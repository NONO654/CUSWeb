define("DS/SMAProcWebAuthoringUI/GatewayEditor",["DS/SMAProcWebCommonControls/Polymer","DS/SMAProcWebCommonControls/utils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebContents/ContentService","DS/SMAProcWebContents/PolyUtils","text!DS/SMAProcWebAuthoringUI/GatewayEditor.html","DS/SMAProcWebCommonControls/import!DS/SMAProcSPUI/sp-modal/sp-modal.html","DS/SMAProcWebCommonControls/import!DS/SMAProcSPUI/sp-button-type/sp-button-type.html","DS/SMAProcWebAuthoringUI/ConditionEditor"],function(e,a,b,d,f,c){a.registerDomModule(c);return e({is:"cmp-gateway-editor",properties:{_gateway:{type:Object,observer:"gatewayChanged"},_conditionEditors:{type:Array,value:function(){return[]}},listeners:{"dataFlowEditorModalDialog.close":"onClose"}},ready:function(){if(this._gateway){this._gateway.getFromSeqFlows()}this.$.dataFlowEditorModalDialog.show()},attached:function(){if(this._gateway){var p=this;var g=function(i){return new Promise(function(k,j){b.getParametersInPLM(i,{onSuccess:k,onFailure:j})})};var r=[p._gateway.getParent()];var m=p._gateway.getIncomingFlowItems();while(m.length>0){var q=[];for(var o=0;o<m.length;o++){if(!(m[o].isGateway())&&(r.indexOf(m[o])<0)){r.push(m[o])}var l=m[o].getIncomingFlowItems();for(var n=0;n<l.length;n++){q.push(l[n])}}m=[];for(var h=0;h<q.length;h++){m.push(q[h])}}Promise.all(r.map(g)).then(function(){var w=new CustomEvent("gatewayeditorattached");var u;var y=[];for(u=0;u<r.length;u++){var s=[];s=r[u].getParameters();for(var t=0;t<s.length;t++){y.push(s[t])}}var v=new d();v.setActivity(p._gateway);var k=p._gateway.getFromSeqFlows();var z=[];if(k.length>0){for(u=0;u<k.length;u++){var x=document.createElement("cmp-condition-editor");var A=(function(j){return f.whenComponentReady(x).then(function(i){i.update(k[j],j,v,y);p._conditionEditors.push(i);e.dom(p.$.conditionEditors).appendChild(i);return true})})(u);z.push(A)}Promise.all(z).then(function(){document.dispatchEvent(w)},function(i){console.error(i)})}else{document.dispatchEvent(w)}},console.error.bind(console))}},gatewayChanged:function(){},onCancel:function(){this.$.dataFlowEditorModalDialog.hide()},onOK:function(){var g=this;g._conditionEditors.forEach(function(i){i.save()});var h=this._gateway.getParent();b.saveSeqFlows(h,{onSuccess:function(){console.log("gateway: modification successful");g.$.dataFlowEditorModalDialog.hide()},onFailure:function(){console.log("Error - gateway: modification NOT successful ")}});this.$.dataFlowEditorModalDialog.hide()},onApply:function(){var g=this._gateway.getParent();b.saveSeqFlows(g,{onSuccess:function(){console.log("gateway: modification successful")},onFailure:function(){console.error("Error - gateway: modification NOT successful ")}})},onClose:function(g){if(g&&g.stopPropagation){g.stopPropagation()}}})});
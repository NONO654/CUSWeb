define("DS/SMAProcWebAuthoringUI/DataflowWebInWinEditor",["DS/SMAProcWebCommonControls/Polymer","DS/SMAProcWebCommonControls/utils","DS/Logger/Logger","module","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/FrameWindow","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMProcessUtils","DS/SMAProcWebCMMUtils/SMAJSCMMWebInWinUtils","DS/SMAProcWebCMMUtils/PubSub","DS/SMAProcWebCMMUtils/SMAProcWebInWinEventHandler","text!DS/SMAProcWebAuthoringUI/DataflowWebInWinEditor.html","css!DS/SMAProcWebAuthoringUI/DataflowWebInWinEditor.css","DS/SMAProcWebCommonControls/import!DS/SMAProcSPUI/sp-modal/sp-modal.html"],function(a,i,d,c,n,j,m,b,f,l,h,e){var k=d.getLogger(c);var g;i.registerDomModule(e);return window.Polymer({is:"cmp-dataflow-webinwin-editor",onresize:function(){this.debounce("resize",function(){g&&g.onResize()},500)},ready:function(){var r=(new URL(document.location)).searchParams,p=r.get("fromSideDataContainer"),o=r.get("toSideDataContainer"),q=r.get("processId");this.toSideDataContainer=o;this.fromSideDataContainer=p;b.loadProcess(q,{onSuccess:this._loadDataFlowTable.bind(this),onFailure:function(s){k.log("Failed to get process"+s)}});window.onresize=this.onresize.bind(this)},_loadDataFlowTable:function(q){m.setCurrentProcess(q);var s=m.getFIFromId(this.fromSideDataContainer);localStorage.setItem("showProcessTree",true);localStorage.setItem("webinwinFlag",true);require(["DS/SMAProcWebAuthoringUtils/cmp-dataflow-editor/cmp-dataflow-editor"],function(){this.frmWindow=new j({workbench:"",workbenchModule:"SMAProcWebApp",height:"100%",width:"100%",viewer:"none",viewerOptions:{antiAliasing:true,useShadowMap:false,infinitePlane:false,displayGrid:false,displayLines:false,control:"SIMPLE",ssao:false,debugShadowLight:false,debugBSphere:false,debugBBox:false},uiOptions:{displayActionBar:false,displayTree:false}}).inject(this.$.dataflow);g=document.createElement("cmp-dataflow-editor");g.addEventListener("dialogHeaderChanged",function(w){if(w.detail&&w.detail.getName){this.$.sourceActivityTitle.innerText=w.detail.getName()}else{this.$.sourceActivityTitle.innerText=""}}.bind(this));if(g){if(this.toSideDataContainer){var u=m.getFIFromId(this.toSideDataContainer);g.updateSelection(s,[u])}else{g.updateSelection(s,[])}var v=n.getFrameWindow(),t=null;if(v){t=v.getUIFrame()}if(t){t.appendChild(g)}}}.bind(this));var o;if(h&&h.getSearchEventHandlersList){o=h.getSearchEventHandlersList()}var r=Object.getOwnPropertyNames(o);for(var p=0;p<r.length;p++){l.add(r[p],o[r[p]])}},winCallBack:function(r,q){switch(r){case"ok":g.onOK();break;case"apply":g.onApply();break;case"cancel":g.onCancel();break;case"ActivitySelection":var o=f.getActivitySelection(q);var p=m.getFIFromId(o.source);if(o.destination){var s=m.getFIFromId(o.destination);g.updateSelection(p,[s],"WIN")}else{g.toggleActivitySelection(p,"WIN")}break;case"Win_Response":l.dispatch("Win_Response",q);break;case"searchResultsReady":l.dispatch("searchResultsReady",{requestList:q});break;case"resize":g.onResize();break;default:k.log(q+" not handled");break}}})});
define("DS/SMAProcWebAuthoringUI/ProcessComposer",["DS/SMAProcWebCommonControls/Polymer","DS/SMAProcWebCommonControls/utils","DS/SMAProcWebDiagram/graph","DS/SMAProcWebAuthoringUI/SMAProcWebProcessComposer","DS/SMAProcWebAsyncUtils/SMAProcWebTransactionManager","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMAccessUtils","DS/SMAProcWebCMMUtils/PubSub"],function(b,f,c,e,g,h,a,i){var d='<dom-module id="cmp-process-composer"><template><style>:host, #graph_canvas {display:block; height: 100%;} .readonly {color :red; left:50%; position:fixed; top:10px;transform :translate(-50%, 0px);display:none;} .show {display:block}</style><div id="graph_canvas"></div><span class="readonly" id="readonly">Read Only</span></template></dom-module>';f.registerDomModule(d);return b({is:"cmp-process-composer",listeners:{click:"onComposerClicked","graph_canvas.process-click":"onProcessClicked","graph_canvas.process-contextmenu":"onProcessRightClicked","graph_canvas.activity-click":"onActivityClicked","graph_canvas.activity-contextmenu":"onActivityRightClicked","graph_canvas.activity-hover":"onActivityHover","graph_canvas.step-click":"onStepClicked","graph_canvas.step-contextmenu":"onStepRightClicked","graph_canvas.gateway-click":"onGatewayClicked","graph_canvas.gateway-contextmenu":"onGatewayRightClicked"},ready:function(){c.CleanUp();c.initialize(this.$.graph_canvas);i.add("processChanged",function(j){c.getGraphNode(j.plmobject).views.main.display.elt.processTitle=j.title});i.add("activityChanged",function(j){c.getGraphNode(j.plmobject).views.main.display.elt.activityTitle=j.title});c.assignCallBackObject(e.uiCallback);this.updateCurrentProcess();e.registerContextualBar();g.start()},updateCurrentProcess:function(){var l=h.currentProcess;if(l){var k=new Set();(l.getAllActivities()||[]).forEach(function(m){(m&&m.getSteps&&m.getSteps()||[]).forEach(function(n){k.add(n.getExtensionName())})});var j=[];k.forEach(function(m){if(m){j.push(h.getExtensionDescriptor(m))}});Promise.all(j).then(function(){c.CreateGraph(l)},function(){c.CreateGraph(l)});if(!a.hasModifyAccess()){this.$.readonly.classList.add("show")}else{this.$.readonly.classList.remove("show")}}},onComposerClicked:e.onComposerClicked,onProcessClicked:function(j){this._handleEvent(j,"onProcessClicked")},onProcessRightClicked:function(j){this._handleEvent(j,"onProcessRightClicked")},onActivityClicked:function(j){this._handleEvent(j,"onActivityClicked")},onActivityRightClicked:function(j){this._handleEvent(j,"onActivityRightClicked")},onActivityHover:function(j){this._handleEvent(j,"onActivityHover")},onStepClicked:function(j){this._handleEvent(j,"onActivityClicked")},onStepRightClicked:function(j){this._handleEvent(j,"onActivityRightClicked")},onGatewayClicked:function(j){this._handleEvent(j,"onGatewayClicked")},onGatewayRightClicked:function(j){this._handleEvent(j,"onGatewayRightClicked")},_handleEvent:function(n,m){if(n){n.stopPropagation();var k=n.detail;var l=k&&k.data;var j=k&&k.originalEvent;if(!j.pageX&&!j.pageY&&j.detail){j.pageX=j.detail.x;j.pageY=j.detail.y}e.uiCallback[m](l,j)}}})});
define("DS/SMAProcWebAuthoringUI/ProcessTableView",["UWA/Core","UWA/Controls/Abstract","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/JSCMM/SMAJSCMMUtils","DS/Utilities/Array","DS/Logger/Logger","module","css!DS/SMAProcWebAuthoringUI/ProcessTableView.css","css!DS/UIKIT/UIKIT.css"],function(k,i,h,a,g,c,m,e,d){var l=e.getLogger(d);var f,b,j=[];b=i.extend({name:"ProcessTableView",_initDefaultOptions:function(){f=[{text:"",dataIndex:"selection",type:"selection",width:30},{dataIndex:"tree",text:"Process Tree",width:"auto",isDraggable:false,isEditable:false}]},init:function(n){this._parent(n);this._initDefaultOptions()},createNodes:function(n,r,t){var q;var s;if(!t){s=r.isProcess()?r:r.getProcess();q=c.getChildrenInOrder(s);t=new g({label:s.getName(),flowItem:s,icons:[{iconName:"fast-forward"}]})}else{if(t){q=c.getChildrenInOrder(r)}}if(q){for(var p=0;p<q.length;p++){if(!q[p].isGateway()){var o=new g({label:q[p].getName(),flowItem:q[p],icons:[{iconName:"play"}]});t.addChild(o);this.createNodes(n,q[p],o)}}}return t},_loadDocument:function(r){var n;var o=new a({useAsyncPreExpand:false});o.prepareUpdate();var q=this.createNodes(o,r);o.addRoot(q);o.pushUpdate();n=o.getXSO();n.onChange(function(s){if(!this.preventSelectionPropogation){this.dispatchEvent("toggleselection",s.options.flowItem)}}.bind(this));var p=this.elements._treeListView.getManager();p.loadDocument(o);setTimeout(function(){o.expandAll();this.isLoaded=true;this._isLoading=false;this.dispatchEvent("processTableViewLoaded");j.forEach(function(s){s()});j=[]}.bind(this),50)},_buildParameterView:function(p){var o;this.elements=this.options.elements;o=this.options.columns||f;this.elements._treeListView=new h({columns:o,defaultCellHeight:30,resize:{rows:false,columns:true},showVerticalLines:true,useTransparentScroller:false,alternateRowColor:false,isEditable:false,iconsSize:22,isSortable:false,show:{rowHeaders:false,columnHeaders:true},selection:{nodes:false,cells:false,rowHeaders:false,columnHeaders:false,unselectAllOnEmptyArea:false,toggle:false,enableListSelection:false,canMultiSelect:true},performances:{buildLinks:false,useRequestAnimationFrameRendering:false,debounceCellRequest:true,debounceCellInternalUpdateTimer:10},showLoaderIndicator:true,enableDragAndDrop:false,shouldAcceptDrag:function(){return false},height:"auto",apiVersion:"2",allowUnsafeHTMLContent:false});this.elements._treeListView.elements.container.addClassName("wux-controls-process-table-view");this.elements.body=new k.createElement("div",{"class":"wux-controls-process-body",html:[{tag:"div",styles:{position:"relative",height:"100%"},html:this.elements._treeListView}]});this.elements.body.inject(this.elements.tableContainer);var n=this.elements._treeListView.getManager();n.onReady(function(){this._loadDocument(p)}.bind(this))},_whenReady:function(n,o){if(this.isLoaded){o()}else{if(!this._isLoading){this._isLoading=true;j.push(o);this._buildParameterView(n)}else{j.push(o)}}},initLoadingTable:function(n){if(!this._isLoading){this._buildParameterView(n);this._isLoading=true}},setAsSourceActivity:function(n){this._whenReady(n,function(){var o=this.getNode(n);o&&o.matchSearch();o&&o.unselect()}.bind(this))},unsetAsSourceActivity:function(n){this._whenReady(n,function(){var o=this.getNode(n);o&&o.unmatchSearch();o&&o.unselect()}.bind(this))},stopSelectionEvent:function(){this.preventSelectionPropogation=true},resumeSelectionEvent:function(){this.preventSelectionPropogation=false},selectActivity:function(n){this._whenReady(n,function(){var o=this.getNode(n);o&&o.select()}.bind(this))},unselectActivity:function(n){this._whenReady(n,function(){var o=this.getNode(n);o&&o.unselect()}.bind(this))},getNode:function(p){var o,n;o=this.elements._treeListView.getManager();n=o.search({shouldStop:function(){return false},match:function(q){if(p){if(q.nodeModel.options.flowItem===p){return true}}return false}});m.optimizedForEach(n,function(q){q.reverseExpand()});return n[0]},setMultiSelectMode:function(n){this.options.canMultiSelect=n},unloadDocument:function(){try{this.elements._treeListView.getManager().unloadDocument();this._model=null;this.elements._treeListView.destroy();this.elements.body.destroy();this.elements.tableContainer.empty()}catch(n){l.log(n)}}});return b});
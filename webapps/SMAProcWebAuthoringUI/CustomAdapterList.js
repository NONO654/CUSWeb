define("DS/SMAProcWebAuthoringUI/CustomAdapterList",["DS/SMAProcWebCommonControls/Polymer","DS/SMAProcWebCommonControls/utils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAWINAuthoringUtils","DS/JSCMM/SMAJSCMMExtensionManager","DS/ApplicationFrame/CommandsManager","text!DS/SMAProcWebAuthoringUI/CustomAdapterList.html","i18n!DS/SMAProcWebAuthoringUI/assets/nls/CustomAdapterList","DS/SMAProcWebSupportabilityUtils/SupportabilityAPI","DS/SMAProcWebSupportabilityUI/cmp-supportability-diagnostics/cmp-supportability-diagnostics","DS/SMAProcWebSupportabilityUI/ZipJSArchiver","DS/SMAProcWebSupportabilityUtils/platform/SessionInfo","DS/Controls/Button"],function(b,h,l,g,k,a,e,m,c,f,d,j,i){h.registerDomModule(e);return b({is:"cmp-customadapter-list",properties:{customadapters:{type:Array,value:function(){return[]}},defaultIconURL:{type:String,value:"DS/SMAProcWebApp/assets/icons/32/SMAWflCustomAdapter32.png"},_i18n:{value:m}},ready:function(){var q=this;var r=new j({spaceUrl:l.get3DSpaceUrl()});var n=undefined;if(g.isWebInWin()){var p=c.Diagnostics.createDefaultRunner(r);var o=c.Logs.createDefaultLogs(new d(),r);n=new f(p,o)}l.fetchCustomExtensionDescriptors().then(function(s){(s||[]).forEach(function(t){q.push("customadapters",{title:t.getTitle()||t.getName(),description:t.getDescription(),name:t.getExtensionName(),iconUrl:k.getIconForExtension(t.getExtensionName())})})},function(u){q.querySelector("p").hidden=true;var s=q.querySelector("#adapter-error");s.hidden=false;var t=q.querySelector("#error-message");var w=t.innerText;t.innerText=w+"\n"+u+"\n\n";console.warn("Failed to fetch custom extension descriptors:",u);if(g.isWebInWin()&&n){var v=new i({label:"Run diagnostics",name:"Run diagnostics",onClick:function(){q.innerHTML="";q.appendChild(n);n.setOnCancel(function(){location.reload()})},allowUnsafeHTMLLabel:false});v.inject(t)}}).then(function(){if(q.customadapters){var u=new UWA.Element("div",{"class":"wux-control-inline-container",style:{"vertical-align":"top"}});u.inject(q);for(var t=0;t<q.customadapters.length;t++){var s=new i({value:q.customadapters[t].name,label:q.customadapters[t].title,icon:q.getIconPath(q.customadapters[t].iconUrl),displayStyle:"icon",onClick:q.addAdapter,allowUnsafeHTMLLabel:false});s.inject(u);s.elements.icon.addEventListener("error",q.getDefaultIcon)}}})},addAdapter:function(q){var p=q.target;var o=p.dsModel.value;if(g.isWebInWin()){window.dscef.sendString("LaunchCustomAdapter",o,"","")}else{var r=a.getCommand("SMAWflActionBarGenericAdapterCmdHdr");if(r){var n=r.getArguments();if(n&&n.length>0&&o){n[0].Value=o}if(r.begin){r.begin()}}}},getDefaultIcon:function(o){var n=o.srcElement;n.src=require.toUrl("DS/SMAProcWebApp/assets/icons/32/SMAWflCustomAdapter32.png")},getIconPath:function(n){if(n){return n}return require.toUrl(this.defaultIconURL)},_areAdaptersAvailable:function(){return this.customadapters&&(this.customadapters.length>0)},_getLibRecURL:function(){return require.toUrl("DS/SMAProcWebExtensions/assets/library/CustomLibRec.xml")}})});
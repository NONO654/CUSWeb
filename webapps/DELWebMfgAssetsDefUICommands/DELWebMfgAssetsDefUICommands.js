define("DS/DELWebMfgAssetsDefUICommands/AttachDocumentCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefUIControls/DocumentMgmtUI"],function(e,a,b,c){var d=a.extend({init:function(f){this._parent(f,{mode:"exclusive",isAsynchronous:false})},beginExecute:function(){var f=b.getSelectedRefs()[0];c.attachDocument(f.id)}});return d});define("DS/DELWebMfgAssetsDefUICommands/CreateInstanceCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefUIServices/CreateLinkUtil","DS/DELWebMfgAssetsDefUIServices/CommandsManager"],function(f,c,b,d){var e=c.extend({name:"CreateInstanceCmd",init:function(g){this._parent(g,{mode:"exclusive",isAsynchronous:false})},beginExecute:function a(){var g=d.getSelectedObjectsForLinkCreation();b.createInstance(g.fromReference.id,g.toReference.id,this._iEvtID)}});return e});define("DS/DELWebMfgAssetsDefUICommands/BlocksViewCmd",["UWA/Core","UWA/Class","DS/Core/Events","DS/Logger/Logger","DS/ApplicationFrame/CommandCheckHeader","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil"],function(i,a,g,c,k,d,f){var h=k.extend({name:"BlocksViewCmd",_logger:null,init:function l(m){var n;d.CommandsCheckHeaderManager.registerCmd(m.ID,this);this._parent(m);if(i.is(c)){this._logger=c.getLogger(h)}this._blockLayout=d.getMGAElement("InnerBlocLayout");this._prefix="/WUX/AFR/CMD/"+this._context+"/";this._endpostfix="Block/END";this.blockName="Unknown";this._cmdEnum={Bottom:{row:1,column:0},Left:{row:0,column:0},Right:{row:0,column:1}};if(i.is(m.arguments)){if(m.arguments.length>0){if(m.arguments[0].ID==="Name"){this.blockName=m.arguments[0].Value;d.BlocksViewCmdManager.registerCmdState(this.blockName,false)}}}if(f.isViewPersistanceOn()){n=(widget.getValue("BlocksView"+this.blockName)==="true")?true:false;this.setState(n);d.BlocksViewCmdManager.registerCmdState(this.blockName,n);if(this.getState()){this._check(true)}else{this._uncheck(true)}}else{this.setState(true);d.BlocksViewCmdManager.registerCmdState(this.blockName,true)}this.onStateChange(this._stateChanged)},_stateChanged:function j(){var m=this.getState();d.BlocksViewCmdManager.registerCmdState(this.blockName,m);if(m){widget.setValue("BlocksView"+this.blockName,"true");this._check(false)}else{widget.setValue("BlocksView"+this.blockName,"false");this._uncheck(false)}},_check:function e(o){var m=d.BlocksViewCmdManager.getActiveCmdNames(this.blockName),n=m.length;switch(this.blockName){case"Bottom":if(0===n&&!o){this._blockLayout.maximizeRow(this._cmdEnum.Bottom.row)}else{this._blockLayout.unmaximizeRows()}break;case"Left":if(0===n&&!o){this._blockLayout.maximizeRow(this._cmdEnum.Left.row);this._blockLayout.maximizeColumnInRow(this._cmdEnum.Left.row,this._cmdEnum.Left.column)}else{if(1===n){if(m[0]==="Right"){this._blockLayout.unmaximizeColumnsInRow(this._cmdEnum.Right.row);this._blockLayout.maximizeRow(this._cmdEnum.Left.row)}else{if(m[0]==="Bottom"){this._blockLayout.unmaximizeRows();this._blockLayout.maximizeColumnInRow(this._cmdEnum.Left.row,this._cmdEnum.Left.column);this._blockLayout._resizeBottomBloc()}}}else{if(2===n){this._blockLayout.unmaximizeColumnsInRow(this._cmdEnum.Right.row)}}}break;case"Right":if(0===n){this._blockLayout.maximizeRow(this._cmdEnum.Right.row);this._blockLayout.maximizeColumnInRow(this._cmdEnum.Right.row,this._cmdEnum.Right.column)}else{if(1===n){if(m[0]==="Left"){this._blockLayout.unmaximizeColumnsInRow(this._cmdEnum.Left.row);this._blockLayout.maximizeRow(this._cmdEnum.Right.row)}else{if(m[0]==="Bottom"){this._blockLayout.unmaximizeRows();this._blockLayout.maximizeColumnInRow(this._cmdEnum.Right.row,this._cmdEnum.Right.column);this._blockLayout._resizeBottomBloc()}}}else{if(2===n){this._blockLayout.unmaximizeColumnsInRow(this._cmdEnum.Left.row)}}}break;default:break}},_uncheck:function b(o){var m=d.BlocksViewCmdManager.getActiveCmdNames(this.blockName),n=m.length;switch(this.blockName){case"Bottom":if(0===n&&!o){this.setState(true)}else{this._blockLayout.maximizeRow(this._cmdEnum.Left.row)}break;case"Left":if(0===n&&!o){this.setState(true)}else{if(1===n){if(m[0]==="Right"){this._blockLayout.maximizeRow(this._cmdEnum.Right.row);this._blockLayout.maximizeColumnInRow(this._cmdEnum.Right.row,this._cmdEnum.Right.column)}else{if(m[0]==="Bottom"){this._blockLayout.maximizeRow(this._cmdEnum.Bottom.row);this._blockLayout._resizeBottomBloc()}}}else{if(2===n){this._blockLayout.maximizeColumnInRow(this._cmdEnum.Right.row,this._cmdEnum.Right.column)}}}break;case"Right":if(0===n){this.setState(true)}else{if(1===n){if(m[0]==="Left"){this._blockLayout.maximizeRow(this._cmdEnum.Left.row);this._blockLayout.maximizeColumnInRow(this._cmdEnum.Left.row,this._cmdEnum.Left.column)}else{if(m[0]==="Bottom"){this._blockLayout.maximizeRow(this._cmdEnum.Bottom.row);this._blockLayout._resizeBottomBloc()}}}else{if(2===n){this._blockLayout.maximizeColumnInRow(this._cmdEnum.Left.row,this._cmdEnum.Left.column)}}}break;default:break}}});return h});define("DS/DELWebMfgAssetsDefUICommands/BIEssentialsCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/BIUtils"],function(g,f,c,a){var b=f.extend({name:"BIEssentialsCmd",_logger:null,_context:null,init:function e(h){this._context=h.context;this._parent(h,{mode:"exclusive",isAsynchronous:false});if(g.is(c)){this._logger=c.getLogger(b)}this.onStateChange(this._stateChanged)},_stateChanged:function d(){var m=this,p=this.getState(),r={},q=this._context.getMBOMTreeListView(),k=m._context.getBodyTreeListView(),i=q.getDocument().getRoots(),j=k.getDocument().getRoots(),l=q.getDocument().getAllDescendants(),o=k.getDocument().getAllDescendants(),n=[],h=[];if(p){m._view=m._context.getCurrentView();if(Array.isArray(i)){i.forEach(function(s){n.push(s.getReferencePID())})}if(Array.isArray(j)){j.forEach(function(s){h.push(s.getReferencePID())})}r.rootEBOM=h;r.rootMBOM=n;r.loadedProcNodes=l;r.loadedProdNodes=o;a.resetBIModelCollection();a.fetchBIComputation(r,function(){})}else{a.resetBIModelCollection()}a.setCurrentBICmdState(p);m._logger.log("BI _stateChanged")}});return b});define("DS/DELWebMfgAssetsDefUICommands/LinksFilterCmd",["UWA/Core","DS/UIKIT/Modal","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","UWA/Utils","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/DELWebMfgAssetsDefUIGraphView/GraphLinkFilter","DS/UIKIT/Input/Button","DS/DELWebMfgAssetsDefUIGraphView/GraphView","DS/DELWebMfgAssetsDefModelServices/Resources"],function(i,n,c,b,d,e,m,g,l,o,k,j,f,h){var a=c.extend({init:function(p){this._parent(p,{mode:"exclusive",isAsynchronous:false})},unselectAll:function(p){p.forEach(function(q){q.checkFlag=false;k.setDisplayedStatus(q._properties.value.value,false)});return""},selectAll:function(p){p.forEach(function(q){q.checkFlag=true;k.setDisplayedStatus(q._properties.value.value,true)});return""},beginExecute:function(){var v=this,A,r,B,q,p,u,x,y,z,t,s,C,w=[];if(i.is(this.dialog)){this.dialog.destroy();this.dialog=null;new f({renderTo:d.getMGAElement("SlidingViews").getView(1),referenceCollection:m.references,instanceCollection:m.instances,connectionCollection:m.connections})}else{B=this;q=h.getNLSValue("InsertCmd.OK");p="NAME";u=new l({type:"checkbox"});x=k.getCreatableTypesOfLink();A=i.createElement("div");this.dialog=new n({header:h.getNLSValue("GraphViewLinksFilter.Header"),closable:false,className:"Links filter",footer:A});r=new j({value:q,className:"btn btn-primary MGAGraphViewLinksFilterOKButton"}).inject(A);r.addEvent("onClick",function(){new f({renderTo:d.getMGAElement("SlidingViews").getView(1),referenceCollection:m.references,instanceCollection:m.instances,connectionCollection:m.connections});v.dialog.destroy();v.dialog=null});this.dialog.inject(widget.body);y=new o({type:"switch",label:h.getNLSValue("GraphViewLinksFilter.SelectUnselectAll")+"</br>",checkFlag:true});u.addChild(y);y.addEventListener("buttonclick",function(D){if(D.dsModel._properties.checkFlag.value===false){B.unselectAll(w)}else{B.selectAll(w)}});for(s=0;s<x.length;s++){p=x._models[s]._attributes.name;t=x._models[s]._attributes.img;if(k.getDisplayedStatusByName(p)===true){z=true}else{z=false}C=h.getIconURLFromKey(t);w[s]=new o({type:"checkbox",value:p,label:"<img src='"+C+"'/>   "+p,checkFlag:z,isMultiSelection:true});u.addChild(w[s]);w[s].addEventListener("buttonclick",function(D){k.setDisplayedStatus(D.dsModel._properties.value.value,D.dsModel._properties.checkFlag.value)})}this.dialog.setBody(u);this.dialog.show()}}});return a});define("DS/DELWebMfgAssetsDefUICommands/RelationsCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/DELWebMfgAssetsDefUIControls/LinksUI","DS/DELWebMfgAssetsDefUIServices/UIUtils"],function(f,e,d,a){var c=e.extend({name:"RelationsCmd",init:function(g){a.CommandsCheckHeaderManager.registerCmd(g.ID,this);this._parent(g,{mode:"exclusive",isAsynchronous:false});this.onStateChange(this._stateChanged)},_stateChanged:function b(){d.toggle(this)}});return c});define("DS/DELWebMfgAssetsDefUICommands/PPRReplaceByNewRevisionCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/Logger/Logger","UWA/Class/Options","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/BIUtils"],function(e,b,c,l,f,d,a,k,h,o){var j=b.extend(l,{name:"PPRReplaceByNewRevisionCmd",_logger:null,_context:null,_mbomTreeDocument:null,mbomTreeListView:null,init:function p(q){this._parent(q,{mode:"exclusive",isAsynchronous:false});this._logger=c.getLogger(j);this._context=this.getOption("context");if(!this._context){this._logger.warn("ERROR: No context given");return}},_displayError:function i(q){this._logger.warn("ERROR: "+q);d.AlertManager.add({className:"error",message:f.getNLSValue(q),})},beginExecute:function n(){this._logger.log("beginExecute");this.mbomTreeListView=this._context.getMBOMTreeListView();if(!this.mbomTreeListView){this._logger.warn("No mbom treelistview");return}this._mbomTreeDocument=this.mbomTreeListView.getDocument();if(!this._mbomTreeDocument){this._logger.awrn("No mbom tree document");return}},execute:function m(){var q=this,s;this._logger.log("execute");if(!this._mbomTreeDocument){this._logger.warn("No treedocument found for mbom !");return}s=this._mbomTreeDocument.getSelectedNodes();if(!this.mbomTreeListView.getDocument().areRelationsLoaded(s)){d.AlertManager.add({className:"error",message:f.getNLSValue("Error.RelationsNotLoaded.Title")});return}s.forEach(function r(z){var A,B,x,y,C,u=z.getReferencePID(),v=z.getInstancePID();if(!u){q._logger.warn("ERROR: Could not get referencePID");return}if(!v&&!z.isRoot()){q._logger.warn("ERROR: Could not get instancePID");return}C=z.getFirstParentWithAScopeNode();if(e.is(C)){x=C.getScopes();if(x.length!==0){y=x[0].to}}A=z.getParent();B=A.getReferencePID();a.webServiceRequest({url:"modeler/ppr/isReadOnly",method:"GET",data:{pid:B},onComplete:function w(D){var F={instancePID:v};if(D.isReadOnly){q._displayError("Error.ReplaceByExistingParentNotInReadWrite.Title");return}if(z.isScoped()&&e.is(y)){F.scopedParentPrdRefID=y}a.webServiceRequest({url:"modeler/ppr/replaceByNewRevision",method:"POST",data:e.Json.encode(F),onComplete:function G(L){var I=[],K=[],J=[],H=null;H=L.revisedObjects[0].revisedTo;L.instancesAndReferences.forEach(function(N){var M=N.attributesValue;if(M.hasOwnProperty("isInstanceOf")){M.queriedForConnections=true;I.push(M)}else{K.push(M)}});L.connections.forEach(function(N){var M=k.parseConnection(N);J.push(M)});k.addToCollections({stackedReferences:K,stackedInstances:I,stackedConnections:J,deletedObjects:L.deletedObjects,onComplete:function(){var P,N,O;N=function(Q){h.fillConnectionModelInfo(Q);q.mbomTreeListView.utils.fillReferenceTreeNode(A);if(!A.isExpanded()){A.expand()}if(z.isExpanded()){O=q.mbomTreeListView.getDocument().getNodeModel(Q.id)[0];O.expand()}if(o.getCurrentBICmdState()){o.computeBIStatus()}};P=k.references.get(H);if(!e.is(P)){k.fetchRoot(H,{context:this,onComplete:function M(R){var Q=k.references.add(R);N(Q)}})}else{N(P)}d.AlertManager.add({className:"success",message:f.getNLSValue("ReplaceByNewRevision.Success")})}})},onFailure:function E(J,I,H){console.log("jsonData: "+J+" error:"+I+" options: "+H);d.AlertManager.add({className:"error",message:f.getNLSValue("Error.ReplaceByNewRevisionError.Title")})}})},onFailure:function t(F,E,D){console.log("jsonData: "+F+" error:"+E+" options: "+D);d.AlertManager.add({className:"error",message:f.getNLSValue("Error.ReplaceByNewRevisionError.Title")})}})},this)},endExecute:function g(){this._logger.log("endExecute")}});return j});define("DS/DELWebMfgAssetsDefUICommands/InsertInstanceCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefUIServices/CreateLinkUtil","DS/DELWebMfgAssetsDefUIServices/CommandsManager","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/Search"],function(d,j,f,b,k,q,l,c,i,r,a,p,g){var m=j.extend({_search:null,init:function n(s){this._parent(s,{mode:"exclusive",isAsynchronous:false});this._search=new g(this.onSearchObjectSelected.bind(this))},beginExecute:function o(){this._showDialog()},onSearchObjectSelected:function e(s){var u,t;u=i.getSelectedRefs({views:i.VIEWS.ROUTINGS});if(u.length===1){t=u[0];s.forEach(function(w){var v=t.get("PID"),y=w.id,z=p.getNLSValue("InsertInstanceCmd.CreateInstanceFailure"),x=new l({PID:w.id});x.fetch({proxy:"passport",headers:{SecurityContext:c.getSecurityContext()},wait:true,onComplete:function(A){if(a.isInstancePossible(t,A)){i.references.add(A);r.createInstance(v,y)}else{q.AlertManager.add({className:"error",message:z})}}})})}},_showDialog:function h(){var D=this,s,B,C=p.getNLSValue("InsertInstanceCmd.DialogTitle"),A=p.getNLSValue("InsertInstanceCmd.FormPlaceHolder"),v=p.getNLSValue("InsertInstanceCmd.SEARCH"),u=p.getNLSValue("InsertInstanceCmd.CANCEL"),E=p.getNLSValue("InsertInstanceCmd.SearchTitle"),w,y,t,x,z;if(d.is(D.dialog)){D.dialog.destroy();D.dialog=null}s=new f({className:"MGA-DELWebMfgAssetsDefUICommands-InsertInstanceCmd-Form vertical",grid:"4 8",fields:[{type:"text",name:"search",required:true,placeholder:A,}]});B=d.createElement("div");w=function w(){var H=i.getSelectedRefs({views:i.VIEWS.ROUTINGS}),F,G=H[0];F=a.getValidChildTypesForParentType(G.get("type"));D._search.activate(E,F,[s.getValue("search")]);D.dialog.destroy();D.dialog=null};y=function y(){D.dialog.destroy();D.dialog=null};t=new k({value:v,className:"primary",icon:"search",}).inject(B);t.addEvent("onClick",w);x=new k({value:u,className:"default"}).inject(B);x.addEvent("onClick",y);this.dialog=new b({className:"MGA-DELWebMfgAssetsDefUICommands-InsertInstanceCmd-Dialog",header:C,closable:true,body:s,footer:B,events:{onHide:y,}});z=this.dialog.getContent();z.setAttribute("tabIndex","0");z.addEventListener("keydown",function(F){if(F.keyCode===13){if(F.target.type==="button"){F.target.triggerEvent("click")}else{w()}}else{if(F.keyCode===27){y()}}});this.dialog.inject(widget.body);this.dialog.getBody().setStyle("max-height",q.getPopUpMaxHeight()-200);this.dialog.show()},});return m});define("DS/DELWebMfgAssetsDefUICommands/PPRReplaceByLatestRevisionCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/Logger/Logger","UWA/Class/Options","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/BIUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel"],function(g,b,d,m,h,e,a,p,l,j,f){var c=b.extend(m,{name:"PPRReplaceByLatestRevisionCmd",_logger:null,_context:null,_mbomTreeDocument:null,mbomTreeListView:null,init:function q(r){this._parent(r,{mode:"exclusive",isAsynchronous:false});this._logger=d.getLogger(c);this._context=this.getOption("context");if(!this._context){this._logger.warn("ERROR: No context given");return}},_displayError:function k(r){this._logger.warn("ERROR: "+r);e.AlertManager.add({className:"error",message:h.getNLSValue(r),})},beginExecute:function o(){this._logger.log("beginExecute");this.mbomTreeListView=this._context.getMBOMTreeListView();if(!this.mbomTreeListView){this._logger.warn("No mbom treelistview");return}this._mbomTreeDocument=this.mbomTreeListView.getDocument();if(!this._mbomTreeDocument){this._logger.awrn("No mbom tree document");return}},execute:function n(){var r=this,t;this._logger.log("execute");if(!this._mbomTreeDocument){this._logger.warn("No treedocument found for mbom !");return}t=this._mbomTreeDocument.getSelectedNodes();if(!this.mbomTreeListView.getDocument().areRelationsLoaded(t)){e.AlertManager.add({className:"error",message:h.getNLSValue("Error.RelationsNotLoaded.Title")});return}t.forEach(function s(A){var B,C,y,z,D,v=A.getReferencePID(),w=A.getInstancePID();if(!v){r._logger.warn("ERROR: Could not get referencePID");return}if(!w&&!A.isRoot()){r._logger.warn("ERROR: Could not get instancePID");return}D=A.getFirstParentWithAScopeNode();if(g.is(D)){y=D.getScopes();if(y.length!==0){z=y[0].to}}B=A.getParent();C=B.getReferencePID();a.webServiceRequest({url:"modeler/ppr/isReadOnly",method:"GET",data:{pid:C},onComplete:function x(E){var G={pid:v};if(E.isReadOnly){r._displayError("Error.ReplaceByExistingParentNotInReadWrite.Title");return}a.webServiceRequest({url:"modeler/ppr/getMajorRevisions",method:"POST",data:g.Json.encode(G),onComplete:function H(I){var K,J,M=I[I.length-1].PID;if(M===v){r._displayError("Error.NoLatestForReplaceByLatest.Title");return}K={instancePID:w,latestRefPID:M};J=new f({PID:M});J.fetch({proxy:"passport",type:"json",wait:true,onComplete:function L(P){var O,N=l.references.add(P);O=function O(){if(A.isScoped()&&g.is(z)){K.scopedParentPrdRefID=z}a.webServiceRequest({url:"modeler/ppr/replaceByLatest",method:"POST",headers:a.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),data:g.Json.encode(K),onComplete:function Q(V){var S=[],U=[],T=[];V.instancesAndReferences.forEach(function(X){var W=X.attributesValue;if(W.hasOwnProperty("isInstanceOf")){W.queriedForConnections=true;S.push(W)}else{U.push(W)}});V.connections.forEach(function(X){var W=l.parseConnection(X);T.push(W)});l.addToCollections({stackedReferences:U,stackedInstances:S,stackedConnections:T,deletedObjects:V.deletedObjects,onComplete:function(){var Z,X,Y;X=function(aa){j.fillConnectionModelInfo(aa);r.mbomTreeListView.utils.fillReferenceTreeNode(B);if(!B.isExpanded()){B.expand()}if(A.isExpanded()){Y=r.mbomTreeListView.getDocument().getNodeModel(aa.id)[0];Y.expand()}if(p.getCurrentBICmdState()){p.computeBIStatus()}};Z=l.references.get(M);if(!g.is(Z)){l.fetchRoot(M,{context:this,onComplete:function W(ab){var aa=l.references.add(ab);X(aa)}})}else{X(Z)}e.AlertManager.add({className:"success",message:h.getNLSValue("ReplaceByLatest.Success")})}})},onFailure:function R(U,T,S){var V="Error.ReplaceByLatestError.Title";r.log("jsonData: "+U+" error:"+T+" options: "+S);if(g.is(T.message)&&T.message==="replaceMfgItemScopedWithDifferentProduct"){V="Error.ReplaceByLatestScopeToDiffPrd.Title"}e.AlertManager.add({className:"error",message:h.getNLSValue(V)})}})};l.getConnectionsByModel(N,null,null,true,O)}})},onFailure:function F(K,J,I){r.log("jsonData: "+K+" error:"+J+" options: "+I);e.AlertManager.add({className:"error",message:h.getNLSValue("Error.GetMajorRevisionFailure.Title")})}})},onFailure:function u(G,F,E){r.log("jsonData: "+G+" error:"+F+" options: "+E);e.AlertManager.add({className:"error",message:h.getNLSValue("Error.ReplaceByLatestError.Title")})}})},this)},endExecute:function i(){this._logger.log("endExecute")}});return c});define("DS/DELWebMfgAssetsDefUICommands/ReplaceCapableResourceCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/Logger/Logger","DS/DELWebMfgAssetsDefUIServices/CommandsManager","DS/DELWebMfgAssetsDefUIControls/LinksUI","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/ExternalEventsUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/Search"],function(f,n,i,b,o,t,a,h,u,p,e,l,v,q,s,j){var c=n.extend({name:"ReplaceCapableResourceCmd",_logger:null,_search:null,_connection:null,init:function(w){this._parent(w,{mode:"exclusive",isAsynchronous:false});this._logger=t.getLogger("ReplaceCapableResourceCmd");this._search=new j(this.onSearchObjectSelected.bind(this))},setLinkedReference:function m(w){this._connection=w},beginExecute:function r(){this._showDialog();this._logger.log("STARTED - Showing search dialog")},replaceCapableResource:function d(A){var z=s.getNLSValue("ReplaceCapableResourceCmd.ReplaceResourceSuccess"),B=s.getNLSValue("ReplaceCapableResourceCmd.ReplaceResourceFailure"),y=this._connection,D=y.id,E=this,x=function x(K){var H=[],J=[],N=[],O=[],L=[],M;K=K||{};K=f.merge(K,{deletedConnections:[],instancesAndReferences:[],connections:[]});E._logger.log("Successful server response received. New connections are:");L=K.deletedConnections;K.instancesAndReferences.forEach(function(R){var P=f.is(R.attributesValue)?R.attributesValue:R,Q,S;if(P.hasOwnProperty("isInstanceOf")){Q=l.instances.get(P.PID);if(!f.is(Q)){E._logger.warn("We only update Insts")}else{Q.set(P)}}else{S=l.references.get(P.PID);if(!f.is(S)){S=new p(f.merge(P,{queriedForChildren:true,queriedForDocuments:true}));if(f.is(S)){l.references.add(S);S.setDisplayModel({asRootInTableView:true})}}else{S.set(P)}}});K.connections.forEach(function F(P){M=l.parseConnection(P);E._logger.log(M.PID);N.push(M)});if((L.length===0)&&(N.length===0)){u.AlertManager.add({className:"info",message:s.getNLSValue("Info.NoUpdate.Title")});E._logger.warn("No connections Deleted");return}E._logger.log("Deleted Connections are:");L.forEach(function I(P){l.connections.remove(P);E._logger.log(P)});l.addToCollections({stackedReferences:H,stackedInstances:J,stackedConnections:N,deletedObjects:O,silent:false,onComplete:function G(){N.forEach(function P(Q){var R,S;if(f.is(Q.from)&&f.is(Q.to)){R=l.references.get(Q.from);S=l.references.get(Q.to);if((f.is(R)&&f.is(R.id))&&(f.is(S)&&f.is(S.id))){v.fillConnectionModelInfo(R);v.fillConnectionModelInfo(S)}else{E._logger.warn("From or To model is empty")}}Q=l.getConnectionFromCollection(Q.PID);h.updateUI(Q);E._logger.log("New Connection PID: "+Q.id)});u.AlertManager.add({className:"success",message:z});E._logger.log("COMPLETED");q.emitDeleteConnectionEvent(y.toJSON());q.emitCreateConnectionEvent(K.connections)}})},w=function w(){u.AlertManager.add({className:"error",message:B});E._logger.warn(B)},C=f.Json.encode({connectionID:D,newResourceID:A});e.webServiceRequest({url:"modeler/ppr/replaceCapableResource",method:"PUT",headers:e.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),context:this,onComplete:x,onFailure:w,onTimeout:w,onCancel:w,data:C})},onSearchObjectSelected:function g(z){var w=this,A=l.getReferenceFromCollection(z[0].id),x=s.getNLSValue("ReplaceCapableResourceCmd.ReplaceResourceExistsFailure"),y=function y(B){w.replaceCapableResource(B)};if(f.is(A)){this._logger.log("Selected object: "+A.id+" is fetched from Collections");y(A.id)}else{A=new p({PID:z[0].id});A.fetch({proxy:"passport",headers:{SecurityContext:e.getSecurityContext()},wait:true,onComplete:function(B){if(w._connection.get("to")===B.id){u.AlertManager.add({className:"error",message:x})}else{w._logger.log("Selected object: "+B.id+" is fetched from DB");y(B.id)}}})}},_showDialog:function k(){var H=this,w,F,G=s.getNLSValue("ReplaceCapableResourceCmd.DialogTitle"),E=s.getNLSValue("ReplaceCapableResourceCmd.FormPlaceHolder"),z=s.getNLSValue("ReplaceCapableResourceCmd.SEARCH"),y=s.getNLSValue("ReplaceCapableResourceCmd.CANCEL"),I=s.getNLSValue("ReplaceCapableResourceCmd.SearchTitle"),A,C,x,B,D;if(f.is(H.dialog)){H.dialog.destroy();H.dialog=null}w=new i({className:"MGA-DELWebMfgAssetsDefUICommands-ReplaceCapableResourceCmd-Form vertical",grid:"4 8",fields:[{type:"text",name:"search",required:true,placeholder:E,}]});F=f.createElement("div");A=function A(){H._search.activate(I,null,[w.getValue("search")],false);H.dialog.destroy();H.dialog=null};C=function C(){H.dialog.destroy();H.dialog=null};x=new o({value:z,className:"primary",icon:"search",}).inject(F);x.addEvent("onClick",A);B=new o({value:y,className:"default"}).inject(F);B.addEvent("onClick",C);this.dialog=new b({className:"MGA-DELWebMfgAssetsDefUICommands-ReplaceCapableResourceCmd-Dialog",header:G,closable:true,body:w,footer:F,events:{onHide:C,}});D=this.dialog.getContent();D.setAttribute("tabIndex","0");D.addEventListener("keydown",function(J){if(J.keyCode===13){if(J.target.type==="button"){J.target.triggerEvent("click")}else{A()}}else{if(J.keyCode===27){C()}}});this.dialog.inject(widget.body);this.dialog.getBody().setStyle("max-height",u.getPopUpMaxHeight()-200);this.dialog.show()},});return c});define("DS/DELWebMfgAssetsDefUICommands/SearchDocumentCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/DocumentUtility","DS/DELWebMfgAssetsDefDocumentModel/DocumentModelUtility","DS/DELWebMfgAssetsDefModelServices/LoggerUtils","DS/DELWebMfgAssetsDefModelServices/ModelPreferences","DS/DELWebMfgAssetsDefUIServices/Search"],function(g,a,i,m,j,c,l,h,q,f,b,e,d){var k=a.extend({_search:null,init:function p(r){this._parent(r,{mode:"exclusive",isAsynchronous:false});this._search=new d(this.onSearchObjectSelected.bind(this))},beginExecute:function o(){this._search.activate(h.getNLSValue("SearchDocumentCmd.SearchTitle"),["Document"],null)},onSearchObjectSelected:function n(r){var t,s;t=l.getSelectedRefs();if(t.length===1){s=t[0];r.forEach(function(u){var x=s.get("PID"),w=u.id,y=u["ds6w:label"];var z=h.getNLSValue("SearchDocumentCmd.LogMessage",{title:y}),v=b.getNextIndex();b.logStarted(v,z);q.getDocumentInfo(w,{onComplete:function(C){var B=C.data[0];var A={onComplete:function(){f.addDocumentToCollection(B);if(g.is(z)){b.logCompleted(v,z)}f.addDocumentConnectionToCollection(x+"|"+B.id,B.id,x);q._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("DocumentMgmtUI.UploadDocSucceeded",{document:B.dataelements.title})})},onFailure:function(D){if(g.is(z)){b.logFailed(v,z)}q._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("DocumentMgmtUI.UploadFailed",{message:g.Json.encode(D.message)})})}};if(e.PPRTypes[B.type]!=="DOCUMENT"){q._uiUtils.AlertManager.add({className:"info",message:h.getNLSValue("DocumentMgmtUI.SelectionNotSupported",{type:B.type})})}else{q.linkWithDocumentID(x,w,A)}}})})}}});return k});define("DS/DELWebMfgAssetsDefUICommands/InsertCmd",["UWA/Core","UWA/Utils","UWA/Class/Options","DS/Logger/Logger","DS/ApplicationFrame/Command","DS/Core/Events","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefUIControls/NewUI","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelPreferences","DS/DELWebMfgAssetsDefModelServices/CollectionUtils"],function(b,c,l,q,f,i,a,d,r,s,p,k,e){var j=f.extend(l,{name:"InsertCmd",_logger:null,_context:null,init:function n(t){var u;this._parent(t,{mode:"exclusive",isAsynchronous:false});if(b.is(q)){this._logger=q.getLogger(j)}u=this.getOption("context");if(b.is(u)){this._context=u}},_started:function g(){i.publish({event:this._evtID+"/STARTED",})},_completed:function m(t){if(b.is(t)){a.setForceDBMode(true)}i.publish({event:this._evtID+"/COMPLETED",data:t})},createReference:function h(C){var x=this,t=this._context,K=e.getSelectedRefs()[0],z,F,u,w,I,B,E=p.getNLSValue("InsertCmd.CreateInstanceFailure"),J=p.getNLSValue("InsertCmd.CreateReferenceFailure"),y;this._started();if(b.is(K)){z=K.id;if(b.is(t)&&b.is(z,"string")){if(b.is(t.getView)){w=t.getView();B=w.getDocument().getNodeModel({searchReferencePID:z,});B.forEach(function(L){L.setState({state:"expandingState"})},this)}}y=widget.getValue("oneDelmiaAggregationMode");F={isAggregatedBy:z,oneDelmiaAggregationMode:y==="true"};for(I in C){if(C.hasOwnProperty(I)){F[I]=C[I]}}e.instances.create(null,{proxy:"passport",wait:true,headers:a.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),queriedForConnections:true,data:b.Json.encode(F),onFailure:function A(M,L){if(b.is(L)){if(b.is(L.message,"string")){E+="\n"+L.message}}r.AlertManager.add({className:"error",message:E});x._completed()},onComplete:function H(M){var L=p.getNLSValue("InsertCmd.CreateInstanceSuccess",{name:M.get("PLM_ExternalID")});r.AlertManager.add({className:"success",message:L});x._completed(M)},onTimeout:function v(L){if(b.is(L)){if(b.is(L.message,"string")){E+="\n"+L.message}}r.AlertManager.add({className:"error",message:E});x._completed()},logMessage:p.getNLSValue("InsertInstanceCmd.LogMessage",{title:C.V_Name,type:C.type})})}else{u={};for(I in C){if(C.hasOwnProperty(I)){u[I]=C[I]}}e.references.create(null,{proxy:"passport",wait:true,headers:a.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),queriedForDocuments:true,queriedForChildren:true,queriedForConnections:true,data:b.Json.encode(u),onFailure:function D(){r.AlertManager.add({className:"error",message:J});x._completed()},onComplete:function G(L){var N=p.getNLSValue("InsertCmd.CreateReferenceSuccess",{name:L.get("PLM_ExternalID")}),M;if(b.is(x._displayedInTableView,"array")){M=L.get("PPRTYPE");if(b.is(M,"string")){if(-1<x._displayedInTableView.indexOf(M)){L.setDisplayModel({asRootInTableView:true})}else{L.setDisplayModel({asRootInAuxiliaryView:true});widget.dispatchEvent("onShowAuxView",[{PPRType:L.get("PPRTYPE")}])}}}r.AlertManager.add({className:"success",message:N});x._completed(L)},logMessage:p.getNLSValue("InsertCmd.LogMessage",{title:C.V_Name,type:C.type})})}},beginExecute:function o(){var y=this.getArguments(),w=this,u="",v,x,z,t;if(b.is(y,"array")){z=y.length;if(0<z){y.forEach(function(A){if(!b.is(A)){return}if(!b.is(A.ID,"string")){return}if(!b.is(A.Value,"string")){return}if("ReferenceType"===A.ID){u=A.Value}if("PPRType"===A.ID){this._pprType=A.Value}if("DisplayedInTableView"===A.ID){if(!b.is(this._displayedInTableView,"array")){this._displayedInTableView=[]}this._displayedInTableView.push(A.Value)}},this)}}if(!b.is(this._displayedInTableView,"array")){this._displayedInTableView=["SYSTEM","OPERATION"]}v=u.split("/")[0];x=u.split("/")[1]||"";if(s.getShowDialog()){a.getXMLValues("DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIInsertCmdFormAttribute",function(A){var B=function B(){var D=[],E=k.getTypeHierarchy(x),F=function F(J,I){var H=J.label.toLowerCase(),G=I.label.toLowerCase(),K=0;if(H<G){K=-1}else{if(H>G){K=1}}return K};if(b.is(E,"array")){E.forEach(function C(G){if(G!==x){D.push({label:p.getNLSValue(G,null,"Type"),value:G,selected:false})}});D.sort(F)}D.unshift({label:p.getNLSValue(x,null,"Type"),value:x,selected:true});d.showDialog(v,x,D,w.createReference,w)};s.InsertCmdFormAttribute=A;B()})}else{t={V_Type:u,V_Name:x,type:x};if(b.is(this._logger)){this._logger.log("Create object without dialog: ");this._logger.log(t)}this.createReference(t)}}});return j});define("DS/DELWebMfgAssetsDefUICommands/PPRReplaceByExistingRevisionCmd",["UWA/Core","UWA/Class/Options","DS/ApplicationFrame/Command","DS/Logger/Logger","DS/UIKIT/Form","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/BIUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/Search"],function(d,n,j,t,f,a,k,s,l,c,b,i,u,r,g){var p=j.extend(n,{name:"PPRReplaceByExistingRevisionCmd",_logger:null,_search:null,_mbomTreeListView:null,_context:null,init:function o(v){this._parent(v,{mode:"exclusive",isAsynchronous:false});this._logger=t.getLogger(p);this._context=this.getOption("context");if(!this._context){this._logger.warn("ERROR: No context.");return}this._search=new g(this.onSearchObjectSelected.bind(this));if(d.is(v.arguments)){if(v.arguments.length>0){if(v.arguments[0].ID==="Restriction"){this._restriction=v.arguments[0].Value}}}},beginExecute:function q(){this._mbomTreeListView=this._context.getMBOMTreeListView();if(!this._mbomTreeListView.getDocument().areRelationsLoaded(this._mbomTreeListView.getDocument().getXSO().get())){s.AlertManager.add({className:"error",message:r.getNLSValue("Error.RelationsNotLoaded.Title")});return}this._showDialog()},onSearchObjectSelected:function e(y){var v=this,x=y[0].id,w;w=new l({PID:x});w.fetch({proxy:"passport",type:"json",headers:c.getHeaders(),wait:true,onComplete:function(I){var F,L,G,H,J,C,E,K,D,z=i.references.add(I);F=v._mbomTreeListView.getDocument();L=F.getXSO().get()[0];G=L.getInstancePID();H=L.getParent();J=H.getReferencePID();K=L.getFirstParentWithAScopeNode();if(d.is(K)){C=K.getScopes();if(C.length!==0){E=C[0].to}}c.webServiceRequest({url:"modeler/ppr/isReadOnly",method:"GET",data:{pid:J},onComplete:function B(M){var O={instancePID:G,existingRefPID:x};if(M.isReadOnly){v._displayError("Error.ReplaceByExistingParentNotInReadWrite.Title");return}if(L.isScoped()&&d.is(E)){O.scopedParentPrdRefID=E}N=function N(){c.webServiceRequest({url:"modeler/ppr/replaceByExisting",method:"POST",data:d.Json.encode(O),onComplete:function Q(V){var R=[],U=[],S=[],T;console.log("replaced reference :"+V);V.instancesAndReferences.forEach(function(X){var W=X.attributesValue;if(W.hasOwnProperty("isInstanceOf")){W.queriedForConnections=true;R.push(W)}else{U.push(W)}});V.connections.forEach(function(X){var W=i.parseConnection(X);S.push(W)});T=function T(){i.addToCollections({stackedReferences:U,stackedInstances:R,stackedConnections:S,deletedObjects:V.deletedObjects,onComplete:function(){var W,X;W=i.references.get(x);if(W){u.fillConnectionModelInfo(W)}v._mbomTreeListView.utils.fillReferenceTreeNode(H);if(!H.isExpanded()){H.expand()}if(L.isExpanded()){X=v._mbomTreeListView.getDocument().getNodeModel(W.id)[0];X.expand()}if(b.getCurrentBICmdState()){b.computeBIStatus()}s.AlertManager.add({className:"success",message:r.getNLSValue("ReplaceByExisting.Success")})}})};i.getDescendantsFromServer(x,T)},onFailure:function P(T,S,R){var U="Error.ReplaceByExistingError.Title";console.log("jsonData: "+T+" error:"+S+" options: "+R);if(d.is(S)&&d.is(S.message)&&S.message==="replaceMfgItemScopedWithDifferentProduct"){U="Error.ReplaceByExistingScopeExists.Title"}s.AlertManager.add({className:"error",message:r.getNLSValue(U)})}})};i.getConnectionsByModel(z,null,null,true,N)},onFailure:function A(O,N,M){console.log("jsonData: "+O+" error:"+N+" options: "+M);v._displayError("Error.ReplaceByExistingError.Title")}})}})},_showDialog:function h(){var G=this,v,E,F=r.getNLSValue("PPRReplaceByExistingRevision.DialogTitle"),D=r.getNLSValue("PPRReplaceByExistingRevision.FormPlaceHolder"),y=r.getNLSValue("PPRReplaceByExistingRevision.SEARCH"),x=r.getNLSValue("PPRReplaceByExistingRevision.CANCEL"),H=r.getNLSValue("PPRReplaceByExistingRevision.SearchTitle"),z,B,w,A,C;if(d.is(G.dialog)){G.dialog.destroy();G.dialog=null}v=new f({className:"MGA-DELWebMfgAssetsDefUICommands-InsertInstanceCmd-Form vertical",grid:"4 8",fields:[{type:"text",name:"search",required:true,placeholder:D,}]});E=d.createElement("div");z=function z(){G._search.activate(H,null,[v.getValue("search")],false);G.dialog.destroy();G.dialog=null};B=function B(){G.dialog.destroy();G.dialog=null};w=new k({value:y,className:"primary",icon:"search",}).inject(E);w.addEvent("onClick",z);A=new k({value:x,className:"default"}).inject(E);A.addEvent("onClick",B);this.dialog=new a({className:"MGA-DELWebMfgAssetsDefUICommands-InsertInstanceCmd-Dialog",header:F,closable:true,body:v,footer:E,events:{onHide:B,}});C=this.dialog.getContent();C.setAttribute("tabIndex","0");C.addEventListener("keydown",function(I){if(I.keyCode===13){if(I.target.type==="button"){I.target.triggerEvent("click")}else{z()}}else{if(I.keyCode===27){B()}}});this.dialog.inject(widget.body);this.dialog.getBody().setStyle("max-height",s.getPopUpMaxHeight()-200);this.dialog.show()},_displayError:function m(v){s.AlertManager.add({className:"error",message:r.getNLSValue(v),})}});return p});define("DS/DELWebMfgAssetsDefUICommands/ExportCSVCmd",["UWA/Core","DS/Core/Events","DS/Logger/Logger","DS/UIKIT/Form","DS/UIKIT/Modal","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefUIServices/TableViewPreferences","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils"],function(d,k,r,f,a,i,l,q,p,c,h){var b=i.extend({name:"ExportCSVCmd",_preferences:null,_logger:null,init:function n(t){this._parent(t,{mode:"exclusive",isAsynchronous:false});if(d.is(r)){this._logger=r.getLogger(b)}if(d.is(t.arguments)){if(t.arguments.length>0){if(t.arguments[0].ID==="Preferences"){this._preferences=t.arguments[0].Value;c.getXMLValues(this._preferences)}}}},_getMainView:function s(){var t;if("MFN"===q._widgetTrigram){t=q._myWidget.getMBOMView().treeListView}else{t=q.getMGAElement("TableUI")}return t},_getVisibleTableContentAsCSV:function g(u){var F=l.getTableViewLabelColumn(),t=l.getTableViewColumns().slice(0),I,B,G,D,H,C,E=this._getMainView(),y=E.utils._treeList.getManager(),A=y.getNumberOfRows(),w=[],v="\r\n",z='"'+p.getNLSValue("ExportCSVCmd.DepthColumnName")+'"';z+=u+'"'+q.getColumnDisplayValue(F)+'"';for(H=0;H<t.length;H++){if(!y.isColumnHidden(t[H].dataIndex)){z+=u+'"'+q.getColumnDisplayValue(t[H])+'"';w.push(t[H].dataIndex)}}z+=v;for(D=0;D<A;D++){C=y.getTreeNodeModelFromRowID(D);z+=C._nodeDepth;z+=u+'"'+C.getLabel().replace(/"/g,'""')+'"';for(H=0;H<w.length;H++){I=C.options.grid[w[H]];if(d.is(I)){if(I instanceof Array){G="";for(var x=0;x<I.length;x++){if(x!==0){G+=","}B=I[x];if(d.is(B.Value)){G+=B.Value}else{G+=B.toString()}}}else{G=I.toString()}}else{G=""}z+=u+'"'+G.replace(/"/g,'""')+'"'}z+=v}return z},_getAllRefsInTableViewInDisplayOrder:function e(){var x=[],u=this._getMainView(),v=u.utils._treeList.getManager(),t=v.getNumberOfRows(),y,w;for(y=0;y<t;y++){w=v.getTreeNodeModelFromRowID(y);x.push(w.getReferencePID())}return x},_getConfiguredAttributesAsCSV:function j(t,u){var D=[],z,y,v,C,w="\r\n",B,x="";function A(F){return t.hasOwnProperty(F)}function E(F,H){var I,G;I=t[H].Attribute;for(G=0;G<I.length;G++){C=I[G].name;if(C===F){return true}}return false}for(z in t){y=t[z].Attribute;for(v=0;v<y.length;v++){C=y[v].name;if(D.indexOf(C)==-1){D.push(C)}}}for(B=0;B<D.length;B++){if(B!==0){x+=u}x+='"'+D[B]+'"'}x+=w;this._getAllRefsInTableViewInDisplayOrder().forEach(function(F){var H,G,I;H=h.references.get(F);if(d.is(H)){z=H.get("type");if(A(z)){for(B=0;B<D.length;B++){if(B!==0){x+=u}G=D[B];if(E(G,z)&&H.get(G)!==undefined){I=String(H.get(G))}else{I=""}x+='"'+I.replace(/"/g,'""')+'"'}x+=w}}});return x},_completed:function m(){k.publish({event:this._evtID+"/COMPLETED"})},beginExecute:function o(){var t=this;function u(z,x,w){var y=document,v=y.createElement("a");if(!d.is(z)){return}if(!d.is(x)){return}if(!d.is(w)){return}w=w||"application/octet-stream";if(navigator.msSaveBlob&&!t.odtMode){return navigator.msSaveBlob(new Blob([z],{type:w}),x)}v.href="data:"+w+","+encodeURIComponent(z);("download" in v)?(v.download=x):(v.target="_blank");v.style.cssText="visibility: hidden";y.body.appendChild(v);setTimeout(function(){v.click();y.body.removeChild(v)},66)}if(d.is(this._preferences)){c.getXMLValues(this._preferences,function(F){var y=F.convert("Config.Preferences.ExportCSV.Type","name"),I=F.Config.Preferences.ExportCSV.showOptionPanel,H=F.Config.Preferences.ExportCSV.defaultValue,A=F.Config.Preferences.ExportCSV.columnSeparator||",",C=false,E,w,v,x,z,D,B;function G(){if(d.is(y)&&C){B=t._getConfiguredAttributesAsCSV(y,A)}else{B=t._getVisibleTableContentAsCSV(A)}u(B,"MGA "+(new Date()).toString().split(" ").splice(1,4).join(" ")+".csv","text/csv");t._completed()}if(I){v=p.getNLSValue("ExportCSVCmd.Header");x=p.getNLSValue("ExportCSVCmd.OK");z=p.getNLSValue("ExportCSVCmd.CANCEL");D=p.getNLSValue("ExportCSVCmd.ExportAllQuestion");E=new a({header:v,closable:true,});E.inject(widget.body);w=new f({className:"MGA-DELWebMfgAssetsDefUICommands-ExportCSV-Form",fields:[{type:"boolean",name:"ExportAllAttributes",label:D,value:H}],buttons:[{type:"submit",value:x},{type:"reset",value:z}],events:{onSubmit:function(){C=this.getValue("ExportAllAttributes")==="true";E.hide();G()},onReset:function(){E.hide()}}});E.setBody(w);E.show()}else{C=H;G()}})}else{this._logger.warn("Tools_exportCSV needs an xml configuration file")}},});return b});define("DS/DELWebMfgAssetsDefUICommands/ManageDocumentsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefUIControls/DocumentMgmtUI"],function(g,b,c,d){var e=b.extend({init:function f(h){this._parent(h,{mode:"exclusive",isAsynchronous:false})},beginExecute:function a(){var h=c.getSelectedRefs()[0];d.manageDocuments(h.id)}});return e});define("DS/DELWebMfgAssetsDefUICommands/ShowGraphViewCmd",["UWA/Core","DS/Core/Events","DS/ApplicationFrame/CommandCheckHeader","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIGraphView/GraphView","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefUIServices/CommandsManager"],function(h,e,g,a,b,d,c){var f=g.extend({init:function(i){a.CommandsCheckHeaderManager.registerCmd(i.ID,this);this._parent(i,{});this.onStateChange(function j(){var l=a.getMGAElement("SlidingViews"),k;if(this.getState()){c.setCommandState("ShowLinksFilterMenu",true);l.goToNthView(1);k=new b({renderTo:a.getMGAElement("SlidingViews").getView(1),referenceCollection:d.references,instanceCollection:d.instances,connectionCollection:d.connections})}else{c.setCommandState("ShowLinksFilterMenu",false);l.goToNthView(0)}})}});return f});define("DS/DELWebMfgAssetsDefUICommands/EditCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/ApplicationFrame/CommandsManager","DS/Core/Events","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils"],function(g,f,c,d,a,b){var e=f.extend({name:"EditCmd",init:function(h){var i=(widget.getValue("forceDBModePreferences")==="true")?true:false;this._parent(h,{});a.CommandsCheckHeaderManager.registerCmd(h.ID,this);this.setState(i);this.onStateChange(function(j){b.setForceDBMode(j)})}});return e});define("DS/DELWebMfgAssetsDefUICommands/DuplicateAdvCmd",["UWA/Core","DS/Core/Events","DS/Logger/Logger","DS/UIKIT/Form","DS/UIKIT/Modal","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefUIServices/TreeListUtils","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefDocumentModel/DocumentModelUtility","DS/DELWebMfgAssetsDefModelServices/DocumentUtility"],function(d,l,s,e,a,i,f,m,r,b,n,t,u,v,k){var h=i.extend({name:"DuplicateAdvCmd",_preferences:null,_logger:null,init:function o(x){this._parent(x,{mode:"exclusive",isAsynchronous:false});if(d.is(s)){this._logger=s.getLogger(h)}if(d.is(x.arguments)){if(x.arguments.length>0){if(x.arguments[0].ID==="Preferences"){this._preferences=x.arguments[0].Value;b.getXMLValues(this._preferences)}}}},_completed:function c(){b.setForceDBMode(true);l.publish({event:this._evtID+"/COMPLETED"})},_createDuplicateAdv:function q(L){var B=this,A,D,C,G,H,z,x,F,E=d.is(t.getMGAElement("TableUI"))?t.getMGAElement("TableUI").utils:null,y=d.is(t.getMGAElement("TreeUI"))?t.getMGAElement("TreeUI").utils:null,I=d.is(E)?E.getSelectedOccurencePaths():[],J=d.is(y)?y.getSelectedOccurencePaths():[],K=I.concat(J);B._simplifyPaths(K);A=B._getLeafReferencePIDs(K);D=d.is(E)?E.getExpandedStructureUnderSelections(A):[];C=d.is(y)?y.getExpandedStructureUnderSelections(A):[];G=D.concat(C);B._simplifyExpands(G);L.pathList=K;L.expandList=G;H=d.Json.encode(L);z=function z(M){var P=[],O=[],N=[];if(d.is(M)&&!d.is(M.error)){M.instancesAndReferences.forEach(function(S){var Q=S.attributesValue,T,R;if(Q.hasOwnProperty("isInstanceOf")){R=f.instances.get(Q.PID);if(!d.is(R)){O.push(S);P.push(Q.isInstanceOf)}}else{T=f.references.get(Q.PID);if(!d.is(T)){N.push(S)}}});N.forEach(function(S){var R=S.attributesValue,Q=S.attributesDef,T;T=f.references.get(R.PID);if(!d.is(T)){T=f.references.add(S)}else{R=T.setTypeAndPPRTYPE(R);T.set(R);T.setDisplayModel({attributesDef:Q},{silent:true})}T.set("queriedForChildren",true);T.set("queriedForConnections",true);if(P.indexOf(R.PID)===-1){l.publish({event:"DELWebMfgAssetsDefUI/asRootInView",data:{rootPLMID:R.PID}})}});O.forEach(function(T){var R=T.attributesValue,Q=T.attributesDef,S;S=f.instances.get(R.PID);if(!d.is(S)){R=d.extend(R,{queriedForConnections:true});S=f.instances.add(T)}else{S.set(R);S.set("queriedForConnections",true);S.setDisplayModel({attributesDef:Q},{silent:true})}});M.connections.forEach(function(Q){var R=f.parseConnection(Q);if(!f.connections.get(R.PID)){f.connections.add(R)}});N.forEach(function(S){var R=S.attributesValue,T,Q;T=f.references.get(R.PID);u.fillConnectionModelInfo(T);if(!T.get("queriedForDocuments")){T.set("queriedForDocuments",true);Q=M.documents[T.id];if(Q.length>0){k.getDocumentInfo(Q,{onComplete:function U(Y){var X=0,V=Y.data,W=[];for(X=0;X<V.length;X++){k.collectionUtils.documents.add(V[X],{silent:true});k.collectionUtils.documentsConnection.add({ID:T.id+"|"+V[X].id,irpcID:T.id,docID:V[X].id},{silent:true});W.push(V[X].id)}v.appendDocIDsToDisplayModel(T,W)}})}}});O.forEach(function(S){var Q=S.attributesValue,R;R=f.instances.get(Q.PID);u.fillConnectionModelInfo(R)});t.AlertManager.add({className:"success",message:r.getNLSValue("DuplicateAdvCmd.Success")})}};x=function(M){t.AlertManager.add({className:"error",message:r.getNLSValue("DuplicateAdvCmd.Failure")});B._logger.warn("Lifecycle_createDuplicateAdv FAILED: "+M)};b.webServiceRequest({url:"modeler/ppr/advancedClone",method:"POST",headers:b.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),data:H,onComplete:z,onFailure:x,onTimeout:F,logMessage:r.getNLSValue("DuplicateAdvCmd.LogMessage")})},_simplifyPaths:function j(D){var C,A,E,B,z,y,x;for(z=0;z<D.length;z++){C=D[z].path;for(y=0;y<D.length;y++){if(y!==z){A=D[y].path;if(C.length<=A.length){for(x=0;x<C.length;x++){E=C[x];B=A[x];if(E.refPID!==B.refPID||E.instPID!==B.instPID){break}}if(x===C.length){D.splice(z--,1);break}}}}}},_getLeafReferencePIDs:function w(B){var A,x,z,y=[];for(z=0;z<B.length;z++){A=B[z].path;x=A[A.length-1];y.push(x.refPID)}return y},_simplifyExpands:function g(z){var B,A,y,x;for(y=0;y<z.length;y++){B=z[y];for(x=y+1;x<z.length;x++){A=z[x];if(B.refPID===A.refPID&&B.instPID===A.instPID){z.splice(x,1)}}}},beginExecute:function p(){var J=this,y,E,G,x=r.getNLSValue("DuplicateAdvCmd.Header"),A=r.getNLSValue("DuplicateAdvCmd.OK"),C=r.getNLSValue("DuplicateAdvCmd.CANCEL"),F=new a({header:x,closable:true,}),I,H,z=[],B=function(){var K=[];if(I.isDisplayed){K.push({type:"text",name:"Prefix",label:r.getNLSValue("DuplicateAdvCmd.Prefix"),value:I.defaultValue})}for(E in H){if(H.hasOwnProperty(E)){z.push(E);G=H[E];if(G.isDisplayed){K.push({type:"boolean",name:E,label:r.getNLSValue("DuplicateAdvCmd."+E),value:G.defaultValue})}}}return K},D=function(){y=new e({className:"MGA-DELWebMfgAssetsDefUICommands-DuplicateAdvCmd-Form",fields:B(),buttons:[{type:"submit",value:A},{type:"reset",value:C}],events:{onSubmit:function(){var L=this;var K={};if(I.isDisplayed){K.Prefix=this.getValue("Prefix")}else{K.Prefix=I.defaultValue}z.forEach(function(N){var M;var O=H[N];if(O.isDisplayed){M=L.getValue(N)==="true"}else{M=O.defaultValue}K[N]=M});J._createDuplicateAdv(K);F.hide();J._completed()},onReset:function(){F.hide()}}});F.setBody(y);F.show()};F.inject(widget.body);if(d.is(this._preferences)){b.getXMLValues(this._preferences,function(K){I=K.Config.Preferences.DuplicateAdvanced.PrefixOption;H=K.convert("Config.Preferences.DuplicateAdvanced.LinkOption","name");if(K.Config.Preferences.DuplicateAdvanced.showOptionPanel){D()}else{var L={};L.Prefix=I.defaultValue;for(E in H){if(H.hasOwnProperty(E)){L[E]=H[E].defaultValue}}z.forEach(function(M){L[M]=G.defaultValue});J._createDuplicateAdv(L);J._completed()}})}else{this._logger.warn("Lifecycle_createDuplicateAdv needs an xml configuration file")}}});return h});define("DS/DELWebMfgAssetsDefUICommands/RelationalExplorerCmd",["UWA/Core","UWA/Utils","DS/Logger/Logger","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/Selection","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","UWA/Utils/InterCom"],function(e,i,d,c,o,j,b,m){var l=null;var g=c.extend({name:"RelationalExplorerCmd",_logger:null,init:function n(p){var q=this;this._parent(p,{mode:"shared",isAsynchronous:true});this._logger=this._logger?this._logger:d.getLogger(g);function r(){q.enable()}r()},setObjectOnCompass:function h(q){var p=e.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket",r=null;this._logger.log("setObjectOnCompass");if(!e.is(q.nodesToOpen,"array")){throw new Error("setObjectOnCompass: Invalid init parameter nodesToOpen")}if(l===null){l=new m.Socket(p);l.subscribeServer("com.ds.compass",window.parent)}if(q.nodesToOpen.length===0){l.dispatchEvent("onResetX3DContent",{},p)}else{r=this.dropdataFromSelectedNodes(q.nodesToOpen);l.dispatchEvent("onSetX3DContent",r,p)}},openApp:function f(q,s){var p=e.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";this._logger.log("open_app");if(l===null){l=new m.Socket(p);l.subscribeServer("com.ds.compass",window.parent)}l.addListener("launchApp",function r(t){if(e.is(s,"function")){s(t)}});l.dispatchEvent("onLaunchApp",q,p)},dropdataFromSelectedNodes:function a(q){var r={protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:[]}};var p=function p(t){var u=widget.data;return{envId:b.getPlatformId({serviceId:b.get3DSpaceServiceName()}),serviceId:"3DSpace",contextId:[u.role,u.organization,u.collaborativeSpace].join("."),objectId:t.getID(),objectType:t.options.type,displayName:t.options.display?t.options.display:t.getLabel(),displayType:t.options.grid["ds6w:type"],path:t.getOccurencePathWithType?t.getOccurencePathWithType():null}};q.forEach(function s(t){r.data.items.push(p(t))});return r},execute:function k(){var r,q=o.getActionBarContext();this._logger.log("Execute");r=q.getSelectedNodes();this.setObjectOnCompass({nodesToOpen:r});this.openApp({appId:"ENORIPE_AP"},function p(){})}});return g});define("DS/DELWebMfgAssetsDefUICommands/EditTVColumnsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIControls/EditTVColumnsUI","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIServices/TableViewPreferences"],function(e,c,g,f,b,k,d,i){var a=c.extend({name:"EditTVColumnsCmd",init:function j(l){this._parent(l,{mode:"exclusive",isAsynchronous:false})},beginExecute:function h(){var p,r,v=this,u,m,o,l=b.getNLSValue("EditTVColumnsCmd.OK"),n=b.getNLSValue("EditTVColumnsCmd.CANCEL"),t=b.getNLSValue("EditTVColumnsCmd.TITLE"),s=e.createElement("div");p=function p(){var z=v._editTVColumnsUI._tableViewColumns,C=v._editTVColumnsUI._leftViewColumns,y=v._editTVColumnsUI._rightViewColumns,B=v._editTVColumnsUI._widgetLayoutValues,x=v._editTVColumnsUI.trigram,A,w=v._editTVColumnsUI._tabView.selectedTab.getId(),D=v._editTVColumnsUI.preferencesGrid.getManager();switch(w){case"bottom-block":if(!e.is(z)){z=i.getTableViewColumns()}z=v._editTVColumnsUI.getColumnOrder(z,D);break;case"left-block":if(!e.is(C)){C=i.getLeftViewColumns()}C=v._editTVColumnsUI.getColumnOrder(C,D);break;case"right-block":if(!e.is(y)){y=i.getRightViewColumns()}y=v._editTVColumnsUI.getColumnOrder(y,D);break;case"widget-layout-block":if(e.is(B.Columns)){if(x==="MFN"){widget.dispatchEvent("DELWebMfgItemDefUI/editWidgetLayout",B.Columns)}else{if(x==="MGA"){u(B.Columns)}}}B=v._editTVColumnsUI.getWidgetLayout(B,D);break;default:break}if(e.is(z)){if(z.isChanged===true){i.setViewPreference("TableView",z.Columns);A=d.getMGAElement("TableUI").getManager();m(z,A)}}if(e.is(C)){if(C.isChanged===true){i.setViewPreference("LeftBloc",C.Columns);A=d.getMGAElement("LeftUI").getManager();m(C,A)}}if(e.is(y)){if(y.isChanged===true){i.setViewPreference("RightBloc",y.Columns);A=d.getMGAElement("RightUI").getManager();m(y,A)}}if(e.is(B)){if(B.isChanged===true){i.setViewPreference("Widget Layout",B.Columns);if(x==="MFN"){widget.dispatchEvent("DELWebMfgItemDefUI/editWidgetLayout",B.Columns)}else{if(x==="MGA"){u(B.Columns)}}}}r()};u=function u(y){var x,z,w;for(x in y){switch(x){case"AV":w="showAuxiliaryView";break;case"LV":w="LeftBlock";break;case"RV":w="RightBlock";break;case"TV":w="BottomBlock";break;case"GV":if(y[x]){d.CommandsCheckHeaderManager.getCmd("BottomBlock").setState(true)}w="ShowGraphView";break;default:break}z=d.CommandsCheckHeaderManager.getCmd(w);if(y[x]===true){z.setState(true)}else{z.setState(false)}}};m=function m(z,w){var y,D,B,A,C,x;B=w.getColumnIDFromDataIndex("tree")+1;for(y=0;y<z.Columns.length;y++){D=z.Columns[y];C=D.width;x=D.minWidth;A=w.getColumnIDFromDataIndex(D.dataIndex);if(D.display===true){if(w._listOfColumnsPreviousWidth[A]===0){w._listOfColumnsPreviousWidth[A]=100}C=isNaN(C)?"auto":parseInt(C);x=isNaN(x)?"100":parseInt(x);w.showColumn(A);w.setColumnOptions(A,{width:C,minWidth:x});w.moveColumn(A,B)}else{w.hideColumn(A)}B++}};r=function r(){v._dialogModel.destroy();v._dialogModel=null};new f({value:l,className:"btn btn-primary",events:{onClick:p}}).inject(s);new f({value:n,className:"btn btn-default",events:{onClick:r}}).inject(s);if(e.is(this._dialogModel)){r()}this._editTVColumnsUI=new k();if(e.is(this._ctx.name)&&"MfgItemWidget"===this._ctx.name){if(e.is(this._ctx.isActionViewOpen)){if(false===this._ctx.isActionViewOpen()){try{this._editTVColumnsUI._tabView.elements.tabList.getElementsByClassName("uwa-tab")[2].remove()}catch(q){}}}o=this._ctx.getFocusTab();if("LeftUI"===o){this._editTVColumnsUI._tabView.options.selectedTab=1}else{if("TableUI"===o){this._editTVColumnsUI._tabView.options.selectedTab=0}else{if("RightUI"===o){this._editTVColumnsUI._tabView.options.selectedTab=2}}}}this._dialogModel=new g({className:"MGA-DELWebMfgAssetsDefUICommands-EditTVColumnsCmd-Dialog editViews-modal",header:t,closable:true,footer:s});this._dialogModel.inject(widget.body);this._dialogModel.setBody(this._editTVColumnsUI);this._dialogModel.show();this._editTVColumnsUI.setParentDialog(this._dialogModel)}});return a});define("DS/DELWebMfgAssetsDefUICommands/ShowAuxiliaryViewCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil","DS/DELWebMfgAssetsDefModelServices/ModelUtils"],function(f,d,a,e,b){var c=d.extend({init:function(i){var h,g=b.getWidgetTrigram();this._parent(i,{});a.CommandsCheckHeaderManager.registerCmd(i.ID,this);if(e.isViewPersistanceOn()){h=(widget.getValue(g+"ViewAuxiliary")==="true")?true:false;this.setState(h)}this.onStateChange(function(n){var j,m=a.getMGAElement("MainBlocLayout"),k=a.getMGAElement("TreeUI"),l=a.BlocksViewCmdManager;if(false===n){if(k){j=k.getManager().getDocument().getXSO();j.empty()}widget.setValue(g+"ViewAuxiliary","false");m.setColumnsWidth(0,[0],0,{minSize:0})}else{widget.setValue(g+"ViewAuxiliary","true");m.setColumnsWidth(0,[0],250)}})}});return c});define("DS/DELWebMfgAssetsDefUICommands/ExploreInWebAppCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/Selection","UWA/Class/Options","UWA/Utils/InterCom"],function(f,c,d,j,b,p,k,n){var m=null;var e=c.extend(k,{name:"ExploreInWebAppCmd",_logger:null,_selectedReference:null,init:function o(q){this._logger=d.getLogger(e);this._parent(q,{mode:"exclusive",isAsynchronous:false,})},setSelectedReference:function i(q){this._selectedReference=q},setObjectOnCompass:function h(r){var q=f.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket",s=null;this._logger.log("setObjectOnCompass");if(!f.is(r.nodesToOpen,"array")){throw new Error("setObjectOnCompass: Invalid init parameter nodesToOpen")}if(m===null){m=new n.Socket(q);m.subscribeServer("com.ds.compass",window.parent)}if(r.nodesToOpen.length===0){m.dispatchEvent("onResetX3DContent",{},q)}else{s=this.dropdataFromSelectedNodes(r.nodesToOpen);m.dispatchEvent("onSetX3DContent",s,q)}},openApp:function g(s,u){var q=f.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket",r=null;this._logger.log("open_app");if(r===null){r=new n.Socket(q);r.subscribeServer("com.ds.compass",window.parent)}r.addListener("launchApp",function t(v){if(f.is(u,"function")){u(v)}});r.dispatchEvent("onLaunchApp",s,q)},dropdataFromSelectedNodes:function a(r){var s={protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:[]}};var q=function q(u){var v=widget.data;return{envId:b.getPlatformId({serviceId:b.get3DSpaceServiceName()}),serviceId:"3DSpace",contextId:[v.role,v.organization,v.collaborativeSpace].join("."),objectId:u.id,objectType:u._attributes.type,displayName:u._attributes.V_Name,displayType:u._attributes.type,path:null}};r.forEach(function t(u){s.data.items.push(q(u))});return s},beginExecute:function l(){var s,r=b.get3DSpaceUrl(),q;this._logger.log("beginExecute");if(f.is(this._selectedReference)){q=this._selectedReference;this._selectedReference=null}else{q=j.getSelectedRefs()[0]}if(!f.is(q)){this._logger.error("selected model is empty");return}if(q.isPart()){s=r+"common/emxNavigator.jsp?appName=ENOENBO_AP&objectId="+q.id}else{s=r+"common/emxNavigator.jsp?appName=DELCPV_AP&objectId="+q.id}window.open(s)},});return e});define("DS/DELWebMfgAssetsDefUICommands/RefreshCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefDocumentModel/DocumentModelUtility","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils"],function(e,b,d,h,a,g,f,c){var j=b.extend({name:"RefreshCmd",init:function(k){this._parent(k,{mode:"exclusive",isAsynchronous:false})},beginExecute:function i(){var n=h.getSelectedRefs(),l=h.getSelectedInsts();l.forEach(function m(o){var p=widget.CollectionUtils.getImpactedConnections(o.id);if(e.is(p,"array")){p.forEach(function q(r){widget.CollectionUtils.connections.remove(r.id)})}});n.forEach(function k(o){var p,t=h.getInstancesFromCollection(o.id);if(e.is(t,"array")){t.forEach(function s(u){h.instances.remove(u);l.push(u)})}d.deleteDocIDsFromDisplayModel(o);p=widget.CollectionUtils.getImpactedConnections(o.id);if(e.is(p,"array")){p.forEach(function r(u){widget.CollectionUtils.connections.remove(u.id)})}o.fetch({proxy:"passport",type:"json",headers:a.getHeaders(),wait:true,queriedForDocuments:false,queriedForChildren:false,queriedForConnections:false,forceRefresh:true,onComplete:function q(v){h._getDescendantsFromDB(v.id,{callback:function u(){var w=f.getNLSValue("RefreshCmd.ReferenceSuccess",{name:v.get("V_Name")});c.AlertManager.add({className:"success",message:w})},expandLevel:1,withLinks:true,withLinksResolved:true})}})});l.forEach(function k(o){o.fetch({proxy:"passport",type:"json",headers:a.getHeaders(),wait:true,queriedForConnections:false,forceRefresh:true,onComplete:function p(){var q=f.getNLSValue("RefreshCmd.InstanceSuccess",{name:o.get("PLM_ExternalID")});c.AlertManager.add({className:"success",message:q})}})})}});return j});define("DS/DELWebMfgAssetsDefUICommands/ConfigCommandUtil",["UWA/Core","DS/Core/Events","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns"],function(h,f,b,d,a,g){var c=function c(k){var j=b.getWidgetTrigram();var s,p,i,l;s=function s(t){var u=false;if(h.is(t)){if(t.utils.view==="MBOM"||t.utils.view==="BODY"){u=true}}return u};p=function p(x){var u=[],w,t,v=[];if(h.is(x,"array")){u=x;if(u.length>0){t=d.getInstanceFromCollection(u[0]);if(h.is(t)){w=t.get("isAggregatedBy")}}}else{w=x}v=h.is(w)?[w]:[];u.forEach(function(y){v.push(y);t=d.getInstanceFromCollection(y);if(h.is(t)){v.push(t.get("isInstanceOf"))}});return v};i=function i(){var t,v,u=[];if(j==="MFN"){v=k.getFocusedView();if(s(v)){u=v.getDocument().getSelectedNodes()}}else{t=a.getMGAElement("TableUI");if(h.is(u)){u=t.getDocument().getSelectedNodes()}}return u};l=function l(){var u,t;if(j==="MFN"){u=k.getFocusedView();if(s(u)){t=u.utils.view}}else{t="ROUTINGS"}return t};return{getSelections:function q(){return i()},getViewId:function m(){return l()},getData:function n(){var t,v,u;t=this.getSelections();v=[];t.forEach(function(z){var y,w,x;x=z.isRoot();if(x){y={id:z.getReferencePID(),alias:z.getLabel(),isRoot:x}}else{w=z.getParent();y={id:z.getInstancePID(),alias:z.getLabel(),isRoot:x,VPMRef:z.options.referenceType,parentID:w.getReferencePID(),parentalias:w.getLabel()}}v.push(y)});u={selectedNodes:v};return u},transformToRIROccurrencePath:function r(t){return p(t)},updateEffectivityAttributes:function o(u,t){if(h.is(g)&&h.is(g.updateAttributes,"function")){g.updateAttributes(u,function v(w){f.publish({event:"changeEffectivity",data:{viewId:t,updatedAttributes:w}})})}}}};var e=(function e(){var i;return{getInstance:function j(k){if(!h.is(i)){i=new c(k)}return i}}})();return e});define("DS/DELWebMfgAssetsDefUICommands/LoadRelationsCmd",["UWA/Core","DS/Core/Events","DS/Logger/Logger","DS/UIKIT/Form","DS/UIKIT/Modal","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefUIServices/TableViewPreferences","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","UWA/Class/Options"],function(g,e,c,h,k,b,n,d,f,a,j,l){var i=b.extend(l,{name:"LoadRelationsCmd",_logger:null,_context:null,mbomTreeListView:null,init:function o(p){this._parent(p,{mode:"exclusive",isAsynchronous:false});if(g.is(c)){this._logger=c.getLogger(i)}this._context=this.getOption("context");if(!this._context){this._logger.warn("ERROR: No context.");return}},beginExecute:function m(){this._context.getMBOMTreeListView().utils.loadRelations()},});return i});define("DS/DELWebMfgAssetsDefUICommands/CapableResourceBLCmd",["DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefUIServices/CreateLinkUtil","DS/DELWebMfgAssetsDefUIServices/AbstractDragAndDropManager","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefUIServices/Search","UWA/Core","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/Resources","DS/Logger/Logger","DS/DELWebMfgAssetsDefUIServices/UIUtils","UWA/Class/Options","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefUIControls/LinksUI",],function(n,w,l,j,i,d,k,s,t,u,o,b,v,f){var q=k.extend(o,{name:"CapableResourceBL",_logger:null,_context:null,_search:null,init:function p(x){var y=this;y._logger=t.getLogger(q);y._parent(x,{mode:"exclusive",isAsynchronous:false,});y._context=y.getOption("context");y._search=new i(this.searchCallBack.bind(this))},beginExecute:function r(){this._logger.log("beginExecute")},execute:function h(){this._logger.log("execute");var x=j.getSelectedRefs()[0].id;b.webServiceRequest({url:"modeler/ppr/getResourcesFromBL",method:"POST",context:this,onComplete:this.getCapableResourceComplete,onFailure:this.getCapableResourceFailure,data:d.Json.encode({pid:x}),})},endExecute:function m(){this._logger.log("endExecute")},getCapableResourceComplete:function g(x){if(0===x.resourceIDS.length){u.AlertManager.add({className:"info",message:s.getNLSValue("Info.CapableResourceBL.Empty"),})}else{this._search.activate("Capable resource search",null,x.resourceIDS)}},getCapableResourceFailure:function e(x){this._logger.warn("ERROR: CapableResourceBL failed");this._logger.log(x);u.AlertManager.add({className:"error",message:s.getNLSValue("Error.CapableResourceBL.Failure"),})},searchCallBack:function c(y){var x=this;y.forEach(function(B){var z=j.references.get(B.id);if(!z){var A=new n({PID:B.id});A.fetch({proxy:"passport",type:"json",headers:b.getHeaders(),wait:true,onComplete:function(D,C){j.references.add(D);x.addToCapableResourceList(D)}})}else{x.addToCapableResourceList(z)}})},addToCapableResourceList:function a(y){var A=this;var C=j.getSelectedRefs({views:"ROUTINGS"})[0];if(d.is(C)&&(C.get("PPRTYPE")=="SYSTEM"||C.get("PPRTYPE")=="OPERATION")){var x={type:C.get("PPRTYPE")+"_DELAsmProcessCanUseCnx",IDFrom:C.id,IDTo:y.id};j.connections.create(null,{proxy:"passport",wait:true,headers:b.getHeaders(),data:d.Json.encode(x),onFailure:function z(D,E){u.AlertManager.add({className:"error",message:s.getNLSValue("CreateLinkUtil.LinkCreationFailure")});if(d.is(A._logger)){A._logger.warn("Create link error: "+d.Json.encode(E))}},onComplete:function B(D,F){var E=j.references.get(C.id),G=j.references.get(y.id);if(d.is(E)){v.fillConnectionModelInfo(E)}if(d.is(G)){v.fillConnectionModelInfo(G)}u.AlertManager.add({className:"success",message:s.getNLSValue("CreateLinkUtil.LinkCreationSuccess",{selectedDisplayedType:s.getNLSValue("DELAsmProcessCanUseCnx"),targetLabel:u.getLabelValue(E),draggedLabel:u.getLabelValue(G)})});f.updateUI(D)},logMessage:s.getNLSValue("CreateLinkUtil.LogMessage",{type:s.getNLSValue("DELAsmProcessCanUseCnx"),from:u.getLabelValue(C),to:u.getLabelValue(y)})})}if(y.getDisplayModelAttr("asRootInAuxiliaryView")==false){y.setDisplayModel({asRootInAuxiliaryView:true});widget.dispatchEvent("onShowAuxView",[{PPRType:y.get("PPRTYPE")}])}},});return q});define("DS/DELWebMfgAssetsDefUICommands/HideRootNodeCmd",["UWA/Core","DS/Logger/Logger","DS/Core/Events","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefUIServices/CommandsManager","DS/DELWebMfgAssetsDefUIServices/UIUtils"],function(h,e,g,d,c,j,b,f){var n=d.extend({name:"HideRootNodeCmd",_logger:null,_rootMdlSelectionArray:[],_isAll:false,_viewsArr:null,_hideAllNodes:function i(o,s){var p=this,r={silent:false};if(h.is(o,"array")){o.forEach(function q(t){if(h.is(t.referenceMdl.setDisplayModel,"function")){if(t.selectedInAuxView){t.referenceMdl.setDisplayModel({asRootInAuxiliaryView:false},r);p._viewsArr.push("TreeUI")}if(t.selectedInTableView){t.referenceMdl.setDisplayModel({asRootInTableView:false},r);j.remove3DContentFromMBOM(t.referenceMdl.id);p._viewsArr.push("TableUI")}if(t.referenceMdl.isProduct()||t.referenceMdl.isPart()||t.referenceMdl.isResource()){if(t.selectedInBodyView){t.referenceMdl.setDisplayModel({asRootInBodyView:false},r);p._viewsArr.push("LeftUI")}}}})}s()},_resetFilterUI:function a(p){if(h.is(p,"array")&&p.length>0){p.filter(function q(r,s){return(p.indexOf(r)===s)}).forEach(function o(r){var t,s;if(r!=="TreeUI"){s=f.getMGAElement(r);if(h.is(s)){t=s.utils._filterProxy;if(h.is(t)){t.resetFilterUI()}}}})}},init:function m(o){var p,q;this._parent(o,{mode:"exclusive",isAsynchronous:false});if(h.is(e)){this._logger=e.getLogger(n)}p=this.getArguments();if(h.is(p,"array")&&(p.length>0)){q=p[0];if(h.is(q)&&h.is(q.ID,"string")&&(q.ID==="Option")){if(h.is(q.Value,"string")&&(q.Value==="All")){this._isAll=true}}}},beginExecute:function l(){var q={views:[j.VIEWS.AUXILIARY]},r=null,p=null;if(h.is(j.VIEWS.ROUTINGS)){q.views.push(j.VIEWS.ROUTINGS)}if(h.is(j.VIEWS.MBOM)){q.views.push(j.VIEWS.MBOM)}if(h.is(j.VIEWS.BODY)){q.views.push(j.VIEWS.BODY)}r=this._isAll?j.references.toArray():j.getSelectedRefs(q);p=r.filter(j.isRoot);if(h.is(p,"array")){this._rootMdlSelectionArray=[];p.forEach(function o(t){var s={referenceMdl:t,selectedInTableView:this._isAll,selectedInBodyView:this._isAll,selectedInAuxView:this._isAll};if(h.is(t.getDisplayModelAttr,"function")&&!this._isAll){s.selectedInTableView=t.getDisplayModelAttr("selectedInTableView");s.selectedInTableView=h.is(s.selectedInTableView,"boolean")?s.selectedInTableView:false;s.selectedInBodyView=t.getDisplayModelAttr("selectedInBodyView");s.selectedInBodyView=h.is(s.selectedInBodyView,"boolean")?s.selectedInBodyView:false;s.selectedInAuxView=t.getDisplayModelAttr("selectedInAuxiliaryView");s.selectedInAuxView=h.is(s.selectedInAuxView,"boolean")?s.selectedInAuxView:false}this._rootMdlSelectionArray.push(s)},this)}p=null},execute:function k(){var p=this,o={callback:this._hideAllNodes,globalArray:this._rootMdlSelectionArray,context:this,blockSize:50},q;p._viewsArr=[];b.disableActionPanel();f.emptySelection({silent:true});q=c.getExecuteByBlockPromise(o);q.then(function r(){var t={onComplete:function s(){g.publish({event:"DELWebMfgAssetsDefUI/emptyView"})}};j.emptyCollectionsIfNoRoots(t);p._resetFilterUI(p._viewsArr)})}});return n});define("DS/DELWebMfgAssetsDefUICommands/LogPanelCmd",["UWA/Core","DS/Core/Events","DS/ApplicationFrame/CommandCheckHeader","DS/DELWebMfgAssetsDefUIControls/LogPanel"],function(g,a,f,b){var d=f.extend({name:"LogPanelCmd",init:function e(i){var j=this,h=function h(){j.toggleState()};this._parent(i,{mode:"exclusive",isAsynchronous:false});this.onStateChange(this._stateChanged);a.subscribe({event:"MFNMGA.LogPanelCloseEvent"},h)},_stateChanged:function c(){b.toggle()}});return d});define("DS/DELWebMfgAssetsDefUICommands/DeleteCmd",["UWA/Core","DS/Logger/Logger","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/Core/Events","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils"],function(g,c,b,d,h,e,a,k){var j=b.extend({name:"DeleteCmd",_logger:null,_restriction:null,init:function o(p){this._parent(p,{mode:"exclusive",isAsynchronous:false});if(g.is(c)){this._logger=c.getLogger(j)}if(g.is(p.arguments)){if(p.arguments.length>0){if(p.arguments[0].ID==="Restriction"){this._restriction=p.arguments[0].Value}}}},_started:function i(){e.publish({event:this._evtID+"/STARTED",})},_completed:function f(p){if(g.is(p)){a.setForceDBMode(true)}e.publish({event:this._evtID+"/COMPLETED"})},_deleteReference:function n(q,p,s){var t=function t(y,A){var z,w,v,x;if(A){z=A.deletedObjects}if(p&&g.is(z)){for(x=0;x<z.length;x++){w=z[x];v=k.instances.get(w);if(g.is(v)){k.instances.remove(w)}v=k.references.get(w);if(g.is(v)){k.references.remove(w)}}}s._completed(z)},r=function r(w,v){if(v&&v.message){d.AlertManager.add({className:"error",message:v.message})}else{d.AlertManager.add({className:"error",message:h.getNLSValue("DeleteCmd.DeleteFailure")})}s._completed()},u={proxy:"passport",data:g.Json.encode({deep:p}),headers:a.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),wait:true,context:s,onComplete:t,onFailure:r,logMessage:h.getNLSValue("DeleteCmd.LogMessageReference")};this._started();q.setDisplayModel({selectedInTableView:false,selectedInAuxiliaryView:false});q.destroy(u)},_deleteInstance:function l(r,u,p,s){var t=function t(A){var w=k.getReferenceModelFromInstance(A),y=w.get(u),x=h.getNLSValue("DeleteCmd.AddAsNewRoot",{referenceLabel:y});if(g.is(w.get("displayModel").get("asRootInAuxiliaryView"))){if(!w.get("displayModel").get("asRootInAuxiliaryView")&&!w.get("displayModel").get("asRootInTableView")){d.ModalManager.confirm(x,p,function z(B){if(B){w.setDisplayModel({asRootInAuxiliaryView:true});widget.dispatchEvent("onShowAuxView",[{PPRType:w.get("PPRTYPE")}])}})}}s._completed()},q=function q(x,w){if(w&&w.message){d.AlertManager.add({className:"error",message:w.message})}else{d.AlertManager.add({className:"error",message:h.getNLSValue("DeleteCmd.DeleteFailure")})}s._completed()},v={proxy:"passport",headers:a.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),context:s,wait:true,onComplete:t,onFailure:q,logMessage:h.getNLSValue("DeleteCmd.LogMessageInstance")};this._started();r.setDisplayModel({selectedInTableView:false,selectedInAuxiliaryView:false});r.destroy(v)},beginExecute:function m(){var t=this,u="V_Name",x="PLM_ExternalID",y=h.getNLSValue("DeleteCmd.AreYouSure"),q=[],p,s,v=d.getMGAElement("TableUI");if(v._labelIsOnRef===true){u=v._label}else{x=v._label}p=k.getSelectedInsts();p.forEach(function(z){var A=k.getReferenceModelFromInstance(z);if(g.is(A)){q.push(A.id)}});s=k.getSelectedRefs().filter(function(z){return(q.indexOf(z.id)===-1)});if(g.is(p)){p.forEach(function w(B){var A=B.get(x),C=h.getNLSValue("DeleteCmd.DeleteInstanceConfirmation",{instanceLabel:A});d.ModalManager.confirm(C,y,function z(D){if(D){t._deleteInstance(B,u,y,t)}})})}if(g.is(s)&&!(g.is(this._restriction)&&this._restriction==="InstancesOnly")){s.forEach(function r(C){var B=C.get(u),D=h.getNLSValue("DeleteCmd.DeleteReferenceConfirmation",{referenceLabel:B}),z=h.getNLSValue("DeleteCmd.DeleteWholeStructure",{referenceLabel:B});d.ModalManager.confirm(D,y,function A(F){if(F){if(k.getInstancesFromCollection(C.id).length>0){d.ModalManager.confirm(z,y,function E(G){if(G){t._deleteReference(C,true,t)}else{t._deleteReference(C,false,t)}})}else{t._deleteReference(C,false,t)}}})})}}});return j});define("DS/DELWebMfgAssetsDefUICommands/ProductFlowCmd",["UWA/Core","DS/UIKIT/Form","DS/UIKIT/Modal","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","UWA/Utils","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/DELWebMfgAssetsDefUIGraphView/GraphLinkFilter","DS/DELWebMfgAssetsDefUIGraphView/ProductFlowView","DS/UIKIT/Input/Button","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIGraphView/GraphView","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/Windows/Panel"],function(d,f,b,j,c,t,u,h,e,n,m,r,q,k,s,i,v,l,o,a,g){var p=j.extend({init:function(w){this._parent(w,{mode:"exclusive",isAsynchronous:false})},beginExecute:function(){var x=this,w=h.getSelectedRefs({views:h.VIEWS.ROUTINGS})[0].get("PID");if(d.is(this.panel1)){this.panel1.destroy();this.panel1=null}else{var y=t.getMGAElement("FrameWindow").getImmersiveFrame();this.panel1=new g({title:s.getNLSValue("ProductFlowCmd.Title"),position:{at:"top-left"},immersiveFrame:y,resizableFlag:true});this.panel1.addEventListener("close",function(z){x.panel1.destroy();x.panel1=null});new q({PID:w,dialog:x.panel1})}}});return p});define("DS/DELWebMfgAssetsDefUICommands/CreateLinkCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/DELWebMfgAssetsDefUIServices/CreateLinkUtil","DS/DELWebMfgAssetsDefUIServices/CommandsManager"],function(f,d,c,e){var a=d.extend({name:"CreateLinkCmd",init:function(g){this._parent(g,{mode:"exclusive",isAsynchronous:false})},beginExecute:function b(){var g=e.getSelectedObjectsForLinkCreation(true);c.createLink(g.fromReference,g.toReference,g.fromInstance,g.toInstance,this._evtID,g.fromAbsolutePath,g.toAbsolutePath)}});return a});define("DS/DELWebMfgAssetsDefUICommands/EditConfigContextCmd",["UWA/Core","DS/Logger/Logger","DS/CfgConfigurationCommands/commands/CfgEditConfigurationContextCmd","DS/DELWebMfgAssetsDefUICommands/ConfigCommandUtil"],function(h,b,e,c){var d=e.extend({init:function g(i){this._parent(i);this._logger=b.getLogger(d);this._context=i.context;if(!this._context){this._logger.warn("ERROR: No context.");return}this._configCmdUtil=c.getInstance(this._context)},_getSelectedNodes:function f(){var i=this._configCmdUtil.getSelections(),j;j=i.map(function(n){var m,k,l;l=n.isRoot();if(l){m={id:n.getReferencePID(),alias:n.getLabel(),isRoot:l}}else{k=n.getParent();m={id:n.getReferencePID(),alias:n.getLabel(),isRoot:l,parentID:k.getReferencePID(),parentalias:k.getLabel()}}return m});return j},getData:function a(){var j,i;j=this._getSelectedNodes();i={selectedNodes:j};return i}});return d});define("DS/DELWebMfgAssetsDefUICommands/EditVariantCmd",["UWA/Core","DS/Logger/Logger","DS/CfgEffectivityCommands/commands/CfgVariantEffectivityCmd","DS/DELWebMfgAssetsDefUICommands/ConfigCommandUtil"],function(g,c,e,d){var b=e.extend({viewId:null,selectedNodeInfos:null,init:function f(j){var i=this;i._context=j.context,i._logger=c.getLogger(b);if(!i._context){i._logger.warn("ERROR: No context.");return}i._configCmdUtil=d.getInstance(i._context);j.postOKHandler=function h(){var k,l=i._configCmdUtil.getData();if(g.is(l.selectedNodes)&&g.is(l.selectedNodes[0].isRoot)){if(l.selectedNodes[0].isRoot===true){k={pids:[l.selectedNodes[0].id],relids:[]}}else{k={pids:[],relids:[l.selectedNodes[0].id]}}i._configCmdUtil.updateEffectivityAttributes(k,i._configCmdUtil.getViewId())}};i._parent(j);if(widget.getValue("x3dPlatformId")===""){widget.setValue("x3dPlatformId","OnPremise")}},getData:function a(){return this._configCmdUtil.getData()}});return b});define("DS/DELWebMfgAssetsDefUICommands/EditEvolutionCmd",["UWA/Core","DS/Logger/Logger","DS/Core/Events","DS/CfgEffectivityCommands/commands/CfgEvolutionCmd","DS/DELWebMfgAssetsDefUICommands/ConfigCommandUtil","DS/DELWebMfgAssetsDefModelServices/ExternalEventsUtils"],function(e,a,c,g,b,d){var i=g.extend({init:function h(k){var j=this;j._context=k.context;j._logger=a.getLogger(i);if(!j._context){j._logger.warn("ERROR: No context.");return}j._configCmdUtil=b.getInstance(j._context);c.subscribe({event:"changeEffectivity"},function m(n){d.emitUpdateEvolutionEffectivityEvent(n.updatedAttributes)});k.postCloseHandler=function l(){var n,o=j._configCmdUtil.getData();if(e.is(o.selectedNodes)&&e.is(o.selectedNodes[0].isRoot)){if(o.selectedNodes[0].isRoot===true){n={pids:[o.selectedNodes[0].id],relids:[]}}else{n={pids:[],relids:[o.selectedNodes[0].id]}}j._configCmdUtil.updateEffectivityAttributes(n,j._configCmdUtil.getViewId())}};j._parent(k);if(widget.getValue("x3dPlatformId")===""){widget.setValue("x3dPlatformId","OnPremise")}},getData:function f(){return this._configCmdUtil.getData()}});return i});define("DS/DELWebMfgAssetsDefUICommands/ExpandFilterCmd",["UWA/Core","DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd","DS/DELWebMfgAssetsDefModelServices/Selection","DS/DELWebMfgAssetsDefUICommands/ConfigCommandUtil"],function(d,g,j,b){var e=g.extend({_context:null,init:function i(k){this._context=k.context?k.context:null;this._configCmdUtil=b.getInstance(this._context);this._parent(k)},getAppParams:function h(){return{widgetId:d.is(widget)?(d.is(widget.id)?widget.id:null):null,appId:d.is(widget)?(d.is(widget.data)?widget.data.appId:null):null}},getSelectorManager:function a(){return j.getProxyXSO()},getRoots:function f(){var k=this,n,m;m=k._configCmdUtil.getSelections();n=m.reduce(function l(o,p){if(p.isRoot()){o.push({id:p.getReferencePID(),label:p.getLabel()})}return o},[]);return n},getSelection:function c(){var l=this,n,m,k=[],o=[];m=l._configCmdUtil.getSelections();m.forEach(function(q){var p;p=l._configCmdUtil.transformToRIROccurrencePath(q.isRoot()?q.getReferencePID():q.getAbsolutePath());k.push(p);o.push([q.getLabel()])});n={path:k,label:o};return n}});return e});
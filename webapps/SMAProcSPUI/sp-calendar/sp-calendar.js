(function(i){var b,a,k,f,d,e,g,j,m,c,h,l={ONCHANGE:"change"};m={IS_VISIBLE:"is-visible"};c={HOUR:"hour",MINUTE:"minute",SECOND:"second",MERIDIAN:"ampm"};h={TIME:{hour:"12",minute:"00",second:"00",ampm:"AM"},DATE:null};e=function(n){var r=this.$.month.selectedIndex,p=this.$.year.selectedIndex,q=this.$.month.options.length-1,o=this.$.year.options.length-1;if(!n){if(r<q){++r}else{r=0;this.$.year.selectedIndex=p<o?++p:0;this.onYearChange()}}else{if(r>0){--r}else{r=q;this.$.year.selectedIndex=p>0?--p:o;this.onYearChange()}}this.$.month.selectedIndex=r;this.onMonthChange()};a=function(t,s){var n=[],o=[],r,q,v,p,u;r=new Date(t,s,0);q=r.getDate();for(v=1;v<=q;v++){r.setDate(v);u=r.getDay();o=u?o:[];if(v===1&&u!==0){for(p=0;p<u;p++){o.push({dayInWeek:-1,value:""})}}o.push({dayOfWeek:u,value:v});if(v===q&&u!==6){for(p=u+1;p<=6;p++){o.push({dayInWeek:-1,value:""})}u=6}if(u===6){n.push(o)}}return n};k=function(w,v,u){var n=[],p=[],t,s,y,r,x,B,o,q="is-empty",z="is-selected",A;B='<td data-day="{day}" class="{STATE}"><button class="datepicker-button datepicker-day"type="button" data-day="{day}">{day}</button></td>';t=new Date(w,v,0);s=t.getDate();Polymer.dom(this.$.dateContent).innerHTML="";for(y=1;y<=s;y++){t.setDate(y);x=t.getDay();p=x?p:[];if(y===1&&x!==0){for(r=0;r<x;r++){p.push(B.replace(/{STATE}/g,q).replace(/{day}/g,""))}}o=u===y?z:"";p.push(B.replace(/{STATE}/g,o).replace(/{day}/g,y));if(y===s&&x!==6){for(r=x+1;r<=6;r++){p.push(B.replace(/{STATE}/g,q).replace(/{day}/g,""))}x=6}if(x===6){A=document.createElement("tr");A.innerHTML=p.join("");Polymer.dom(this.$.dateContent).appendChild(A)}}};g=function(n,o){if(n.match(/^\d$/g)){n="0"+n}if(o===c.HOUR){if(n>12&&n<=24){n=(n-12).toString()}else{if(n<=0||n>24||isNaN(parseInt(n))){n=h.TIME.hour}}}if(o===c.MINUTE||o===c.SECOND){if(n>=60||n<0||isNaN(parseInt(n))){n=h.TIME.minute}}if(o===c.MERIDIAN){if(n.toLowerCase()!=="am"&&n.toLowerCase()!=="pm"){n=h.TIME.ampm}}return n};d=function(){var q,p,n,o;if(!this.date){return}o=f(this.date);n=[o.getMonth()+1,o.getDate(),o.getFullYear()];p=[this.time.hour,this.time.minute,this.time.second];q=Date.parse(n.join("/")+" "+p.join(":")+" "+this.time.ampm);return q.toString()};j=function(){var o,n;o=d.call(this);if(this.value&&this.value.match(/\d+\/\d+\/\d{4}/g)){n=new Date(this.value).getTime().toString()}else{n=this.value}if(o!==n){this.value=d.call(this);this.fire(l.ONCHANGE,{value:this.value})}};f=function(o){var n;if(!o){return}n=parseInt(o)==o?parseInt(o):o;return new Date(n)};i.SPCalendar=Polymer({is:"sp-calendar",properties:{displaytime:{type:Boolean,value:false,notify:true,reflectToAttribute:true},readonly:{type:Boolean,value:false,notify:true,reflectToAttribute:true},haserror:{type:Boolean,value:false,notify:true,reflectToAttribute:true},time:{type:Object,value:function(){return{hour:h.TIME.hour,minute:h.TIME.minute,second:h.TIME.second,ampm:h.TIME.ampm}},notify:true},date:{value:null,notify:true,observer:"dateChanged"},value:{type:String,notify:true,observer:"valueChanged"},day:{value:null},month:{type:Number,value:7},startyear:{type:Number,value:1994},weeks:{type:Array,value:function(){return[]}},year:{type:Number,value:2014}},toDisplayDate:function(p){var o;if(!p||!this.validate(p)){return p}o=f(p);var n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return n[o.getMonth()]+" "+o.getDate()+", "+o.getFullYear()},ready:function(){var n=new Date();this.year=n.getFullYear();this.month=parseInt(n.getMonth(),10)+1;this.set("$.month.selectedIndex",this.month-1);this.set("$.year.selectedIndex",this.year-this.startyear);k.call(this,this.year,this.month,this.day)},onShowNextMonth:function(){e.call(this)},onShowPreviousMonth:function(){e.call(this,true)},onYearChange:function(){var n=this.$.year;this.year=n.options[n.selectedIndex].value;k.call(this,this.year,this.month)},onMonthChange:function(){var n=this.$.month;this.month=parseInt(n.options[n.selectedIndex].value,10)+1;k.call(this,this.year,this.month)},onDayPick:function(p){var q=p.target,o=q.dataset.day,n;if(o){this.DOM(this).find('td[data-day="'+this.day+'"]').removeClass("is-selected");this.DOM(q.parentElement).addClass("is-selected");this.day=o;this.hideCalendar();n=new Date(this.month.toString()+"/"+this.day.toString()+"/"+this.year.toString());this.updateDate(n)}},onInputClick:function(){this.DOM(this.$.datepicker).addClass(m.IS_VISIBLE);this.DOM(this.$.cover).addClass(m.IS_VISIBLE)},onCoverClick:function(){this.hideCalendar()},onTimestampInputClick:function(n){if(n.target===this.$.time){this.$.hourInput.focus()}},onSetTodaysDate:function(n){this.updateDate(new Date());this.hideCalendar()},onSetCurrentTime:function(n){this.updateTime(new Date());this.$.hourInput.focus();j.call(this)},onTimeChanged:function(p){var o,q,n;n=p.currentTarget.id;q={hourInput:c.HOUR,minInput:c.MINUTE,secInput:c.SECOND,ampmInput:c.MERIDIAN};this.set("time"+("."+q[n]),g(p.currentTarget.value,q[n]));j.call(this)},dateChanged:function(){j.call(this)},valueChanged:function(){var r,p,t,n,q,s,o;if(!this.JS.isEmpty(this.value)){if(!this.validate(this.value)){return}p=f(this.value);this.updateTime(p);this.updateDate(p);this.year=p.getFullYear();this.month=p.getMonth()+1;this.day=p.getDate();this.set("$.month.selectedIndex",this.month-1);this.set("$.year.selectedIndex",this.year-this.startyear);k.call(this,this.year,this.month,this.day)}else{this.reset()}},reset:function(){this.set("time.hour",h.TIME.hour);this.set("time.minute",h.TIME.minute);this.set("time.second",h.TIME.second);this.set("time.ampm",h.TIME.ampm);this.date=h.DATE},updateDate:function(n){var o;this.year=n.getFullYear();this.month=n.getMonth()+1;this.day=n.getDate();o=this.month+"/"+this.day+"/"+this.year;this.date=!this.date||this.date!==o?o:this.date},updateTime:function(q){var o,n,p,r;o=q.getHours()>12?"PM":"AM";n=g(q.getHours().toString(),c.HOUR);p=g(q.getMinutes().toString(),c.MINUTE);r=g(q.getSeconds().toString(),c.SECOND);this.set("time.hour",this.time.hour!==n?n:this.time.hour);this.set("time.minute",this.time.minute!==p?p:this.time.minute);this.set("time.second",this.time.second!==n?r:this.time.second);this.set("time.ampm",this.time.ampm!==o?o:this.time.ampm)},_computeClass:function(o,n){return this.tokenList({"is-visible ":o})+"time-input form-control "+this.tokenList({"is-visible":o})+" \n                              "+this.tokenList({"is-readonly":n})},_computeExpression1:function(n){return Polymer.dom(this.$.month.options[n-1]).innerHTML},tokenList:function(p){var n,o=[];for(var n in p){if(p[n]){o.push(n)}}return o.join(" ")},hideCalendar:function(){this.DOM(this.$.datepicker).removeClass(m.IS_VISIBLE);this.DOM(this.$.cover).removeClass(m.IS_VISIBLE)},focus:function(){this.$.dateinput.focus()},validate:function(o){var n,p;if(!o){return true}n=f(o);if(isNaN(n.getTime())){return false}if(n.getFullYear()<=1970||n.getFullYear()>2034){return false}return true},behaviors:[SPBase]})}(this));
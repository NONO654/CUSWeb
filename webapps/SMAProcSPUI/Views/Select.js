define("DS/SMAProcSPUI/Views/Select",["UWA/Core","UWA/Element","UWA/Event","UWA/Utils","UWA/Controls/Abstract"],function(f,b,a,c,e){var d={name:"select",genericInputName:"form-control",skeletonName:"select",defaultOptions:{name:"",value:"",multiple:true,placeholder:"",options:[],className:"",attributes:{},disabled:false},init:function(g){g=g||{};this._parent(g);this.events=null;this.getContent();if(f.owns(g,"name")){this.setName(g.name)}if(f.owns(g,"value")){this.setValue(g.value)}},getContent:function(){if(!this.elements.container){this.buildSkeleton()}return this.elements.container},buildInput:function(){return f.createElement("select",{"class":this.genericInputName})},buildSkeleton:function(){var i=this.elements,h=this.options,g=false;i.input=this.buildInput().set(h.attributes);if(h.id){i.input.id=h.id}i.container=f.createElement("div",{"class":this.getClassNames(),html:i.input});i.input.addClassName(this.skeletonName+"-hidden");i.choice=f.createElement("ul",{"class":this.skeletonName+"-choice "+this.genericInputName}).inject(i.container);i.dropdown=f.createElement("div",{"class":this.skeletonName+"-dropdown"}).inject(i.container);i.content=f.createElement("ul",{"class":this.skeletonName+"-results"}).inject(i.dropdown);if(h.multiple){i.input.set("multiple",h.multiple);i.container.addClassName(this.skeletonName+"-multiple")}this.add(h.options);if(h.placeholder!==false){this.setPlaceholder(h.placeholder)}g=g||this.getSelection().length===0;this.getContent().toggleClassName("not-chosen",g);this.getContent().toggleClassName("chosen",!g);this.setDisabled(h.disabled);this.elements.input.selectedIndex="-1"},getOption:function(g){return this._getOption(g)},_getOption:function(i,g,l){var j=this,h=this.getOptions(),k=i,m;if(f.is(i,"element")){if(/option|optgroup/.test(i.getTagName())){if(!f.is(l)){return i}}else{if(!f.is(l)){return i}l=false;h=this.getOptions(true)}}else{if(f.is(i.value)){k=i.value}}return h.some(function(o,n){m=o;if(o===k||o.value===k||o.label===k||n===k){if(!g||o.getTagName()===g){if(f.is(l)){m=j.getOptions(l)[n]}return true}}})?m:null},getOptions:function(g){if(g){return this.elements.content.getElements(".result-group, .result-option")}else{return Array.prototype.map.call(this.elements.input.getElementsByTagName("*"),function(h){return f.extendElement(h)})}},remove:function(i){var j=this,g=this.getSelection(),h;if(!f.is(i)){i=this.getOptions()}c.splat(i).forEach(function(k){j.removeOption(k)});h=this.getSelection();if(!g.equals(h)){this.select(h)}return this},removeOption:function(j){var i,g,h;j=this._getOption(j);if(j&&j.isInjected()){i=j.getparent();g=this_getOption(j,undefined,true);h=g.getParent(".result-group");j.remove();g.remove();if(i&&i.getTagName()==="optgroup"&&i.getChildren().length===0){i.remove();h.remove()}}return this},add:function(i){var j=this,g=this.getSelection(),h;c.splat(i).forEach(function(k){j.addOption(k)});h=this.getSelection();if(!g.equals(h)){this.select(h)}return this},addOption:function(l,g){var j=this._getOption(l),n=this.elements,m=!!j,k=n.input,i=n.content,h;if(l.value===undefined){return}if(!f.is(l,"object")){l={value:l}}if(!m){j=f.createElement("option");h=f.createElement("li",{"class":"result-option"})}if(l.group){k=this._getOption(l.group,"optgroup");if(!k){k=f.createElement("optgroup",{label:l.group}).inject(n.input);i=f.createElement("li",{"class":"result-group",html:[{tag:"span","class":"result-group-label",text:l.group},{tag:"ul","class":"result-group-sub"}]}).inject(n.content).getElement("ul")}else{i=this._getOption(k,undefined,true).getElement("ul")}}if(!h){h=this._getOption(j,undefined,true)}b.set.call(h,{text:f.is(l.label)?l.label:l.value,title:f.is(l.label)?l.label:l.value});if(l.label===""){b.set.call(h,{html:"&nbsp;"})}b.set.call(j,{text:typeof l.label!=="undefined"?l.label:l.value,value:typeof l.value!=="undefined"?l.value:l.label,selected:!!l.selected,disabled:!!l.disabled});if(!m){j.inject(k,g);h.inject(i,g)}return this},enable:function(g){var h=this;if(f.is(g)){c.splat(g).forEach(function(i){h.setDisabled(false,i)})}else{h.setDisabled(false)}return this},disable:function(g){var h=this;if(f.is(g)){c.splat(g).forEach(function(i){h.setDisabled(true,i)})}else{h.setDisabled()}return this},isDisabled:function(){return !!this.elements.input.disabled},setDisabled:function(i,h){var g;if(typeof i==="undefined"){i=true}if(h){h=this._getOption(h);h.disabled=i;g=this._getOption(h,undefined,true);g.toggleClassName("result-option-disabled",i)}else{this.elements.input.disabled=i;this.handleEvents()}},setPlaceholder:function(j){var i=this.elements,g=this.options,k=g.placeholder,h;i.choice.empty();if(j===false&&k!==false){g.placeholder=j}else{if(j!==false){g.placeholder=j;h=f.createElement("li",{"class":"choice-default",styles:{padding:".25em 1em .25em .4em",fontSize:"12px"},text:this.options.placeholder}).inject(i.choice)}}},getSelection:function(){var j=this,i=this.getOptions(),g=this.elements.input.selectedIndex,h=[];if(i.length>0){h=i.filter(function(l,k){if(l.getTagName()!=="optgroup"){if(j.options.multiple){if(l.selected){return true}}else{if(g>=0&&g===k){return true}}}else{g++}})}return h},clear:function(g){var h=this;this.getSelection().forEach(function(i){h.setSelection(i,false)});if(!g){this.dispatchOnChange()}},select:function(j,h,i){var k=this,g=this.getSelection();if(!f.is(h)){h=true}c.splat(j).forEach(function(l){k.setSelection(l,h)});if((!i&&!this.getSelection().equals(g))||(!this.options.multiple)){this.dispatchOnChange()}return this},setSelection:function(j,g){var h,i;j=this._getOption(j);if(j){if(j.getTagName()==="optgroup"){this.select(j.getChildren(),g)}else{j.selected=g}}},clearCheck:function(){this.getOptions(true).forEach(function(h){var g=h.getElement(".fonticon");g&&g.remove()})},syncInput:function(){var h=this,g=this.getSelection();this.clearCheck();g.forEach(function(k){var i=h._getOption(k,undefined,true);var j=f.createElement("span",{"class":"fonticon fonticon-check"});i.insertBefore(j,i.childNodes[0])})},dispatchOnChange:function(){a.dispatchEvent(this.elements.input,"change")},handleEvents:function(){var g=this.elements;if(!this.events){this.events={container:{click:this.dispatchEvent.bind(this,"onClick"),mousedown:this.dispatchEvent.bind(this,"onMouseDown")},input:{change:this.dispatchEvent.bind(this,"onChange"),keydown:this.dispatchEvent.bind(this,"onKeyDown"),focus:this.focus.bind(this),blur:this.blur.bind(this)},content:{mousewheel:function(l){var k=this.scrollTop,j=this.scrollHeight,i=this.getSize().height,m=(l.type==="DOMMouseScroll"?l.detail*-40:l.wheelDelta),h=m>0;if(!h&&-m>j-i-k){this.scrollTop=j;a.stop(l)}else{if(h&&m>k){this.scrollTop=0;a.stop(l)}}}}}}if(this.isDisabled()){g.container.removeEvents(this.events.container);g.content.removeEvents(this.events.content);g.input.removeEvents(this.events.input)}else{g.container.addEvents(this.events.container);g.content.addEvents(this.events.content);g.input.addEvents(this.events.input)}},onMouseDown:function(g){if(!this.isDisabled()){a.preventDefault(g);this.focus()}this.preventDismiss=false;if(this.elements.input.disabled){this.setDisabled();this._dispatchers&&this._dispatchers.onMouseDown.halt();a.stop(g)}else{if(!this.getContent().hasClassName("dropdown-visible")){this.setVisible(true);this.ensureVisible();this.preventDismiss=true}}},setVisible:function(h){var k,g,i,j;if(!f.is(h)){h=!this.getContent().hasClassName("dropdown-visible")}if(h){k=this.getContent().getOffsets().y;g=this.elements.dropdown.getSize().height;i=window.innerHeight||document.documentElement.clientHeight;j=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;this.getContent().addClassName("dropdown-visible");if(k+g>i+j){this.getContent().addClassName("dropup")}else{this.getContent().removeClassName("dropup")}}else{this.getContent().removeClassName("dropdown-visible")}},onChange:function(h){var g;this.syncInput();g=this.getSelection().length===0;this.getContent().toggleClassName("not-chosen",g);this.getContent().toggleClassName("chosen",!g);if(!this.options.multiple){this.setVisible(false)}},onKeyDown:function(i){var h=a.whichKey(i),g=true;if(h==="space"){if(!this.getContent().hasClassName("dropdown-visible")){this.setVisible(true)}}else{if(h==="return"){this.setVisible()}else{if(h==="esc"){if(this.getContent().hasClassName("dropdown-visible")){this.setVisible(false)}}else{g=false}}}if(g){a.preventDefault(i)}},onClick:function(k){var j=a.getElement(k),h=this.options,i=false,g=this.preventDismiss;if(j.hasClassName("result-option")||j.getParent(".result-option")){j=j.hasClassName("result-option")?j:j.getParent(".result-option");j=this._getOption(j,undefined,true);if(!j.disabled&&!j.getParent().disabled){this.select(j,h.multiple?!j.selected:true)}}else{if(!g&&(j.hasClassName(this.skeletonName+"-choice")||j.getParent("."+this.skeletonName+"-choice")||j.hasClassName(this.skeletonName))){this.setVisible()}}},ensureVisible:function(){var j=this.getSelection(),k=this.elements.content,l,g,i,h;if(j.length>0){l=k.scrollTop,g=k.getSize().height,i=this._getOption(j[j.length-1],undefined,true),h=i.offsetTop-parseInt(k.getStyle("margin-top"),10);if(h<l||h>l+g){this.elements.content.scrollTop=h}}},setClassName:function(g){},setFocus:function(g){var h=this.elements;if(typeof g==="undefined"){g=true}h.container.toggleClassName("focus",g);h.input[g?"focus":"blur"]();if(g===false){this.setVisible(false)}},focus:function(){this.setFocus();this.dispatchEvent("onFocus")},blur:function(){this.setFocus(false);this.dispatchEvent("onBlur")},setName:function(g){if(f.is(g,"string")){this.elements.input.name=g}return this},getName:function(){return this.elements.input.name},getValue:function(){return this.getSelection(true).map(function(g){return g.value})},setValue:function(g){this.clear(true);if(f.is(g)){this.select(g)}}};return e.extend(d)});
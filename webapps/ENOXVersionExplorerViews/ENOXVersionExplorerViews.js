define("DS/ENOXVersionExplorerViews/NodeDropdownMenu",["DS/UIKIT/DropdownMenu","DS/Tree/TreeNodeModel","css!DS/ENOXVersionExplorerViews/styles/NodeDropdownMenu"],function(a,c){var b=null;return{displayNodeDropdownMenu:function(u){var n=this,k=u.treeNode,j=u.target,p=u.menuList,o=u.position,d=u.dropdownContainer;if(!((k instanceof c)||Array.isArray(k))){throw Error("NodeDropdownMenu.displayNodeDropdownMenu:incorrect data to display dropdown menu")}if(!b||d.getElement(".version-node-dropdown-menu")==null){b=new a({target:j,renderTo:d,removeOnHide:true,bound:false,closeOnClick:true,scrollMode:false,offset:{x:5,y:5},items:[],events:{onClick:function(w,i){var x=i.event,v=b.data;v.menuctx=u;if(typeof x.pubfn==="function"){x.pubfn(b.data)}else{if(typeof x==="string"){n[(typeof n.publishEvent==="function"?"publishEvent":"publish")]({event:x,data:v,})}}},onClickOutside:function(v){var w=v.target,i=false;if(this.nodeView){while(w=w.parentNode,w){if(w===this.nodeView){i=true;break}}}this[(i===true?"show":"hide")]()},}});b.elements.container.addClassName("version-node-dropdown-menu")}else{b.removeItem(b.items.map(function(i){return i.id}));b.options.target=j}b.nodeView=j;b.data=k;for(var l=0;l<p.length;l++){var t=p[l];if(t.id==="divider"){b.addItem({className:"version-node-dropdown-menu-divider"})}else{b.addItem({text:t.text,fonticon:t.fonticon,icon:t.icon,event:t.event,id:t.id})}}var h=b.elements.container.getElement(".dropdown-menu-wrap.dropdown-menu-icons").getAttribute("tabindex");b.elements.container.getElement(".dropdown-menu-wrap.dropdown-menu-icons").removeAttribute("tabindex");b.show();if(o){var m=b.elements.container.clientWidth;var e=b.elements.container.clientHeight;var g=d.getBoundingClientRect();var f=g.width,s=g.height;var r=o.x-g.left,q=o.y-g.top;if(r+m>f){r=f-m-5}if(q+e>s){q=s-e-5}b.options.altPosition={x:r,y:q};b.updatePosition()}b.elements.container.getElement(".dropdown-menu-wrap.dropdown-menu-icons").setAttribute("tabindex",h)}}});define("DS/ENOXVersionExplorerViews/VersionExplorerModal",["UWA/Core","DS/ENOFloatingPanel/ENOFloatingPanel","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerView","i18n!DS/UIKIT/assets/nls/UIKIT",],function(d,c,b,a){return{_dlg:undefined,_dlgDiv:undefined,footerStyle:{none:1,okCancel:2},_closeDlg:function(){if(this._dlg){var g=this._dlgDiv.getChildren();var e=g.length;for(var f=0;f<e;f++){this._dlgDiv.remove(g[f])}this._dlg.destroy();this._dlg=undefined;this._dlgDiv=undefined;(this.options&&typeof this.options.onCloseDlg==="function")&&this.options.onCloseDlg()}},displayDialog:function(e){var g=this;if(g._dlgDiv&&g._dlg){g._closeDlg()}g._dlgDiv=d.createElement("div",{styles:{width:"100%",height:"100%",overflow:"hidden"}});e.className=("version-explorer-modal"+(typeof e.className==="string"&&e.className.length?" "+e.className:""));var f=d.merge(e,{body:g._dlgDiv,closable:true,animate:true,resizable:true,autocenter:true,visible:true,limitParent:true,footer:(e.footerStyle===g.footerStyle.okCancel?('<button type="button" class="btn btn-primary _BTN_OK">'+a.ok+'</button> <button type="button" class="btn btn-default _BTN_CANCEL">'+a.ko+"</button>"):undefined),overlay:(e.modal===true),events:{onClose:g._closeDlg.bind(g),},onOK:function(){},onCancel:function(){},title:b.VersionExplorer});g._dlg=new c(f);g._dlg.elements.body.setStyle("padding","0");e.parentContainer=e.parentContainer||d.extendElement(document.body);g._dlg.inject(e.parentContainer);g._dlgDiv.setContent(e.globalDiv);if(g._dlg.elements.footer){g._dlg.elements.footer.getElement("button._BTN_OK").addEvent("click",function(h){e.onOK(h);g._closeDlg()});g._dlg.elements.footer.getElement("button._BTN_CANCEL").addEvent("click",function(h){g._closeDlg();e.onCancel(h)})}(e.position&&e.position.clientX&&e.position.clientY)&&(g._dlg.elements.container.setStyles({top:e.position.clientY.toString()+"px",left:e.position.clientX.toString()+"px"}),g._dlg.initialClient=g._dlg._getCurrentClientPosition(e.position));this.options=e},setTitle:function(e){if(this._dlg!==undefined){this._dlg.setTitle(b.VersionExplorer+(typeof e==="string"&&e.length?" - "+e:""))}},changeFooterStyle:function(){if(this._dlg!==undefined){that._dlg.elements.footer}}}});define("DS/ENOXVersionExplorerViews/NewRevisionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewRevisionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],function(c,a,b){return{displayDialog:function(d){if(!d.derivedFrom||!d.derivedFrom.name||!d.derivedFrom.id){throw Error("derived From Name or ID cannot be null")}if(typeof d.defaultName!=="string"||!d.defaultName.length){throw Error("Default Name cannot be null")}var g=[{type:"text",label:b.revTitle,required:false,value:d.defaultName||"",name:"newVersionName"},{type:"textarea",label:b.description,required:false,name:"newVersionDescription"},{type:"text",label:b.derivedFrom,required:false,disabled:true,value:d.derivedFrom.name,name:"newVersionBasedOn"}];var f=new c({fields:g,className:"newVersionDialog"});var e=new a({renderTo:d.parentContainer||document.body,className:"newVersionSuperModal"});e.dialog({title:(d.title||b.newRevision),body:f.elements.container,buttons:[{className:"primary",value:b.create,action:function(h){var j=f.getValue("newVersionName"),i=f.getValue("newVersionDescription");h.hide();d.onOK(j,i)},name:"buttonOK"},{className:"default",value:b.cancel,action:function(h){h.hide()},name:"buttonCancel"},]});f.getField("newVersionDescription").focus()}}});define("DS/ENOXVersionExplorerViews/VersionExplorerToolbar",["UWA/Core","DS/UIKIT/Iconbar","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/WebappsUtils/WebappsUtils","UWA/Element","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerToolbar","css!DS/ENOXVersionExplorerViews/styles/VersionExplorerToolbar",],function(g,d,a,e,c,h,f,b,i){return d.extend({_versionExplorerController:undefined,init:function(k){var j=this;j._versionExplorerController=k.versionExplorerController;j.versionExplorerView=k.versionExplorerView;arr=[];for(var l in a.OrientationMode){arr.splice(a.OrientationMode[l],0,l)}this._circularArray=new e.CircularArray(arr);var m=this;var n=c.UserSettings.thumbnailGraphLayout;if(isNaN(n)){for(var l in h.THUMBNAIL_GRAPH_LAYOUT){if(h.THUMBNAIL_GRAPH_LAYOUT[l]===n){n=l;break}}}g.extend(k,{className:"versionexplorer-iconbar",items:[{fonticon:"select-on",text:i.multiSelect,id:"menuMultiSelect"},{fonticon:"",text:i.multiSelect,id:"multiSelectCounter"},{fonticon:"open-down",text:"",id:"menuMultiSelectDropdown"},{fonticon:"graph-egraph-down "+n,text:i[n],id:"graphViewDropDown",content:{type:"icondropdown",options:{items:[{selected:(n==="ROOT_ON_RIGHT"),fonticon:"graph-egraph-down ROOT_ON_RIGHT",description:i.ROOT_ON_RIGHT,id:"ROOT_ON_RIGHT"},{selected:n==="ROOT_ON_LEFT",fonticon:"graph-egraph-down ROOT_ON_LEFT",description:i.ROOT_ON_LEFT,id:"ROOT_ON_LEFT"},{selected:n==="ROOT_ON_BOTTOM",fonticon:"graph-egraph-down ROOT_ON_BOTTOM",description:i.ROOT_ON_BOTTOM,id:"ROOT_ON_BOTTOM"},{selected:n==="ROOT_ON_TOP",fonticon:"graph-egraph-down",description:i.ROOT_ON_TOP,id:"ROOT_ON_TOP"}],events:{onClick:function(p,o){document.getElementById("graphViewDropDown").getChildren()[0].className=o.elements.container.getChildren()[0].className;m.versionExplorerView.setThumbnailGraphLayout(o.elements.container.id);var q=m.menu.items.find(function(r){return r.id==="graphViewDropDown"});if(q){q.text=o.description;q.tooltip.setBody(q.text)}}}}}},{fonticon:"arrow-double-combo",text:i.zoomToFit,id:"menuZoomToFit"},{fonticon:"map-navigation",text:i.toggleOverview,id:"menuToggleOverview"},{className:"divider",id:"divider"},{fonticon:"reload",text:i.refresh,id:"menuRefresh"},{fonticon:"legend-eye",text:i.toggleOverview,text:i.legend,id:"menuToggleLegend"},{fonticon:"cog",text:i.settings,id:"menuSettings"},{fonticon:"graph-egraph",text:i.displayThumbnailView,id:"menuDisplayThumbnailView",content:{type:"icondropdown",options:{items:[{selected:true,fonticon:"graph-egraph selected",id:"DisplayThumbnailView",description:i.displayThumbnailView},{fonticon:"graph-egraph-list ",id:"DisplaySubwayListView",description:i.displaySubwayListView}],events:{onClick:function(p,o){o.elements.container.className="item ";this.elements.container.getChildren()[0].className="item selected";m.setView("menu"+o.id,true)}}}}},{fonticon:"graph-egraph-list",text:i.displaySubwayListView,id:"menuDisplaySubwayListView",content:{type:"icondropdown",options:{items:[{fonticon:"graph-egraph ",id:"ThumbnailView",description:i.displayThumbnailView},{selected:true,fonticon:"graph-egraph-list selected",id:"SubwayListView",description:i.displaySubwayListView}],events:{onClick:function(p,o){o.elements.container.className="item ";this.elements.container.getChildren()[1].className="item selected";m.setView("menuDisplay"+o.id,true)}}}}}],events:{onClick:j.handleThumbnailGraphToolbar}});this._parent(k);g.createElement("span",{}).inject(this.getItem("multiSelectCounter").elements.container);this.hideMultiSelect();this.removeLegendButton()},select:function(){var j=arguments,n,l,o,k,m;if(j[0]===undefined||j[0]===null){return}l=(j[1]===undefined)?true:j[1];m=(j[2]===undefined)?false:j[2];(m&&l)&&this.elements.container.querySelectorAll(".item-active").forEach(function(p){p.removeClassName&&p.removeClassName("item-active")});(m&&l)&&this.overflowMenu.getSelectedItems().forEach(function(p){this.overflowMenu.menus[0].toggleSelection(p);p.elements.container.removeClassName("selectable")},this);n=this.getItem(j[0]);if(!n||n.elements.container.hasClassName("divider")){return}n.elements.container[l?"addClassName":"removeClassName"]("item-active");o=n.elements.container.id;k=this.overflowMenu.items.filter(function(p){return p.elements.container.hasClassName(o)});if(k.length===1){this.overflowMenu.menus[0].toggleSelection(k[0]);k[0].elements.container.addClassName("selectable")}},getItemIndex:function(p){var m,j,k,o=false,n=-1;for(m=0,j=this.menu.items.length;m<j;m+=1){o=this.menu.items[m];if(p&&p.nodeType){k=p.hasClassName("item")?p:p.getParent();if(o.id===k.id){n=m;break}}else{if(m===p||o.id===p||o.name===p){n=m;break}}o=false}return n},addLegendButton:function(j){this.showItem("menuToggleLegend");this.select("menuToggleLegend",j)},removeLegendButton:function(){this.hideItem("menuToggleLegend")},setView:function(m,l){if(this.viewTYPE!==m){this.viewTYPE=m;switch(m){case"menuDisplayThumbnailView":this.showItem("menuDisplayThumbnailView");this.showItem("menuRefresh");this.showItem("divider");this.showItem("graphViewDropDown");this.showItem("menuZoomToFit");this.showItem("menuToggleOverview");this.hideItem("menuSettings");this.hideItem("menuDisplaySubwayListView");(l===true)&&this.versionExplorerView._displayThumbnailGraph(true);break;case"menuDisplaySubwayListView":this.hideItem("menuDisplayThumbnailView");this.hideItem("graphViewDropDown");this.hideItem("menuZoomToFit");this.hideItem("menuToggleOverview");this.showItem("menuDisplaySubwayListView");this.showItem("menuSettings");this.showItem("menuRefresh");if(document.getElementById("menuMultiSelect").style.display=="none"){this.hideItem("divider")}else{this.showItem("divider")}(l===true)&&this.versionExplorerView._displaySubwayGraph();break}var j=["menuToggleOverview","menuZoomToFit","graphViewDropDown"];for(var k=0;k<j.length;k++){this[(m==="menuDisplayThumbnailView"?"showItem":"hideItem")](j[k])}}},handleThumbnailGraphToolbar:function(k,l){var j=this;switch(l.id){case"menuRefresh":j._versionExplorerController.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:true});break;case"menuToggleOverview":j.select(l.id,!j.getItem(l.id).elements.container.hasClassName("item-active"));c._saveUserSettings("displayThumbnailOverview",j.getItem(l.id).elements.container.hasClassName("item-active"),j.versionExplorerView._versionModel.isCompare);j.versionExplorerView.setThumbnailOverviewVisibility();break;case"menuZoomToFit":j.versionExplorerView.reframeThumbnailGraph();break;case"menuToggleLegend":j.select(l.id,!j.getItem(l.id).elements.container.hasClassName("item-active"));j.versionExplorerView.displayLegend(j.getItem(l.id).elements.container.hasClassName("item-active"));c._saveUserSettings("displayLegend",j.getItem(l.id).elements.container.hasClassName("item-active"),j.versionExplorerView._versionModel.isCompare);break;case"menuMultiSelect":this.versionExplorerView._versionModel._USER_SET_MULTI_SELECT=!j.getItem(l.id).elements.container.hasClassName("item-active");this.versionExplorerView._manageSelect({data:!this.versionExplorerView._versionModel._USER_SET_MULTI_SELECT});break;case"menuMultiSelectDropdown":this.versionExplorerView.onMultiSelectDropdownClick(k);break;case"menuSettings":this.versionExplorerView._customizeColumns();break}},hideItem:function(k){var j=this.getItem(k);j&&j.elements.container.hide()},showItem:function(k){var j=this.getItem(k);j&&j.elements.container.show()},activateItem:function(j){this.select(j,true)},deactivateItem:function(j){this.select(j,false)},hideMultiSelect:function(){this.hideItem("menuMultiSelect");this.hideItem("multiSelectCounter");this.hideItem("menuMultiSelectDropdown")},showMultiSelect:function(){this.showItem("menuMultiSelect");this.showItem("divider")},activateMultiSelect:function(){if(!this._multiSelectActive){this.activateItem("menuMultiSelect");this.showItem("multiSelectCounter");this.activateItem("multiSelectCounter");this.activateItem("menuMultiSelectDropdown");this._multiSelectActive=true}},deactivateMultiSelect:function(){if(this._multiSelectActive){this.deactivateItem("menuMultiSelect");this.hideItem("multiSelectCounter");this.hideItem("menuMultiSelectDropdown");this._multiSelectActive=false}},setMultiSelectCount:function(j){this._multiSelectActive&&this.getItem("multiSelectCounter").elements.container.getElement("span").setContent(j.toString())},showMultiSelectDropdown:function(){this._multiSelectActive&&this.showItem("menuMultiSelectDropdown")},hideMultiSelectDropdown:function(){this.hideItem("menuMultiSelectDropdown")},setSubwayViewRowHeight:function(j){j=j||c.UserSettings.subwayViewMode;this.versionExplorerView.setSubwayRowHeight(h.SUBWAY_VIEW_MODE[j]);c._saveUserSettings("subwayViewMode",j,this.versionExplorerView._versionModel.isCompare)}})});define("DS/ENOXVersionExplorerViews/NewVersionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewVersionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],function(d,b,c,a){return{displayDialog:function(o){if(!o.derivedFrom||!o.derivedFrom.name||!o.derivedFrom.id){throw Error("derived From Name or ID cannot be null")}if(typeof o.defaultName!=="string"||!o.defaultName.length){throw Error("Default Name cannot be null")}var h=o.dataModelType;var l=o.semanticTypes;var m=false;var f=[{type:"textarea",label:a.description,required:false,name:"newVersionDescription"}];if(Array.isArray(l)&&l.length){m=true;var k=l.length;f.push({label:a.semanticRelationship,disabled:true,className:"semanticTypeText",required:true,flag:"semanticType"});for(var j=0;j<k;j++){f.push({type:"radio",label:l[j].label,required:false,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType"})}}else{switch(h){case c.DATA_MODEL_TYPES.MODEL_P_PRIME:case c.DATA_MODEL_TYPES.MODEL_RDF:m=true;f.push({label:a.semanticRelationship,disabled:true,className:"semanticTypeText",required:true,flag:"semanticType"},{type:"radio",label:a.S,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"S",checked:true},{type:"radio",label:a.F,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"F"},{type:"radio",label:a.SO,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SO"},{type:"radio",label:a.SP,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SP"});break;default:break}}f.push({type:"text",label:a.derivedFrom,required:false,disabled:true,value:o.derivedFrom.name,name:"newVersionBasedOn"});var e=new d({fields:f,className:"newVersionDialog"});var n;var n=(n=e.elements.container.getElement('input[type="text"].semanticTypeText'),n?n.getParent("div").getElement("label span"):undefined);(!!n)&&UWA.createElement("span",{"class":"fonticon fonticon-info",events:{mousedown:function(i){}}}).inject(n,"before");var g=new b({renderTo:o.parentContainer||document.body,className:"newVersionSuperModal"});g.dialog({title:o.title||a.newBranch,body:e.elements.container,buttons:[{className:"primary",value:a.create,action:function(q){var s=o.defaultName,r=e.getValue("newVersionDescription"),i=undefined;if(m===true){var p=e.elements.container.getElements('.semanticTypeRadio input[type="radio"]:checked');i=(p&&p.length==1)&&p[0].getAttribute("value")}q.hide();o.onOK(s,r,i)},name:"buttonOK"},{className:"default",value:a.cancel,action:function(i){i.hide()},name:"buttonCancel"},]})}}});define("DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg",["UWA/Class","UWA/Core","DS/UIKIT/SuperModal","DS/UIKIT/Input/Toggle","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg","i18n!DS/UIKIT/assets/nls/UIKIT","css!DS/LifecycleControls/assets/styles/LifecycleModals","css!DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg"],function(b,d,c,g,i,e,h,a){var f=b.singleton({init:function(){this._parent({})},showDialog:function(l){var n=this;var k=l.onOk;var o=l.onShow;var m=new c({closable:true,className:"Lifecycle_Modals",events:{onShow:function(){if(o!=null){o(n)}}},renderTo:l.parent});var j=this.buildDialogBody(l);m.dialog({body:j,title:l.title,buttons:[{className:"primary",value:e.ok,action:function(q){var r={};var p=q.elements.body.getElement("#compact-view-toggle");if(p){r.compactView=p.checked}if(n.checkboxes!==undefined){r.attributes=n.getSelectedAttributes()}q.hide();k(r)}},{value:e.ko,action:function(p){p.hide()}}]})},getSelectedAttributes:function(){var j=[];var m=this.checkboxes.length;for(var k=0;k<m;k++){var l=this.checkboxes[k];if(l.isChecked()){j.push(l.getId())}}return j},buildDialogBody:function(u){var r=this;var m=d.createElement("div",{styles:{position:"relative",height:"100%",overflow:"auto"}});if(u.showGraphListSettings){var j=new g({id:"compact-view-toggle",type:"switch",label:i.UseCompactDisplay,checked:u.compactView}).inject(m)}if(u.showGraphListSettings){var t=d.createElement("div",{html:i.SelectColumns}).inject(m);var k=d.createElement("form",{});var o=d.createElement("fieldset",{id:"attribute-preference-content","class":"preferenceSet"});var p=u.allAttributes.length;this.checkboxes=[];for(var q=0;q<p;q++){var s=u.allAttributes[q];var l=s.isSelected;if(l){this.addAttrItem(o,s)}}for(var q=0;q<p;q++){var s=u.allAttributes[q];var l=s.isSelected;if(!l){this.addAttrItem(o,s)}}o.inject(k);k.inject(m)}return m},addAttrItem:function(k,j){var l=new g({id:j.name,type:"checkbox",className:"primary",label:j.displayName,checked:j.isSelected,disabled:(j.disabled==true)?true:false}).inject(k);this.checkboxes.push(l)}});return f});define("DS/ENOXVersionExplorerViews/VersionExplorerPrefs",["UWA/Class","UWA/Promise","DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg","DS/LifecycleServices/LifecycleServices","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg","DS/LifecycleServices/LifecycleServicesSettings","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/WAFData/WAFData"],function(a,f,e,d,i,c,b,h){var g=a.extend({init:function(m,o,k,l,n,j){this._parent({});this.allColumns=k;this.defaultCols=l;this.hWidget=m;this.appId=o;this._IS_COMPARE=j},getAll:function(){return this.allColumns},getAlldbKeys:function(){return this.allColumns.map(function(j){return j.dbKey})},loadSettingsPromise:function(){var j=this;j.loaded=null;return new f(function(m,l){j=j;var n=j.hWidget.getValue("x3dPlatformId");var k=encodeURI(c.get3DSpaceWSUrl(n,"/resources/AppsMngt/user/getPreferences?name="+j.appId));h.authenticatedRequest(k,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(o){console.log("PICK COMPARE DIALOG: success getting value");if(o!=null&&o!=""){j.loaded=JSON.parse(o)}if(j.loaded==null||j.loaded==""){j.loaded=j.defaultCols;j.save(j.loaded)}m(j.loaded)},onFailure:function(o){console.log("PICK COMPARE DIALOG: failed getting value")}})})},load:function(){var j=this;j.loaded=null;if(j.hWidget){j.loaded=j.hWidget.getValue(j.appId)}else{j.loaded=JSON.parse(window.localStorage.getItem(j.appId))}if(j.loaded==null){j.loaded=j.defaultCols;j.save(j.loaded)}return j.loaded},save:function(j){if(this.hWidget){this.hWidget.setValue(this.appId,j)}else{window.localStorage.setItem(this.appId,JSON.stringify(j))}if(this._IS_COMPARE){var l=this.hWidget.getValue("x3dPlatformId");var k=encodeURI(c.get3DSpaceWSUrl(l,"/resources/AppsMngt/user/setPreferences?name="+this.appId+"&value="+JSON.stringify(j)));h.authenticatedRequest(k,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(m){console.log("PICK COMPARE DIALOG: success setting ")},onFailure:function(m){console.log("PICK COMPARE DIALOG: failed setting ")}})}},getAttrDispName:function(j){var k=j;if(j=="newTarget"){k=i.newTarget}else{k=d.getAttributeDisplayName(j)}return k},customizations:function(m){var p=this;if(this._IS_COMPARE){this.loadSettingsPromise().then(function(n){setTimeout(function(){var t=[{name:"title",displayName:p.getAttrDispName("title"),isSelected:true,disabled:true}];for(var v=0,s=n.length;v<s;v++){var u=p.allColumns.find(function(x){return n[v]===x.dbKey});if(u){t.push({name:u.dbKey,displayName:u.columnNLS,isSelected:true})}}var w=p.allColumns.length;for(var v=0;v<w;v++){if(n.indexOf(p.allColumns[v].dbKey)==-1){t.push({name:p.allColumns[v].dbKey,displayName:p.allColumns[v].columnNLS,isSelected:false})}}e.showDialog({title:i.SettingsTitle,parent:document.body,showGraphListSettings:m.showGraphListSettings,showGraphSettings:m.showGraphSettings,compactView:m.compactView,allAttributes:t,onShow:function(x){if((m.onShowDlg!==undefined)&&(m.onShowDlg!==null)){m.onShowDlg(x)}},onOk:function(z){var x={};if(z.compactView!==undefined){x.compactView=z.compactView}if(z.attributes!==undefined){x.attributes=[];var A=z.attributes.length;for(var y=0;y<A;y++){if(z.attributes[y]=="title"){continue}x.attributes.push(z.attributes[y])}p.save(x.attributes)}if((m.onOk!==undefined)&&(m.onOk!==null)){m.onOk(x)}}})},500)})}else{var q=this.load();var k=[{name:"title",displayName:this.getAttrDispName("title"),isSelected:true,disabled:true}];for(var o=0,j=q.length;o<j;o++){var l=this.allColumns.find(function(n){return q[o]===n.dbKey});if(l){k.push({name:l.dbKey,displayName:l.columnNLS,isSelected:true})}}var r=this.allColumns.length;for(var o=0;o<r;o++){if(q.indexOf(this.allColumns[o].dbKey)==-1){k.push({name:this.allColumns[o].dbKey,displayName:this.allColumns[o].columnNLS,isSelected:false})}}e.showDialog({title:i.SettingsTitle,parent:document.body,showGraphListSettings:m.showGraphListSettings,showGraphSettings:m.showGraphSettings,compactView:m.compactView,allAttributes:k,onShow:function(n){if((m.onShowDlg!==undefined)&&(m.onShowDlg!==null)){m.onShowDlg(n)}},onOk:function(u){var s={};if(u.compactView!==undefined){s.compactView=u.compactView}if(u.attributes!==undefined){s.attributes=[];var v=u.attributes.length;for(var t=0;t<v;t++){if(u.attributes[t]=="title"){continue}s.attributes.push(u.attributes[t])}p.save(s.attributes)}if((m.onOk!==undefined)&&(m.onOk!==null)){m.onOk(s)}}})}},setParams:function(l,k,j){if(typeof l==="string"&&l.length){this.appId=l}if(Array.isArray(k)&&k.length){this.allColumns=k}if(Array.isArray(j)&&j.length){this.defaultCols=j}}});return g});define("DS/ENOXVersionExplorerViews/VersionExplorerView",["UWA/Core","UWA/Controls/Abstract","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/ENOXVersionExplorerViews/VersionExplorerToolbar","DS/Tree/TreeDocument","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerViews/NodeDropdownMenu","DS/ENOXVersionExplorerViews/VersionExplorerModal","DS/ENOXVersionExplorerThumbnailGraphView/NodeEdgeViewsTemplates/DefaultNodeEdgeViewsTemplate","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerSubwayListView/VersionExplorerSubwayListView","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleControls/DelayedMask","DS/ENOXVersionExplorerModel/VersionTreeNodeModel","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","css!DS/ENOXVersionExplorerViews/styles/VersionExplorer",],function(j,k,c,b,a,g,o,m,p,n,q,e,i,d,f,l){var h=k.extend({_versionModel:undefined,init:function(t){j.Class.implement.call(this,{displayLegend:function(Y){w&&w.addLegendButton(Y);H.getElement(".versionexplorer-legend")[(Y===true?"addClassName":"removeClassName")]("versionexplorer-legend-expanded")},removeLegend:function(){H.getElement(".versionexplorer-legend").removeClassName("versionexplorer-legend-expanded");w&&w.removeLegendButton()},showDialog:function(Y,aa,Z){m.displayDialog({globalDiv:H,parentContainer:aa,modal:Z,footerStyle:((u._versionModel._SELECTION_MODE&n.SELECTION_MODES.WITH_COMMANDS)?m.footerStyle.none:m.footerStyle.okCancel),position:{clientX:Y.clientX,clienty:Y.clientY},className:Y.className,onCloseDlg:function(){C.cleanup()},onOK:function(ab){C.publishEvent("ENOXVersionExplorerModalOK",C.getSelectedNodes())},onCancel:function(){C.publishEvent("ENOXVersionExplorerModalCancel")}})},hideDialog:function(){m._closeDlg()},setTitle:function(Y){m.setTitle(Y)},setThumbnailGraphLayout:function(Y){V.setRootPosition(c.OrientationMode[Y]);e._saveUserSettings("thumbnailGraphLayout",Y,u._versionModel.isCompare);C.publishEvent("ENOXVersionExplorerThumbnailGraphLayoutChanged",Y)},reframeThumbnailGraph:function(){E===n.DISPLAY_MODES.THUMBNAIL_VIEW&&V&&V.reframeAll()},setThumbnailOverviewVisibility:function(){V[e.UserSettings.displayThumbnailOverview===true?"showOverview":"hideOverview"]();H.getElement(".version-thumbnail-canvas").hide();H.getElement(".version-thumbnail-canvas").show()},updateViewOptions:function(){var Y=undefined;O();switch(u._versionModel._DATA_MODEL_TYPE){case n.DATA_MODEL_TYPES.MODEL_P:case n.DATA_MODEL_TYPES.MODEL_ER:case n.DATA_MODEL_TYPES.MODEL_REVISION:Y={displayThumbnailCollapser:(!e.X_DESIGN),displaySemantic:(!e.X_DESIGN),};break;default:Y={displayThumbnailCollapser:true,displaySemantic:true,};break}Q&&Q.updateViewOptions(Y)},displayView:function(Y){switch(e.UserSettings.displayMode){case n.DISPLAY_MODES.THUMBNAIL_VIEW:u._displayThumbnailGraph(Y);break;case n.DISPLAY_MODES.SUBWAY_VIEW:u._displaySubwayGraph();break;default:break}K()},setSubwayRowHeight:function(Y){T.setRowHeight(Y)},_customizeColumns:function(){u.customizeColumns.customizations({showGraphListSettings:(e.UserSettings.displayMode==n.DISPLAY_MODES.SUBWAY_VIEW),showGraphSettings:(e.UserSettings.displayMode==n.DISPLAY_MODES.THUMBNAIL_VIEW),compactView:(e.UserSettings.subwayViewMode==="SUBWAY_COMPACT_VIEW"),onOk:function(aa){if(aa.compactView!==undefined){var ac=e.UserSettings.subwayViewMode;var Z=aa.compactView?"SUBWAY_COMPACT_VIEW":"SUBWAY_COMFORTABLE_VIEW";if(Z!==ac){e._saveUserSettings("subwayViewMode",Z,u._versionModel.isCompare)}}if(T){T.prepareUpdateColumns();var Y=u.customizeColumns.getAll();var ab=g.intersectionDifference(Y,aa.attributes,function(af,ag){return af.dbKey===ag}),ae=ab[0].difference.map(function(af){return af.outputKey}),ad=Y.filter(function(af){return aa.attributes.findIndex(function(ag){return ag===af.dbKey})>=0}).map(function(af){return af.outputKey});T.getColumnManager().hideColumns(ae);T.getColumnManager().showColumns(ad);T.pushUpdateColumns(false);u.setSubwayRowHeight(n.SUBWAY_VIEW_MODE[Z])}},onShowDlg:function(Y){}})},_displayThumbnailGraph:function(Y){if(!(u._versionModel instanceof a)){throw Error("Version Model must be an instance of TreeDocument")}F();L();(Y===true)&&V.reframeAll();e._saveUserSettings("displayMode",E,u._versionModel.isCompare);if(e.UserSettings.displayThumbnailOverview){(w&&w.select("menuToggleOverview",true))}u.setThumbnailOverviewVisibility();H.getElement(".version-thumbnail-canvas").hide();H.getElement(".version-thumbnail-canvas").show();C.publishEvent("_ENOXVersionExplorerViewChanged")},_displaySubwayGraph:function(){W();S();e._saveUserSettings("displayMode",E,u._versionModel.isCompare);C.publishEvent("_ENOXVersionExplorerViewChanged")},_manageSelect:function(Z){var aa=Z.data;var ab=Z.notifyThumbnailUI;var Y=u._versionModel.searchByAttribute("__checked__",true);if(!(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.MULTI_SELECT_ONLY)){u._versionModel._SELECTION_MODE&=~n.SELECTION_MODES.MULTI_SELECT_ACTIVE;u._versionModel._USER_SET_MULTI_SELECT=false;w&&w.deactivateMultiSelect();R&&(u._versionModel.getModelEvents().unsubscribe(R),R=undefined);M&&(u._versionModel.getModelEvents().unsubscribe(M),M=undefined);u._versionModel.getXSO().get().length>1&&u._versionModel.prepareAddDelete()&&u._versionModel.unselectAll()&&u._versionModel.pushAddDelete();Y.forEach(function(ac){ac.options.grid.__checked__=false});ab=true}else{if(((Y&&Y.length>0)||u._versionModel._USER_SET_MULTI_SELECT)&&(!aa)&&(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.MULTI_SELECT_ONLY)){if(!(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.MULTI_SELECT_ACTIVE)){u._versionModel._SELECTION_MODE|=n.SELECTION_MODES.MULTI_SELECT_ACTIVE}w&&w.activateMultiSelect();X&&(C.unsubscribeEvent("_ENOXVersionExplorerManageMultiSelect",X),X=undefined);R=R||u._versionModel.getModelEvents().subscribe({event:"select"},A);M=M||u._versionModel.getModelEvents().subscribe({event:"unselect"},A);ab=true;w&&w[(Y&&Y.length>1&&(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.WITH_COMMANDS)?"showMultiSelectDropdown":"hideMultiSelectDropdown")]()}else{if(!u._versionModel._USER_SET_MULTI_SELECT){u._versionModel._SELECTION_MODE&=~n.SELECTION_MODES.MULTI_SELECT_ACTIVE;w&&w.deactivateMultiSelect();R&&(u._versionModel.getModelEvents().unsubscribe(R),R=undefined);M&&(u._versionModel.getModelEvents().unsubscribe(M),M=undefined);X=X||C.subscribeEvent("_ENOXVersionExplorerManageMultiSelect",u._manageSelect);(aa===true)&&(u._versionModel.prepareAddDelete(),u._versionModel.unselectAll(),Y.forEach(function(ac){ac.options.grid.__checked__=false}),u._versionModel.pushAddDelete());ab=true}}}w&&w.setMultiSelectCount(Y.length);ab&&E===n.DISPLAY_MODES.THUMBNAIL_VIEW&&V&&V.notifyUpdateNodes("_selectionMode");E===n.DISPLAY_MODES.SUBWAY_VIEW&&T&&T.updateSelectionMode()},setSelectionMode:function(Y){if(Y!==u._versionModel._SELECTION_MODE){(Y>=0)&&(u._versionModel._SELECTION_MODE=Y);w&&w[(!(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.MULTI_SELECT_ONLY)?"hideMultiSelect":"showMultiSelect")]();this._manageSelect({notifyThumbnailUI:true})}},onMultiSelectDropdownClick:function(Z){var Y=C.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(ab){C.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",Y);var aa=u._versionModel.searchByAttribute("__checked__",true);C._getMultiSelectMenuListPromise(aa).then(function(ac){o.displayNodeDropdownMenu.bind(C)({treeNode:aa,target:null,menuList:ac,position:{x:Z.clientX,y:Z.clientY},dropdownContainer:H})})});C.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:false,contextualMenu:true})},build:function(){G();P();y()},_getActiveView:function(){return E},cleanup:function(){V&&V.cleanup();T&&T.cleanup();E=null},setLoadingMask:function(){if(!D){D=new i(H,1000,f.loadingText)}},unmask:function(){if(D){D.unmask();D=null}},setFocus:function(Z){var Y=(Z instanceof d)?[Z]:u._versionModel.getXSO().get();if(Array.isArray(Y)&&Y.length>0){if(E===n.DISPLAY_MODES.THUMBNAIL_VIEW){V&&V.reframeOn(Y)}else{T&&T.setFocus(Y[Y.length-1])}}},_highlightParents:function(Z){if(e.UserSettings.highlightParentConnectionsOnSelect===true){var Y=v(Z);if(e.UserSettings.highlightParentConnectionsOnSelect===true&&Y&&Y.links){this._highlightLinks(Y.links)}}},_unhighlightParents:function(Z){var Y=v(Z);Y&&Y.nodes&&this._unhighlightNodes(Y.nodes);Y&&Y.links&&this._unhighlightLinks(Y.links)},_highlightNodes:function(Y){if(Array.isArray(Y)){Y.forEach(function(Z){if(Z instanceof d){Z.highlight()}else{if(typeof Z==="string"){Z=u._versionModel.searchByID(Z);if(Z.length===1){Z[0].highlight()}}}})}else{if(typeof Y==="function"){u._versionModel._nodeList.filter(Y).forEach(function(Z){Z.highlight()})}}},_unhighlightNodes:function(Y){if(Array.isArray(Y)){Y.forEach(function(Z){if(Z instanceof d){Z.unhighlight()}else{if(typeof Z==="string"){Z=u._versionModel.searchByID(Z);if(Z.length===1){Z[0].unhighlight()}}}})}else{if(typeof Y==="function"){u._versionModel._nodeList.filter(Y).forEach(function(Z){Z.unhighlight()})}}},_highlightLinks:function(Y){if(Array.isArray(Y)&&Y.length){Y.forEach(function(Z){u._versionModel.highlightLink(Z)})}},_unhighlightLinks:function(Y){if(Array.isArray(Y)&&Y.length){Y.forEach(function(Z){u._versionModel.unhighlightLink(Z)})}},updateParentHighlighting:function(Z){e._saveUserSettings("highlightParentConnectionsOnSelect",Z,u._versionModel.isCompare);var aa=u._versionModel.getXSO().get(),Y;aa.forEach(function(ab){Y=v(ab);if(Y&&Y.links){u[Z===true?"_highlightLinks":"_unhighlightLinks"](Y.links)}})}});function G(){var Y=u.options;J=Y.parentContainer;z=(typeof Y.showToolbar==="boolean")?Y.showToolbar:true;x=Y.mapScaleLimits||x;C=Y.versionExplorerController;Q=Y.nodeEdgeViewsTemplate;r=Y.customOnDrop;if(!Q){Q=new p()}}function P(){var Y="";H=j.createElement("div",{"class":"version-global-div",html:['<div class="versionexplorer-toolbar">',"</div>",'<div class="modal-header versionexplorer-legend">','   <span class="close fonticon fonticon-cancel" title=""></span>',"</div>",'<div class="version-thumbnail-canvas">',"</div>",'<div class="version-subway-canvas">',"</div>",].join("\n")});if(J){J=j.extendElement(J);J.setContent(H)}}function O(){if(z){H.getElement(".versionexplorer-toolbar").show();if(!w){w=new b({renderTo:H.getElement(".versionexplorer-toolbar"),versionExplorerView:u,versionExplorerController:C})}w.show()}else{H.getElement(".versionexplorer-toolbar").hide()}}function y(){var Y=H.getElement(".version-thumbnail-canvas");if(Y){Y.addEvent("resize",function(){B()})}H.getElement(".versionexplorer-legend span.close").addEvent("mousedown",function(Z){w&&w.handleThumbnailGraphToolbar(Z,w.getItem("menuToggleLegend"))})}function s(Y){var ac=Y.displayMode===n.DISPLAY_MODES.THUMBNAIL_VIEW?Y.node.data.options.id:Y.cellInfos.nodeModel.__MASTER__.options.id,ab,aa,ad=u._versionModel.searchByAttribute("__checked__",true);var Z=C.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(ai){C.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",Z);if(Y.displayMode===n.DISPLAY_MODES.THUMBNAIL_VIEW){aa=Y.node;if(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.WITH_COMMANDS&&((u._versionModel._FILTER_ENABLED&&aa.data.getAttribute("__filter__"))||!u._versionModel._FILTER_ENABLED)){var af=u._versionModel.searchByID(ac);aa=(af.length===1)?af[0].__treeGraphNode__:undefined;if(aa){var ae,ak,ah;if(!u._versionModel._USER_SET_MULTI_SELECT){ah=aa.grNode.views.main.display.elt.querySelector("."+Q.HTMLViewsClasses.nodeClass).getBoundingClientRect()}else{ah=aa.grNode.views.main.display.elt.querySelector("."+Q.HTMLViewsClasses.nodeDropdownMenuButtonClass).getBoundingClientRect()}(ah)&&(ae=(ah.left+ah.right)/2,ak=(ah.top+ah.bottom)/2);ab={treeNode:aa.data,target:aa.grNode.views.main.display.elt,selectedNodes:ad,position:{x:ae,y:ak},dropdownContainer:H}}}}else{var aj=Y.cellInfos,ag=Y.event;aa=aj.nodeModel.__MASTER__;if(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.WITH_COMMANDS&&((u._versionModel._FILTER_ENABLED&&aa.getAttribute("__filter__"))||!u._versionModel._FILTER_ENABLED)){ab={treeNode:aa,target:aj.view,selectedNodes:ad,position:{x:ag.clientX,y:ag.clientY},dropdownContainer:H}}}(u._versionModel._SELECTION_MODE&n.SELECTION_MODES.WITH_COMMANDS)&&!!ab&&C.publishEvent("ENOXVersionExplorerDropdownMenu",ab)});C.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:false,contextualMenu:true})}function N(Y){C.publishEvent("ENOXVersionExplorerDoubleClickVersion",Y)}function B(){var Z=H.getElement(".version-thumbnail-canvas");if(Z&&Z.getStyle("display")!=="none"&&V!==undefined){var Y=Z.getBoundingClientRect();V.setSize(Y.width,Y.height)}}function K(){function Z(aa){var ad=undefined;if(typeof aa==="object"&&Object.keys(aa).length){ad=j.createElement("ul",{"class":"iconbar-items-wrap iconbar-items-icons"});for(var ac in aa){ad.addContent('<li><div class="symbol">'+ac.toString()+'</div><div class="text">'+aa[ac]+"</div></li>")}}var ab=H.getElement(".versionexplorer-legend ul");ab&&ab.destroy();ad.inject(H.getElement(".versionexplorer-legend"),"top")}var Y=u._versionModel.getLegend();if(typeof Y==="object"&&Object.keys(Y).length){Z(Y);u.displayLegend(e.UserSettings.displayLegend)}else{u.removeLegend()}}function A(Z){var ab=Z.target;ab.options.grid.__checked__=ab._isSelected;var Y=u._versionModel.getXSO().get();for(var aa=0;aa<Y.length;aa++){Y[aa].options.grid.__checked__=Y[aa]._isSelected}u._manageSelect({data:false})}function F(){H.getElement(".version-subway-canvas").hide();T&&T.deactivate()}function S(){H.getElement(".version-subway-canvas").show();if(!T){G();T=new q({container:H.getElement(".version-subway-canvas"),onNodeDropdownMenu:function(Y){Y.displayMode=n.DISPLAY_MODES.SUBWAY_VIEW;s(Y)},onNodeDoubleClick:N,customOnDrop:r,model:u._versionModel,defaultCellHeight:n.SUBWAY_VIEW_MODE[e.UserSettings.subwayViewMode]});u._subwayGraphView=T;if(z){w.show();w.setView("menuDisplaySubwayListView")}u.setSelectionMode()}if(E!==n.DISPLAY_MODES.SUBWAY_VIEW){T.activate();T.updateSelectionMode();E=n.DISPLAY_MODES.SUBWAY_VIEW}}function W(){H.getElement(".version-thumbnail-canvas").hide();V&&V.deactivate()}function L(){function Y(ac){ac.displayMode=n.DISPLAY_MODES.THUMBNAIL_VIEW;s(ac)}H.getElement(".version-thumbnail-canvas").show();if(!V){var Z;if(isNaN(Number(e.UserSettings.thumbnailGraphLayout))){Z=c.OrientationMode[e.UserSettings.thumbnailGraphLayout]}else{Z=Number(e.UserSettings.thumbnailGraphLayout);for(var aa in n.THUMBNAIL_GRAPH_LAYOUT){if(n.THUMBNAIL_GRAPH_LAYOUT[aa]===Z){e._saveUserSettings("thumbnailGraphLayout",aa,u._versionModel.isCompare);break}}}var ab={NodeEdgeViewsTemplate:Q,orientation:Z,onNodeDropdownMenu:Y,onNodeDoubleClick:N,onContextualEvent:Y};V=new c.SyncEGraphTree(H.getElement(".version-thumbnail-canvas"),ab);V.setModel(u._versionModel);V.createOverview();if(z){w.show();w.setView("menuDisplayThumbnailView")}u.setSelectionMode();u._thumbnailGraphView=V;V.setRootPosition(c.OrientationMode[e.UserSettings.thumbnailGraphLayout])}if(E!==n.DISPLAY_MODES.THUMBNAIL_VIEW){V.activate();E=n.DISPLAY_MODES.THUMBNAIL_VIEW;u.setFocus()}else{V.notifyUpdateNodes("_selectionMode")}}function v(Z){var Y;if(Array.isArray(Z.options.ancestors)&&Z.options.ancestors.length){Z.options.ancestors.sort(function(ab,aa){if(ab.semantic==="I"){return -1}else{return 1}});Y=Z.options.ancestors.reduce(function(ab,aa){if((aa.semantic==="I")||(aa.semantic!=="I"&&!ab.nodes.length)){ab.nodes.push(aa.id);ab.links.push([aa.id,Z.options.id])}return ab},{nodes:[],links:[]})}return Y}var u=this,J=undefined,U=undefined,I=undefined,z=true,x={maxScale:1,minScale:0.25},C=undefined,V=undefined,T=undefined,Q=undefined,E=undefined,w=undefined,H=undefined,R=undefined,M=undefined,X=undefined,r=undefined,D=undefined;u._parent(t);u._versionModel=t.versionModel;u.customizeColumns=t.customizeColumns;if(t._isODT){j.Class.implement.call(this,{_ODTGetThumbnailView:function(){return V},_ODTGetSubwayView:function(){return T}})}}});return h});
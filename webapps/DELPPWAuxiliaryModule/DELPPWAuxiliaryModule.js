define("DS/DELPPWAuxiliaryModule/AuxiliaryModule",["UWA/Core"],function(b){var a=function(I,F,g,w,m,L,J,O,d,B,c,p,N){var t=[],n=[],D,G,s,E=function(Q){var R,P=false;if(b.is(Q)&&b.is(Q.get)){if(Q.isConnection()){P=n.indexOf(Q.get("type"))>-1}else{R=m.getPPRType(Q);P=t.indexOf(R)>-1}}return P},x=function(){return t.indexOf("PROCESS")>-1},l=function l(P){var T,S,R,Q={forceDBMode:true,silent:true,onComplete:function(U){if(b.is(U)){m.createRefOrInst({isInstanceOf:U.id},R.get("PID"))}else{I.debug("Child reference fetch failed")}}};T=F.getSelectedNodes();if(b.is(T,"array")&&b.is(P)){S=T[0].getID();R=m.getReferenceModel(S);P.forEach(function(U){m.fetchRoot(U.id,Q)})}},k=function k(){var R=I.getId(),Q,P=false,S=I.getPreferenceValue("widgetLayoutValues");if(b.is(S)){Q=b.Json.decode(S);P=(Q[R]!=="")?true:false}return P},C=function C(P){var Q=s.immersiveFrame.getDockingElement(P);if(Q.getContainedVisibleWindows().length<=0){Q.visibleDockingZoneFlag=false}};return{listenTo:function y(){return{addToAuxiliaryView:this.addToAuxiliaryView,addInstance:this.onAddInstance,removeConnection:this.onRemoveConnection,removeReference:this.onRemoveRefOrInst,removeInstance:this.onRemoveRefOrInst,addConnection:this.onAddConnection,changeReference:this.onChangeIRPC,addReference:this.onAddReference,searchAndAddInstance:this.onSearchAndAddInstance,reparentInstances:this.onReparentInstances,toggleAuxPanel:this.onToggleAuxPanel,expandAll:this.onExpandAll,widgetLayoutChanged:this.onWidgetLayoutChanged,DuplicateAdvCmd:this.onDuplicateAdvCmd}},onStart:function o(R){var Q,P=I.getElement(),S=P.getElementsByClassName("tree-list-container")[0],T=g.getComponent("WUXFrameWindowsManager"),U=T.getFrameWindow(I.getAppContext());G=g.getComponent("WUXDockAreaEnum");if(!b.is(R.pprTypes)||!b.is(R.linkTypes)){throw new Error(I.getId()+": TreeListAuthoringModule initialization failed")}t=R.pprTypes;n=R.linkTypes;D=b.is(R.displayBadge)?R.displayBadge:null;s=g.create("Panel",{title:J.getNLSValue("View.AUXILIARY.Title"),identifier:"AuxiliaryPanel",minWidth:300,minHeight:250,height:250,width:300,immersiveFrame:U.getImmersiveFrame(),content:P,visibleFlag:false,resizableFlag:true,closeButtonFlag:false,useBordersFlag:true,collapsibleFlag:false,verticallyStretchableFlag:true});w.loadDocument(F.getWUXNodeModel());w.getContent().inject(S);B.registerViewforWidgetLayout({viewID:I.getId(),viewType:"treeListView",dockArea:G.LeftDockArea});Q=k();I.notify("toggleCmdCheckHeaderState",{cmdName:"ToggleAuxiliaryView",cmdState:Q});N.loadRoots()},onStop:function u(){if(b.is(s)){s.remove();s=void 0}B.unregisterViewforWidgetLayout(I.getId(),"treeListView")},onToggleAuxPanel:function r(S){var R,P,Q;P=function P(){if(!s.visibleFlag){if(!s._getPositionFromPreferences()){s.currentDockArea=G.LeftDockArea}s.show()}R=s.immersiveFrame.getDockingElement(s.currentDockArea);if(R){R.collapseDockingZoneFlag=false}},Q=function Q(){if(s.visibleFlag){s.hide();F.unSelectAll()}};(S.state===true)?P():Q()},onExpandAll:function A(){var P=F.getSelectedNodes();if(b.is(P,"array")&&P.length>0){F.expandNode(P)}},onWidgetLayoutChanged:function e(){var P=k();s.currentDockArea=G.LeftDockArea;s._saveDockAreaInPreferences();C(s.currentDockArea);I.notify("toggleCmdCheckHeaderState",{cmdName:"ToggleAuxiliaryView",cmdState:P})},onAddReference:function M(P){if(!E(P)){return}if(b.is(P.id)&&F.isNodeAdded(P.id)){F.addNode(P,{silentMode:true,withLinksResolved:false})}},onChangeIRPC:function h(P){if(!E(P)){return}F.updateAttributes(P)},onAddInstance:function j(P){F.addNode(P,{silentMode:true,withLinksResolved:false})},onReparentInstances:function z(P){F.reparent(P)},onRemoveConnection:function f(Q){var R,P;if(!E(Q)){return}R=Q.get("type");if(!b.is(R,"string")){I.debug("Could not get connection type");return}P=Q.get("from");if(b.is(D)&&D.linkType===R){F.updateBadge(P,null)}},addToAuxiliaryView:function H(af,S){var aa=S||{},V={},ab="V_Name",T=J.getNLSValue(I.getId()),X=0,P,ad,Z,Y,W,U,ag=function ae(ai){X++;I.log(J.getNLSValue("AuxiliaryModule.AddRoot.Title",{objectName:ai.get(ab),view:T}),W);if(X===af.length){if(!s.visibleFlag){I.notify("toggleCmdCheckHeaderState",{cmdName:"ToggleAuxiliaryView",cmdState:true})}I.info(J.getNLSValue("AuxiliaryModule.AddRootSuccess.Title",{view:T}),W)}},ah=b.is(aa.forceDBMode)?aa.forceDBMode:false,ac=b.is(aa.askAddToAuxConfirmation)?aa.askAddToAuxConfirmation:false,R={withLinksResolved:false,forceDBMode:ah,onAddToTreeListComplete:ag};af=b.is(af,"array")?af:[af];P=function P(){W=I.log(J.getNLSValue("AuxiliaryModule.AddRoot.LogMessage",{view:T}));af.forEach(function(ai){U=F.validate(ai);if(b.is(U)){V[U.param]=U.paramValue;Y=J.getNLSValue(U.key,V,"ValidationError");I.warn(Y,W);X++}else{F.addNode(ai,R)}})};if(b.is(af)){if(ac){ad=J.getNLSValue("Confirmation.AddAsNewRoot");Z=J.getNLSValue("Confirmation.AreYouSure");g.showConfirmation(Z,ad,{attributes:[ab],models:af},function Q(ai){if(b.is(ai)&&ai){P()}})}else{P()}}},onRemoveRefOrInst:function K(P){if(b.is(P)){F.removeNode(P.id)}},onAddConnection:function v(S){var R=0,P,Q;Q=function Q(U){var V,T;if(!E(U)){return}T=U.get("from");V=U.get("type");if(b.is(D)&&D.linkType===V){F.updateBadge(T,D.badgeIcon)}};if(b.is(S,"array")){P=S.length;for(R=0;R<P;R++){Q(S[R])}}else{Q(S)}},onSearchAndAddInstance:function q(){var P=F.getSelectedNodes();if(P.length>0&&x()){O.showSearchDialoguAndActivate(l)}},onDuplicateAdvCmd:function i(){if(F.getSelectedNodes().length>0){p.exectuteDuplicateAdvCmd()}}}};return{behaviors:["WUXNodeModelBehavior","UXFactoryBehavior","TreeListViewBehavior","ModelBehavior","LinkBehavior","ResourceBehavior","SearchBehavior","RefreshBehavior","ViewBehavior","TaggerBehavior","DuplicateAdvBehavior","LoadRecentBehavior"],creator:a}});
define("DS/DELWebMfgItemDefUIPanel/ProgressIndicatorBar",["UWA/Core","UWA/Class","DS/Core/Events","DS/Logger/Logger","DS/Controls/ProgressBar"],function(f,a,d,c,l){var k,i=l.extend({name:"ProgressIndicatorBar",_logger:null,init:function j(m){k=this;this._parent(m);this.showCount=0;d.subscribe({event:"DELMGAMFN/webService/Start"},this.start);d.subscribe({event:"DELMGAMFN/webService/End"},this.stop)},onShow:function g(){this.visibleFlag=true},onHide:function e(){if(this.showCount<1){this.visibleFlag=false}},start:function b(){if(k){k.showCount++;k.onShow()}},stop:function h(){if(k){k.showCount--;k.onHide()}}});return i});define("DS/DELWebMfgItemDefUIPanel/ToolBar",["UWA/Class/View","DS/ApplicationFrame/CommandsManager","DS/Logger/Logger","UWA/Class/Debug","UWA/Core","DS/Controls/Button","DS/DELWebMfgAssetsDefModelServices/Resources","DS/Controls/TooltipModel","css!DS/DELWebMfgItemDefUIPanel/assets/css/ToolBar",],function(c,a,f,p,h,n,i,m){var k=c.extend(p,{_toolBarView:null,_context:null,_beforeActionSetFocusOn:null,defaultOptions:{},setup:function(q,r,s){this.defaultOptions=q;this._context=r;this._beforeActionSetFocusOn=s;this.setContainer(this._buildView());this._bindEvent()},render:function e(){this._parent();this._onResize()},destroy:function(){this.stopListening();this._parent()},_bindEvent:function l(){var q=this;this._context.getBlocLayout().getContent().addEvent("onBlocLayoutResizeEnd",function(r){setTimeout(function(){q._onResize()},200)})},_buildView:function o(){this._toolBarView=h.createElement("div",{"class":"toolBarView",});var q=h.createElement("div",{"class":"toolBarViewIcon",}).inject(this._toolBarView);i.getIconFromKey(this.defaultOptions.toolBarIcon).inject(q);var s=h.createElement("div",{"class":"toolBarViewTitle",}).inject(this._toolBarView);var r=h.createElement("text",{"class":"toolBarViewTitleText",html:this.defaultOptions.toolBarTitle}).inject(s);this._buildToolBar().inject(this._toolBarView);this._buildToolBarSmall().inject(this._toolBarView);return this._toolBarView},_buildToolBar:function j(){var r=this;var q=h.createElement("div",{"class":"toolBarBody",});this.defaultOptions.Buttons.forEach(function(s){var u=new n({});u.tooltipInfos=new m({shortHelp:i.getNLSValue(s.toolTip)});u.inject(q);u.addEventListener("click",function(){r._toolBarButtonAction(s.command)});var t=h.is(s.icon)?s.icon:s.command;i.getIconFromKey(t).inject(u.getContent())});return q},_buildToolBarSmall:function b(){var s=this;var r=h.createElement("div",{"class":"toolBarBodySmall",});var q=new n({}).inject(r);q.addEventListener("click",function(){s._toolBarBodyUl.toggle()});i.getIconFromKey("ActionDropDown").inject(q.getContent());this._toolBarBodyUl=h.createElement("ul",{"class":"toolBarBodySmallUl",}).inject(r);this.defaultOptions.Buttons.reverse().forEach(function(t){var w=h.createElement("il",{"class":"toolBarBodySmallIl",}).inject(s._toolBarBodyUl);var v=new n({});v.tooltipInfos=new m({shortHelp:i.getNLSValue(t.toolTip)});v.inject(w);v.addEventListener("click",function(){s._toolBarButtonAction(t.command);s._toolBarBodyUl.hide()});var u=h.is(t.icon)?t.icon:t.command;i.getIconFromKey(u).inject(v.getContent())});this.defaultOptions.Buttons.reverse();return r},_onResize:function d(q){var r=this._toolBarView.offsetWidth;this._toolBarBodyUl.hide();if(r<400){if(this._toolBarView.hasClassName("toolBarView")){this._toolBarView.removeClassName("toolBarView");this._toolBarView.addClassName("toolBarViewSmall")}}else{if(this._toolBarView.hasClassName("toolBarViewSmall")){this._toolBarView.removeClassName("toolBarViewSmall");this._toolBarView.addClassName("toolBarView")}}},_toolBarButtonAction:function g(q){if(h.is(this._beforeActionSetFocusOn)){this._context.setFocus(this._beforeActionSetFocusOn)}var r=a.getCommand(q,this._context);if(r){r.beginExecute();r.execute();r.endExecute()}},});return k});define("DS/DELWebMfgItemDefUIPanel/AbstractView",["UWA/Class/View","DS/Logger/Logger","UWA/Class/Debug","UWA/Core","DS/DELWebMfgItemDefUIPanel/ToolBar","css!DS/DELWebMfgItemDefUIPanel/assets/css/AbstractView",],function(a,b,h,d,e){var g=a.extend(h,{_actionMainDiv:null,_actionHeader:null,_actionBody:null,_toolBar:null,setup:function(){this._buildActionView()},destroy:function(){this.stopListening();this._parent()},_buildActionView:function j(){this.setContainer(this._buildSkeleton());this.container.setStyles({width:"100%",height:"100%",})},_buildSkeleton:function i(){this._actionMainDiv=d.createElement("div",{"class":"actionViewMain",});this._buildHeader().inject(this._actionMainDiv);this._buildBody().inject(this._actionMainDiv);return this._actionMainDiv},_buildHeader:function c(){this._actionHeader=d.createElement("div",{"class":"actionHeader",});this._toolBar=new e(this.toolBarOptions,this._context,"ACTION");this._toolBar.inject(this._actionHeader);return this._actionHeader},_buildBody:function f(){this._actionBody=d.createElement("div",{"class":"actionBody",});return this._actionBody},});return g});define("DS/DELWebMfgItemDefUIPanel/OriginView",["DS/DELWebMfgItemDefUIDragAndDropManagers/DragAndDropManagerAction","DS/DELWebMfgItemDefUIPanel/AbstractView","DS/DELWebMfgItemDefUIViews/ActionView","UWA/Class/View","DS/Logger/Logger","UWA/Class/Debug","DS/DELWebMfgAssetsDefUIServices/Search"],function(d,h,b,a,c,i,e){var g=h.extend({name:"originView",_actionView:null,_fromPID:null,_fromReference:null,_context:null,_search:null,_type:null,toolBarOptions:{toolBarIcon:"ActionOrigin",toolBarTitle:"",Buttons:[{icon:"EditTVColumns",command:"EditTVColumns",toolTip:"EditTVColumnsCmd.TITLE",},{icon:"OriginRemoveSmall",command:"OriginRemove",toolTip:"Cmd.OriginRemove.Title",},{icon:"OriginAddSmall",command:"OriginAdd",toolTip:"Cmd.OriginAdd.Title",},],},setup:function(k){this._context=k._context;this._fromPID=k._fromPID;this._fromReference=k._fromReference;this._type=k._type;this._search=new e(this._searchCallBack.bind(this));this.toolBarOptions.toolBarTitle=this._fromReference.get("V_Name");this._parent();this._buildTreeListView()},destroy:function(){this.stopListening();this._actionView?this._actionView.destroy():null;this._context.getReferenceCollection()._models.forEach(function(k){if(true===(k.get("displayModel")).get("asRootInActionView")){k.setDisplayModel({asRootInActionView:false},{silent:true})}});this._search.destroy();this._actionView=null;this._context=null;this._fromPID=null;this._fromReference=null;this._parent()},_buildTreeListView:function j(){this._actionView=new b({title:"Origin",renderTo:this._actionBody,context:this._context,mfgwidget:this._context,draganddropmanager:d,type:this._type,fromPID:this._fromPID,contextualMenu:["OriginAdd","OriginRemove","ActionBar_Attributes","Relations","ActionViewFilter"]})},_searchCallBack:function f(k){k.forEach(function(l){d._onAssemblyDrop({referenceID:l.id})})},});return g});define("DS/DELWebMfgItemDefUIPanel/AlternateView",["DS/DELWebMfgItemDefUIDragAndDropManagers/DragAndDropManagerAction","DS/DELWebMfgItemDefUIPanel/AbstractView","DS/DELWebMfgItemDefUIViews/ActionView","UWA/Class/View","DS/Logger/Logger","UWA/Class/Debug","DS/DELWebMfgAssetsDefUIServices/Search","UWA/Core"],function(d,i,b,a,c,j,e,g){var h=i.extend({name:"alternateView",_actionView:null,_fromPID:null,_fromReference:null,_context:null,_search:null,_type:null,toolBarOptions:{toolBarIcon:"ActionAlternates",toolBarTitle:"",Buttons:[{icon:"EditTVColumns",command:"EditTVColumns",toolTip:"EditTVColumnsCmd.TITLE",},{icon:"AlternateBL",command:"AlternateBL",toolTip:"Cmd.AlternateBL.Title"},{icon:"AlternateRemoveSmall",command:"AlternateRemove",toolTip:"Cmd.AlternateRemove.Title",},{icon:"AlternateAddSmall",command:"AlternateAdd",toolTip:"Cmd.AlternateAdd.Title"},],},setup:function(l){this._context=l._context;this._fromPID=l._fromPID;this._fromReference=l._fromReference;this._type=l._type;this._search=new e(this._searchCallBack.bind(this));this.toolBarOptions.toolBarTitle=this._fromReference.get("V_Name");this._parent();this._buildTreeListView()},destroy:function(){this.stopListening();this._actionView?this._actionView.destroy():null;this._context.getReferenceCollection()._models.forEach(function(m){var l=m.get("displayModel");if(g.is(l)&&(true===l.get("asRootInActionView"))){m.setDisplayModel({asRootInActionView:false},{silent:true})}});this._search.destroy();this._context=null;this._fromPID=null;this._fromReference=null;this._actionView=null;this._parent()},_buildTreeListView:function k(){this._actionView=new b({title:"Alternate",renderTo:this._actionBody,context:this._context,mfgwidget:this._context,draganddropmanager:d,type:this._type,fromPID:this._fromPID,contextualMenu:["AlternateAdd","AlternateRemove","ActionBar_Attributes","Relations","ActionViewFilter"]})},_searchCallBack:function f(l){l.forEach(function(m){d._onAssemblyDrop({referenceID:m.id})})},});return h});define("DS/DELWebMfgItemDefUIPanel/CapableResourceView",["DS/DELWebMfgItemDefUIDragAndDropManagers/DragAndDropManagerAction","DS/DELWebMfgItemDefUIPanel/AbstractView","DS/DELWebMfgItemDefUIViews/ActionView","UWA/Class/View","DS/Logger/Logger","UWA/Class/Debug","DS/DELWebMfgAssetsDefUIServices/Search","UWA/Core"],function(d,i,b,a,c,j,e,g){var h=i.extend({name:"CapableResourceView",_actionView:null,_fromPID:null,_fromReference:null,_context:null,_search:null,_type:null,toolBarOptions:{toolBarIcon:"ActionCapableResource",toolBarTitle:"",Buttons:[{icon:"EditTVColumns",command:"EditTVColumns",toolTip:"EditTVColumnsCmd.TITLE",},{icon:"CapableResourceBL",command:"CapableResourceBL",toolTip:"Cmd.CapableResourceBL.Title"},{icon:"CapableResourceRemoveSmall",command:"CapableResourceRemove",toolTip:"Cmd.CapableResourceRemove.Title",},{icon:"CapableResourceAddSmall",command:"CapableResourceAdd",toolTip:"Cmd.CapableResourceAdd.Title",},],},setup:function(l){this._context=l._context;this._fromPID=l._fromPID;this._fromReference=l._fromReference;this._type=l._type;this._search=new e(this._searchCallBack.bind(this));this.toolBarOptions.toolBarTitle=this._fromReference.get("V_Name");this._parent();this._buildTreeListView()},destroy:function(){this.stopListening();this._actionView?this._actionView.destroy():null;this._context.getReferenceCollection()._models.forEach(function(m){var l=m.get("displayModel");if(g.is(l)&&(true===l.get("asRootInActionView"))){m.setDisplayModel({asRootInActionView:false},{silent:true})}});this._search.destroy();this._context=null;this._fromPID=null;this._fromReference=null;this._actionView=null;this._parent()},_buildTreeListView:function k(){this._actionView=new b({title:"CapableResource",renderTo:this._actionBody,context:this._context,mfgwidget:this._context,draganddropmanager:d,type:this._type,fromPID:this._fromPID,contextualMenu:["CapableResourceAdd","CapableResourceRemove","ActionBar_Attributes","Relations"]})},_searchCallBack:function f(l){l.forEach(function(m){d._onAssemblyDrop({referenceID:m.id})})},});return h});define("DS/DELWebMfgItemDefUIPanel/ActionViewManager",["DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgItemDefUIPanel/AlternateView","DS/DELWebMfgItemDefUIPanel/OriginView","DS/DELWebMfgItemDefUIPanel/CapableResourceView","DS/DELWebMfgItemDefUIDragAndDropManagers/DragAndDropManagerAction","DS/Logger/Logger","UWA/Class/Debug","UWA/Class","UWA/Core","DS/DELWebMfgItemDefUIViews/DropView","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/Resources"],function(h,k,c,g,f,l,b,t,q,o,d,a,u,s){var e=o.singleton({name:"ActionViewManager",_view:null,_context:null,_fromPID:null,_fromReference:null,_type:"MfgProcessAlternate",_dropView:null,_dropZone:null,_mbomXSO:null,_mbomXSOAddEvent:null,_mbomXSORemEvent:null,init:function n(x){this._context=x._context;this._dropZone=d.createElement("div",{"class":"dropZone",}).inject(this._context.getActionDiv());b.init({context:this._context,});this._dropView=new a({container:this._dropZone,accepts:["CreateAssembly",],});this._dropZone.hide()},initView:function i(y){var x=false;if(null===d.is(y)){return false}this._mbomXSO=this._context.getMBOMTreeListView().getDocument().getXSO();if(this._mbomXSO.get("items").length>1){u.AlertManager.add({className:"warning",message:s.getNLSValue("Info.MBOMViewMultipleSel.Title")});if(d.is(this._view)){this.clearSelection();this._view._actionHeader.destroy();this._view._actionView.getTreeListView().getManager().unloadDocument();x=true}return x}if(d.is(this._view)){this.destroyView()}this._type=false!==d.is(y.type)?y.type:this._type;if(false===d.is(this._type)){return false}this._fromPID=this.getMBOMSelectedPID();if(false===d.is(this._fromPID)){return false}this._fromReference=h.references.get(this._fromPID);if(false===d.is(this._fromReference)){return false}b._fromPID=this._fromPID;if("MfgProcessAlternate"===this._type){this._view=new g({_context:this._context,_fromPID:this._fromPID,_fromReference:this._fromReference,_type:this._type});b._type="PROCESS_MfgProcessAlternate"}else{if("HistorizationLinkRefRef"===this._type){this._view=new f({_context:this._context,_fromPID:this._fromPID,_fromReference:this._fromReference,_type:this._type});b._type="PROCESS_HistorizationLinkRefRef"}else{if("DELAsmProcessCanUseCnx"===this._type){this._view=new l({_context:this._context,_fromPID:this._fromPID,_fromReference:this._fromReference,_type:this._type});b._type="PROCESS_DELAsmProcessCanUseCnx"}}}this._bindEvents();this._dropZone.show();this.initAuxiliayViewList();this._view.inject(this._context.getActionDiv());return true},destroyView:function w(){this._dropZone.hide();this._unbindEvents();if(d.is(this._view)){this._view.destroy()}this._fromPID=null;this._fromReference=null;this._view=null},destroy:function r(){this.destroyView()},getMBOMSelectedPID:function p(){var x=this._context.getMBOMTreeListView().getDocument().getSelectedNodes();if(0===x.length){return null}return x[0].getReferencePID()},_bindEvents:function v(){var x=this;this._mbomXSOAddEvent=this._mbomXSO.onPostAdd(function(){if(false===e.initView({type:x._type,})){if("MfgProcessAlternate"===x._type){u.CommandsCheckHeaderManager.getCmd("AlternateCommand").setState(false)}else{if("HistorizationLinkRefRef"===x._type){u.CommandsCheckHeaderManager.getCmd("OriginCommand").setState(false)}else{if("DELAsmProcessCanUseCnx"===x._type){u.CommandsCheckHeaderManager.getCmd("CapableResourceCommand").setState(false)}}}}});this._mbomXSORemEvent=this._mbomXSO.onRemove(function(){var A=x._context.getMBOMTreeListView().getDocument().getXSO().get("items"),y,z=x._context.getMBOMTreeListView().getDocument().getNodeModel(x._fromPID,{searchReferencePID:true,returnFirstOne:true,});if((false===d.is(z))||(true===z.isHidden())){if("MfgProcessAlternate"===x._type){u.CommandsCheckHeaderManager.getCmd("AlternateCommand").setState(false)}else{if("HistorizationLinkRefRef"===x._type){u.CommandsCheckHeaderManager.getCmd("OriginCommand").setState(false)}else{if("DELAsmProcessCanUseCnx"===x._type){u.CommandsCheckHeaderManager.getCmd("CapableResourceCommand").setState(false)}}}}if(A.length===1){A=A[0];x._fromPID=A.getReferencePID();e.initView({type:x._type})}else{if(A.length===0){if(d.is(x._view)){x.clearSelection();y=h.references.filter(function(C){return C.get("displayModel").get("asRootInActionView")});if(d.is(y,"array")){y.forEach(function B(C){if(d.is(C)){C.setDisplayModel({asRootInActionView:false},{silent:true})}})}x._view._actionHeader.destroy();x._view._actionView.getTreeListView().getManager().unloadDocument()}}}});this._view._actionView.getTreeListView().addEvent("treeListViewUpdate",function(){if(0===x._view._actionView.getTreeListView().getRoots().length){x._dropZone.show()}else{x._dropZone.hide()}})},_unbindEvents:function j(){this._mbomXSOAddEvent!==null?this._mbomXSO.unsubscribe(this._mbomXSOAddEvent):null;this._mbomXSORemEvent!==null?this._mbomXSO.unsubscribe(this._mbomXSORemEvent):null;this._view!==null?this._view._actionView.getTreeListView().removeEvent("treeListViewUpdate"):null},initAuxiliayViewList:function(){var x=this;if(true===this._fromReference.get("queriedForConnections")){h.getConnectionsById(x._fromPID,null,[this._type],false,function(y){y.forEach(function(z){var C=z.get("to"),A=x._context.getReferenceCollection().get(C),B;if(d.is(A)){A.setDisplayModel({asRootInActionView:true})}else{B=new k({PID:C});B.fetch({proxy:"passport",type:"json",headers:c.getHeaders(),wait:true,onComplete:function(D){x._context.getReferenceCollection().add(D);D.setDisplayModel({asRootInActionView:true})}})}})})}},clearSelection:function m(){var x;if(d.is(this._view)&&d.is(this._view._actionView)){x=this._view._actionView.getTreeListView();if(d.is(x)){x.getDocument().getXSO().empty()}}}});return e});
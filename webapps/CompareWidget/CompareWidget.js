define("DS/CompareWidget/CompareActionBar",["DS/ApplicationFrame/ActionBar","UWA/Utils/Client"],function(f,b){var a=b.getScrollbarWidth();var d=900;function e(k){if(!k){throw new Error("Action Bar not defined")}if(k._afr){var h=k._afr.getWorkbench()["@view"];if(h){var j=h.getParent();if(j){var g=k._afr.getWorkbench()["@view"].getParent().getDimensions();k._modelEvents.publish({event:"ACTIONBAR_WIDTH_CHANGE",data:g.width})}}}}var c=f.extend({_checkWidth:function(){var l=this.elements.container.getDimensions();if(l.width<=d){if(this._isShownWhenSmall===undefined||this._isShownWhenSmall===false){this.close()}else{this.open()}}else{if(l.width>d){if(this._isShownWhenLarge!==undefined&&this._isShownWhenLarge===true){this.open()}else{this.close()}}}var r=this._afr.getNumberOfSections();if(r==0){return}var k=this._afr.getCurrentSection();if(k!==undefined&&k._minimumWidthValue===undefined){k._minimumWidthValue=k.getContent().getDimensions().width}var m=(this.elements.chevron===undefined)?0:this.elements.chevron.getDimensions().width;var o=this.elements.container.getDimensions().width-m;var t=0;if(this._tabBar.visibleFlag){t=Math.min(this._tabBar.getWidthWithoutScroll(),o)}this._tabBar.minWidth=t;if(this.elements.container.getParent()&&k){var p=this;var h;h=k.getContent();var q=this.elements.container.getParent().getDimensions();this._afr.elements.borderContainer.setStyles({minWidth:this._tabBar.minWidth+m});var s=q.width;var u=document.getElementById("compare-region-left");var g=document.getElementById("attribute-table");var j=u.offsetWidth+g.offsetWidth;var n=h.getDimensions().width;if(n>j){p._afr.elements.container.addClassName("wux-ui-scrollbuttons-h");p._afr.elements.container.setStyles({display:"block",minWidth:""});p._afr.getWorkbench()["@view"].style.marginBottom=-a-3+"px"}else{p._afr.elements.container.removeClassName("wux-ui-scrollbuttons-h");p._afr.elements.container.setStyles({display:"inline-block",verticalAlign:"top"});p._afr.getWorkbench()["@view"].style.marginBottom=""}}if(this.getNumberOfSections()<=1){this._tabBar.hide()}else{if(this.elements.container.getAttribute("data-open")==="true"){this._tabBar.show()}}e(this)}});return c});define("DS/CompareWidget/DBG_Stopwatch_impl",["UWA/Core"],function(m){var b=-1;var j={};if((typeof(widget)!="undefined")&&(widget._timingEventList==null)){widget._timingEventList=[]}var g=function(){var q=0;var p=0;var s="";var r=[]};function o(){var p="\n>CW>TM>******************************************************";p+="\n>CW>TM>*              T I M E S T A M P S                   *";p+="\n>CW>TM>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv\n";if((widget!=null)&&(widget.cw_debugtxt!=null)){p+=widget.cw_debugtxt}else{p+=" << No Timestamps >>"}return p}function l(){var p=new Date();return(p.getTime())}function f(s,r,t){var q=[""," ","  ","   ","    ","     ","      ","       "];var p=s-t.toString().length;if(p>7){p=7}if(r=="l"){ret=q[p]+t}else{ret=t+q[p]}return ret}function k(){var q;q="\n>CW>TM>******************************************************";q+="\n>CW>TM>*            T I M I N G   E V E N T S               *";q+="\n>CW>TM>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv";j={};for(var y=0;y<=b;y++){var v=widget._timingEventList[y].msStart;var z=widget._timingEventList[y].markList.length;var C=widget._timingEventList[y].markList[z-1].msTime;var t=C-v;q+="\n>CW>TM> <<<<<<<< ---------- Iteration #"+y+", total: "+t+" ms ---------- >>>>>>>> ";widget._timingEventList[y].msElapsed=t;for(var A=0;A<z;A++){var p=widget._timingEventList[y].markList[A];var D=p.msTime-v;var w="\n>CW>TM> ("+p.msTime+" ms) @ "+f(6,"l",D)+" ms /"+f(4,"l",Math.round(100*(D/t)))+"% into iter ";var u="";if(p.id!=null){for(var B=0;B<A;B++){var s=widget._timingEventList[y].markList[B];if(s.id==p.id){var r=p.msTime-s.msTime;var x=Math.round(100*(r/t));if(j[p.str+"    "+p.comment]==undefined){j[p.str+"    "+p.comment]=x}else{j[p.str+"    "+p.comment]+=x}u=" :: from '"+s.str+"'\n                                                                   ---->"+f(6,"l",r)+"ms elapsed, "+f(3,"l",x)+"% of entire op          "+p.comment;break}}}q+=(w+":: "+p.str+u)}}q+="\n";return q}function e(){var s="\n>CW>TM>******************************************************";s+="\n>CW>TM>*    C O M P R E H E N S I V E   D A T A             *";s+="\n>CW>TM>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv";var r=0;for(var p=0;p<widget._timingEventList.length;p++){r+=widget._timingEventList[p].msElapsed}var q=(b+1);s+=">\n>CW>TM>    ITER COUNT: "+q;s+="\n>CW>TM> AVG ITER TIME: "+(r/q)+" ms";jQuery.each(j,function(t,u){s+="\n>CW>TM>"+f(4,"l",Math.round(100*(u/q)/100))+"% - "+t});return s}function h(p){b++;var q=new g();q.msStart=l();q.comment="Start Iteration #"+b+(p?" / "+p:"");q.markList=[];widget._timingEventList.push(q)}function a(p){var r=null;var s=null;var q="";if(typeof(p)=="string"){r=p}else{r=p.str;s=p.id;q=(p.comment!=null?p.comment:"")}if(b==-1){this.dbglog("CANNOT log message, because iteration has not started:"+r)}else{widget._timingEventList[b].markList.push({msTime:l(),id:s,str:r,comment:q})}}function n(){var r="";if(b==-1){r+="\n>CW>TM>    << no stats to report  >>>"}else{var p=k();var q=e();r+=q+p}r+=o();return r}function d(){var p=n();console.log(p)}function c(p){if(widget.cw_debugtxt==null){widget.cw_debugtxt=""}var q=l();widget.cw_debugtxt+=">CW>TM> DBGLOG (@"+q+" ms ),'"+p+"'\n";return q}return{iterStart:h,mark:a,dump:d,getTimingOutput:n,dbglog:c,}});define("DS/CompareWidget/ColumnPanelLayout",["UWA/Controls/Abstract","DS/WAFData/WAFData","DS/LifecycleServices/LifecycleServicesSettings"],function(d,a,b){var c=d.extend({init:function(e){this._parent({});this.panels=this.getPanelsFromOptions(e);this.onExpand=e.onExpand;this.onCollapse=e.onCollapse;this.onResize=e.onResize;this.elements.container=UWA.createElement("div");this.elements.container.setStyles({width:"100%",height:"100%",position:"relative"});this.layout=this.elements.container;e.parentElement.appendChild(this.layout);this.controllers=[];this.controllersHidden=false;this.getPanelParametersToWidget();this.buildSkeleton(this.panels)},showControllers:function(){for(var f=0;f<this.controllers.length;f++){var e=this.controllers[f];if(e.isHiddenBeforeHideControllers===false){e.show()}}this.controllersHidden=false;this.updatePanelSizes()},hideControllers:function(){for(var f=0;f<this.controllers.length;f++){var e=this.controllers[f];e.isHiddenBeforeHideControllers=e.isHidden();this.controllers[f].hide()}this.controllersHidden=true;this.updatePanelSizes()},showPanel:function(e){if(e.isCollapsed){e.expander.show()}else{e.show();e.hider.show()}this.updatePanelSizes()},hidePanel:function(e){if(e.isCollapsed){e.expander.hide()}else{e.hide();e.hider.hide()}this.updatePanelSizes()},collapse:function(e,f){e.hider.hide();e.hide();if(e.splitter!=null){e.splitter.hide()}e.expander.show();if(f){if(e.id=="compare-region-left"){this.setPanelVizParameter("vizStructPanel",false)}else{if(e.id=="attribute-table"){this.setPanelVizParameter("vizAttrTable",false)}else{if(e.id=="compare-viewer"){this.setPanelVizParameter("vizViewerPanel",false)}}}}this.updateSplitterVisibilities();this.updatePanelSizes();if(this.onCollapse!=null){this.onCollapse(e,f)}e.isCollapsed=true;widget.dispatchEvent("onUpdateViewerLegend")},expand:function(e,f){e.show();e.expander.hide();e.hider.show();if(f){if(e.id=="compare-region-left"){this.setPanelVizParameter("vizStructPanel",true)}else{if(e.id=="attribute-table"){this.setPanelVizParameter("vizAttrTable",true)}else{if(e.id=="compare-viewer"){this.setPanelVizParameter("vizViewerPanel",true)}}}}this.updateSplitterVisibilities();this.updatePanelSizes();if(this.onExpand!=null){this.onExpand(e,f)}e.isCollapsed=false;widget.dispatchEvent("onUpdateViewerLegend")},getPanelsFromOptions:function(g){var f=[];for(var h=0;h<g.panels.length;h++){var j=g.panels[h];var e=j.panel;e.hiderTitle=j.hiderTitle;e.expanderTitle=j.expanderTitle;f.push(e)}return f},updateSplitterVisibilities:function(){var f=this.panels;for(var g=0;g<f.length;g++){var h=f[g];if(h.isHidden()){if(h.splitter!=null){h.splitter.hide()}}else{var e=this.getNextVisiblePanel(h);if(e!=null){h.splitter.show()}else{if(h.splitter!=null){h.splitter.hide()}}}}},updatePanelSizes:function(){var r=this.panels;var p=r.length;var s=this.getVisiblePanels();var t=s.length;var m=t-1;var j=this.getVisibleExpanders().length;if(this.controllersHidden){m=0;j=0}var u=this.layout.offsetWidth;var h=u-(m*this.splitterWidth)-(j*this.expanderWidth);var v=h/u;var l=h/t;var g=[];var f=[];var o=this.getPanelParameters();if(o.ratioStructPanel>0){if(t==3){f[0]=o.ratioStructPanel*v;f[1]=o.ratioAttrTable*v;f[2]=o.ratioViewerPanel*v}else{if(t==2){if(r[0].isHidden()){var k=o.ratioStructPanel*v;f[0]=(o.ratioAttrTable*v)+(k/2);f[1]=(o.ratioViewerPanel*v)+(k/2)}else{if(r[1].isHidden()){var k=o.ratioAttrTable*v;f[0]=(o.ratioStructPanel*v)+(k/2);f[1]=(o.ratioViewerPanel*v)+(k/2)}else{var k=o.ratioViewerPanel*v;f[0]=(o.ratioStructPanel*v)+(k/2);f[1]=(o.ratioAttrTable*v)+(k/2)}}}}}else{if(t==3){g[0]=0.49*h;g[1]=0.22*h;g[2]=0.29*h}else{if(t==2){if(r[0].isHidden()){g[0]=0.3*h;g[1]=0.7*h}else{if(r[1].isHidden()){g[0]=0.5*h;g[1]=0.5*h}else{g[0]=0.7*h;g[1]=0.3*h}}}else{if(t==1){g[0]=h}}}}var q=0;for(var n=0;n<p;n++){var e=r[n];if(!e.isHidden()){if(o.ratioStructPanel>0){if(t==1){e.style.width=100*Math.floor(l)/u+"%"}else{e.style.width=(f[q]*100)+"%"}}else{if(g.length===t){e.style.width=100*Math.floor(g[q])/u+"%"}else{e.style.width=100*Math.floor(l)/u+"%"}}if(this.onResize){this.onResize(e)}++q}}},getVisiblePanels:function(){var g=[];for(var f=0;f<this.panels.length;f++){var e=this.panels[f];if(!e.isHidden()){g.push(e)}}return g},getVisibleExpanders:function(){var g=[];for(var f=0;f<this.panels.length;f++){var e=this.panels[f];if(!e.expander.isHidden()){g.push(e.expander)}}return g},buildSkeleton:function(f){var m=f.length;var k=null;this.panelMinWidth=100;this.splitterWidth=10;this.expanderWidth=20;for(var g=0;g<m;g++){var e=f[g];e.style.cssText="float:left; height:100%; width: 100px;";if(k!=null){k.next=e}k=e;var j=this.createSplitter(e);var h=this.createHider(e);var l=this.createExpander(e);this.controllers.push(j);this.controllers.push(h);this.controllers.push(l);l.hide();e.hider=h;e.splitter=j;e.expander=l;if(g==m-1){j.hide();e.splitter=null}this.layout.appendChild(e);this.layout.appendChild(h);this.layout.appendChild(j);this.layout.appendChild(l)}this.updatePanelSizes();window.addEventListener("resize",this.updatePanelSizes.bind(this))},createSplitter:function(e){var f=UWA.createElement("div");f.className="splitter";f.style.cssText="width:"+this.splitterWidth+"px; background-color:#f0f0f0; height:100%; float:left";f.panel=e;f.style.cursor="col-resize";f.addEventListener("mousedown",this.splitterMouseDown.bind(this));f.addEventListener("touchstart",this.splitterMouseDown.bind(this));return f},createHider:function(e){var f=UWA.createElement("span");f.title=e.hiderTitle;f.className="hider-icon fonticon-2x fonticon fonticon-left-open";f.style.cssText="margin-left:-26px; float:left; z-index:100000; position: relative";f.panel=e;f.addEventListener("click",this.hiderClick.bind(this));return f},createExpander:function(e){var f=UWA.createElement("span");f.title=e.expanderTitle;f.className="expander-icon fonticon-2x fonticon fonticon-right-open";f.style.cssText="margin-left:-10px";var g=UWA.createElement("div");g.title=e.expanderTitle;g.className="expander";g.style.cssText="width:"+this.expanderWidth+"px; background-color:#f0f0f0; height:100%; float:left";g.panel=e;g.hide();g.addEventListener("click",this.expanderClick.bind(this));g.appendChild(f);return g},hiderClick:function(f){var g=f.currentTarget;var e=g.panel;this.collapse(e,true)},expanderClick:function(f){var g=f.currentTarget;var e=g.panel;this.expand(e,true)},getNextVisiblePanel:function(e){var f=e.next;if(f==null){return null}if(f.isHidden()){return this.getNextVisiblePanel(f)}else{return f}},windowMouseMove:function(g){var j=this;if(g.buttons==0){j.movingSplitter=null}if(j.movingSplitter==null){window.removeEventListener("mousemove",j.windowMouseMoveListener);window.removeEventListener("touchmove",j.windowMouseMoveListener)}else{var f=j.movingSplitter.panel;var m=g.pageX;if(g.type=="touchmove"){m=Math.round(g.touches[0].pageX)}var h=f.offsetLeft;var n=f.offsetWidth;var k=j.layout.offsetWidth;var o=j.movingSplitter.clickDeltaToLeft;var e=k;var q=m-h-n-o;var p=j.getNextVisiblePanel(f);if(p!=null){e=p.offsetLeft+p.offsetWidth}if((m>(h+this.panelMinWidth))&&(m<(e-this.panelMinWidth))){f.style.width=100*(n+q)/k+"%";if(this.onResize){this.onResize(f)}if(p!=null){p.style.width=100*(p.offsetWidth-q)/k+"%";if(this.onResize){this.onResize(p)}}}}},splitterMouseDown:function(g){g.stopPropagation();g.preventDefault();if(g.currentTarget!=g.target){return}var f=this;f.movingSplitter=g.currentTarget;var e=g.pageX;if(g.type=="touchstart"){e=Math.round(g.touches[0].pageX)}f.movingSplitter.clickDeltaToLeft=e-f.movingSplitter.offsetLeft;f.windowMouseMoveListener=f.windowMouseMove.bind(f);window.addEventListener("mousemove",f.windowMouseMoveListener);window.addEventListener("touchmove",f.windowMouseMoveListener);f.windowMouseMoveListener=f.windowMouseMove.bind(f);window.addEventListener("mouseup",function(h){if(f.movingSplitter==null){return}f.movingSplitter=null;var s=f.panels;var q=s.length;var u=f.getVisiblePanels();var v=u.length;var n=v-1;var k=f.getVisibleExpanders().length;if(f.controllersHidden){n=0;k=0}var w=f.layout.offsetWidth;var j=w-(n*f.splitterWidth)-(k*f.expanderWidth);var x=j/w;var p=f.getPanelParameters();if(p.ratioStructPanel==-1){p.ratioStructPanel=0.49;p.ratioAttrTable=0.22;p.ratioViewerPanel=0.29}var m=[];var r=f.panels[0].style.width;m[0]=Number(r.substr(0,r.length-1))/100;r=f.panels[1].style.width;m[1]=Number(r.substr(0,r.length-1))/100;r=f.panels[2].style.width;m[2]=Number(r.substr(0,r.length-1))/100;if(v>1){var l=m[0]/x;var t=m[1]/x;var o=m[2]/x;if(v==2){if(s[0].isHidden()){t=(m[1]-(m[0]/2))/x;o=(m[2]-(m[0]/2))/x}else{if(s[1].isHidden()){l=(m[0]-(m[1]/2))/x;o=(m[2]-(m[1]/2))/x}else{l=(m[0]-(m[2]/2))/x;t=(m[1]-(m[2]/2))/x}}}f.setPanelRatioParameters(l,t,o)}})},getPanelParameters:function(){var e={};e.vizStructPanel=widget.getBool("vizStructPanel");e.ratioStructPanel=widget.getValue("ratioStructPanel");e.vizAttrTable=widget.getBool("vizAttrTable");e.ratioAttrTable=widget.getValue("ratioAttrTable");e.vizViewerPanel=widget.getBool("vizViewerPanel");e.ratioViewerPanel=widget.getValue("ratioViewerPanel");return e},getPanelParametersToWidget:function(){var f=widget.getValue("x3dPlatformId");var e=b.get3DSpaceWSUrl(f,"/resources/AppsMngt/user/getPreferences?name=compare_vizStructPanel");a.authenticatedRequest(e,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(g){if(g!=""){var h=g;widget.setValue("vizStructPanel",h)}},onFailure:function(g){}});e=b.get3DSpaceWSUrl(f,"/resources/AppsMngt/user/getPreferences?name=compare_vizAttrTable");a.authenticatedRequest(e,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(g){if(g!=""){var h=g;widget.setValue("vizAttrTable",h)}},onFailure:function(g){}});e=b.get3DSpaceWSUrl(f,"/resources/AppsMngt/user/getPreferences?name=compare_vizViewerPanel");a.authenticatedRequest(e,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(g){if(g!=""){var h=g;widget.setValue("vizViewerPanel",h)}},onFailure:function(g){}});e=b.get3DSpaceWSUrl(f,"/resources/AppsMngt/user/getPreferences?name=compare_panel_ratios");a.authenticatedRequest(e,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(j){if(j!=""){var g=j;var l=g.split("|");for(var h=0;h<l.length;++h){var k=l[h];if(h==0){widget.setValue("ratioStructPanel",k)}else{if(h==1){widget.setValue("ratioAttrTable",k)}else{if(h==2){widget.setValue("ratioViewerPanel",k)}}}}}},onFailure:function(g){}})},setPanelVizParameter:function(f,h){widget.setValue(f,h);var g=widget.getValue("x3dPlatformId");var e=b.get3DSpaceWSUrl(g,"/resources/AppsMngt/user/setPreferences?name=compare_"+f+"&value="+h);a.authenticatedRequest(e,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(j){console.log("COMPARE PANEL LAYOUT: success setting "+f+" preference")},onFailure:function(j){console.log("COMPARE PANEL LAYOUT: failed setting "+f+" preference")}})},setPanelRatioParameters:function(f,h,k){var e=f+h+k;if(e>1){console.log("COMPARE PANEL LAYOUT: panels are too wide");return}widget.setValue("ratioStructPanel",f);widget.setValue("ratioAttrTable",h);widget.setValue("ratioViewerPanel",k);var g=f+"|"+h+"|"+k;var l=widget.getValue("x3dPlatformId");var j=b.get3DSpaceWSUrl(l,"/resources/AppsMngt/user/setPreferences?name=compare_panel_ratios&value="+g);a.authenticatedRequest(j,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(m){console.log("COMPARE PANEL LAYOUT: success setting compare_panel_ratios preference")},onFailure:function(m){console.log("COMPARE PANEL LAYOUT: failed setting compare_panel_ratios preference")}})}});return c});define("DS/CompareWidget/CompareOverview",["css!DS/CompareWidget/CompareWidget.css"],function(){var N=10;var v=6;var g=1;var B="butt";var m="SM";var l="1px solid rgb( 128, 128, 128)";var k="3px solid rgb(   0,   0,   0)";function j(Q,P){this.objKey=Q;this.diffType=P}var O=null;var D="NONE";var x=30;var h=10;var F=1;var n=5;var r=100;var f=0;var q=0;var E=0;var o=0;var K=new Object();function w(P){if(K[P]==null){var R="diff-type.diff-type-"+P;var Q=[];if(jQuery("."+R).css("border-left-style")=="solid"){Q.push(jQuery("."+R).css("border-left-color"))}Q.push(jQuery("."+R).css("background-color"));if(jQuery("."+R).css("border-right-style")=="solid"){Q.push(jQuery("."+R).css("border-right-color"))}K[P]=Q}return K[P]}function J(P){if(O==null){return false}else{return((P>=0)&&(P<O.length))}}function p(P){if((O!=null)&&(P!=null)){for(var Q=0;Q<O.length;Q++){if(O[Q].objKey==P){return Q}}}return -1}function t(){var Q=-1;try{var P=jQuery("#structure-treetable-right");if((P!=null)&&(P!=undefined)){var R=P.fancytree("getTree");var T=R.getActiveNode();if(T!=null){Q=p(T.key)}}}catch(S){}return Q}function a(){var ab=jQuery("#structure-treetable-right").fancytree("getTree");if(ab==undefined){console.log("Tree not ready")}else{var Q=ab.toDict();var S=Q.length;var Z=[];var ac=0;for(var Y=0;Y<S;Y++){Z[ac]=Q[Y];var V=ac;ac++;while(Z[V]!=undefined){if(Z[V].expanded){var R=Z[V].children;var X=V+1;if(R!=null){var P=R.length;for(var W=0;W<P;W++){Z.splice(X++,0,R[W]);ac++}}}V++}}O=[];var aa=Z.length;var T=0;for(var U=0;U<aa;U++){if(jQuery("#structure-treetable-left")[0].tBodies[0].rows[U].style.display==""){O[T]=new j(Z[U].key,Z[U].data.diffType);T++}}}}function I(){var T=t();var W=O.length;var V=jQuery("#structure-treetable-left")[0].clientHeight;var Q=jQuery("#compare-trees").scrollTop();var S=jQuery("div#compare-tree")[0].clientHeight;var U=jQuery("#compare-structure-tree").scrollTop();var R=U+S;var P=S/x;f=W*(U/V);q=f+P-1}function H(R,V){var T=(O==null)?false:(Math.floor(0.5+(V-R))<O.length);if(T){var Q=v-4;var U=Math.floor((0.5*n)+(n*(R)));var S=r+8;var P=Math.floor(n*(V-R+1));jQuery("div#obox").css("top",U).css("left",Q).css("width",S).css("height",P);jQuery("div#obox").css("visibility","visible")}else{jQuery("div#obox").css("visibility","hidden")}}function b(){I();H(f,q)}function L(){var Q=jQuery("div#compare-tree")[0].clientHeight;var T=jQuery(".fancytree-folder").not(".fancytree-focused")[0];x=(T!=undefined?T.offsetHeight:null);if(x==null||x==0){var P=jQuery(".fancytree-exp-nl")[0];if(P!=null){x=P.offsetHeight}}if(x==null||x==0){x=39}h=Math.floor(Q/x);var R=jQuery("div#compare-tree")[0].clientHeight;var V=50;var U=jQuery("div#compare-overview");var S=jQuery("#OverviewCanvas")[0];if(S!=null){S.width=V;S.height=R-5;r=S.width-(2*v);if((O==null)||(O==undefined)){}else{F=Math.floor(O.length-h);n=(R-(2*N))/O.length}}}function A(P,Q){if(Q){P.removeClass("button-unavail");P.addClass("button-avail")}else{P.removeClass("button-avail");P.addClass("button-unavail")}}function d(V){var R=false;var X=false;var W=false;R=(V!=0);if(V!="NONE"){for(var S=V-1;S>=0;S--){if(O[S].diffType!=m){X=true;break}}for(var Q=V+1;Q<O.length;Q++){if(O[Q].diffType!=m){W=true;break}}}var T=jQuery('*[data-name="OverviewUp"]');var P=jQuery('*[data-name="OverviewDown"]');var U=jQuery('*[data-name="OverviewHome"]');A(T,X);A(P,W);A(U,R)}function u(R){var P=Math.floor(R);if(P<0){P=0}else{if(P>=O.length){P=O.length-1}}var Q=(P)*x;jQuery("#compare-structure-tree").scrollTop(Q)}function C(Q,T,V,R,X){var P=R-V;var Z=T.length;var W=P/Z;for(var U=0;U<Z;U++){var S=V+(U*W);var Y=S+W;e(Q,T[U],S,Y,X)}}function e(R,P,T,Q,S){R.strokeStyle=P;R.beginPath();R.moveTo(T,S);R.lineTo(Q,S);R.stroke()}function z(){if(O==null){console.log("===>> CompareOverview: DrawLines request prior to having a keylist")}else{var P=O.length;var V=v;var U=V+r;var R=Math.floor(N+(0.5*n));var T=document.getElementById("OverviewCanvas");var S=T.getContext("2d");S.clearRect(0,0,T.width,T.height);S.lineWidth=g;S.lineCap=B;for(var Y=0;Y<P;Y++){var W=O[Y].diffType;if(O[Y].objKey=="index_0"){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}else{var X="diff-type-"+W;if((X=="diff-type-DIFF")||(X=="diff-type-SM")||(X=="diff-type-REV")||(X=="diff-type-QTY")||(X=="diff-type-SIMILAR")||(X=="diff-type-RO")||(X=="diff-type-LO")||(X=="diff-type-MOVED")){var Q="#checkBoxID_"+W;if(jQuery(Q).is(":checked")){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}else{if(X=="diff-type-REVQTY"){if((jQuery("#checkBoxID_REV").is(":checked"))||(jQuery("#checkBoxID_QTY").is(":checked"))){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}else{if(X=="diff-type-SIMILARQTY"){if((jQuery("#checkBoxID_SIMILAR").is(":checked"))||(jQuery("#checkBoxID_QTY").is(":checked"))){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}else{if(X=="diff-type-SIMILARREVQTY"){if((jQuery("#checkBoxID_REV").is(":checked"))||(jQuery("#checkBoxID_QTY").is(":checked"))||(jQuery("#checkBoxID_SIMILAR").is(":checked"))){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}else{if(X=="diff-type-REVMOVED"){if((jQuery("#checkBoxID_REV").is(":checked"))||(jQuery("#checkBoxID_MOVED").is(":checked"))){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}else{if(X=="diff-type-SIMILARMOVED"){if((jQuery("#checkBoxID_SIMILAR").is(":checked"))||(jQuery("#checkBoxID_MOVED").is(":checked"))){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}else{if(X=="diff-type-SIMILARREV"){if((jQuery("#checkBoxID_REV").is(":checked"))||(jQuery("#checkBoxID_SIMILAR").is(":checked"))){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}else{if(X=="diff-type-SIMILARREVMOVED"){if((jQuery("#checkBoxID_REV").is(":checked"))||(jQuery("#checkBoxID_MOVED").is(":checked"))||(jQuery("#checkBoxID_SIMILAR").is(":checked"))){if(W!=m){if(Y==D){S.lineWidth=g}else{S.lineWidth=g}var Z=w(W);C(S,Z,V,U,R)}R+=n}}}}}}}}}}}}}function c(T){if(T=="NONE"){jQuery("div#currbox").css("visibility","hidden");D="NONE"}else{var S=Math.floor(T);if(J(S)){try{var R=jQuery("#structure-treetable-right").fancytree("getTree");R.activateKey(O[S].objKey)}catch(V){console.log("Failure in update of tree... continuing...")}if(S<f){u(S)}else{if(S>(q-1)){u(S-h+2)}}var Q=v-2;var W=Math.floor(N+(n*(S+0.5))-4);var U=r+4;var P=8;jQuery("div#currbox").css("top",W).css("left",Q).css("width",U).css("height",P);jQuery("div#currbox").css("visibility","visible")}D=S}z()}function G(P,Q){if(P==true){L()}c(Q);d(Q);b()}function M(R){var P=R;a();var Q=(R!="NONE")&&(typeof(R)=="string");if(Q){P=p(R)}G(true,P);jQuery("div#obox").css({border:l})}function s(P){var Q=t();var S=Q+P;var R=Q;while((S<O.length)&&(S>=0)){if(O[S].diffType!=m){R=S;break}S+=P}if(R!=Q){G(false,R)}}var y=function(S){this.targetElement=S;this.rootElement=UWA.createElement("div",{id:"compare-overview-toplevel",html:[{tag:"div",id:"compare-overview",html:[{tag:"div",id:"canvas-buffer",html:[{tag:"canvas",id:"OverviewCanvas"},{tag:"div",id:"obox"},{tag:"div",id:"currbox"}]}]}]});this.rootElement.inject(this.targetElement);var T=this;jQuery(document).ready(function(){var Z=null;var X=false;var Y=300;jQuery(window).resize(function(){Z=new Date();if(X===false){X=true;setTimeout(W,Y)}});function W(){if(new Date()-Z<Y){setTimeout(W,Y)}else{X=false;if(jQuery("#overview-container").css("display")!=="none"){G(true,D)}}}});var R=function(){console.log("DRAGDONE");jQuery("div#compare-content").off("mousemove",V);jQuery("div#compare-content").off("mouseup",P);jQuery("div#obox").css({border:l})};function V(Z){if(Z.buttons==1){var aa=Z.pageY;var X=aa-E;var W=n;var Y=o+(X/W);if(Y<0){Y=0}if(Y>O.length){Y=O.length}jQuery("#compare-structure-tree").scrollTop(Y*x);Z.stopImmediatePropagation()}else{R()}}var Q=false;function P(W){Q=true;W.stopImmediatePropagation();R()}function U(W){if(W.buttons==1){E=W.pageY;o=f;jQuery("div#compare-content").on("mousemove",V);jQuery("div#compare-content").on("mouseup",P);jQuery("div#obox").css({border:k});W.stopImmediatePropagation()}}jQuery("div#obox").mousedown(U);jQuery("#compare-structure-tree").click(function(W,X){if(W.target.className=="fancytree-expander"){a()}G(false,t());return true});jQuery("#compare-legend").click(function(W,X){a();G(false,t());return true});jQuery("#compare-structure-tree").keydown(function(X,Y){var W=t();if((W!=D)||(X.which=="187")||(X.which=="189")||(X.which=="107")||(X.which=="109")||(X.which=="37")||(X.which=="39")){a();G(false,t());return true}return false});jQuery("div#overview-container").click(function(Z){if(Q){Q=false}else{var X=Z.pageX;var W=Z.pageY;if((X>v)&&(X<v+r)){var Y=Math.floor(jQuery("div#compare-legend").innerHeight()+N+(0.5*n));var ab=Math.floor((W-Y)/n);var aa=(ab)*x;jQuery("#compare-structure-tree").scrollTop(aa)}}})};y.prototype.init=function(P){M(P)};y.prototype.refresh=function(P){if(this.rootElement){this.rootElement.destroy();this.rootElement=null}};y.prototype.scrollTree=function(P,Q){var S=O.length;var R=S*(P/Q);b()};y.prototype.goHome=function(){M(0)};y.prototype.goUp=function(){s(-1)};y.prototype.goDown=function(){s(1)};y.prototype.forODT_getKeyListSize=function(){return O.length};return y});define("DS/CompareWidget/DBG_Stopwatch",["UWA/Core"],function(a){return{iterStart:function(){},mark:function(){},dump:function(){},getTimingOutput:function(){},dbglog:function(){},enable:function(){var b=this;require(["DS/CompareWidget/DBG_Stopwatch_impl"],function(c){b.iterStart=c.iterStart;b.mark=c.mark;b.getTimingOutput=c.getTimingOutput;b.dump=c.dump;b.dbglog=c.dbglog})}}});define("DS/CompareWidget/DnD",["DS/ENO6WPlugins/jQuery"],function(b){this._processingCB=null;this._processingCBThis=null;var a=function(j,e,c,k,h){var f=this;f._dragInVizCB=c;f._dragOutVizCB=k;f._dragOverVizCB=h;f._dragCBThis=e;f._dragInCount=0;f.getDropSide=function(m){var n=m.currentTarget.id;var l=null;if(n==="drop-target-right"||n==="drop-target-right-iconlabel"||n==="drop-target-right-icon"||n==="compare-tree-to-1"){l="drop-right"}else{if((n==="drop-target-left")||(n==="drop-target-left-iconlabel")||(n==="drop-target-left-icon"||(n==="compare-tree-base"))){l="drop-left"}}return l};f.getObjs=function(l){var o=[];var s=null;var t=null;var u=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;if(u){var y=false;if(typeof l.originalEvent.dataTransfer.types.indexOf==="function"){y=(l.originalEvent.dataTransfer.types.indexOf("text/searchitems")>=0)}else{y=l.originalEvent.dataTransfer.types.contains("text/searchitems")}if(y){t=l.originalEvent.dataTransfer.getData("text/searchitems")}else{t=l.originalEvent.dataTransfer.getData("text/plain")}}else{var p=UWA.is(l.originalEvent.dataTransfer.types.indexOf,"function")?"indexOf":"contains";var n="";var x=["text/searchitems","text/plain","Text"];for(var w=0;w<x.length&&n==="";w++){var v=l.originalEvent.dataTransfer.types[p](x[w]);if((UWA.is(v,"number")&&v>=0)||(UWA.is(v,"boolean")&&v===true)){n=x[w]}}if(n!=""){t=l.originalEvent.dataTransfer.getData(n)}}if((t)&&(t!="")){var m=JSON.parse(t).data;for(var r=0;r<m.items.length;r++){var q=m.items[r];o.push(q)}}return(o)};f.handleDragEnter=function(l){l.preventDefault();f._dragInCount++;if(f._dragInCount==1){f._dragInVizCB.call(f._dragCBThis,l)}return true};f.handleDragOver=function(l){l.preventDefault();if(f._dragOverVizCB!=null){f._dragOverVizCB(l)}};f.handleDragLeave=function(l){l.preventDefault();f._dragInCount--;if(f._dragInCount==0){f._dragOutVizCB.call(f._dragCBThis,l)}return true};f.handleDragDropped=function(n){f._dragInCount=0;n.preventDefault();f._dragOutVizCB.call(f._dragCBThis,n);var m=f.getObjs(n);if(m.length>0){var l=f.getDropSide(n);if(_processingCB!=null){_processingCB.call(_processingCBThis,m,l)}}return true};var d={dragenter:f.handleDragEnter,dragover:f.handleDragOver,dragleave:f.handleDragLeave,drop:f.handleDragDropped,dragdrop:f.handleDragDropped};var g=jQuery("#"+j);g.bind(d)};return{_attachedObjects:[],setProcessingCB:function(d,c){_processingCBThis=d;_processingCB=c},attachObject:function(f,c,d,g,e){this._attachedObjects.push(new a(f,c,d,g,e))},}});define("DS/CompareWidget/CompareImgSrc",[],function(){var e="snresources/images/icons/small/";var c="snresources/images/icons/large/";var d={VPMReference:"I_VPMNavProduct.png","3DShape":"I_Part.png",CATPart:"I_DECPrtCV5.png",CATProduct:"I_DECAsmCV5.png","CATIA Embedded Component":"I_DECAsmCV5.png",Drawing:"I_VPMNavDrawing.png",ENOStrRefinementSpecification:"I_AdvancedFilter32.png"};var b={ENOStrRefinementSpecification:"I_AdvancedFilter144.png"};var f="common/images/";var a={Default:"iconSmallDefault.gif",CATShape:"iconSmallCATShape.gif","CATIA CGR":"iconSmallCATIACGR.gif",CATProcess:"iconSmallCATProcess.gif",CATDrawing:"iconSmallCATDrawing.gif","CATIA Design Table":"iconSmallCATIADesignTable.gif","CATIA V4 Model":"iconSmallCATIAV4Model.gif",CATAnalysis:"iconSmallCATAnalysis.gif",CATAnalysisResults:"iconSmallCATAnalysisResults.gif",CATAnalysisComputations:"iconSmallCATAnalysisComputations.gif",Missing:"utilUploadStop.gif"};return{getObjTypeIconPath:function(h){var g=null;if(typeof(d[h])!=="undefined"){g=e+d[h]}else{if(typeof(a[h])!=="undefined"){g=f+a[h]}else{g=f+a.Default}}return g},getObjTypeLargeIconPath:function(j){var g=null;var h=b[j];if(h!=undefined){g=c+b[j]}return g},defaultThumbnailPath:"/webapps/W3DSpace/assets/img/big/I_DefaultThumbnail.png",thumbnailUrlPath:"/resources/compare/thumbnailUrl/",iconUrlPath:"/resources/compare/icon/"}});define("DS/CompareWidget/CompareStructEngine",[],function(){var a=function(h,f,n,g,k){if((h==false)&&(f.level!=n.level)){return this.REL_NONE}var l=this.MATCH_NONE;if((f.src_obj==n.src_obj)||(f.src_obj_root==n.src_obj_root)){l=this.MATCH_SIMILAR}if(((l==this.MATCH_SIMILAR)&&g)||(f.pid==n.pid)||(f.rlv_V5==n.rlv_V5)||((f.type==n.type)&&(f.name==n.name))){l=this.MATCH_OK}var j=this.REL_NONE;if(l!=this.MATCH_NONE){var m=0;if((k==false)&&(f.revision!=n.revision)){m+=1}if((h==false)&&(f.xform!=n.xform)){m+=2}if((h==true)&&(f.Qty!=n.Qty)){m+=4}if(l==this.MATCH_OK){switch(m){case 0:j=this.REL_SAME;break;case 1:j=this.REL_SAME_REV;break;case 2:j=this.REL_SAME_MOVED;break;case 3:j=this.REL_SAME_REV_MOVED;break;case 4:j=this.REL_SAME_QTY;break;case 5:j=this.REL_SAME_REV_QTY;break;default:j=this.REL_UNKNOWN;break}}else{if(l==this.MATCH_SIMILAR){switch(m){case 0:j=this.REL_SIMILAR;break;case 1:j=this.REL_SIMILAR_REV;break;case 2:j=this.REL_SIMILAR_MOVED;break;case 3:j=this.REL_SIMILAR_REV_MOVED;break;case 4:j=this.REL_SIMILAR_QTY;break;case 5:j=this.REL_SIMILAR_REV_QTY;break;default:j=this.REL_UNKNOWN;break}}}}return j};var c=function(h,g){var f=g.length;for(i=0;i<f;i++){var j=g[i];if(j.relType!=this.REL_NONE){b.call(this,j,h,g)}}};var b=function(l,m,k){var o=l.parentIdx;if(o==-1){return}var h=k[o];if((h.diffChecked==null)||(h.diffChecked==false)){h.diffChecked=true;if((h.relType==this.REL_NONE)||(h.relType==this.REL_UNKNOWN)){var g=l.matchNdx;var n=m[g];var f=n.parentIdx;var j=m[f];j.matchNdx=o;h.matchNdx=f;h.relType=this.REL_DIFF}b.call(this,h,m,k)}else{}};function e(f){var l=new Array(f.length);for(var k=0;k<f.length;k++){l[k]=-1}for(var k=0;k<f.length;k++){var h=f[k].objID;l[h]=k}for(var g=0;g<f.length;g++){var m=f[g].parentID;f[g].parentIdx=m==-1?-1:l[m]}}function d(f,g){if((f==undefined)||(f==null)||((f.constructor==String)&&(f==""))){return g}else{return f}}return{REL_FORCED:1,REL_SAME:2,REL_SAME_QTY:3,REL_SAME_REV:4,REL_SAME_MOVED:5,REL_SAME_REV_MOVED:6,REL_SAME_REV_QTY:7,REL_SIMILAR:8,REL_SIMILAR_QTY:9,REL_SIMILAR_REV:10,REL_SIMILAR_MOVED:11,REL_SIMILAR_REV_MOVED:12,REL_SIMILAR_REV_QTY:13,REL_DIFF:14,REL_NONE_LEFT:21,REL_NONE_RIGHT:22,REL_NONE:23,MATCH_NONE:-1,MATCH_OK:1,MATCH_SIMILAR:2,COMPARE_STRUCT:32,COMPARE_LIST:33,createSCO:function(D,x,p,C,j,t,r,o,w,z,m,l,B,A,q,n,s,v,y){var g=d(z,"NOVAL_REVID"+D);var f=d(q,g);var h=d(m,null);if(h==null){h=d(n,g)}var u=null;if((w!=null)&&(w.constructor==Array)){u=w.toString()}var k=d(l,B);k=d(k,"NOVAL_OK");return{coType:"SCO",title:s,objID:x,parentID:p,name:d(C,"NOVAL_NAME"+D),type:d(j,"NOVAL_TYPE"+D),level:t,pid:d(r,"NOVAL_PID"+D),revision:d(o,"NOVAL_REV"+D),xform:d(u,"NOVAL_XFORM"+D),inst_comp:k,rlv_V5:d(A,"NOVAL_ILRV5"+D),src_obj:f,src_obj_root:h,isRoot:v,isLeaf:y}},createLCO:function(u,g,k,f,q,n,t,r,m,j,s,p,l,h){var o=this.createSCO(u,g,"NOVAL_LIST"+u,k,f,"NOVAL_LIST"+u,q,n,"NOVAL_LIST"+u,t,r,"NOVAL_LIST"+u,"NOVAL_LIST"+u,m,j,s,p,l,h);o.coType="LCO";o.Qty=1;return o},evalAssemblies:function(C,R,Q,k){var y=(k.indexOf("ignore_revision")!=-1);var g=(k.indexOf("ignore_dupe")!=-1);e(R);e(Q);if((C!=this.COMPARE_LIST)&&(C!=this.COMPARE_STRUCT)){console.error("BAD Comparison Type requested... defaulting to COMPARE_STRUCT")}var F=(C==this.COMPARE_LIST);try{for(var N=0;N<R.length;N++){R[N].matchNdx=this.MATCH_NONE;R[N].matchSet=[]}var t=[];for(var N=0;N<Q.length;N++){t[N]=N;Q[N].matchNdx=this.MATCH_NONE;Q[N].relType=this.REL_NONE}for(var o=0;o<R.length;o++){var J=R[o];J.matchSet=[];for(var O=0;O<t.length;O++){var w=t[O];var H=Q[w];var A=this.REL_NONE;try{A=a.call(this,F,J,H,g,y)}catch(I){console.log("Exception evaluating nodes: "+I+" continuing...")}var j=false;if(A!=this.REL_NONE){if(J.inst_comp==H.inst_comp){var s=J.parentIdx;if(s!=-1){if((s==0)&&(H.parentIdx==0)){j=true}else{var q=R[s];var E=q.matchNdx;if(E==H.parentIdx){j=true}}}}if(j){J.matchNdx=w;J.matchSet=[];H.matchNdx=o;H.relType=A;t.splice(O,1);break}else{J.matchSet.push({relndx:t[O],reltype:A})}}}}for(var n=0;n<R.length;n++){var J=R[n];var z=false;if(J.matchNdx!=this.MATCH_NONE){}else{var x=J.matchSet;var D=-1;var l=this.REL_NONE;for(var M=0;M<x.length;M++){var L=x[M];var r=L.reltype;var G=L.relndx;var B=false;if(!F){var K=J.parentIdx;var h=Q[G];var p=h.parentIdx;var v=Q[p];B=((K==-1&&K==-1)||(v.matchNdx==K))}if(Q[G].matchNdx!=this.MATCH_NONE){if(B){z=true}}else{var m="";var u=false;if(F){if(r<l){u=true}}else{if((z==false)&&(B==true)){u=true;z=true}if((u==false)&&(z==B)&&(r<l)){u=true}}if(u==true){m=" --->>> BEST SO FAR!!";D=G;l=r}}}if(l==this.REL_NONE){}else{var f=D;var P=Q[f];J.matchNdx=f;P.matchNdx=n;P.relType=l}}if((!F)&&(J.matchNdx!=this.MATCH_NONE)){var f=J.matchNdx;var P=Q[f];b.call(this,P,R,Q)}}}catch(I){console.log("Exception evaluating assemblies:"+I+" continuing...")}},}});define("DS/CompareWidget/CompareAlert",["DS/MessageBus/MessageBus","DS/PADUtils/views/PADAlert","css!DS/CompareWidget/CompareWidget.css"],function(d,a){var c=true;var b={doAlert:function(g){var j="(empty)";var f="warning";try{var j=(!!g?g.msg:null);if(!!(g.alertStyle)){if(g.alertStyle=="compare-alert-error"){f="error"}else{f="warning"}}if(j==null){console.log("%%%% CompareWidget: Blank alert "+f+" sent %%%%")}else{if((c==true)&&(f=="error")){console.log("%%%% CompareWidget "+f+": "+j)}a.displayNotification({msg:g.msg,eventID:f})}}catch(h){console.log("%%%% CompareWidget: Failed to display alert "+f+" '"+j+"' %%%%")}}};return b});define("DS/CompareWidget/AttributeTable",["UWA/Controls/Abstract","DS/Controls/Toggle","DS/UIKIT/Mask","i18n!DS/CompareWidget/assets/nls/CompareWidget"],function(f,e,d,c){var a=false;var b=f.extend({init:function(g){this._parent({});this.container=g;this.buildSkeleton()},setHorizontalLayout:function(g){this.bHorizontal=g},showThumbnails:function(){this.leftThumnailElem.show();for(var g=0;g<this.rightThumnailElems.length;++g){this.rightThumnailElems[g].show()}},hideThumbnails:function(){this.leftThumnailElem.hide();for(var g=0;g<this.rightThumnailElems.length;++g){this.rightThumnailElems[g].hide()}},updateLeftThumbnail:function(g){this.updateThumbnail(this.leftThumnailElem,g)},updateRightThumbnail:function(h,g){this.updateThumbnail(this.rightThumnailElems[h],g)},updateThumbnail:function(h,g){h.setHTML('<img src="'+g+'" width="144px" height="108px" />');if(g==""){h.setHTML("")}},update:function(g){this.clearAttributeElements();var m=2;var j=g.length;for(var h=0;(h<j)&&(m==2);h++){var l=g[h];if((l!==null)&&(l.valuesRight!==null)&&(l.valuesRight.length>1)){this.bHorizontal=true;m=l.valuesRight.length+1}}this.addThumbnailElements(m);for(var h=0;h<j;h++){var l=g[h];var k=this.addAttributeElement(l);k.toShow=l.visible}this.updateVisibilities();d.unmask(this.container)},hideAllAttributesBut:function(k){this.visibleAttrElements=[];var h=this.attrListElem.children;for(var g=0;g<h.length;g++){var j=h[g];j.toShow=false;if(k.indexOf(j.attrName)!=-1){j.toShow=true}}this.updateVisibilities()},hideAttributes:function(k){this.visibleAttrElements=[];var h=this.attrListElem.children;for(var g=0;g<h.length;g++){var j=h[g];j.toShow=false;if(k.indexOf(j.attrName)==-1){j.toShow=true}}this.updateVisibilities()},showAllAttributes:function(){this.visibleAttrElements=[];var h=this.attrListElem.children;for(var g=0;g<h.length;g++){var j=h[g];j.toShow=true}this.updateVisibilities()},updateVisibilities:function(){var k=this.showDiffOnlyToggle.checkFlag;var h=this.attrListElem.children;for(var g=0;g<h.length;g++){var j=h[g];if(j.toShow){if(k){if(j.same){j.hide()}else{j.show()}}else{j.show()}}else{j.hide()}}},buildSkeleton:function(){this.elements.container=this.container;this.container.setStyles({"padding-left":"8px"});var j=c.get("attributes");var m=UWA.createElement("div",{html:"<b>"+j+"</b>"});m.inject(this.container);var l=c.get("attrShowDiffOnly");this.showDiffOnlyToggle=new e({label:l,checkFlag:false});this.showDiffOnlyToggle.elements.container.id="show-diff-only";this.showDiffOnlyToggle.inject(this.container);this.showDiffOnlyToggle.addEventListener("buttonclick",this.showDiffOnlyClicked.bind(this));var k=this.showDiffOnlyToggle.elements.container;var h=k.offsetTop+k.offsetHeight;var g=UWA.createElement("div");g.inject(this.container);g.setStyles({height:"calc(100% - "+h+"px)","overflow-y":"auto"});this.attrThumbnailsElem=UWA.createElement("div");this.attrThumbnailsElem.className="attribute-table-thumbnails";this.attrThumbnailsElem.inject(g);this.attrListElem=UWA.createElement("div");this.attrListElem.className="attribute-table-attribute-list";this.attrListElem.inject(g);d.mask(this.container)},showDiffOnlyClicked:function(g){this.updateVisibilities()},clearAttributeElements:function(){while(this.attrThumbnailsElem.firstChild){this.attrThumbnailsElem.removeChild(this.attrThumbnailsElem.firstChild)}while(this.attrListElem.firstChild){this.attrListElem.removeChild(this.attrListElem.firstChild)}},addThumbnailElements:function(j){if(this.bHorizontal){this.attrThumbnailsElem.setStyle("display","flex")}else{this.attrThumbnailsElem.setStyle("display","inline")}var h=100/(j+1);var k=h.toString()+"%";if(this.bHorizontal){this.titleThumnailElem=UWA.createElement("div");this.titleThumnailElem.inject(this.attrThumbnailsElem);this.titleThumnailElem.setStyle("width",k);this.leftThumnailElem=UWA.createElement("div");this.leftThumnailElem.inject(this.attrThumbnailsElem);this.leftThumnailElem.setStyle("width",k);this.rightThumnailElems=[];for(var g=0;g<j-1;++g){this.rightThumnailElems[g]=UWA.createElement("div");this.rightThumnailElems[g].inject(this.attrThumbnailsElem);this.rightThumnailElems[g].setStyle("width",k)}}else{this.leftThumnailElem=UWA.createElement("div");this.leftThumnailElem.className="attribute-table-left-thumbnail";this.leftThumnailElem.inject(this.attrThumbnailsElem);this.rightThumnailElems=[];for(var g=0;g<j-1;++g){this.rightThumnailElems[g]=UWA.createElement("div");this.rightThumnailElems[g].className="attribute-table-right-thumbnail";this.rightThumnailElems[g].inject(this.attrThumbnailsElem)}}},addAttributeElement:function(r){var p=r.valuesRight.length+1;var s=100/(p+1);var l=s.toString()+"%";var u=UWA.createElement("div");u.className="attribute-table-attribute";if(this.bHorizontal){u.className+=" attribute-table-attribute-horz"}else{u.setStyle("margin-top","4px")}u.attrName=r.name;u.inject(this.attrListElem);if(!r.visible){u.hide()}var o=UWA.createElement("div",{html:"<b>"+r.displayName+"</b>"});o.inject(u);if(this.bHorizontal){o.setStyle("width",l);o.setStyle("backgroundColor","#f4f5f6");o.setStyle("padding","4px")}if((r.valueLeft==r.valuesRight[0])&&!this.bHorizontal){var m=r.valueLeft;if(m==null){m=""}var h=UWA.createElement("div",{html:m,});h.inject(u);u.same=true}else{u.same=true;var g=r.valueLeft;if(g==null){g=""}var k=UWA.createElement("div",{html:g});if(!this.bHorizontal){k.className="attribute-table-attribute-value-left"}k.inject(u);if(this.bHorizontal){k.setStyle("width",l);k.setStyle("padding","4px")}for(var q=0;q<p-1;++q){var n=r.valuesRight[q];if(n==null){n=""}var t=UWA.createElement("div",{html:n});if(!this.bHorizontal){t.className="attribute-table-attribute-value-right"}t.inject(u);if(this.bHorizontal){t.setStyle("width",l);t.setStyle("padding","4px")}var j=(g!=null&&g!=n);if(j){u.same=false;if(this.bHorizontal){t.setStyle("color","#ff0000")}else{t.setStyle("color","#009ddb")}}}}return u}});return b});define("DS/CompareWidget/FilterAttributesWidget",["css!DS/CompareWidget/CompareWidget.css","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/Controls/Toggle","DS/UIKIT/Input/Select","i18n!DS/CompareWidget/assets/nls/CompareWidget"],function(a,g,b,f,e,d){var c=g.extend({callback:null,context:null,attributesList:"",attributeDisplayOption:"default",defaultShowAttributes:"",dontShowAttributes:"",displayAllCheckbox:null,attributeCheckboxes:[],resetButton:null,saveButton:null,cancelButton:null,modal:null,init:function(l,m,j,h){var k=this;this._parent(h);this.elements.container=UWA.createElement("div");this.elements.container.className="filter_attributes_container";l.appendChild(this.elements.container);this.elements.footer=m;this.attributesList=j;if(typeof(h)!=="undefined"&&h!==null){if(typeof(h.callback)!=="undefined"&&h.callback!==null){k.callback=h.callback}if(typeof(h.context)!=="undefined"&&h.context!=null){k.context=h.context}if(typeof(h.getAttributeDisplayOption)!=="undefined"&&h.getAttributeDisplayOption!==null){k.attributeDisplayOption=h.getAttributeDisplayOption()}if(typeof(h.getDefaultShowAttributes)!=="undefined"&&h.getDefaultShowAttributes!==null){k.defaultShowAttributes=h.getDefaultShowAttributes()}if(typeof(h.getDontShowAttributes)!=="undefined"&&h.getDontShowAttributes!==null){k.dontShowAttributes=h.getDontShowAttributes()}k.setAttributeDisplayOptions=h.setAttributeDisplayOptions}this.initUI()},initUI:function(){var n=this;var s=UWA.createElement("div");s.className="attribute-displayoptions";this.displayAllCheckbox=new f({label:d.displayAll,value:"all",visibleFlag:true});this.displayAllCheckbox.inject(s);this.displayAllCheckbox.addEventListener("buttonclick",function(u){if(n.saveButton){n.saveButton.setDisabled(false)}for(var t=0;t<n.attributeCheckboxes.length;++t){n.attributeCheckboxes[t].checkFlag=n.displayAllCheckbox.checkFlag}n.attributeDisplayOption=n.displayAllCheckbox.checkFlag?"all":"selected"});this.elements.container.appendChild(s);var q=UWA.createElement("div");q.className="attributes-scroll-container";this.elements.container.appendChild(q);var p=UWA.createElement("div");p.className="attribute-list-container";q.appendChild(p);function j(u){var v=true;if(n.attributeDisplayOption==="all"){v=false}else{if(n.attributeDisplayOption==="default"){v=true;for(var t=0;t<n.defaultShowAttributes.length;++t){if(n.defaultShowAttributes[t]===u){v=false}}}else{v=false;for(var t=0;t<n.dontShowAttributes.length;++t){if(n.dontShowAttributes[t]===u){v=true}}}}return v?false:true}var h=true;for(var l=0;l<this.attributesList.length;++l){var k=UWA.createElement("div");k.className="attribute-onestring";var m=j(this.attributesList[l].name);if(!m){h=false}this.attributeCheckboxes[l]=new f({label:this.attributesList[l].displayName,value:this.attributesList[l].name,checkFlag:m,visibleFlag:true,});this.attributeCheckboxes[l].inject(k);this.attributeCheckboxes[l].addEventListener("buttonclick",function(v){if(n.saveButton){n.saveButton.setDisabled(false)}n.attributeDisplayOption="selected";var t=true;for(var u=0;u<n.attributeCheckboxes.length;++u){if(!n.attributeCheckboxes[u].checkFlag){t=false}}n.displayAllCheckbox.checkFlag=t});p.appendChild(k)}this.displayAllCheckbox.checkFlag=h;var r=UWA.createElement("div");r.className="filterattributes-OkCancel";this.resetButton=new b({value:d.reset,className:"attrlist-reset",visibleFlag:true,});this.saveButton=new b({value:d.save,className:"primary",visibleFlag:true,disabled:true,});this.cancelButton=new b({value:d.cancel,className:"default",visibleFlag:true,});this.resetButton.inject(r);this.saveButton.inject(r);this.cancelButton.inject(r);this.elements.footer.appendChild(r);this.resetButton.addEvent("onClick",function(){if(n.saveButton){n.saveButton.setDisabled(false)}for(var w=0;w<n.attributesList.length;++w){var t=false;var v=n.attributesList[w].name;for(var u=0;u<n.defaultShowAttributes.length;++u){if(n.defaultShowAttributes[u]===v){t=true}}n.attributeCheckboxes[w].checkFlag=t;n.displayAllCheckbox.checkFlag=false}n.attributeDisplayOption="default"});this.saveButton.addEvent("onClick",function(){var t="";if(n.attributeDisplayOption==="selected"){for(var u=0;u<n.attributesList.length;++u){if(n.attributeCheckboxes[u].checkFlag===false){if(t!==""){t+="|"}t+=n.attributesList[u].name}}}if((n.setAttributeDisplayOptions!==null)&&typeof(n.setAttributeDisplayOptions)==="function"){n.setAttributeDisplayOptions(n.attributeDisplayOption,t)}n.saveButton.disabled=true;n.saveButton.setDisabled(true);n.cancelButton.setDisabled(true);n.resetButton.setDisabled(true);var v={};n.dispatchEvent("onModification",v);var v={};n.dispatchEvent("onClose",v)});n.cancelButton.addEvent("onClick",function(){var t={};n.dispatchEvent("onClose",t)});var o={};this.dispatchEvent("onReady",o)},resizeForScrolling:function(){if(this.modal!==null){var j=this.modal.elements.container.getDimensions();var m=j.height;var p=j.maxHeight;if(p===-1){this.modal._fixMaxWidthAndHeight();j=this.modal.elements.container.getDimensions();m=j.height}var n=this.modal.elements.footer.getDimensions().height;var q=jQuery(".attribute-displayoptions");var k=q[0].offsetTop;var l=q[0].offsetHeight;var o=jQuery(".attributes-scroll-container");var h=m-(k+l)-n;if(h>0){o[0].style.height=h.toString()+"px"}}},});return c});define("DS/CompareWidget/DBG_Popup",["DS/ENO6WPlugins/jQuery","DS/ENOFloatingPanel/ENOFloatingPanel"],function(e,d){var b=null;function a(){b.destroy();delete b;b=null}function c(g){var h=UWA.createElement("div",{"class":"debug-timing-output",html:'<plaintext style="font-size:11px; color:black">'+g});var f={className:"debug-timing-output-modal",title:"Compare Widget / Debug",body:h,overlay:false,closable:true,animate:false,resizable:true,autocenter:true,visible:true,limitParent:true,events:{onResizeFloating:function(){},onShow:function(){},onHide:function(){},onClose:function(){a()}}};b=new d(f);b.inject(document.body);jQuery(".modal-body")[0].style.overflow="scroll"}return{show:function(f){c(f)},hide:function(){a()}}});define("DS/CompareWidget/ViewStateMgr",["i18n!DS/CompareWidget/assets/nls/CompareContent"],function(j){var k=function(l){var o=!(UWA.Utils.Client.Platform.ios||UWA.Utils.Client.Platform.android);var m=l.getPanelParameters();var n={uPrefs:{pref_vizStructPanel:(m.vizStructPanel),pref_vizOverview:(widget.getBool("vizOverview")),pref_vizLegend:(widget.getBool("vizLegend")),pref_vizAttrTable:(m.vizAttrTable),pref_vizViewerPanel:(m.vizViewerPanel)},wState:{state_viewerSupported:l.supportedForViewer&&o,state_isListView:l.isListView}};return n};var e=function(l,m){c(l,m,true)};var a=function(l,m){c(l,m,false)};var c=function(m,o,l){var n=m.rootElement.getElement("#"+o);if(n!=null){if(l){n.show()}else{n.hide()}}};var d=function(q,r){var n=q.leftPanel;if(r.showLeft){q.layout.showPanel(n)}else{q.layout.hidePanel(n)}if(r.expandLeft){q.layout.expand(n)}else{q.layout.collapse(n)}var m="compare-region-header";var l="model-color-window";if(r.showLeftExtras){e(q,m);e(q,l)}else{a(q,m);a(q,l)}var o=q.rootElement.getElement("#compare-legend");if(o!=null){if(r.showLegend){o.show()}else{o.hide()}}var s=q.rootElement.getElement("#overview-container");if(s!=null){if(r.showOverview){s.show()}else{s.hide()}}var t=q.midPanel;if(r.expandMid){q.layout.expand(t)}else{q.layout.collapse(t)}if(r.showMid){q.layout.showPanel(t)}else{q.layout.hidePanel(t)}var p=q.rightPanel;if(r.expandRight){q.layout.expand(p)}else{q.layout.collapse(p)}if(r.showRight){q.layout.showPanel(p)}else{q.layout.hidePanel(p)}if(r.showControllers){q.layout.showControllers()}else{q.layout.hideControllers()}};var b=function(u,z,o){var w=k(u);var s=w.uPrefs;var q=w.wState;var B=false;var t=false;var m=false;var y=false;var n=false;var p=false;var A=false;var r=false;var v=false;var l=false;if(z<=1){B=true;t=true}else{if(z>2){p=true;A=true}else{if(u.bGenericCompare){p=true;A=true}else{l=true;B=true;if(B&&s.pref_vizStructPanel){t=true;m=true;n=s.pref_vizOverview;y=s.pref_vizLegend}p=(o==true)?false:true;if(p&&s.pref_vizAttrTable){A=true}r=(q.state_viewerSupported);if(r&&s.pref_vizViewerPanel){v=true}}}}var x={showControllers:l,showLeft:B,expandLeft:t,showLeftExtras:m,showOverview:n,showLegend:y,showMid:p,expandMid:A,showRight:r,expandRight:v};d(u,x)};var f=function(o,m,l,n,p){if((o!==undefined)&&(o!==null)){if(!m){o.addClass("button-unavail")}else{o.removeClass("button-unavail");if(l){o.addClass("wux-ui-state-active");o.attr("data-command",n)}else{o.removeClass("wux-ui-state-active");o.attr("data-command",p)}}}};var g=function(s,w,n){var r=jQuery('*[data-name="ToggleListView"]');f(r,(w==2)&&!s.bGenericCompare,s.isListView,j.ListViewDeactivate,j.ListViewActivate);var u=jQuery('*[data-name="ToggleOverview"]');f(u,(w==2)&&!s.bGenericCompare,widget.getBool("vizOverview"),j.OverviewHide,j.OverviewShow);var t=jQuery('*[data-name="ToggleLegend"]');f(t,(w==2)&&!s.bGenericCompare,widget.getBool("vizLegend"),j.LegendHide,j.LegendShow);var p=jQuery('*[data-name="ToggleAttr"]');var o=((w>=2)&&(n==false));var l=s.getPanelParameters();f(p,o,l.vizAttrTable,j.AttrHide,j.AttrShow);var m=jQuery('*[data-name="SwapColumns"]');f(m,(w==2),false,"","");var q=jQuery('*[data-name="Refresh"]');f(q,(w>=1),false,"","");var v=jQuery('*[data-name="RemoveAll"]');f(v,(w>=1),false,"","")};var h=function(l){this.ccontent=l};h.prototype.updateWidgetViewState=function(o,p,n){var m=(o.IDleft?1:0)+(o.IDright?1:0)+(o.IDrightMulti.length)+(o.JSONIDleft?1:0)+(o.JSONIDright?1:0);var l=false;if(!(p==undefined)){l=p}if(n!=true){b(o,m,l)}g(o,m,l)};h.prototype.showElement=function(m,n,l){c(m,n,l)};return h});define("DS/CompareWidget/Utils",["UWA/Class","DS/WAFData/WAFData"],function(b,a){var c=b.singleton({init:function(){this._parent({})},requestGet:function(j,k,e,d,h){k.tenant=e.tenant;var g=(j.indexOf("?")!=-1)?"&":"?";j+=g;for(var f in k){j+=f+"="+k[f]+"&"}j=e.url3DSpace+j;a.authenticatedRequest(j,{method:"GET",type:"json",timeout:120000,headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:encodeURIComponent(e.securityContext)},onComplete:d,onFailure:h})},requestObjInfo:function(j,f,d,h){var g="/resources/compare/revisions2";var k={objectId:j};this.requestGet(g,k,f,function e(o){var p=null;var n=o.results;for(var m=0;m<n.length;m++){var l=n[m];if(l.physicalid==j){p=l;break}}d(p)},h)},requestFilter:function(k,g,f,d,j){var h="/resources/FilterBIAPI/Filter/getFilter";var l={filterName:k};this.requestGet(h,l,f,function e(o){var n=null;for(var m=0;m<o.filter.length;m++){var p=o.filter[m];if(g==p.filterPhysicalid){n=p;break}}d(n)},j)},loadFilterRoot:function(h,e,d,f){var g=h.rootPhysicalId;this.requestObjInfo(g,e,function(j){h.rootObj=j;d(j)},f)},loadFilter:function(g,e,d,f){var h=this;h.requestObjInfo(g.physicalid,e,function(k){for(var j in k){g[j]=k[j]}h.requestFilter(g.name,g.physicalid,e,function(l){g.filter=l;h.loadFilterRoot(l,e,function(m){g.revision=m.name+" "+m.revision;d(l)},f)},f)},f)},getFilter:function(h,e,d,f){var g=h.filter;if(g!=null){if(g.rootObj==null){this.loadFilterRoot(g,e,function(){d(g)},f)}else{d(g)}}else{this.loadFilter(h,e,function(j){d(j)},f)}},getRootObj:function(g,e,d,f){if(g.isFilter){this.getFilter(g,e,function(h){d(h.rootObj)},f)}else{if(g.type!=null){d(g)}else{this.requestObjInfo(g.physicalid,e,function(j){for(var h in j){g[h]=j[h]}d(g)},f)}}}});return c});define("DS/CompareWidget/CompareObjMgr",["DS/WAFData/WAFData","i18n!DS/CompareWidget/assets/nls/CompareStructure","DS/CompareWidget/CompareAlert","DS/LifecycleServices/AssemblyJson","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/ListSnapshots/WebServices","DS/CompareWidget/DBG_Stopwatch"],function(q,f,n,c,r,K,v,J){var j="passport";var F=3600000;function d(P,O){var M=P.occurrencerelationships[O].child;P.occurrencerelationships.splice(O);P.occurrences.splice(M);for(var N=0;N<P.occurrencerelationships.length;N++){var L=P.occurrencerelationships[N];if(L.parent>O){oOccurRel.parent--}if(L.child>O){oOccurRel.child--}}}function x(O){var N=O;for(var M=0;M<O.occurrencerelationships.length;){var L=O.occurrencerelationships[M];if((L.relationship=="CatAnalysis")&&(L.parent!=O.rootoccurrence)){d(O,M)}else{M++}}return N}function G(N,M,O,L){if(M=="snapshotID"){r.app_initialization(function(){v.getSnapshotAssembly(null,N,O,L)})}else{if(M=="modelID"){r.app_initialization(function(){K.expandAssembly(null,N,O,L)})}else{console.log("BAD JSON type... fetch aborted")}}}function u(S){for(var O=0;O<S.length;O++){var R=S[O];var M=R.nodes;for(var N=0;N<M.length;N++){var P=M[N];var L=P.attributes;var T=L.revision;var Q=T.indexOf(".");if(Q!=-1){L.revision=T.substring(0,Q)}}}}function p(L,O,Q){var M=-1;for(var N=0;N<L.length;N++){var P=L[N];if(P[O]==Q){M=N;break}}return M}function b(L,O,P){var N=null;var M=p(L,O,P);if(M!=-1){N=L[M]}return N}function y(R,T,M){var O=T.length;for(var S=0;S<O;S++){var P=T[S];var N=P.nodeid;P.nodeNdx=p(R,"nodeid",N);if(S==0){P.parentNodeNdx=-1;P.parentOccNdx=-1}else{var Q=P.occurrenceid;var U=b(M,"child",Q);var L=U.parent;if(U["IEF-UUID"]!=null){P.IEF_UUID=U["IEF-UUID"]}P.parentOccNdx=p(T,"occurrenceid",L);var V=T[P.parentOccNdx].nodeid;P.parentNodeNdx=p(R,"nodeid",V)}}}function l(P){var O=P.length;for(var L=0;L<O;L++){var N=P[L];var M=N;var R=0;var Q=8096;while((M.parentOccNdx!=-1)&&(R<Q)){R++;M=P[M.parentOccNdx]}if(R>=Q){console.log("Problem calculating levels for object; Failsafe level reached");R=0}N.level=R}}var e=["CATProduct","CATPart","CATDrawing","CATAnalysis","CATProcess","CATShape","CATIA CGR","CATIA Embedded Component","VPMReference","VPMRepReference","3DShape","Part"];function k(L){return(e.indexOf(L)!=-1)}function w(W,Z){var N=W.length;for(var O=0;O<N;O++){var M=W[O];var P=M.attributes;if(P.isViewerSupported==undefined){var Y=k(M.type);if(Y){P.isViewerSupported=true}}if(P.Title==undefined){P.Title=M.Title}var aa=["PLMEntity.V_Name","Title","name"];var V=aa.length;var X="";for(var S=0;S<V;S++){var T=P[aa[S]];if((typeof(T)!=undefined)&&(T!=null)&&(T!="")){X=T;break}}P.titleToUse=X}var R=Z.length;for(var U=0;U<R;U++){var Q=Z[U];if(Q.parentNodeNdx!=-1){var L=W[Q.parentNodeNdx];Q.parentPhysicalId=L.physicalid}}}function g(P){var O=P.length;for(var M=0;M<O;M++){var Q=P[M];Q.isLeaf=true}for(var M=0;M<O;M++){var Q=P[M];var L=Q.parentOccNdx;if(L!=-1){var N=P[L];N.isLeaf=false}}}function z(V,M){var S=V.length;var O=false;for(var X=1;X<S;X++){if((V[X].ConnectionId==null)||(V[X].ConnectionId=="")){O=true;break}}if(O==false){return}var Y=[];for(var X=0;X<V.length;X++){var Q=V[X];var U=Q.occurrenceid;Y[U]=X}var T=M.length;for(X=0;X<T;X++){var W=M[X];var R=W.child;var L=W.physicalid;var P=Y[R];var N=V[P];N.ConnectionId=L}Y=null}function E(T,Q){var U=T.length;var L=Q.length;for(var P=0;P<U;P++){var O=T[P];var R=O.nodes;var S=O.occurrences;var N=O.occurrencerelationships;y(R,S,N);l(S);w(R,S);g(S);if(P<L){var M=Q[P];z(S,N)}}}function o(L,S){var U=L[0];var X=U.nodes;var ab=U.occurrencerelationships;var P=L[1];var O=P.nodes;var Q=P.occurrencerelationships;var Z=function(ad){return((ad==undefined)||(ad==null)||(ad=="")?true:false)};var W=[];for(var M=0;M<2;M++){var T=((M==0)?X:O);var Y=T.length;for(var N=0;N<Y;N++){var ac=T[N];if((Z(ac.attributes["revision-latest-version"]))||(Z(ac.attributes["MCADInteg-SourceObj"]))||(Z(ac.attributes["revision-physicalid"]))||(Z(ac.attributes.name))){W.push(ac.physicalid)}}}if(W.length>0){var R=W.join();var V=widget.getValue("x3dPlatformId");var aa=r.get3DSpaceWSUrl(V,"/resources/compare/postInfo/");J.mark({id:"infoSvcCall",str:"[BEGIN] http req: postInfo "});q.authenticatedRequest(aa,{method:"POST",type:"json",timeout:120000,data:R,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(av){J.mark({id:"infoSvcCall",str:"  [END] http req: postInfo"});var ao=av.results;var aj=ao.length;for(var ar=0;ar<aj;ar++){var aq=ao[ar];var ae=aq.physicalid;var ak=aq["revision-latest-version"];var ad=aq["MCADInteg-SourceObj"];var ah=aq["revision-physicalid"];var am=aq.isViewerSupported;var au=aq.name;var ap=[];var al=false;for(var af=0;((al==false)&&(af<2));af++){var an=((af==0)?X:O);var at=an.length;for(var ai=0;ai<at;ai++){var aw=an[ai];var ag=aw.physicalid;if(ag==ae){aw.attributes["MCADInteg-SourceObj"]=ad;aw.attributes["revision-physicalid"]=ah;aw.attributes.name=au;aw.attributes["revision-latest-version"]=ak;aw.attributes.isViewerSupported=am;break}}}}S()}})}}function C(O,P,M,L){var N=[];G(O[1],P[1],function(Q){N.push(Q);G(O[0],P[0],function(R){N.push(R);u(N);var S=[c.convertToViewerFormat(N[0]),c.convertToViewerFormat(N[1])];E(N,S);o(N,function(){M(N,S)})},L)},L)}var H={};function D(N){lut_occurNdxForOccurID={};for(var M=0;M<N.length;M++){var L=N[M];H[L.occurrenceid]=N[M]}}function m(S,N){var R=[];var M=[];for(var P=0;P<N.length;P++){if(N[P].parent==S){R.push({parentOccID:S,childOccID:N[P].child,treeOrder:N[P].treeOrder,PLM_ExternalID:N[P].PLM_ExternalID})}}if(R.length>0){R.sort(function(U,T){return(U.treeOrder-T.treeOrder)});for(var O=0;O<R.length;O++){M.push(R[O]);var Q=m(R[O].childOccID,N);for(var L=0;L<Q.length;L++){M.push(Q[L])}}}return M}function s(T){var P=T;var S=T.occurrences;var M=T.occurrencerelationships;if((M.length==0)||(M[0].treeOrder==undefined)){console.log("Compare Widget: Unable to sort structure / tree order information not present in data.")}else{var O=M[0].treeOrder;var L=true;for(var N=1;N<M.length;N++){if(M[N].treeOrder!=O){L=false}}if(L==true){console.log("Compare Widget: Unable to sort structure / no useful tree order information in data.")}else{D(S);var Q=m(0,M);Q.splice(0,0,{parentOccID:null,childOccID:T.rootoccurrence,treeOrder:"0",PLM_ExternalID:"(none)"});var R=new Array(S.length);for(var N=0;N<Q.length;N++){R[N]=H[Q[N].childOccID]}P.occurrences=R}}return P}function a(M,N,L){var Q=[];var P=s(N[0]);var O=s(N[1]);var S=x(P);var R=x(O);Q=[c.convertToViewerFormat(S),c.convertToViewerFormat(R)];E(N,Q);L(N,Q)}function h(L){}function A(Q,R,N){var M=(Q)?"/resources/compare/index/fetchModelsFromIndex":"/resources/compare/fetchModels";var O=widget.getValue("x3dPlatformId");var P=[];P.push("objectIds="+N.join(","));if((R!=null)&&(R.length!=0)){P.push("&compareOption="+R)}if(Q){var L=r.get3DSpaceBaseUrl(O);P.push("&root3DSpaceUrl="+L)}var S=r.get3DSpaceWSUrl(O,M,P);return S}function B(O,L,N){try{q.authenticatedRequest(O,{method:"GET",type:"json",proxy:j,timeout:F,headers:{Accept:"application/json"},onComplete:L,onFailure:N})}catch(M){console.log("Error loading tree data from server");N()}}function t(X,Z,aa,N,Y){function P(ad){var ae=ad.length;var ab=(ae==0?null:ad[0].Failed_idlist!=null?ad[0].Failed_idlist:ae==1?null:ad[1].Failed_idlist!=null?ad[1].Failed_idlist:null);if(ab!=null){Y(ab)}else{h(ad[0].options);var ac=ad.length;if(ad[ac-1].type=="DEBUG"){ad.splice(ac-1,1)}a(aa,ad,N)}}function S(ae,ad,ab){if(Z.indexOf("requiresIndex")!=-1){var ac=f.not_found_in_index;n.doAlert({msg:ac,alertStyle:"compare-alert-warning"});Y()}else{var ac=f.disabling_index_object_not_found;n.doAlert({msg:ac,alertStyle:"compare-alert-warning"});t(false,Z,aa,N,Y)}}var R=[null,null];function M(ae,ac){var ad=ac.length;var ab=(ad==0?null:ac[0].Failed_idlist!=null?ac[0].Failed_idlist:null);if(ab!=null){Y(ab)}else{R[ae]=ac[0]}if(R[0]!=null&&R[1]!=null){h(R[0].options);a(aa,R,N);R=[null,null]}}function W(ad){var ae=ad.length;var ab=(ae==0?null:ad[0].Failed_idlist!=null?ad[0].Failed_idlist:null);if(ab!=null){Y(ab)}else{h(ad[0].options);var ac=ad.length;if(ad[ac-1].type=="DEBUG"){ad.splice(ac-1,1)}a(aa,ad,N);ad=[null,null]}}function Q(ab){M(0,ab)}function O(ab){M(1,ab)}function U(ae,ac,ab){var ad=f.OBJ_NOT_FOUND;console.log("Compare Widget:: "+ad);n.doAlert({msg:ad,alertStyle:"compare-alert-error"});Y()}if(X){var L=A(X,Z,aa);B(L,P,S)}else{if(aa.length==2){var V=A(X,Z,[aa[0]]);var T=A(X,Z,[aa[1]]);B(V,Q,U);B(T,O,U)}else{var L=A(X,Z,aa);B(L,W,Y)}}}function I(L){j=L}I.prototype.fetchObjsByRootIDs=function(N,P,Q,M,L){if(P!==undefined){a(N,P,M)}else{var O=(Q.indexOf("use_index")!=-1);t(O,Q,N,M,L)}};I.prototype.fetchSnapshotObjsByID=function(M,O,N,L){C(M,O,N,L)};return I});define("DS/CompareWidget/CompareViewer",["i18n!DS/CompareWidget/assets/nls/CompareViewer","DS/CompareWidget/DBG_Stopwatch","DS/UIKIT/Mask",],function(h,o,A){var m=this;var s=null;var e=false;var j=false;var a=null;var n=null;var y=false;var x=false;var u=false;var q=null;var l=null;var w=function(D){function C(E){E.viewer3D.subscribe({event:"onReady"},function(){o.dbglog("  [END] Creating PAD3DViewer...");try{A.unmask(E.targetElement);E.viewer3D.render().inject(E.targetElement);y=true;E.widget.dispatchEvent("onViewer3D_ready2LoadViewerJSON")}catch(F){console.log('Can not dispatch "onViewer3D_ready2LoadViewerJSON", exception: '+F)}});E.viewer3D.subscribe({event:"onLoadingComplete"},function(){try{E.widget.dispatchEvent("onViewer3D_viewerJSONLoadOK")}catch(F){console.log('Can not dispatch "onViewer3D_viewerJSONLoadOK", exception: '+F)}});E.viewer3D.subscribe({event:"onLoadingFailure"},function(){try{E.widget.dispatchEvent("onViewer3D_objLoadFail")}catch(F){console.log('Can not dispatch "onViewer3D_objLoadFail", exception:'+F)}})}var B={widget:D.widget,targetElement:D.targetElement,viewer3D:null,compareAPI3D:null,css_view_class:"windowed",onWidget_updateViewerLegend:function(){if((s!=null)&&(s.compareAPI3D!=null)&&(typeof s.compareAPI3D.setLegendVisibleFlag==="function")){try{var G=(jQuery("#compare-region-left").css("display")!="none");var F=(G==false);s.compareAPI3D.setLegendVisibleFlag(F)}catch(E){console.log("setLegendVisibleFlag support not as expected")}}},onWidget_loadComplete:function(){try{var E=this;if(E.viewer3D===null){if(u){E.viewer3D=q;C(E);q.ODT_init(widget)}else{require(["DS/ENOPAD3DViewer/PAD3DViewer","UWA/Core"],function(G,H){o.dbglog("[BEGIN] Creating PAD3DViewer...");E.viewer3D=new G({widget:E.widget,css_view_class:E.css_view_class,actionbar_corrected:true,windowOptions:{robotVisibility:false,defaultContextualBarVisibility:false,allowDnD:false,workbench:"CompareViewerCmd.xml",workbenchModule:"CompareWidget"}});C(E)})}}}catch(F){console.log("Error loading PAD3DViewer")}},onWidget_viewChanged:function(E){if(E.type==="fullscreen"||E.type==="maximized"){if(E.height){this._setBodyHeight(E.height)}}else{this._setBodyHeight("auto")}widget.dispatchEvent("onUpdateViewerLegend");this.css_view_class=E.type;this.widget.dispatchEvent("onViewChangePAD",E)},_setBodyHeight:function(E){if(E){if(E!=="auto"){E+="px"}this.widget.body.setStyle("height",E)}}};B.widget.addEvent("onLoad",B.onWidget_loadComplete.bind(B));B.widget.addEvent("onViewChange",B.onWidget_viewChanged.bind(B));B.widget.addEvent("onUpdateViewerLegend",B.onWidget_updateViewerLegend.bind(B));return B};var t=function(C){var D=(C!=null)?C.split("/"):[];var B=null;if(D.length>0){if(D.length!=1||D[0]!==""){B=s.viewer3D.unstreamPath(D)}}return B};function g(B,F){var C=[];var I=B;var H=F.mapOccurrenceToPath;for(var E=0;E<H.length;E++){var D=H[E][H[E].length-1];if(D==B){var G=s.viewer3D.unstreamPath(H[E]);C.push(G)}}return C}var d=function(L,G,D){if(this.options==null){return}if(!(L instanceof Array)){L=[L]}if(!(G instanceof Array)){G=[G]}this.options.properties.Old.name=((L[0]==null||L[0].title==null)?"  ":L[0].title);this.options.properties.New.name=((G[0]==null||G[0].title==null)?"  ":G[0].title);if((e==false)||(s==null)||(s.compareAPI3D==null)){return}var O=[];var C=[];var N=s.viewer3D.getHideShowController();for(var Q=0;Q<L.length;Q++){var K=L[Q];if((K.IDPath!=null)&&(K.IDPath!="")){var U=null;if(x){U=g(K.IDPath,this.options.leftViewerJSON)}else{var E=t(K.IDPath);if(E!=null){U=[E]}}if(U!=null){if(N._sceneGraphOverrideSet!=null){var I=N._sceneGraphOverrideSet.createOverride(U);if(I!=null){U.forEach(function(W,V){O.push(W)})}else{}}}}}for(var P=0;P<G.length;P++){var S=G[P];if((S.IDPath!=null)&&(S.IDPath!="")){var U=null;if(x){U=g(S.IDPath,this.options.rightViewerJSON)}else{var E=t(S.IDPath);if(E!=null){U=[E]}}if(U!=null){if(N._sceneGraphOverrideSet!=null){var I=N._sceneGraphOverrideSet.createOverride(U);if(I!=null){U.forEach(function(W,V){C.push(W)})}else{}}}}}this.options.properties.Old.pathElements=O;this.options.properties.New.pathElements=C;var J={};for(var M in this.options.properties){if(this.options.properties.hasOwnProperty(M)){if(M=="New"){J.New={color:this.options.properties.New.color,name:this.options.properties.New.name,nls:this.options.properties.New.nls,pathElements:this.options.properties.New.pathElements}}else{if(M=="Old"){J.Old={color:this.options.properties.Old.color,name:this.options.properties.Old.name,nls:this.options.properties.Old.nls,pathElements:this.options.properties.Old.pathElements}}else{J[M]=this.options.properties[M]}}}}var R=[];if(O.length>0){O.forEach(function(W,V){R.push(W)})}else{J.Old=null}if(C.length>0){C.forEach(function(W,V){R.push(W)})}else{J.New=null}var H=null;var B="";var T=D.toLowerCase();if(T=="hide"){H=N.hide;B="onHide"}else{if(T=="show"){H=N.show;B="onShow"}else{if(T=="update"){H=N.exclusiveShow;B="onExclusiveShow"}}}var F=N.subscribe({event:B},function(){try{s.compareAPI3D.updateCompareModel(J)}catch(V){console.log(V)}N.unsubscribe(F)});H.call(N,{paths:R});widget.dispatchEvent("onUpdateViewerLegend")};var b=function(B){this.targetElement=B;this.options=null;this.viewerLoaded=false;this.rootLoadReqCount=0;if(s==null){s=w({widget:widget,targetElement:this.targetElement})}jQuery("#compare-content").on("loadNewModelEvent",this.load3DComparison.bind(this));jQuery("#compare-content").on("loadNewModelJSONEvent",this.compareViewerJSONReady.bind(this));jQuery("#compare-content").on("loadNewSnapshotEvent",this.load3DComparison.bind(this));jQuery("#compare-content").on("newRowSelectedEvent_3Dviewer",this.newRowSelected.bind(this));jQuery("#compare-content").on("geometryHideShowEvent",this.geometryHideShow.bind(this));A.mask(this.targetElement)};b.prototype.compareViewerJSONReady=function(C,B){if(this._bViewingSnapshots==false){if(this.options!=null){this.options.leftViewerJSON=B.left.viewerJSON;this.options.rightViewerJSON=B.right.viewerJSON;this.options.isSwapped=B.isSwapped;if(y){s.widget.dispatchEvent("onViewer3D_ready2LoadViewerJSON")}else{}}}};var r=function(B){B=B.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return(B&&B.length===4)?"#"+("0"+parseInt(B[1],10).toString(16)).slice(-2)+("0"+parseInt(B[2],10).toString(16)).slice(-2)+("0"+parseInt(B[3],10).toString(16)).slice(-2):""};var c=function(I,F,B,D,J,H){var E=jQuery("#model-color-left").css("background-color");if(E==null){E="rgb(0, 0, 230)"}var G=jQuery("#model-color-right").css("background-color");if(G==null){G="rgb(255,0,255)"}var C={properties:{panel:"reduce",TitleNls:h.Title,New:{nls:h.RightTitle,color:r(G),name:(H!=null?H:"  ")},Old:{nls:h.LeftTitle,color:r(E),name:(J!=null?J:"  ")},Common:{nls:h.CommonTitle,color:"#EEEEEE"}},leftViewerJSON:I,rightViewerJSON:F,leftId:B,rightId:D};return C};b.prototype.load3DComparison=function(G,F){o.mark({id:"Viewer",str:"[BEGIN] load viewer with models "});if((G==null)||(typeof(G)=="undefined")||(G.type==null)||(typeof(G.type)=="undefined")){return}var E=null;var D=null;a=null;n=null;var B=(F.left.title)?F.left.title+" ":"";B+=(F.left.revision)?F.left.revision:"";var C=(F.right.title)?F.right.title+" ":"";C+=(F.right.revision)?F.right.revision:"";x=F.isListView;if(G.type==="loadNewModelEvent"){this._bViewingSnapshots=false;this._leftIsFilter=F.left.isFilter;this._rightIsFilter=F.right.isFilter;this._isSwapped=false;E=null;D=null;a=F.left.physicalId;n=F.right.physicalId;if(this._leftIsFilter){a=a+"_LEFT"}if(this._rightIsFilter){n=n+"_RIGHT"}}else{if(G.type==="loadNewSnapshotEvent"){this._bViewingSnapshots=true;E=F.left.viewerJSON;D=F.right.viewerJSON;a=F.left.physicalId+"_LEFT";n=F.right.physicalId+"_RIGHT"}else{return}}this.options=c(E,D,a,n,B,C);this._attachWidgetEventHandlers.call(this);if((s!=null)&&(s.viewer3D!=null)){A.unmask(this.targetElement);s.targetElement=this.targetElement;s.viewer3D.render().inject(s.targetElement);s.widget.dispatchEvent("onViewer3D_ready2LoadViewerJSON")}};var v=function(F,B){var E=(F)?F.split("/"):[];var C="";for(var D=0;D<E.length;D++){if(D%2==1){C+="/"+E[D]+B+"/"}else{C+=E[D]+B}}return C};var z=function(C){var E="";if(C.data!==null&&C.data.compareData!==null){if(!C.parent.isRoot()){var B=C.data.compareData["physicalid[connection]"];var D=C.data.compareData.physicalid;E=z(C.parent)+"/"+B+"/"+D}else{E=C.data.compareData.physicalid}}return E};function p(D){var B=null;var E="";if(D!=null){B=z(D);if(B==""){B=null}if((D.data!=null)&&(D.data.compareData!=null)){var C=D.data.compareData;E=C.title+" "+C.revision}}return{IDPath:B,title:E}}function f(D){var C=true;var B=jQuery(D);if((B.length>0)&&!(B.is(":checked"))){C=false}return C}var k=function(E){var I=false;var G=f("#checkBoxID_REV");var K=f("#checkBoxID_QTY");var B=f("#checkBoxID_SIMILAR");var F=f("#checkBoxID_MOVED");var D=f("#checkBoxID_DIFF");var C=f("#checkBoxID_SM");var H=f("#checkBoxID_RO");var J=f("#checkBoxID_LO");if(E){if(G&&K&&B&&F&&D&&C&&H&&J){I=true}else{I=false}}else{if(G||K||B||F||D||C||H||J){I=false}else{I=true}}return I};b.prototype.newRowSelected=function(J,C){if(this.options==null){return}var I=function(){var R=jQuery("#structure-treetable-right")[0].tBodies[0].rows.length;var N=[];var T=[];var Q=[];var M=[];for(var O=1;O<R;O++){var S=C.rightTree[0].getNodeByKey(jQuery("#structure-treetable-right")[0].tBodies[0].rows[O].cells[3].id);var L=C.leftTree.getNodeByKey(jQuery("#structure-treetable-left")[0].tBodies[0].rows[O].cells[2].id);var U=p(S);var P=p(L);if((this._bViewingSnapshots)||(this._leftIsFilter)){P.IDPath=v(P.IDPath,this._isSwapped?"_RIGHT":"_LEFT")}if((this._bViewingSnapshots)||(this._rightIsFilter)){U.IDPath=v(U.IDPath,this._isSwapped?"_LEFT":"_RIGHT")}if(jQuery("#structure-treetable-left")[0].tBodies[0].rows[O].style.display=="none"){N.push(P);T.push(U)}else{if(jQuery(jQuery("#structure-treetable-left")[0].tBodies[0].rows[O]).attr("isLeaf")=="true"){Q.push(P);M.push(U)}else{N.push(P);T.push(U)}}}if(N.length>0&&T.length>0){d.call(this,N,T,"hide")}if(Q.length>0&&M.length>0){d.call(this,Q,M,"show")}}.bind(this);var E=k(true);var G=k(false);var F=(C.left.data.isRoot==true||C.right[0].data.isRoot==true);var D=null;var K=null;if(G){var H=C.rightTree[0].getNodeByKey(jQuery("#structure-treetable-right")[0].tBodies[0].rows[0].cells[3].id);var B=C.leftTree.getNodeByKey(jQuery("#structure-treetable-left")[0].tBodies[0].rows[0].cells[2].id);D=p(B);K=p(H)}else{if((E&&F)||(!F)){D=p(C.left);K=p(C.right[0])}}if(E||G){if((this._bViewingSnapshots)||(this._leftIsFilter)){D.IDPath=v(D.IDPath,this._isSwapped?"_RIGHT":"_LEFT")}if((this._bViewingSnapshots)||(this._rightIsFilter)){K.IDPath=v(K.IDPath,this._isSwapped?"_LEFT":"_RIGHT")}}if(G){d.call(this,D,K,"hide")}else{if((E&&F)||(!F)){d.call(this,D,K,"update")}else{I()}}};b.prototype.geometryHideShow=function(K,C){if(this.options==null){return}var D=C.showIndexes.length;var H=[];var M=[];var L=C.showIndexes;var E=L.length;for(var G=0;G<E;G++){var I=L[G];var J=C.right[0].getNodeByKey(jQuery("#structure-treetable-right")[0].tBodies[0].rows[I].cells[3].id);var B=C.left.getNodeByKey(jQuery("#structure-treetable-left")[0].tBodies[0].rows[I].cells[2].id);var F=p(J);var N=p(B);if((this._bViewingSnapshots)||(this._leftIsFilter)){N.IDPath=v(N.IDPath,this._isSwapped?"_RIGHT":"_LEFT")}if((this._bViewingSnapshots)||(this._rightIsFilter)){F.IDPath=v(F.IDPath,this._isSwapped?"_LEFT":"_RIGHT")}H.push(N);M.push(F)}d.call(this,H,M,"update")};b.prototype._viewerJSONsAreReady=function(){return((this.options.leftViewerJSON!=null)&&(this.options.rightViewerJSON!=null))};b.prototype._attachWidgetEventHandlers=function(){var B=this;widget.onViewer3D_ready2LoadViewerJSON=function(){if(!(s&&s.viewer3D)){}else{if(B.rootLoadReqCount==0){if(B._viewerJSONsAreReady()==false){}else{B.rootLoadReqCount++;B._loadViewerJSON(0)}}else{}}};widget.onViewer3D_viewerJSONLoadOK=function(){var F="3DViewerModelLoad"+(B.rootLoadReqCount-1);var C="  [END] Load viewer JSON #"+(B.rootLoadReqCount-1);o.mark({id:F,str:C});try{if(B.rootLoadReqCount==1){B.rootLoadReqCount++;B._loadViewerJSON(1)}else{if(B.rootLoadReqCount==2){var G=s.viewer3D.getRoots();var E=G.length;B.options.properties.Old.occurrence=G[0];B.options.properties.Old.pathElement=t(a);B.options.properties.New.occurrence=G[1];B.options.properties.New.pathElement=t(n);s.viewer3D._frmWindow.getActionBar()._checkWidth();require(["DS/DMU3DCompareAPI/DMU3DCompareAPI"],function(I){try{var J=s.viewer3D._frmWindow;o.mark({id:"DMU3DCompareAPI_CREATE",str:"[BEGIN] Create DMU3DCompareAPI"});if(!s.compareAPI3D){s.compareAPI3D=(u?l:new I(J))}o.mark({id:"DMU3DCompareAPI_CREATE",str:"  [END] DMU3DCompareAPI created"});o.mark({id:"DMU3DCompareAPI_DOIT",str:"[BEGIN] DMU3DCompareAPI compare"});s.compareAPI3D.compare(B.options.properties);e=true;o.mark({id:"DMU3DCompareAPI_DOIT",str:"  [END] DMU3DCompareAPI compare "});o.mark({id:"Viewer",str:"  [END] load viewer with models",comment:"*** models should be visible in viewer now ***"})}catch(H){console.log("--> COMPARE VIEWER / 3D Comparison unavailable: Error loading compareAPI3D: "+H)}widget.dispatchEvent("onUpdateViewerLegend")},function(H){console.log("--> COMPARE VIEWER / Error loading compareAPI3D")})}else{console.log("COMPARE WIDGET: Unexpected event/aborting compare")}}}catch(D){console.log("--> COMPARE VIEWER / Error loading compareAPI3D: "+D)}};widget.onViewer3D_objLoadFail=function(C){console.log("--> COMPARE VIEWER / Error loading:"+C)}};b.prototype._adjustViewerJSON_makeIDsUnique=function(M,B,C){for(var D=0;D<M.results.length;D++){var E=M.results[D];if(E.attributes!=null){var K=-1;for(var L=0;L<M.results[D].attributes.length;L++){var Q=M.results[D].attributes[L];if(Q.hasOwnProperty("name")){var G=Q.value;if(Q.name==="resourceid"){M.results[D].attributes[L]["value"]+=C}}}}}var P=M.mapPathToOccurrence;var O={};var N=Object.keys(P);N.forEach(function(S,T){var U=S.replace(/",/g,C+'",');U=U.replace(/"]/g,C+'"]');O[U]=T});M.mapPathToOccurrence=O;var J=M.mapOccurrenceToPath;var F=[];for(var I=0;I<J.length;I++){F[I]=[];var R=J[I];for(var H=0;H<R.length;H++){F[I].push(R[H]+C)}}M.mapOccurrenceToPath=F};b.prototype._loadViewerJSON=function(G){var B="";var F=0;var D="";if(G==0){B=this.options.leftViewerJSON;F=this.options.leftId;D="_LEFT"}else{if(G==1){B=this.options.rightViewerJSON;F=this.options.rightId;D="_RIGHT"}else{console.log("--> COMPARE WIDGET / attempted to load > 2 models... currently unsupported... ignoring");return}}var E="3DViewerModelLoad"+G;var C="[BEGIN] load viewer JSON #"+G;o.mark({id:E,str:C});if((this._bViewingSnapshots)||(F.endsWith(D))){this._adjustViewerJSON_makeIDsUnique(B,F,D)}s.viewer3D.loadJSON({data:[{rootID:F,structure:B}]});return true};b.prototype.do3DCompare_4_Swap=function(){var H=this;if((H.options!==undefined)&&(H.options!==null)){var J=H._rightIsFilter;H._rightIsFilter=H._leftIsFilter;H._leftIsFilter=J;H._isSwapped=!H._isSwapped;var C=H.options.leftId;H.options.leftId=H.options.rightId;H.options.rightId=C;var E=H.options.leftViewerJSON;H.options.leftViewerJSON=H.options.rightViewerJSON;H.options.rightViewerJSON=E;var D=H.options.properties.New.name;H.options.properties.New.name=H.options.properties.Old.name;H.options.properties.Old.name=D;if((H.options.properties.New.occurrence!==undefined)&&(H.options.properties.Old.occurrence!==undefined)){var L=H.options.properties.New.occurrence;H.options.properties.New.occurrence=H.options.properties.Old.occurrence;H.options.properties.Old.occurrence=L}if((H.options.properties.New.pathElement!==undefined)&&(H.options.properties.Old.pathElement!==undefined)){var F=H.options.properties.New.pathElement;H.options.properties.New.pathElement=H.options.properties.Old.pathElement;H.options.properties.Old.pathElement=F}else{var B=s.viewer3D.getRoots();var G=B.length;H.options.properties.Old.occurrence=B[1];H.options.properties.Old.pathElement=t(H.options.leftId);H.options.properties.New.occurrence=B[0];H.options.properties.New.pathElement=t(H.options.rightId)}if((H.options.properties.New.pathElements!==undefined)&&(H.options.properties.Old.pathElements!==undefined)){var K=H.options.properties.New.pathElements;H.options.properties.New.pathElements=H.options.properties.Old.pathElements;H.options.properties.Old.pathElements=K}if(s&&s.compareAPI3D){try{o.mark({id:"DMU3DCompareAPI_DOIT",str:"[BEGIN] DMU3DCompareAPI compare"});s.compareAPI3D.compare(H.options.properties);jQuery("#compare-content").on("loadNewModelEvent",H.load3DComparison.bind(H));jQuery("#compare-content").on("loadNewModelJSONEvent",H.compareViewerJSONReady.bind(H));jQuery("#compare-content").on("loadNewSnapshotEvent",H.load3DComparison.bind(H));jQuery("#compare-content").on("newRowSelectedEvent_3Dviewer",H.newRowSelected.bind(H));jQuery("#compare-content").on("geometryHideShowEvent",H.geometryHideShow.bind(H));o.mark({id:"DMU3DCompareAPI_DOIT",str:"  [END] DMU3DCompareAPI compare "});widget.dispatchEvent("onUpdateViewerLegend")}catch(I){console.log("--> COMPARE VIEWER / Swap and Recompare failure "+I)}}}};b.prototype.releaseResources=function(C){if(s&&s.viewer3D){var B=s.viewer3D.subscribe({event:"onEndRootRemoved"},function(){if(s&&s.compareAPI3D){try{s.compareAPI3D.clean()}catch(D){}s.compareAPI3D=null;s.viewer3D.unsubscribe(B)}});e=false;s.viewer3D.empty();this._rootLoadReqCount=0}};b.prototype.refresh_4_swap=function(C){if(s&&s.compareAPI3D){try{s.compareAPI3D.clean()}catch(B){console.log("--> COMPARE VIEWER / Setup for Swap and Recompare failure "+B)}}};b.prototype._forODT_viewChange=function(B){if(s!=null&&typeof(s)!=="undefined"){s.onWidget_viewChanged(B)}};b._forODT_configForODT=function(){if(widget!=null){widget.addEventOnce("ENOLCM/CompareWidget/isODT",function(B){console.log("Recieving ODT viewer objects for ODT run...");u=true;q=B.ODT_cwObjects;l=B.ODT_DMU3D})}};return b});define("DS/CompareWidget/CompareTable",["DS/ENO6WPlugins/jQuery","DS/WidgetServices/WidgetServices","DS/LifecycleServices/LifecycleServicesSettings","DS/WAFData/WAFData","DS/CompareWidget/AttributeTable","DS/CompareWidget/CompareImgSrc","DS/CompareWidget/CompareAlert","i18n!DS/CompareWidget/assets/nls/CompareWidget"],function(h,p,c,l,b,m,f,o){var k="";var d=[];var e=[];var n=[];var g=false;var j=false;var a=function(r,q,s){this.attrTable=new b(r);this.proxyType=q;this.securityContext=s;this.savedThumbnailData=[];c.app_initialization(function(){});jQuery("#compare-content").on("newRowSelectedEvent",this.updateTable.bind(this));this.setAttributeDisplayPreferencesToWidget()};a.prototype.reInit=function(q){this.attrTable=new b(q)};a.prototype.setGenericCompare=function(q){g=q;this.attrTable.setHorizontalLayout(q)};a.prototype.updateTable=function(s,x){var z=this;var w=false;if((x!==undefined)&&(x!==null)){if((x.right!==undefined)&&(x.right.length>=2)){w=true}}else{if((this.data!==undefined)&&(this.data!==null)){if((this.data.right!==undefined)&&(this.data.right.length>=2)){w=true}}}x=(x==null)?this.data:x;if(x==null){return}if(this.data!=x){this.data=x;this.getListOfObjIds(x.left);for(var y=0;y<x.right.length;++y){this.getListOfObjIds(x.right[y].parent)}}k="";d=[];if(x.left!==undefined&&x.left!==null&&x.left.data!==null&&x.left.data.compareData!==null&&x.left.data.compareData.publicAttr!==null){k=x.left.data.compareData.physicalid}if(x.right!==undefined&&x.right!==null){for(var y=0;y<x.right.length;++y){if(x.right[y]!==undefined&&x.right[y]!==null&&x.right[y].data!==null&&x.right[y].data.compareData!==null&&x.right[y].data.compareData.publicAttr!==null){d[y]=x.right[y].data.compareData.physicalid}}}if(k===""){var u=true;for(var y=0;y<d.length;++y){if(d[y]!==""){u=false}}if(u){return}}var B=true;if(this.findIdInCache(k)!==-1){B=false;for(var y=0;y<d.length;++y){if(this.findIdInCache(d[y])===-1){B=true}}}if(B){try{var C=widget.getValue("x3dPlatformId");var v=c.get3DSpaceWSUrl(C,"/resources/v1/collabServices/attributes/op/read/");var t=[];if(k!==""){var r="bus/"+k;t.push(r)}for(var y=0;y<d.length;++y){if(d[y]!==""){var r="bus/"+d[y];t.push(r)}}var q={debug_properties:"",lIds:t};q=UWA.Json.encode(q);l.authenticatedRequest(v,{method:"POST",type:"json",proxy:this.proxyType,timeout:30000,data:q,headers:{Accept:"application/json",SecurityContext:encodeURIComponent(z.securityContext),"content-type":"application/json","Accept-Language":widget.lang},onComplete:function(D){z.updateAttrCacheFromAttrData(D.results);z.updateTableFromCache();z.loadThumbnailsIntoTable(w);if(D.results.length<=2){z.updateAttrCacheFromAllIds()}},onFailure:function(E){var D=o.loading_attributes_failed;f.doAlert({msg:D,alertStyle:"compare-alert-warning"});console.log("COMPARE TABLE: failed getting first 2 attributes")}})}catch(A){console.log("Error loading object attribute data from server")}}else{z.updateTableFromCache();z.loadThumbnailsIntoTable(w)}};a.prototype.loadThumbnailsIntoTable=function(t){var v=this;var r="thumbnailimage";var q=this.isAttributeShownInTable(r,false);if(!q){v.attrTable.hideThumbnails();return}v.attrTable.showThumbnails();var A=(typeof(widget)!=="undefined"&&widget)?widget.getValue("x3dPlatformId"):null;if(A==null||A==""){A="OnPremise"}var x=c.get3DSpaceBaseUrl(A);var y=x+m.thumbnailUrlPath;if(k!==""){var u=v.savedThumbnailData[k];if(u!==undefined){v.attrTable.updateLeftThumbnail(u)}else{try{var z=y+k+"/?tenant="+A+"&root3DSpaceUrl="+x;l.authenticatedRequest(z,{proxy:this.proxyType,onComplete:function(B){v.savedThumbnailData[k]=B;v.attrTable.updateLeftThumbnail(B)},onFailure:function(B){v.attrTable.updateLeftThumbnail("")}})}catch(w){v.attrTable.updateLeftThumbnail("")}}}else{v.attrTable.updateLeftThumbnail("")}if(d.length>0){var s=0;if(d[s]!==""){var u=v.savedThumbnailData[d[s]];if(u!==undefined){v.attrTable.updateRightThumbnail(s,u)}else{try{var z=y+d[s]+"/?tenant="+A+"&root3DSpaceUrl="+x;l.authenticatedRequest(z,{proxy:this.proxyType,onComplete:function(B){v.savedThumbnailData[d[0]]=B;v.attrTable.updateRightThumbnail(0,B)},onFailure:function(B){v.attrTable.updateRightThumbnail(0,"")}})}catch(w){v.attrTable.updateRightThumbnail(0,"")}}}else{v.attrTable.updateRightThumbnail(s,"")}if(d.length>1){s=1;if(d[s]!==""){var u=v.savedThumbnailData[d[s]];if(u!==undefined){v.attrTable.updateRightThumbnail(s,u)}else{try{var z=y+d[s]+"/?tenant="+A+"&root3DSpaceUrl="+x;l.authenticatedRequest(z,{proxy:this.proxyType,onComplete:function(B){v.savedThumbnailData[d[1]]=B;v.attrTable.updateRightThumbnail(1,B)},onFailure:function(B){v.attrTable.updateRightThumbnail(1,"")}})}catch(w){v.attrTable.updateRightThumbnail(1,"")}}}else{v.attrTable.updateRightThumbnail(s,"")}if(d.length>2){s=2;if(d[s]!==""){var u=v.savedThumbnailData[d[s]];if(u!==undefined){v.attrTable.updateRightThumbnail(s,u)}else{try{var z=y+d[s]+"/?tenant="+A+"&root3DSpaceUrl="+x;l.authenticatedRequest(z,{proxy:this.proxyType,onComplete:function(B){v.savedThumbnailData[d[2]]=B;v.attrTable.updateRightThumbnail(2,B)},onFailure:function(B){v.attrTable.updateRightThumbnail(2,"")}})}catch(w){v.attrTable.updateRightThumbnail(2,"")}}}else{v.attrTable.updateRightThumbnail(s,"")}if(d.length>3){s=3;if(d[s]!==""){var u=v.savedThumbnailData[d[s]];if(u!==undefined){v.attrTable.updateRightThumbnail(s,u)}else{try{var z=y+d[s]+"/?tenant="+A+"&root3DSpaceUrl="+x;l.authenticatedRequest(z,{proxy:this.proxyType,onComplete:function(B){v.savedThumbnailData[d[3]]=B;v.attrTable.updateRightThumbnail(3,B)},onFailure:function(B){v.attrTable.updateRightThumbnail(3,"")}})}catch(w){v.attrTable.updateRightThumbnail(3,"")}}}else{v.attrTable.updateRightThumbnail(s,"")}}}}}};a.prototype.getDefaultShowAttributes=function(){var q=["thumbnailimage","attribute[Title]","owner","current","modified","type","originated","revision"];return q};a.prototype.getDontShowAttributes=function(){var q=widget.getValue("attributes_not_shown");var r=[];if(q!=="__showall__"){r=q.split("|")}return r};a.prototype.getAttributeDisplayOption=function(){var q=widget.getValue("attributes_display_option");if((q===undefined)||(q===null)||(q==="")){var r=widget.getValue("attributes_not_shown");if(r==="__showall__"){return"all"}else{if(r===""){return"default"}else{return"selected"}}}else{return q}};a.prototype.isAttributeShownInTable=function(t,w){var q=this.getAttributeDisplayOption();var u=true;if(q==="none"){u=true}else{if(q==="all"){u=false}else{if(q==="default"){u=true;var r=this.getDefaultShowAttributes();for(var s=0;s<r.length;++s){if(r[s]===t){u=false}}}else{u=false;var v=this.getDontShowAttributes();for(var s=0;s<v.length;++s){if(v[s]===t){u=true}}}}}return u?false:true};a.prototype.setAttributeDisplayOptions=function(q,u){var r=this;widget.setValue("attributes_display_option",q);if(q==="selected"){widget.setValue("attributes_not_shown",u)}var t=widget.getValue("x3dPlatformId");var s=c.get3DSpaceWSUrl(t,"/resources/AppsMngt/user/setPreferences?name=compare_attributes_display_option&value="+q);l.authenticatedRequest(s,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(w){if(q==="selected"){var v=encodeURIComponent(u);s=c.get3DSpaceWSUrl(t,"/resources/AppsMngt/user/setPreferences?name=compare_attributes_not_shown&value="+v);l.authenticatedRequest(s,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(x){},onFailure:function(x){}})}},onFailure:function(v){}})};a.prototype.setAttributeDisplayPreferencesToWidget=function(){var r=widget.getValue("x3dPlatformId");var q=c.get3DSpaceWSUrl(r,"/resources/AppsMngt/user/getPreferences?name=compare_attributes_display_option");l.authenticatedRequest(q,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(t){var s=t;widget.setValue("attributes_display_option",s);if(s==="selected"){q=c.get3DSpaceWSUrl(r,"/resources/AppsMngt/user/getPreferences?name=compare_attributes_not_shown");l.authenticatedRequest(q,{method:"GET",timeout:5000,headers:{Accept:"application/json",},onComplete:function(u){var v=u;widget.setValue("attributes_not_shown",v)},onFailure:function(u){}})}},onFailure:function(s){}})};a.prototype.findIdInCache=function(s){var r=-1;for(var q=0;q<e.length;++q){if(e[q].id===s){r=q}}return r};a.prototype.updateTableRowVisibility=function(){if(this.attrTable==null){return}var r=this.getAttributeDisplayOption();if(r==="default"){var q=this.getDefaultShowAttributes();this.attrTable.hideAllAttributesBut(q)}else{if(r==="selected"){var s=this.getDontShowAttributes();this.attrTable.hideAttributes(s)}else{this.attrTable.showAllAttributes()}}};a.prototype.updateAttrCacheFromAttrData=function(v){for(var t=0;t<v.length;++t){if(this.findIdInCache(v[t].physicalID)===-1){var x=[];for(var s=0;s<v[t].basicData.length;++s){if(v[t].basicData[s].name=="revision"){var w=v[t].basicData[s].value;if(w!=null){for(var r=0;r<w.length;r++){var q=w[r];var u=q.indexOf(".");if(u!=-1){v[t].basicData[s].value[r]=q.substring(0,u)}}}}x.push(v[t].basicData[s])}for(var s=0;s<v[t].data.length;++s){x.push(v[t].data[s])}e.push({id:v[t].physicalID,data:x})}}};a.prototype.getListOfObjIds=function(s){if((s.data.compareData!==undefined)&&(s.data.compareData!==null)){var r=s.data.compareData.physicalid;if(n.indexOf(r)===-1){n.push(r)}}if((s.children!==undefined)&&(s.children!==null)){for(var q=0;q<s.children.length;++q){this.getListOfObjIds(s.children[q],n)}}};a.prototype.updateAttrCacheFromAllIds=function(){var w=this;try{var y=widget.getValue("x3dPlatformId");var t=c.get3DSpaceWSUrl(y,"/resources/v1/collabServices/attributes/op/read/");var s=[];for(var u=0;(u<n.length);++u){var v=n[u];if(this.findIdInCache(v)===-1){var q="bus/"+v;s.push(q)}}if(s.length>0){if(!w._loadingAllAttributes){var r={debug_properties:"",lIds:s};r=UWA.Json.encode(r);w._loadingAllAttributes=true;l.authenticatedRequest(t,{method:"POST",type:"json",proxy:this.proxyType,timeout:900000,data:r,headers:{Accept:"application/json",SecurityContext:encodeURIComponent(w.securityContext),"content-type":"application/json","Accept-Language":widget.lang},onComplete:function(z){w.updateAttrCacheFromAttrData(z.results);w._loadingAllAttributes=false;w.updateCompareExportButtonState(true)},onFailure:function(z){w._loadingAllAttributes=false}})}}else{w.updateCompareExportButtonState(true)}}catch(x){console.log("Error loading object attribute data from server")}};a.prototype.updateTableFromCache=function(){var v=[];var F=this.getAttributeDisplayOption();var r=(F=="default")?this.getDefaultShowAttributes():"";var K=(F=="selected")?this.getDontShowAttributes():"";var D=this.findIdInCache(k);var E=[];for(var J=0;J<d.length;++J){E[J]=this.findIdInCache(d[J])}var z=[];for(var J=0;J<e.length;++J){for(var H=0;H<e[J].data.length;++H){var I=e[J].data[H].name;var u=false;for(var G=0;(G<z.length)&&!u;++G){if(z[G]===I){u=true}}if(!u){z.push(I)}}}for(var J=0;J<z.length;++J){var y=z[J];var q=null;if((k!=="")&&(D!==-1)){for(var H=0;(H<e[D].data.length)&&(q===null);++H){if(e[D].data[H].name===y){q=e[D].data[H]}}}var L=[];for(var B=0;(B<d.length);++B){L[B]=null;if((d[B]!=="")&&(E[B]!==-1)){for(var H=0;(H<e[E[B]].data.length)&&(L[B]===null);++H){if(e[E[B]].data[H].name===y){L[B]=e[E[B]].data[H]}}}}var I="";var t="";var M="";if(q!==null){I=q.selectable;t=q.nls;M=q.type}else{for(var B=0;B<L.length;++B){if(L[B]!==null){I=L[B].selectable;t=L[B].nls;M=L[B].type}}}if(I!==""){var w=((q!=null)&&(q.value!=null)&&(q.value.constructor==Array))?q.value[0]:"";var C=[];for(var B=0;B<L.length;++B){C[B]=((L[B]!=null)&&(L[B].value!=null)&&(L[B].value.constructor==Array))?L[B].value[0]:""}if(M==="timestamp"||I==="modified"||I==="originated"){w=p.formatDate(w,true);for(var B=0;B<L.length;++B){C[B]=p.formatDate(C[B],true)}}var x="hidden";if(F==="default"){x="hidden";for(var H=0;((H<r.length)&&(x==="hidden"));++H){if(I===r[H]){x=""}}}else{if(F==="selected"){x="";for(var H=0;((H<K.length)&&(x===""));++H){if(I===K[H]){x="hidden"}}}else{if(F==="all"){x=""}}}var A=t;var s=true;if(x=="hidden"){s=false}if(q==null){w=null}v.push({name:I,displayName:t,valueLeft:w,valuesRight:C,visible:s})}}this.attributes=v;if(this.attrTable!=null){this.attrTable.update(v)}widget.dispatchEvent("ENOLCM/CompareWidget/attrTableUpdatedEvent_forODTs","attr table updated")};a.prototype.getAttributeListFromTable=function(){var q=this.attributes.concat([{name:"thumbnailimage",displayName:o.thumbnailimage}]);return q};a.prototype.swapAttributes=function(){if(this.data!=null){if((this.attributes!==undefined)&&(this.attributes!==null)){for(var s=0;s<this.attributes.length;++s){var q=this.attributes[s];if(q!==null){var t=q.valueLeft;q.valueLeft=q.valueRight;q.valueRight=t}}}var r=this.data.left;this.data.left=this.data.right[0];this.data.right[0]=r}};a.prototype.refresh=function(r){if(this.rootElement){this.rootElement.destroy();this.rootElement=null}while(e.length>0){var q=e.pop();while(q.data.length>0){q.data.pop()}}while(n.length>0){n.pop()}this.updateCompareExportButtonState(false);this.data=[];this.savedThumbnailData=[]};a.prototype.getAllAttributes=function(){return e};a.prototype.updateCompareExportButtonState=function(q){var t=jQuery('*[data-name="CompareExport"]');var r=g?false:true;var s=!(UWA.Utils.Client.Platform.ios||UWA.Utils.Client.Platform.android);if(r&&s&&q){t.removeClass("button-unavail")}else{t.addClass("button-unavail")}};return a});define("DS/CompareWidget/CompareStructure",["DS/ENO6WPlugins/jQuery","DS/LifecycleServices/LifecycleServicesSettings","DS/CompareWidget/CompareImgSrc","i18n!DS/CompareWidget/assets/nls/CompareStructure","DS/CompareWidget/DnD","DS/CompareWidget/CompareStructEngine","DS/CompareWidget/DBG_Stopwatch","css!DS/VENCompareWidgetUtils/plugins/fancytree/v2.9.0/fancytree.css","css!DS/CompareWidget/CompareWidget.css"],function(B,D,A,t,Y,j,T){var e=0;var d=0;var w=0;var aa=0;var Z=0;var u=0;var z=0;var o=0;var m=0;var F=false;var v=null;var c=false;var l=null;var I=false;var q=function(ad,ac,ab){v=ab;this.targetElement=ad;this.legendElement=ac;this.fTree_left=null;this.fTreeData_left=[];this.fTree_right=[];this.fTreeData_right=[];this.loadingGif=null};function E(ad,ae,aj,aq){var al={};for(var au=0;au<aq.length;au++){var ah=aq[au].child;al[ah]=au}var at=new Array(aj.length);for(var au=0;au<aj.length;au++){at[au]=null}for(var ap=0;ap<aj.length;ap++){var ab=aj[ap];var ax=ab.occurrenceid;var ag=ae[ab.nodeid];var am=ag.attributes;var ak=(ab.parentNodeNdx==-1);var an=ab.isLeaf;var ac=-1;var af=null;var aw=null;var ar=al[ax];if(ar!=undefined){af=aq[ar]["IEF-UUID"];aw=aq[ar].PLM_ExternalID;ac=aq[ar].parent}var ao=am["MCADInteg-SourceObj"];var av=null;if((ao!="undefined")&&(ao!=null)&&(ao!="")){var ai=ao.split("|");av=ai[0]}at[ap]=j.createSCO(ad,ax,ac,am.name,ag.type,ab.level,ag.physicalid,am.revision,ab.xform,am["revision-physicalid"],am["PLMReference.V_DerivedFrom"],aw,af,am["revision-latest-version"],av,am["MCADInteg-SourceObj-root"],ag.Title,ak,an)}return at}function R(ap,ak,al,ae){var ao=new Array(ak.length);for(var ai=0;ai<ak.length;ai++){ao[ai]=null}for(var an=0;an<al.length;an++){var af=al[an];var ac=af.nodeid;if(ao[ac]!=null){ao[ac].Qty++}else{var ah=ak[ac];var aj=ah.attributes;var ad=(af.parentNodeNdx==-1);var ab=af.isLeaf;var aq=aj["MCADInteg-SourceObj"];var ag=null;if((aq!="undefined")&&(aq!=null)&&(aq!="")){var am=aq.split("|");ag=am[0]}ao[ac]=j.createLCO(ap,an,aj.name,ah.type,ah.physicalid,aj.revision,aj["revision-physicalid"],aj["PLMReference.V_DerivedFrom"],aj["revision-latest-version"],ag,aj["MCADInteg-SourceObj-root"],ah.Title,ad,ab)}}return ao}function J(ab){var ac="ERROR";switch(ab){case j.REL_FORCED:ac="FORCED";break;case j.REL_SAME:ac="SM";break;case j.REL_SAME_QTY:ac="QTY";break;case j.REL_SAME_REV:ac="REV";break;case j.REL_SAME_MOVED:ac="MOVED";break;case j.REL_SAME_REV_QTY:ac="REVQTY";break;case j.REL_SAME_REV_MOVED:ac="REVMOVED";break;case j.REL_SIMILAR:ac="SIMILAR";break;case j.REL_SIMILAR_QTY:ac="SIMILARQTY";break;case j.REL_SIMILAR_REV:ac="SIMILARREV";break;case j.REL_SIMILAR_MOVED:ac="SIMILARMOVED";break;case j.REL_SIMILAR_REV_QTY:ac="SIMILARREVQTY";break;case j.REL_SIMILAR_REV_MOVED:ac="SIMILARREVMOVED";break;case j.REL_DIFF:ac="DIFF";break;case j.REL_NONE:ac="NONE";break;default:ac="UNEXPECTED:'"+ab+"'";break}return ac}function Q(ah,ad,aj,ac,ab,ai,af,ae){var ag=null;if(ac!=null){ag={diffTypeCode:ah,diffType:J(ah),quantity:aj,physicalid:ac.physicalid,type:ac.type,relationship:ac.relationship,cgrurl:ac.cgrurl,icon:ac.icon,"attribute[Spatial Location]":(af==null?null:af.xform),level:(af==null?null:af.level+""),matchresult:ad,title:ac.attributes.titleToUse,name:ac.attributes.name,revision:ac.attributes.revision,occNdx:(af==null?null:af.occurrenceid),parentOccNdx:ai,isLeaf:ab,isRoot:ae};if(af!=null){if(af.parentPhysicalId!=undefined){ag["from.physicalid"]=af.parentPhysicalId}if(af.ConnectionId!=undefined){ag["physicalid[connection]"]=af.ConnectionId}}}return ag}function s(ay,aq,aD,ax,ap,aB){var aH=[];var ar=[null,null];for(var am=0;am<2;am++){var ab=(am==0?ay:ax);var aG=(am==0?aq:ap);var aF=(am==0?aD:aB);var au=(am==1?ay:ax);var ag=(am==1?aq:ap);var aA=(am==1?aD:aB);var aj=ab.length;for(var ai=0;ai<aj;ai++){var aI=ab[ai];if((am==1)&&(aI.relType!=j.REL_NONE)){continue}var az=aI.isLeaf;var ao=aI.Qty;var aw=aI.matchNdx;var af=aI.parentID;var al=(aw==-1?null:au[aw]);var ae=false;var ac=j.MATCH_NONE;var av=j.REL_NONE;var aJ=0;var at=al==null?null:al.parentID;if(al!=null){ac="MATCH_OK";av=(am==0?al.relType:aI.relType);ae=al.isLeaf;aJ=al.Qty}else{ac="MATCH_ONLY_"+am}var an=null;var aC=null;var ah=null;var aK=null;var ad=null;var aE="unknown";if(aI.coType=="LCO"){aC=aG[ai];aE=aI.isRoot;if(av!=j.REL_NONE){ah=ap[aw]}}else{aK=aF[ai];aC=aG[aK.nodeNdx];if(av!=j.REL_NONE){ad=aA[aw];ah=ag[ad.nodeNdx]}}var ak=Q(av,ac,ao,aC,az,af,aK,aE);if(ak!=null){ak.obj2=Q(av,ac,aJ,ah,ae,at,ad,aE);if(aE==true){if(ar[am]!=null){Console.error("Object "+am+" has more than one root...")}else{ar[am]=ak}}else{aH.push(ak)}}}}if(ar[1]!=null){aH.unshift(ar[1])}if(ar[0]!=null){aH.unshift(ar[0])}return aH}q.prototype._getOtherTree=function(ab){return(ab._id===this.fTree_left._id)?this.fTree_right[0]:this.fTree_left};q.prototype._getOtherTrees=function(ab){return(ab._id===this.fTree_left._id)?this.fTree_right:null};function P(ab,ac){V(1,ab,ac)}function a(ab,ac){V(0,ab,ac)}var N=["DIFF","SM","REV","QTY","SIMILAR","RO","LO","MOVED"];var O={REVQTY:["REV","QTY"],SIMILARQTY:["SIMILAR","QTY"],SIMILARREVQTY:["SIMILAR","REV","QTY"],REVMOVED:["REV","MOVED"],SIMILARMOVED:["SIMILAR","MOVED"],SIMILARREV:["SIMILAR","REV"],SIMILARREVMOVED:["SIMILAR","REV","MOVED"],};function V(aj,af,ai){var ah=null;if(aj==0){ah="#structure-treetable-left"}else{if(aj==1){ah="#structure-treetable-right"}else{console.log("INVALID struct compare index");return}}var ac=af.replace("diff-type-","");if(N.indexOf(ac)!=-1){var ab="#checkBoxID_"+ac;if(B(ab).is(":checked")){B(ah)[0].tBodies[0].rows[ai].style.display=""}}else{var ae=O[ac];for(var ag=0;ag<ae.length;ag++){var ad=ae[ag];var ab="#checkBoxID_"+ad;if(B(ab).is(":checked")){B(ah)[0].tBodies[0].rows[ai].style.display=""}}}}function f(ag,ad){var al=B("#structure-treetable-left")[0].tBodies[0].rows[ag];var ae=B("#structure-treetable-right")[0].tBodies[0].rows[ag];al.style.display=ad?"":"none";ae.style.display=ad?"":"none";if(al.className.contains("fancytree-has-children")||ae.className.contains("fancytree-has-children")){var ai=B("#structure-treetable-right")[0].tBodies[0].rows.length;var ak=(ae.ftnode.data.compareData!=null)?Number(ae.ftnode.data.compareData.level):Number(al.ftnode.data.compareData.level);var aj=ag+1;var ac=false;while((aj<ai)&&(!ac)){al=B("#structure-treetable-left")[0].tBodies[0].rows[aj];ae=B("#structure-treetable-right")[0].tBodies[0].rows[aj];var ab=(ae.ftnode.data.compareData!=null)?Number(ae.ftnode.data.compareData.level):Number(al.ftnode.data.compareData.level);if(ab>ak){if(ad){var af=B("#structure-treetable-right")[0].tBodies[0].rows[aj].cells[0].getElementsByTagName("span")[0].className;af=af.replace("diff-type ","");var ah=P(af,aj);ah=a(af,aj)}else{al.style.display="none";ae.style.display="none";al.name="hasParent "+ag;ae.name="hasParent "+ag}}else{ac=true}++aj}}}function S(ai,ac,ab){if((B(B("#structure-treetable-left")[0].tBodies[0].rows[ai]).attr("isLeaf")=="true")||(B(B("#structure-treetable-right")[0].tBodies[0].rows[ai]).attr("isLeaf")=="true")){var ae=false;var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ai];var ad=ag.ftnode.tree.activeNode;if(ad==null){ae=true}else{var af=ag.ftnode;while((af!=null)&&!ae){if(af.key==ad.key){ae=true}af=af.parent}}if(ae){var ah=(ad.tr.style.display=="");if(ah){ac.push(ai)}else{ab.push(ai)}}else{ab.push(ai)}}else{ab.push(ai)}}function G(ae,ak){var am=B("#structure-treetable-right")[0].tBodies[0].rows.length;var aj=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ac=[];var ad=[];if(am<aj){am=aj}var ah="";for(var af=1;af<am;af++){ah=B("#structure-treetable-right")[0].tBodies[0].rows[af].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var al=(ah=="diff-type-REVQTY")||(ah=="diff-type-SIMILARQTY")||(ah=="diff-type-SIMILARREVQTY")||(ah=="diff-type-REVMOVED")||(ah=="diff-type-SIMILARMOVED")||(ah=="diff-type-SIMILARREV")||(ah=="diff-type-SM")||(ah=="diff-type-SIMILAR")||(ah=="diff-type-REV")||(ah=="diff-type-MOVED")||(ah=="diff-type-LO")||(ah=="diff-type-RO")||(ah=="diff-type-QTY");if((ah=="diff-type-DIFF")&&!(al)){if(B("#checkBoxID_DIFF").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ak=true;while(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ak=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}if(ak){S(af,ad,ac)}}p();if(ak){B("#compare-content").trigger("geometryHideShowEvent",{left:ae.left,right:ae.right,hideIndexes:ac,showIndexes:ad})}return null}function n(ag,al){var an=B("#structure-treetable-right")[0].tBodies[0].rows.length;var ak=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ad=[];var af=[];var ac=null;var ap=null;if(an<ak){an=ak}var ai="";for(var ae=1;ae<an;ae++){ai=B("#structure-treetable-right")[0].tBodies[0].rows[ae].cells[0].getElementsByTagName("span")[0].className;ai=ai.replace("diff-type ","");var am=(ai=="diff-type-REVQTY")||(ai=="diff-type-REVMOVED")||(ai=="diff-type-SM")||(ai=="diff-type-DIFF")||(ai=="diff-type-REV")||(ai=="diff-type-MOVED")||(ai=="diff-type-LO")||(ai=="diff-type-RO")||(ai=="diff-type-QTY");if((ai=="diff-type-SIMILAR")&&!(am)){if(B("#checkBoxID_SIMILAR").is(":checked")){if(al){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-right")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=P(ah,ae)}}}}if(al){if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-left")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=a(ah,ae)}}}}}else{f(ae,false)}}else{if((ai=="diff-type-SIMILARQTY")&&!(am)){if(!(B("#checkBoxID_QTY").is(":checked"))){if(B("#checkBoxID_SIMILAR").is(":checked")){if(al){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-right")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=P(ah,ae)}}}}if(al){if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-left")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=a(ah,ae)}}}}}else{f(ae,false)}}}else{if((ai=="diff-type-SIMILARREVQTY")&&!(am)){if(!(B("#checkBoxID_QTY").is(":checked")&&(B("#checkBoxID_REV").is(":checked")))){if(B("#checkBoxID_SIMILAR").is(":checked")){if(al){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-right")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=P(ah,ae)}}}}if(al){if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-left")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=a(ah,ae)}}}}}else{if(!(B("#checkBoxID_QTY").is(":checked")&&(B("#checkBoxID_REV").is(":checked"))&&B("#checkBoxID_SIMILAR").is(":checked"))){f(ae,false)}}}}else{if((ai=="diff-type-SIMILARMOVED")&&!(am)){if(!(B("#checkBoxID_MOVED").is(":checked"))){if(B("#checkBoxID_SIMILAR").is(":checked")){if(al){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-right")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=P(ah,ae)}}}}if(al){if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-left")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=a(ah,ae)}}}}}else{f(ae,false)}}}else{if((ai=="diff-type-SIMILARREV")&&!(am)){if(!(B("#checkBoxID_REV").is(":checked"))){if(B("#checkBoxID_SIMILAR").is(":checked")){if(al){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-right")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=P(ah,ae)}}}}if(al){if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-left")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=a(ah,ae)}}}}}else{f(ae,false)}}}else{if((ai=="diff-type-SIMILARREVMOVED")&&!(am)){if(!(B("#checkBoxID_MOVED").is(":checked")&&(B("#checkBoxID_REV").is(":checked")))){if(B("#checkBoxID_SIMILAR").is(":checked")){if(al){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-right")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=P(ah,ae)}}}}if(al){if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name.contains("hasParent")){var ao=ae;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[ao].name.contains("hasParent")){ao=ao-1}}else{ab=false}}var aq=B("#structure-treetable-left")[0].tBodies[0].rows[ao+1].name;if(aq!=undefined){aq=aq.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[aq].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var aj=a(ah,ae)}}}}}else{if((!B("#checkBoxID_SIMILAR").is(":checked")&&(!B("#checkBoxID_REV").is(":checked"))&&(!B("#checkBoxID_MOVED").is(":checked")))){f(ae,false)}}}}}}}}}if(al){S(ae,af,ad)}}p();if(al){B("#compare-content").trigger("geometryHideShowEvent",{left:ag.left,right:ag.right,hideIndexes:ad,showIndexes:af})}return null}function x(ae,ak){var am=B("#structure-treetable-right")[0].tBodies[0].rows.length;var aj=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ac=[];var ad=[];if(am<aj){am=aj}var ah="";for(var af=1;af<am;af++){ah=B("#structure-treetable-right")[0].tBodies[0].rows[af].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var al=(ah=="diff-type-REVQTY")||(ah=="diff-type-SIMILARQTY")||(ah=="diff-type-SIMILARREVQTY")||(ah=="diff-type-REVMOVED")||(ah=="diff-type-SIMILARMOVED")||(ah=="diff-type-SIMILARREV")||(ah=="diff-type-DIFF")||(ah=="diff-type-SIMILAR")||(ah=="diff-type-REV")||(ah=="diff-type-MOVED")||(ah=="diff-type-LO")||(ah=="diff-type-RO")||(ah=="diff-type-QTY");if((ah=="diff-type-SM")&&!(al)){if(B("#checkBoxID_SM").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}if(ak){S(af,ad,ac)}}p();if(ak){B("#compare-content").trigger("geometryHideShowEvent",{left:ae.left,right:ae.right,hideIndexes:ac,showIndexes:ad})}return null}function y(ag,am){var ao=B("#structure-treetable-right")[0].tBodies[0].rows.length;var al=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ac=[];var af=[];if(ao<al){ao=al}var aj="";var ap=true;var ai=-1;var ad=false;if(B("#structure-treetable-right")[0].tBodies[0].rows[0].cells[2].id!=""){ad=true;ai=0}for(var ae=1;ae<ao;ae++){if(ad!=true){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].cells[2].id!=""){ad=true;ai=ae}}aj=B("#structure-treetable-right")[0].tBodies[0].rows[ae].cells[0].getElementsByTagName("span")[0].className;aj=aj.replace("diff-type ","");var an=aj.contains("diff-type-REVQTY")||aj.contains("diff-type-SIMILARQTY")||aj.contains("diff-type-SIMILARREVQTY")||aj.contains("diff-type-REVMOVED")||aj.contains("diff-type-SIMILARMOVED")||aj.contains("diff-type-SIMILARREV")||aj.contains("diff-type-SM")||aj.contains("diff-type-SIMILAR")||aj.contains("diff-type-REV")||aj.contains("diff-type-MOVED")||aj.contains("diff-type-LO")||aj.contains("diff-type-DIFF")||aj.contains("diff-type-QTY");if((aj=="diff-type-RO")&&!(an)){if(B("#checkBoxID_RO").is(":checked")){if(am){if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[ae].name.contains("hasParent")){var aq=ae;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[aq].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[aq].name.contains("hasParent")){aq=aq-1}}else{ab=false}}var ar=B("#structure-treetable-right")[0].tBodies[0].rows[aq+1].name;if(ar!=undefined){ar=ar.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[ar].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var ak=P(ah,ae)}}}}if(am){if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name==undefined){f(ae,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[ae].name.contains("hasParent")){var aq=ae;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[aq].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[aq].name.contains("hasParent")){aq=aq-1}}else{ab=false}}var ar=B("#structure-treetable-left")[0].tBodies[0].rows[aq+1].name;if(ar!=undefined){ar=ar.replace("hasParent ","");var ah=B("#structure-treetable-right")[0].tBodies[0].rows[ar].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var ak=a(ah,ae)}}}}}else{f(ae,false)}}if(am){S(ae,af,ac)}}p();if(am){B("#compare-content").trigger("geometryHideShowEvent",{left:ag.left,right:ag.right,hideIndexes:ac,showIndexes:af})}return null}function X(ae,ak){var am=B("#structure-treetable-right")[0].tBodies[0].rows.length;var aj=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ac=[];var ad=[];if(am<aj){am=aj}var ah="";for(var af=1;af<am;af++){ah=B("#structure-treetable-right")[0].tBodies[0].rows[af].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var al=ah.contains("diff-type-REVQTY")||ah.contains("diff-type-SIMILARQTY")||ah.contains("diff-type-SIMILARREVQTY")||ah.contains("diff-type-REVMOVED")||ah.contains("diff-type-SIMILARMOVED")||ah.contains("diff-type-SIMILARREV")||ah.contains("diff-type-SM")||ah.contains("diff-type-SIMILAR")||ah.contains("diff-type-REV")||ah.contains("diff-type-MOVED")||ah.contains("diff-type-DIFF")||ah.contains("diff-type-RO")||ah.contains("diff-type-QTY");if((ah=="diff-type-LO")&&!(al)){if(B("#checkBoxID_LO").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}if(ak){S(af,ad,ac)}}p();if(ak){B("#compare-content").trigger("geometryHideShowEvent",{left:ae.left,right:ae.right,hideIndexes:ac,showIndexes:ad})}return null}function h(ae,ak){var am=B("#structure-treetable-right")[0].tBodies[0].rows.length;var aj=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ac=[];var ad=[];if(am<aj){am=aj}var ah="";for(var af=1;af<am;af++){ah=B("#structure-treetable-right")[0].tBodies[0].rows[af].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var al=(ah=="diff-type-SIMILARQTY")||(ah=="diff-type-SIMILARMOVED")||(ah=="diff-type-SM")||(ah=="diff-type-SIMILAR")||(ah=="diff-type-DIFF")||(ah=="diff-type-MOVED")||(ah=="diff-type-LO")||(ah=="diff-type-RO")||(ah=="diff-type-QTY");if(((ah=="diff-type-REV"))&&!(al)){if(B("#checkBoxID_REV").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}else{if(((ah=="diff-type-SIMILARREV"))&&!(al)){if(!(B("#checkBoxID_SIMILAR").is(":checked"))){if(B("#checkBoxID_REV").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}}else{if(((ah=="diff-type-REVMOVED"))&&!(al)){if(!(B("#checkBoxID_MOVED").is(":checked"))){if(B("#checkBoxID_REV").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}}else{if(((ah=="diff-type-REVQTY"))&&!(al)){if(!(B("#checkBoxID_QTY").is(":checked"))){if(B("#checkBoxID_REV").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}}else{if(((ah=="diff-type-SIMILARREVQTY"))&&!(al)){if(!(B("#checkBoxID_QTY").is(":checked")&&B("#checkBoxID_SIMILAR").is(":checked"))){if(B("#checkBoxID_REV").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{if((!B("#checkBoxID_SIMILAR").is(":checked")&&(!B("#checkBoxID_REV").is(":checked"))&&(!B("#checkBoxID_QTY").is(":checked")))){f(af,false)}}}}else{if((ah=="diff-type-SIMILARREVMOVED")&&!(al)){if(!(B("#checkBoxID_MOVED").is(":checked")&&(B("#checkBoxID_SIMILAR").is(":checked")))){if(B("#checkBoxID_REV").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{if((!B("#checkBoxID_SIMILAR").is(":checked")&&(!B("#checkBoxID_REV").is(":checked"))&&(!B("#checkBoxID_MOVED").is(":checked")))){f(af,false)}}}}}}}}}if(ak){S(af,ad,ac)}}p();if(ak){B("#compare-content").trigger("geometryHideShowEvent",{left:ae.left,right:ae.right,hideIndexes:ac,showIndexes:ad})}return null}function K(ae,ak){var am=B("#structure-treetable-right")[0].tBodies[0].rows.length;var aj=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ac=[];var ad=[];if(am<aj){am=aj}var ah="";for(var af=1;af<am;af++){ah=B("#structure-treetable-right")[0].tBodies[0].rows[af].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var al=(ah=="diff-type-REVQTY")||(ah=="diff-type-SIMILARQTY")||(ah=="diff-type-SIMILARREVQTY")||(ah=="diff-type-DIFF")||(ah=="diff-type-SIMILARREV")||(ah=="diff-type-SM")||(ah=="diff-type-SIMILAR")||(ah=="diff-type-REV")||(ah=="diff-type-LO")||(ah=="diff-type-RO")||(ah=="diff-type-QTY");if((ah=="diff-type-MOVED")&&!(al)){if(B("#checkBoxID_MOVED").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}else{if((ah=="diff-type-SIMILARREVMOVED")&&!(al)){if(!(B("#checkBoxID_SIMILAR").is(":checked")&&(B("#checkBoxID_REV").is(":checked")))){if(B("#checkBoxID_MOVED").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{if((!B("#checkBoxID_SIMILAR").is(":checked")&&(!B("#checkBoxID_REV").is(":checked"))&&(!B("#checkBoxID_MOVED").is(":checked")))){f(af,false)}}}}else{if((ah=="diff-type-REVMOVED")&&!(al)){if(!(B("#checkBoxID_REV").is(":checked"))){if(B("#checkBoxID_MOVED").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}}else{if((ah=="diff-type-SIMILARMOVED")&&!(al)){if(!(B("#checkBoxID_SIMILAR").is(":checked"))){if(B("#checkBoxID_MOVED").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}}}}}if(ak){S(af,ad,ac)}}p();if(ak){B("#compare-content").trigger("geometryHideShowEvent",{left:ae.left,right:ae.right,hideIndexes:ac,showIndexes:ad})}return null}function H(ae,ak){var am=B("#structure-treetable-right")[0].tBodies[0].rows.length;var aj=B("#structure-treetable-left")[0].tBodies[0].rows.length;var ac=[];var ad=[];if(am<aj){am=aj}var ah="";for(var af=1;af<am;af++){ah=B("#structure-treetable-right")[0].tBodies[0].rows[af].cells[0].getElementsByTagName("span")[0].className;ah=ah.replace("diff-type ","");var al=(ah=="diff-type-REVMOVED")||(ah=="diff-type-SIMILARMOVED")||(ah=="diff-type-SIMILARREV")||(ah=="diff-type-SM")||(ah=="diff-type-SIMILAR")||(ah=="diff-type-REV")||(ah=="diff-type-MOVED")||(ah=="diff-type-LO")||(ah=="diff-type-RO")||(ah=="diff-type-DIFF");if((ah=="diff-type-QTY")&&!(al)){if(B("#checkBoxID_QTY").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}else{if(((ah=="diff-type-REVQTY"))&&!(al)){if(!(B("#checkBoxID_REV").is(":checked"))){if(B("#checkBoxID_QTY").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}}else{if(((ah=="diff-type-SIMILARQTY"))&&!(al)){if(!(B("#checkBoxID_SIMILAR").is(":checked"))){if(B("#checkBoxID_QTY").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{f(af,false)}}}else{if(((ah=="diff-type-SIMILARREVQTY"))&&!(al)){if(!(B("#checkBoxID_SIMILAR").is(":checked")&&(B("#checkBoxID_REV").is(":checked")))){if(B("#checkBoxID_QTY").is(":checked")){if(ak){if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-right")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-right")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-right")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=P(ag,af)}}}}if(ak){if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name==undefined){f(af,true)}else{if(B("#structure-treetable-left")[0].tBodies[0].rows[af].name.contains("hasParent")){var an=af;var ab=true;while(ab){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name!=undefined){if(B("#structure-treetable-left")[0].tBodies[0].rows[an].name.contains("hasParent")){an=an-1}}else{ab=false}}var ao=B("#structure-treetable-left")[0].tBodies[0].rows[an+1].name;if(ao!=undefined){ao=ao.replace("hasParent ","");var ag=B("#structure-treetable-right")[0].tBodies[0].rows[ao].cells[0].getElementsByTagName("span")[0].className;ag=ag.replace("diff-type ","");var ai=a(ag,af)}}}}}else{if((!B("#checkBoxID_SIMILAR").is(":checked")&&(!B("#checkBoxID_REV").is(":checked"))&&(!B("#checkBoxID_QTY").is(":checked")))){f(af,false)}}}}}}}if(ak){S(af,ad,ac)}}p();if(ak){B("#compare-content").trigger("geometryHideShowEvent",{left:ae.left,right:ae.right,hideIndexes:ac,showIndexes:ad})}return null}function W(af,ab){var ag={};for(var ae in af){switch(af[ae].diffTypeCode){case j.REL_SAME:ag.SM=true;break;case j.REL_FORCED:ag.LO=true;break;case j.REL_NONE_LEFT:ag.LO=true;break;case j.REL_NONE_RIGHT:ag.RO=true;break;case j.REL_SAME_QTY:ag.QTY=true;break;case j.REL_SAME_REV:ag.REV=true;break;case j.REL_SAME_MOVED:ag.MOVED=true;break;case j.REL_SAME_REV_MOVED:ag.REV=true;ag.MOVED=true;break;case j.REL_SAME_REV_QTY:ag.REV=true;ag.QTY=true;break;case j.REL_SIMILAR:ag.SIMILAR=true;break;case j.REL_SIMILAR_REV:ag.SIMILAR=true;ag.REV=true;break;case j.REL_SIMILAR_QTY:ag.SIMILAR=true;ag.QTY=true;break;case j.REL_SIMILAR_MOVED:ag.SIMILAR=true;ag.MOVED=true;break;case j.REL_SIMILAR_REV_MOVED:ag.SIMILAR=true;ag.REV=true;ag.MOVED=true;break;case j.REL_SIMILAR_REV_QTY:ag.SIMILAR=true;ag.REV=true;ag.QTY=true;break;case j.REL_DIFF:ag.DIFF=true;break;default:break}}var ac='<div style="padding-left:10px; padding-right:10px;"><b>'+t.CompareStatus+"</b></div>";for(var ad in ag){if(ag.hasOwnProperty(ad)){ac+='<label class="status-legend-item" ><input type="checkbox" checked="checked" id="checkBoxID_'+ad+'"><span class="diff-type-legend diff-type-'+ad+'"></span></label>';ac+='<div class="status-legend-itemtext">'+t[ad]+"</div>"}}ab.setContent(B('<div class="legend">'+ac+"</div>"))}function M(ab){var ac=B(ab);return{mousedown:function(ad){ac.mousedown(ad);ac.on("touchstart",function(ae){ae.pageX=ae.originalEvent.touches[0].pageX;ad(ae)})},bind:function(ad,ae){if(ad=="mousemove"){ac.bind(ad,ae);ac.bind("touchmove",function(af){af.pageX=af.originalEvent.touches[0].pageX;ae(af)})}else{alert(ad+"is not supported in _jQueryEx")}},unbind:function(ad,ae){if(ad=="mousemove"){ac.unbind(ad,ae);ac.unbind("touchmove",ae)}else{alert(ad+"is not supported in _jQueryEx")}}}}function L(ac,ab){ab.setContent(B(' <div id="compare-tree-base">  <table class="table table-striped table-condensed" id="structure-treetable-left" >   <thead class="hidden"><tr><th></th><th></th><th></th></tr></thead>   <tbody>    <tr><td></td></tr>   </tbody>  </table> </div> <div id="compare-tree-column-separator"> </div> <div id="compare-tree-to-1">  <table class="table table-condensed table-striped" id="structure-treetable-right" >   <thead class="hidden"><tr><th></th><th></th><th></th><th></th></tr></thead>   <tbody>    <tr><td></td><td></td></tr>   </tbody>  </table> </div> <div id="compare-tree-to-2">  <table class="table table-condensed table-striped hidden" id="structure-treetable-right-2" >   <thead class="hidden"><tr><th></th><th></th><th></th><th></th></tr></thead>   <tbody>    <tr><td></td><td></td></tr>   </tbody>  </table> </div> <div id="compare-tree-to-3">  <table class="table table-condensed table-striped hidden" id="structure-treetable-right-3" >   <thead class="hidden"><tr><th></th><th></th><th></th><th></th></tr></thead>   <tbody>    <tr><td></td><td></td></tr>   </tbody>  </table> </div> <div id="compare-tree-to-4">  <table class="table table-condensed table-striped hidden" id="structure-treetable-right-4" >   <thead class="hidden"><tr><th></th><th></th><th></th><th></th></tr></thead>   <tbody>    <tr><td></td><td></td></tr>   </tbody>  </table> </div> <div id="compare-tree-to-5">  <table class="table table-condensed table-striped hidden" id="structure-treetable-right-5" >   <thead class="hidden"><tr><th></th><th></th><th></th><th></th></tr></thead>   <tbody>    <tr><td></td><td></td></tr>   </tbody>  </table> </div>'));if(F==false){Y.attachObject("compare-tree-base",ac,function(){B("#structure-treetable-left").addClass("ft-drop-cue-on");B("#model-color-left").addClass("ft-drop-cue-on")},function(){B("#structure-treetable-left").removeClass("ft-drop-cue-on");B("#model-color-left").removeClass("ft-drop-cue-on")});Y.attachObject("compare-tree-to-1",ac,function(){B("#structure-treetable-right").addClass("ft-drop-cue-on");B("#model-color-right").addClass("ft-drop-cue-on")},function(){B("#structure-treetable-right").removeClass("ft-drop-cue-on");B("#model-color-right").removeClass("ft-drop-cue-on")})}M("div#compare-tree-column-separator").mousedown(function(ae){e=ae.pageX;d=document.getElementById("compare-tree-base").clientWidth;w=document.getElementById("compare-tree-column-separator").clientWidth;aa=document.getElementById("compare-tree-to-1").clientWidth;Z=d+w+aa;var ad=document.getElementById("meta-datacell-base");if(ad!==null){u=document.getElementById("meta-datacell-base").clientWidth;z=document.getElementById("meta-datacell-rowlabel").clientWidth;o=document.getElementById("meta-datacell-to-1").clientWidth;m=u+z+o}ae.stopPropagation();ae.preventDefault();M("div#compare-region-left").bind("mousemove",function(af){if(af.buttons==0){M("div#compare-region-left").unbind("mousemove")}else{var ah=af.pageX-e;var aj=d+ah;var an=aa-ah;var ak=(aj/Z)*100;var am=(an/Z)*100;if((ak>4)&&(ak<96)){document.getElementById("compare-tree-base").style.width=ak+"%";document.getElementById("compare-tree-to-1").style.width=am+"%"}var ar=document.getElementById("meta-datacell-base");if(ar!==null){var aq=u+ah;var ag=o-ah;var ai=(aq/m)*100;var ap=(ag/m)*100;if((aq>144)&&(ag>148)){document.getElementById("meta-datacell-base").style.width=ai+"%";document.getElementById("meta-datacell-to-1").style.width=ap+"%"}}var al=document.getElementById("compare-tree-base").style.width;var ao=document.getElementById("compare-tree-to-1").style.width;document.getElementById("model-color-left").style.width=al;document.getElementById("model-color-right").style.width=ao}});B(window).bind("mouseup",function(af){M("div#compare-region-left").unbind("mousemove");B(window).unbind("mouseup")})})}q.prototype._crNode2treeRowNode=function(ah,aj,ab,ag,ae){var af={key:"index_"+ah},ai={key:"index_"+ah};var ad=l+A.getObjTypeIconPath("Missing");var ac=aj.matchresult;switch(ac){case"MATCH_ONLY_0":af.title=aj.title;af.name=aj.name;af.objectId=(aj.occNdx!=null?aj.occNdx:ah);af.parent=(aj.parentOccNdx==-1?undefined:aj.parentOccNdx);af.icon=aj.icon!=null?(aj.icon.contains("://")?aj.icon:aj.icon.substring(1)):A.getObjTypeIconPath(aj.type);af.thumbnail=aj.thumbnail;af.compareData=aj;if(ae){af.isRoot=aj.isRoot}else{af.isRoot=(aj.parentOccNdx==-1?true:false)}af.isLeaf=aj.isLeaf;ai.title="";ai.name="";ai.objectId="dummy_"+ah;ai.icon="";ai.thumbnail=ad;ai.parent=ab[af.parent];ai.compareData=null;ai.isRoot=false;ai.isLeaf=false;ai.diffType="LO";ai.diffTypeCode=j.REL_NONE_LEFT;ai.diffClasses="diff-type diff-type-"+ai.diffType;break;case"MATCH_ONLY_1":ai.title=aj.title;ai.name=aj.name;ai.objectId=(aj.occNdx!=null?aj.occNdx:ah);ai.parent=(aj.parentOccNdx==-1?undefined:aj.parentOccNdx);ai.icon=aj.icon!=null?(aj.icon.contains("://")?aj.icon:aj.icon.substring(1)):A.getObjTypeIconPath(aj.type);ai.thumbnail=aj.thumbnail;ai.compareData=aj;if(ae){ai.isRoot=aj.isRoot}else{ai.isRoot=(aj.parentOccNdx==-1?true:false)}ai.isLeaf=aj.isLeaf;af.title="";af.name="";af.objectId="dummy_"+ah;af.icon="";af.thumbnail=ad;af.parent=ag[ai.parent];af.compareData=null;af.isRoot=false;af.isLeaf=false;ai.diffType="RO";ai.diffTypeCode=j.REL_NONE_RIGHT;ai.diffClasses="diff-type diff-type-"+ai.diffType;break;default:af.title=aj.title;af.name=aj.name;af.objectId=(aj.occNdx!=null?aj.occNdx:ah);af.parent=(aj.parentOccNdx==-1?undefined:aj.parentOccNdx);af.icon=aj.icon!=null?(aj.icon.contains("://")?aj.icon:aj.icon.substring(1)):A.getObjTypeIconPath(aj.type);af.thumbnail=aj.thumbnail;af.compareData=aj;if(ae){af.isRoot=aj.isRoot}else{af.isRoot=(aj.parentOccNdx==-1?true:false)}af.isLeaf=aj.isLeaf;ai.title=aj.obj2.title;ai.name=aj.obj2.name;ai.objectId=(aj.obj2.occNdx!=null?aj.obj2.occNdx:ah);ai.parent=(aj.obj2.parentOccNdx==-1?undefined:aj.obj2.parentOccNdx);ai.icon=aj.obj2.icon!=null?(aj.obj2.icon.contains("://")?aj.obj2.icon:aj.icon.substring(1)):A.getObjTypeIconPath(aj.obj2.type);ai.thumbnail=aj.obj2.thumbnail;ai.compareData=aj.obj2;if(ae){ai.isRoot=aj.isRoot}else{ai.isRoot=(aj.parentOccNdx==-1?true:false)}ai.isLeaf=aj.obj2.isLeaf;ai.diffType=aj.obj2.diffType;ai.diffTypeCode=aj.obj2.diffTypeCode;ai.diffClasses="diff-type diff-type-"+ai.diffType;break}af.matchRow=ai;ai.matchRow=af;return{left:af,right:ai}};function g(ah,ae,am,ak){for(var ad=0;ad<2;ad++){var ac=ae;if(ad==1){ac=ak}var aj=ac.length;for(var ag=0;ag<aj;ag++){var al=ac[ag];if(al.compareData.type=="3DShape"){if(al.parent!=null){var an=ac[al.parent];if(an.expanded==true){var ai=ah.getNodeByKey(an.key);var ab=am.getNodeByKey(an.key);ai.setExpanded(false);ab.setExpanded(false);an.expanded=false;var af=an.matchRow;af.expanded=false}}}}}}q.prototype._showCompareResults=function(aj,aq,ar,ai){var an=0;for(var ag=1;ag<aj.length;++ag){if(aj[ag].length>an){an=aj[ag].length}}this.fTreeData_left=[];this.fTreeData_right=[];for(var ag=1;ag<aj.length;++ag){var ab=aj[ag];var ad=[];var am=[];var af=[];var ap=[];this.fTreeData_right[ag-1]=[];for(var ac=0;ac<an;ac+=1){var ao=ab[ac];var al=this._crNode2treeRowNode(ac,ao,ad,am,ai);var ah=al.left.objectId;var ae=al.right.objectId;ad[ah]=ae;am[ae]=ah;af[ah]=al.left;ap[ae]=al.right;if(ag===1){C(al.left,this.fTreeData_left,af)}C(al.right,this.fTreeData_right[ag-1],ap)}if(ag===1){W(ap,this.legendElement)}}if(this.loadingGif!==null&&typeof(this.loadingGif)!=="undefined"){this.loadingGif.hide()}L(this,this.targetElement);var ak=this;require(["DS/CompareWidgetUtils/Fancytree","DS/CompareWidgetUtils/Fancytree_table"],function(av,az){ak.fTree_left=ak._createFancyTree("#structure-treetable-left",ak.fTreeData_left,1,r).fancytree("getTree");for(var ay=1;ay<aj.length;++ay){var aw="#structure-treetable-right";if(ay>1){aw+="-"+ay}ak.fTree_right[ay-1]=ak._createFancyTree(aw,ak.fTreeData_right[ay-1],ay+1,r).fancytree("getTree")}if(ai==false){g(ak.fTree_left,af,ak.fTree_right[0],ap)}if(aq[0]!=null){k(ak.fTree_left,aq[0])}if(aq[1]!=null){k(ak.fTree_right[0],aq[1])}var at=B("#structure-treetable-right").height();var aA=B("#structure-treetable-left").height();if(at<aA){at=aA}B("#compare-tree-column-separator").height(at);p();var au=aj[1];var aB=((I==true)||(au[0].diffTypeCode!=j.REL_NONE));ar(aB);var ax={left:ak.fTree_left,right:ak.fTree_right};B("#checkBoxID_SIMILAR").on("click",ax,(function(aD){var aC=n(aD.data,true)}));B("#compare-legend #checkBoxID_DIFF").on("click",ax,(function(aD){var aC=G(aD.data,true)}));B("#compare-legend #checkBoxID_LO").on("click",ax,(function(aD){var aC=X(aD.data,true)}));B("#compare-legend #checkBoxID_RO").on("click",ax,(function(aD){var aC=y(aD.data,true)}));B("#compare-legend #checkBoxID_MOVED").on("click",ax,(function(aD){var aC=K(aD.data,true)}));B("#compare-legend #checkBoxID_REV").on("click",ax,(function(aD){var aC=h(aD.data,true)}));B("#compare-legend #checkBoxID_QTY").on("click",ax,(function(aD){var aC=H(aD.data,true)}));B("#compare-legend #checkBoxID_SM").on("click",ax,(function(aD){var aC=x(aD.data,true)}));widget.dispatchEvent("ENOLCM/CompareWidget/structCompareDoneEvent_forODTs","Struct Compare");T.mark({id:"Compare_Struct",str:"  [END] Compare Structure",comment:"*** struct compare should be fully displayed ***"})})};function b(ab){var ad=ab.rootNode.children;for(var ac=0;ac<ad.length;ac++){var ae=ad[ac];if(ae.data.compareData!=null){return ae}}return null}function k(ab,af){var ac=b(ab);var ae=ac.tr.getElementsByClassName("fancytree-node")[0];var ad=document.createElement("div");ad.title=af;ad.className="wux-layouts-treeview-badge wux-ui-3ds wux-ui-3ds-filter wux-ui-3ds-lg";ad.style="visibility: visible; top: 15px; left:45px";ae.appendChild(ad)}function C(ab,ad,ae){if((ab.parent==undefined)||(ab.parent.toString().startsWith("NOVAL_LIST"))){ab.parent=null;ad.push(ab)}else{var ac=ae[ab.parent];if(ac==null){console.error("FTree>>  ****** FAILED TO FIND PARENT ("+ab.parent+") WHILE BUILDING FANCYTREE *****");console.error("FTree>>  ****           THIS SHOULD NEVER HAPPEN                ****")}else{if(!("children" in ac)){ac.children=[];ac.folder=true;ac.expanded=true}ac.children.push(ab)}}}q.prototype._createFancyTree=function(ad,ac,ab,ae){return B(ad).fancytree({extensions:["table"],checkbox:false,table:{indentation:20,nodeColumnIdx:ab},imagePath:l+"/",source:ac,renderColumns:ae,activate:this.onActivate.bind(this),expand:this.onExpand.bind(this),collapse:this.onCollapse.bind(this)})};function r(ab,ag){var af=ag.node;var ai=(af.tree.columnCount==4);var am=0;var ac=af.data.isLeaf;if(ac){B(af.tr).attr("isLeaf",true)}else{B(af.tr).attr("isLeaf",false)}if(ai){var ao=am++}var ak=am++;var aj=am++;var ae=am++;var ar=B(af.tr).find(">td");if(ai){var ao=0;ar.eq(ao).html('<span class="'+af.data.diffClasses+'"/>');B(ar.eq(ao)).addClass("change-field")}B(ar.eq(aj)).addClass("title-field");B(ar.eq(ae)).addClass("revision-field");if(af.data.compareData!=null){var ah=af.data.compareData.title;var ap=af.data.compareData.revision;var aq=af.data.compareData.physicalid;var al=af.data.compareData.name;var an=af.key;if(c){var ad=af.data.compareData.quantity;ar.eq(ak).html("<span>"+ad+"</span>");B(ar.eq(ak)).addClass("quantity-field")}else{ar.eq(ak).html("<span>&nbsp;</span>");B(ar.eq(ak)).addClass("quantity-field-hidden")}if(ap!=null){ar.eq(ae).html("<span>"+ap+"</span>");B(ar.eq(ae)).addClass("revision-field");B(ar.eq(ae)).attr("id",an)}if(ah!=null){if(al!=null){B(ar.eq(aj)).attr("id",al)}B(ar.eq(aj)).attr("title",ah);B(ar.eq(aj)).addClass("title-field")}}else{ar.eq(aj).html('<span class="fancytree-node"       style="padding-left: 20px;"><span class="fancytree-expander" style="display:none;"></span><span class="fancytree-title"    style="display:inline;">&nbsp;</span></span>');ar.eq(ae).html("<span>&nbsp;</span>");ar.eq(ak).html("<span>&nbsp;</span>");if(c){B(ar.eq(ak)).addClass("quantity-field")}else{B(ar.eq(ak)).addClass("quantity-field-hidden")}}}q.prototype._setExpanded=function(ag,ab){var ah,ae;if(ag.originalEvent!=undefined){ah=this._getOtherTree(ag.tree);ae=ah.getNodeByKey(ag.node.key);ae.setExpanded(ab)}var af=B("#structure-treetable-right").height();var ad=B("#structure-treetable-left").height();if(af<ad){af=ad}B("#compare-tree-column-separator").height(af);if(ab){var ac=G(null,false);ac=X(null,false);ac=y(null,false);ac=K(null,false);ac=h(null,false);ac=H(null,false);ac=n(null,false);ac=x(null,false)}p()};function p(){B("#structure-treetable-right.fancytree-ext-table tr:visible:odd>td").removeClass("compare_row_even");B("#structure-treetable-right.fancytree-ext-table tr:visible:odd>td").addClass("compare_row_odd");B("#structure-treetable-right.fancytree-ext-table tr:visible:even>td").removeClass("compare_row_odd");B("#structure-treetable-right.fancytree-ext-table tr:visible:even>td").addClass("compare_row_even");B("#structure-treetable-left.fancytree-ext-table tr:visible:odd>td").removeClass("compare_row_even");B("#structure-treetable-left.fancytree-ext-table tr:visible:odd>td").addClass("compare_row_odd");B("#structure-treetable-left.fancytree-ext-table tr:visible:even>td").removeClass("compare_row_odd");B("#structure-treetable-left.fancytree-ext-table tr:visible:even>td").addClass("compare_row_even")}q.prototype._doActivate=function(af){var ag=null;var ac=null;var ab=this._getOtherTree(af.tree);var ad=ab.getNodeByKey(af.node.key);var aj=null;B(af.node.tr).addClass("info");if(af.tree._id===this.fTree_left._id){B(af.node.tr).addClass("leftActive")}else{B(af.node.tr).addClass("rightActive")}ad.setActive();I=true;if(af.tree._id===this.fTree_left._id){var ah=this._getOtherTrees(af.tree);var ai=[];for(var ae=0;ae<ah.length;++ae){ai[ae]=ah[ae].getNodeByKey(af.node.key)}B("#compare-content").trigger("newRowSelectedEvent",{left:af.node,right:ai,leftTree:af.tree,rightTree:ah});B("#compare-content").trigger("newRowSelectedEvent_3Dviewer",{left:af.node,right:ai,leftTree:af.tree,rightTree:ah})}};q.prototype.onActivate=function(ab,ac){this._doActivate(ac)};q.prototype.onExpand=function(ab,ac){this._setExpanded(ac,true)};q.prototype.onCollapse=function(ab,ac){this._setExpanded(ac,false)};function U(){var ab=widget.getValue("x3dPlatformId");l=D.get3DSpaceBaseUrl(ab)}q.prototype.compareUsingJSONObjs=function(at,ao,an,al,ah){var ab=null;c=at;U();I=false;var aq=[];var ae=[];var aj=[];for(var ap=0;ap<al.length;++ap){aq[ap]=al[ap].nodes;ae[ap]=al[ap].occurrences;aj[ap]=al[ap].occurrencerelationships}var ar=this;T.mark({id:"Compare_Struct",str:"[BEGIN] Compare Structure"});T.mark({id:"structCompCalc",str:"[BEGIN] Compare Calculation "});var ag=null;if(at){ag=j.COMPARE_LIST}else{ag=j.COMPARE_STRUCT}var af=[];for(var ap=0;ap<al.length;++ap){if(at){af[ap]=R(ap,aq[ap],ae[ap],aj[ap])}else{af[ap]=E(ap,aq[ap],ae[ap],aj[ap])}}var ad=[];var ai=false;if((al.length>2)||ao){ai=true}for(var ap=1;ap<al.length;++ap){if(ai){var am=af[0];am[0].matchNdx=0;am[0].matchSet=[];var ak=af[ap];ak[0].matchNdx=0;ak[0].relType=j.REL_SIMILAR}else{j.evalAssemblies(ag,af[0],af[ap],an)}T.mark({id:"structCompCalc",str:"  [END] Compare Calculation",comment:"*** struct diff now computed ***"});ad[ap]=s(af[0],aq[0],ae[0],af[ap],aq[ap],ae[ap])}var ac=[null,null];for(var ap=0;ap<2;ap++){if(al[ap].isFilter==true){ac[ap]=al[ap].filterName}}ar._showCompareResults(ad,ac,ah,c)};q.prototype.refresh=function(ab){if(ab){I=false}if(this.targetElement){this.targetElement.destroy();this.targetElement=null}if(this.legendElement){this.legendElement.destroy();this.legendElement=null}};return q});define("DS/CompareWidget/PickDialogView",["UWA/Core","UWA/Class/View","UWA/Class/Model","UWA/Class/Collection","UWA/Drivers/Alone","DS/UIKIT/Input/Button","DS/WAFData/WAFData","DS/W3DXComponents/Skeleton","DS/CompareWidget/CompareImgSrc","DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleServices/LifecycleServices","i18n!DS/CompareWidget/assets/nls/CompareWidget","css!DS/CompareWidget/CompareWidget.css"],function(s,R,M,c,J,N,t,T,r,l,P,K,O,y){var u=null;var F=r.defaultThumbnailPath;var k=r.getObjTypeIconPath("Default");var g=r.thumbnailUrlPath;var m=r.iconUrlPath;var q="revisionsFacet";var z="alternateDesignsFacet";var C="historyGraphFacet";var w="filtersFacet";var a="";var I="";var Q=-1;var h="";var f="";var E="";var v="";var j=null;var H=null;function G(X,W){var V=r.getObjTypeIconPath(X);return W+"/"+V}function b(ab,ae,X,W,ad,aa){var Y="";var ac=(typeof(widget)!=="undefined"&&widget)?widget.getValue("x3dPlatformId"):null;if(ac==null||ac==""){ac="OnPremise"}var V=ab+g+X+"/?tenant="+ac+"&root3DSpaceUrl="+ab;var Z=ab+F;t.authenticatedRequest(V,{ndx:0,proxy:ae,onComplete:function(ag){if(ag.endsWith("iconLargeDefault.png")){var af=r.getObjTypeLargeIconPath(aa);if(af!=null){ag=ab+"/"+af}}jQuery(ad).find(W).attr("src",ag)},onFailure:function(){jQuery(ad).find(W).attr("src",Z)}})}function L(aa,ae,W,V,ad,Y){var X="";var ac=(typeof(widget)!=="undefined"&&widget)?widget.getValue("x3dPlatformId"):null;if(ac==null||ac==""){ac="OnPremise"}var Z=aa+m+W+"/?tenant="+ac+"&root3DSpaceUrl="+aa;var ab=aa+k;t.authenticatedRequest(Z,{ndx:0,proxy:ae,onComplete:function(ag){if(ag.endsWith("iconLargeDefault.png")){var af=r.getObjTypeIconPath(Y);if(af!=null){ag=aa+"/"+af}}jQuery(ad).find(V).attr("src",ag)},onFailure:function(){jQuery(ad).find(V).attr("src",ab)}})}function x(aa,ad,Y,Z){if(ad.physicalid==h&&aa.getElement(".picked-tile-sub-container")!==null){return}var W=Y+F;var ac=Y+k;var X="#"+aa.id;var ab=null;var V=ad["PLMEntity.V_Name"];if(V==null||V==""){V=ad.Title}if(V==null||V==""){V=ad.name}aa.setContent(jQuery('<div class="picked-tile-sub-container" id="'+ad.physicalid+'"><div class = "picked-tile-header"><img class = "picked-tile-image"  alt="[img missing]" id="picked-thumb" src="'+W+'" draggable="false"></div><div class = "picked-tile-body"><img class = "picked-tile-icon" id="picked-icon"  src="'+ac+'" draggable="false" onError="this.onerror=null;this.src=\''+ac+'\';"><div class = "picked-tile-title">'+V+'</div><div class = "picked-tile-subtitle">'+ad.type+'</div><div class = "picked-tile-content">'+ad.revision+"</div></div></div>"));b(Y,Z,ad.physicalid,"#picked-thumb",X,ad.internalType);L(Y,Z,ad.physicalid,"#picked-icon",X,ad.internalType);h=ad.physicalid;f=ad.isFilter?ad.revision:ad.name+" "+ad.revision;E=ad.type;v=ad.internalType}var D=M.extend({idAttribute:"physicalid",sync:function(X,W,V){return this._parent(X,W,s.merge({ajax:t.authenticatedRequest,headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:encodeURIComponent(this.securityContext)},onFailure:V.onComplete,type:"json",proxy:W.proxyType,timeout:120000},V))}});var U=M.extend({sync:function(X,W,V){return this._parent(X,W,s.merge({ajax:t.authenticatedRequest,headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:encodeURIComponent(this.securityContext)},onFailure:V.onComplete,type:"json",proxy:W.proxyType,timeout:120000},V))}});var B=M.extend({sync:function(X,W,V){return this._parent(X,W,s.merge({ajax:t.authenticatedRequest,headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:encodeURIComponent(this.securityContext)},onFailure:V.onComplete,type:"json",proxy:W.proxyType,timeout:120000},V))}});var p=M.extend({sync:function(X,W,V){return this._parent(X,W,s.merge({ajax:t.authenticatedRequest,headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:encodeURIComponent(this.securityContext)},onFailure:V.onComplete,type:"json",proxy:W.proxyType,timeout:120000},V))}});function S(aa,V,W){var Y=false;for(var Z=0;Z<W.length&&!Y;Z++){var X=W[Z];if(X.trg===aa){if(V.indexOf(X.src)>=0){Y=true}else{Y=S(X.src,V,W)}}}return Y}function n(Z,W,Y,V){for(var aa=0;aa<W.length;aa++){var X=W[aa];if(X.typ.contains("revision")){if((Y!=="earlier")&&(X.src===Z)){V.push(X.trg);n(X.trg,W,"later",V)}if((Y!=="later")&&(X.trg===Z)){V.push(X.src);n(X.src,W,"earlier",V)}}}}function o(V){var W=c.extend({nameSelFacet:V,setup:function(Z,Y){this.url=Y.baseURL;this.tenant=(typeof(widget)!=="undefined"&&widget)?widget.getValue("x3dPlatformId"):null;if(this.tenant==null||this.tenant==""){this.tenant="OnPremise"}this.errorMngt=Y.errorMngt;this.oId=Y.rootObj.physicalid;this.objType=Y.rootObj.internalType;this.droppedId=Y.droppedObj.physicalid;this.isFilter=Y.droppedObj.isFilter;this.securityContext=Y.securityContext;this.proxyType=Y.proxyType;this.container=Y.container;this.baseContainer=Y.baseContainer;this.callbackFn=Y.callbackFn;this.dataSetRev=Y.dataSetRev;this.dataSetAlt=Y.dataSetAlt;this.isOdt=Y.isOdt;this.isHistoryEmbedded=Y.isHistoryEmbedded;this.isCompare=Y.isCompare;var aa=this.container.getElements(".facetviews > .set-container");var X=aa.length;if(V===q){this.model=D}else{if(V===z){this.model=U;if((Y.dupFiltering===undefined)||(Y.dupFiltering===null)){this.dupFiltering="all"}else{this.dupFiltering=Y.dupFiltering}if((Y.dupRevsFiltering===undefined)||(Y.dupRevsFiltering===null)){this.dupRevsFiltering="all"}else{this.dupRevsFiltering=Y.dupRevsFiltering}Q=aa.length}else{if(V===C){this.model=B}else{this.model=p}}}},parse:function(af){var aI=this;var az=[],au;if(this.isOdt()===true){if(V===q){af=this.dataSetRev}else{af=this.dataSetAlt}}if(V===q){if(v==="SoftwareLogicalItem"){var ax=0;if(af.graphs.length>0){var ax=af.graphs[0].versions.length;var aP="";for(aO=0;aO<ax;++aO){af.graphs[0].versions[aO].codeForThisBranch="";var aD=af.graphs[0].versions[aO].code.lastIndexOf("_");if(aD>-1){if(af.graphs[0].versions[aO].id===this.oId){aP=af.graphs[0].versions[aO].code.slice(0,aD)}else{af.graphs[0].versions[aO].codeForThisBranch=af.graphs[0].versions[aO].code.slice(0,aD)}}}for(aO=0;aO<ax;++aO){if(af.graphs[0].versions[aO].id!=this.oId){if(af.graphs[0].versions[aO].codeForThisBranch===aP){af.graphs[0].versions[aO].physicalid=af.graphs[0].versions[aO].id;af.graphs[0].versions[aO].internalType=af.graphs[0].versions[aO].type;af.graphs[0].versions[aO].name=af.graphs[0].versions[aO].label;af.graphs[0].versions[aO].revision=af.graphs[0].versions[aO].code;if(E!==""){af.graphs[0].versions[aO].type=E}az.push(af.graphs[0].versions[aO])}}}}}else{var at=af.results;var ax=!(at)?0:at.length;for(var aJ=0;aJ<ax;aJ++){var ap=at[aJ];var aX=ap["PLMEntity.V_Name"];var aC=aX;if(!aC){aC=ap.Title;if(!aC){aC=ap.name}}ap.name=aC}if(af.results){for(au=0;au<af.results.length;au++){if(af.results[au].physicalid!=this.oId||this.isFilter){az.push(af.results[au])}}}}}else{if(V===z){var av=this.container.getElements(".facetviews > .set-container");var aA=av.length;if((Q>=0)&&(Q<aA)){var aQ=av[Q];if(aQ.style.display==""){var aw=aQ.getElement(".set-header");aw.style.display="flex";var ak=aQ.getElement(".set-contents");ak.style.height="calc(100% - 52px)";var aV=aw.getElement(".set-switcher");aV.hide();var aW=aw.getElement(".set-actions");var an=aW.getElement("#selDuplicate");if(an===null){a=aI.dupFiltering;var aU="";if(aI.dupFiltering==="direct"){aU=y.get("displayAlternateDepthDirect")}else{if(aI.dupFiltering==="origin"){aU=y.get("displayAlternateDepthOrigin")}else{aU=y.get("displayAlternateDepthAll")}}var aS=new N({value:aU,id:"selDuplicate",icon:"fonticon-doc-text",attributes:{title:aU},dropdown:{items:[{text:y.get("displayAlternateDepthDirect"),value:"DUP_IMM"},{text:y.get("displayAlternateDepthOrigin"),value:"DUP_DESC"},{text:y.get("displayAlternateDepthAll"),value:"DUP_ALL"}]}}).inject(aW);aS.elements.container.style.marginRight="4px";aS.elements.container.style.maxWidth="48%";aS.addEvent("onDropdownClick",function(a1,aZ){var aY=aZ.value;if((aY!=="")&&(aY!==aI.dupFiltering)){var a0="";if(aY==="DUP_IMM"){aI.dupFiltering="direct";a0=y.get("displayAlternateDepthDirect")}else{if(aY==="DUP_DESC"){aI.dupFiltering="origin";a0=y.get("displayAlternateDepthOrigin")}else{if(aY==="DUP_ALL"){aI.dupFiltering="all";a0=y.get("displayAlternateDepthAll")}}}this.setValue(a0);this.elements.container.title=a0;a=aI.dupFiltering;require(["DS/UIKIT/Mask"],function(a3){var a2=aI.container.getElement(".facetviews");a3.mask(a2)});aI.fetch()}})}var aj=aW.getElement("#selRevOfDuplicate");if(aj===null){I=aI.dupRevsFiltering;var ar="";if(aI.dupRevsFiltering==="top"){ar=y.get("displayAlternateRevisionTop")}else{if(aI.dupRevsFiltering==="latest"){ar=y.get("displayAlternateRevisionLatest")}else{if(aI.dupRevsFiltering==="latestPublished"){ar=y.get("displayAlternateRevisionLatestPublished")}else{ar=y.get("displayAlternateRevisionAll")}}}var aL=new N({value:ar,id:"selRevOfDuplicate",icon:"fonticon-picture",attributes:{title:ar},dropdown:{items:[{text:y.get("displayAlternateRevisionTop"),value:"REV_FIRST"},{text:y.get("displayAlternateRevisionLatest"),value:"REV_LAST"},{text:y.get("displayAlternateRevisionLatestPublished"),value:"REV_LAST_PUB"},{text:y.get("displayAlternateRevisionAll"),value:"REV_ALL"}]}}).inject(aW);aL.elements.container.style.marginLeft="4px";aL.elements.container.style.maxWidth="48%";aL.addEvent("onDropdownClick",function(a0,aY){var a1=aY.value;if((a1!=="")&&(a1!==aI.dupRevsFiltering)){var aZ="";if(a1==="REV_FIRST"){aI.dupRevsFiltering="top";aZ=y.get("displayAlternateRevisionTop")}else{if(a1==="REV_LAST"){aI.dupRevsFiltering="latest";aZ=y.get("displayAlternateRevisionLatest")}else{if(a1==="REV_LAST_PUB"){aI.dupRevsFiltering="latestPublished";aZ=y.get("displayAlternateRevisionLatestPublished")}else{if(a1==="REV_ALL"){aI.dupRevsFiltering="all";aZ=y.get("displayAlternateRevisionAll")}}}}this.setValue(aZ);this.elements.container.title=aZ;I=aI.dupRevsFiltering;require(["DS/UIKIT/Mask"],function(a3){var a2=aI.container.getElement(".facetviews");a3.mask(a2)});aI.fetch()}})}}}if(af.nodes){var aK=-1;for(au=0;au<af.nodes.length;au++){if(af.nodes[au].id===this.oId){aK=af.nodes[au].nId;break}}var ac=new Array();ac.push(aK);n(aK,af.connections,"both",ac);for(au=0;au<af.nodes.length;au++){var ap=af.nodes[au];ap.physicalid=ap.id;ap.name=ap.displayName;if(ap.physicalid===this.oId){}else{if(ac.indexOf(ap.nId)>=0){}else{var aE=false;if(aI.dupRevsFiltering==="top"){var Z=false;for(var ab=0;ab<af.connections.length;ab++){var al=af.connections[ab];if((al.typ.contains("revision"))&&(al.trg===ap.nId)){Z=true;break}}if(Z==false){aE=true}}else{if((aI.dupRevsFiltering==="latest")||(aI.dupRevsFiltering==="latestPublished")&&af.nodes[au].ispublished===true){var ad=false;for(var ab=0;ab<af.connections.length;ab++){var al=af.connections[ab];if((al.typ.contains("revision"))&&(al.src===ap.nId)){if(aI.dupRevsFiltering==="latest"){ad=true;break}else{for(var ah=0;ah<af.nodes.length;ah++){if((af.nodes[ah].nId===al.trg)&&(af.nodes[ah].ispublished===true)){ad=true;break}}}if(ad==true){break}}}if(ad==false){aE=true}}else{if(aI.dupRevsFiltering==="all"){aE=true}}}if(aE){var aa=false;if(aI.dupFiltering==="direct"){var aq=new Array();aq.push(ap.nId);n(ap.nId,af.connections,"both",aq);for(var ab=0;ab<af.connections.length;ab++){var al=af.connections[ab];if((al.typ==="duplicate")&&(al.src===aK)&&(aq.indexOf(al.trg)>=0)){aa=true}}}else{if(aI.dupFiltering==="origin"){var aR=new Array();aR.push(aK);aa=S(ap.nId,aR,af.connections)}else{aa=true}}if(aa){az.push(ap)}}}}}}}else{if(V===C){if(this.isHistoryEmbedded){if(aI.container.getElement(".versionexplorer-toolbar")){if(aI.container.getElements(".root-skeleton-container")!=null){if(aI.container.getElements(".root-skeleton-container")[0]!=null){aI.container.getElements(".root-skeleton-container")[0].setStyle("display","none")}if(aI.container.getElements(".root-skeleton-container")[1]!=null){aI.container.getElements(".root-skeleton-container")[1].setStyle("display","none")}}}}}else{var aB=[];var aT=af.filters;if(aT){var aN=aT.length;for(var aO=0;aO<aN;aO++){var aF=aT[aO];if(this.oId===aF.rootPhysicalId){aB.push(aF)}}}for(var aO=0;aO<aB.length;aO++){var aF=aB[aO];var aH=aF.filterPhysicalid;var Y={physicalid:aH,id:aH,name:aF.filterName,internalType:"ENOStrRefinementSpecification",type:y.get("filterType"),revision:f,isFilter:true,filter:aF};if(Y.physicalid!=this.droppedId){az.push(Y)}}}}}require(["DS/UIKIT/Mask"],function(aZ){var aY=aI.container.getElement(".facetviews");aZ.unmask(aY)});var aG=jQuery('*[data-name="Refresh"]');aG.css("opacity","1.0");aG.css("pointer-events","auto");var aM=jQuery('*[data-name="RemoveAll"]');aM.css("opacity","1.0");aM.css("pointer-events","auto");var am=this.container.getElement(".facets-list > .facet.interactive.tab-behavior.selected");if((this.nameSelFacet===am.dataset.name)){ay();if(az.length===0){var ao="";if(this.nameSelFacet===q){ao=y.get("noRevision")}else{if(this.nameSelFacet===z){ao=y.get("noAlternateDesign")}else{ao=y.get("noFilters")}}if(!this.isHistoryEmbedded){var ag=this.container.getElement(".facetviews");var X=UWA.createElement("div",{id:"empty-msg",html:ao});ag.appendChild(X)}var ae=aI.container.getElements(".facets-list > .facet.interactive.tab-behavior");for(var aO=0;aO<ae.length;++aO){var ai=ae[aO];if(!ai.hasClassName("selected")){ai.addEventListener("click",ay)}}}}function ay(){var aY=aI.container.getElements(".facets-list > .facet.interactive.tab-behavior");for(var aZ=0;aZ<aY.length;++aZ){var a0=aY[aZ];if(!a0.hasClassName("selected")){a0.removeEventListener("click",ay)}}if(aI.container.getElement("#empty-msg")){aI.container.getElement("#empty-msg").remove()}}az.sort(function(aZ,aY){return aZ.nId-aY.nId});require(["DS/UIKIT/Mask"],function(aY){aY.unmask(aI.container)});return az},sync:function(){return this.model.prototype.sync.apply(this,arguments)},fetch:function(){var X=this;if(this.isHistoryEmbedded){var aa=this.container.getElement(".version-global-div");if(aa!=null){aa.setStyle("display","none")}}else{var aa=jQuery('*[data-name="'+this.nameSelFacet+'"]');if(aa[0].hasClassName("selected")){this.closeHistoryGraphDialog()}}var ab="";var Z;if(this.nameSelFacet===q){if(v==="SoftwareLogicalItem"){Z="/resources/v1/dslc/versiongraph/"+this.oId+"?withAttributes=1"}else{Z="/resources/compare/revisions2?tenant="+this.tenant+"&objectId="+this.oId}ab=this.url+Z}else{if(this.nameSelFacet===z){var Y="all";Z="/resources/lifecycle/history/links?tenant="+this.tenant+"&physicalid="+this.oId+"&depth=100&type="+Y;ab=this.url+Z}else{if(this.nameSelFacet===C){j=this;this.displayHistoryGraph();if(j.isHistoryEmbedded){ab=this.url}}else{var Z="/resources/FilterBIAPI/Filter/getFilters?tenant="+this.tenant;ab=this.url+Z}}}return(ab!="")?this._parent(s.merge({url:ab})):ab},displayHistoryGraph:function(){var Y=this;var aa=null;if(Y.isHistoryEmbedded){aa=Y.container.getChildren()[0].getChildren()[0].getChildren()[1].getChildren()[1]}Y.versionExplorer=new l({versionGraphContainer:aa,widget:widget,autoUpdate:false,isCompare:Y.isCompare});Y.versionExplorer.setSingleSelectionMode();Y.versionExplorer.disableCommands();if(!Y.isHistoryEmbedded){Y.versionExplorer.showDialog({className:"VEPickDialogModal"},undefined,true)}H=Y.versionExplorer;var X={displayLegend:false};O.getHistoryConfigPromise().then(function(ab){K.historyConfig=ab;if(K.historyConfig&&K.historyConfig.settings){if(K.historyConfig.settings.defaultView){X.displayMode=P.DISPLAY_MODES[K.historyConfig.settings.defaultView]}if(K.historyConfig.settings.thumbnailGraph){if(K.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout){X.thumbnailGraphLayout=K.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout}if(K.historyConfig.settings.thumbnailGraph.displayThumbnailOverview){X.displayThumbnailOverview=K.historyConfig.settings.thumbnailGraph.displayThumbnailOverview==="true"}}if(K.historyConfig.settings.subwayGraph){if(K.historyConfig.settings.subwayGraph.subwaySort){X.subwaySortAscending=K.historyConfig.settings.subwayGraph.subwaySort==="asc"}if(K.historyConfig.settings.subwayGraph.viewMode==="SUBWAY_COMPACT_VIEW"||K.historyConfig.settings.subwayGraph.viewMode==="SUBWAY_COMFORTABLE_VIEW"){X.subwayViewMode=K.historyConfig.settings.subwayGraph.viewMode}}}},function(){})["finally"](function(){K.loadUserSettingsPromise(X,false,Y.isCompare).then(function(){Y.versionExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:j.oId,type:j.objType,tenantId:j.tenant,securityContext:j.securityContext,onComplete:function(){var ab=Y.versionExplorer.applyFilter(function(ac){return j.oId!==ac._options.id})},dataModelType:P.DATA_MODEL_TYPES.MODEL_HISTORY})})});if(j.container.getElement("#empty-msg")){j.container.getElement("#empty-msg").remove()}if(!Y.isHistoryEmbedded){var Z=jQuery('*[data-name="historyGraphFacet"]');if((Z!==undefined)&&(Z!==null)){if(Z.length>0){Z[0].removeEventListener("click",j.displayHistoryGraph)}}}Y.versionExplorer.subscribeEvent("ENOXVersionExplorerModalCancel",function(ab){H=null;j.processEmptyHistoryGraphResults(y.get("noHistoryGraphSelection"));Y.versionExplorer.cleanup()},false);Y.versionExplorer.subscribeEvent("ENOXVersionExplorerModalOK",function(ae){H=null;var af=Y.versionExplorer.getSelectedNodes();var ad=af.length;if(ad>0){var ac;for(var ab=0;ab<ad;++ab){if(af[ab].options.data.physicalid!==j.oId){if(ac===undefined){ac=af[ab].options.data}}}if(ac!==undefined){j.callbackFn(ac)}else{j.processEmptyHistoryGraphResults(y.get("rootHistoryGraphSelection"))}}else{j.processEmptyHistoryGraphResults(y.get("noHistoryGraphSelection"))}Y.versionExplorer.cleanup()},false);Y.versionExplorer.subscribeEvent("select",function(ae){if(Y.isHistoryEmbedded){H=null;var af=Y.versionExplorer.getSelectedNodes();var ad=af.length;if(ad>0){var ac;for(var ab=0;ab<ad;++ab){if(af[ab].options.data.physicalid!==j.oId){if(ac===undefined){ac=af[ab].options.data}}}if(ac!==undefined){j.callbackFn(ac)}else{j.processEmptyHistoryGraphResults(y.get("rootHistoryGraphSelection"))}}else{j.processEmptyHistoryGraphResults(y.get("noHistoryGraphSelection"))}}},false)},processEmptyHistoryGraphResults:function(X){var aa=this;var Y=j.container.getElement(".facetviews");var Z=UWA.createElement("div",{id:"empty-msg",html:X,});Y.appendChild(Z);var ab=jQuery('*[data-name="historyGraphFacet"]');if((ab!==undefined)&&(ab!==null)){if(ab.length>0){ab[0].addEventListener("click",j.displayHistoryGraph)}}},closeHistoryGraphDialog:function(){if(H!==null){H.hideDialog()}H=null},refreshOptions:function(Y,X){this.oId=Y.physicalid;this.droppedId=X.physicalid;this.isFilter=X.isFilter}});return W}function e(V){var W={baseURL:V.revServiceURL,droppedObj:V.droppedObj,rootObj:V.rootObj,securityContext:V.securityContext,container:V.listContainer,baseContainer:V.baseContainer,proxyType:V.proxyType,callbackFn:V.callbackFn,dataSetRev:V.dataSetRev,dataSetAlt:V.dataSetAlt,isOdt:function(){if(typeof V.dataSetRev==="object"){return true}else{return false}},duplicateOnly:V.duplicateOnly,dupFiltering:V.dupFiltering,dupRevsFiltering:V.dupRevsFiltering,bHistoryGraphSelector:V.bHistoryGraphSelector,isHistoryEmbedded:V.isHistoryEmbedded,isCompare:V.isCompare};return W}function A(V,X,Z,Y){var aa=(Y==true)?{selectedFacet:X,facets:[{name:q,text:y.get("revisions"),icon:"picture",handler:T.getRendererHandler("revisions")},{name:z,text:y.get("alternateDesigns"),icon:"doc-text",handler:T.getRendererHandler("alternateDesigns")},{name:C,text:y.get("historyGraph"),icon:"compass ROTATE_COMPASS",handler:T.getRendererHandler("historyGraph")},]}:{selectedFacet:X,facets:[{name:q,text:y.get("revisions"),icon:"picture",handler:T.getRendererHandler("revisions")},{name:z,text:y.get("alternateDesigns"),icon:"doc-text",handler:T.getRendererHandler("alternateDesigns")},]};var W=widget.getBool("useIndex");if(W){aa.facets.push({name:w,text:y.get("filters"),icon:"filter",handler:T.getRendererHandler("filters")})}if(Z!=undefined&&Z==true){delete aa.facets.splice(0,1)}aa.model=new M();return aa}var d=R.extend({setup:function(X){var Y={useInfiniteScroll:false,usePullToRefresh:false};var V={useInfiniteScroll:false,usePullToRefresh:false,itemViewOptions:{mapping:{subtitle:"type",image:function(){var aa=b(this.model.collection.url,this.model.collection.proxyType,this.model._attributes.physicalid,".tile-image",this.container,this.model._attributes.internalType);var aa=this.model.collection.url+F;return aa},content:"revision",title:"name",icon:function(){var aa=L(this.model.collection.url,this.model.collection.proxyType,this.model._attributes.physicalid,".tile-icon",this.container,this.model._attributes.internalType);var aa=G(this.model._attributes.internalType,this.model.collection.url);return aa},Nodeid:"physicalid"}},events:{onItemViewSelect:function(aa){var ac=arguments[arguments.length-1];var ab=ac.model||ac;aa.collection.callbackFn(ab._attributes)},onItemViewDrag:function(ab,aa,ad){var ae=(typeof(widget)!=="undefined"&&widget)?widget.getValue("x3dPlatformId"):null;if(ae==null||ae==""){ae="OnPremise"}var ac={protocol:"3DXContent",version:"0.1",source:"FBS_BIP_LIST",data:{items:[{envId:ae,serviceId:"3DSpace",subtitle:aa.model._attributes.type,content:aa.model._attributes.revision,contextId:"_Local",objectId:aa.model._attributes.physicalid,objectType:aa.model._attributes.internalType,displayType:aa.model._attributes.type,displayName:aa.model._attributes.name}]}};ad.dataTransfer.setData("text",JSON.stringify(ac))}}};Y.contents=s.clone(V);var W={revisions:{collection:o(q),collectionOptions:e(X),view:null,viewOptions:Y,idCardOptions:A(false,q,X.duplicateOnly,X.bHistoryGraphSelector)},alternateDesigns:{collection:o(z),collectionOptions:e(X),view:null,viewOptions:Y,idCardOptions:A(false,z,X.duplicateOnly,X.bHistoryGraphSelector)},historyGraph:{collection:o(C),collectionOptions:e(X),view:null,viewOptions:Y,idCardOptions:A(false,C,X.duplicateOnly,X.bHistoryGraphSelector)},filters:{collection:o(w),collectionOptions:e(X),view:null,viewOptions:Y,idCardOptions:A(false,w,X.duplicateOnly,X.bHistoryGraphSelector)}};if(X.duplicateOnly!=undefined&&X.duplicateOnly==true){var X={rootIdCardOptions:A(true,z,X.duplicateOnly,X.bHistoryGraphSelector)};delete W.revisions;delete W.historyGraph;delete W.filters}else{var X={rootIdCardOptions:A(true,q,X.duplicateOnly,X.bHistoryGraphSelector)}}u=new T(W,X);Q=-1;var Z=this;u.addEvent("onRouteChange",function(){if((Z.options.facetToSelect!==undefined)&&(Z.options.facetToSelect!==null)&&(Z.options.facetToSelect!=="")){jQuery('*[data-name="'+Z.options.facetToSelect+'"]').trigger("click");Z.options.facetToSelect=null}Z.dispatchEvent("onRouteChange")})},render:function(){var V;V=J.extendElement(this.container);V.empty();x(this.options.baseContainer,this.options.droppedObj,this.options.revServiceURL,this.options.proxyType);u.render().inject(V);return this},refresh:function(Z,ac,V,ab){x(this.options.baseContainer,Z,this.options.revServiceURL,this.options.proxyType);var aa=0,X,W;var Y=u.getNodeAt(aa);while(Y){for(X=0;X<Y.get("facets").length;X++){W=Y.get("facets")[X];if(W.collection){if(W.collection.nameSelFacet===z){if(V!==undefined){W.collection.dupFiltering=V}if(ab!==undefined){W.collection.dupRevsFiltering=ab}}W.collection.refreshOptions(ac,Z);W.collection.fetch()}}aa++;Y=u.getNodeAt(aa)}},getDupFilteringValues:function(){return{duplicates:a,revsOfDuplicates:I}},closeHistoryGraphDialog:function(){if(j!==null){j.closeHistoryGraphDialog()}}});return d});define("DS/CompareWidget/PickDialog",["DS/ENO6WPlugins/jQuery","DS/CompareWidget/PickDialogView","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/CompareWidget/Utils","i18n!DS/CompareWidget/assets/nls/CompareWidget","css!DS/CompareWidget/CompareWidget.css"],function(p,j,b,e,k,n){var m=null;var g=null;var f=null;var l=null;var a=null;var o=null;var h=null;var d=null;var c=function(r,t,q,s,u){g=t;f=q;l=s;o=UWA.createElement("div",{id:"pick-dialog-container",html:[{tag:"div",id:"pick-dialog-header"},{tag:"div",id:"pick-dialog-content"}]});o.inject(r);m=r.getElement("#pick-dialog-content");require(["DS/UIKIT/Mask"],function(v){v.mask(m)});if(u){r.getElement("#pick-dialog-header").hide()}};c.prototype.load=function(s,x,B,u,r,y,q,A,D,C,w,t,z){d=(A==undefined?null:A);var v=(q==undefined?null:q);b.app_initialization(function(){e.getSecurityContextPromise(A,v).then(function(F){a=F;o.getElement("#pick-dialog-header").setContent(p('<span id="pick-header">'+n.chooseObject+"</span>"));k.getRootObj(s,{tenant:A,securityContext:a,url3DSpace:f},function E(G){h=new j({container:m,listContainer:m,baseContainer:g,revServiceURL:f,droppedObj:s,rootObj:G,proxyType:l,callbackFn:x,dataSetRev:t,dataSetAlt:z,duplicateOnly:(u?u:false),dupFiltering:r,dupRevsFiltering:y,bHistoryGraphSelector:D,isHistoryEmbedded:C,isCompare:w,facetToSelect:B,securityContext:F});h.render()},function(G){console.log("getRootObj error: "+G)})})})};c.prototype.refresh=function(s){var r=this;k.getRootObj(s,{tenant:d,securityContext:a,url3DSpace:f},function q(t){h.refresh(s,t)})};c.prototype.getDupFilteringValues=function(){return(h!==null)?h.getDupFilteringValues():undefined};c.prototype.closeHistoryGraphDialog=function(){if(h!==null){h.closeHistoryGraphDialog()}};return c});define("DS/CompareWidget/CompareContent",["DS/WAFData/WAFData","DS/Controls/Loader","DS/ENOFloatingPanel/ENOFloatingPanel","DS/ApplicationFrame/ActionBar","DS/ApplicationFrame/CommandsManager","DS/WidgetServices/WidgetServices","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/CompareWidget/CompareTable","DS/CompareWidget/CompareStructure","DS/CompareWidget/CompareViewer","DS/CompareWidget/PickDialog","DS/UIKIT/Mask","DS/CompareWidget/CompareOverview","DS/CompareWidget/FilterAttributesWidget","DS/CompareWidget/ViewStateMgr","DS/CompareWidget/DnD","DS/CompareWidget/Utils","DS/CompareWidget/CompareObjMgr","DS/CompareWidget/ColumnPanelLayout","DS/CompareWidget/CompareActionBar","DS/CompareWidgetUtils/CompareExporter","css!DS/CompareWidget/CompareWidget.css","i18n!DS/CompareWidget/assets/nls/CompareContent","i18n!DS/CompareWidget/assets/nls/CompareStructure","i18n!DS/CompareWidget/assets/nls/CompareExport","i18n!DS/CompareWidget/assets/nls/CompareWidget","DS/CompareWidget/DBG_Stopwatch"],function(r,I,x,g,F,a,p,A,c,d,l,B,C,h,D,z,v,E,m,G,u,b,k,n,t,y,L,K){var e=((typeof(widget)!="undefined")&&(widget.uwaUrl!=null)&&(widget.uwaUrl.search("CW_TIMING")!=-1));var s=false;var H=s?function(M){console.log("TENANT: "+M)}:function(M){};var j=function(M){M=M||{};this.proxyType=M.proxyType||"passport";this.rootServiceURL=M.rootServiceURL||"";this.objMgr=new m(this.rootServiceURL,this.proxyType);this.tenant=(typeof(widget)!=="undefined"&&widget)?widget.getValue("x3dPlatformId"):null;if(this.tenant==null||this.tenant==""){this.tenant="OnPremise"}H("CompareContent is loading using tenant (from x3dPlatformId) '"+this.tenant+"'");this.CmdContexts={Load:0,Refresh:1,RemoveAll:2,Replace:3,SwapColumns:4,Load_4_swap:5};this.currentCmdContext=this.CmdContexts.Load;this.reloadFromCompassOK=true;this.securityContext="uninitialized";this.structureCompare=null;this.tableCompare=null;this.viewerCompare=null;this.compareOverview=null;this.actionBar=null;this.trees=[];this.rootElement=null;this.tableShown=false;this.isListView=false;this.IDleft=null;this.IDright=null;this.IDrightMulti=[];this.objs={};this.JSONIDleft=null;this.JSONIDleftType=null;this.JSONIDright=null;this.JSONIDrightType=null;this.supportedForViewer=true;this.pickDialog=null;this.facetToSelect=null;this.viewStateMgr=new z(this);this._scTopCurrent=0;this._scLeftCurrent=0;this._cachedIDArray=[];this._cachedFetchedTableArray=[];this.swapActivePID_l="NONE";this.swapActivePID_r="NONE";this.savedDupFiltering="";this.savedDupRevsFiltering="";this.bGenericCompare=false;this.bRequiresIndex=false};j.prototype.dragEnterHighlight=function(N){var M=this;var O=UWA.Event.getElement(N).id;if(O.startsWith("drop-target-left")){jQuery("#drop-target-left").addClass("drop-cue-on")}else{if(O.startsWith("drop-target-right")){jQuery("#drop-target-right").addClass("drop-cue-on")}}};j.prototype.dragLeaveDeHighlight=function(N){var M=this;if(N==null){}else{var O=UWA.Event.getElement(N).id;if(O.startsWith("drop-target-left")){jQuery("#drop-target-left").removeClass("drop-cue-on")}else{if(O.startsWith("drop-target-right")){jQuery("#drop-target-right").removeClass("drop-cue-on")}}}};j.prototype.updateDroppedObj=function(O){var M=O.physID||O.physicalid;O.physicalid=M;if(this.objs[M]==null){this.objs[M]=O}else{for(var N in O){this.objs[M][N]=O[N]}}};j.prototype.validateIdsThenCall=function(R,M){if(R.length>0){var O=R.join(",");var N=p.get3DSpaceWSUrl(this.tenant,"/resources/compare/getObjState","objectIds="+O);var Q=this;try{r.authenticatedRequest(N,{proxy:this.proxyType,method:"GET",onComplete:function(X){var W=JSON.parse(X).results;if((W==null)||(typeof W.length!="number")){Q.NLS_showMessage("BAD_DROP","compare-alert-error")}else{var U=true;Q.bGenericCompare=false;Q.bRequiresIndex=false;for(var V=0;V<W.length;V++){var S=W[V];if(S.exists==false){Q.NLS_showMessage("OBJ_NOT_FOUND","compare-alert-warning");U=false;break}if(S.isSupportedType==false){Q.bGenericCompare=true}if(S.requiresIndex){Q.bRequiresIndex=true;var T=widget.getBool("useIndex");if(!T){Q.NLS_showMessage("INDEX_REQ_ENABLING","compare-alert-warning");widget.setValue("useIndex",true)}}Q.updateDroppedObj(S)}}M(U)}});return}catch(P){console.log("Exception on '"+N+"'")}}};j.prototype.processValidatedIDs=function(R,N){var U=this;if((N==null)||(N.length==0)){return}var O=N.length;if(O>5){this.NLS_showMessage("selectFiveOrFewer","compare-alert-error");return}var M=null;var P=null;if(O>=2){if((R==="drop-right")&&(this.IDleft!==null)){this.IDright=N[0];for(var ac=1;ac<N.length;++ac){this.IDrightMulti[ac-1]=N[ac]}}else{this.IDleft=N[0];this.IDright=N[1];for(var ac=2;ac<N.length;++ac){this.IDrightMulti[ac-2]=N[ac]}}}else{P=N[0];if(R==="drop-left"){this.IDleft=P;M="right-rev-list"}else{if(R==="drop-right"){this.IDright=P;M="left-rev-list"}}}this.persistIDs(this.IDleft,this.IDright,this.IDrightMulti);if((this.IDleft!=null)&&(this.IDright!=null)){var S=[];S[0]=this.IDleft;S[1]=this.IDright;for(ac=0;ac<this.IDrightMulti.length;++ac){S[ac+2]=this.IDrightMulti[ac]}U.doCompareForModels(S);var Q=jQuery('*[data-name="Refresh"]');Q.css("opacity","1.0");Q.css("pointer-events","auto");var V=jQuery('*[data-name="RemoveAll"]');V.css("opacity","1.0");V.css("pointer-events","auto");jQuery(".AfrActionBar",jQuery("div#compare-region-left")).show()}else{if(U.pickDialog===null){var Z=(R=="drop-left"?"drop-target-left":"drop-target-right");if(Z==="drop-target-right"){document.getElementById("drop-target-left").setStyle("flex","0.5")}else{if(Z==="drop-target-left"){document.getElementById("drop-target-right").setStyle("flex","0.5")}}var ab=document.getElementById(M);var T=p.get3DSpaceBaseUrl(this.tenant);var aa=new B(ab,document.getElementById(Z),T,this.proxyType);jQuery(ab).removeAttr("hidden");var X=(this.savedDupFiltering!=="")?this.savedDupFiltering:widget.getValue("display_alternate_depth");var Y=(this.savedDupRevsFiltering!=="")?this.savedDupRevsFiltering:widget.getValue("display_alternate_revision_type");this.savedDupFiltering="";this.savedDupRevsFiltering="";var W=true;aa.load(this.objs[P],function(ae){U.updateDroppedObj(ae);if(U.IDleft==null){U.IDleft=ae.physicalid}else{if(U.IDright==null){U.IDright=ae.physicalid}}jQuery(ab).attr("hidden");U.doCompareForModels([U.IDleft,U.IDright])},U.facetToSelect,false,X,Y,null,null,W,true,true);U.pickDialog=aa}else{var ad=this.objs[P];U.pickDialog.refresh(ad)}}jQuery(".AfrActionBar",jQuery("div#compare-region-left")).show()};j.prototype.NLS_showMessage=function(M,N){require(["DS/CompareWidget/CompareAlert","i18n!DS/CompareWidget/assets/nls/CompareContent"],function(P,Q){var O=(M==null)?Q["MISSING ALERT MESSAGE"]:(Q[M]!=null)?Q[M]:M;P.doAlert({msg:O,alertStyle:N});return},function(O){console.log("%%%% CompareWidget:: Failed to show "+N+": '"+M+"', error:"+O)})};j.prototype.IsCompareContentParentADialog=function(){if((jQuery(this.rootElement).closest(".compare_popup")).length>0){return true}return false};var f=function(M,Q){var O=Q.length;for(var P=0;P<O;P++){var N=Q[P];if(N.physicalid==M){return{physicalId:M,title:N.attributes.name,revision:N.attributes.revision,type:N.type,isViewerSupported:N.attributes.isViewerSupported}}}};j.prototype.triggerViewerForModels=function(X,Y,W){var T=X[0];var N=this.objs[T];var U=false;if(N&&N.isFilter){U=true;T=N.filter.rootPhysicalId}var P=Y[0];var ab=P.nodes;var V=f(T,ab);V.isFilter=U;var M=X[1];var R=this.objs[M];var Z=false;if(R&&R.isFilter){Z=true;M=R.filter.rootPhysicalId}var S=Y[1];var ac=S.nodes;var Q=f(M,ac);Q.isFilter=Z;if(!V||!Q||!V.isViewerSupported||!Q.isViewerSupported){this.supportedForViewer=false;var O="";if(V&&V.isViewerSupported==false){O=n.replace(n.get("UnsupportedTypeObject"),{type:V.type,name:V.title+" "+V.revision})}if(Q&&Q.isViewerSupported==false){if(O.length>0){O+=", "}O+=n.replace(n.get("UnsupportedTypeObject"),{type:Q.type,name:Q.title+" "+Q.revision})}var aa=n.replace(n.get("ViewerNotSupported"),{UnsupportedTypeObject:O});this.NLS_showMessage(aa,"compare-alert-warning");console.log("Viewer not supported for requested objects: "+O);w(Y,W)}else{this.supportedForViewer=true;jQuery("#compare-content").trigger("loadNewModelEvent",{left:V,right:Q,isListView:this.isListView});w(Y,W)}};var w=function(P,R){var N=P[0];var T=R[0];var M=N.nodes[0];var Q=P[1];var S=R[1];var O=Q.nodes[0];if(M.attributes["revision-physicalid"]!=null&&M.attributes["revision-physicalid"]!=""){jQuery("#compare-content").trigger("loadNewModelJSONEvent",{left:{physicalId:M.attributes["revision-physicalid"],title:M.attributes.name,revision:M.attributes.revision,viewerJSON:T},right:{physicalId:O.attributes["revision-physicalid"],title:O.attributes.name,revision:O.attributes.revision,viewerJSON:S}})}};var o=function(X,Q){var V=[];for(var U=0;U<X.length;U++){var T=X[U];var W=T.rootoccurrence;var S=-1;for(var N=0;N<T.occurrences.length;N++){var P=T.occurrences[N];var R=P.occurrenceid;if(R==W){S=P.nodeid;break}}if(S==-1){console.error("ERROR: Cannot find root node in JSON snapshot table for model #"+U);return}for(var N=0;N<T.nodes.length;N++){var O=T.nodes[N];if(O.nodeid==S){var M={physicalId:O.physicalid,title:O.attributes.name,revision:O.attributes.revision,viewerJSON:Q[U]};V.push(M);break}}}jQuery("#compare-content").trigger("loadNewSnapshotEvent",{left:V[0],right:V[1],isListView:this.isListView})};var J=function(N,M,R){var Q=null;var T=null;if(N.constructor==Array){if(N.length==1){return J(N[0],M,R)}T=N}else{T=[N]}for(var O=0;O<T.length;O++){var S=T[O];if(S!=null){if((S.compareData!==undefined)&&(S.compareData!==null)){if(S.compareData.physicalid===M){if(R==="NONE"){Q=S.key}else{if((S.compareData.obj2!==undefined)&&(S.compareData.obj2!==null)){if(S.compareData.obj2.physicalid===R){Q=S.key}}}}if((S.children!==undefined)&&(S.children!==null)){for(var P=0;(Q==null)&&(P<S.children.length);P++){Q=J(S.children[P],M,R)}}}}}return Q};j.prototype.doCompareStructure=function(M){try{var O=this;var P=O.getCompareOptions();this.structureCompare.compareUsingJSONObjs.call(O.structureCompare,O.isListView,O.bGenericCompare,P,M,function(S){var Q=(O.swapActivePID_l!="NONE")||(O.swapActivePID_r!="NONE");var V=S||Q;if(!V){jQuery("#structure-treetable-left").bind("click",function(X,Y){jQuery("#compare-tree-base").unbind("click");jQuery("#compare-tree-to-1").unbind("click");O.updateWidgetViewState(false)});jQuery("#structure-treetable-right").bind("click",function(X,Y){jQuery("#compare-tree-base").unbind("click");jQuery("#compare-tree-to-1").unbind("click");O.updateWidgetViewState(false)})}O.updateWidgetViewState(!V);var W=(V==true?0:"NONE");if((O.currentCmdContext===O.CmdContexts.Load_4_swap)||(O.currentCmdContext===O.CmdContexts.SwapColumns)){O.viewerCompare.do3DCompare_4_Swap();var R=O.swapActivePID_r;var U=O.swapActivePID_l;var T=null;if(R==="NONE"){if(U==="NONE"){W="NONE"}else{T=J(O.structureCompare.fTreeData_right,U,R)}}else{T=J(O.structureCompare.fTreeData_left,R,U)}if(T!=null){W=T}else{console.log("Cannot find selected child to re-establish as active... defaulting to first element")}}O.createCompareOverview(W)})}catch(N){this.IDleft=null;this.IDright=null;this.JSONIDleft=null;this.JSONIDright=null;O.updateWidgetViewState(false);this.NLS_showMessage("BadStructData","compare-alert-error");console.log("BAD STRUCT DATA // EXPECTION");console.log(N.stack)}};j.prototype._loadFiltersAndContinue=function(V,W){var T=this;var M=V.length;var P=[];for(var S=0;S<M;S++){var U=V[S];var R=T.objs[U];if(R!=null){if(R.isFilter&&R.filter==null){P.push(R)}}}var N=P.length;if(N==0){W(V)}else{var O=0;for(var S=0;S<N;S++){var R=P[S];var Q=p.get3DSpaceBaseUrl(this.tenant);E.loadFilter(R,{tenant:T.tenant,securityContext:T.securityContext,url3DSpace:Q},function(X){O++;if(O==N){W(V)}})}}};j.prototype.doCompareForModels=function(N){K.iterStart();var Q=this;K.mark({id:"retrieveObjbyID",str:"[BEGIN] Request obj mgr fetch "});var S=Q.rootElement.getElement("#compare-region-left");C.mask(S);var P=undefined;if((Q.currentCmdContext===Q.CmdContexts.Load_4_swap)||(Q.currentCmdContext===Q.CmdContexts.SwapColumns)){if(Q._cachedIDArray.length===2){if(N[0]===Q._cachedIDArray[1]){var M=Q._cachedFetchedTableArray[0];Q._cachedFetchedTableArray[0]=Q._cachedFetchedTableArray[1];Q._cachedFetchedTableArray[1]=M;var O=Q._cachedIDArray[0];Q._cachedIDArray[0]=Q._cachedIDArray[1];Q._cachedIDArray[1]=O}P=Q._cachedFetchedTableArray}}var R=this.getCompareOptions();this.objMgr.fetchObjsByRootIDs(N,P,R,function(T,U){K.mark({id:"retrieveObjbyID",str:"  [END] Request obj mgr fetch",comment:"*** objects now fully loaded from DB ***"});Q._loadFiltersAndContinue(N,function(){if(Q.currentCmdContext!==Q.CmdContexts.Load_4_swap){var V=true;if(V){Q._cachedIDArray=N;Q._cachedFetchedTableArray=T}var X=(N.length<=2);if(Q.bGenericCompare){X=false}var W=!(UWA.Utils.Client.Platform.ios||UWA.Utils.Client.Platform.android);if(X&&W){Q.triggerViewerForModels.call(Q,N,T,U)}}Q.tableCompare.setGenericCompare(Q.bGenericCompare);Q.doCompareStructure.call(Q,T);C.unmask(S)})},function(T){if((T!=null)&&(T.length>0)){Q.NLS_showMessage(T[0].error,"compare-alert-error")}Q.removeAll();C.unmask(S)})};j.prototype.getCompareTreeElementHtml=function(){var M=[{tag:"div",id:"model-color-window",html:[{tag:"div",id:"model-color-panel",display:"flex","flex-direction":"row",html:[{tag:"div",id:"model-color-left",html:[]},{tag:"div",id:"model-color-spacer",html:[]},{tag:"div",id:"model-color-right",html:[]},{tag:"div",id:"model-color-spacer2",html:[]},]},]},{tag:"div",id:"compare-trees",html:[{tag:"div",id:"compare-structure-tree",html:[{tag:"div",id:"initial-drop",html:[{tag:"div","class":"drop-label",html:[{tag:"span",text:""}]},{tag:"div",id:"drop-targets",html:[{tag:"div",id:"left-container",html:[{tag:"div",id:"left-rev-list","class":"rev-list",hidden:"true"},{tag:"div",id:"drop-target-left","class":"drop-target",html:'<div id="drop-target-left-iconlabel" class="drop-icon-label"><span id="drop-target-left-icon" class="fonticon fonticon-2x fonticon-download"></span><br/>'+n.get("dropHere")+"</div>"}]},{tag:"div",id:"right-container",html:[{tag:"div",id:"right-rev-list","class":"rev-list",hidden:"true"},{tag:"div",id:"drop-target-right","class":"drop-target",html:'<div id="drop-target-right-iconlabel" class="drop-icon-label"><span id="drop-target-right-icon" class="fonticon fonticon-2x fonticon-download"></span><br/>'+n.get("dropHere")+"</div>"}]}]}]}]}]}];return M};j.prototype.getCompareRegionLeftElementHtml=function(){var M=[{tag:"div",id:"compare-region-header",html:[{tag:"div",id:"compare-legend",html:[]}]},{tag:"div",id:"compare-region-upperleft",html:[{tag:"div",id:"overview-container",},{tag:"div",id:"compare-tree",html:this.getCompareTreeElementHtml()}]}];return M};j.prototype.render=function(M,N,P){this.rootElement=UWA.createElement("div",{id:"compare-content",html:[]});this.leftPanel=UWA.createElement("div",{id:"compare-region-left",html:this.getCompareRegionLeftElementHtml()});this.midPanel=UWA.createElement("div",{id:"attribute-table",html:[]});if(this.currentCmdContext===this.CmdContexts.SwapColumns){this.rightPanel=P}else{this.rightPanel=UWA.createElement("div",{id:"compare-viewer",html:[]})}this.rootElement.inject(M,N);var O=this;this.layout=new G({parentElement:this.rootElement,panels:[{panel:this.leftPanel,hiderTitle:n.HideTreeStructure,expanderTitle:n.ShowTreeStructure},{panel:this.midPanel,hiderTitle:n.HideAttributeTable,expanderTitle:n.ShowAttributeTable},{panel:this.rightPanel,hiderTitle:n.Hide3DCompare,expanderTitle:n.Show3DCompare}],onCollapse:function(Q,S){if(Q==O.midPanel){O.updateWidgetViewState(false,true);var R=jQuery('*[data-name="CustomizeRows"]');R.addClass("button-unavail")}O.updateActionbarVisibility()},onExpand:function(Q,S){if(Q==O.midPanel){O.updateWidgetViewState(false,true);var R=jQuery('*[data-name="CustomizeRows"]');R.removeClass("button-unavail")}O.updateActionbarVisibility()},onResize:function(Q){if(Q==O.leftPanel||Q==O.midPanel){O.updateActionbarPosition()}}});return this.rootElement};j.prototype.createCompareOverview=function(N){var M=this;jQuery("#compare-overview-toplevel").remove();M.compareOverview=new h(M.rootElement.getElement("#overview-container"));M.compareOverview.init(N)};j.prototype.onReadyViewer=function(){var M=this};if(e==true){var q=function(M){require(["DS/CompareWidget/DBG_Popup"],function(O){var N=K.getTimingOutput();O.show(N)})}}j.prototype.createActionBar=function(O){var N=this;this.actionBar=new u({context:null,file:"CompareActionBar.xml",module:"CompareWidget"});this.actionBar.inject(N.rootElement);this.actionBar.onActionBarReady(function M(){this.elements.container.id="compare-actionBar";var U=jQuery('*[data-name="OverviewUp"]');jQuery(U).click(function(){N.compareOverview.goUp()});if(N.currentCmdContext!==N.CmdContexts.Load_4_swap){U.addClass("button-unavail")}var V=jQuery('*[data-name="OverviewDown"]');jQuery(V).click(function(){N.compareOverview.goDown()});if(N.currentCmdContext!==N.CmdContexts.Load_4_swap){V.addClass("button-unavail")}var R=jQuery('*[data-name="OverviewHome"]');jQuery(R).click(function(){N.compareOverview.goHome()});if(N.currentCmdContext!==N.CmdContexts.Load_4_swap){R.addClass("button-unavail")}var Y=jQuery('*[data-name="ToggleListView"]');jQuery(Y).click(function(){N.swapActivePID_l="NONE";N.swapActivePID_r="NONE";N.doToggleListView();N.refresh()});var Q=jQuery('*[data-name="ToggleAttr"]');jQuery(Q).click(function(){N.doToggleAttr()});var W=jQuery('*[data-name="ToggleOverview"]');jQuery(W).click(function(){N.doToggleOverview()});var aa=jQuery('*[data-name="ToggleLegend"]');jQuery(aa).click(function(){N.doToggleLegend()});var ab=jQuery('*[data-name="CustomizeRows"]');jQuery(ab).click(function(){N.filterAttributes()});ab.addClass("button-unavail");var Z=jQuery('*[data-name="CompareExport"]');jQuery(Z).click(function(){N.compareExport()});Z.addClass("button-unavail");var T=jQuery('*[data-name="SwapColumns"]');jQuery(T).click(function(){N.swapColumns()});var X=jQuery('*[data-name="Refresh"]');jQuery(X).click(function(){N.swapActivePID_l="NONE";N.swapActivePID_r="NONE";N.refresh()});var S=jQuery('*[data-name="RemoveAll"]');jQuery(S).click(function(){N.persistIDs(null,null,[]);N.IDright=null;N.IDleft=null;N.JSONIDright=null;N.JSONIDleft=null;N.swapActivePID_l="NONE";N.swapActivePID_r="NONE";N.removeAll();N.updateWidgetViewState(false)});N.updateWidgetViewState(false);if(e==true){var P=jQuery('*[data-name="debugWinButton"]');jQuery(P).click(function(){q(N)})}widget.dispatchEvent("ENOLCM/CompareWidget/endActionBarLoad","Action Bar has Loaded")});this.updateActionbarPosition()};j.prototype.doToggleListView=function(){if(this.isListView==true){this.isListView=false}else{this.isListView=true}this.updateWidgetViewState()};j.prototype.doToggleAttr=function(){if((this.midPanel!==null)&&(this.layout!==null)){if(this.midPanel.isCollapsed){this.layout.expand(this.midPanel,true)}else{this.layout.collapse(this.midPanel,true)}}this.updateWidgetViewState(false,true)};j.prototype.doToggleOverview=function(){var M=this.doToggle("vizOverview",true);this.viewStateMgr.showElement(this,"overview-container",M)};j.prototype.doToggleLegend=function(){var M=this.doToggle("vizLegend",true);this.viewStateMgr.showElement(this,"compare-legend",M)};j.prototype.doToggle=function(P,M){var O=widget.getBool(P);var N=!O;widget.setValue(P,N);this.updateWidgetViewState(false,M);return N};j.prototype.init=function(M){var N=this;p.app_initialization(function(){var O=A.getSecurityContextPromise(widget.getValue("x3dPlatformId"));O.then(function(P){N.setSecurityContextAndInit(P,M)})})};j.prototype.setSecurityContextAndInit=function(O,M){var N=this;N.securityContext=O;N.initUI.call(N);N.initData.call(N);if(typeof M==="function"){M()}};j.prototype.dropHandler=function(M,Q){var P=[];for(var O=0;O<M.length;O++){P.push(M[O].objectId)}var U=(this.IDleft!=null?1:0)+(this.IDright!=null?1:0);var T=P.length;if(T>5){this.NLS_showMessage("selectFiveOrFewer","compare-alert-error");return}if(T<1){console.warn("WARNING: unexpected drop count... no processing to be done");return}if(T<=2){for(var O=0;O<T;O++){if((P[O]==this.IDleft)||(P[O]==this.IDright)){this.NLS_showMessage("AlreadyLoaded","compare-alert-warning");return}}}var R=this;var N=M[0].envId;if((N==undefined)||(N==null)||(N.length==0)){N=null}var S=widget.getValue("x3dPlatformId");if(N!=null){if(S==N){H("Tenant info for dropped ID same as current tenant / no change ("+S+", "+N+")")}else{if((M.length==1)&&(((this.IDleft!=null)&&(Q=="drop-right"))||((this.IDright!=null)&&(Q=="drop-left")))){this.NLS_showMessage("TenantMismatch","compare-alert-error");H("Both objects' tenants must match // "+S+" != "+N+"... rejecting dropped object");return}else{H("Changing tenant, based upon dropped ID, from '"+S+"' to '"+N+"'");widget.setValue("x3dPlatformId",N);this.tenant=N}}}else{H("Dropped ID has no tenant info / value not changed, value remains '"+S)}R.validateIdsThenCall.call(R,P,function(V){if(V==true){if(U<2){R.processValidatedIDs(Q,P)}else{if(T>=2){R.IDleft=P[0];R.IDright=P[1];R.IDrightMulti=[];for(var W=2;W<T;++W){R.IDrightMulti[W-2]=P[W]}}else{if(T==1){if(Q=="drop-left"){R.IDleft=P[0]}else{if(Q=="drop-right"){R.IDright=P[0]}}R.IDrightMulti=[]}}R.currentCmdContext=R.CmdContexts.Replace;R.clean()}}})};j.prototype.initUI=function(O){var N=this;v.setProcessingCB(this,this.dropHandler);v.attachObject("drop-target-left",this,this.dragEnterHighlight,this.dragLeaveDeHighlight);v.attachObject("drop-target-right",this,this.dragEnterHighlight,this.dragLeaveDeHighlight);try{if(this.currentCmdContext!==this.CmdContexts.SwapColumns){this.tableCompare=new c(this.rootElement.getElement("#attribute-table"),this.proxyType,this.securityContext)}else{this.tableCompare.reInit(this.rootElement.getElement("#attribute-table"));jQuery("#compare-content").on("newRowSelectedEvent",this.tableCompare.updateTable.bind(this.tableCompare));this.tableCompare.swapAttributes()}}catch(M){console.log("Exception in create/init compare table: "+M)}if(this.rootElement.getElement("#overview-container")){this.rootElement.getElement("#overview-container").hide()}this.structureCompare=new d(this.rootElement.getElement("#compare-structure-tree"),this.rootElement.getElement("#compare-legend"),this.proxyType);if(this.currentCmdContext!==this.CmdContexts.SwapColumns){this.viewerCompare=new l(this.rootElement.getElement("#compare-viewer"))}jQuery("#compare-structure-tree").scroll(function(S){var U=jQuery("#compare-structure-tree");var P=U[0].scrollTop;var Q=U[0].scrollLeft;if(P!=N._scTopCurrent){if(N.compareOverview!=null){var R=U[0].scrollHeight;N.compareOverview.scrollTree(P,R)}N._scTopCurrent=P}else{if(Q!=N._scLeftCurrent){var U=jQuery("div#model-color-panel");if(U!=null){U[0].style.marginLeft=-Q+"px";var T=jQuery("div#model-color-spacer2");if(T!=null){T[0].hide()}}N._scLeftCurrent=Q}}})};j.prototype.updateActionbarPosition=function(){var N=jQuery("div#compare-actionBar");var M=document.getElementById("compare-region-left");var R=document.getElementById("attribute-table");var P=document.getElementById("compare-viewer");var O=document.getElementById("compare-content");var Q=(M.offsetWidth+R.offsetWidth)*100/O.offsetWidth;N.css("width",Q+"%");if((this.actionBar!==undefined)&&(this.actionBar!==null)){this.actionBar._checkWidth()}};j.prototype.updateActionbarVisibility=function(){var M=jQuery("div#compare-actionBar");if(this.leftPanel.isHidden()&&this.midPanel.isHidden()){M.css("display","none")}else{M.css("display","")}};j.prototype.initData=function(){var T=[];var X=[];var R=[];var P="drop-left";if((this.currentCmdContext==this.CmdContexts.Refresh)||(this.currentCmdContext==this.CmdContexts.Replace)||(this.currentCmdContext==this.CmdContexts.SwapColumns)){if(this.currentCmdContext==this.CmdContexts.SwapColumns){var N=this.IDleft;this.IDleft=this.IDright;this.IDright=N}if((this.IDleft!=null)||(this.IDright!=null)){if(this.IDleft!=null){P="drop-left";T.push(this.IDleft)}if(this.IDright!=null){P="drop-right";T.push(this.IDright)}for(var Q=0;Q<this.IDrightMulti.length;++Q){T.push(this.IDrightMulti[Q])}}else{if(this.JSONleft!=null){X.push(this.JSONIDleft);R.push(this.JSONIDleftType)}if(this.JSONright!=null){X.push(this.JSONIDright);R.push(this.JSONIDrightType)}}}this.IDleft=null;this.IDright=null;this.IDrightMulti=[];this.JSONIDleft=null;this.JSONIDleftType=null;this.JSONIDright=null;this.JSONIDrightType=null;if((this.currentCmdContext!=this.CmdContexts.RemoveAll)&&(this.reloadFromCompassOK==true)){if((T.length==0)&&(X.length==0)){var M=this.fetchPersistedIDs();if(M!=null){if(M.IDleft!=null){T.push(M.IDleft);P="drop-left"}if(M.IDright!=null){T.push(M.IDright);P="drop-right"}if(M.IDrightMulti!=null){for(var Q=0;Q<M.IDrightMulti.length;++Q){T.push(M.IDrightMulti[Q])}}}if(T.length==0){var O=this.fetchContentFromCompass();if(O!=null){if(O.useIndex!=null){widget.setValue("useIndex",O.useIndex)}if(O.envId!=null){this.tenant=O.envId;widget.setValue("x3dPlatformId",this.tenant);H("CompareContents: compass data indicates tenmant is now '"+this.tenant+"'")}if(O.type=="modelIDArray"){T=O.val}else{if((O.type=="snapshotIDArray")||(O.type=="mixedIDArray")){X=O.val;R=O.valType}else{if(O.type=="none"){}else{console.log("%% Unexpected ID type found on compass... ignoring")}}}}}}}if((T!=null)&&(T.length>0)){var U=this;U.validateIdsThenCall.call(U,T,function(Y){if(Y==true){U.processValidatedIDs(P,T)}})}else{if((X!=null)&&(X.length==2)){var V=new I({text:"Loading...",showButtonFlag:true}).inject(widget.body.getElement("#drop-target-left"));V.on();this.JSONIDright=X[0];this.JSONIDrightType=R[0];this.JSONIDleft=X[1];this.JSONIDleftType=R[1];var S=this;this.objMgr.fetchSnapshotObjsByID(X,R,function(aa){var Y=aa.JSONObjTableArray;var Z=aa.JSONViewerObjsArray;o(Y,Z);S.doCompareStructure.call(S,Y)},function(Y){console.log("CompareContents :: Error attempting to fetch JSON Objects from server");console.log("  Error Message :: "+Y);S.NLS_showMessage(Y.message,"compare-alert-error");S.removeAll()})}}if(this.currentCmdContext===this.CmdContexts.SwapColumns){this.currentCmdContext=this.CmdContexts.Load_4_swap}else{this.currentCmdContext=this.CmdContexts.Load}var W=((T.length>0)||(X.length>0));this.createActionBar.call(this,W);this.updateWidgetViewState()};j.prototype._forODT_viewChange=function(N){var M=this;if(M.viewerCompare){M.viewerCompare._forODT_viewChange(N)}};j.prototype.compareExport=function(M){var W=this;function V(ab,ac){if(ab.structDisplayStyle==="list"){ac.push(y.ReferenceQuantity)}else{ac.push(y.Depth)}ac.push(y.ReferenceID);if(ab.structDisplayStyle==="list"){ac.push(y.ComparedQuantity)}ac.push(y.ComparedID);ac.push(y.Type);ac.push(y.ComparisonStatus);ac.push(y.ComparisonInformation)}function X(ai,af,al,ah,aq,ap){if(af.outputAttributeDifferences&&(af.allAttributes!==undefined)){var ak=-1;var am=-1;for(var ao=0;ao<af.allAttributes.length;++ao){if(af.allAttributes[ao].id===al){ak=ao}if(af.allAttributes[ao].id===aq){am=ao}}if((ak>-1)&&(am>-1)){var ab=[];var at=af.allAttributes[ak].data;var ac=af.allAttributes[am].data;for(ao=0;(ao<at.length);++ao){if(W.tableCompare.isAttributeShownInTable(at[ao].selectable,true)){var aj=false;for(var an=0;!aj&&(an<ac.length);++an){if(at[ao].name===ac[an].name){aj=true;var au="";if((at[ao].value!==undefined)&&(at[ao].value!==null)){au=at[ao].value[0];if(at[an].type==="timestamp"||at[an].name==="modified"||at[an].name==="originated"){au=a.formatDate(au,true)}}var ad="";if((ac[an].value!==undefined)&&(ac[an].value!==null)){ad=ac[an].value[0];if(ac[an].type==="timestamp"||ac[an].name==="modified"||ac[an].name==="originated"){ad=a.formatDate(ad,true)}}if(au!==ad){ab.push({name:at[ao].name,displayName:at[ao].nls,valueLeft:au,valueRight:ad})}}}}}if(ab.length>0){var ar="";for(var ao=0;ao<ab.length;++ao){if(ao!==0){ar+="\r\n"}var ag=y.replace(y.get("ReferenceAttribute"),{attributeName:ab[ao].displayName,attributeValue:ab[ao].valueLeft});var ae=y.replace(y.get("ComparedAttribute"),{attributeName:ab[ao].displayName,attributeValue:ab[ao].valueRight});ar+=ag+", "+ae}if(ar!==""){ai.push(ar)}}}}}function O(aj,ar,am,ab,aq){var af=[];var ae="";var ak="";if(ar.structDisplayStyle==="list"){if((am.compareData!==undefined)&&(am.compareData!==null)){af.push(am.compareData.quantity)}else{af.push("")}}else{af.push(aj)}if((am.compareData!==undefined)&&(am.compareData!==null)){af.push(am.compareData.title+" "+am.compareData.revision);ae=am.compareData.physicalid}else{af.push("")}if(ar.structDisplayStyle==="list"){if((ab.compareData!==undefined)&&(ab.compareData!==null)){af.push(ab.compareData.quantity)}else{af.push("")}}if((ab.compareData!==undefined)&&(ab.compareData!==null)){af.push(ab.compareData.title+" "+ab.compareData.revision);ak=ab.compareData.physicalid}else{af.push("")}if((am.compareData!==undefined)&&(am.compareData!==null)){af.push(am.compareData.type)}else{if((ab.compareData!==undefined)&&(ab.compareData!==null)){af.push(ab.compareData.type)}else{af.push("")}}if(ab.diffType==="SM"){af.push(t.SM)}else{if(ab.diffType==="LO"){af.push(t.LO)}else{if(ab.diffType==="RO"){af.push(t.RO)}else{if(ab.diffType==="MOVED"){af.push(t.MOVED)}else{if(ab.diffType==="REV"){af.push(t.REV)}else{if(ab.diffType==="SIMILAR"){af.push(t.SIMILAR)}else{if(ab.diffType==="DIFF"){af.push(t.DIFF)}else{if(ab.diffType==="QTY"){af.push(t.QTY)}else{if(ab.diffType==="REVQTY"){af.push(t.REV+","+t.QTY)}else{if(ab.diffType==="SIMILARQTY"){af.push(t.SIMILAR+","+t.QTY)}else{if(ab.diffType==="SIMILARREVQTY"){af.push(t.SIMILAR+","+t.REV+","+t.QTY)}else{if(ab.diffType==="REVMOVED"){af.push(t.REV+","+t.MOVED)}else{if(ab.diffType==="SIMILARMOVED"){af.push(t.SIMILAR+","+t.MOVED)}else{if(ab.diffType==="SIMILARREV"){af.push(t.SIMILAR+","+t.REV)}else{if(ab.diffType==="SIMILARREVMOVED"){af.push(t.SIMILAR+","+t.REV+","+t.MOVED)}else{af.push(ab.diffType)}}}}}}}}}}}}}}}if(ar.outputAttributeDifferences&&(ar.allAttributes!==undefined)){X(af,ar,ae,am,ak,ab)}aq.rows.push(af);var ac=am.children;var ao=0;var ai=ab.children;var ap=0;if((ac!==undefined)&&(ac!==null)){ao=am.children.length}if((ai!==undefined)&&(ai!==null)){ap=ab.children.length}var ag=(ao>=ap)?ao:ap;for(var ah=0;ah<ag;ah++){var al=am.children[ah];var an=ab.children[ah];var ad=ah+1;O(aj+"."+ad,ar,al,an,aq)}}if(this.structureCompare){var N={columns:[],tables:[]};var R=this.structureCompare.fTreeData_left;var Z=this.structureCompare.fTreeData_right[0];var aa={};aa.csv_base_file_name=y.BaseFilenameExport;if(this.tableCompare){aa.allAttributes=this.tableCompare.getAllAttributes();aa.outputAttributeDifferences=true}var Y=R.length;var P=Z.length;var U=(Y>=P)?Y:P;aa.structDisplayStyle=(this.isListView)?"list":"tree";V(aa,N.columns);for(var T=0;T<U;++T){var S=T+1;var Q={rows:[]};N.tables.push(Q);O(S,aa,R[T],Z[T],Q)}b.generateCsv(N,aa)}};j.prototype.swapColumns=function(O){this.currentCmdContext=this.CmdContexts.SwapColumns;function N(P){var T="NONE";if((P!=null)&&(P!=undefined)){var Q=P.fancytree("getTree");var S=null;try{S=Q.getActiveNode();if((S!=null)&&(S!=undefined)){if((S.data!=null)&&(S.data!=undefined)){if((S.data.compareData!=null)&&(S.data.compareData!=undefined)){T=S.data.compareData.physicalid}}}}catch(R){}}return T}var M=jQuery("#structure-treetable-left");this.swapActivePID_l=N(M);M=jQuery("#structure-treetable-right");this.swapActivePID_r=N(M);this.clean()};j.prototype.refresh=function(P,O){this.currentCmdContext=this.CmdContexts.Refresh;var M=this.rootElement.getElements(".facets-list > .facet.selected");if(M.length>0){this.facetToSelect=M[0].dataset.name}if((O!==undefined)&&(O.useWidgetPreferences!==undefined)&&(O.useWidgetPreferences===true)){this.savedDupFiltering="";this.savedDupRevsFiltering=""}else{if(this.pickDialog!==null){var N=this.pickDialog.getDupFilteringValues();if(N.duplicates!==""){this.savedDupFiltering=N.duplicates}if(N.revsOfDuplicates!==""){this.savedDupRevsFiltering=N.revsOfDuplicates}}}this.closeHistoryGraphDialog();this.clean()};j.prototype.removeAll=function(N){this.currentCmdContext=this.CmdContexts.RemoveAll;this.reloadFromCompassOK=false;if(this.pickDialog!==null){var M=this.pickDialog.getDupFilteringValues();if(M.duplicates!==""){this.savedDupFiltering=M.duplicates}if(M.revsOfDuplicates!==""){this.savedDupRevsFiltering=M.revsOfDuplicates}}this.closeHistoryGraphDialog();this.clean()};j.prototype.clean=function(O){var N=this;if(this.currentCmdContext!==this.CmdContexts.SwapColumns){if(this.tableCompare){this.tableCompare.refresh()}}if(this.pickDialog){this.pickDialog=null}if(this.compareOverview){this.compareOverview.refresh();this.compareOverview=null}if(this.structureCompare){var P=this.currentCmdContext!=this.CmdContexts.SwapColumns;this.structureCompare.refresh(P)}delete this.actionBar;if(this.viewerCompare){if(this.currentCmdContext===this.CmdContexts.SwapColumns){this.viewerCompare.refresh_4_swap()}else{this.viewerCompare.releaseResources();this.viewerCompare=null}}var M=null;if(this.IsCompareContentParentADialog()){M=document.getElementsByClassName("compare_popup")[0]}else{M=widget.body.getElement("#widget-content")}if((this.filterAttributesWidget!==undefined)&&(this.filterAttributesWidget!==null)){this.doCloseCustomizeRows()}var Q=this.rightPanel;jQuery("div#compare-content").remove();this.render(M,"bottom",Q);this.init();this.tableShown=false};j.prototype.getCompareOptions=function(){var M=[];if(widget.getBool("compare_option_leaf")===true){M.push("leaf")}if(widget.getBool("compare_option_reference")===true){M.push("display_quantity")}M.push("similar");if(this.bRequiresIndex){M.push("requiresIndex")}if(widget.getBool("openness_revisions")==true){M.push("ignore_revision")}if(widget.getBool("openness_duplicates")==true){M.push("ignore_dupe")}if(widget.getBool("useIndex")==true){M.push("use_index")}if(widget.getBool("serverTimingVerbose")==true){M.push("CW_SERVER_TIMING")}return M};j.prototype.getX3DContent=function(){return widget.getValue("X3DContentId")};j.prototype.fetchPersistedIDs=function(){var M=null;var N=widget.getValue("persistedIDs");if(N){M=JSON.parse(N)}return M};j.prototype.persistIDs=function(N,M,P){var O={IDleft:N,IDright:M,IDrightMulti:P};widget.setValue("persistedIDs",JSON.stringify(O))};j.prototype.fetchContentFromCompass=function(){var Q=this;var P={type:"none",val:[],valType:[],envId:null};var X=Q.getX3DContent();if(X!=null){var O=null;try{O=JSON.parse(X)}catch(S){console.log("Compare Widget:: Incomplete JSON content; cannot compare.("+S+")");return P}if((O!=null)&&(O!=undefined)){P.useIndex=O.useIndexing;if((O.data!=null)&&(O.data!=undefined)&&(O.data.items!=null)&&(O.data.items!=undefined)){var U=O.data.items;var M=U.length;var V=false;var W=false;if(M>5){this.NLS_showMessage("selectFiveOrFewer","compare-alert-error");P.val=[]}else{var T=U[0].envId;if((T!=null)&&(T.length==0)){T=null}if((T!=null)&&(M==2)&&(U[1].envId!=(T))){H("(CompareWidget) UNEXPECTED MISMATCH on dropped IDs: '"+T+"' vs '"+U[1].envId)}H("Tenant on ID coming from compass is '"+T+"'");P.envId=T;for(var N=0;N<M;N++){var R=U[N].idType;if(R==null||R=="undefined"){R="modelID"}if(R=="snapshotID"){V=true}else{if(R=="modelID"){W=true}}P.val.push(U[N].objectId);P.valType.push(R)}if(W){if(V){P.type="mixedIDArray"}else{P.type="modelIDArray"}}else{if(V){P.type="snapshotIDArray"}}}}}}return P};j.prototype.filterAttributes=function(){var O=this;if(this.filterAttributesWidget===undefined){var M=document.createElement("div");M.className="filter-attributes-popup";var Q=document.createElement("div");var N=new x({className:"filter-attributes-modal",title:L.customizeRows,body:M,footer:Q,overlay:false,closable:true,animate:true,resizable:true,autocenter:true,visible:true,events:{onResizeFloating:function(){if(O.filterAttributesWidget!=null&&O.filterAttributesWidget.modal!=null&&O.filterAttributesWidget.modal.elements!=null){O.filterAttributesWidget.modal.centerIt();O.filterAttributesWidget.resizeForScrolling()}},onShow:function(){O.updateActionBarButtonState(false)},onHide:function(){O.updateActionBarButtonState(true)},onClose:function(){O.doCloseCustomizeRows()}}});var P=O.tableCompare.getAttributeListFromTable();this.filterAttributesWidget=new D(M,Q,P,{context:O.context,getAttributeDisplayOption:O.tableCompare.getAttributeDisplayOption,getDefaultShowAttributes:O.tableCompare.getDefaultShowAttributes,getDontShowAttributes:O.tableCompare.getDontShowAttributes,setAttributeDisplayOptions:O.tableCompare.setAttributeDisplayOptions,events:{onReady:function(R){N.inject(document.body);var S={x:4};N.setNewSizeWithDiff(S)},onModification:function(R){O.tableCompare.updateTableRowVisibility()},onClose:function(R){O.doCloseCustomizeRows()}}}).inject(M);this.filterAttributesWidget.modal=N}else{this.filterAttributesWidget.modal.show()}};j.prototype.doCloseCustomizeRows=function(){if((this.filterAttributesWidget.modal!==undefined)&&(this.filterAttributesWidget.modal!==null)){this.filterAttributesWidget.modal.destroy();this.updateActionBarButtonState(true);delete this.filterAttributesWidget}};j.prototype.updateActionBarButtonState=function(M){var N=jQuery('*[data-name="CustomizeRows"]');if(M){N.removeClass("button-unavail")}else{N.addClass("button-unavail")}};j.prototype.resizeModelColorPanel=function(){var O=jQuery("div#compare-structure-tree");var M=jQuery("div#compare-trees");var N=jQuery("div#model-color-spacer2");if((O.length==1)&&(M.length==1)&&(N.length==1)){if((O[0].clientHeight>M[0].clientHeight)&&!(O[0].clientWidth>M[0].clientWidth)){N[0].show()}else{N[0].hide()}}};j.prototype.updateWidgetViewState=function(N,M){this.viewStateMgr.updateWidgetViewState(this,N,M)};j.prototype.closeHistoryGraphDialog=function(){if(this.pickDialog!==null){this.pickDialog.closeHistoryGraphDialog()}};j.prototype.getPanelParameters=function(){return(this.layout!==null)?this.layout.getPanelParameters():null};return j});define("DS/CompareWidget/CompareWidget",["DS/CompareWidget/CompareContent","DS/LifecycleServices/LifecycleServicesSettings","DS/CompareWidget/DBG_Stopwatch","i18n!DS/CompareWidget/assets/nls/CompareWidget","DS/RuntimeView/NLSManager"],function(n,c,e,l,o){e.dbglog("compareWidget module is loading");var f=false;var d=null;var b=f?function(p){console.log("TENANT: "+p)}:function(p){};var h=false;var g=null;var j=false;if((typeof(widget)!="undefined")&&(widget.uwaUrl!=null)){if(widget.uwaUrl.search("CW_TIMING")!=-1){e.enable()}if(widget.uwaUrl.search("CW_SERVER_TIMING")!=-1){j=true}}function a(){if(h){return}if(!widget){throw new Error(l.needwidgetenv)}h=true}function m(){widget.setTitle(l.enoviaCompareTitle);e.dbglog("compareWidget init() is starting");var v={type:"hidden",name:"vizStructPanel",defaultValue:true};var t={type:"hidden",name:"vizAttrTable",defaultValue:false};var r={type:"hidden",name:"vizViewerPanel",defaultValue:true};var x={type:"hidden",name:"ratioStructPanel",defaultValue:-1};var y={type:"hidden",name:"ratioAttrTable",defaultValue:-1};var q={type:"hidden",name:"ratioViewerPanel",defaultValue:-1};var p={type:"boolean",name:"vizOverview",label:l.showOverviewBar,defaultValue:true};var E={type:"boolean",name:"vizLegend",label:l.showCompareStatusLegend,defaultValue:true};var B={type:"boolean",name:"openness_revisions",label:l.opennessRevision,defaultValue:false};var u={type:"boolean",name:"openness_duplicates",label:l.opennessDuplicates,defaultValue:false};var A={type:"list",name:"display_alternate_depth",label:l.displayAlternateDepth,defaultValue:"all",options:[{label:l.displayAlternateDepthDirect,value:"direct"},{label:l.displayAlternateDepthOrigin,value:"origin"},{label:l.displayAlternateDepthAll,value:"all"}]};var w={type:"list",name:"display_alternate_revision_type",label:l.displayAlternateRevisionType,defaultValue:"latest",options:[{label:l.displayAlternateRevisionTop,value:"top"},{label:l.displayAlternateRevisionLatest,value:"latest"},{label:l.displayAlternateRevisionLatestPublished,value:"latestPublished"},{label:l.displayAlternateRevisionAll,value:"all"}]};var D={name:"attributes_not_shown",type:"hidden",defaultValue:"",};var s={type:"boolean",name:"useIndex",label:l.useIndex,defaultValue:true};var C={type:"hidden",name:"persistedIDs",defaultValue:"[]"};var z={type:"hidden",name:"serverTimingVerbose",defaultValue:j};widget.setOptions({preferences:[z,v,t,r,x,y,q,p,E,B,u,s,A,w,D]});require(["DS/ENOPAD3DViewer/PAD3DViewer"],function(F){widget.data.addPlatformPref=false;k()},function(F){k()})}function k(){o.DEFAULT_LANGUAGE=widget.getValue("lang");e.dbglog("compareWidget complete_init() is starting");c.app_initialization(function(){var u=(widget!=null)?widget.getValue("X3DContentId"):null;var r=(u!=null)?JSON.parse(u):null;var q=(r!=null)?r.envId:null;var s=widget.getValue("x3dPlatformId");b("CompareWidget starting... x3dPlatformId (should be value from compass menu) is: '"+s+"'");if(q!=null){b("CompareWidget Starting... X3DContentId (should be tenant for data itself) is '"+q+"'")}else{b("CompareWidget launched w/o any content... using platform tenant for now")}if(q!=null&&q.length>0){if(q==s){b("CompareWidget: platform tenant and content tenant match... no need to change")}else{b("CompareWidget: platform tenant and content tenant DO NOT MATCH / changing platform's Tenant to "+q+"'");widget.setValue("x3dPlatformId",q)}}else{var t=widget.getValue("x3dPlatformId");if(t==null||t.length==0){b("CompareWidget launched, but X3DContentId is *unset*, so pushing 'OnPremise' to x3dPlatformId");widget.setValue("x3dPlatformId","OnPremise")}}g=new n({proxyType:"passport"});var p=widget.body.getElement("#widget-content");g.render(p,"bottom");g.init(function(){widget.dispatchEvent("ENOLCM/CompareWidget/endLoadingWidget")})})}d={getContent:function(){return g},onLoad:function(){widget.setBody([{tag:"div",id:"widget-content"}]);setTimeout(m,0)},onResize:function(){jQuery("#widget-content").height(window.innerHeight)},onViewChange:function(p){if(g!=null){g.updateWidgetViewState()}},onRefresh:function(q){if(g!=null){var p={useWidgetPreferences:true};g.refresh(q,p);g.updateWidgetViewState()}},onEdit:function(){},endEdit:function(){if(g!=null){g.updateWidgetViewState()}},};a();return d});
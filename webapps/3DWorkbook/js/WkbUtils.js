define("DS/3DWorkbook/js/WkbUtils",["UWA/Core","UWA/Class","UWA/Utils","UWA/Data","DS/3DWorkbook/js/WkbHighlightUtilIE","DS/3DWorkbook/js/WkbHighlightUtil","UWA/Promise"],function(d,j,g,l,b,k,h){function i(n){var m=n.getElementsByTagName("DELWKIPublishMappingRoot");return m[0].getAttribute("mode")}var a=j.singleton({init:function(m){this.graphicsMode={Graphics2D:0,Graphics3D:1,Both:2};if(this.detectIE()){this.highlightUtil=b}else{this.highlightUtil=k}},detectIE:function f(){var p=window.navigator.userAgent;var n=p.indexOf("MSIE ");if(n>0){return parseInt(p.substring(n+5,p.indexOf(".",n)),10)}var m=p.indexOf("Trident/");if(m>0){var q=p.indexOf("rv:");return parseInt(p.substring(q+3,p.indexOf(".",q)),10)}var o=p.indexOf("Edge/");if(o>0){return parseInt(p.substring(o+5,p.indexOf(".",o)),10)}return false},createAndAppend:function(n,m,p,r){var o={};if(p){o["class"]=p}if(r){o.id=r}var q=d.createElement(m,o);n.appendChild(q);return q},callServerRequest:function(o,s,q,u,m,t,p){var n=widget.getValue("collabSpace");if(n==undefined){n=null}var r={Accept:"application/json, text/plain, application/octet-stream",SecurityContext:n};if(d.is(p)){r["Content-Type"]=p}l.request(o,{method:m,type:u,data:t,cache:-1,headers:r,timeout:50000,proxy:(window.UWA.Data.proxies.passport?"passport":"ajax"),onComplete:s,onFailure:q?q:function(v){d.log("Error")}})},callServerRequestAjax:function(m){var n={Accept:"application/json, text/plain, application/octet-stream",SecurityContext:widget.getValue("collabSpace")};l.request(m,{method:"GET",type:"xml",data:"",cache:-1,headers:n,timeout:50000,proxy:"ajax"})},serverRequestPromise:function c(n,m,q,o){var p=this;return new h(function(t,s){var v=function(w){t(w)};var r=function(w){s(w)};var u="application/json";p.callServerRequest(n,v,r,m,q,o,u)})},getServerData:function(o,p,n,m){this.callServerRequest(o,p,n,m,"GET","")},postServerData:function(n,p,m,o){this.callServerRequest(n,p,m,"json","POST",o)},getPreferenceValue:function(o,m){var n;for(n=0;n<o.length;++n){if(o[n].name===m){return o[n].value}}return""},getPrefBoolValue:function(o,m){var n;for(n=0;n<o.length;++n){if(o[n].name===m){if(o[n].value.toUpperCase()==="TRUE"){return true}else{return false}}}return false},getAlertMessageBody:function(m){var n;if(window.DOMParser){var o=new DOMParser();n=o.parseFromString(m,"text/html")}else{n=new ActiveXObject("Microsoft.XMLDOM");n.async=false;n.loadXML(m)}return(n.body.innerHTML)},getPartHighlightPath:function(w,m){var o=this;var p,x,q,s=null;var n="";var t=(i(m)==="Connected");var r=w.getElement("#prdPathList");if(r){var u=r.getElementsByTagName("li");if(u.length>0){if(t){x=this.highlightUtil.getPathFromMapConnected(r,m,0);if(!x){x=this.highlightUtil.getPathFromMapConnected(r,m,1)}}else{x=this.highlightUtil.getPathFromMap(u,m,0);if(!x){x=this.highlightUtil.getPathFromMap(u,m,1)}}}else{var v=w.getElement("#refId");x=this.highlightUtil.getTopAssemblyPath(v.getAttribute("data-refId"),m)}}if(x){n=x}return n},getHighlightIdByExternalPath:function(t,m){var o=this;var p,u=null,q,r=null;var n="";var s=(i(m)==="Connected");if(t.length>0){if(s){u=this.highlightUtil.getPartPhysicalId(t,m)}else{return""}}else{return""}if(d.is(u)){n=u}return n},getInstancePath:function e(o,n){var m=[];if(d.is(n)&&n!==""){var p=(i(n)==="Connected");if(p){m=this.highlightUtil.getInstancePath(o,n);if(!d.is(m)){m=[]}}else{return[]}}return m},getToolHighlightPath:function(n,m){return this.highlightUtil.getToolHighlightPath(n,m,i(m))}});return a});
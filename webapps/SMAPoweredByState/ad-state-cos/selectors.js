/*!  Copyright 2017 Dassault Systemes. All rights reserved. */
define(["UWA/Utils"],function(b){var a={};a.ErrorCodes={SERVER_STATUS_WS_ERROR:"SMAPoweredByState.ad-state-cos.SERVER_STATUS_WS_ERROR",RUNASENABLED_WS_ERROR:"SMAPoweredByState.ad-state-cos.RUNASENABLED_WS_ERROR",DRM_WS_ERROR:"SMAPoweredByState.ad-state-cos.DRM_WS_ERROR",DRM_CPULIMIT_WS_ERROR:"SMAPoweredByState.ad-state-cos.DRM_CPULIMIT_WS_ERROR",STATIONS_WS_ERROR:"SMAPoweredByState.ad-state-cos.STATIONS_WS_ERROR",PRIVATE_STATIONS_ERROR:"SMAPoweredByState.ad-state-cos.PRIVATE_STATIONS_ERROR",SERVERS_WS_ERROR:"SMAPoweredByState.ad-state-cos.SERVERS_WS_ERROR"};a.DRMMode={CLOUD:"Cloud",FIPER:"fiper",LSF:"lsf"};a.OS={WINDOWS:"windows",LINUX:"linux"};a.ServerStatus={NOTRESPONDING:"NOTRESPONDING",UNKNOWN:"UNKNOWN",UNSTARTED:"UNSTARTED",INITIALIZING:"INITIALIZING",STARTING:"STARTING",RUNNING:"RUNNING",SHUTTINGDOWN:"SHUTTINGDOWN",STOPPED:"STOPPED"};a.StationStatus={INVALID:"Invalid",UNKNOWN:"Unknown",RUNNING:"Running",OFFLINE:"Offline",QUIETING:"Quieting",SHUTDOWN:"Shutdown",SUSPENDED:"Suspended"};a.LOCALSTATIONNAME="{localhost}";a.MaxCores={};a.MaxCores[a.OS.WINDOWS]=4;a.MaxCores[a.OS.LINUX]=16;a.isServersInitialized=function(c){return !c.cos.servers.uninitialized};a.serversPersistenceOperation=function(c){return !c.cos.servers.persistenceOperation?null:c.cos.servers.persistenceOperation};a.serversPersistenceError=function(c){return !c.cos.servers.persistenceError?null:c.cos.servers.persistenceError};a.allServers=function(c){return c.cos.servers.objects};a.serverWithID=function(d,f){var e=null,c;for(c=0;c<d.cos.servers.objects.length;c++){if(d.cos.servers.objects[c].id===f){e=d.cos.servers.objects[c];break}}return e};a.serverForStation=function(e,d){var f=null,c;for(c=0;c<e.cos.servers.objects.length;c++){if(e.cos.servers.objects[c].id===d.server){f=e.cos.servers.objects[c];break}}return f};a.isStationsInitialized=function(c){return !c.cos.stations.uninitialized};a.stationsPersistenceOperation=function(c){return !c.cos.stations.persistenceOperation?null:c.cos.stations.persistenceOperation};a.stationsPersistenceError=function(c){return !c.cos.stations.persistenceError?null:c.cos.stations.persistenceError};a.allStations=function(c){return c.cos.stations.objects};a.serverStations=function(c,d){return c.cos.stations.objects.filter(function(e){return e.server===d.id})};a.firstStationWithID=function(e,f){var d=null,c;for(c=0;c<e.cos.stations.objects.length;c++){if(e.cos.stations.objects[c].id===f){d=e.cos.stations.objects[c];break}}return d};a.stationWithID=function(e,f,h){var d=null,g,c;if(f){g=a.serverStations(e,f);for(c=0;c<g.length;c++){if(g[c].id===h){d=g[c];break}}}return d};a.stationWithName=function(f,g,c){var e=null,h=a.serverStations(f,g),d;for(d=0;d<h.length;d++){if(h[d].name===c){e=h[d];break}}return e};a.privateStation=function(f,g,e){var d=null,h=a.serverStations(f,g),c;for(c=0;c<h.length;c++){if(h[c].name===a.LOCALSTATIONNAME){if(!e||(b.matchUrl(e,h[c].spaceURL))){d=h[c];break}}}return d};a.runningStations=function(d,e,c){return d.cos.stations.objects.filter(function(f){return((!e||(f.server===e.id))&&(!c||(b.matchUrl(c,f.spaceURL)))&&(f.status===a.StationStatus.RUNNING))})};a.runningWindowsStations=function(d,e,c){return a.runningStations(d,e,(c?c:null)).filter(function(f){return(f.os===a.OS.WINDOWS)})};a.isDRMConfigurationsInitialized=function(c){return !c.cos.drmConfigurations.uninitialized};a.cpuLimit=function(g,j,e,f){var h=(typeof j==="string")?a.serverWithID(g,j):j,c=null;if(e===a.DRMMode.CLOUD){if(f===a.OS.WINDOWS){c=a.MaxCores[a.OS.WINDOWS]}else{c=a.MaxCores[a.OS.LINUX];if(h&&h.drmInfo&&h.drmInfo.length>0){for(var d=0;d<h.drmInfo.length;d++){if(h.drmInfo[d].name===a.DRMMode.CLOUD&&h.drmInfo[d].cpuLimit>0){c=h.drmInfo[d].cpuLimit;break}}}}}return c};return a});
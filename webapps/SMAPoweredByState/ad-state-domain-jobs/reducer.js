/*!  Copyright 2017 Dassault Systemes. All rights reserved. */
define(["DS/SMAPoweredByState/ad-state-domain-jobs/action-types","DS/SMAPoweredByState/ad-state-domain-jobs/job-reducer","DS/SMAPoweredByState/ad-state-domain-study/action-types","DS/SMAPoweredByState/ad-state-utils","DS/SMAPoweredByState/ad-state-defs"],function(d,f,b,g,h){var e={};const c={uninitialized:true,objects:[]};function i(m,l){var j=null,k,n=m;if(l.payload&&l.payload.pendingJobID){j=g.getObject(m.objects,l.payload.pendingJobID)}else{if(l.payload&&l.payload.jobID){j=g.getObject(m.objects,l.payload.jobID)}else{if(l.payload&&l.payload.context&&l.payload.context.jobID){j=g.getObject(m.objects,l.payload.context.jobID)}else{if(l.payload&&l.payload.context){j=g.getObject(m.objects,l.payload.context)}else{if(l.jobID){j=g.getObject(m.objects,l.jobID)}}}}}k=f["default"](j,l);if(k!==j){n={objects:m.objects.slice()};if(j!==null){g.replaceObject(n.objects,k,j)}else{n.objects.push(k)}}return n}function a(l,k){var m,j;if(typeof l==="undefined"){m=g.deepCopy(c)}else{switch(k.type){case b.CREATE_STUDY+h.AsyncStatus.PENDING:m=g.deepCopy(c);if(m.uninitialized){delete m.uninitialized}break;case b.CLOSE_STUDY:m=g.deepCopy(c);break;case d.CREATE_JOB+h.AsyncStatus.FAILURE:case d.CLONE_JOB+h.AsyncStatus.FAILURE:m={persistenceError:k.payload.error,objects:l.objects.slice()};g.removeObject(m.objects,k.payload.context);break;case d.UPDATE_JOB+h.AsyncStatus.PENDING:m={objects:l.objects.slice()};j=g.getObject(m.objects,k.payload.jobID);j.persistenceOperation=h.PersistenceOperation.UPDATING;if(j.persistenceError){delete j.persistenceError}break;case d.UPDATE_JOB+h.AsyncStatus.SUCCESS:m={objects:l.objects.slice()};j=g.getObject(m.objects,k.payload.jobID);j.persistenceStatus=h.PersistenceStatus.CLEAN;delete j.persistenceOperation;break;case d.UPDATE_JOB+h.AsyncStatus.FAILURE:m={objects:l.objects.slice()};j=g.getObject(m.objects,k.payload.context);j.persistenceError=k.payload.error;delete j.persistenceOperation;break;case d.DELETE_JOBS+h.AsyncStatus.PENDING:m={objects:l.objects.slice()};k.payload.forEach(function(n){j=g.getObject(m.objects,n);j.persistenceOperation=h.PersistenceOperation.DELETING;if(j.persistenceError){delete j.persistenceError}});break;case d.DELETE_JOBS+h.AsyncStatus.SUCCESS:case d.DELETE_JOBS+h.AsyncStatus.FAILURE:m={objects:l.objects.slice()};if(k.payload.successes){k.payload.successes.forEach(function(n){g.removeObject(m.objects,n)})}if(k.payload.failures&&(k.payload.failures.length>0)){k.payload.failures.forEach(function(n){n.ids.forEach(function(o){j=g.shallowCopy(g.getObject(m.objects,o));if(j.persistenceOperation){delete j.persistenceOperation}j.persistenceError=n.error.error;g.replaceObject(m.objects,j)})})}break;case d.REFRESH_JOBS+h.AsyncStatus.PENDING:m={persistenceOperation:h.PersistenceOperation.READING,objects:l.objects};break;case d.REFRESH_JOBS+h.AsyncStatus.SUCCESS:m={objects:k.payload.slice()};break;case d.REFRESH_JOBS+h.AsyncStatus.FAILURE:m={persistenceError:k.payload.error,objects:l.objects};break;default:m=i(l,k);break}}return m}e["default"]=a;return e});
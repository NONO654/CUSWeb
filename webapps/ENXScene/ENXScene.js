/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
function ENXScene(b){var c=function(e){var d=false;if(UWA.is(e,"boolean")){d=e}else{if(UWA.is(e,"string")){d=e.toLowerCase()==="true"}}return d};var a={widget:null,xnav_component_opts:{x3dAppId:null,widget:null,active_view:null,action_bar_opts:null,layout:{title_update:true,view_customization:null,store_roots_in_pref:true,padshell:true,root_panel:true,specific_columns:{0:"bi_color"}},amd_custo:{}},xnav_component:null,init:function(d){this.pcsPrefix=widget.id+"_"+widget.title;window.top.performance.mark(this.pcsPrefix+"_init");window.top.performance.measure(this.pcsPrefix+"_call_init","enxscene_load_html",this.pcsPrefix+"_init");this.widget=d.widget;if(d.odt_settings){this._odt_settings=d.odt_settings}if(d.odt_xnavcomponents_opts){this.xnav_component_opts=d.odt_xnavcomponents_opts}this.widget.addEvent("onLoad",this.onLoad.bind(this));this.widget.addEvent("onRefresh",this.onRefresh.bind(this))},onRefresh:function(){var d=this;require(["DS/PADUtils/PADSettingsMgt"],function(e){if(e.getSetting("refresh_v2")===true&&d.xnav_component!==null){d.xnav_component.refresh()}})},onLoad:function(){var d=this;window.top.performance.mark(this.pcsPrefix+"_onload");window.top.performance.measure(this.pcsPrefix+"_call_onload",this.pcsPrefix+"_init",this.pcsPrefix+"_onload");if(this.xnav_component===null){require(["DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSession","DS/PADServices/utils/AttributesMgt","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADWebInWinServices","UWA/Utils/Client","text!DS/ENXScene/assets/xscene_settings.json","i18n!DS/ENXScene/assets/nls/ENXScene.json","DS/PADUtils/Configuration","DS/PADServices/utils/Storage","text!DS/ENXScene/assets/ProductExplorerConf.json"],function(k,r,e,u,l,t,s,i,j,w,p){r.softInit(true);window.top.performance.mark(d.pcsPrefix+"_require_infra_padutils");window.top.performance.measure(d.pcsPrefix+"_require_infra",d.pcsPrefix+"_onload",d.pcsPrefix+"_require_infra_padutils");var m=JSON.parse(p);j.mergeConfig(m);var f=JSON.parse(s);if(d._odt_settings){f.padsettings=UWA.extend(f.padsettings,d._odt_settings,true)}l.initialize({widget:d.widget});k.setApp(f.padsettings,"enxscene",true);u.addSharedSettings(d.widget,["x3dPlatformId","storedObjectMgt","maxDashSearch"]);d.widget.mergePreferences(k.getWidgetPreferences());d.widget.addEvent("endEdit",function(){if(typeof d.widget!="undefined"&&k.getSetting("webInWin_context_availability").indexOf(d.widget.getValue("addinmode"))!==-1&&d.widget.getValue("X3DContentId")){d._processContentID({callback:function(){d.widget.dispatchEvent("onContentAdded")}})}else{k.updateWidgetPreferences.call(k)}});d.widget.addEvent("onPlatformIdChange",function(x,y){if(x=="x3dPlatformId"){k.updateTenantSecPreference(y,true)}});d.widget.addEvent("onChangeControlUpdate",function(x,y){var z=k.getSetting("changeControlActivation");if(d.widget.getValue("changeControlActivation")!==undefined){z=d.widget.getBool("changeControlActivation")}var A="bottom-right";if(sessionStorage.getItem("changeControlPosition")){A=sessionStorage.getItem("changeControlPosition")}else{A=k.getSetting("changeControlPosition")}if(y===false){d.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:A,})}else{d.widget.addPreference({name:"changeControlPosition",defaultValue:A,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]})}d.widget.dispatchEvent("onEdit")});k.updateWidgetPreferences();if(k.getSetting("activateFUN078214")===true){d.widget.addEvent("onSearch",d.onSearch.bind(d))}if(!d.widget.getValue("x3dSharedId")&&!d.widget.getValue("x3dAppId")){d.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENXScene_appId"})}var q=d.xnav_component_opts;var g=widget.getValue("forceTouchMode")?widget.getValue("forceTouchMode"):false;var v=g||((t.Features.touchEvents&&!t.Features.pointerEvents))?f.action_bar.touch:f.action_bar.standard;if(l.isWebInWinContext()){v=f.action_bar.webinwin}q.layout.propertiesFacet=k.getSetting("propertiesFacet");v.language=d.widget.lang;q.x3dAppId=d.widget.getValue("x3dAppId");q.widget=d.widget;q.insert_replace=true;q.active_view=d.widget.getValue("default_view");q.authorize_setStructure=true;q.insert_replace=true;q.renderTo=document.body;if(k.getSetting("activateDropInviteWithFilter")===true){q.layout.drop_invite="inviteWithFilter"}else{if(k.getSetting("activate_newDropInvite")===true){q.layout.drop_invite="drop_here"}}if(k.getSetting("columnParametrization")!==true){q.layout.specific_columns=undefined}if(k.getSetting("authorizeChangeControl")===true){q.authorizeChangeControl=true;if(d.widget.getValue("changeControlActivation")!==undefined){k.setSetting("changeControlActivation",d.widget.getBool("changeControlActivation"))}}if(d.xnav_component_opts.layout.noactionbar!==true){q.action_bar_opts=v}if(k.getSetting("activateDGV")===true){q.layout.amdTreeView="datagridview";if(q.active_view==="treelistview"){q.active_view="datagridview"}}else{if(q.active_view==="datagridview"){q.active_view="treelistview"}}if(d._odt_settings&&d._odt_settings.onModifyViewSettings){d._odt_settings.onModifyViewSettings(f.view_settings)}e.updateAttributesList(m.columnsCusto);var o=d.widget.getValue("xscene_custo");var h=d.widget.getValue("xscene_custoParams");if(h){e.updateSelectedParams(JSON.parse(h))}if(o==="null"){o=null}var n=w.sess.get("PE/XSceneCusto");if(k.getSetting("resetCustomization")===true||(o&&o.charAt(0)!=="{")){localStorage.removeItem("PADTreeListDefinition."+q.x3dAppId);d._initialize_component(q)}else{if(n){q.layout.view_customization=n;d._initialize_component(q)}else{if(o){q.layout.view_customization=JSON.parse(o);d._initialize_component(q)}else{require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess","DS/PADServices/utils/AttributesMgt"],function(y,z,x){y.app_initialization(function(A){if(A&&A.success){z.getMyAppsTemplate({preference_name:q.x3dAppId+"-"+y.getPlatformId(),onComplete:function(C){var B=null;if(C.length>0&&C.charAt(0)==="{"){B=JSON.parse(C);if(B.selectedExtensions&&B.selectedTypes){x.updateSelectedParams({selectedExtensions:B.selectedExtensions,selectedTypes:B.selectedTypes});delete B.selectedExtensions;delete B.selectedTypes}}q.layout.view_customization=B;d._initialize_component(q)},onFailure:function(B){d._initialize_component(q)}})}else{d._initialize_failure()}})})}}}})}},onDestroy:function(){this.xnav_component.destroy();this.xnav_component=null;var d=require("DS/PADUtils/PADSharedSettings");d.destroy()},_initialize_component:function(f){var d=this,e=f||{};window.top.performance.mark(d.pcsPrefix+"_require_xnavcomponent_before");require(["DS/WebappsUtils/WebappsUtils","DS/ENXNav/XNavComponent"],function(i,g){window.top.performance.mark(d.pcsPrefix+"_require_xnavcomponent_done");window.top.performance.measure(d.pcsPrefix+"_require_xnavcomponent",d.pcsPrefix+"_require_xnavcomponent_before",d.pcsPrefix+"_require_xnavcomponent_done");var h=UWA.extend(e,d._addEventsCB());d.xnav_component=new g(e);d.widget.setBody(d.xnav_component.render())})},_initialize_failure:function(){var d=this;require(["css!DS/ENXNav/ENXNav","DS/ENXNav/views/xNavInitError","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(g,i,h){var f=UWA.createElement("div",{"class":"xnav_component"});var e=new i({msg:h.initialization_error});f.setContent(e);d.widget.setBody(f);d.widget.dispatchEvent("onXSceneReady")})},_processContentID:function(f){var e=this;var g=e.widget.getValue("X3DContentId");var d=UWA.is(g,"string")?JSON.parse(g):g;require(["DS/PADUtils/PADTypesMgt","DS/ENXNav/utils/xNavKindProcessor"],function(i,h){i.retrieveAuthorizedObjects({version:"2.0",X3DContentId:d,callback:function(j){h.loadKinds(e.xnav_component,j,undefined,false,f&&f.callback?f.callback:undefined);e.widget.deleteValue("X3DContentId")}})})},_addEventsCB:function(){var d=this;var e="saved_filter_ids";return{events:{onReady:function(){window.top.performance.mark(d.pcsPrefix+"_xnavcomponent_onready");window.top.performance.measure(d.pcsPrefix+"_xnavcomponent_ready",d.pcsPrefix+"_require_xnavcomponent_done",d.pcsPrefix+"_xnavcomponent_onready");d.widget.addEvent("onViewChange",d.xnav_component.onResize.bind(d.xnav_component));d.widget.addEvent("onResize",d.xnav_component.onResize.bind(d.xnav_component));var k=require("DS/PADUtils/PADSettingsMgt");var n=require("DS/PADUtils/PADWebInWinServices");if(!n.isWebInWinContext()&&k.getSetting("activateTreeOptionsInWidgetBody")===true){var o=require("DS/PADServices/utils/GlobalModelEvents");var A=o.getModelEvents();A.subscribe({event:"ENXViews/Views/showInWidgetBody"},function(B){if(B.html){if(B.title){widget.setTitle(B.title)}widget.setBody(B.html)}else{if(B.restore===true){widget.setTitle(d.xnav_component.getWidgetTitle());d.widget.setBody(d.xnav_component.render())}}})}var u=require("DS/PADUtils/PADSharedSettings");u.resetDebounceFlags();d.xnav_component.addEvent("onToggleView",function(B){d.widget.setValue("default_view",B)});var s=[];var x=[];if(d.widget.getValue("xscene_root_pids")===undefined){d.widget.addPreference({name:"xscene_root_pids",type:"hidden",defaultValue:"[]"})}else{s=JSON.parse(d.widget.getValue("xscene_root_pids"));d.widget.setValue("xscene_root_pids","[]")}if(!d.widget.getValue("xscene_root_pids_detached")){d.widget.addPreference({name:"xscene_root_pids_detached",type:"hidden",defaultValue:"[]"})}if(d.widget.getValue(e)===undefined){d.widget.addPreference({name:e,type:"hidden",defaultValue:"[]"})}else{x=JSON.parse(d.widget.getValue(e));d.widget.setValue(e,"[]")}var t=d.widget.getValue("X3DContentId");var i=widget.getValue("xscene_struture");if(i==="null"){i=null}widget.setValue("xscene_struture",null);var y=(x&&x.length>0)?true:false;var f=i?true:false;if(UWA.is(i,"string")){var v=JSON.parse(i);var k=require("DS/PADUtils/PADSettingsMgt");var g=require("UWA/Promise");var m=JSON.parse(widget.getValue("xscene_root_pids_detached"));var w=(i!=="{}")&&(k.getSetting("activate_loadPopUp")===true&&c(d.widget.getValue("storedObjectMgt"))&&!(d.widget.getValue("addinmode")&&k.getSetting("webInWin_context_availability").indexOf(d.widget.getValue("addinmode"))!==-1));if(w){require(["DS/PADUtils/views/PADStoredObjMgt"],function(E,D){var C=widget.getValue("xscene_objectInfos");if(UWA.is(C,"string")){C=JSON.parse(C)}else{C={}}var B=new E({render_div:".xnav_component",structure:JSON.parse(i),objectInfos:C,id_to_detach:m,filterIds:x,xnav_component:d.xnav_component,events:{onLoadObjects:function(H){widget.setValue(e,"[]");widget.setValue("xscene_root_pids","[]");widget.setValue("xscene_root_pids_detached","[]");widget.setValue("xscene_struture",null);y=(H.filterIds&&H.filterIds.length>0)?true:false;f=H.structure?true:false;if(y&&f){var G=[];var I=new g(function(J){g.all(G).then(function(){d.xnav_component.addFilter({filterIds:H.filterIds,broadcast:false,doNotFillTheTagger:true,callback:function(K){J(K)}})})});I.name="AddFilter";G.push(I);var F=new g(function(J){g.all(G).then(function(K){d.xnav_component.add({content:"structure",structure:H.structure,id_to_detach:H.id_to_detach,broadcast:false,callback:function(){console.log("structure added")}})});J()});F.name="AddRoots";G.push(F);g.all(G).then(function(){d.widget.dispatchEvent("onXSceneReady")})}else{if(y){d.xnav_component.addFilter({filterIds:H.filterIds,broadcast:false,doNotFillTheTagger:true,callback:function(J){d.widget.dispatchEvent("onXSceneReady")}})}else{if(f){d.xnav_component.add({content:"structure",structure:H.structure,id_to_detach:H.id_to_detach,broadcast:false,callback:function(){d.widget.dispatchEvent("onXSceneReady")}})}}}widget.setValue("xscene_objectInfos",JSON.stringify(H.objectInfos));if(c(d.widget.getValue("storedObjectMgt"))!==H.showStoredObjectMgt){widget.setValue("storedObjectMgt",H.showStoredObjectMgt)}}}})})}else{widget.setValue(e,"[]");widget.setValue("xscene_root_pids","[]");widget.setValue("xscene_root_pids_detached","[]");widget.setValue("xscene_struture",null);var j=JSON.parse(i);y=(x.length>0)?true:false;if(y){var r=[];var z=new g(function(B){g.all(r).then(function(){d.xnav_component.addFilter({filterIds:x,broadcast:false,doNotFillTheTagger:true,callback:function(C){B(C)}})})});z.name="AddFilter";r.push(z);var l=new g(function(B){g.all(r).then(function(C){C.forEach(function(D){if(j.hasOwnProperty(D)){delete j[D]}});d.xnav_component.add({content:"structure",structure:j,id_to_detach:m,broadcast:false,callback:function(){console.log("structure loaded directly after filter loaded")}})});B()});l.name="AddRoots";r.push(l);g.all(r).then(function(){if(d.widget.getValue("addinmode")&&k.getSetting("webInWin_context_availability").indexOf(d.widget.getValue("addinmode"))!==-1&&t){d._processContentID({callback:function(){d.widget.dispatchEvent("onXSceneReady")}})}else{d.widget.dispatchEvent("onXSceneReady")}})}else{d.xnav_component.add({content:"structure",structure:j,id_to_detach:m,broadcast:false,callback:function(){d.widget.dispatchEvent("onXSceneReady");if(d.widget.getValue("addinmode")&&k.getSetting("webInWin_context_availability").indexOf(d.widget.getValue("addinmode"))!==-1&&t){d._processContentID({callback:function(){d.widget.dispatchEvent("onXSceneReady")}})}else{d.widget.dispatchEvent("onXSceneReady")}}})}}}else{if(s.length>0){var h=JSON.parse(d.widget.getValue("xscene_root_pids_detached"));if(k.getSetting("activate_loadPopUp")===true&&c(d.widget.getValue("storedObjectMgt"))){var q={};for(var p=0;p<s.length;p++){q[s[p]]={}}require(["DS/PADUtils/views/PADStoredObjMgt"],function(E,D){var C=widget.getValue("xscene_objectInfos");if(UWA.is(C,"string")){C=JSON.parse(C)}else{C={}}var B=new E({render_div:".xnav_component",structure:q,objectInfos:C,id_to_detach:m,filterIds:x,xnav_component:d.xnav_component,events:{onLoadObjects:function(H){widget.setValue(e,"[]");widget.setValue("xscene_root_pids","[]");widget.setValue("xscene_root_pids_detached","[]");widget.setValue("xscene_struture",null);y=(H.filterIds&&H.filterIds.length>0)?true:false;f=H.structure?true:false;if(y&&f){var G=[];var I=new g(function(J){g.all(G).then(function(){d.xnav_component.addFilter({filterIds:H.filterIds,broadcast:false,doNotFillTheTagger:true,callback:function(K){J(K)}})})});I.name="AddFilter";G.push(I);var F=new g(function(J){g.all(G).then(function(K){d.xnav_component.add({content:"structure",structure:H.structure,id_to_detach:H.id_to_detach,broadcast:false,callback:function(){}})});J()});F.name="AddRoots";G.push(F);g.all(G).then(function(){d.widget.dispatchEvent("onXSceneReady")})}else{if(y){d.xnav_component.addFilter({filterIds:H.filterIds,broadcast:false,doNotFillTheTagger:true,callback:function(J){d.widget.dispatchEvent("onXSceneReady")}})}else{if(f){d.xnav_component.add({content:"structure",structure:H.structure,id_to_detach:H.id_to_detach,broadcast:false,callback:function(){d.widget.dispatchEvent("onXSceneReady")}})}}}widget.setValue("xscene_objectInfos",JSON.stringify(H.objectInfos));if(c(d.widget.getValue("storedObjectMgt"))!==H.showStoredObjectMgt){widget.setValue("storedObjectMgt",H.showStoredObjectMgt)}}}})})}else{d.widget.setValue(e,"[]");d.widget.setValue("xscene_root_pids","[]");d.widget.setValue("xscene_root_pids_detached","[]");y=(x.length>0)?true:false;if(y){var r=[];var z=new g(function(B){g.all(r).then(function(){d.xnav_component.addFilter({filterIds:x,broadcast:false,doNotFillTheTagger:true,callback:function(C){B(C)}})})});z.name="AddFilter";r.push(z);var l=new g(function(B){g.all(r).then(function(C){s=s.filter(function(D){return(this.indexOf(D)<0)},C);if(s&&s.length>0){d.xnav_component.add({content:"idslist",pids:s,id_to_detach:h,behavior:undefined,broadcast:false,callback:function(){d.widget.dispatchEvent("onXSceneReady")}})}else{d.widget.dispatchEvent("onXSceneReady")}});B()});l.name="AddRoots";r.push(l);g.all(r).then(function(){d.widget.dispatchEvent("onXSceneReady")})}else{d.xnav_component.add({content:"idslist",pids:s,id_to_detach:h,behavior:undefined,broadcast:false,callback:function(){d.widget.dispatchEvent("onXSceneReady")}})}}}else{if(UWA.is(t)){d._processContentID({callback:function(){d.widget.dispatchEvent("onXSceneReady")}})}else{if(x.length>0){d.widget.setValue(e,"[]");if(k.getSetting("activate_loadPopUp")===true&&c(d.widget.getValue("storedObjectMgt"))){require(["DS/PADUtils/views/PADStoredObjMgt"],function(E,D){var C=widget.getValue("xscene_objectInfos");if(UWA.is(C,"string")){C=JSON.parse(C)}else{C={}}var B=new E({render_div:".xnav_component",objectInfos:C,filterIds:x,xnav_component:d.xnav_component,events:{onLoadObjects:function(F){widget.setValue(e,"[]");if(F.filterIds&&F.filterIds>0){d.xnav_component.addFilter({filterIds:F.filterIds,broadcast:false,doNotFillTheTagger:true,callback:function(G){d.widget.dispatchEvent("onXSceneReady")}})}widget.setValue("xscene_objectInfos",JSON.stringify(F.objectInfos));if(c(d.widget.getValue("storedObjectMgt"))!==F.showStoredObjectMgt){widget.setValue("storedObjectMgt",F.showStoredObjectMgt)}}}})})}else{d.xnav_component.addFilter({filterIds:x,broadcast:false,doNotFillTheTagger:true,callback:function(B){d.widget.dispatchEvent("onXSceneReady")}})}}else{d.widget.dispatchEvent("onXSceneReady")}}}}window.top.performance.mark(d.pcsPrefix+"_app_load_complete");window.top.performance.measure(d.pcsPrefix+"_app_load_completed","enxscene_load_html",d.pcsPrefix+"_app_load_complete")},onAddFilters:function(h){var f=require("DS/PADUtils/PADSettingsMgt");if(f.getSetting("activate_reloadFilter")===true){if(h.filterIds.length>0){var g=JSON.parse(d.widget.getValue(e));g=g.concat(h.filterIds);g=g.filter(function(k,i,j){return j.indexOf(k)===i});d.widget.setValue(e,JSON.stringify(g))}}},onSaveRoots:function(){var l=[],g=[],m=d.xnav_component.options.model;m.getRoots().forEach(function(i){l.push(i.getID())});if(m.hasOwnProperty("detachedRoots")){m.detachedRoots.forEach(function(i){g.push(i.getID());if(l.indexOf(i.getID())===-1){l.push(i.getID())}})}var h=widget.getValue("xscene_struture");if(h==="null"){h=null}if(UWA.is(h,"string")){var j,k=l.length;h=JSON.parse(h);var f={};for(j=0;j<k;j++){if(h.hasOwnProperty(l[j])){f[l[j]]=h[l[j]]}}widget.setValue("xscene_struture",JSON.stringify(f))}d.widget.setValue("xscene_root_pids",JSON.stringify(l));d.widget.setValue("xscene_root_pids_detached",JSON.stringify(g))},onAddPaths:function(m){var g=widget.getValue("xscene_struture");if(g==="null"){g=null}if(!UWA.is(g)){g={}}else{g=JSON.parse(g)}var h;var l=m.addedPaths.length;for(h=0;h<l;h++){var j=g;var f=0;var k=m.addedPaths[h].length;for(f=0;f<k;f++){if(!j.hasOwnProperty(m.addedPaths[h][f])){j[m.addedPaths[h][f]]={}}j=j[m.addedPaths[h][f]]}}widget.setValue("xscene_struture",JSON.stringify(g))},onDeleteRoots:function(k){var n=JSON.parse(widget.getValue("xscene_root_pids")),h=JSON.parse(widget.getValue("xscene_root_pids_detached"));var m=JSON.parse(k);var l=[],g=[];if(m.length>0){if(n.length>0){l=n.filter(function(i){return this.indexOf(i)<0},m)}if(h.length>0){g=h.filter(function(i){return this.indexOf(i)<0},m)}}var o=widget.getValue("xscene_struture");if(o==="null"){o=null}if(UWA.is(o,"string")){o=JSON.parse(o);var j,f=m.length;for(j=0;j<f;j++){if(o.hasOwnProperty(m[j])){delete o[m[j]]}}widget.setValue("xscene_struture",JSON.stringify(o))}widget.setValue("xscene_root_pids",JSON.stringify(l));widget.setValue("xscene_root_pids_detached",JSON.stringify(g))},onRootsVisibility:function(){var f=[],g=d.xnav_component.options.model;if(g.hasOwnProperty("detachedRoots")){g.detachedRoots.forEach(function(h){f.push(h.getID())})}d.widget.setValue("xscene_root_pids_detached",JSON.stringify(f))},onCustoViewChange:function(f,g){d.widget.setValue("xscene_custo",JSON.stringify(f));if(g){d.widget.setValue("xscene_custoParams",JSON.stringify(g))}},onAuthoringCtxAvailable:function(j){if(j.isLicenseValid===true){var g=require("DS/PADUtils/PADSettingsMgt");var h=require("DS/PADUtils/PADCommandProxy");d.debouncePrefSynchro=false;d._proxy=h.create({events:{onPreferenceModification:function(l){if(l.name==="changeControlActivation"){d.debouncePrefSynchro=true;d.widget.setValue(l.name,l.value);g.setSetting(l.name,l.value)}}}});var i=g.getSetting("changeControlActivation");if(d.widget.getValue("changeControlActivation")!==undefined){i=d.widget.getBool("changeControlActivation")}var k="bottom-right";if(sessionStorage.getItem("changeControlPosition")){k=sessionStorage.getItem("changeControlPosition")}else{k=g.getSetting("changeControlPosition")}var f=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");f.setPosition(k);d.widget.addPreference({name:"changeControlActivation",defaultValue:i,type:"boolean",label:"changeControlActivation_label",onchange:"onChangeControlUpdate"});d.widget.addPreference({name:"changeControlPosition",defaultValue:k,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]});g.addEvent("onChangeControlActivation",function(m){var l=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");if(!d.debouncePrefSynchro){d._proxy.preferenceModification({name:"changeControlActivation",value:m})}else{d.debouncePrefSynchro=false}if(m===true){l.show()}else{l.hide()}});g.addEvent("onChangeControlPosition",function(m){var l=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");l.setPosition(m);sessionStorage.setItem("changeControlPosition",m)})}},onTenantChange:function(f){require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess"],function(g,h){h.getMyAppsTemplate({preference_name:d.widget.getValue("x3dAppId")+"-"+g.getPlatformId(),onComplete:function(j){var i=null;if(j.length>0){i=JSON.parse(decodeURIComponent(j));if(i.selectedExtensions&&i.selectedTypes){AttributesMgt.updateSelectedParams({selectedExtensions:i.selectedExtensions,selectedTypes:i.selectedTypes});delete i.selectedExtensions;delete i.selectedTypes}}f.updateTreeListView(i)},onFailure:function(i){f.updateTreeListView()}})})},onSaveAsTemplate:function(f){if(f&&f.selectedExtensions&&f.selectedTypes){d.widget.setValue("xscene_custoParams",JSON.stringify({selectedExtensions:f.selectedExtensions,selectedTypes:f.selectedTypes}))}var g=JSON.stringify(f);d.widget.deleteValue("xscene_custo");require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess","DS/PADServices/utils/Storage"],function(i,j,h){h.sess.set("PE/XSceneCusto",f);j.saveMyAppsTemplate({preference_name:widget.getValue("x3dAppId")+"-"+i.getPlatformId(),value:g,onComplete:function(k){},onFailure:function(k){}})})}}}},onSearch:function(d){if(this.xnav_component){this.xnav_component.search.execute(d)}},};a.init(b);return a}function ENXSceneV2(i){var j="xscene_root_pids";var h="xscene_root_pids_detached";var a="xscene_struture";var c="saved_filter_ids";var f="xsceneStoredObjects";function b(k){return typeof k==="string"?JSON.parse(k):null}function g(l,k){if(l&&l.products&&l.products[k]){delete l.products[k]}}var e=function(l){var k=false;if(UWA.is(l,"boolean")){k=l}else{if(UWA.is(l,"string")){k=l.toLowerCase()==="true"}}return k};var d={widget:null,activeBody:"welcome",xnav_component_opts:{x3dAppId:null,widget:null,active_view:null,action_bar_opts:null,layout:{view_customization:null,padshell:true,withWelcomePanel:true},amd_custo:{}},xnav_component:null,init:function(k){this.pcsPrefix=widget.id+"_"+widget.title;window.top.performance.mark(this.pcsPrefix+"_init");window.top.performance.measure(this.pcsPrefix+"_call_init","enxscene_load_html",this.pcsPrefix+"_init");this.widget=k.widget;if(k.odt_settings){this._odt_settings=k.odt_settings}if(k.odt_xnavcomponents_opts){this.xnav_component_opts=k.odt_xnavcomponents_opts}this.widget.addEvent("onLoad",this.onLoad.bind(this));this.widget.addEvent("onRefresh",this.onRefresh.bind(this));this.widget.addEvent("onSearch",this.onSearch.bind(this))},onRefresh:function(){var k=this;require(["DS/PADUtils/PADSettingsMgt"],function(l){if(l.getSetting("refresh_v2")===true&&k.xnav_component!==null){k.xnav_component.refresh()}})},onLoad:function(){var m=this;window.top.performance.mark(this.pcsPrefix+"_onload");window.top.performance.measure(this.pcsPrefix+"_call_onload",this.pcsPrefix+"_init",this.pcsPrefix+"_onload");var l=-1,n=widget.preferences.length;for(var k=0;k<n&&l===-1;k++){if(widget.preferences[k].name==="storedObjectMgt"){l=k}}if(l!==-1){widget.preferences.splice(l,1)}if(this.xnav_component===null){require(["DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSession","DS/PADServices/utils/AttributesMgt","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADWebInWinServices","UWA/Utils/Client","text!DS/ENXScene/assets/xscene_settings.json","i18n!DS/ENXScene/assets/nls/ENXScene.json","DS/PADUtils/Configuration","DS/PADServices/utils/Storage","text!DS/ENXScene/assets/ProductExplorerConf.json"],function(u,B,o,E,v,D,C,s,t,G,z){B.softInit(true);window.top.performance.mark(m.pcsPrefix+"_require_infra_padutils");window.top.performance.measure(m.pcsPrefix+"_require_infra",m.pcsPrefix+"_onload",m.pcsPrefix+"_require_infra_padutils");var w=JSON.parse(z);t.mergeConfig(w);var p=JSON.parse(C);if(m._odt_settings){p.padsettings=UWA.extend(p.padsettings,m._odt_settings,true)}p.action_bar={standard:{file:"ENXSceneV2.xml",module:"ENXScene"},touch:{file:"ENXSceneV2.xml",module:"ENXScene"},webinwin:{file:"ENXSceneV2.xml",module:"ENXScene"}};m._migrate_settings();v.initialize({widget:m.widget});u.setApp(p.padsettings,"enxscene",true);E.addSharedSettings(m.widget,["x3dPlatformId","autoreload","welcomeonempty","maxDashSearch","pad_security_ctx"]);m.widget.mergePreferences(u.getWidgetPreferences());m.widget.addEvent("endEdit",function(){if(typeof m.widget!="undefined"&&u.getSetting("webInWin_context_availability").indexOf(m.widget.getValue("addinmode"))!==-1&&m.widget.getValue("X3DContentId")){m._processContentID({callback:function(){var H=require("DS/PADServices/utils/GlobalModelEvents");H.publish({event:"ENXViews/WelcomePanel/closeLandingPage"});m.widget.dispatchEvent("onContentAdded")}})}else{u.updateWidgetPreferences.call(u)}});m.widget.addEvent("onPlatformIdChange",function(H,I){if(H=="x3dPlatformId"){u.updateTenantSecPreference(I,true)}});m.widget.addEvent("onChangeControlUpdate",m._onChangeControlUpdateHandler.bind(m));u.updateWidgetPreferences();if(!m.widget.getValue("x3dSharedId")&&!m.widget.getValue("x3dAppId")){m.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENXScene_appId"})}var A=m.xnav_component_opts;var q=widget.getValue("forceTouchMode")?widget.getValue("forceTouchMode"):false;var F=q||((D.Features.touchEvents&&!D.Features.pointerEvents))?p.action_bar.touch:p.action_bar.standard;if(v.isWebInWinContext()){F=p.action_bar.webinwin}A.layout.propertiesFacet=u.getSetting("propertiesFacet");F.language=m.widget.lang;A.x3dAppId=m.widget.getValue("x3dAppId");A.widget=m.widget;A.insert_replace=true;A.active_view=m.widget.getValue("default_view");A.authorize_setStructure=true;A.insert_replace=true;A.renderTo=document.body;if(u.getSetting("activateDropInviteWithFilter")===true){A.layout.drop_invite="inviteWithFilter"}else{if(u.getSetting("activate_newDropInvite")===true){A.layout.drop_invite="drop_here"}}if(u.getSetting("columnParametrization")!==true){A.layout.specific_columns=undefined}if(u.getSetting("authorizeChangeControl")===true){A.authorizeChangeControl=true;if(m.widget.getValue("changeControlActivation")!==undefined){u.setSetting("changeControlActivation",m.widget.getBool("changeControlActivation"))}}if(u.getSetting("activateDGV")===true){A.layout.amdTreeView="datagridview";if(A.active_view==="treelistview"){A.active_view="datagridview"}}else{if(A.active_view==="datagridview"){A.active_view="treelistview"}}if(m.xnav_component_opts.layout.noactionbar!==true){A.action_bar_opts=F}if(m._odt_settings&&m._odt_settings.onModifyViewSettings){m._odt_settings.onModifyViewSettings(p.view_settings)}o.updateAttributesList(w.columnsCusto);var y=m.widget.getValue("xscene_custo");var r=m.widget.getValue("xscene_custoParams");if(r){o.updateSelectedParams(JSON.parse(r))}var y=m.widget.getValue("xscene_custo");var x=G.sess.get("PE/XSceneCusto");if(y==="null"){y=null}if(u.getSetting("resetCustomization")===true||(y&&y.charAt(0)!=="{")){localStorage.removeItem("PADTreeListDefinition."+A.x3dAppId);m._initialize_component(A)}else{if(x){A.layout.view_customization=x;m._initialize_component(A)}else{if(y){A.layout.view_customization=JSON.parse(y);m._initialize_component(A)}else{require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess"],function(H,I){H.app_initialization(function(J){if(J&&J.success){I.getMyAppsTemplate({preference_name:A.x3dAppId+"-"+H.getPlatformId(),onComplete:function(L){var K=null;if(L.length>0&&L.charAt(0)==="{"){K=JSON.parse(L);if(K.selectedExtensions&&K.selectedTypes){o.updateSelectedParams({selectedExtensions:K.selectedExtensions,selectedTypes:K.selectedTypes});delete K.selectedExtensions;delete K.selectedTypes}}A.layout.view_customization=K;m._initialize_component(A)},onFailure:function(K){m._initialize_component(A)}})}else{m._initialize_failure()}})})}}}})}},_onChangeControlUpdateHandler:function(l,n){var k=this;var m=require("DS/PADUtils/PADSettingsMgt");var o=m.getSetting("changeControlActivation");if(k.widget.getValue("changeControlActivation")!==undefined){o=k.widget.getBool("changeControlActivation")}var p="bottom-right";if(sessionStorage.getItem("changeControlPosition")){p=sessionStorage.getItem("changeControlPosition")}else{p=m.getSetting("changeControlPosition")}if(n===false){k.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:p,})}else{k.widget.addPreference({name:"changeControlPosition",defaultValue:p,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]})}k.widget.dispatchEvent("onEdit")},onDestroy:function(){this.xnav_component.destroy();this.xnav_component=null;var k=require("DS/PADUtils/PADSharedSettings");k.destroy()},_migrate_settings:function(){var l=this.widget.getValue(j);var u=this.widget.getValue(h);var o=this.widget.getValue(a);var w=b(l);var t=b(u);var p=b(o);var m=false;var v={products:{},filters:{}};if(p){var y=Object.keys(p);for(var n=0;n<y.length;n++){var x=y[n];if(!v.products[x]){v.products[x]={};var r=p[x];m=true}}}if(w){for(var q=0;q<w.length;q++){var s=w[q];if(t){if(t.indexOf(s)!==-1){if(!v.id2detach){v.id2detach=[]}v.id2detach.push(s)}}v.products[s]={};m=true}}if(m){this.widget.setValue(f,JSON.stringify(v))}this.widget.deleteValue(j);this.widget.deleteValue(h);this.widget.deleteValue(a);this.widget.deleteValue(c)},_initialize_component:function(m){var k=this,l=m||{};window.top.performance.mark(k.pcsPrefix+"_require_xnavcomponent_before");require(["DS/PADServices/views/ENXWelcomePanel","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/GlobalUtils","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices"],function(r,o,n,p,q){q.app_initialization(function(){var y=o.getModelEvents();var s=k.widget.getValue("xsceneStoredObjects");if(s==="null"){s=null}if(n.getURLParameter("cleanSetting")==="xsceneStoredObjects"){k.widget.deleteValue("xsceneStoredObjects");s={products:{},filters:{}}}else{if(UWA.is(s,"string")){s=JSON.parse(s)}else{s={products:{},filters:{}}}}var t=e(widget.getValue("autoreload"));var x=k.widget.getValue("X3DContentId");var w=(x!==undefined)&&(x!==null);var v=undefined;var u={modelEvents:y,storedObjects:s,readOnlyApp:p.getConfig("readOnlyApp")};k.welcome=new r(u);k.welcome.initialize().then(function(){if(t===false&&!w){k.widget.setBody(k.welcome.render());k.activeBody="welcome"}});if(t){v=s}require(["DS/ENXNav/XNavComponent"],function(z){window.top.performance.mark(k.pcsPrefix+"_require_xnavcomponent_done");window.top.performance.measure(k.pcsPrefix+"_require_xnavcomponent",k.pcsPrefix+"_require_xnavcomponent_before",k.pcsPrefix+"_require_xnavcomponent_done");var A=UWA.extend(l,k._addEventsCB());if(v){A.objects2Load=v}k.xnav_component=new z(A);var B=k.widget.getValue("X3DContentId");if(UWA.is(B)){k._processContentID({callback:function(){y.publish({event:"ENXViews/WelcomePanel/closeLandingPage"})}})}})})})},_initialize_failure:function(){var k=this;require(["css!DS/ENXNav/ENXNav","DS/ENXNav/views/xNavInitError","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(n,p,o){var m=UWA.createElement("div",{"class":"xnav_component"});var l=new p({msg:o.initialization_error});m.setContent(l);k.widget.setBody(m);k.activeBody="failure";k.widget.dispatchEvent("onXSceneReady")})},_processContentID:function(m){var l=this;var n=l.widget.getValue("X3DContentId");var k=UWA.is(n,"string")?JSON.parse(n):n;require(["DS/PADUtils/PADTypesMgt","DS/ENXNav/utils/xNavKindProcessor"],function(p,o){p.retrieveAuthorizedObjects({version:"2.0",X3DContentId:k,callback:function(q){o.loadKinds(l.xnav_component,q,"fromDrop",false,m&&m.callback?m.callback:undefined);l.widget.deleteValue("X3DContentId")}})})},_addEventsCB:function(){var k=this;return{events:{onReady:function(q){window.top.performance.mark(k.pcsPrefix+"_xnavcomponent_onready");window.top.performance.measure(k.pcsPrefix+"_xnavcomponent_ready",k.pcsPrefix+"_require_xnavcomponent_done",k.pcsPrefix+"_xnavcomponent_onready");var p=k.widget.getValue("X3DContentId");var m=require("DS/PADServices/utils/GlobalModelEvents");if(UWA.is(p)){k._processContentID({callback:function(){m.publish({event:"ENXViews/WelcomePanel/closeLandingPage"})}})}k.widget.addEvent("onViewChange",k.xnav_component.onResize.bind(k.xnav_component));k.widget.addEvent("onResize",k.xnav_component.onResize.bind(k.xnav_component));var n=require("DS/PADUtils/PADSettingsMgt");var m=require("DS/PADServices/utils/GlobalModelEvents");var r=m.getModelEvents();r.subscribe({event:"ENXViews/Views/showInWidgetBody"},function(s){if(s.html){if(s.title){widget.setTitle(s.title)}widget.setBody(s.html)}else{if(s.restore===true){widget.setTitle(k.xnav_component.getWidgetTitle());if(k.activeBody==="welcome"){k.widget.setBody(k.welcome.render())}else{if(k.activeBody="app"){k.widget.setBody(k.xnav_component.render())}}}}});var l=require("DS/PADUtils/PADSharedSettings");l.resetDebounceFlags();k.xnav_component.addEvent("onToggleView",function(s){k.widget.setValue("default_view",s)});if(q&&q.addInView){k.widget.setBody(k.xnav_component.render());k.activeBody="app"}if(q&&q.error===true){k._initialize_failure()}var m=require("DS/PADServices/utils/GlobalModelEvents");var r=m.getModelEvents();var o=require("DS/PADUtils/PADWebInWinServices");var n=require("DS/PADUtils/PADSettingsMgt");if(!o.isWebInWinContext()&&n.getSetting("activateTreeOptionsInWidgetBody")===true){var r=m.getModelEvents();r.subscribe({event:"ENXViews/Views/showInWidgetBody"},function(s){if(s.html){widget.setBody(s.html)}else{if(s.restore===true){k.widget.setBody(k.xnav_component.render())}}})}r.subscribe({event:"ENXViews/WelcomePanel/openContent"},function(s){k.widget.setBody(k.xnav_component.render());k.activeBody="app";k.xnav_component.afterSetBody();switch(s.mode){case"welcome":k.xnav_component.openStoredObjects(s);break;case"drop":k.xnav_component.openDroppedObjects(s).then(function(t){if(t&&t.error){if(n.getSetting("welcomeonempty")){k.widget.setBody(k.welcome.render());k.activeBody="welcome"}}});break;default:console.error("Unknown mode")}});r.subscribe({event:"ENXViews/WelcomePanel/removeFromStored"},function(x){if(x.item2remove){var D=x.item2remove,C=[];var B=k.widget.getValue("xsceneStoredObjects");if(B==="null"){B=null}if(UWA.is(B,"string")){B=JSON.parse(B);var y,w,t=D.length;var v=false;for(y=0;y<t;y++){if(B.products&&B.products.hasOwnProperty(D[y])){var u=k.xnav_component.options.model.searchRootById(D[y]);if(u){C.push(D[y])}delete B.products[D[y]];v=true}if(B.filters){var s=Object.getOwnPropertyNames(B.filters);for(w=s.length-1;w>=0;w--){var A;if(B.filters[s[w]].associatedProduct===D[y]){A=D[y]}else{if(s[w]===D[y]){A=B.filters[s[w]].associatedProduct}}if(A){var u=k.xnav_component.options.model.searchRootById(A);if(u){k.xnav_component.options.model.removeRoot(u);C.push(s[w])}delete B.filters[s[w]];v=true}}}}if(v){widget.setValue("xsceneStoredObjects",JSON.stringify(B))}if(C.length){var E=require("DS/PADServices/utils/GlobalModelEvents");var z=E.getModelEvents();z.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"deleteRoots",removeIds:C}});z.publish({event:"ENXViews/WelcomePanel/removeFromView",data:{item2remove:C}})}}}});r.subscribe({event:"ENXViews/WelcomePanel/activate"},function(s){r.publish({event:"ENXViews/WelcomePanel/refreshView"});if(s==="fromHome"){k.welcome.fromHome=true}k.widget.setBody(k.welcome.render());k.activeBody="welcome"});r.subscribe({event:"ENXViews/WelcomePanel/closeLandingPage"},function(){k.widget.setBody(k.xnav_component.render());k.activeBody="app"});r.subscribe({event:"ENXViews/WelcomePanel/unselectAllInModel"},function(){k.xnav_component.getPADTreeDocument().unselectAll()});r.subscribe({event:"ENXViews/WelcomePanel/removeFromView"},function(t){var v=t.item2remove,u=v?v.length:0,s=k.xnav_component.getPADTreeDocument();s.withTransactionUpdate(function(){for(var w=0;w<u;w++){var x=s.searchRootById(v[w]);if(x){s.removeRoot(x)}}})});r.publish({event:"ENXViews/WelcomePanel/appReady"});window.top.performance.mark(k.pcsPrefix+"_app_load_complete");window.top.performance.measure(k.pcsPrefix+"_app_load_completed","enxscene_load_html",k.pcsPrefix+"_app_load_complete");k.widget.dispatchEvent("onXSceneReady")},onAddPaths:function(m){var r=widget.getValue("xsceneStoredObjects");if(r==="null"){r=null}if(!UWA.is(r)){r={products:{},filters:{}}}else{r=JSON.parse(r)}var o;var l=m.addedPaths.length;for(o=0;o<l;o++){var s=r.products;var n=0;var q=m.addedPaths[o].length;for(n=0;n<q;n++){if(!s.hasOwnProperty(m.addedPaths[o][n])){s[m.addedPaths[o][n]]={}}s=s[m.addedPaths[o][n]]}}widget.setValue("xsceneStoredObjects",JSON.stringify(r));var t=require("DS/PADServices/utils/GlobalModelEvents");var p=t.getModelEvents();p.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"products",addedPaths:m.addedPaths}})},onAddFilters:function(p){var n=widget.getValue("xsceneStoredObjects");if(n==="null"){n=null}if(!UWA.is(n)){n={products:{},filters:{}}}else{n=JSON.parse(n)}var o={filters:{}};for(var l=0;l<p.filterIds.length;l++){n.filters[p.filterIds[l]]={associatedProduct:p.rootIds[l],filterName:p.filterNames[l]};o.filters[p.filterIds[l]]={associatedProduct:p.rootIds[l],filterName:p.filterNames[l]}}widget.setValue("xsceneStoredObjects",JSON.stringify(n));var m=require("DS/PADServices/utils/GlobalModelEvents");var q=m.getModelEvents();q.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"filters",addedFilters:o}});q.publish({event:"ENXViews/WelcomePanel/closeLandingPage"})},onDeleteRoots:function(q){var u=JSON.parse(q);var t=[];var s=widget.getValue("xsceneStoredObjects");if(s==="null"){s=null}if(UWA.is(s,"string")){s=JSON.parse(s);var o,n,l=u.length;for(o=0;o<l;o++){if(s.products&&s.products.hasOwnProperty(u[o])){t.push(u[o])}if(s.filters){var m=Object.getOwnPropertyNames(s.filters);for(n=m.length-1;n>=0;n--){var r;if(s.filters[m[n]].associatedProduct===u[o]){r=u[o]}else{if(m[n]===u[o]){r=s.filters[m[n]].associatedProduct}}if(r){t.push(m[n])}}}}var v=require("DS/PADServices/utils/GlobalModelEvents");var p=v.getModelEvents();p.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"removeFromView",removedFromViewIds:t}})}},onRootsVisibility:function(){var l=[],m=k.xnav_component.options.model;if(m.hasOwnProperty("detachedRoots")){m.detachedRoots.forEach(function(n){l.push(n.getID())})}k.widget.setValue("xsceneDetachedRoots",JSON.stringify(l))},onEmptyView:function(){var l=require("DS/PADUtils/PADSettingsMgt");if(l.getSetting("welcomeonempty")){k.widget.setBody(k.welcome.render());k.activeBody="welcome"}},onCustoViewChange:function(l,m){k.widget.setValue("xscene_custo",JSON.stringify(l));if(m){k.widget.setValue("xscene_custoParams",JSON.stringify(m))}},onAuthoringCtxAvailable:function(p){if(p.isLicenseValid===true){var m=require("DS/PADUtils/PADSettingsMgt");var n=require("DS/PADUtils/PADCommandProxy");k.debouncePrefSynchro=false;k._proxy=n.create({events:{onPreferenceModification:function(r){if(r.name==="changeControlActivation"){k.debouncePrefSynchro=true;k.widget.setValue(r.name,r.value);m.setSetting(r.name,r.value)}}}});var o=m.getSetting("changeControlActivation");if(k.widget.getValue("changeControlActivation")!==undefined){o=k.widget.getBool("changeControlActivation")}var q="bottom-right";if(sessionStorage.getItem("changeControlPosition")){q=sessionStorage.getItem("changeControlPosition")}else{q=m.getSetting("changeControlPosition")}var l=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");l.setPosition(q);k.widget.addPreference({name:"changeControlActivation",defaultValue:o,type:"boolean",label:"changeControlActivation_label",onchange:"onChangeControlUpdate"});k.widget.addPreference({name:"changeControlPosition",defaultValue:q,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]});m.addEvent("onChangeControlActivation",function(s){var r=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");if(!k.debouncePrefSynchro){k._proxy.preferenceModification({name:"changeControlActivation",value:s})}else{k.debouncePrefSynchro=false}if(s===true){r.show()}else{r.hide()}});m.addEvent("onChangeControlPosition",function(s){var r=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");r.setPosition(s);sessionStorage.setItem("changeControlPosition",s)})}},onTenantChange:function(l){require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess"],function(m,n){n.getMyAppsTemplate({preference_name:k.widget.getValue("x3dAppId")+"-"+m.getPlatformId(),onComplete:function(p){var o=null;if(p.length>0){o=JSON.parse(decodeURIComponent(p));if(o.selectedExtensions&&o.selectedTypes){AttributesMgt.updateSelectedParams({selectedExtensions:o.selectedExtensions,selectedTypes:o.selectedTypes});delete o.selectedExtensions;delete o.selectedTypes}}l.updateTreeListView(o)},onFailure:function(o){l.updateTreeListView()}})})},onSaveAsTemplate:function(l){if(l&&l.selectedExtensions&&l.selectedTypes){k.widget.setValue("xscene_custoParams",JSON.stringify({selectedExtensions:l.selectedExtensions,selectedTypes:l.selectedTypes}))}var m=JSON.stringify(l);k.widget.deleteValue("xscene_custo");require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess","DS/PADServices/utils/Storage"],function(o,p,n){n.sess.set("PE/XSceneCusto",l);p.saveMyAppsTemplate({preference_name:widget.getValue("x3dAppId")+"-"+o.getPlatformId(),value:m,onComplete:function(q){},onFailure:function(q){}})})}}}},onSearch:function(k){if(this.xnav_component){this.xnav_component.search.execute(k)}}};d.init(i);return d};
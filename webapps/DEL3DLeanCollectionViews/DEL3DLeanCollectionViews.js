define("DS/DEL3DLeanCollectionViews/SideCollectionViews/AScrollCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanViews/Behaviors/HammerBehavior","DS/DEL3DLeanViews/Utils/UIUtils","DS/DEL3DLeanViews/EmptyViews/LoadingEmptyView"],function(e,d,g,c,b,a){var f=g.CollectionView.extend({name:"AScrollCollectionView",topRatio:0,dY:0,behaviors:[{behaviorClass:c,usePanEvent:true,eventDirection:8|16,threshold:50}],collectionViewsEnum:null,emptyView:a,buildChildView:function(l,k,j){var i=d.extend({model:l,parent:this},j);var h=new k(i);return h},initialize:function(){this.onWheelDelegate=e.proxy(this.onWheel,this);this.parent=this.getOption("parent")},onAttach:function(){this.$el[0].onwheel=this.onWheelDelegate},onDetach:function(){this.$el[0].onwheel=null},onWheel:function(h){var i={deltaY:-(Math.abs(h.deltaY)<10?h.deltaY*10:h.deltaY)};if(this.panEventCallback(i)){this.children.each(function(j){if(!j._isEmpty){j.updateDataTop()}})}},onBeforeDetach:function(){this.triggerMethod("view:enablePan",false)},panStartEventCallback:function(){this.children.each(function(h){h.triggerMethod("view:enablePan",false)})},panEventCallback:function(k){var j=Number(((k.deltaY*100)/this.$el.height()).toFixed(2));var h=0;var l=true;var i=this;this.children.each(function(m){if(!m._isEmpty){var n=m.actualDataTop+j;if(h===0){if(n>0||n<0&&n<=-i.maxTop){if(n>0){i.onAttach()}l=false}}h++;if(l===true){m.updateTop(n)}}});return l},panEndEventCallback:function(n){var k=this;var h=0;var j=Number(((n.deltaY*100)/this.$el.height()).toFixed(2));var m=0;var i=0;var l=Math.abs(n.velocityY)<=0.1;k.children.each(function(o){if(!o._isEmpty){o.updateDataTop(true);if(l){o.triggerMethod("view:enablePan",true)}else{m=o.actualDataTop+j;if(h===0){if(m>0){i=-m}else{if(m<-k.maxTop){i=-k.maxTop-m}}}b.addClass(o.$el,"animateScroll");o.updateTop(m+i,true);h++}}});if(!l){setTimeout(function(){k.children.each(function(o){b.removeClass(o.$el,"animateScroll");o.updateDataTop();o.triggerMethod("view:enablePan",true)})},300)}}});return f});define("DS/DEL3DLeanCollectionViews/ThumbnailCollectionViews/ThumbnailCollectionView",["pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanCollections/Collection.manager","DS/DEL3DLeanViews/Behaviors/ScrollableCollectionViewBehavior"],function(a,e,d,c){var b=e.CollectionView.extend({behaviors:[c],buildChildView:function(k,j,i){if(j.prototype.emptyView){return new j(i)}var h=d.findModel(k.get("to"));var g=a.extend({model:h,relationModel:k,parent:this},i);var f=new j(g);return f},onAddChild:function(){this._behaviors[0].updateSize()}});return b});define("DS/DEL3DLeanCollectionViews/ElementCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanViews/assets/enums/ViewsEnum","DS/DEL3DLeanCollections/Collection.manager","DS/DEL3DLeanModels/Model.manager"],function(e,b,g,d,f,a){var c=g.CollectionView.extend({collectionViewsEnum:null,filter:function(h){return h.name==="CoordModel"},childView:function(l){var h=null;var j=f.findModel(l.get("to"));var i=j.get("type");var m=d.getFromServerType(i);h=m.viewConstructor;if(d.STICKYNOTE.viewConstructor===h){var k=j.get("V_DEL3DL_Category");switch(k){case"ISSUE":h=d.ISSUENOTE.viewConstructor;break;case"ACTION":h=d.TASKNOTE.viewConstructor;break;default:h=d.NOTE.viewConstructor;break}}return h},buildChildView:function(o,m,l){if(m.prototype.emptyView){return new m(l)}var k=f.findModel(o.get("to"));var j=b.extend({model:k,relationModel:o,collectionViewsEnum:this.collectionViewsEnum,parent:this},l);var i=k.get("type");var n=d.getFromServerType(i);if(n.leangetConstructor){j=b.extend({leangetConstructor:n.leangetConstructor},j)}var h=new m(j);return h},_getRemovedViews:function(h){h=h.map(function(i){return a.isRelation?f.findModel(i.get("to")):i});return g.CollectionView.prototype._getRemovedViews.call(this,h)},initialize:function(){this.parent=this.getOption("parent");this.collectionViewsEnum=this.getOption("collectionViewsEnum")}});return c});define("DS/DEL3DLeanCollectionViews/MeetingLeangetCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanViews/Meeting/MeetingLeangetView","DS/DEL3DLeanViews/Utils/UIUtils","css!DS/DEL3DLeanCollectionViews/assets/css/MeetingLeangetCollectionView.css"],function(e,c,f,d,a){var b=f.CollectionView.extend({name:"MeetingLeangetCollectionView",className:"meetingLeangetCollectionView",childView:d,childViewEvents:{"SelectedLeangetView:LeangetDropped":"onLeangetDropped"},buildChildView:function(k,j,i){var h=c.extend({model:k,parent:this},i);var g=new j(h);return g},constructor:function b(){f.CollectionView.prototype.constructor.apply(this,arguments)},initialize:function(){this.parent=this.getOption("parent");this.collection.comparator="order"},initMeetingCollection:function(){this.focusLeangetIndex=0;var g=this.children.first();var h=this.children.first().infraView;a.addClass(g.$el,"focus");a.removeClass(g.$el,"meetingLeangetHidden");h.firstFocus()},selectMeetingLeanget:function(g){var h=g;if(h<this.focusLeangetIndex){for(;h!==this.focusLeangetIndex;++h){a.removeClass(this.children.findByIndex(h).$el,"next");a.addClass(this.children.findByIndex(h).$el,"previous")}}else{if(h>this.focusLeangetIndex){for(;h!==this.focusLeangetIndex;--h){a.addClass(this.children.findByIndex(h).$el,"next");a.removeClass(this.children.findByIndex(h).$el,"previous")}}}this.children.findByIndex(this.focusLeangetIndex).unfocus(g<this.focusLeangetIndex);this.focusLeangetIndex=g;this.children.findByIndex(this.focusLeangetIndex).focus()}});return b});define("DS/DEL3DLeanCollectionViews/SearchPersonCollectionView",["UWA/Core","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanViews/Team/SearchPersonCollectionItemView"],function(d,c,b){var a=c.CollectionView.extend({childView:b,constructor:function a(){c.CollectionView.prototype.constructor.apply(this,arguments)},initialize:function(){},bindEvents:function(){},unbindEvents:function(){}});return a});define("DS/DEL3DLeanCollectionViews/PersonCollectionView",["UWA/Core","pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanViews/Team/PersonView","DS/DEL3DLeanViews/Components/ButtonView","DS/DEL3DLeanViews/Utils/UIUtils","DS/DEL3DLeanViews/Team/SearchPersonPanelView"],function(g,h,j,c,i,d,f){var k=j.CollectionView.extend({childView:c,constructor:function k(){this.displayOwnTeam=arguments[0].displayOwnTeam;this.onAddMemberDelegate=h.proxy(this.onAddMember,this);j.CollectionView.prototype.constructor.apply(this,arguments)},initialize:function(){this.collection.on("after:loadPrivileges",this.test.bind(this))},test:function(){this.render()},filter:function(n){if(n.get("name")===g.getGlobal().leanSessionManager._3DLeanSession.get("owner")){return false}var m;if(this.displayOwnTeam){m=n.isInTeam()}else{m=n.isCollaborator()}return m},attachHtml:function(m,o,n){if(o.model.name==="PersonModel"){n+=1}else{n=0}j.CollectionView.prototype.attachHtml.apply(this,[m,o,n])},onAddChild:function e(m,n){n.disableToggle=!this.displayOwnTeam;n.bindEvents()},onAddMember:function b(){f.openPanel(this.displayOwnTeam)},editMode:function a(m){this.children.each(function(n){if(g.is(n.editMode)){n.editMode(m)}});if(m){d.addClass(this.$el,"editMember")}else{d.removeClass(this.$el,"editMember")}},onRender:function l(){this.addTeamMemberButton=new i({actionName:"addTeamMemberButton",icon:"CreatePage.svg",callback:this.onAddMemberDelegate});this.addChildView(this.addTeamMemberButton,0)},bindEvents:function(){this.children.each(function(m){if(g.is(m.bindEvents)){m.bindEvents()}})},unbindEvents:function(){this.children.each(function(m){if(g.is(m.unbindEvents)){m.unbindEvents()}})}});return k});define("DS/DEL3DLeanCollectionViews/SideCollectionViews/SelectedLeangetCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanViews/Panels/CollectionElements/SelectedLeangetView","css!DS/DEL3DLeanCollectionViews/assets/css/SelectedLeangetCollectionView.css"],function(c,b,f,e){var a=f.CollectionView.extend({name:"SelectedLeangetCollectionView",className:"selectedLeangetCollectionView",collectionViewsEnum:null,childView:e,childViewEvents:{"SelectedLeangetView:LeangetDropped":"onLeangetDropped"},buildChildView:function(k,j,i){var h=b.extend({model:k,parent:this},i);var g=new j(h);return g},constructor:function a(){f.CollectionView.prototype.constructor.apply(this,arguments)},initialize:function(){this.parent=this.getOption("parent");this.collection.comparator="order"},reorderBeforeRemove:function d(g){this.children.each(function(i){if(i.model.get("order")>g.get("order")){var h=i.model.get("order")-1;i.model.set("order",h);i.$el.attr("data-order",h);i.render()}})},onLeangetDropped:function(g){var h=b.filter(this.children._views,function(i){return i.model.get("order")===g.relatedTargetOrder});this.children.each(function(j){var i;if(j.model.get("order")>g.relatedTargetOrder&&j.model.get("order")<=g.targetOrder){i=j.model.get("order")-1;j.model.set("order",i);j.$el.attr("data-order",i)}else{if(j.model.get("order")<=g.relatedTargetOrder&&j.model.get("order")>=g.targetOrder){i=j.model.get("order")+1;j.model.set("order",i);j.$el.attr("data-order",i)}}});h[0].model.set("order",g.targetOrder);h[0].$el.attr("data-order",g.targetOrder);this.collection.sort()},onGuidedMeetingStart:function(){this.children.each(function(g){g.onMeetingGuided()});this.activeChild=0;this.children.findByIndex(this.activeChild).focused()},onGuidedMeetingLeangetFocused:function(g){this.onGuidedMeetingLeangetVisited(this.activeChild);this.activeChild=g;this.children.findByIndex(this.activeChild).focused()},onGuidedMeetingLeangetVisited:function(g){this.children.findByIndex(g).visited()}});return a});define("DS/DEL3DLeanCollectionViews/SideCollectionViews/FavoritesCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/SideCollectionViews/AScrollCollectionView","DS/DEL3DLeanViews/Panels/CollectionElements/FavoritesView","css!DS/DEL3DLeanCollectionViews/assets/css/FavoritesCollectionView.css"],function(e,a,c,d){var f=c.extend({name:"FavoritesCollectionView",className:"favoritesCollectionView",topRatio:10,dY:0,childView:d,initialize:function(g){f.__super__.initialize.call(this,g)},onAddChild:function b(){this.onAttach()},onAttach:function(){f.__super__.onAttach.call(this);if(!this.isEmpty()){var g=0;var h=this;this.children.each(function(k){var l=g*h.topRatio;k.updateTop(l);k.updateDataTop();g++});this.maxTop=(h.topRatio*(h.children.length-1));var j=this;setTimeout(function(){j.triggerMethod("view:enablePan",true)},0)}else{var i=this.children.first();if(i){i.showEmpty()}}}});return f});define("DS/DEL3DLeanCollectionViews/ThumbnailCollectionViews/ContentsThumbnailCollectionView",["DS/DEL3DLeanCollectionViews/ThumbnailCollectionViews/ThumbnailCollectionView"],function(a){var b=a.extend({});return b});define("DS/DEL3DLeanCollectionViews/SideCollectionViews/StoreCollectionView",["UWA/Core","pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/SideCollectionViews/AScrollCollectionView","DS/DEL3DLeanViews/Panels/CollectionElements/LeangetStoreView","DS/DEL3DLeanEnums/Model.enum","css!DS/DEL3DLeanCollectionViews/assets/css/StoreCollectionView.css"],function(g,c,a,b,d,f){var e=b.extend({name:"StoreCollectionView",className:"storeCollectionView",topRatio:28,dY:0,childView:d,filter:function(h){return true},initialize:function(h){e.__super__.initialize.call(this,h)},viewComparator:function(j,i){var h=0;var l=j.get("type");var k=i.get("type");if(l==="DEL3DL_Sketch"){h=-1}else{if(k==="DEL3DL_Sketch"){h=1}else{if(l==="DEL3DL_5S_FollowUp"){h=1}else{if(k==="DEL3DL_5S_FollowUp"){h=-1}else{if(l<k){h=-1}else{h=1}}}}}return h},onAttach:function(){e.__super__.onAttach.call(this);if(!this.isEmpty()){var k=0;var h=this;this.children.each(function(i){var m=k*h.topRatio;i.updateTop(m);i.updateDataTop();k++});this.maxTop=(h.topRatio*(h.children.length-1));var l=this;setTimeout(function(){l.triggerMethod("view:enablePan",true)},0)}else{var j=this.children.first();if(j){j.showEmpty()}}}});return e});define("DS/DEL3DLeanCollectionViews/ThumbnailCollectionViews/ActionThumbnailCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","DS/DEL3DLeanCollectionViews/ThumbnailCollectionViews/ThumbnailCollectionView","DS/DEL3DLeanViews/Thumbnails/ActionThumbnailView","pluginDS!DS/VENBackboneRadio/backbone.radio.2.0.0/backbone.radio","css!DS/DEL3DLeanCollectionViews/assets/css/ThumbnailCollectionViews/ActionThumbnailCollectionView.css"],function(d,b,c,e){var a=b.extend({childView:c,name:"ActionThumbnailCollectionView",className:"actionThumbnailCollectionView",thumbnailActionCollectionRadio:e.channel("thumbnailActionCollection"),childViewTriggers:{"editAction:select":"editAction:select"},initialize:function(){this.onActionDestroyDelegate=d.proxy(this.onActionDestroyCallback,this);this.thumbnailActionCollectionRadio.on("issueActions:collectionview:destroy",this.onActionDestroyDelegate)},onActionDestroyCallback:function(f){this.collection.remove(f);f.destroy();this.render()}});return a});define("DS/DEL3DLeanCollectionViews/FloatableCollectionView",["UWA/Core","pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/DEL3DLeanCollectionViews/ElementCollectionView","text!DS/DEL3DLeanCollectionViews/assets/templates/FloatableCollectionView.template.html","pluginDS!DS/VENBackboneRadio/backbone.radio.2.0.0/backbone.radio","DS/DEL3DLeanModels/relations/Coord.model","DS/DEL3DLeanViews/Behaviors/InteractBehavior","DS/DEL3DLeanCollections/Collection.manager","DS/DEL3DLeanSession/Session.manager","DS/DEL3DLeanViews/Utils/UIUtils","DS/DEL3DLeanEnums/Model.enum","DS/DEL3DLeanEnums/Collection.enum","DS/DEL3DLeanHttpRequest/HttpRequest","DS/DEL3DLeanViews/Utils/TaskUtils","DS/DEL3DLeanViews/Utils/IssueUtils","css!DS/DEL3DLeanCollectionViews/assets/css/FloatableCollectionView.css"],function(g,f,t,j,h,p,o,k,i,u,n,s,m,q,c,d,l){var r=h.extend({name:"FloatableCollectionView",className:"floatableCollectionView",staticRadioChannel:o.channel("static"),sideBarRadioChannel:o.channel("sidebar"),floatableRadioChannel:o.channel("floatable"),isFocus:false,fromViewModel:null,childViewEvents:{"FloatableElement:selected":"onFloatableSelected","FloatableElement:updateRelation":"updateRelation","FloatableElement:delete":"deleteFloatable","FloatableElement:deleteId":"deleteFloatableId","FloatableElement:forcePressEvent":"forceChildPressEvent","FloatableElement:putViewOnTop":"putChildViewOnTop","FloatableElement:editStickyView":"onEditStickyView"},childViewTriggers:{captureContext:"captureContext"},template:t.template(p),behaviors:[{behaviorClass:i,isDroppable:true,isActiveOnRender:false,enableDropAcceptClass:".sidePersonView, .sideStickerView",className:".floatableDropZone"}],initialize:function(v){this.$el.attr("id",this.cid);this.$el.append('<div class="floatableDropZone" style="width:100%; height:100%;"></div>');this.fromViewModel=v.staticViewModel;h.prototype.initialize.apply(this,[v]);this.selectAllDelegate=f.proxy(this.selectAll,this);this.deselectAllDelegate=f.proxy(this.deselectAll,this);this.deleteFloatableSelectedDelegate=f.proxy(this.deleteFloatableSelected,this);this.createViewDelegate=f.proxy(this.createFloatableView,this);this.afterMinimizeDelegate=f.proxy(this.afterMinimize,this);this.afterMaximizeDelegate=f.proxy(this.afterMaximize,this);this.staticRadioChannel.on("after:maximize",this.afterMaximizeDelegate);this.staticRadioChannel.on("after:minimize",this.afterMinimizeDelegate)},bindEvents:function(){this.sideBarRadioChannel.on("sideBarView:selectAll",this.selectAllDelegate);this.sideBarRadioChannel.on("sideBarView:deselectAll",this.deselectAllDelegate);this.sideBarRadioChannel.on("sideBarView:delete",this.deleteFloatableSelectedDelegate);this.floatableRadioChannel.on("floatableCollection:newStickyNoteModel",this.createViewDelegate)},unbindEvents:function(){this.sideBarRadioChannel.off("sideBarView:selectAll",this.selectAllDelegate);this.sideBarRadioChannel.off("sideBarView:deselectAll",this.deselectAllDelegate);this.sideBarRadioChannel.off("sideBarView:delete",this.deleteFloatableSelectedDelegate);this.floatableRadioChannel.off("floatableCollection:newStickyNoteModel",this.createViewDelegate)},focus:function(v){this.triggerMethod("view:activeInteract",v,v,v);if(v===true){this.bindEvents()}else{this.unbindEvents();this.deselectAll()}this.enableFloatableViews(this.children,v);this.isFocus=v},enableFloatableViews:function(v,w){v.each(function(x){x.enableView(w)})},layoutEditable:function(v){if(v){s.addClass(this.$el,"layoutEditable")}else{s.removeClass(this.$el,"layoutEditable")}},settingsEditable:function(v){if(v){s.addClass(this.$el,"settingsEditable")}else{s.removeClass(this.$el,"settingsEditable")}},putChildViewOnTop:function(v){this.children.each(f.proxy(function(w){s.removeClass(w.$el,"onTop")},this));s.addClass(v.$el,"onTop")},onEditStickyView:function(v){this.focus(!v)},onFloatableSelected:function(){var v=0;this.children.each(function(w){if(w.isSelected()===true){++v}});if(v===0){this.cancelChildPressEvent()}this.sideBarRadioChannel.trigger("floatableView:floatableElementSelected",v)},forceChildPressEvent:function(){this.children.each(function(v){v.forcePressEvent=true});clearTimeout(this.timeOufFct);this.timeOufFct=setTimeout(f.proxy(this.deselectAll,this),5000)},cancelChildPressEvent:function(){this.children.each(function(v){v.forcePressEvent=false});clearTimeout(this.timeOufFct)},selectAll:function(){this.forceChildPressEvent();this.children.each(function(v){v.selectFloatable()});this.onFloatableSelected()},deselectAll:function(){this.cancelChildPressEvent();this.children.each(function(v){v.unSelectFloatable()});this.onFloatableSelected()},updateRelation:function(w,x){var v=w.relationModel;if(!g.is(v)){return}v.save(x)},searchFreeSpaceForSN:function(){var w=f(".sideView.left.sidePanelOpened").length>0?0:94;var v=30;for(;this.$el.find('.stickyNoteView[data-x="'+w+'"][data-y="'+v+'"]').length>0;v+=5){if(v>80){break}}return{coordY:v,coordX:w}},createFloatableView:function(w){var x=this.searchFreeSpaceForSN();var v=this.createFloatableRelation(w,{V_DEL3DL_Y:x.coordY,V_DEL3DL_X:x.coordX});return v},createFloatableRelation:function(z,x){var v=z.get("type");var y=new k();var w={};x=x||{};w.from=this.fromViewModel.id;w.to=z.id;w.V_DEL3DL_X=0;w.V_DEL3DL_Y=0;w.V_DEL3DL_Size_X=v==="DEL3DL_Sticky_Note"?1.25:0.75;w.V_DEL3DL_Size_Y=v==="DEL3DL_Sticky_Note"?1.25:0.75;t.extend(w,x);y.save(w);q.RELATIONS.sessionInstance.add(y);return y},onAddChild:function b(v,w){w.enableView(this.isFocus)},deleteFloatableId:function(v){var w=this.children.findByCid(v);this.deleteFloatable(w)},deleteFloatable:function(w){var x=w.model;var v=w.relationModel;if(!g.is(w)){return}w.enableView(false);setTimeout(f.proxy(function(){if(x.isAction()&&this.fromViewModel.name==="ActionLogModel"){d.deleteTask(x)}else{if(x.isIssue()&&this.fromViewModel.name==="IssueLogModel"){l.deleteIssue(x)}}s.endTransitionEvent(w.$el,f.proxy(function(){v.destroy();if(x.isAction()||x.isIssue()){if(x.isAction()&&this.fromViewModel.name==="ActionLogModel"){d.removeRemainingActionRelationAndModel(x)}else{if(x.isIssue()&&this.fromViewModel.name==="IssueLogModel"){l.removeRemainingIssueRelationAndModel(x)}}}else{q.FLOATABLES.sessionInstance.remove(x)}this.onFloatableSelected()},this));s.addClass(w.$el,"deleted")},this),0)},deleteFloatableSelected:function(){this.cancelChildPressEvent();this.children.each(f.proxy(function(v){if(v.isSelected()===true){this.deleteFloatable(v)}},this))},afterDeleteFloatable:function(){},onDragEnterCallback:function(){},onDragLeaveCallback:function(){},onDropCallback:function(A){this.trigger("before:floatable:drop",A);var z=this;var x=((100*(A.dragEvent.clientX-this.$el.offset().left))/this.$el.width()).toFixed(2);var w=((100*(A.dragEvent.clientY-this.$el.offset().top))/this.$el.height()).toFixed(2);x-=2.5;w-=2.5;var C=A.relatedTarget.getAttribute("data-name");var v=null;var y={};if(g.is(C)){v=m.STICKYMEMBER;y={V_DEL3DL_People_Name:C}}else{var B=A.relatedTarget.getAttribute("data-documentId");v=m.STICKER;y={V_DEL3DL_Document_PID:B}}u.createModel(null,v,y,{success:function(D){var E=z.createFloatableRelation(D,{V_DEL3DL_X:x,V_DEL3DL_Y:w});z.trigger("after:floatable:drop",A,D,E)},error:function(){}})},afterMinimize:function e(v){if(g.is(v.focusView)&&g.is(v.unfocusView)){if((v.unfocusView===this.parent&&v.unfocusView.className!=="pageView")||(v.unfocusView===this.parent&&v.unfocusView.className==="pageView"&&!t.contains(v.unfocusView.staticCollectionView.children._views,v.focusView))||(v.focusView.className==="mapView"&&this.parent.className==="pageView"&&t.contains(this.parent.staticCollectionView.children._views,v.unfocusView))){s.removeClass(this.parent.$el,"minMaxTransition");this.children.each(function(w){var x=f(".stickyNoteDescription",w.$el);if(g.is(w.autoResizeText)&&x.text().length>0){w.autoResizeText()}})}}},afterMaximize:function a(v){if(g.is(v.focusView)&&g.is(v.unfocusView)){if((v.focusView===this.parent&&v.focusView.className!=="pageView")||(v.focusView===this.parent&&v.focusView.className==="pageView"&&!t.contains(v.focusView.staticCollectionView.children._views,v.unfocusView))||(v.focusView.className!=="mapView"&&v.focusView===this.parent._getParentStaticView()&&!t.contains(v.focusView.staticCollectionView.children._views,v.unfocusView))){this.children.each(function(w){var x=f(".stickyNoteDescription",w.$el);if(g.is(w.autoResizeText)&&x.text().length>0){x.css("visibility","hidden");setTimeout(function(){w.autoResizeText();x.css("visibility","visible")},0)}})}}}});return r});define("DS/DEL3DLeanCollectionViews/SideCollectionViews/SideStickerCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/SideCollectionViews/AScrollCollectionView","DS/DEL3DLeanViews/ToolsSubpanels/CollectionElements/SideStickerView","css!DS/DEL3DLeanCollectionViews/assets/css/SideStickerCollectionView.css"],function(d,a,b,c){var e=b.extend({childView:c,name:"SideStickerCollectionView",className:"sideStickerCollectionView",topRatio:12,leftRatio:30,leftCurrent:8,initialize:function(f){e.__super__.initialize.call(this,f);this._isReallyEmpty=false},filter:function(f){return(f.attributes.businessobj.isImage===true)},buildChildView:function(j,i,h){var g=a.extend({model:j,parent:this,actualLeft:this.leftCurrent},h);var f=new i(g);if(this.leftCurrent===((this.leftRatio*2)+8)){this.leftCurrent=8}else{this.leftCurrent+=this.leftRatio}return f},onRender:function(){this.onAttach()},onAttach:function(){e.__super__.onAttach.call(this);if(!this.isEmpty()){var k=0;var h=-1;var f=this;this.children.each(function(i){if(h++===2){h=0;k++}var j=k*f.topRatio;i.updateTop(j);i.updateDataTop()});this.maxTop=(f.topRatio*k);var l=this;setTimeout(function(){l.triggerMethod("view:enablePan",true)},0)}else{if(this._isReallyEmpty){var g=this.children.first();if(g){g.showEmpty()}}}},showEmpty:function(){this._isReallyEmpty=true;this.render()}});return e});define("DS/DEL3DLeanCollectionViews/SideCollectionViews/SideTeamCollectionView",["UWA/Core","pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/SideCollectionViews/AScrollCollectionView","DS/DEL3DLeanViews/ToolsSubpanels/CollectionElements/SidePersonView","css!DS/DEL3DLeanCollectionViews/assets/css/SideTeamCollectionView.css"],function(f,c,a,b,e){var d=b.extend({name:"SideTeamCollectionView",className:"sidePersonCollectionView",topRatio:9,childView:e,allowedSessions:[],filter:function(h){var g=false;if(h.get("name")===f.getGlobal().leanSessionManager._3DLeanSession.get("owner")){return false}if(h.isInTeam()||h.isCollaborator()){g=true}return g},viewComparator:function(k,i){var h=0;if(k.isInTeam()&&!i.isInTeam()){h=-1}else{if(!k.isInTeam()&&i.isInTeam()){h=1}else{var j;var g;if(!k.isInTeam()){j=k.get("personFirstname")+k.get("personLastname");g=i.get("personFirstname")+i.get("personLastname")}else{j=k.get("firstname")+k.get("lastname");g=i.get("firstname")+i.get("lastname")}if(j<g){h=-1}else{if(j>g){h=1}}}}return h},initialize:function(g){d.__super__.initialize.call(this,g);this.listenTo(f.getGlobal().leanSessionManager,"after:loadall",this.init.bind(this))},init:function(){setTimeout(function(){if(this.isEmpty()){this._isReallyEmpty=true;var g=this.children.first();if(g){g.showEmpty()}}}.bind(this),0)},onAddChild:function(){if(this._isRendered){this.onAttach()}},onBeforeRemoveChild:function(){var g=this;if(this._isRendered){setTimeout(function(){g.onAttach()},0)}},onAttach:function(){d.__super__.onAttach.call(this);if(this._isReallyEmpty){var k=this.children.first();if(this.isEmpty()&&f.is(k.showEmpty,"function")){this.children.first().showEmpty()}}var h=0;var g=this;this.children.each(function(i){if(i.name!=="LoadingEmptyView"){var l=h*g.topRatio;i.updateTop(l);i.updateDataTop();h++}});this.maxTop=(g.topRatio*(g.children.length-1));var j=this;setTimeout(function(){j.triggerMethod("view:enablePan",true)},0)}});return d});define("DS/DEL3DLeanCollectionViews/StaticCollectionView",["UWA/Core","pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/ElementCollectionView","DS/DEL3DLeanViews/Behaviors/LayoutBehavior","pluginDS!DS/VENBackboneRadio/backbone.radio.2.0.0/backbone.radio","DS/DEL3DLeanModels/relations/Coord.model","DS/DEL3DLeanCollections/Collection.manager","DS/DEL3DLeanViews/Utils/UIUtils","DS/DEL3DLeanEnums/Model.enum","DS/DEL3DLeanEnums/Collection.enum"],function(f,i,m,c,n,o,j,h,b,k,a){var g=c.extend({name:"StaticCollectionView",className:"staticCollectionView",behaviors:[{behaviorClass:n}],isFocused:false,isLayoutEditable:false,fromViewModel:null,childViewEvents:{"staticView:swipe":"onSwipe"},staticRadioChannel:o.channel("static"),initialize:function(p){this.fromViewModel=p.staticViewModel;c.prototype.initialize.apply(this,[p]);this.deleteAllStaticViewDelegate=i.proxy(this.deleteAllStaticView,this);this.deleteStaticViewDelegate=i.proxy(this.deleteStaticView,this);this.createViewDelegate=i.proxy(this.createStaticView,this);this.onChangeSizeDelegate=i.proxy(this.onChangeSize,this)},bindEvents:function(){this.staticRadioChannel.on("staticCollection:deleteAll",this.deleteAllStaticViewDelegate);this.staticRadioChannel.on("staticCollection:delete",this.deleteStaticViewDelegate);this.staticRadioChannel.on("staticCollection:newModel",this.createViewDelegate);this.staticRadioChannel.on("staticCollection:changeSize",this.onChangeSizeDelegate)},unbindEvents:function(){this.staticRadioChannel.off("staticCollection:deleteAll",this.deleteAllStaticViewDelegate);this.staticRadioChannel.off("staticCollection:delete",this.deleteStaticViewDelegate);this.staticRadioChannel.off("staticCollection:newModel",this.createViewDelegate);this.staticRadioChannel.off("staticCollection:changeSize",this.onChangeSizeDelegate)},focus:function(p){if(p===true){this.bindEvents()}else{this.unbindEvents()}this.children.each(i.proxy(function(q){if(!q.emptyView){q.setFocusable(p)}},this));this.isFocused=p},layoutEditable:function(p){this.children.each(i.proxy(function(q){if(!q.emptyView){q.setPositionEditable(p);if(!p&&q.onDrag===true){this.triggerMethod("view:onChildCancelMove",q)}}},this));this.triggerMethod("view:activeInteract",p,p,false);this.triggerMethod("view:layoutEditable",p);this.isLayoutEditable=p},deleteStaticView:function(q){var p=q.relationModel;p.destroy({success:function(){}});b.addClass(q.$el,"deleted");b.endTransitionEvent(q.$el,i.proxy(function(){this.removeChildView(q);if(this.isEmpty()){this.render()}},this))},deleteAllStaticView:function(){this.children.each(i.proxy(function(p){this.deleteStaticView(p)},this))},refreshSketches:function(){this.children.each(i.proxy(function(p){if(f.is(p.model)&&p.model.name==="SketchModel"){p.leangetView.refreshForeground()}},this))},updateRelation:function(q,p){q.set(p,{silent:true})},createStaticView:function(q){var p=this.createStaticRelation(q);return p},createStaticRelation:function(p,r){var s=new j();var q={merge:true};r=r||{};m.extend(r,{from:this.fromViewModel.id,to:p.id});s.save(r,q);a.RELATIONS.sessionInstance.add(s);return s},onAddChild:function d(p,q){if(!q.emptyView){if(this.isLayoutEditable){q.setPositionEditable(true)}q.setFocusable(!this.isLayoutEditable&&this.isFocused)}},onDragEnterCallback:function(s){var q={x:0,y:0};var t=i(s.relatedTarget);var u=t.offset();var r=t.width();var p=t.height();if(s.dragEvent.x0-u.left>r/2){q.x=1}if(s.dragEvent.y0-u.top>p/2){q.y=1}t.data("__draggingCorner__",q)},hasFreeSpace:function e(){var q=0;for(var p=0;p<this.collection.length;p++){if(this.collection.models[p].name==="CoordModel"){var s=Number(this.collection.models[p].get("V_DEL3DL_Size_X"))||1;var r=Number(this.collection.models[p].get("V_DEL3DL_Size_Y"))||1;q+=s*r}}return q<9},_isPositionAvailale:function l(v,u){var s=v;var q=u;for(var t=0;t<this.collection.length;t++){if(this.collection.models[t].name==="CoordModel"){var r=this.collection.models[t].get("V_DEL3DL_X");var p=this.collection.models[t].get("V_DEL3DL_Y");if(r===s&&p===q){return false}}}return true},onDropCallback:function(r){if(f.is(r.target)&&f.is(r.relatedTarget)){var q=Number(r.target.getAttribute("data-x"));var p=Number(r.target.getAttribute("data-y"));if(i(r.relatedTarget).hasClass("leangetStoreView")){if(this.hasFreeSpace()&&this._isPositionAvailale(q,p)&&!i(r.target).hasClass("loading")){i(r.target).addClass("loading");h.createModel(null,k.getFromServerType(i(r.relatedTarget).attr("data-type")),{},{success:i.proxy(function(t){this.createStaticRelation(t,{V_DEL3DL_X:q,V_DEL3DL_Y:p,V_DEL3DL_Size_X:1,V_DEL3DL_Size_Y:1});i(r.target).removeClass("loading")},this),error:i.proxy(function(){i(r.target).removeClass("loading")},this)})}}else{var s=this.children.filter({cid:r.relatedTarget.id})[0];if(this._isPositionAvailale(q,p)&&!i(r.target).hasClass("loading")){this.updateRelation(s.relationModel,{V_DEL3DL_X:q,V_DEL3DL_Y:p});this.triggerMethod("view:onChildMove",s)}else{this.triggerMethod("view:onChildCancelMove",s)}}}},onChangeSize:function(r,q,p){this.updateRelation(r.relationModel,{V_DEL3DL_Size_X:q,V_DEL3DL_Size_Y:p});this.triggerMethod("view:onChildMove",r)},onCreatePageButtonClicked:function(s,p){var q=this;var t=Number(p.split("|")[0]);var r=Number(p.split("|")[1]);if(q.hasFreeSpace()&&q._isPositionAvailale(t,r)){s.$el.parent().parent().addClass("loading");h.createModel(null,k.PAGE,{},{success:function(u){q.createStaticRelation(u,{V_DEL3DL_X:t,V_DEL3DL_Y:r,V_DEL3DL_Size_X:1,V_DEL3DL_Size_Y:1});q.staticRadioChannel.trigger("map:addPage",u,t,r);s.$el.parent().parent().removeClass("loading")},error:function(){s.$el.parent().parent().removeClass("loading")}})}},onSwipe:function(x){var t=this;var u=x.child;var w=x.event.direction;var v=u.relationModel;var z=v.attributes.V_DEL3DL_X;var y=v.attributes.V_DEL3DL_Y;var q=0;var p=0;if(w===4){q=z-1;p=y}else{if(w===16){q=z;p=y-1}else{if(w===8){q=z;p=y+1}else{if(w===2){q=z+1;p=y}else{return}}}}var s=t.collection.filter({V_DEL3DL_X:q,V_DEL3DL_Y:p})[0];if(s){var r=t.children.filter({relationModel:s})[0];u.$el.one("transitionend",function(){t.staticRadioChannel.once("after:maximize",function(){if(f.is(x.maximizeLeanget)){x.maximizeLeanget.isOnSwipe=false}u.isOnSwipe=false;r.isOnSwipe=false;b.removeClass(i(".mainView"),"onSwipe");b.removeClass(r.$el,["from"+w,"toCenter","swipeTransition","swipe"]);b.removeClass(u.$el,["fromCenter","to"+w,"swipeTransition","swipe"])});if(f.is(x.maximizeLeanget)){x.maximizeLeanget.isOnSwipe=true}u.isOnSwipe=true;r.isOnSwipe=true;t.staticRadioChannel.trigger("static:focusView",r)});b.addClass(i(".mainView"),"onSwipe");b.addClass(r.$el,["swipe","from"+w,"maximize"]);b.addClass(u.$el,["swipe","fromCenter"]);if(r.className!=="pageView"){if(f.is(r.leangetView)&&f.is(r.leangetView.resizeView)){r.leangetView.resizeView(true)}}else{r.staticCollectionView.children.each(function(A){if(f.is(A.leangetView)&&f.is(A.leangetView.resizeView)){A.leangetView.resizeView(false)}})}setTimeout(function(){if(r.$el.hasClass("swipe")){b.addClass(r.$el,["swipeTransition","toCenter"])}if(u.$el.hasClass("swipe")){b.addClass(u.$el,["swipeTransition","to"+w])}},200)}}});return g});define("DS/DEL3DLeanCollectionViews/StaticCollectionViews/TeamPadStaticCollectionView",["pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/StaticCollectionView","text!DS/DEL3DLeanCollectionViews/assets/templates/TeamPadStaticCollectionView.template.html","css!DS/DEL3DLeanCollectionViews/assets/css/TeamPadStaticCollectionView.css"],function(d,c,b){var a=c.extend({name:"TeamPadStaticCollectionView",className:"teamPadStaticCollectionView",template:d.template(b),initialize:function(e){c.prototype.initialize.apply(this,[e])},onShow:function(){},onRender:function(){}});return a});define("DS/DEL3DLeanCollectionViews/StaticCollectionViews/PageStaticCollectionView",["UWA/Core","pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/StaticCollectionView","DS/DEL3DLeanViews/EmptyViews/PageEmptyView","pluginDS!DS/VENBackboneRadio/backbone.radio.2.0.0/backbone.radio","DS/DEL3DLeanViews/assets/enums/SideBarActionEnum","text!DS/DEL3DLeanCollectionViews/assets/templates/PageStaticCollectionView.template.html","css!DS/DEL3DLeanCollectionViews/assets/css/PageStaticCollectionView.css"],function(c,d,g,e,i,h,f,b){var a=e.extend({name:"PageStaticCollectionView",className:"pageStaticCollectionView",template:g.template(b),emptyView:i,sideBarRadioChannel:h.channel("sidebar"),initialize:function(j){e.prototype.initialize.apply(this,[j]);this.staticViewModel=this.getOption("staticViewModel");this.afterFocusViewDelegate=d.proxy(this.afterFocusView,this);this.onCollectionChangeDelegate=d.proxy(this.onCollectionChange,this);this.collection.on("change",this.onCollectionChangeDelegate)},onCollectionChange:function(j){var k=this;k.children.each(function(l){if(l.model.id===j.attributes.to){k.triggerMethod("view:onChildRelationUpdate",l)}})},focus:function(j){if(j){this.staticRadioChannel.on("after:focus",this.afterFocusViewDelegate)}else{this.staticRadioChannel.off("after:focus",this.afterFocusViewDelegate)}e.prototype.focus.apply(this,[j])},afterFocusView:function(){if((this.collection.length===0&&d(".mapView.meetingPreparationOpened").length===0&&!c.getGlobal().inMeeting)||(this.collection.length===0&&c.getGlobal().inMeeting&&c.getGlobal().isMeetingLeader)){this.sideBarRadioChannel.trigger("sideBarView:openMenu","left",f.CUSTOMIZE)}}});return a});define("DS/DEL3DLeanCollectionViews/StaticCollectionViews/MapStaticCollectionView",["pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","pluginDS!DS/VENUnderscore/underscore.1.8.3/underscore","DS/DEL3DLeanCollectionViews/StaticCollectionView","DS/DEL3DLeanViews/EmptyViews/MapEmptyView","pluginDS!DS/VENBackboneRadio/backbone.radio.2.0.0/backbone.radio","text!DS/DEL3DLeanCollectionViews/assets/templates/MapStaticCollectionView.template.html","css!DS/DEL3DLeanCollectionViews/assets/css/MapStaticCollectionView.css"],function(e,d,b,f,g,c){var a=b.extend({name:"MapStaticCollectionView",className:"mapStaticCollectionView",template:d.template(c),emptyView:f,sideBarRadioChannel:g.channel("sidebar"),initialize:function(h){b.prototype.initialize.apply(this,[h]);this.staticViewModel=this.getOption("staticViewModel");this.onCollectionAddRemoveDelegate=e.proxy(this.onCollectionAddRemove,this);this.onCollectionChangeDelegate=e.proxy(this.onCollectionChange,this);this.collection.on("add",this.onCollectionAddRemoveDelegate);this.collection.on("remove",this.onCollectionAddRemoveDelegate);this.collection.on("change",this.onCollectionChangeDelegate)},onCollectionAddRemove:function(){this.sideBarRadioChannel.trigger("mapButton:updateMapButtonAvailability",this.collection)},onCollectionChange:function(h){var i=this;i.children.each(function(j){if(j.model.id===h.attributes.to){i.triggerMethod("view:onChildRelationUpdate",j);i.sideBarRadioChannel.trigger("mapButton:updateMapButtonAvailability",i.collection)}})},onShow:function(){},onRender:function(){},isEmpty:function(){for(var h=0;h<this.collection.length;h++){if(this.collection.models[h].name==="CoordModel"){return false}}return true}});return a});
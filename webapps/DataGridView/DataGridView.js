define("DS/DataGridView/DataGridViewCustomViewsDialog",["UWA/Core","UWA/Element","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/Controls/TooltipModel","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/Toggle","DS/Controls/SelectionChips","i18n!DS/DataGridView/assets/nls/translation"],function(e,b,l,a,f,i,g,m,c,h,d,k){var j=l.inherit({name:"DataGridViewCustomViewsDialog",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},title:{defaultValue:k.DataGridViewCustomViewsDialog.Title,type:"string",category:"Appearance"},modalFlag:{defaultValue:true,type:"boolean",category:"Behavior"},autoCloseFlag:{defaultValue:false,type:"boolean",category:"Behavior"},resizableFlag:{defaultValue:true,type:"boolean",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:false,type:"boolean",category:"Behavior"},width:{defaultValue:600,type:"integer",category:"Appearance",advancedSetter:true,recordFlag:true},height:{defaultValue:530,type:"integer",category:"Appearance",advancedSetter:true,recordFlag:true}},_preBuild:function(){this._parent();this._comboBox=null;this._renameViewEditor=null;this._editedCustomViews=[];this._selectedCustomView=null;this._treeDocuments=[];this._updateFromCurrentViewButton=null},_postBuildView:function(){this._parent();var y=this;this._resetPreferencesHasBeenClicked=false;var s=e.createElement("div",{"class":"wux-datagridview-custom-views-maindiv"});var q=e.createElement("div",{});var B=e.createElement("div",{"class":"wux-datagridview-custom-views-selected-view",html:k.DataGridViewCustomViewsDialog.SelectedView});B.inject(q);this._comboBox=new m({enableSearchFlag:false});this._comboBox.getContent().classList.add("wux-datagridview-custom-views-combo");this._comboBox.inject(q);this._updateComboFromCustomViews();this._renameViewEditor=new c({requiredFlag:true,placeholder:k.DataGridViewCustomViewsDialog.RenameViewEditor.placeHolder,selectAllOnFocus:true});this._renameViewEditor.getContent().classList.add("wux-datagridview-custom-views-editor");this._renameViewEditor.visibleFlag=false;this._renameViewEditor.inject(q);var C=new i({icon:{iconName:"pencil",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"icon"});C.tooltipInfos=new g({shortHelp:k.DataGridViewCustomViewsDialog.RenameView.ShortHelp,longHelp:k.DataGridViewCustomViewsDialog.RenameView.LongHelp});C.inject(q);C.addEventListener("buttonclick",function(D){y.renameCurrentCustomView()});this._renameViewEditor.addEventListener("change",function(D){if(y._selectedCustomView&&(y._renameViewEditor.value!=="")){y._selectedCustomView.identifier=y._renameViewEditor.value;y._updateComboFromCustomViews()}y._renameViewEditor.visibleFlag=false});this._renameViewEditor.addEventListener("blur",function(D){y._renameViewEditor.visibleFlag=false;y._comboBox.visibleFlag=true});var x=new i({icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"icon"});x.tooltipInfos=new g({shortHelp:k.DataGridViewCustomViewsDialog.DeleteView.ShortHelp,longHelp:k.DataGridViewCustomViewsDialog.DeleteView.LongHelp});x.inject(q);x.addEventListener("buttonclick",function(E){if(y._selectedCustomView){var D=new l({immersiveFrame:y.dataGridView.getContainingImmersiveFrame(),modalFlag:true,title:k.DataGridViewCustomViewsDialog.DeleteView.ShortHelp,content:k.DataGridViewCustomViewsDialog.DeleteView.ConfirmationQuestion+" '"+y._selectedCustomView.identifier+"'?",buttons:{Yes:new i({onClick:function(F){y.deleteCustomView(y._comboBox.selectedIndex);y._updateComboFromCustomViews();D.close()}}),No:new i({onClick:function(F){D.close()}})}})}});var r=new i({icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"icon"});r.tooltipInfos=new g({shortHelp:k.DataGridViewCustomViewsDialog.CreateView.ShortHelp,longHelp:k.DataGridViewCustomViewsDialog.CreateView.LongHelp});r.inject(q);r.addEventListener("buttonclick",function(D){y.createNewCustomView();y._updateComboFromCustomViews();y.renameCurrentCustomView()});var o=this.dataGridView.layout.getCurrentCustomViewIndex();C.disabled=(o===0)?true:false;x.disabled=(o===0)?true:false;q.inject(s);y._comboBox.addEventListener("change",function(){var D=y._comboBox.value;C.disabled=(y._comboBox.selectedIndex===0)?true:false;x.disabled=(y._comboBox.selectedIndex===0)?true:false;y.loadCustomView(y._comboBox.selectedIndex,false);y._updateButtonsState()});var A=e.createElement("div",{html:k.DataGridViewCustomViewsDialog.Description,"class":"wux-datagridview-custom-views-part"});A.inject(s);var z=e.createElement("div",{"class":"wux-datagridview-custom-views-part wux-datagridview-custom-views-datagridview"});var t=require("DS/DataGridView/DataGridView");this._attributesDataGridView=new t({identifier:this.dataGridView.identifier+"_CustomViews",rowDragEnabledFlag:true,rowReorderEnabledFlag:false,showRowIndexFlag:false,showSelectionCheckBoxesFlag:false,showOutlineFlag:true,rowSelection:"none",cellSelection:"none",showModelChangesFlag:true,showNodeKPIColorFlag:true,columns:[{text:k.DataGridViewCustomViewsDialog.ColumnsName,dataIndex:"tree",editableFlag:false,resizableFlag:true,width:"auto"},{text:k.DataGridViewCustomViewsDialog.ColumnsVisibleFlag,dataIndex:"visibleFlag",typeRepresentation:"boolean",editionPolicy:"EditionInPlace",width:60,getCellEditableState:function(E){var D=E.nodeModel.getAttributeValue("dataIndex");return y.dataGridView.layout.getColumnAlwaysVisibleFlag(D)?false:true}},{text:k.DataGridViewCustomViewsDialog.ColumnsWidth,dataIndex:"width",typeRepresentation:"integer",width:80,editionPolicy:"EditionOnDoubleClick",allowResetToUndefinedByUIFlag:true},{text:k.DataGridViewCustomViewsDialog.ColumnsPinnedState,dataIndex:"pinned",typeRepresentation:"pinnedEnum",width:"auto",editionPolicy:"EditionOnOver"}],defaultColumnDef:{minWidth:30,editableFlag:true,resizableFlag:false,editionPolicy:"EditionOnOver",sortableFlag:false,getCellKPIColor:function(I){var D=undefined;var H=y.dataGridView.layout;var F=I.nodeModel.getAttributeValue("dataIndex");if((I.columnID===1)&&(y._columnsVisibleFlagFromPreferences&&(y._columnsVisibleFlagFromPreferences.hasOwnProperty(F))&&(I.nodeModel.getAttributeValue("visibleFlag")!==y._columnsVisibleFlagFromPreferences[F]))){D="#e87b00"}else{if((I.columnID===2)&&(y._columnsWidthFromPreferences&&(y._columnsWidthFromPreferences.hasOwnProperty(F)))){var G=I.nodeModel.getAttributeValue("width");var E=y._columnsWidthFromPreferences[F];if((G!=E)&&((G!==undefined)||(E!=="auto"))){D="#e87b00"}}else{if((I.columnID===3)&&(y._columnsPinnedStateFromPreferences&&(y._columnsPinnedStateFromPreferences.hasOwnProperty(F))&&(I.nodeModel.getAttributeValue("pinned")!==y._columnsPinnedStateFromPreferences[F]))){D="#e87b00"}}}return D}},onContextualEvent:function p(D){return[]}});var v={};v[""]="unpinned";v[k.DataGridViewCustomViewsDialog.LeftPinned]="left";v[k.DataGridViewCustomViewsDialog.RightPinned]="right";this._attributesDataGridView.getTypeRepresentationFactory().registerEnum("pinnedEnum",v);this._attributesDataGridView.inject(z);z.inject(s);if(this.dataGridView.rowGroupingEnabledFlag){var u=e.createElement("div",{"class":"wux-datagridview-custom-views-part"});var n=function(I,D){var F=y.dataGridView.getDraggedRowData(I);if(F){var H={label:F.label,value:F.grid.dataIndex,index:undefined};var G=D.chipCellView?D.chipCellView.associatedModelItem:undefined;if(G){var E=D.dropPosition;if(E==="left"){H.index=y._groupingSelectionChips.getChipPosition(G.chipOptions.label)}else{if(E==="right"){H.index=y._groupingSelectionChips.getChipPosition(G.chipOptions.label)+1}}}y._groupingSelectionChips.addChip(H)}I.preventDefault();return true};this._groupingSelectionChips=new d({shape:d.SHAPE.OVAL,placeholder:k.DataGridViewCustomViewsDialog.GroupingPlaceholder,onDropCell:function(E,D){return n(E,D)},onDropBlank:function(E,D){return n(E,D)}});this._groupingSelectionChips.addEventListener("change",function(D){y._updateButtonsState()});this._groupingSelectionChips.inject(u);u.inject(s)}var w=e.createElement("div",{"class":"wux-datagridview-custom-views-part wux-datagridview-custom-views-footer"});this._resetToDefaultButton=new i({label:k.DataGridViewCustomViewsDialog.ResetPreferences,onClick:function(D){y.resetToDefault()}});this._resetToDefaultButton.getContent().addClassName("wux-datagridview-custom-views-flushButton");this._resetToDefaultButton.inject(w);this._updateFromCurrentViewButton=new i({label:k.DataGridViewCustomViewsDialog.UpdateFromCurrentView.Label,emphasize:"medium-attention"});this._updateFromCurrentViewButton.getContent().classList.add("wux-datagridview-custom-views-update-button");this._updateFromCurrentViewButton.tooltipInfos=new g({shortHelp:k.DataGridViewCustomViewsDialog.UpdateFromCurrentView.ShortHelp,longHelp:k.DataGridViewCustomViewsDialog.UpdateFromCurrentView.LongHelp});this._updateFromCurrentViewButton.inject(w);this._updateFromCurrentViewButton.addEventListener("buttonclick",function(D){y.updateFromCurrentView()});w.inject(s);this.content=s;this.buttons={Ok:new i({label:k.DataGridViewCustomViewsDialog.SaveAndApply,onClick:function(D){y.saveCustomViews(true);y.visibleFlag=false}}),Save:new i({onClick:function(D){y.saveCustomViews();y.visibleFlag=false}}),Cancel:new i({onClick:function(D){y.visibleFlag=false}})};this.buttons.Save.emphasize="secondary";this.addEventListener("close",function(D){y.visibleFlag=false})},loadCustomViews:function(){var p=this.dataGridView.layout;this._editedCustomViews=e.clone(p.getCustomViews());if(!this._editedCustomViews){this._editedCustomViews=[{identifier:k.DefaultView}]}this._treeDocuments=[];for(var o=0;o<this._editedCustomViews.length;o++){this._createNewTreeDocument()}this._columnsVisibleFlagFromPreferences=p._getColumnsVisibleFlagInPreferences();this._columnsWidthFromPreferences=p._getColumnsWidthInPreferences();this._columnsPinnedStateFromPreferences=p._getColumnsPinnedStateInPreferences();var n=p.getCurrentCustomViewIndex();if(n<0){n=0}this.loadCustomView(n,true);this._updateComboFromCustomViews()},loadCustomView:function(n,p){var z=this;var u=this._editedCustomViews[n];if(u&&((this._selectedCustomView!==u)||p)){this._selectedCustomView=u;if(this._groupingSelectionChips){this._groupingSelectionChips.removeAllChips();var t=this.dataGridView._rowModel._groupingOptions;if(t){for(var w=0;w<t.dataIndexesToGroup.length;w++){var s=t.dataIndexesToGroup[w];this._groupingSelectionChips.addChip({label:this.dataGridView.layout.getColumnOptionValue(s,"text"),value:s})}}}var v=this._treeDocuments[n];if(v){var D=v.getRoots();if(!D||(D.length===0)){v.prepareUpdate();var x=this.dataGridView.layout;var B=x.getLeafColumns();var y=x._getOrderedColumnIndexesFromChanges(u);for(var w=0;w<B.length;w++){var r=B[y[w]];var C=r.dataIndex;var o;if(u.columnsVisibleFlag&&(u.columnsVisibleFlag[C]!==undefined)){o=u.columnsVisibleFlag[C]}else{o=x._getOriginalColumnOptionValue(C,"visibleFlag")}var q;if(u.columnsWidth&&(u.columnsWidth[C]!==undefined)){q=u.columnsWidth[C]}else{q=x._getOriginalColumnOptionValue(C,"width")}var A;if(u.columnsPinnedState&&(u.columnsPinnedState[C]!==undefined)){A=u.columnsPinnedState[C]}else{A=x._getOriginalColumnOptionValue(C,"pinned")}v.addRoot(new f({label:r.text,icons:[r.icon],grid:{visibleFlag:o,width:(q==="auto"?undefined:q),dataIndex:C,pinned:(A?A:"unpinned")}}))}v.setUseChangeTransactionMode(true);v.pushUpdate()}}this._attributesDataGridView.treeDocument=v;this._attributesDataGridView.setActiveCell(-1);this._updateButtonsState()}},resetToDefault:function(){this._resetPreferencesHasBeenClicked=true;var q=this._attributesDataGridView.getTreeDocument();if(q){q.prepareUpdate();var s=this.dataGridView.layout;var v=q.getRoots();for(var r=0;r<v.length;r++){var p=v[r];if(p){var u=p.getAttributeValue("dataIndex");var n=s._getOriginalColumnOptionValue(u,"visibleFlag");var o=s._getOriginalColumnOptionValue(u,"width");var t=s._getOriginalColumnOptionValue(u,"pinned");p.updateOptions({grid:{visibleFlag:n,width:(o==="auto"?undefined:o),pinned:(t?t:"unpinned")}})}}q._getTrueRoot().sortChildren({sortFunction:function(C,A){var x=C.getAttributeValue("dataIndex");var w=A.getAttributeValue("dataIndex");var D=s.getColumnIndex(x);var B=s.getColumnIndex(w);var z=s._originalOrderedColumnsReverseIndexes[D];var y=s._originalOrderedColumnsReverseIndexes[B];return(z-y)}});q.pushUpdate()}if(this._groupingSelectionChips){this._groupingSelectionChips.removeAllChips()}this._resetToDefaultButton.disabled=true},updateFromCurrentView:function(){var t=this._attributesDataGridView.getTreeDocument();if(t){t.prepareUpdate();var v=this.dataGridView.layout;var o=v.getOrderedColumnsIndexes();var y=t.getRoots();for(var u=0;u<y.length;u++){var q=y[u];if(q){var x=q.getAttributeValue("dataIndex");var n=v.getColumnVisibleFlag(x);var p=v.getColumnWidth(x);var w=v.getColumnPinned(x);q.updateOptions({grid:{visibleFlag:n,width:(p==="auto"?undefined:p),pinned:(w?w:"unpinned")}})}}t._getTrueRoot().sortChildren({sortFunction:function(F,D){var C=F.getAttributeValue("dataIndex");var A=D.getAttributeValue("dataIndex");var G=v.getColumnIndex(C);var E=v.getColumnIndex(A);var B=v._orderedColumnsReverseIndexes[G];var z=v._orderedColumnsReverseIndexes[E];return(B-z)}});t.pushUpdate();if(this._selectedCustomView){this._selectedCustomView.columnsSortModel=this.dataGridView._rowModel.sortModel}if(this._groupingSelectionChips){this._groupingSelectionChips.removeAllChips();var s=this.dataGridView._rowModel._groupingOptions;if(s){for(var u=0;u<s.dataIndexesToGroup.length;u++){var r=s.dataIndexesToGroup[u];this._groupingSelectionChips.addChip({label:this.dataGridView.layout.getColumnOptionValue(r,"text"),value:r})}}}if(this._updateFromCurrentViewButton){this._updateFromCurrentViewButton.disabled=true;this._updateFromCurrentViewButton.emphasize=undefined}}},_checkIfResetToDefaultIsPossible:function(){var A=false;var s=this._attributesDataGridView.getTreeDocument();if(s){var w=this.dataGridView.layout;var t=w._getOriginalOrderedColumnsIndexes();var B=s.getRoots();for(var u=0;u<B.length;u++){var q=B[u];if(q){var z=q.getAttributeValue("dataIndex");if(t[u]!==w.getColumnIndex(z)){A=true;break}var n=q.getAttributeValue("visibleFlag");var p=q.getAttributeValue("width");var x=q.getAttributeValue("pinned");if(!A&&(n!==w._getOriginalColumnOptionValue(z,"visibleFlag"))){A=true;break}if(!A){var o=w._getOriginalColumnOptionValue(z,"width");if((p!=o)&&((p!==undefined)||(o!=="auto"))){A=true;break}}if(!A&&(x!==w._getOriginalColumnOptionValue(z,"pinned"))){A=true;break}}}}if(!A&&this._selectedCustomView){var v=this.dataGridView._rowModel._originalSortModel;var y=this._selectedCustomView.columnsSortModel;if(y&&v&&(y!=v)){A=true}else{var C=this._groupingSelectionChips.getAllChipsOptions();var r=C.map(function(D){return D.value});if(r.length>0){A=true}}}if(this._resetToDefaultButton){this._resetToDefaultButton.disabled=!A}return A},_checkIfUpdateFromCurrentViewIsPossible:function(){var y=false;var z=this._attributesDataGridView.getTreeDocument();if(z){var C=this.dataGridView.layout;var n=C.getOrderedColumnsIndexes();var t=z.getRoots();for(var x=0;x<t.length;x++){var w=t[x];if(w){var E=w.getAttributeValue("dataIndex");if(n[x]!==C.getColumnIndex(E)){y=true;break}var u=w.getAttributeValue("visibleFlag");var r=w.getAttributeValue("width");var p=w.getAttributeValue("pinned");if(!y&&this._columnsVisibleFlagFromPreferences&&this._columnsVisibleFlagFromPreferences.hasOwnProperty(E)&&(u!==this._columnsVisibleFlagFromPreferences[E])){y=true;break}if(!y&&this._columnsWidthFromPreferences&&this._columnsWidthFromPreferences.hasOwnProperty(E)){var s=this._columnsWidthFromPreferences[E];if((r!=s)&&((r!==undefined)||(s!=="auto"))){y=true;break}}if(!y&&this._columnsPinnedStateFromPreferences&&this._columnsPinnedStateFromPreferences.hasOwnProperty(E)&&(p!==this._columnsPinnedStateFromPreferences[E])){y=true;break}}}}if(!y&&this._selectedCustomView){var A=this.dataGridView._rowModel._originalSortModel;var q=this.dataGridView._rowModel.sortModel;var B=this._selectedCustomView.columnsSortModel;if(q&&(B!=q)&&(q!=A)){y=true}else{var o=this._groupingSelectionChips.getAllChipsOptions();var D=o.map(function(F){return F.value});var v=this.dataGridView._rowModel._groupingOptions;if((!v&&D.length>0)||(v&&!v.dataIndexesToGroup.equals(D))){y=true}}}if(this._updateFromCurrentViewButton){this._updateFromCurrentViewButton.disabled=!y;if(y){this._updateFromCurrentViewButton.emphasize="medium-attention"}else{this._updateFromCurrentViewButton.emphasize=undefined}}return y},_checkIfSaveAndApplyArePossible:function(){var y=false;var I=this.dataGridView.layout;var o=this._groupingSelectionChips.getAllChipsOptions();var J=o.map(function(L){return L.value});for(var E=0;E<this._treeDocuments.length;E++){var F=this._treeDocuments[E];var v=this._editedCustomViews[E];if(F&&v){var C=I._getOrderedColumnIndexesFromChanges(v);var u=F.getRoots();for(var D=0;D<u.length;D++){var A=u[D];if(A){var K=A.getAttributeValue("dataIndex");var q=A.getAttributeValue("pinned");if(C[D]!==I.getColumnIndex(K)){y=true;break}var w=A.getAttributeValue("visibleFlag");if(((w!==I._getOriginalColumnOptionValue(K,"visibleFlag"))&&(!v.columnsVisibleFlag||!v.columnsVisibleFlag.hasOwnProperty(K)))||((v.columnsVisibleFlag&&v.columnsVisibleFlag.hasOwnProperty(K)&&(v.columnsVisibleFlag[K]!==w)))){y=true;break}var s=A.getAttributeValue("width");if(s===undefined){s="auto"}if(((s!=I._getOriginalColumnOptionValue(K,"width"))&&(!v.columnsWidth||!v.columnsWidth.hasOwnProperty(K)))||((v.columnsWidth&&v.columnsWidth.hasOwnProperty(K)&&(v.columnsWidth[K]!=s)))){y=true;break}if(((q!==I._getOriginalColumnOptionValue(K,"pinned"))&&(!v.columnsPinnedState||!v.columnsPinnedState.hasOwnProperty(K)))||((v.columnsPinnedState&&v.columnsPinnedState.hasOwnProperty(K)&&(v.columnsPinnedState[K]!==q)))){y=true;break}}}}if(!y){var x=this.dataGridView._rowModel._groupingOptions;if((!x&&J.length>0)||(x&&!x.dataIndexesToGroup.equals(J))){y=true}}if(y){break}}var z=false;if(((this._comboBox.selectedIndex!==I.getCurrentCustomViewIndex())&&(I.getCurrentCustomViewIndex()>=0))||((this._editedCustomViews.length>1)&&(I.getCurrentCustomViewIndex()<0))){z=true}if(!z){var F=this._attributesDataGridView.getTreeDocument();if(F){var n=I.getOrderedColumnsIndexes();var u=F.getRoots();for(var E=0;E<u.length;E++){var A=u[E];if(A){var K=A.getAttributeValue("dataIndex");if(n[E]!==I.getColumnIndex(K)){z=true;break}var w=A.getAttributeValue("visibleFlag")&&(!this.dataGridView.rowGroupingOptions.hideGroupedColumns||(J.indexOf(K)<0));var s=A.getAttributeValue("width");var q=A.getAttributeValue("pinned");if(!z&&(w!==I.getColumnVisibleFlag(K))){z=true;break}if(!z){var t=I.getColumnWidth(K);if((s!=t)&&((s!==undefined)||(t!=="auto"))){z=true;break}}if(!z&&(q!==I.getColumnPinned(K))){z=true;break}}}}if(!z&&this._selectedCustomView){var G=this.dataGridView._rowModel._originalSortModel;var r=this.dataGridView._rowModel.sortModel;var H=this._selectedCustomView.columnsSortModel;if(r&&(H!=r)&&(r!=G)){z=true}else{if((!this.dataGridView._rowModel._groupingOptions&&J.length>0)||(this.dataGridView._rowModel._groupingOptions&&!this.dataGridView._rowModel._groupingOptions.dataIndexesToGroup.equals(J))){z=true}}}}var B=this.buttons.Ok;if(B){B.disabled=!z;if(y){B.label=k.DataGridViewCustomViewsDialog.SaveAndApply}else{B.label=k.DataGridViewCustomViewsDialog.Apply}}var p=this.buttons.Save;if(p){p.disabled=!y}return(y&&z)},_updateButtonsState:function(){this._checkIfResetToDefaultIsPossible();this._checkIfUpdateFromCurrentViewIsPossible();this._checkIfSaveAndApplyArePossible()},_createNewTreeDocument:function(){var n=new a();var o=this;n.onUpdate(function(p){o._updateButtonsState()});n.onNodeModelUpdate(function(u){if(u.data&&u.data.attributes&&u.data.attributes.pinned){var v=u.data.nodeModel;var q=v.getTreeDocument();var p=u.data.virtualRowID;var t=p;var s=o._getFirstOrLastUnpinnedColumnIndex(q,"left");var r=o._getFirstOrLastUnpinnedColumnIndex(q,"right");if((u.data.attributes.pinned==="unpinned")&&(p<s)){t=s}else{if((u.data.attributes.pinned==="unpinned")&&(p>r)){t=s}else{if((u.data.attributes.pinned==="left")&&(p>=s)){t=s-1}else{if((u.data.attributes.pinned==="right")&&(p<=r)){t=r+1}}}}if(t!==p){v.getParent().moveChild(v,t);o._attributesDataGridView.ensureNodeModelVisible(v,true)}}o._updateButtonsState()});this._treeDocuments.push(n)},_clearCustomView:function(n){if(n){for(var o in n){if(n.hasOwnProperty(o)&&(o!=="identifier")){delete n[o]}}}},_setCustomViewPropertyValue:function(p,o,n,q){if(p){if(!p[o]){p[o]={}}p[o][n]=q}},getCurrentEditedCustomViewIndex:function(){return this._editedCustomViews.indexOf(this._selectedCustomView)},getEditedCustomView:function(q){var o;if(typeof q==="string"){for(var n=0;n<this._editedCustomViews.length;n++){var p=this._editedCustomViews[n];if(p&&(p.identifier===q)){o=p;break}}}else{return this._editedCustomViews[q]}return o},createNewCustomView:function(){var p=k.CustomViewDefaultName;var o=1;while(this.getEditedCustomView(p)){o++;p=k.CustomViewDefaultName+" "+o}var n={identifier:p};this._editedCustomViews.push(n);this._createNewTreeDocument();this._selectedCustomView=n},renameCurrentCustomView:function(){if(this._selectedCustomView&&this._comboBox&&this._renameViewEditor){this._comboBox.visibleFlag=false;this._renameViewEditor.value=this._selectedCustomView.identifier;this._renameViewEditor.visibleFlag=true;this._renameViewEditor._giveFocus()}},deleteCustomView:function(o){var n=this.getEditedCustomView(o);this._editedCustomViews.splice(o,1);this._treeDocuments.splice(o,1);if(this._selectedCustomView===n){this._selectedCustomView=(this._editedCustomViews.length>0)?this._editedCustomViews[0]:null;this.loadCustomView(0,true)}},saveCustomViews:function(o){var p=this.getCurrentEditedCustomViewIndex();for(var n=0;n<this._editedCustomViews.length;n++){this.saveCustomView(n,(n===p)&&o)}this.dataGridView.layout.setCustomViews(e.clone(this._editedCustomViews));if(o){this.dataGridView.layout.setCurrentCustomViewIndex(this._comboBox.selectedIndex)}if(this.dataGridView.onCustomViewsSave){this.dataGridView.onCustomViewsSave.call(this.dataGridView,this.dataGridView.layout.getCustomViews(),this.dataGridView.layout.getCurrentCustomViewIndex())}},saveCustomView:function(v,o){var s=this._editedCustomViews[v];if(s){var D=this;var A=this.dataGridView.layout;if(o){this.dataGridView.prepareUpdateView()}var C={};this._clearCustomView(s);if(this._resetPreferencesHasBeenClicked&&o){A.deleteDataGridViewPreferences()}var y=this._treeDocuments[v];if(y){var r=y.getRoots();for(var x=0;x<r.length;x++){var u=r[x];if(u){var E=u.getAttributeValue("dataIndex");var t=u.getAttributeValue("visibleFlag");if(t!==A._getOriginalColumnOptionValue(E,"visibleFlag")){D._setCustomViewPropertyValue(s,"columnsVisibleFlag",E,t)}if(o){if((D._resetPreferencesHasBeenClicked&&(t!==A._getOriginalColumnOptionValue(E,"visibleFlag")))||(!D._resetPreferencesHasBeenClicked&&(A.getColumnVisibleFlag(E)!==t))){A.setColumnVisibleFlag(E,t,{isUserInteraction:true})}else{if(D._resetPreferencesHasBeenClicked&&(A.getColumnVisibleFlag(E)!==t)){A.setColumnVisibleFlag(E,t)}}}var q=u.getAttributeValue("width");if(q===undefined){q="auto"}if(q!==A._getOriginalColumnOptionValue(E,"width")){D._setCustomViewPropertyValue(s,"columnsWidth",E,q)}if(o){if((D._resetPreferencesHasBeenClicked&&(q!==A._getOriginalColumnOptionValue(E,"width")))||(!D._resetPreferencesHasBeenClicked&&(A.getColumnWidth(E)!==q))){A.setColumnWidth(E,q,{isUserInteraction:true})}else{if(D._resetPreferencesHasBeenClicked&&(A.getColumnWidth(E)!==q)){A.setColumnWidth(E,q)}}}var p=u.getAttributeValue("pinned");if(p!==A._getOriginalColumnOptionValue(E,"pinned")){D._setCustomViewPropertyValue(s,"columnsPinnedState",E,p);D._saveColumnOrderInCustomView(E,p,x,s)}if(o){if((D._resetPreferencesHasBeenClicked&&(p!==A._getOriginalColumnOptionValue(E,"pinned")))||(!D._resetPreferencesHasBeenClicked&&(A.getColumnPinned(E)!==p))){A.setColumnPinned(E,p,{isUserInteraction:true})}else{if(D._resetPreferencesHasBeenClicked&&(A.getColumnPinned(E)!==p)){A.setColumnPinned(E,p)}}}}}}if(o&&this._selectedCustomView){var w=A._getOrderedColumnIndexesFromChanges(this._selectedCustomView);if(!e.equals(A._orderedColumnsIndexes,w)){A._orderedColumnsIndexes=w.slice(0);A._computeOrderedColumnsReverseIndexes();A._updateColumnTreeFromOrderedIndexes();this.dataGridView.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}if(this._resetPreferencesHasBeenClicked&&o){var z=this.dataGridView._rowModel._originalSortModel;if(this.dataGridView.sortModel!==z){this.dataGridView.sortModel=z;this.dataGridView.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}this._resetPreferencesHasBeenClicked=false;if(this.dataGridView.rowGroupingEnabledFlag&&this._groupingSelectionChips&&o){var n=this._groupingSelectionChips.getAllChipsOptions();var B=n.map(function(F){return F.value});if(!this.dataGridView._rowModel._groupingOptions||!this.dataGridView._rowModel._groupingOptions.dataIndexesToGroup.equals(B)){C={updateCellContent:true,updateCellLayout:true,updateCellAttributes:true};this.dataGridView.groupRows({dataIndexesToGroup:B});A._saveGroupingOptionsInPreferences()}}if(o){this.dataGridView.pushUpdateView(C)}}},_getFirstOrLastUnpinnedColumnIndex:function(o,v){var r=0;var p=0;var s=0;var u=o.getRoots();for(var q=0;q<u.length;q++){var n=u[q];if(n){var t=n.getAttributeValue("pinned");if(t==="left"){p++}else{if(t==="right"){s++}else{r++}}}}if((v==="undefined")||(v==="left")){return p}else{if(v==="right"){return p+r-1}}return -1},_getNumberOfColumnsToTheLeft:function(n){return{left:0,unpinned:this._getFirstOrLastUnpinnedColumnIndex(n,"left"),right:this._getFirstOrLastUnpinnedColumnIndex(n,"right")+1}},_getTreeDocumentFromCustomView:function(p){var n=null;var o=this._editedCustomViews.indexOf(p);if(o>=0){n=this._treeDocuments[o]}return n},_saveColumnOrderInCustomView:function(p,r,q,o){var n=this._getTreeDocumentFromCustomView(o);if(n){var t=(r==="unpinned")?"unpinnedColumnsOrder":"pinnedColumnsOrder";var s=this._getNumberOfColumnsToTheLeft(n);this._setCustomViewPropertyValue(o,t,p,q-s[r])}},_updateComboFromCustomViews:function(){var p=this.getCurrentEditedCustomViewIndex();var o=[];for(var n=0;n<this._editedCustomViews.length;n++){o.push(this._editedCustomViews[n].identifier)}this._comboBox.elementsList=o;this._comboBox.selectedIndex=p}});return j});define("DS/DataGridView/ModelMassUpdateDialog",["UWA/Core","UWA/Element","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ButtonGroup","i18n!DS/DataGridView/assets/nls/translation"],function(d,c,j,a,e,g,h,b,i){var f=j.inherit({name:"ModelMassUpdateDialog",publishedProperties:{treeDocument:{defaultValue:null,type:"object"},attributes:{defaultValue:[],type:"array"},setNodeModelValueFunction:{defaultValue:null,type:"function"}},destroy:function(){if(this._dataGridView){this._dataGridView.destroy();this._dataGridView=null}this._parent()},_postBuildView:function(){this._parent();var l=d.createElement("div",{"class":"wux-model-mass-update-maindiv"});var k=d.createElement("div",{"class":"wux-model-mass-update-description"});var n=d.createElement("div",{html:i.ModelMassUpdate.Description,"class":"wux-model-mass-update-description-label"}).inject(k);this._selectionButtonGroup=new b({type:"radio"});this._selectionButtonGroup.getContent().addClassName("wux-model-mass-update-target");this._selectionButtonGroup.addChild(new h({type:"radio",label:i.ModelMassUpdate.ApplyToSelected,value:0,checkFlag:true}));this._selectionButtonGroup.addChild(new h({type:"radio",label:i.ModelMassUpdate.ApplyToAll,value:1}));this._selectionButtonGroup.inject(k);k.inject(l);this._selectionButtonGroup.addEventListener("change",function(q){o._updateButtonsDisableState()});var m=[{text:"Name",dataIndex:"tree",typeRepresentation:"string",alignment:"far",width:"250",minWidth:"50",alwaysVisibleFlag:true,editableFlag:false},{text:"Value",dataIndex:"value",getCellTypeRepresentation:function(q){return q.nodeModel?q.nodeModel.getAttributeValue("typeRepresentation"):"string"},resizableFlag:false,width:"auto",minWidth:"100",alwaysVisibleFlag:true,editableFlag:true,editionPolicy:"EditionInPlace"}];var p=require("DS/DataGridView/DataGridView");this._dataGridView=new p({identifier:this.identifier+"_DataGridView",height:"auto",treeDocument:null,columns:m,cellSelection:"none",selectionBehavior:{selectNodeModelOnCellSelection:false},focusNextEditableCellOnTabFlag:true,showBackgroundFlag:false,showCellActivationFlag:false,showCellPreselectionFlag:false,columnDragEnabledFlag:false,showAlternateBackgroundFlag:false,showRowIndexFlag:false,showSelectionCheckBoxesFlag:true,showRowHeaderBackgroundFlag:false,defaultColumnDef:{minWidth:30,sortableFlag:false}});this._dataGridView.layout.columnsHeader=false;this._dataGridView.layout.rowSpacing=6;this._applyAttributes();var o=this;this._dataGridView.addEventListener("liveChange",function(q,r){var s=o._dataGridView.model[r.rowID];if(s){s.select()}});this._dataGridView.addEventListener("change",function(q,r){var s=o._dataGridView.model[r.rowID];if(s){s.select()}});this._dataGridView.inject(l);this.content=l;this.title=i.ModelMassUpdate.Title;var o=this;this.buttons={Ok:new g({onClick:function(q){o.applyAttributesValues();o.visibleFlag=false}}),Apply:new g({onClick:function(q){o.applyAttributesValues()}}),Close:new g({onClick:function(q){o.visibleFlag=false}})};this.addEventListener("close",function(q){o.visibleFlag=false})},_applyProperties:function(k){this._parent(k);if(this.isDirty("treeDocument")){this._applyTreeDocument(k.treeDocument)}if(this.isDirty("attributes")){this._applyAttributes(k.attributes)}},_applyTreeDocument:function(k){if(this.treeDocument){var m=this.treeDocument.getXSO();if(m){var l=this;m.onPostAdd(function(n){l._updateButtonsDisableState()});m.onPostRemove(function(n){l._updateButtonsDisableState()})}}},_applyAttributes:function(k){if(!this._dataGridView){return}var l=new a();var o=this.attributes;if(o){for(var p=0;p<o.length;p++){var m=o[p];var t=m.label?m.label:m.name;l.addRoot(new e({label:t,grid:{name:m.name,typeRepresentation:m.typeRepresentation,value:undefined}}))}}this._dataGridView.treeDocument=l;var s=this.buttons.Ok;if(s){s.disabled=true}var u=this.buttons.Apply;if(u){u.disabled=true}var n=l.getXSO();if(n){var q=this;n.onPostAdd(function(v){q._updateButtonsDisableState()});n.onPostRemove(function(v){q._updateButtonsDisableState()})}var q=this;var r=this._dataGridView.addEventListener("allCellsRendered",function(){q._dataGridView.removeEventListener("allCellsRendered",r);q._dataGridView.sizeColumnToFit("tree",{isUserInteraction:false,computeAllRows:true})})},resetAttributesValues:function(){if(!this._dataGridView){return}for(var k=0;k<this._dataGridView.model.length;k++){var l=this._dataGridView.model[k];if(l){l.setAttribute("value",undefined)}}this._dataGridView.unselectAll()},_applyAttributesValues:function(q,p){if(q&&p){if(this.setNodeModelValueFunction){for(var n=0;n<p.length;n++){var k=p[n];if(k){var m=k.getAttributeValue("name");var o=k.getAttributeValue("value");this.setNodeModelValueFunction(q,m,o)}}}else{var l={grid:{}};for(var n=0;n<p.length;n++){var k=p[n];if(k){var m=k.getAttributeValue("name");var o=k.getAttributeValue("value");l.grid[m]=o}}q.updateOptions(l)}}},applyAttributesValues:function(){if(!this._dataGridView||!this.treeDocument){return}var k=(this._selectionButtonGroup.value[0]==1)?true:false;var m=this._dataGridView.getNodesXSO();var n=m.get();if(n.length>0){var l=this;if(k){this.treeDocument.processDescendants({onlyVisibleNodes:true,processNode:function(o){l._applyAttributesValues(o.nodeModel,n)}})}else{this.treeDocument.processSelectedNodes({processNode:function(o){l._applyAttributesValues(o.nodeModel,n)}})}}},_updateButtonsDisableState:function(){var n=true;if(this.treeDocument&&this._dataGridView&&this._dataGridView.treeDocument){var o=this.treeDocument.getXSO();var m=this._dataGridView.treeDocument.getXSO();if(o&&m){var k=(this._selectionButtonGroup.value[0]==1)?true:false;if(k){n=m.isEmpty()}else{n=o.isEmpty()||m.isEmpty()}}}var p=this.buttons.Ok;if(p){p.disabled=n}var l=this.buttons.Apply;if(l){l.disabled=n}}});return f});define("DS/DataGridView/DataGridViewCell",["DS/CollectionView/CollectionViewCell"],function(a){var b=a.inherit({name:"DataGridViewCell",publishedProperties:{showKPIColorFlag:{defaultValue:false,type:"boolean"},KPIColor:{defaultValue:undefined,type:"string"}},_applyShowKPIColorFlag:function(c){this._updateKPIColor()},_applyKPIColor:function(c){this._updateKPIColor()},_updateKPIColor:function(){if(this.showKPIColorFlag){if(!this.elements.KPIColorDiv){this.elements.KPIColorDiv=new UWA.Element("div",{"class":"wux-layouts-datagridview-kpi-color"})}else{this.elements.KPIColorDiv.show()}if(this.KPIColor!==undefined){this.elements.KPIColorDiv.style.background=this.KPIColor;this.elements.KPIColorDiv.style.visibility=""}else{this.elements.KPIColorDiv.style.visibility="hidden"}if(!this.elements.KPIColorDiv.parentNode){this.elements.KPIColorDiv.inject(this.elements.container,"top")}}else{if(this.elements.KPIColorDiv){this.elements.KPIColorDiv.hide()}}},_applyProperties:function(c){this._parent(c);if(this.isDirty("showKPIColorFlag")){this._applyShowKPIColorFlag(c.showKPIColorFlag)}if(this.isDirty("KPIColor")){this._applyKPIColor(this.KPIColor)}},blackBoxFlag:true,_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-cell")}});return b});define("DS/DataGridView/DataGridViewLayout",["DS/CollectionView/layouts/CollectionViewGridLayout","DS/Utilities/Utils","DS/Utilities/Dom","DS/Utilities/TreeUtils","i18n!DS/DataGridView/assets/nls/translation"],function(j,h,b,d,k){var a=24;var g=38;var e=a+1;var c=g+1;var i="wux-collectionView-dataGridView";var f=j.inherit({name:"CollectionViewDataGridLayout",publishedProperties:{columns:{defaultValue:[],type:"array"},cellWidth:{defaultValue:100,type:"integer"},cellHeight:{defaultValue:a,type:"integer"},getRowHeightFunction:{defaultValue:null,type:"function"},columnsHeader:{defaultValue:true,type:"boolean"},columnHeaderHeight:{defaultValue:e,type:"integer"},rowsHeader:{defaultValue:true,type:"boolean"},rowSpacing:{defaultValue:0,type:"integer"},addCellCoordinates:{defaultValue:false,type:"boolean"}},init:function(l){this._parent(l);this._balancedColumnTree=[];this._columnItemsByDepth=[];this._leafColumns=[];this._leafColumnsCount=0;this._computedColumns=[];this._computedRows=[];this._columnTreeItemCount=0;this._useVariableRowHeight=false;this._hasAutoWidthColumnWithAutoRowHeightFlag=false;this._autoRowHeightColumnIndexes=[];this._customViews=null;this._currentCustomViewIndex=-1;this._manageTouchChange()},_manageTouchChange:function(){var l=this;document.addEventListener("touchChange",function(){l.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})})},prepareLayout:function(){var m=this.rowsHeader;var l=this.getLeafColumns();this._leafColumnsCount=l.length+(m?1:0);this._computeColumnsWidth();this._leftPinnedRowcolumnID=m?-4:-3;this._unpinnedRowcolumnID=m?-3:-2;this._rightPinnedRowcolumnID=m?-2:-1;this._isInvalid=false},_applyColumns:function(n,q){this._balancedColumnTree=d.createBalancedTree(this.columns);this._columnItemsByDepth=d.computeItemsByDepth(this._balancedColumnTree);var m=this.collectionView.defaultColumnDef?this.collectionView.defaultColumnDef.autoRowHeightFlag:false;this._leafColumns=[];this._hasAutoWidthColumnWithAutoRowHeightFlag=false;this._autoRowHeightColumnIndexes=[];if(this._columnItemsByDepth&&(this._columnItemsByDepth.length>0)){var l=this._columnItemsByDepth[this._columnItemsByDepth.length-1];for(var o=0;o<l.length;o++){var p=l[o];if(p.dataIndex!==undefined){if(typeof p.pinned!=="undefined"&&p.pinned!=="left"&&p.pinned!=="right"&&p.pinned!=="unpinned"){p.pinned="unpinned"}this._leafColumns.push(p);if(m||p.autoRowHeightFlag){this._autoRowHeightColumnIndexes.push(o);if(this.getColumnWidth(o)==="auto"){this._hasAutoWidthColumnWithAutoRowHeightFlag=true}}}else{console.warn("The leaf column at index "+o+" does not have a defined dataIndex")}}}if(this._autoRowHeightColumnIndexes.length>0){if(!this.getRowHeightFunction){this.getRowHeightFunction=this.getRowHeightFromCellContents}else{this.resetRowHeights()}}else{if(this.getRowHeightFunction===this.getRowHeightFromCellContents){this.getRowHeightFunction=null}}this._originalLeafColumns=d.cloneTree(this._leafColumns);this._computeOriginalOrderedColumnsIndexes();this._updateColumnTreeFromOrderedIndexes();this._computeColumnsWidth();if((n&&(n.length>0))||q){this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})}},applyColumns:function(){this.collectionView.prepareUpdateView();this._applyColumns();this._applyPreferencesOnColumns();this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});this.collectionView.pushUpdateView({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true},true)},_computeColumnItems:function(){this._mergeColumnGroups(this._balancedColumnTree,this.collectionView._draggedColumnOrGroup);this._columnItemsByDepth=d.computeItemsByDepth(this._balancedColumnTree);this._columnTreeItemCount=d.countItem(this._balancedColumnTree);this._computeColumnsReverseIndexes();this._computeOrderedColumnsIndexes()},_mergeColumnGroups:function(l,q){if(l.length>1){for(var n=l.length-1;n>0;n--){var s=l[n];var r=l[n-1];if(s&&s.children&&r&&r.children&&(s.dataIndex===r.dataIndex)&&(!q||((s!==q)&&(r!==q)))){var p=this.getColumnOrGroupPinned(s);var o=this.getColumnOrGroupPinned(r);if(p===o){r.children=r.children.concat(s.children);for(var m=0;m<s.children.length;m++){s.children[m]._parent=r}l.splice(n,1)}}}}for(var n=0;n<l.length;n++){var t=l[n];if(t&&t.children){this._mergeColumnGroups(t.children,q)}}},_updateColumnTreeFromOrderedIndexes:function(){var o=this.getLeafColumns();var n=[];for(var l=0;l<this._orderedColumnsIndexes.length;l++){var m=this._orderedColumnsIndexes[l];var p=o[m];var q=d.extractItemHierarchy(p,this._balancedColumnTree,false);if(q){n.push(q)}}this._balancedColumnTree=n;this._computeColumnItems()},_applyRowsHeader:function(l,m){if(!this.rowsHeader){this.collectionView.elements.rowHeaderExtension.setAttribute("hideBorder","")}else{this.collectionView.elements.rowHeaderExtension.removeAttribute("hideBorder")}this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})},_applyCellHeight:function(l,m){if(m<a){this.cellHeight=l;return}this.resetRowHeights()},_applyGetRowHeightFunction:function(l,m){this._useVariableRowHeight=((this.getRowHeightFunction!==undefined)&&(this.getRowHeightFunction!==null));this.resetRowHeights()},_applyColumnsHeader:function(l,m){this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})},_applyColumnHeaderHeight:function(l,m){if(m<e){this.columnHeaderHeight=l;return}this.invalidate({updateCellContent:false,updateCellLayout:false,updateCellAttributes:false})},_applyRowSpacing:function(l,m){this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},_applyAddCellCoordinates:function(l,m){this.invalidate({updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})},getLeafColumns:function(){return this._leafColumns},getVisibleOrderedLeafColumns:function(){if(!this._leafColumns){return[]}var m=[];var p=this.getLeafColumns();var q=this.getVisibleOrderedColumnsIndexes();for(var l=0;l<q.length;l++){var o=q[l];var n=p[o];m.push(n)}return m},_getColumnTreeDepth:function(){return this._columnItemsByDepth?this._columnItemsByDepth.length:0},_getOriginalLeafColumns:function(){return this._originalLeafColumns},getColumnOptionValue:function(o,n){var l;var m=this.getColumnIndex(o);if(m>-1){var q=this.getLeafColumns();var r=q[m];if(r){l=r[n]}if(l===undefined){var p=this.collectionView.defaultColumnDef;if(p){l=p[n]}}}return l},_getOriginalColumnOptionValue:function(n,m){var l;var n=this.getColumnIdentifiers(n).columnIndex;if(n>-1){var o=this._getOriginalLeafColumns();var p=o[n];if(p){l=p[m]}if((l===undefined)&&this.collectionView.defaultColumnDef){l=this.collectionView.defaultColumnDef[m]}}return l},_computeColumnsReverseIndexes:function(){this._columnsReverseIndexes={};var o=this.getLeafColumns();for(var m=0,p=o.length;m<p;m++){var l=o[m].dataIndex;if(l!==undefined){this._columnsReverseIndexes[l]=m}}this._columnsReverseIndexes.rowHeader=-1},_computeOriginalOrderedColumnsIndexes:function(){var n=this.getLeafColumns();var r=n.length;var q=[];var o=[];var p=[];for(var m=0;m<r;m++){var l=this.getColumnPinned(m);if(l==="left"){q.push(m)}else{if(l==="right"){p.push(m)}else{o.push(m)}}}this._orderedColumnsIndexes=q.concat(o).concat(p);this._originalOrderedColumnsIndexes=this._orderedColumnsIndexes.slice(0);this._computeOrderedColumnsReverseIndexes();this._originalOrderedColumnsReverseIndexes=this._orderedColumnsReverseIndexes.slice(0)},_getOriginalOrderedColumnsIndexes:function(){return this._originalOrderedColumnsIndexes},_computeOrderedColumnsIndexes:function(){this._orderedColumnsIndexes=[];var l=this._columnItemsByDepth[this._columnItemsByDepth.length-1];for(var m=0;m<l.length;m++){var n=l[m];this._orderedColumnsIndexes.push(this.getColumnIndex(n.dataIndex))}this._computeOrderedColumnsReverseIndexes()},getOrderedColumnsIndexes:function(){return this._orderedColumnsIndexes},_computeOrderedColumnsReverseIndexes:function(){this._orderedColumnsReverseIndexes=[];for(var l=0;l<this._orderedColumnsIndexes.length;l++){this._orderedColumnsReverseIndexes[this._orderedColumnsIndexes[l]]=l}},_computeColumnsWidth:function(){this._firstUnpinnedColumnIndex=undefined;this._lastUnpinnedColumnIndex=undefined;this._firstLeftPinnedColumnIndex=undefined;this._lastLeftPinnedColumnIndex=undefined;this._firstRightPinnedColumnIndex=undefined;this._lastRightPinnedColumnIndex=undefined;var l=this.collectionView.getViewportDimensions();var o=this.collectionView.getDimensions();var D=this._getEstimatedVirtualHeight(true)>l.height?UWA.Utils.Client.getScrollbarWidth():0;var r=o.width-D-(this.rowsHeader?this.getRowHeaderWidth():0);if(this.getRightContainerWidth()>0){r--}if(this.getLeftContainerWidth()>0){r--}var I=0;var s=this.getLeafColumns();this.collectionView.elements.rowHeaderExtension.style.width=this.rowsHeader?(this.getRowHeaderWidth()+1)+"px":"0px";for(var B=0,y=s.length;B<y;B++){var u=false;var E=this.getColumnVisibleState(B);var q=this.getColumnWidth(B);if(q===undefined){q="auto"}var H=this.getColumnMinWidth(B);if(!E){q=0}else{if(typeof q==="string"){if(q==="auto"){q=0;u=true;I++}else{if(q.indexOf("%")>-1){q=Math.floor(o.width*(parseInt(q,10)/100))}else{q=parseInt(q,10)}}}q=Math.max(0,q);if(H&&!u){q=Math.max(H,q)}}r=r-q;this._setColumnComputedWidth(B,q)}var A=this.cellWidth;var G=this.rowsHeader?this.getRowHeaderWidth():0;var p=0;var w=0;var C=0;for(var B=0;B<this._orderedColumnsIndexes.length;B++){var z=this._orderedColumnsIndexes[B];var H=this.getColumnMinWidth(z);var E=this.getColumnVisibleState(z);var q=this.getColumnWidth(z);var m=this.getColumnPinned(z);if(q==="auto"&&E){var F=Math.floor(r/(I-C));var x=Math.max(A,F);if(H){x=Math.max(H,x)}r=r-x;this._setColumnComputedWidth(z,x);C++}var t=0;var v=this.getColumnComputedWidth(z);if(m==="left"){t=G;G+=v;if(this._firstLeftPinnedColumnIndex===undefined&&E){this._firstLeftPinnedColumnIndex=z}if(E){this._lastLeftPinnedColumnIndex=z}}else{if(m==="right"){t=p;p+=v;if(this._firstRightPinnedColumnIndex===undefined&&E){this._firstRightPinnedColumnIndex=z}if(E){this._lastRightPinnedColumnIndex=z}}else{t=w;w+=v;if(this._firstUnpinnedColumnIndex===undefined&&E){this._firstUnpinnedColumnIndex=z}if(E){this._lastUnpinnedColumnIndex=z}}}this._setColumnPosition(z,t)}},_setColumnPosition:function(m,l){if(!this._computedColumns[m]){this._computedColumns[m]={}}this._computedColumns[m].position=l},getColumnPosition:function(l){return this._computedColumns[l]?this._computedColumns[l].position:0},getColumnOrGroupPosition:function(m){var l=0;if(m){if(m.children){l=this.getColumnOrGroupPosition(m.children[0])}else{l=this.getColumnPosition(this.getColumnIndex(m.dataIndex))}}return l},moveColumn:function(o,m,l){var n=this.getLeafColumns();var p=n[this.getColumnIndex(o)];this.moveColumnOrGroup(p,m,l)},moveColumnOrGroup:function(B,m,t){if(!B){return}if(typeof m==="string"){m=this.getColumnIndex(m)}var z=this.getLeafColumns();var J=z[m];if(!J){return}var C=d.getLeafItems(B);for(var G=0;G<C.length;G++){var q=C[G];if(q===J){return}}var H=this.getFirstLeafColumnIndex(B);var K=this.getLastLeafColumnIndex(B);var A=this._orderedColumnsReverseIndexes[H];var r=this._orderedColumnsReverseIndexes[m];var y=(A<r)?"after":"before";var E=d.getCommonParent(B,J);if(!E){E=this._balancedColumnTree}var L=this._getPreviousVisibleColumnID(H);var u=this._getNextVisibleColumnID(K);var w=this._columnTreeItemCount;var p=d.extractItemHierarchy(B,E,true);if(p){d.splitParentAtItemIndex(J,E,y);var s=d.getIndexInRootParent(J,E);var I=(y==="after")?s+1:s;if(E&&(E!==this._balancedColumnTree)){d.addChild(E,p,I)}else{this._balancedColumnTree.splice(I,0,p)}}this._computeColumnItems();var F=this.getColumnPinned(m);var D=this._orderedColumnsReverseIndexes[H]<this._orderedColumnsReverseIndexes[L]?H:u;var l=this._orderedColumnsReverseIndexes[H]<this._orderedColumnsReverseIndexes[L]?L:H;for(var G=this._orderedColumnsReverseIndexes[D];G<=this._orderedColumnsReverseIndexes[l];G++){var o=this._orderedColumnsIndexes[G];if(this.getColumnVisibleState(o)){var n=this.getColumnPinned(o);if(n===F){this.collectionView._freeUpColumnCells(o,1)}}}if(t&&t.isUserInteraction){for(var G=0;G<C.length;G++){this._saveColumnOrderInPreferences(C[G].dataIndex)}this._updateAllOrderInPreferences(B)}var v=false;if(this._columnTreeItemCount!==w){v=true}this.collectionView._updateColumnHeaderCells({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});var x=(this.collectionView._draggedColumnOrGroup)?true:false;this.collectionView.invalidateLayout({updateCellContent:v,updateCellLayout:true,updateCellAttributes:x})},getColumnAutoRowHeightFlag:function(l){return this.getColumnOptionValue(l,"autoRowHeightFlag")},setColumnAutoRowHeightFlag:function(m,o){var l=this.getColumnIndex(m);var n=this.getLeafColumns();if(n[l].autoRowHeightFlag!==o){n[l].autoRowHeightFlag=o;this.applyColumns()}},hasAutoWidthColumnWithAutoRowHeightFlag:function(){return this._hasAutoWidthColumnWithAutoRowHeightFlag},getColumnVisibleState:function(l){return this.getColumnAlwaysVisibleFlag(l)||this.getColumnVisibleFlag(l)},getColumnVisibleFlag:function(l){return this.getColumnOptionValue(l,"visibleFlag")},setColumnVisibleFlag:function(o,m,l){var n=this.getColumnIndex(o);if(n<0){return}var p=this.getLeafColumns();if(p[n].visibleFlag!==m){if(!m&&this.getColumnAlwaysVisibleFlag(o)){return}p[n].visibleFlag=m;if(this.getColumnAutoRowHeightFlag(n)){this.resetRowHeights()}if(m){this.collectionView._requestDelayedModelData()}if(!this.getColumnAutoRowHeightFlag(n)){this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:true})}}if(l&&l.isUserInteraction){this._saveColumnVisibleFlagInPreferences(n)}},getColumnAlwaysVisibleFlag:function(l){return this.getColumnOptionValue(l,"alwaysVisibleFlag")},getColumnOrGroupVisibleState:function(l){var n=false;if(l){if(l.children){for(var m=0;m<l.children.length;m++){var o=l.children[m];n=this.getColumnOrGroupVisibleState(o);if(n){break}}}else{n=this.getColumnVisibleState(l.dataIndex)}}return n},getColumnEditableFlag:function(l){return this.getColumnOptionValue(l,"editableFlag")},getColumnEditionPolicy:function(l){return this.getColumnOptionValue(l,"editionPolicy")},getColumnResizableFlag:function(l){return this.getColumnOptionValue(l,"resizableFlag")},getColumnSortableFlag:function(l){return this.getColumnOptionValue(l,"sortableFlag")},getColumnMassUpdateAllowedFlag:function(l){return this.getColumnOptionValue(l,"massUpdateAllowedFlag")},getColumnCompareFunction:function(l){return this.getColumnOptionValue(l,"compareFunction")},getColumnIcon:function(l){return this.getColumnOptionValue(l,"icon")},getColumnWidth:function(l){return this.getColumnOptionValue(l,"width")},setColumnWidth:function(q,p,n){if(isNaN(p)&&p!=="auto"){console.log("The width given for column "+q+" is not a Number");return}var o=this.getColumnIndex(q);var r=this.getLeafColumns();var m=this.getColumnMinWidth(o);if(m&&(typeof p==="number")){p=Math.max(p,m)}if(r[o].width!==p){r[o].width=p;if(typeof p==="number"){this._setColumnComputedWidth(o,p)}else{this._computeColumnsWidth()}var l=this.getColumnPinned(o);if((l==="left")||(l==="right")){this.collectionView._updateViewportDimensions()}if(n&&!n.isUserInteraction&&this.getColumnAutoRowHeightFlag(o)){this.resetRowHeights()}else{this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}if(n&&n.isUserInteraction){this._saveColumnWidthInPreferences(o)}},_setColumnComputedWidth:function(m,l){if(!this._computedColumns[m]){this._computedColumns[m]={}}this._computedColumns[m].width=l},getColumnComputedWidth:function(m){var l=this.getColumnIndex(m);if(l===-1){return(this.rowsHeader?this.getRowHeaderWidth():0)}else{var n=this._computedColumns[l]?this._computedColumns[l].width:0;return((n!==undefined)&&!isNaN(n))?n:0}},getColumnOrGroupComputedWidth:function(m){var l=0;if(m){if(m.children){for(var n=0;n<m.children.length;n++){var o=m.children[n];l+=this.getColumnOrGroupComputedWidth(o)}}else{l=this.getColumnComputedWidth(m.dataIndex)}}return l},getColumnMinWidth:function(l){return this.getColumnOptionValue(l,"minWidth")},getColumnPinned:function(l){return this.getColumnOptionValue(l,"pinned")},setColumnPinned:function(o,n,l){var m=this.getColumnIndex(o);this.setColumnOrGroupPinned(this._leafColumns[m],n,l)},setColumnOrGroupPinned:function(u,A,B){if(!this._isGroupInBalancedTree(u)){console.warn("setColumnOrGroupPinned has been called on a column or Group that does not exist in the DataGridView");return}var q=this.getFirstLeafColumnIndex(u);var s=this.getDataIndexFromColumnIndex(q);if(A!=="right"&&A!=="left"){A="unpinned"}var v=this.getLeafColumns();if(v[q].pinned!==A){var o=q;var p=this._getNumberOfColumnsToTheLeft();if(A==="unpinned"){var w=this._getUnpinnedColumnsOrderInPreferences();if(w&&typeof w[s]==="number"){var y=w[s]+p[A];if(v[q].pinned==="left"){y=y-1}o=this._orderedColumnsIndexes[y]}else{var n=this._orderedColumnsIndexes[this._originalOrderedColumnsReverseIndexes[q]];var z=this.getColumnPinned(n);if(z==="unpinned"){o=n}else{var m=this._getFirstOrLastUnpinnedColumnIndex(z);if(z===v[q].pinned&&z==="left"){m=m-1}else{if(z===v[q].pinned&&z==="right"){m=m+1}}o=this._orderedColumnsIndexes[m]}}}else{var m=this._getFirstOrLastUnpinnedColumnIndex(A);o=this._orderedColumnsIndexes[m]}if(u.children){var l=d.getLeafItems(u);for(var r=0;r<l.length;r++){l[r].pinned=A}d.splitParentAtItemIndex(l[0],this._balancedColumnTree,"before");d.splitParentAtItemIndex(l[l.length],this._balancedColumnTree,"after");this.moveColumnOrGroup(u,o,B);if(B&&B.isUserInteraction){for(var r=0;r<l.length;r++){var t=this.getColumnIndex(l[r].dataIndex);this._saveColumnPinnedStateInPreferences(t)}}}else{u.pinned=A;var t=this.getColumnIndex(u.dataIndex);if(o!==t){d.splitParentAtItemIndex(u,this._balancedColumnTree,"before");d.splitParentAtItemIndex(u,this._balancedColumnTree,"after");this.moveColumn(t,o,B);if(B&&B.isUserInteraction){this._saveColumnPinnedStateInPreferences(t)}}else{this._computeColumnItems();if(B&&B.isUserInteraction){this._saveColumnOrderInPreferences(t);this._updateAllOrderInPreferences();this._saveColumnPinnedStateInPreferences(t)}}}var x=this.collectionView.getViewportDimensions();this._updateColumnTreeFromOrderedIndexes();this._computeColumnItems();this.collectionView._updateViewportDimensions();this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})}},getColumnOrGroupPinned:function(l){var n;if(l){if(l.children){n=this.getColumnOrGroupPinned(l.children[0]);for(var m=1;m<l.children.length;m++){if(n!==this.getColumnOrGroupPinned(l.children[m])){return undefined}}}else{n=this.getColumnPinned(this.getColumnIndex(l.dataIndex))}}return n},getColumnAutoSizePadding:function(l){return this.getColumnOptionValue(l,"autoSizePadding")},getColumnAllowUnsafeHTMLContent:function(l){return this.getColumnOptionValue(l,"allowUnsafeHTMLContent")},getColumnShouldCellAllowUnsafeHTMLContentAt:function(l){return this.getColumnOptionValue(l,"shouldCellAllowUnsafeHTMLContentAt")},getColumnTypeRepresentation:function(l){return this.getColumnOptionValue(l,"typeRepresentation")},getColumnGetCellTypeRepresentation:function(l){return this.getColumnOptionValue(l,"getCellTypeRepresentation")},_getCellTypeRepresentation:function(m){if(!m){return undefined}var l=this.getColumnGetCellTypeRepresentation(m.columnID);if(l){return l.call(this.collectionView,m)}return undefined},setColumnTypeRepresentation:function(m,o){var l=this.getColumnIndex(m);var n=this.getLeafColumns();if(n[l].typeRepresentation!==o){n[l].typeRepresentation=o;if(this.getColumnAutoRowHeightFlag(m)){this.collectionView._resetRowHeightsOnAllCellsRendered()}this.collectionView._updateRenderedColumn(l,{updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})}},getColumnOnCellRequest:function(l){return this.getColumnOptionValue(l,"onCellRequest")},getColumnGetCellEditableState:function(l){return this.getColumnOptionValue(l,"getCellEditableState")},getColumnGetCellGroupingKey:function(l){return this.getColumnOptionValue(l,"getCellGroupingKey")},getColumnGetCellValue:function(l){return this.getColumnOptionValue(l,"getCellValue")},getColumnSetCellValue:function(l){return this.getColumnOptionValue(l,"setCellValue")},getColumnGetCellSemantics:function(l){return this.getColumnOptionValue(l,"getCellSemantics")},getColumnGetCellKPIColor:function(l){return this.getColumnOptionValue(l,"getCellKPIColor")},_getFirstVisibleColumnID:function(){var l=0;while(l<this._orderedColumnsIndexes.length){if(this.getColumnVisibleState(this._orderedColumnsIndexes[l])){return this._orderedColumnsIndexes[l]}else{l=l+1}}return -1},_getLastVisibleColumnID:function(){var l=this._orderedColumnsIndexes.length-1;while(l>=0){if(this.getColumnVisibleState(this._orderedColumnsIndexes[l])){return this._orderedColumnsIndexes[l]}else{l=l-1}}return -1},_getFirstOrLastUnpinnedColumnIndex:function(o){if(o==="right"){var m=this._orderedColumnsIndexes.length-1;for(var n=m;n>=0;n--){var p=this.getColumnPinned(this._orderedColumnsIndexes[n]);if(p==="right"){m--}else{if(p==="left"){return -1}else{return m}}}}else{if(o==="left"){var l=0;for(var n=0;n<this._orderedColumnsIndexes.length;n++){var p=this.getColumnPinned(this._orderedColumnsIndexes[n]);if(p==="left"){l++}else{if(p==="right"){return -1}else{return l}}}}}return -1},_getNumberOfColumnsToTheLeft:function(){return{left:0,unpinned:this._getFirstOrLastUnpinnedColumnIndex("left"),right:this._getFirstOrLastUnpinnedColumnIndex("right")+1}},getVisibleOrderedColumnsIndexes:function(){var l=[];for(var m=0;m<this._orderedColumnsIndexes.length;m++){if(this.getColumnVisibleState(this._orderedColumnsIndexes[m])){l.push(this._orderedColumnsIndexes[m])}}return l},getDisplayedColumnsIndexes:function(){var x=-1;var z=-1;var w=this.collectionView.getViewportDimensions();var y=this.collectionView.getScrollerPosition();var o=y.x,r=y.x+w.width;var p=this.getVisibleOrderedColumnsIndexes();for(var q=0;q<p.length;q++){var u=p[q];var v=this.getColumnPinned(u);if((v!=="left")&&(v!=="right")){var m=this.getColumnPosition(u);if(m<=o){x=u}if(m<r){z=u}else{break}}}var t=[];var n=true;var s=x;while(s>=0&&n){t.push(s);if(s===z){n=false;break}s=this._getNextVisibleColumnID(s)}var l=this._getListOfVisiblePinnedColumnIDs("left").concat(t).concat(this._getListOfVisiblePinnedColumnIDs("right"));return l},_getNumberOfInvisibleColumnsBetween:function(q,p){var n=Math.min(q,p);var o=Math.max(q,p);var l=0;for(var m=n+1;m<o;m++){if(!this.getColumnVisibleState(this._orderedColumnsIndexes[m])){l++}}return l},_getPreviousVisibleColumnID:function(m){if(m===-1){return -1}var l=this._orderedColumnsReverseIndexes[m];if(l===undefined||(l===0)){return -1}else{var n=l-1;while(n>=0){if(this.getColumnVisibleState(this._orderedColumnsIndexes[n])){return this._orderedColumnsIndexes[n]}else{n=n-1}}return -1}},_getNextVisibleColumnID:function(o){var n=this.getColumnIndex(o);if(n===-1){return -1}var m=this._orderedColumnsReverseIndexes[n];if(m===undefined||(m===this._orderedColumnsIndexes.length-1)){return -1}else{var l=m+1;while(l<this._orderedColumnsIndexes.length){if(this.getColumnVisibleState(this._orderedColumnsIndexes[l])){return this._orderedColumnsIndexes[l]}else{l=l+1}}return -1}},_getListOfVisiblePinnedColumnIDs:function(m){var o=[];var l=(m==="left")?this._getFirstVisibleColumnID():this._getLastVisibleColumnID();var n=(m==="left")?this._getNextVisibleColumnID:this._getPreviousVisibleColumnID;while(l>=0){if(this.getColumnPinned(l)===m){o.push(l)}else{return o}l=n.call(this,l)}return o},_getLeafColumnsCount:function(l){if(l){if(l.children){var n=0;for(var m=0;m<l.children.length;m++){n=n+this._getLeafColumnsCount(l.children[m])}return n}else{return 1}}return this._leafColumnsCount},_getColumnTreeItemCount:function(){return this._columnTreeItemCount},_getColumnHeaderCellCount:function(){return this._getColumnTreeItemCount()+(this.rowsHeader?1:0)+3},getRowHeaderWidth:function(){var m=this.collectionView._getCurrentTouchMode();var l=16;if(this.collectionView.showRowIndexFlag){l=m?50:40;if(this.collectionView.showSelectionCheckBoxesFlag&&(m||(this.collectionView.showSelectionCheckBoxesFlag!=="OnOver"))){l+=18}}else{if(this.collectionView.showSelectionCheckBoxesFlag){l=m?40:30}}if(this.collectionView.showNodeKPIColorFlag){l+=6}if(this.collectionView.rowDragEnabledFlag){l+=m?12:6}return l},getCustomViews:function(){if(!this._customViews){this._loadCustomViewsFromLocalPreferences()}return this._customViews},_loadCustomViewsFromLocalPreferences:function(){if(!this._customViews){this._customViews=h.getDataFromLocalPreferences(this.collectionView,i,"customViews");if(!this._customViews){this._customViews=[{identifier:k.DefaultView}]}this._currentCustomViewIndex=-1;var l=h.getDataFromLocalPreferences(this.collectionView,i,"currentCustomViewId");if(l){for(var m=0;m<this._customViews.length;m++){var n=this._customViews[m];if(n&&(n.identifier===l)){this._currentCustomViewIndex=m;break}}}}},setCustomViews:function(l){this._customViews=l;h.saveDataInLocalPreferences(this.collectionView,i,"customViews",this._customViews)},getCurrentCustomViewIndex:function(){return this._currentCustomViewIndex},getCurrentCustomView:function(){return this.getCustomView(this._currentCustomViewIndex)},getCurrentCustomViewId:function(){var m;var l=this.getCurrentCustomView();if(l){m=l.identifier}if(!m){m=k.DefaultView}return m},setCurrentCustomViewIndex:function(l){this._currentCustomViewIndex=l;h.saveDataInLocalPreferences(this.collectionView,i,"currentCustomViewId",this.getCurrentCustomViewId())},_getCustomViewInArray:function(l,p){var n;if(l){for(var m=0;m<l.length;m++){var o=l[m];if(o&&(o.identifier===p)){n=o;break}}}return n},getCustomView:function(m){var l;if(typeof m==="string"){l=this._getCustomViewInArray(this._customViews,m)}else{return this._customViews[m]}return l},createNewCustomView:function(){var m=k.CustomViewDefaultName;var l=1;while(this.getCustomView(m)){l++;m=k.CustomViewDefaultName+" "+l}this._customViews.push({identifier:m});this._currentCustomViewIndex=this._customViews.length-1},clearCustomView:function(l){var m=this.getCustomView(l);if(m){for(var n in m){if(m.hasOwnProperty(n)&&(n!=="identifier")){delete m[n]}}}},deleteCustomView:function(l){if(this._currentCustomViewIndex===l){this._currentCustomViewIndex=0}this._customViews.splice(l,1)},_getXSORectangularShape:function(){var t=this.collectionView.getCellsXSO();if(t.isEmpty()){return undefined}var v=t.get();var u,m,n,w,q,s;for(var l=0;l<v.length;l++){var p=v[l];if(p){var x={rowID:p.rowID,columnID:this.getColumnIndex(p.columnDataIndex)};if(u===undefined){w=this._orderedColumnsReverseIndexes[x.columnID];m=this._orderedColumnsReverseIndexes[x.columnID];q=x.columnID;s=x.columnID;n=x.rowID;u=x.rowID}else{var r=this._orderedColumnsReverseIndexes[x.columnID];if(r>w){w=r;q=x.columnID}if(r<m){m=r;s=x.columnID}if(x.rowID>n){n=x.rowID}if(x.rowID<u){u=x.rowID}}}}var o=(w+1-m-this._getNumberOfInvisibleColumnsBetween(s,q))*(n+1-u);if(o===v.length){return{minColumnID:s,width:w-m+1-this._getNumberOfInvisibleColumnsBetween(s,q),minRowID:u,height:n-u+1}}else{return undefined}},getDataIndexFromColumnIndex:function(l){var m=this.getLeafColumns();if(l>=0&&l<m.length){return m[l].dataIndex}else{return"rowHeader"}},getColumnIndex:function(m){var l=-1;if(m!==undefined){if(typeof m==="string"){if(!this._columnsReverseIndexes){this._computeColumnsReverseIndexes()}var l=this._columnsReverseIndexes[m];if(l===undefined){console.log("Error in getColumnIndex : the column index is undefined for "+m)}}else{l=m}}return l},getColumnIdentifiers:function(n){var m,l;if(typeof n==="string"){l=n;m=this.getColumnIndex(n)}else{m=n;l=this.getDataIndexFromColumnIndex(n)}return{dataIndex:l,columnIndex:m}},resetRowHeights:function(){this._computedRows=[];this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},resetRowHeight:function(o){if(this._computedRows[o]&&(this._computedRows[o].height!==undefined)){var l=this._computedRows[o].height;this._computedRows[o].height=undefined;var n=this.getRowHeight(o);if(n!==l){for(var m=o+1;m<this._computedRows.length;m++){if(this._computedRows[m]){this._computedRows[m].top=undefined}}this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}},getRowHeightFromCellHeight:function(){return(this.collectionView._getCurrentTouchMode())?Math.max(this.cellHeight,g):this.cellHeight},getRowHeightFromCellContents:function(z){var n=this.getRowHeightFromCellHeight();if(this._autoRowHeightColumnIndexes){for(var u=0;u<this._autoRowHeightColumnIndexes.length;u++){var w=this._autoRowHeightColumnIndexes[u];if(this.getColumnVisibleState(w)){var y=this.getCellIDFromCoordinates({rowID:z,columnID:w});var t=false;var B=this.collectionView._getRenderedCellAt(y);if(!B){B=this.collectionView._renderCell(y,{updateCellContent:false,updateCellLayout:"ignore",updateCellAttributes:false});t=true}if(B&&B.component){var x=B.component._getReusableContent();if(x&&x.getContent){var o=B.component.getContent().style;var p=this.getColumnComputedWidth(w);o.width=p+"px";var s=o.lineHeight;var A=o.display;o.lineHeight="";o.display="block";var v=B.component.getContent().offsetHeight;var m=x.getContent().offsetHeight;if(m!==v){m+=2}if(n<m){n=m}o.display=A;o.lineHeight=s}else{var q=this.collectionView.model[z];if(q){var l=q.options.grid;var r=this.getColumnIdentifiers(w);if((r.dataIndex==="tree")||l.hasOwnProperty(r.dataIndex)){this.collectionView._resetRowHeightsOnAllCellsRendered()}}}if(t){this.collectionView._freeUpCell(y,1)}}}}}return n},_computeRowHeightAndPosition:function(o){if(!this._computedRows[o]||(this._computedRows[o].top===undefined)||(this._computedRows[o].height===undefined)){for(var m=0;m<o;m++){this._computeRowHeightAndPosition(m)}if(!this._computedRows[o]){this._computedRows[o]={}}}if(this._computedRows[o].top===undefined){this._computedRows[o].top=(o>0)?this.getRowPosition(o-1)+this.getRowHeight(o-1)+this.rowSpacing:0}if(this._computedRows[o].height===undefined){var l=this.getRowHeightFromCellHeight();var n=0;if(typeof this.getRowHeightFunction==="function"){n=this.getRowHeightFunction(o)}this._computedRows[o].height=Math.max(n,l)}},getRowHeight:function(m){var l=0;if(this._useVariableRowHeight&&(m!==undefined)&&(m>=0)){if(!this._computedRows[m]||(this._computedRows[m].height===undefined)){this._computeRowHeightAndPosition(m)}if(this._computedRows[m]&&(this._computedRows[m].height!==undefined)){l=this._computedRows[m].height}}else{l=this.getRowHeightFromCellHeight()}return l+(this.collectionView.showRowBorderFlag?1:0)},getRowPosition:function(o){var n=0;if(o>=0){if(this._useVariableRowHeight&&(o!==undefined)){if(!this._computedRows[o]||(this._computedRows[o].top===undefined)){this._computeRowHeightAndPosition(o)}if(this._computedRows[o]&&(this._computedRows[o].top!==undefined)){n=this._computedRows[o].top}}else{n=(this.getRowHeight()+this.rowSpacing)*o}}else{var m=this.collectionView._getCurrentTouchMode()?Math.max(this.columnHeaderHeight,c):this.columnHeaderHeight;var l=this._getColumnTreeDepth();n=(o+l)*m}return n},_getEstimatedVirtualHeight:function(m){var q=0;if(this.collectionView.model.length===0){q=1;return q}if(this._useVariableRowHeight&&(!m||!this._autoRowHeightColumnIndexes||(this._autoRowHeightColumnIndexes.length===0)||(this._computedRows[this.collectionView.model.length-1]&&(this._computedRows[this.collectionView.model.length-1].top!==undefined)))){var r=0;if(this._computedRows.length>0){r=this._computedRows[this._computedRows.length-1].top+this._computedRows[this._computedRows.length-1].height}var l=0;var o=0;for(var n=0;n<this._computedRows.length-1;n++){o+=this._computedRows[n].height}l=parseInt(o/this._computedRows.length);var p=(this.collectionView.model.length-this._computedRows.length)*l;q=r+p}else{q=this.collectionView.model.length*this.getRowHeight()}return q},_getRowIDFromPosition:function(s,o){var q=-1;var l=this.rowSpacing;if(this._useVariableRowHeight){if(s>=0){var r=this.collectionView.model.length-1;var p=0;for(var m=0;m<=r;m++){var n=this.getRowHeight(m);if(s<=p+n){q=m;if(o&&q+1<=r){q++}break}p+=n+l}}}else{if(o){q=Math.ceil(s/(this.getRowHeight()+l))}else{q=Math.floor(s/(this.getRowHeight()+l))}}return q},getCellCoordinatesAt:function(s){var t=-1;var q=-1;var r=this.rowsHeader;var o=this.columnsHeader;var u=(r?1:0)+3;var l=o?this._getColumnHeaderCellCount():0;if(s<l){if(s<0){t=-(this._columnItemsByDepth.length)-1;q=-4-(r?1:0)}else{t=-(this._columnItemsByDepth.length);if(s<u){q=s-u}else{var n=0;for(var p=0;p<this._columnItemsByDepth.length;p++){var m=this._columnItemsByDepth[p];if(s<n+m.length+u){q=s-n-u;break}else{t++;n+=m.length}}}}}else{var w=this._getLeafColumnsCount()+3;t=Math.floor((s-l)/w);q=((s-l)%w)-3-(r?1:0)}var v={rowID:t,columnID:q};return v},getCellIDFromCoordinates:function(s){var p=-1;var o=this.rowsHeader;if(s.rowID<0){if(s.columnID<0){if(s.rowID<-this._columnItemsByDepth.length){p=-1}else{p=s.columnID+3+(o?1:0)}}else{var r=3+(o?1:0);var q=0;for(var n=0;n<=this._columnItemsByDepth.length+s.rowID;n++){var m=this._columnItemsByDepth[n];if(n<this._columnItemsByDepth.length+s.rowID){q+=m.length}else{q+=s.columnID}}p=r+q}}else{var t=this._getLeafColumnsCount()+3;var l=this.columnsHeader?this._getColumnHeaderCellCount():0;p=l+(t*s.rowID)+s.columnID+3+(o?1:0)}if(p<-1){p=-1}return p},getColumnOrGroupFromCoordinates:function(l){var m=null;if(l.rowID===-1){m=this._leafColumns[l.columnID]}else{var n=this._columnItemsByDepth[this._columnItemsByDepth.length+l.rowID];if(n){m=n[l.columnID]}}return m},getFirstLeafColumnIndex:function(l){var m=-1;if(l){if(l.children){m=this.getFirstLeafColumnIndex(l.children[0])}else{m=this.getColumnIndex(l.dataIndex)}}return m},getLastLeafColumnIndex:function(l){var m=-1;if(l){if(l.children){m=this.getLastLeafColumnIndex(l.children[l.children.length-1])}else{m=this.getColumnIndex(l.dataIndex)}}return m},isRow:function(n){var l=this.getCellCoordinatesAt(n);var m=((l.columnID===this._leftPinnedRowcolumnID)||(l.columnID===this._unpinnedRowcolumnID)||(l.columnID===this._rightPinnedRowcolumnID));return m},getContentDimensions:function(){var p=this._getEstimatedVirtualHeight();var o=0;var q=this.getLeafColumns();for(var m=0;m<q.length;m++){var n=this.getColumnVisibleState(m);var l=this.getColumnPinned(m);if(n&&(l!=="left")&&(l!=="right")){o+=this.getColumnComputedWidth(m)}}return{width:o,height:p}},getLayoutStylesForCellAt:function(p){var v={};var y=this.getCellCoordinatesAt(p);var r=this.getRowPosition(y.rowID);var x=this.collectionView._getCurrentTouchMode();var u=((y.columnID===this._leftPinnedRowcolumnID)||(y.columnID===this._unpinnedRowcolumnID)||(y.columnID===this._rightPinnedRowcolumnID));var s=this.collectionView.showRowBorderFlag?1:0;if(u){var m=this.getRowHeight(y.rowID);if((!x&&(m!==a+s))||(x&&(m!==g+s))){v.height=m+"px"}v.transform="translateY("+r+"px)"}else{var n=0;if(y.columnID>-1){var q=this.getColumnOrGroupFromCoordinates(y);if(q){n=this.getColumnOrGroupPosition(q)}else{n=this.getColumnPosition(y.columnID)}}var l=this.getDimensionsForCellAt(p);v.width=l.width+"px";var t=(y.columnID===-1)?(a+s):a;var w=(y.columnID===-1)?(g+s):g;if((!x&&(l.height!==t))||(x&&(l.height!==w))){var o=l.height+"px";v.height=o;v.lineHeight=o}v.transform="translate3d("+n+"px,"+r+"px,0)"}return v},getLayoutAttributesForCellAt:function(s){var n=this.getCellCoordinatesAt(s);var o=this.getColumnOrGroupFromCoordinates(n);var p=((n.columnID===this._leftPinnedRowcolumnID)||(n.columnID===this._unpinnedRowcolumnID)||(n.columnID===this._rightPinnedRowcolumnID));var r={"cell-id":s};if(this.addCellCoordinates){r["row-id"]=n.rowID;r["column-id"]=n.columnID}if(n.columnID===-1){r["row-header"]=""}if(!p&&(n.rowID<=-1)){r["column-header"]="";var m=o?this.getFirstLeafColumnIndex(o):n.columnID;if((m===this._firstUnpinnedColumnIndex)||(m===this._firstLeftPinnedColumnIndex)||(m===this._firstRightPinnedColumnIndex)){r["first-column"]=""}var l=o?this.getLastLeafColumnIndex(o):n.columnID;if((l===this._lastUnpinnedColumnIndex)||(l===this._lastLeftPinnedColumnIndex)||(l===this._lastRightPinnedColumnIndex)){r["last-column"]=""}}var q;if(n.columnID===this._leftPinnedRowcolumnID){q="left"}else{if(n.columnID===this._rightPinnedRowcolumnID){q="right"}else{if(n.columnID===-1){q="left"}else{if(o){q=this.getColumnOrGroupPinned(o)}else{q=this.getColumnPinned(n.columnID)}}}}if((q==="left")||(q==="right")){r.pinned=q}if(p){if((n.rowID%2)===0){r["even-row"]=""}else{r["odd-row"]=""}}return r},getMinMaxVisibleCellIDs:function(){if(!this.isValid()){this.prepareLayout()}var q=this.columnsHeader;var p=q?this._getColumnHeaderCellCount():0;var l=this._getLeafColumnsCount()+3;var r=0;var o=this.getMinMaxVisibleRowIDs();var n=p+(o.minRowID*l)-(r*l);var m=p+((o.maxRowID+1)*l)+(r*l)-1;n=Math.max(p,n);m=Math.min(m,p+(this.collectionView.model.length*l)-1);return{minCellID:n,maxCellID:m}},getMinMaxVisibleRowIDs:function(){if(!this.isValid()){this.prepareLayout()}var l=this.collectionView.getViewportDimensions();var o=this.collectionView.getScrollerPosition();var m=this._getRowIDFromPosition(o.y);var n=this._getRowIDFromPosition(o.y+l.height,true);if((n<=-1)&&(o.y+l.height>0)){n=this.collectionView.model.length-1}return{minRowID:m,maxRowID:n}},renderListOfVisibleCellsInViewport:function(r){if(!r||!r.render){return}var y=this.collectionView;var t=false;var m;if(r.allottedTime>0){m=window.performance?performance.now():Date.now()}var B=this.getMinMaxVisibleCellIDs();var H=this.getCellCoordinatesAt(B.minCellID);var l=this.getCellCoordinatesAt(B.maxCellID);var x=this.columnsHeader;var D=this.rowsHeader;var z=x?this._getColumnHeaderCellCount():0;y._listOfRenderedCells.forEach(function(J,K){if(((K<B.minCellID)&&(K>=z))||(K>B.maxCellID)){y._freeUpCell(K,1)}});var n=(this._firstLeftPinnedColumnIndex!==undefined)?true:false;var s=(this._firstRightPinnedColumnIndex!==undefined)?true:false;for(var F=H.rowID;F<=l.rowID;F++){if(n){var q=this.getCellIDFromCoordinates({rowID:F,columnID:this._leftPinnedRowcolumnID});r.render(q)}if(s){var q=this.getCellIDFromCoordinates({rowID:F,columnID:this._rightPinnedRowcolumnID});r.render(q)}var q=this.getCellIDFromCoordinates({rowID:F,columnID:this._unpinnedRowcolumnID});r.render(q)}if(x){if(D){r.render(3)}var C=(this.rowsHeader?1:0)+3;for(var F=0;F<this._columnItemsByDepth.length;F++){var A=this._columnItemsByDepth[F];for(var E=0;E<A.length;E++){var p;if(F===(this._columnItemsByDepth.length-1)){p=this._leafColumns[E]}else{p=A[E]}if(this.getColumnOrGroupVisibleState(p)){r.render(C)}C++}}}var I=H.rowID;var w=l.rowID;if(D){for(var v=I;v<=w;v++){var C=this.getCellIDFromCoordinates({rowID:v,columnID:-1});r.render(C)}}var u=this.getDisplayedColumnsIndexes();for(var v=I;v<=w;v++){if(!r.lightRendering&&!t){if((r.allottedTime>0)){var o=window.performance?performance.now():Date.now();if((o-m)>r.allottedTime){t=true}}for(var G=0;G<u.length;G++){if(u[G]>-1){if(!t){var C=this.getCellIDFromCoordinates({rowID:v,columnID:u[G]});r.render(C)}}}}}return{taskInterrupted:t}},getCellType:function(p){var m=this.getCellCoordinatesAt(p);var n;if(m.columnID>-1){var o=this.getColumnOrGroupFromCoordinates(m);if(o){n=this.getColumnOrGroupPinned(o)}else{n=this.getColumnPinned(m.columnID)}}var l=((m.rowID%2)===0);if(m.rowID<=-1){if(m.columnID===-1){return"__topleft_row_header__"}if(n==="left"){return"__topleft_item__"}else{if(n==="right"){return"__topright_item__"}else{return"__top_item__"}}}else{if(m.columnID===this._leftPinnedRowcolumnID){return l?"__left_even_row__":"__left_odd_row__"}else{if(m.columnID===this._unpinnedRowcolumnID){return l?"__even_row__":"__odd_row__"}else{if(m.columnID===this._rightPinnedRowcolumnID){return l?"__right_even_row__":"__right_odd_row__"}else{if(m.columnID===-1){return"__row_header__"}else{var q=this.getLeafColumns();if(q[m.columnID]&&q[m.columnID].dataIndex==="tree"){if(n==="left"){return"__left_tree_item__"}else{if(n==="right"){return"__right_tree_item__"}else{return"__tree_item__"}}}else{if(n==="left"){return"__left_item__"}else{if(n==="right"){return"__right_item__"}else{return"__item__"}}}}}}}}},getHeaderContainerHeight:function(){var l=this._getColumnTreeDepth();if(this.collectionView._getCurrentTouchMode()){return this.columnsHeader?(Math.max(this.columnHeaderHeight,c)*l):0}else{return this.columnsHeader?(this.columnHeaderHeight*l):0}},getLeftContainerWidth:function(){var o=0;var p=this.getLeafColumns();for(var m=0;m<p.length;m++){var n=this.getColumnVisibleState(m);var l=this.getColumnPinned(m);if(n&&l==="left"){o+=this.getColumnComputedWidth(m)}}if(this.rowsHeader){o+=this.getRowHeaderWidth()}return o},getRightContainerWidth:function(){var o=0;var p=this.getLeafColumns();for(var m=0;m<p.length;m++){var n=this.getColumnVisibleState(m);var l=this.getColumnPinned(m);if(n&&l==="right"){o+=this.getColumnComputedWidth(m)}}return o},getPositionForCellAt:function(o){var l={top:0,left:0};var m=this.getCellCoordinatesAt(o);l.top=this.getRowPosition(m.rowID);if(m.columnID>-1){var n=this.getColumnOrGroupFromCoordinates(m);if(n){l.left=this.getColumnOrGroupPosition(n)}else{l.left=this.getColumnPosition(m.columnID)}}return l},getCellIDFromPositionInView:function(q){var s=-1;if(q){var v=this.getHeaderContainerHeight();if(q.top>=v){var u=this._getRowIDFromPosition(q.top-v);if(u<this.collectionView.model.length){var x=this.collectionView.getViewportDimensions();var m=this.getLeftContainerWidth();var n=this.getRightContainerWidth();var y="unpinned";if(q.left<=m){y="left"}else{if(q.left>=m+x.width){y="right"}}var p=-1;var t=this.rowsHeader?this.getRowHeaderWidth():0;if(q.left>=t){for(var r=0;r<this._orderedColumnsIndexes.length;r++){var o=this._orderedColumnsIndexes[r];var l=this.getColumnVisibleState(o);var w=this.getColumnPinned(o);if(l){t+=this.getColumnComputedWidth(o);if((w===y)&&(q.left<=t)){p=o;break}}}}if((u>=0)&&(p>=0)){s=this.getCellIDFromCoordinates({rowID:u,columnID:p})}}}}return s},getDimensionsForCellAt:function(n){var t=this.getCellCoordinatesAt(n);var r=((t.columnID===this._leftPinnedRowcolumnID)||(t.columnID===this._unpinnedRowcolumnID)||(t.columnID===this._rightPinnedRowcolumnID));var m=0;if(t.columnID>=-1){var o=this.getColumnOrGroupFromCoordinates(t);if(o){m=this.getColumnOrGroupComputedWidth(o)}else{m=this.getColumnComputedWidth(t.columnID)}}else{if(t.columnID===this._leftPinnedRowcolumnID){m=this.collectionView._leftContainerWidth}else{if(t.columnID===this._unpinnedRowcolumnID){var q=this.collectionView.getViewportDimensions();m=q.width}else{if(t.columnID===this._rightPinnedRowcolumnID){m=this.collectionView._rightContainerWidth}}}}var l=this.getRowHeight(t.rowID);var s;if(r){s=l}else{if(t.rowID<=-1){if(t.columnID===-1){s=this.getHeaderContainerHeight()}else{s=this.collectionView._getCurrentTouchMode()?Math.max(this.columnHeaderHeight,c):this.columnHeaderHeight}}else{if(t.columnID===-1){s=l}else{var p=this.collectionView.showRowBorderFlag?1:0;s=(l-p)}}}return{width:m,height:s}},computeCellRange:function(t,y){var v=[];var q=this.getCellCoordinatesAt(t);var m=this.getCellCoordinatesAt(y);if(q.columnID<0){q.columnID=0}if(m.columnID<0){m.columnID=0}var n=this._orderedColumnsReverseIndexes[q.columnID];var z=this._orderedColumnsReverseIndexes[m.columnID];if(n===undefined||z===undefined){return}var r=Math.min(n,z);var x=Math.max(n,z);var u=Math.min(q.rowID,m.rowID);var o=Math.max(q.rowID,m.rowID);for(var w=u;w<=o;w++){for(var l=r;l<=x;l++){var p=this._orderedColumnsIndexes[l];if(this.getColumnVisibleState(p)){var s=this.getCellIDFromCoordinates({rowID:w,columnID:p});v.push(s)}}}return v},isCellInRange:function(r,s,v){var q=false;var w=this.getCellCoordinatesAt(r);var p=this.getCellCoordinatesAt(s);var l=this.getCellCoordinatesAt(v);var u=Math.min(p.rowID,l.rowID);var m=Math.max(p.rowID,l.rowID);if((w.rowID>=u)&&(w.rowID<=m)){var t=this._compareColumnIDs(p.columnID,l.columnID);var o=(t<0)?p.columnID:l.columnID;var n=(o===p.columnID)?l.columnID:p.columnID;if((this._compareColumnIDs(w.columnID,o)>=0)&&(this._compareColumnIDs(w.columnID,n)<=0)){q=true}}return q},isNodeModelInRange:function(m,q,t){var l=false;if(m){var s=m._getRowID();var p=this.getCellCoordinatesAt(q);var n=this.getCellCoordinatesAt(t);var r=Math.min(p.rowID,n.rowID);var o=Math.max(p.rowID,n.rowID);l=((s>=r)&&(s<=o))}return l},getCellsFromNodeModel:function(s,r){var m=[];if(s){var o=s._getRowID();if(!r){var p=this.getLeafColumns();var l=p.length;for(var n=0;n<l;n++){m.push(this.getCellIDFromCoordinates({rowID:o,columnID:n}))}}else{var q=this.getVisibleOrderedColumnsIndexes();for(var n=0;n<q.length;n++){m.push(this.getCellIDFromCoordinates({rowID:o,columnID:q[n]}))}}}return m},_compareColumnIDs:function(n,m){var q=this.getColumnPinned(n);var l=this.getColumnPinned(m);if(q===l){var p=this.getColumnIdentifiers(n);var o=this.getColumnIdentifiers(m);return(p.columnIndex===o.columnIndex)?0:((p.columnIndex<o.columnIndex)?-1:1)}else{if(q==="left"){return -1}else{if(q==="right"){return 1}else{if(l==="left"){return 1}else{return -1}}}}},_computeCellIDFromCell:function(r,w,n,s){var u=r;var q=this.getCellCoordinatesAt(r);if((q.rowID>=0)&&(q.columnID>=0)){var x=-1;var m=-1;if(w==="up"){x=(q.rowID>0)?q.rowID-1:q.rowID;m=q.columnID}else{if(w==="right"){x=q.rowID;m=this._getNextVisibleColumnID(q.columnID)}else{if(w==="down"){x=(q.rowID<this.collectionView.model.length-1)?q.rowID+1:q.rowID;m=q.columnID}else{if(w==="left"){x=q.rowID;m=this._getPreviousVisibleColumnID(q.columnID)}else{if(w==="tab"){if(s){x=q.rowID;m=this._getPreviousVisibleColumnID(q.columnID);if((m<0)&&(x>0)){x--;m=this._getLastVisibleColumnID()}}else{x=q.rowID;m=this._getNextVisibleColumnID(q.columnID);if((m<0)&&(x<this.collectionView.model.length-1)){x++;m=this._getFirstVisibleColumnID()}}if(this.collectionView.focusNextEditableCellOnTabFlag){var v=this.getCellIDFromCoordinates({rowID:x,columnID:m});if(!this.collectionView.getCellEditableState(v)){while(1){var o=v;v=this._computeCellIDFromCell(v,w,n,s);if(v===o){x=-1;m=-1;break}else{if(this.collectionView.getCellEditableState(v)){var y=this.getCellCoordinatesAt(v);x=y.rowID;m=y.columnID;break}}}}}}else{if(w==="pageup"){var t=this.collectionView.getViewportDimensions();var p=this.getMinMaxVisibleRowIDs();var l=p.maxRowID-p.minRowID;x=Math.max(0,q.rowID-l);m=q.columnID}else{if(w==="pagedown"){var t=this.collectionView.getViewportDimensions();var p=this.getMinMaxVisibleRowIDs();var l=p.maxRowID-p.minRowID;x=Math.min(this.collectionView.model.length-1,q.rowID+l);m=q.columnID}else{if(w==="home"){if(n){x=0}else{x=q.rowID}m=this._getFirstVisibleColumnID()}else{if(w==="end"){if(n){x=this.collectionView.model.length-1}else{x=q.rowID}m=this._getLastVisibleColumnID()}else{if(w==="enter"){x=q.rowID;m=q.columnID;if(s){if(x>0){x--}}else{if(x<this.collectionView.model.length-1){x++}}}}}}}}}}}}if((x>=0)&&(m>=0)){u=this.getCellIDFromCoordinates({rowID:x,columnID:m})}}return u},_hasValidIdentifier:function(){if(this.identifier!==""){var l=Math.floor(Number(this.identifier));return((l<0)||(String(l)!==this.identifier))}return false},_getDataFromPreferences:function(l){var m=undefined;if(this._hasValidIdentifier()){m=h.getDataFromLocalPreferences(this.collectionView,i,l)}return m},_saveDataInPreferences:function(l,m){if(this._hasValidIdentifier()){h.saveDataInLocalPreferences(this.collectionView,i,l,m)}},_saveColumnOptionValueInPreferences:function(p,n,m){var o=this._getDataFromPreferences(m);if(!o){o={}}var l=this.getColumnIdentifiers(p);o[l.dataIndex]=this.getColumnOptionValue(l.columnIndex,n);this._saveDataInPreferences(m,o)},checkPresenceOfDataGridViewPreferences:function(){if(this._hasValidIdentifier()){return h.checkPresenceOfPreferences(this.collectionView,i)}else{return false}},deleteDataGridViewPreferences:function(){h.deleteDataFromLocalPreferences(this.collectionView,i)},deleteDataGridViewKeyPreference:function(l){h.deleteDataFromLocalPreferences(this.collectionView,i,l)},_getColumnsVisibleFlagInPreferences:function(){return this._getDataFromPreferences("columnsVisibleFlag")},_saveColumnVisibleFlagInPreferences:function(l){this._saveColumnOptionValueInPreferences(l,"visibleFlag","columnsVisibleFlag")},_getUnpinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("unpinnedColumnsOrder")},_getPinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("pinnedColumnsOrder")},_saveColumnOrderInPreferences:function(p){var n=this.getColumnPinned(p);var o=(n==="unpinned")?this._getUnpinnedColumnsOrderInPreferences():this._getPinnedColumnsOrderInPreferences();if(!o){o={}}var r=this._getNumberOfColumnsToTheLeft();var m=this.getColumnIdentifiers(p);var l=this._orderedColumnsReverseIndexes[m.columnIndex];l=l-r[n];o[m.dataIndex]=l;var q=n==="unpinned"?"unpinnedColumnsOrder":"pinnedColumnsOrder";this._saveDataInPreferences(q,o)},_updateAllOrderInPreferences:function(m){var q=this._getUnpinnedColumnsOrderInPreferences();var r=this._getPinnedColumnsOrderInPreferences();var s=this._getNumberOfColumnsToTheLeft();for(var o=0;o<this._orderedColumnsIndexes.length;o++){var p=this._orderedColumnsIndexes[o];var n=this.getDataIndexFromColumnIndex(p);if(this.getColumnVisibleState(n)){var l=this.getColumnPinned(n);if(q&&l==="unpinned"&&q[n]){q[n]=o-s[l]}else{if(r&&l!=="unpinned"&&r[n]){r[n]=o-s[l]}}}}this._saveDataInPreferences("unpinnedColumnsOrder",q);this._saveDataInPreferences("pinnedColumnsOrder",r)},isInGroup:function(o,l){var n=this.getColumnIdentifiers(o);var p=false;if(l){if(l.children){for(var m=0;m<l.children.length;m++){if(this.isInGroup(o,l.children[m])){return true}}}else{return l.dataIndex===n.dataIndex}}return p},_isGroupInBalancedTree:function(l){if(l&&this._balancedColumnTree){return this._isGroupInTree(l,this._balancedColumnTree)}return false},_isGroupInTree:function(o,l){var m=d.computeFirstBranchDepth(o);var n=d.computeFirstBranchDepth(l);var q=this._columnItemsByDepth[n-m];for(var p=0;p<q.length;p++){if(q[p]===o){return true}}return false},_getColumnsWidthInPreferences:function(){return this._getDataFromPreferences("columnsWidth")},_saveColumnWidthInPreferences:function(l){this._saveColumnOptionValueInPreferences(l,"width","columnsWidth")},_hasColumn:function(l){if(!this._columnsReverseIndexes){this._computeColumnsReverseIndexes()}if(typeof this._columnsReverseIndexes[l]!=="undefined"){return true}return false},_getColumnsPinnedStateInPreferences:function(){return this._getDataFromPreferences("columnsPinnedState")},_saveColumnPinnedStateInPreferences:function(l){this._saveColumnOptionValueInPreferences(l,"pinned","columnsPinnedState")},_getColumnsSortModelInPreferences:function(){return this._getDataFromPreferences("columnsSortModel")},_saveColumnSortModelInPreferences:function(){this._saveDataInPreferences("columnsSortModel",this.collectionView.sortModel)},_getGroupingOptionsInPreferences:function(){return this._getDataFromPreferences("groupingOptions")},_saveGroupingOptionsInPreferences:function(){this._saveDataInPreferences("groupingOptions",this.collectionView._rowModel._groupingOptions)},_getOrderedColumnIndexesFromChanges:function(o){var n=this._originalOrderedColumnsIndexes.slice(0);var u=o.unpinnedColumnsOrder;var t=o.pinnedColumnsOrder;var v=o.columnsPinnedState;var w={};w=h.concatenateObjects(t,u);var r=[],m=[],z=[];var x=this._getNumberOfColumnsToTheLeft();for(var A in w){var l;if(v&&v.hasOwnProperty(A)){l=v[A]}else{l=this.getColumnPinned(A)}if(l==="left"){if(t){var q=t[A];r.push({dataIndex:A,columnIndexInPref:q})}}else{if(l==="right"){if(t){var q=t[A];m.push({dataIndex:A,columnIndexInPref:q+x[l]})}}else{if(l==="unpinned"){if(u){var q=u[A];z.push({dataIndex:A,columnIndexInPref:q+x[l]})}}}}}var B=function(E,G){for(var F=0;F<E.length;F++){if(E[F]===G){E.splice(F,1);return}}};var p=r.concat(z).concat(m);var D=[];for(var C in p){if(p.hasOwnProperty(C)&&this._hasColumn(p[C].dataIndex)){var y=this.getColumnIndex(p[C].dataIndex);D[p[C].columnIndexInPref]=y;B(n,y)}}for(var s=0;s<this._orderedColumnsIndexes.length;s++){if(D.length<s){return D.concat(n)}else{if((typeof D[s]==="undefined")&&(n.length>0)){D[s]=n[0];n.splice(0,1)}}}D=D.filter(function(E){return E!==undefined});return D},_getCurrentViewChanges:function(){var o={columnsVisibleFlag:undefined,columnsWidth:undefined,columnsPinnedState:undefined,columnsSortModel:undefined,groupingOptions:undefined,unpinnedColumnsOrder:undefined,pinnedColumnsOrder:undefined};var q=this.getCurrentCustomView();if(q){o.columnsVisibleFlag=q.columnsVisibleFlag;o.columnsWidth=q.columnsWidth;o.columnsPinnedState=q.columnsPinnedState;o.columnsSortModel=q.columnsSortModel;o.groupingOptions=q.groupingOptions;o.unpinnedColumnsOrder=q.unpinnedColumnsOrder;o.pinnedColumnsOrder=q.pinnedColumnsOrder}var r=this._getColumnsVisibleFlagInPreferences();if(o.columnsVisibleFlag||r){o.columnsVisibleFlag=h.concatenateObjects(o.columnsVisibleFlag,r)}var s=this._getColumnsWidthInPreferences();if(o.columnsWidth||s){o.columnsWidth=h.concatenateObjects(o.columnsWidth,s)}var n=this._getColumnsPinnedStateInPreferences();if(o.columnsPinnedState||n){o.columnsPinnedState=h.concatenateObjects(o.columnsPinnedState,n)}var t=this._getColumnsSortModelInPreferences();if(!o.columnsSortModel){o.columnsSortModel=t}var m=this._getGroupingOptionsInPreferences();if(o.groupingOptions||m){o.groupingOptions=h.concatenateObjects(o.groupingOptions,m)}var p=this._getUnpinnedColumnsOrderInPreferences();if(o.unpinnedColumnsOrder||p){o.unpinnedColumnsOrder=h.concatenateObjects(o.unpinnedColumnsOrder,p)}var l=this._getPinnedColumnsOrderInPreferences();if(o.pinnedColumnsOrder||l){o.pinnedColumnsOrder=h.concatenateObjects(o.pinnedColumnsOrder,l)}return o},_getOrderedColumnIndexesFromPreferences:function(){var l=this._getCurrentViewChanges();return this._getOrderedColumnIndexesFromChanges(l)},_applyPreferencesOnColumns:function(){if(!this._customViews){this._loadCustomViewsFromLocalPreferences()}var m=this._getCurrentViewChanges();this.collectionView.prepareUpdateView();var n=this.getLeafColumns();for(var l=0;l<n.length;l++){if(m.columnsVisibleFlag&&(m.columnsVisibleFlag.hasOwnProperty(n[l].dataIndex))){n[l].visibleFlag=m.columnsVisibleFlag[n[l].dataIndex]}if(m.columnsWidth&&(m.columnsWidth.hasOwnProperty(n[l].dataIndex))){n[l].width=m.columnsWidth[n[l].dataIndex]}if(m.columnsPinnedState&&(m.columnsPinnedState.hasOwnProperty(n[l].dataIndex))){this.setColumnPinned(l,m.columnsPinnedState[n[l].dataIndex])}}this._orderedColumnsIndexes=this._getOrderedColumnIndexesFromPreferences();this._computeOrderedColumnsReverseIndexes();this._updateColumnTreeFromOrderedIndexes();if(m.columnsSortModel){this.collectionView.sortModel=m.columnsSortModel}if(m.groupingOptions){this.collectionView.groupRows(m.groupingOptions)}this.collectionView.pushUpdateView({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true},true)}});return f});define("DS/DataGridView/DataGridViewBaseFilterView",["UWA/Core","UWA/Element","DS/Core/BaseComponent","DS/Core/PointerEvents","DS/Controls/Popup","DS/Controls/Button","i18n!DS/DataGridView/assets/nls/translation"],function(e,a,c,f,b,i,j){var d=function(){if(this.elements._popup){return}this.elements._popup=new b({target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",className:"wux-controls-popup wux-layouts-datagridview-base-filter-popup",constraint:"screen",overlap:false,trigger:"click"});var k=new e.Element("div");this._popupContentDiv=new e.Element("div").inject(k);var l=h.call(this);l.inject(k);this.elements._popup.setBody(k)};var h=function(){var k=new e.Element("div",{"class":"wux-layouts-datagridview-base-filter-footer"});var l=this;this._applyButton=new i({label:j.FilterView.Apply,emphasize:"primary",onClick:function(n){l.validateView()}});this._applyButton.inject(k);var m=new i({label:j.FilterView.Clear,onClick:function(n){l.clearView()}});m.inject(k);return k};var g=c.inherit({name:"datagridviewbasefilterview",publishedProperties:{filterViewManager:{defaultValue:undefined,type:"object",readOnly:true},filterId:{defaultValue:"",type:"string",readOnly:true},propertyId:{defaultValue:"",type:"string",readOnly:true},validFlag:{defaultValue:true,type:"boolean"},filter:{defaultValue:null,type:"object",readOnly:true}},refreshView:function(){this.refreshContentView();this._refreshIconView()},validateView:function(){if(!this.validFlag){return}var k=this.buildFilterModelFromView();this.filterViewManager.disableUpdateView();this.filter.filterModel=k;this.filterViewManager.enableUpdateView();this._refreshIconView()},clearView:function(){this.validFlag=true;this.clearFilterViewContent();this.filterViewManager.disableUpdateView();this.filter.filterModel=this.buildFilterModelFromView();this.filterViewManager.enableUpdateView();this._refreshIconView()},buildContentView:function(){},buildFilterModelFromView:function(){},clearFilterViewContent:function(){},refreshContentView:function(){},_build:function(){this._parent();this.elements.container=new e.Element("div");this.elements.container.dsModel=this;this._popupContentDiv=null;this._applyButton=null;this.handleEvents()},_postBuild:function(){this._refreshIconView()},handleEvents:function(){var k=this;var l=function(m){if(!k.elements._popup){d.call(k);k.buildContentView(this._popupContentDiv);k.elements._popup.visibleFlag=true;k.elements._popup.addEventListener("show",function(n){if(n.dsModel.name==="popup"){k.refreshView()}})}k.elements.container.removeEventListener(f.POINTERHIT,l);m.stopPropagation()};this.elements.container.addEventListener(f.POINTERHIT,l)},_refreshIconView:function(){if(!this.elements.container||!this.filter){return}if(this.filter.isEmpty()){this.elements.container.className="wux-layouts-datagridview-base-filter-view wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-search-filter"}else{this.elements.container.className="wux-layouts-datagridview-base-filter-view wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-filter"}},_applyValidFlag:function(){this._applyButton.disabled=!this.validFlag},_applyProperties:function(k){this._parent()}});return g});define("DS/DataGridView/DataGridViewRow",["DS/CollectionView/CollectionViewCell"],function(b){var a=b.inherit({name:"DataGridViewRow",publishedProperties:{},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-row")}});return a});define("DS/DataGridView/RowModelBase",["DS/Core/BaseComponent"],function(a){var b=a.inherit({name:"RowModelBase",publishedProperties:{},_syncModel:function(){var c=this.dataGridView;var e=this;c._hasFlatTreeState=true;var d=[];if(e._getTreeDocument()){e._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(f){d.push(f.nodeModel);if(f.nodeModel.getChildren()){c._hasFlatTreeState=false}}});c.model=d}},getNodesXSO:function(){var d=null;var c=this._getTreeDocument();if(c){d=c.getXSO()}return d},shouldBeSelected:function(d){var c=this._getTreeDocument();if(c&&!c.options.shouldBeSelected.call(c,d)){return false}return true},groupRows:function(e){var f=this;var c=this.dataGridView;if(e&&e.dataIndexesToGroup){e.dataIndexesToGroup=e.dataIndexesToGroup.filter(function(g){return c.layout.getColumnOptionValue(g,"groupableFlag")});var d=f._groupingOptions&&f._groupingOptions.dataIndexesToGroup||[];f._groupingOptions=e;if(e.dataIndexesToGroup.length===0&&d.length===0){return}if(e.dataIndexesToGroup.length>0&&d.length===0){c.disableRowReordering()}else{if(e.dataIndexesToGroup.length===0&&d.length>0){c.enableRowReordering()}}if(c.rowGroupingOptions.hideGroupedColumns){e.dataIndexesToGroup.forEach(function(h){var g=d.indexOf(h);if(g!==-1){d.splice(g,1)}c.layout.setColumnVisibleFlag(h,false)});d.forEach(function(g){c.layout.setColumnVisibleFlag(g,true)})}this._doGroupingOnModel(e)}},_listenToTreeDocument:function(){var f=this;var c=this.dataGridView;var d=this._getTreeDocument();d.onUpdate(function(g){f._syncModel();if(!f._isModelBeingFetched()){if(c.model&&c.model.length===0){c._displayEmptyContentMessage()}else{c._removeEmptyContentMessage()}}if(f._mustRedrawColumnHeaders){c._updateRenderedRow(-1,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false});f._mustRedrawColumnHeaders=false}if(f._mustClearViewSelection){c.getCellsXSO().empty();f._mustClearViewSelection=false}});f._syncModel();if(!f._isModelBeingFetched()){if(c.model&&c.model.length===0){c._displayEmptyContentMessage()}else{c._removeEmptyContentMessage()}}d.onNodeModelUpdate(function(g){var i=g.data.nodeModel;if(i){var h=c.layout;var j=i._getRowID();c._updateRenderedRow(j,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:true});if(h._useVariableRowHeight){h.resetRowHeight(j)}}});var e=function(i){var g=i.target;if(g&&!g.isExpanded()){var h=g.getChildren();if(((i.event==="addChild")&&h&&(h.length===1))||((i.event==="removeChild")&&(!h||(h.length===0)))){c.updateCellView(c.layout.getCellIDFromCoordinates({rowID:g._getRowID(),columnID:c.layout.getColumnIndex("tree")}),{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}}};d.addModelEventListener("addChild",e);d.addModelEventListener("removeChild",e);this._manageTreeDocumentSelection()},_manageTreeDocumentSelection:function(){var c=this.dataGridView;var e=this.dataGridView.layout;var d=this.getNodesXSO();d.onPostAdd(function(f){var g=e.getMinMaxVisibleRowIDs();f.forEach(function(h){var j=h._getRowID();if((j>=g.minRowID)&&(j<=g.maxRowID)){c._updateRenderedRowCellsAttributes(j)}if((j>=g.minRowID)&&(j<=g.maxRowID)){var i=c._getSelectionCheckBox(j);if(i){var k=i.preventTriggeringChangeEvent;i.preventTriggeringChangeEvent=true;i.checkFlag=true;i.preventTriggeringChangeEvent=k}}});c._updateSelectAllCheckBox()});d.onPostRemove(function(g){var f=e.getMinMaxVisibleRowIDs();g.forEach(function(h){var j=h._getRowID();if((j>=f.minRowID)&&(j<=f.maxRowID)){c._updateRenderedRowCellsAttributes(j);var i=c._getSelectionCheckBox(j);if(i){var k=i.preventTriggeringChangeEvent;i.preventTriggeringChangeEvent=true;i.checkFlag=false;i.preventTriggeringChangeEvent=k}}});c._updateSelectAllCheckBox()})},prepareUpdate:function(){this._getTreeDocument().prepareUpdate()},pushUpdate:function(){this._getTreeDocument().pushUpdate()}});return b});define("DS/DataGridView/DataGridViewRowHeaderCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Utils","DS/Utilities/Dom","DS/Controls/Toggle"],function(g,d,f,c,a,b){var e=f.inherit({name:"DataGridViewRowHeaderCell",publishedProperties:{},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-row-header-cell")},buildView:function(){this._parent();var j=a.generateIcon({iconName:"drag-grip",fontIconFamily:WUXManagedFontIcons.Font3DS});j.classList.add("wux-datagridview-drag-grip");j.setAttribute("draggable",true);j.inject(this.elements.container);var i=new g.Element("div",{"class":"wux-datagridview-selection-label"});i.inject(this.elements.container);var h=new b({type:"checkbox",checkFlag:false,fireOnlyFromUIInteractionFlag:true});h.getContent().classList.add("wux-datagridview-selection-checkbox");h.inject(this.elements.container)}});return e});define("DS/DataGridView/DataGridViewSetFilterView",["DS/Core/BaseComponent","DS/Core/PointerEvents","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CollectionView/CollectionViewStatusBar","DS/DataGridView/DataGridViewBaseFilterView","DS/Controls/LineEditor"],function(e,h,a,f,i,k,c){var l=function(m){if(m===undefined||m===null||m===""){return"(Blank)"}return m};var j=function(n){var p=(n.options&&n.options.getAttributeValueForFiltering)?n.options.getAttributeValueForFiltering(this.propertyId):n.getAttributeValue(this.propertyId);var o=l.call(this,p);if(!this._possibleValues[o]){var m=new f({label:o+" (1)",attributeName:p,attributeId:o,count:0});this._treeDocumentPossibleValues.addRoot(m);this._possibleValues[o]=m}this._possibleValues[o].options.count++;return this._possibleValues[o]};var g=function(){if(!this._treeDocumentPossibleValues){return}this._treeDocumentPossibleValues.prepareUpdate();this._treeDocumentPossibleValues.empty();this._possibleValues={};var m=this.filterViewManager.filterManager.model;var p=this;m.processDescendants({processNode:function(q){j.call(p,q.nodeModel)}});for(var n in this._possibleValues){var o=this._possibleValues[n];o.updateOptions({label:o.options.attributeId+" ("+o.options.count+")"})}this._treeDocumentPossibleValues.pushUpdate()};var d=function(){var n=this.filter.filterModel;var q=false;if(!n||n.length===0){q=true}var m=[];for(var o in this._possibleValues){var p=this._possibleValues[o];if(q){m.push(p)}else{var r=p.options.attributeName;if(r===undefined||r===null||r===""){if(n.indexOf(undefined)!==-1||n.indexOf(null)!==-1||n.indexOf("")!==-1){m.push(p)}}else{if(n.indexOf(r)!==-1){m.push(p)}}}}this._treeDocumentPossibleValues.getXSO().add(m)};var b=k.inherit({name:"datagridviewsetfilterview",publishedProperties:{},_build:function(){this._parent();this._possibleValues=null;this._treeDocumentPossibleValues=null;this._searchLineEditor=null;this._dataGridViewPossibleValues=null},buildContentView:function(){var p=this._popupContentDiv;if(!p){return}p.addClassName("wux-layout-datagridview-filterview-set");var q=this;this._searchLineEditor=new c({placeholder:"Enter an attribute value"}).inject(p);this._searchLineEditor.getContent().addClassName("wux-layouts-datagridview-base-filter-condition");this._searchLineEditor.addEventListener("uncommittedChange",function r(){var s=q._treeDocumentPossibleValues.getRoots();q._treeDocumentPossibleValues.prepareUpdate();s.forEach(function t(u){if(u.options.attributeId.startsWith(q._searchLineEditor.valueToCommit)){u.show()}else{u.hide(true)}});q._treeDocumentPossibleValues.pushUpdate()});this._possibleValues={};this._treeDocumentPossibleValues=new a();var n=this._treeDocumentPossibleValues.getXSO();var m=function(){q.validFlag=!n.isEmpty()};n.onPostAdd(m);n.onPostRemove(m);var o=require("DS/DataGridView/DataGridView");this._dataGridViewPossibleValues=new o({treeDocument:this._treeDocumentPossibleValues,height:200,columns:[{text:"( Select All )",dataIndex:"tree",editableFlag:false,resizableFlag:false,width:"auto"}],showRowIndexFlag:false,showSelectionCheckBoxesFlag:true,sortModel:[{dataIndex:"tree",sort:"asc"}],onContextualEvent:function(){return[]}}).inject(p);this._dataGridViewPossibleValues.buildStatusBar([{type:i.STATUS.NB_SELECTED_ROWS}]);this.refreshContentView()},clearFilterViewContent:function(){this._treeDocumentPossibleValues.getRoots().forEach(function m(n){n.select()})},refreshContentView:function(){if(this.filter&&this.elements._popup){g.call(this);d.call(this);this._dataGridViewPossibleValues._applySortModel()}},buildFilterModelFromView:function(){if(!this._dataGridViewPossibleValues){return this.filter&&this.filter.filterModel}var m=[];this._treeDocumentPossibleValues.getRoots().forEach(function n(o){if(o.isSelected()){var p=o.options.attributeName;if(p===undefined||p===null||p===""){m.push(undefined,null,"")}else{m.push(p)}}});return m}});return b});define("DS/DataGridView/DataGridViewStringRegExpFilterView",["DS/Core/BaseComponent","DS/Core/PointerEvents","DS/DataGridView/DataGridViewBaseFilterView","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/ButtonGroup","i18n!DS/DataGridView/assets/nls/translation"],function(c,d,e,i,b,f,a,h){var g=e.inherit({name:"datagridviewstringregexpfilterview",publishedProperties:{},_build:function(){this._parent();this._firstConditionContainer=null;this._firstConditionChooser=null;this._firstConditionEditor=null;this._operatorChooser=null;this._secondConditionContainer=null;this._secondConditionChooser=null;this._secondConditionEditor=null},buildContentView:function(){var j=this._popupContentDiv;if(!j){return}j.addClassName("wux-layout-datagridview-filterview-stringregexp");var n=function(){var o={container:null,chooser:null,editor:null};o.container=new UWA.Element("div");o.container.addClassName("wux-layouts-datagridview-base-filter-condition");o.chooser=new i({enableSearchFlag:false,elementsList:[{labelItem:h.FilterView.StringRegExp.StartsWith,valueItem:"startsWith"},{labelItem:h.FilterView.StringRegExp.EndsWith,valueItem:"endsWith"},{labelItem:h.FilterView.StringRegExp.Contains,valueItem:"contains"}]}).inject(o.container);o.editor=new b().inject(o.container);return o};var k=n();this._firstConditionContainer=k.container;this._firstConditionChooser=k.chooser;this._firstConditionEditor=k.editor;this._firstConditionContainer.inject(j);var l=this;this._firstConditionEditor.addEventListener("uncommittedChange",function m(p){if(l._firstConditionEditor.valueToCommit===""){if(l._operatorChooser){l._operatorChooser.remove()}if(l._secondConditionContainer){l._secondConditionContainer.remove()}}else{if(!l._operatorChooser){l._operatorChooser=new a();l._operatorChooser.getContent().addClassName("wux-layouts-datagridview-base-filter-operator");l._operatorChooser.addChild(new f({type:"radio",label:h.FilterView.StringRegExp.AND,value:"and"}));l._operatorChooser.addChild(new f({type:"radio",label:h.FilterView.StringRegExp.OR,value:"or"}));l._operatorChooser.value=["and"]}l._operatorChooser.inject(j);if(!l._secondConditionContainer){var o=n();l._secondConditionContainer=o.container;l._secondConditionChooser=o.chooser;l._secondConditionEditor=o.editor}l._secondConditionContainer.inject(j)}});this.refreshContentView()},clearFilterViewContent:function(){if(this._firstConditionContainer){this._firstConditionChooser.selectedIndex=0;this._firstConditionEditor.value=""}if(this._operatorChooser){this._operatorChooser.value=["and"]}if(this._secondConditionContainer){this._secondConditionChooser.selectedIndex=0;this._secondConditionEditor.value=""}},refreshContentView:function(){if(this.filter&&this.elements._popup){var j=this.filter.filterModel;if(!j){this.clearFilterViewContent();return}if(this._firstConditionContainer&&j.condition1){this._firstConditionChooser.value=j.condition1.type;this._firstConditionEditor.value=j.condition1.filter}if(this._operatorChooser&&j.operator){this._operatorChooser.value=j.operator}if(this._secondConditionContainer&&j.condition2){this._secondConditionChooser.value=j.condition2.type;this._secondConditionEditor.value=j.condition2.filter}}},buildFilterModelFromView:function(){if(!this._firstConditionContainer){return this.filter&&this.filter.filterModel}if(this._firstConditionEditor.value===""){return{}}var j={condition1:{type:this._firstConditionChooser.value,filter:this._firstConditionEditor.value}};if(this._secondConditionContainer&&this._secondConditionEditor.value!==""){j.operator=this._operatorChooser.value[0];j.condition2={type:this._secondConditionChooser.value,filter:this._secondConditionEditor.value}}return j}});return g});define("DS/DataGridView/DataGridViewFilterViewManager",["DS/Core/BaseComponent","DS/DataGridView/DataGridViewStringRegExpFilterView","DS/DataGridView/DataGridViewSetFilterView"],function(a,e,b){var c=function(i,h){var g=0;var f=this._listOfFilterViews[i];if(!h){if(f){f.destroy();this._listOfFilterViews[i]=undefined;delete this._listOfFilterViews[i]}return 0}if(f!==undefined){if(f.filterId===h.filterId){f.refreshView();return 3}f.destroy();this._listOfFilterViews[i]=undefined;delete this._listOfFilterViews[i];g=1}var j=this.FILTERVIEWS_MAP[h.filterId];if(!j){console.log("No filter view has been registered for id ",h.filterId);return 0}this._listOfFilterViews[i]=new j({filterViewManager:this,propertyId:i,filterId:h.filterId,filter:h});return 1+g};var d=a.inherit({name:"datagridviewfilterviewmanager",publishedProperties:{view:{defaultValue:undefined,type:"object",readOnly:true},filterManager:{defaultValue:undefined,type:"object"}},registerFilterView:function(g,f){this.FILTERVIEWS_MAP[g]=f},refreshFilterViews:function(){if(!this.filterManager){return}var h=this;var f=Object.keys(this._listOfFilterViews);var g=this.filterManager.getFilters();var i=Object.keys(g);i.forEach(function(j){c.call(h,j,g[j]);var k=f.indexOf(j);if(k!==-1){f.splice(k,1)}});f.forEach(function(j){h._listOfFilterViews[j].destroy();delete h._listOfFilterViews[j]})},getFilterViews:function(){return this._listOfFilterViews},isEmpty:function(){var f=this;return Object.keys(this._listOfFilterViews).every(function(g){return !f._listOfFilterViews[g].filter||f._listOfFilterViews[g].filter.isEmpty()})},disableUpdateView:function(){this._preventUpdateView++},enableUpdateView:function(){this._preventUpdateView--},_build:function(){this.FILTERVIEWS_MAP={stringRegexp:e,set:b,numberComparator:null};this._listOfFilterViews={};this._onFilterModelChangeToken=undefined;this._preventUpdateView=0},_applyFilterManager:function(g){if(this._onFilterModelChangeToken&&g){g.unsubscribe(this._onFilterModelChangeToken)}if(this.filterManager){var h=this;this._onFilterModelChangeToken=this.filterManager.subscribe("filterModelChange",function f(i){if(h._preventUpdateView>0){return}if(i){c.call(h,i.propertyId,i.filter)}else{h.refreshFilterViews()}});this.refreshFilterViews()}},_applyProperties:function(f){this._parent(f);if(this.isDirty("filterManager")){this._applyFilterManager(f.filterManager)}}});return d});define("DS/DataGridView/DataGridViewContextualMenuBuilder",["DS/Utilities/Dom","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Toggle","DS/Controls/Button","DS/Controls/SpinBox","DS/DataGridView/DataGridViewCustomViewsDialog","i18n!DS/DataGridView/assets/nls/translation"],function(b,a,d,g,f,e,h,i){var c=function(j){this._collectionView=j;this._supportedMenus=["pin","sizeColumnToFit","firstColumnsVisibility","columnsManagement","insertRow"]};c.prototype.buildMenu=function(n,k){if(!this._collectionView){console.log("A collection view is mandatory to build its contextual menu");return[]}var j={pin:true,firstColumnsVisibility:true,columnsManagement:true,sizeColumnToFit:true,insertRow:false};k=UWA.extend(j,k);var l=this;var m=[];this._supportedMenus.forEach(function(p){if(k[p]===true){var q=p.substring(0,1).toUpperCase()+p.substring(1,p.length);var o="_create"+q+"ContextualMenu";var r=l[o](n);if(r.length>0&&m.length>0){m.push({type:"SeparatorItem",title:""})}m=m.concat(r)}});return m};c.prototype.showCustomViewsDialog=function(){if(!this._customViewsDialog){this._customViewsDialog=new h({identifier:this._collectionView.identifier+"_CustomViewsDialog",dataGridView:this._collectionView})}this._customViewsDialog.loadCustomViews();this._customViewsDialog.immersiveFrame=this._collectionView.getContainingImmersiveFrame();this._customViewsDialog.visibleFlag=true};c.prototype._createPinContextualMenu=function(n){var k=this;var m=[];if(n.cellInfos&&(n.cellInfos.rowID<=-1)){var j;var o;if(n.cellInfos.rowID===-1){j=this._collectionView.layout.getColumnPinned(n.cellInfos.columnID)}else{o=k._collectionView.layout.getColumnOrGroupFromCoordinates({rowID:n.cellInfos.rowID,columnID:n.cellInfos.columnID});j=this._collectionView.layout.getColumnOrGroupPinned(o)}var l=[];l.push({type:"RadioItem",title:i.ContextualMenuBuilder.PinLeft,state:(j==="left")?"selected":"unselected",action:{callback:function(p){if(o){k._collectionView.layout.setColumnOrGroupPinned(o,"left",{isUserInteraction:true})}else{k._collectionView.layout.setColumnPinned(n.cellInfos.columnID,"left",{isUserInteraction:true})}}}});l.push({type:"RadioItem",title:i.ContextualMenuBuilder.PinRight,state:(j==="right")?"selected":"unselected",action:{callback:function(p){if(o){k._collectionView.layout.setColumnOrGroupPinned(o,"right",{isUserInteraction:true})}else{k._collectionView.layout.setColumnPinned(n.cellInfos.columnID,"right",{isUserInteraction:true})}}}});l.push({type:"RadioItem",title:i.ContextualMenuBuilder.NoPin,state:((j!=="left")&&(j!=="right"))?"selected":"unselected",action:{callback:function(p){if(o){k._collectionView.layout.setColumnOrGroupPinned(o,"unpinned",{isUserInteraction:true})}else{k._collectionView.layout.setColumnPinned(n.cellInfos.columnID,"unpinned",{isUserInteraction:true})}}}});m.push({type:"PushItem",title:i.ContextualMenuBuilder.PinMenu,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-pin"},submenu:l})}return m};c.prototype._createFirstColumnsVisibilityContextualMenu=function(m){var k=[];var s=m.cellInfos&&(m.cellInfos.rowID===-1);if(!s&&m.infos&&m.infos.target){s=b.firstParentWithClass(m.infos.target,"wux-layouts-header")}if(s){var l=undefined;var p=undefined;var n=this._collectionView.layout;var q=n.getLeafColumns();for(var r=0;r<q.length&&r<8;r++){l=q[n._orderedColumnsIndexes[r]];var j=n.getColumnVisibleFlag(l.dataIndex)?"selected":"unselected";k.push({type:"CheckItem",title:l.text,icon:l.icon,state:n.getColumnAlwaysVisibleFlag(l.dataIndex)?"disabled|"+j:j,action:{callback:function o(u){if(u&&u.context&&u.context.id){var t=n.getColumnVisibleFlag(u.context.id);n.setColumnVisibleFlag(u.context.id,!t,{isUserInteraction:true})}},context:{id:l.dataIndex}}})}}return k};c.prototype._createColumnsManagementContextualMenu=function(m){var k=this;var l=[];var j=m.cellInfos&&(m.cellInfos.rowID===-1);if(!j&&m.infos&&m.infos.target){j=b.firstParentWithClass(m.infos.target,"wux-layouts-header")}if(j){l.push({type:"PushItem",title:i.ContextualMenuBuilder.CustomViews,action:{callback:function(n){k.showCustomViewsDialog()}}})}return l};c.prototype._createSizeColumnToFitContextualMenu=function(l){var k=[];var j=l.cellInfos&&(l.cellInfos.rowID===-1);if(!j&&l.infos&&l.infos.target){j=b.firstParentWithClass(l.infos.target,"wux-layouts-header")}if(j&&l.cellInfos){k.push({type:"PushItem",title:i.ContextualMenuBuilder.SizeToFit,state:this._collectionView.layout.getColumnResizableFlag(l.cellInfos.columnID)===false?"disabled":"",action:{context:{cellInfos:l.cellInfos},callback:function(q){if(q&&q.context&&q.context.cellInfos){var m=q.context.cellInfos.manager;var p=m.layout;var n=p.getColumnOrGroupFromCoordinates(q.context.cellInfos);var o;if(n){o=p.getLastLeafColumnIndex(n)}else{o=q.context.cellInfos.columnID}var r=p.getLeafColumns();if(m&&o>=0&&o<r.length){m.sizeColumnToFit(o,{isUserInteraction:true})}}}}});k.push({type:"PushItem",title:i.ContextualMenuBuilder.SizeAllToFit,action:{context:{cellInfos:l.cellInfos},callback:function(n){if(n&&n.context&&n.context.cellInfos){var m=n.context.cellInfos.manager;m.sizeAllColumnsToFit({isUserInteraction:true})}}}})}return k};c.prototype._createInsertRowContextualMenu=function(l){var k=[];var j=l.cellInfos&&(l.cellInfos.rowID<=-1);if(j){return k}var m=function(t,n){if(t&&t.context&&t.context.cellInfos){var o=t.context.cellInfos.manager;var p=o.getTreeDocument();p.prepareUpdate();var q=new d();var r=t.context.cellInfos.nodeModel._getLocalID();t.context.cellInfos.nodeModel.getParent().addChild(q,(n==="before")?r:r+1);p.pushUpdate();var s=q._getRowID();o.insertRowCallback(q,s,l.cellInfos);o.ensureNodeModelVisible(q,true);o._flashEffectOnRow("ui-modified",s)}};k.push({type:"PushItem",title:i.ContextualMenuBuilder.InsertRowBefore,action:{context:{cellInfos:l.cellInfos},callback:function(n){m(n,"before")}}});k.push({type:"PushItem",title:i.ContextualMenuBuilder.InsertRowAfter,action:{context:{cellInfos:l.cellInfos},callback:function(n){m(n,"after")}}});return k};return c});define("DS/DataGridView/DataGridViewTreeNodeCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Utils","DS/Utilities/Dom","DS/Core/PointerEvents"],function(c,e,i,f,a,d){var b={};function h(j){return j.charAt(0).toUpperCase()+j.slice(1)}var g=i.inherit({name:"DataGridViewTreeNodeCell",publishedProperties:{nodeModel:{defaultValue:null,type:"object",category:"Model"},readOnly:{defaultValue:true,type:"boolean",category:"Model"},height:{defaultValue:38,type:"integer",category:"Appearance"},buildLinks:{defaultValue:true,type:"boolean",category:"Appearance"},showIconsFlag:{defaultValue:true,type:"boolean"},flatTreeFlag:{defaultValue:false,type:"boolean"}},_applyNodeModel:function(j){var k=this.nodeModel;if(k){this.__applyExpanderState(k.getState());this.__applyDepth(k.getNodeDepth());this.__applyIcons(k.getIcons())}},_applyReadOnly:function(j){if(this._reusableContent){this._reusableContent.readOnly=this.readOnly}},_applyHeight:function(j){this.elements.container.style.height=this.height+"px"},_applyShowIconsFlag:function(j){if(this.showIconsFlag){this.elements.iconsContainer.show()}else{this.elements.iconsContainer.hide()}},_applyFlatTreeFlag:function(j){if(!this.isDirty("nodeModel")&&this.nodeModel){this.__applyDepth(this.nodeModel.getNodeDepth())}if(this.flatTreeFlag){this.elements.expanderContainer.hide()}else{this.elements.expanderContainer.show()}},_applyProperties:function(j){if(this.isDirty("nodeModel")){this._applyNodeModel(this.nodeModel)}if(this.isDirty("readOnly")){this._applyReadOnly(j.readOnly)}if(this.isDirty("height")){this._applyHeight(this.height)}if(this.isDirty("showIconsFlag")){this._applyShowIconsFlag(j.showIconsFlag)}if(this.isDirty("flatTreeFlag")){this._applyFlatTreeFlag(j.flatTreeFlag)}this._parent(j)},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-tree-node-cell");this.getContent().classList.add("wux-tree-treelistview")},buildView:function(){this.elements.linksContainer=new c.Element("div",{"class":"wux-layouts-treeview-links"}).inject(this.elements.container);this.elements.expanderContainer=new c.Element("div",{"class":"wux-layouts-treeview-expander"}).inject(this.elements.container);this.elements.iconsContainer=new c.Element("div",{"class":"wux-layouts-treeview-icons"});this.elements.iconsContainer.hide();this.elements.iconsContainer.inject(this.elements.container);this.elements.tweakerContainer=new c.Element("div",{"class":"wux-layouts-datagridview-tweaker-container"}).inject(this.elements.container);this.__observeEvents()},_getContentContainer:function(){return this.elements.tweakerContainer},__observeEvents:function(){var l=this.nodeModel;var k=this;function j(n){if(n.type==="touchend"){n.preventDefault()}if(n.which===1||n.type==="touchend"){if(k.nodeModel.getChildren()){if(k.nodeModel._expandState!=="noExpandState"&&k.nodeModel._expandState!=="expandingState"){if(k.nodeModel.isExpanded()&&k.nodeModel._expandState!=="partiallyExpandedState"){k.nodeModel.collapse()}else{k.__applyExpanderState("expandingState");k.nodeModel.expand()}}}}}this.elements.expanderContainer.addEvent(d.POINTERUP,j);var m=function(n){n.stopPropagation();n.preventDefault()};this.elements.expanderContainer.addEventListener("contextmenu",m);this.elements.expanderContainer.addEventListener(d.LONGHOLD,m)},__applyDepth:function(u){var y=this.nodeModel;var k=this.elements;if(u===undefined){u=y.getParents().length}var n=this.flatTreeFlag?0:(this._getCurrentTouchMode()?25:18);var x=25;this.elements.linksContainer.setStyle("margin-left",n);var l=x*u;if(this.buildLinks){var m=y.isLastChild();var s='" data-islastchild="'+(m?"true":"false");var v=y.getParent();var w=v&&v.isLastChild();var z=[y];for(var r=1;r<u;r++){var o=z[0];z.unshift(o?o.getParent():undefined)}var t,p,A;var q="<span>";for(t=0;t<u;t++){p=((t<=u-2)&&(z[t]&&z[t].isLastChild()))?"border-color:transparent":"";A=((t===u-1)&&m)?"50%":"100%";q=q+'<li class="wux-layouts-treeview-link" data-parentislastchild="'+((w&&t<=u-1)?"true":"false")+s+'" data-depth="'+(t+"/"+(u-1))+'" style="'+p+";height: "+A+";margin-right:"+(((t===u-1)?0:x)-1)+"px;margin-left:"+(t===0?x:0)+'px"></li>'}q=q+"</span>";k.linksContainer.innerHTML=u>0?q:""}k.linksContainer.setStyle("width",l);this._nodeOffsetX=l+n+2;k.container.setAttribute("data-node-depth",u)},__applyExpanderState:function(j){if(j){this.elements.expanderContainer.setAttribute("data-wux-state",j)}},__applyLabel:function(j){if(typeof j==="number"){j=j.toString()}if(this._reusableContent){this._reusableContent.disableEvents();this._reusableContent.value=j;this._reusableContent.enableEvents()}},__applyIcons:function(l){var m=this;if(l){if(l instanceof Array){if(l){var j=c.equals(this._icons,l);if(!j){this._icons=c.clone(l);this.elements.iconsContainer.removeAttribute("wux-icon-name");this.elements.iconsContainer.getChildren().forEach(function(n){if(n.hasClassName("wux-layouts-treeview-icon")){n.remove()}});if(l){var k=document.createDocumentFragment();l.forEach(function(o,n){var p=m.__buildIcon(o);k.appendChild(p)});this.elements.iconsContainer.appendChild(k)}}}}if(typeof l==="string"){if(this.elements.iconsContainer.getChildren()){this.elements.iconsContainer.getChildren().forEach(function(n){if(n.hasClassName("wux-layouts-treeview-icon")){n.remove()}})}m.__addIcon(l,"css")}}else{this.elements.iconsContainer.removeAttribute("wux-icon-name");this.elements.iconsContainer.getChildren().forEach(function(n){if(n.hasClassName("wux-layouts-treeview-icon")){n.remove()}})}},__addIcon:function(k,j){var l=this.__buildIcon(k,j);l.inject(this.elements.iconsContainer)},__buildIcon:function(k,j){var l=a.createElement("div",{"class":"wux-layouts-treeview-icon"});switch(j){case"css":l.setAttribute("icon-type","css");l.setAttribute("wux-icon-name",k);break;default:if(typeof k==="string"){l.setAttribute("icon-type","css")}a.generateIcon(k,{target:l});break}return l},computeContentSize:function(){var j=this.elements.expanderContainer.offsetWidth+3;var m=this.elements.iconsContainer.offsetWidth;var k=this._nodeOffsetX+j+m;var l=this._getReusableContent();if(l&&l.computeContentSize){k+=l.computeContentSize()}return Math.ceil(k)},getFontSize:function(){var j=window.getComputedStyle(this.getContent(),null).getPropertyValue("font-size");return parseFloat(j)},getFontFamily:function(){return"arial"}});return g});define("DS/DataGridView/DataGridViewColumnHeaderCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Utils","DS/Utilities/Dom"],function(f,d,e,c,a){var b=e.inherit({name:"DataGridViewColumnHeaderCell",publishedProperties:{},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-column-header-cell")},buildView:function(){this.elements.tweakerContainer=new f.Element("div",{"class":"wux-layouts-datagridview-tweaker-container"}).inject(this.elements.container);this.elements.iconsContainer=new f.Element("div",{"class":"wux-layouts-datagridview-column-header-icons"}).inject(this.elements.container)},_getContentContainer:function(){return this.elements.tweakerContainer},});return b});define("DS/DataGridView/RowModelClientSide",["DS/DataGridView/RowModelBase","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewFilterViewManager","i18n!DS/DataGridView/assets/nls/translation","DS/Utilities/StringUtils"],function(d,a,e,c,f){var b=d.inherit({name:"RowModelClientSide",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},treeDocument:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"},},_applyProperties:function(g){this._parent(g);if(this.isDirty("treeDocument")){this._applyTreeDocument(g.treeDocument)}if(this.isDirty("sortModel")){this._applySortModel(g.sortModel)}},getFilterViewManager:function(){if(!this._filterViewManager){this._filterViewManager=new e({view:this})}return this._filterViewManager},_getTreeDocument:function(){return this.treeDocument},getVisibleNodeModel:function(h){var g=this.dataGridView;return g.model[h]},_isModelBeingFetched:function(){return false},_applyTreeDocument:function(j){if(!this.treeDocument){return}this._listenToTreeDocument();var l=this;var i=this.dataGridView;var g=this.treeDocument.getFilterManager();if(g){if(!this._filterViewManager){this._filterViewManager=new e({view:this.dataGridView,filterManager:g})}else{this._filterViewManager.filterManager=g}}var k=true;var h=function(){l._mustRedrawColumnHeaders=true;var m=l.getFilterViewManager();if(m.isEmpty()){if(!k){i.enableRowReordering()}k=true}else{if(k){i.disableRowReordering()}k=false}};l.treeDocument.addModelEventListener("filter",h)},_applySortModel:function(g){var s=this.dataGridView;var p=this;if(!s._isCurrentlyCalledFromUIInteraction()){p._originalSortModel=p.sortModel}if(!p.sortModel){return}if(p.sortModel.length>0&&(!g||g.length===0)){s.disableRowReordering()}else{if(p.sortModel.length===0&&g&&g.length>0){s.enableRowReordering()}}if(p.sortModel.length>0){var j=p.treeDocument;if(j){var n=s.layout;var l=[];for(var k=0;k<p.sortModel.length;k++){var o=p.sortModel[k].dataIndex;var m=n.getColumnIndex(o);if(m>-1){var h=n.getColumnCompareFunction(m);if(!h){if(!h){h=function(u,t,w,v,i){if((typeof u==="string")&&(typeof t==="string")){return f.compareLocal(u,t)}else{if(u===t){return 0}else{if(u>t){return 1}else{if(u<t){return -1}else{if((u===undefined)&&(t!==undefined)){return 2}else{return -2}}}}}}}}var q=(p.sortModel[k].sort==="desc")?-1:1;l.push({dataIndex:o,compareFunction:h,reverseFactor:q})}s._updateRenderedRowCellsAttributes(-1)}var r=function(z,y){var t=0;var u=0;while((u<l.length)&&(t===0)){var w=l[u];var x=s._getCellValueForSort(z,w.dataIndex);var v=s._getCellValueForSort(y,w.dataIndex);t=w.reverseFactor*w.compareFunction(x,v,z,y,w.dataIndex);u++}if(t===0){return(z._getID()-y._getID())}return t};j._getTrueRoot().sortChildren({isRecursive:true,sortFunction:r})}}},_doGroupingOnModel:function(j){var k=this;var i=k.treeDocument;var g=this.dataGridView;var h=function(){i.prepareUpdate();var o=function(s,u){var q=g.layout.getColumnGetCellValue(u);if(q){var p=g.layout.getColumnIdentifiers(u);var r=g.layout.getCellIDFromCoordinates({rowID:s._getRowID(),columnID:p.columnIndex});var t={cellID:r,columnID:p.columnIndex,rowID:s._getRowID(),nodeModel:s};return q.call(g,t)}return s.getAttributeValue(u)};var m={propertiesToGroup:j.dataIndexesToGroup,getNodeGroupingKey:function(s,u){var q=g.layout.getColumnGetCellGroupingKey(u);if(q){var p=g.layout.getColumnIdentifiers(u);var r=g.layout.getCellIDFromCoordinates({rowID:s._getRowID(),columnID:p.columnIndex});var t=g.getLightCellInfosAt(r);t.nodeModel=s;return q.call(g,t)}return o(s,u)},updateGroupingNodeOptions:function(s){var q=this.getProperty();var r=g.layout.getColumnOptionValue(q,"text");var p={label:(r?r+": ":"")+this.getIdentifier()+" ("+this.getNumberOfOriginalChildren().notHidden+")",grid:{}};if(g.rowGroupingOptions.getGroupingNodeOptions){p.grid=g.rowGroupingOptions.getGroupingNodeOptions.call(g,this,s)}else{g.layout.getLeafColumns().forEach(function(w){var v=g.layout.getColumnOptionValue(w.dataIndex,"getGroupingNodeOptions");if(v){if(typeof(v)==="string"){switch(v){case"sum":var y=0;s.forEach(function(z){y+=parseInt(o(z,w.dataIndex),10)});p.grid[w.dataIndex]=y;break;case"avg":var y=0;s.forEach(function(z){y+=parseInt(o(z,w.dataIndex),10)});p.grid[w.dataIndex]=y/s.length;break;case"min":var x=undefined;s.forEach(function(A){var z=o(A,w.dataIndex);if(x===undefined||z<x){x=z}});p.grid[w.dataIndex]=x;break;case"max":var t=undefined;s.forEach(function(A){var z=o(A,w.dataIndex);if(t===undefined||z>t){t=z}});p.grid[w.dataIndex]=t;break;case"first":p.grid[w.dataIndex]=o(s[0],w.dataIndex);break;case"last":p.grid[w.dataIndex]=o(s[s.length-1],w.dataIndex);break;default:break}}else{var u=[];s.forEach(function(z){u.push(o(z,w.dataIndex))});p.grid[w.dataIndex]=v.call(g,u)}}})}this.updateOptions(p)}};var l=g.rowGroupingOptions.depth;if(l===0){i.groupRoots(m)}else{var n=function(q,r){if(r>=l){q.groupChildren(m);return}var p=q.getChildren();if(p){p.forEach(function(s){n(s,r+1)})}};n(i._getTrueRoot(),0)}k._applySortModel();i.pushUpdate();g.removeModalLoader(c.UpdatingGrouping)};g.displayModalLoader(c.UpdatingGrouping,h)},_findAllCellIDsMatchingFindStr:function(t,h,o){var v=this.dataGridView;var l=v.layout.getVisibleOrderedLeafColumns();if(!o){o=[];this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(i){o.push(i.nodeModel)}})}if(o.length===0){return}for(var p=0;p<o.length;p++){var g=o[p];if(g){for(var q=0;q<l.length;q++){var s=l[q].dataIndex;var r=v.layout.getCellIDFromCoordinates({rowID:g._getRowID(),columnID:v.layout.getColumnIndex(s)});var n=[];var u=v._getCellValueAsStringForFind(v.getCellInfosAt(r),s,l[q].typeRepresentation);if(u){var k=f.toComparable(u.toString(),{toLowerCase:!h});var m=f.toComparable(v.findStr.toString(),{toLowerCase:!h});n=v._getIndexesOfMatchingString(k,m);if(n.length>0){v._matchingFoundArray.push(n);v._matchingCellID.push(r);if(v._matchingNodeModel.indexOf(g)===-1){v._matchingNodeModel.push(g)}}}}}}}});return b});define("DS/DataGridView/DataGridView",["UWA/Core","UWA/Utils/Client","DS/CollectionView/CollectionView","DS/DataGridView/DataGridViewLayout","DS/DataGridView/RowModelClientSide","DS/DataGridView/RowModelServerSide","DS/Core/PointerEvents","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tweakers/TypeRepresentationFactory","DS/DataGridView/DataGridViewRow","DS/DataGridView/DataGridViewCell","DS/DataGridView/DataGridViewColumnHeaderCell","DS/DataGridView/DataGridViewRowHeaderCell","DS/DataGridView/DataGridViewTreeNodeCell","DS/Utilities/Dom","DS/Utilities/Utils","DS/Menu/ContextualMenu","DS/DataGridView/DataGridViewContextualMenuBuilder","DS/Controls/SelectionChips","DS/Tweakers/GeneratedToolbar","DS/CollectionView/edition/CollectionViewEditionOnDoubleClick","DS/CollectionView/edition/CollectionViewEditionOnClick","DS/CollectionView/edition/CollectionViewEditionOnOver","DS/CollectionView/edition/CollectionViewEditionInPlace","DS/Utilities/TouchUtils","DS/Controls/ModalContainer","DS/Controls/Loader","UWA/Class/Promise","i18n!DS/DataGridView/assets/nls/translation","i18n!DS/Controls/assets/nls/translation","DS/DataGridView/DataGridViewFilterViewManager","DS/Utilities/TreeUtils","DS/DataGridView/ModelMassUpdateDialog"],function(e,C,I,ab,h,i,l,K,D,w,U,O,a,p,E,H,Q,r,n,t,W,q,N,B,g,G,M,aa,A,m,L,o,Y,v){var ae=false;var R="wux-ui-state-drag-over";var d=C.Engine;var k;var j=4;var z=false;var b=false;var y,X;function Z(al,ak){var ak=ak||al.target||al.srcElement,aj=ak.getBoundingClientRect(),ai=(al.clientX)?al.clientX-aj.left:0,am=(al.clientY)?al.clientY-aj.top:0;return{offsetX:ai,offsetY:am}}function ac(ak,ai){if(window.notifs){var aj={level:"info",title:m[ak],message:m[ai],sticky:false};window.notifs.addNotif(aj)}}function ad(aj){if(aj[aj.length-1]==="\n"){aj=aj.slice(0,aj.length-2)}var ak=aj.split("\n");for(var ai=0;ai<ak.length;ai++){ak[ai]=ak[ai].split("\t")}return ak}function V(aj){var ai=undefined;if(typeof aj.cellModel==="object"){if(aj.cellModel instanceof Date){ai=aj.cellModel.toLocaleDateString()}else{ai=JSON.stringify(aj.cellModel)}}else{if(typeof aj.cellModel==="string"){ai=aj.cellModel}else{if(aj.cellModel!==undefined){ai=aj.cellModel.toString()}}}if(this.layout.getColumnAllowUnsafeHTMLContent(aj.columnID)){var ak=e.createElement("div");ak.innerHTML=ai;ai=ak.innerText}return ai}function T(ak,ai){var aj=undefined;if(typeof ak.cellModel==="object"&&ak.cellModel!==null){if(ak.cellModel instanceof Date){aj=new Date(ai)}else{aj=JSON.parse(ai)}}else{aj=ai}return aj}function af(ak,ai){var aj;if(ai==="tree"){aj=ak.options.label}else{aj=ak.options.grid[ai]}return aj}function J(ak,ai,al,aj){if(!this._rowReorderDnDInfos.elements.line){this._rowReorderDnDInfos.elements.line=new e.Element("div",{"class":"wux-datagridview-drag-row-feedback",styles:{top:ak,height:ai,background:aj?"#368ec4":"#844138"}});this._rowReorderDnDInfos.elements.chip=new e.Element("div",{"class":"wux-datagridview-drag-row-feedback-chip",styles:{display:(ai>2||al===-1)?"none":"block",left:al,background:aj?"#368ec4":"#844138"}}).inject(this._rowReorderDnDInfos.elements.line);this._rowReorderDnDInfos.elements.line.inject(this.getContent())}else{this._rowReorderDnDInfos.elements.line.setStyles({display:"block",top:ak,height:ai,background:aj?"#368ec4":"#844138"});this._rowReorderDnDInfos.elements.chip.setStyles({display:(ai>2||al===-1)?"none":"block",left:al,background:aj?"#368ec4":"#844138"})}}function u(){if(this._rowReorderDnDInfos.elements.line){this._rowReorderDnDInfos.elements.line.hide()}}function c(ar,av){var ai=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(!ai){return false}var an=0,at=0;var au=av.cellView.getContent().getBoundingClientRect();if(av.nodeModel.acceptNodeDropAt(ai.node,0)){an=au.top+au.height/3;at=au.top+2*au.height/3}else{an=at=au.top+au.height/2}var ao=0;var aw=0;var ak=0;if(ar.clientY<an){this._rowReorderDnDInfos.direction=-1;aw=2;ak=this.layout.getRowPosition(av.rowID)}else{if(ar.clientY>=at){this._rowReorderDnDInfos.direction=1;aw=2;if(av.rowID<this.model.length-1){ak=this.layout.getRowPosition(av.rowID+1)}else{ak=this.layout.getRowPosition(av.rowID)+au.height}}else{this._rowReorderDnDInfos.direction=0;aw=au.height;ak=this.layout.getRowPosition(av.rowID)}}ao=this.layout.getHeaderContainerHeight()+ak-this.getScrollerPosition().y;var am=this.layout.getColumnIndex("tree");var aj=-1;if(am!==undefined){var al=this.layout.getCellIDFromCoordinates({rowID:av.rowID,columnID:am});var aq=this._getViewAt(al);if(aq){var ap=aq.elements.linksContainer.getBoundingClientRect();aj=ap.right}}this._rowReorderDnDInfos.dropAccepted=av.nodeModel.acceptNodeDropAt(ai.node,this._rowReorderDnDInfos.direction);J.call(this,ao,aw,aj,this._rowReorderDnDInfos.dropAccepted);return this._rowReorderDnDInfos.dropAccepted}function s(aq,ar){var ak=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(!ak||ak.source!==this._uuid){return false}var am=this.getDraggedRowData(aq);if(am&&am.rowID!==ar.rowID){var av=-1;var at="";if(this._rowReorderDnDInfos.dropAccepted){var an=ar.nodeModel.getTreeDocument();an.prepareUpdate();this.prepareUpdateView();var ai=an.getUseChangeTransactionMode();an.setUseChangeTransactionMode(false);var au=null;var ap=undefined;if(this._rowReorderDnDInfos.direction!==0){au=ar.nodeModel.getParent();var ao=ar.nodeModel._getLocalID();var al=ar.nodeModel._getRowID();ap=ao+(this._rowReorderDnDInfos.direction===1?1:0)+(au===ak.node.getParent()&&am.rowID<al?-1:0)}else{au=ar.nodeModel}var aj=ak.node;au.moveChild(aj,ap);if(au.getChildren().length===1){au.expand();an.pushUpdate();av=aj._getRowID()}else{an.pushUpdate();if(au.isExpanded()||au._isTrueRoot()){av=aj._getRowID()}else{av=au._getRowID()}}this.pushUpdateView({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true},true);at="ui-modified";an.setUseChangeTransactionMode(ai)}else{av=am.rowID;at="ui-notmodified"}this._flashEffectOnRow(at,av)}return true}function P(ak,ai){var am={},al={},aj;aj=ai.offsetParent;am.x=ak.touches?ak.touches[0].pageX:ak.pageX;am.y=ak.touches?ak.touches[0].pageY:ak.pageY;al.left=ai.offsetLeft;al.top=ai.offsetTop;while(aj){al.left+=aj.offsetLeft;al.top+=aj.offsetTop;aj=aj.offsetParent}return{x:am.x-al.left,y:am.y-al.top}}function ag(ak){var aj=this;var ai={x:ak.x,y:ak.y};this._autoScrollInfos.interval=setInterval(function(){ai.x+=aj._autoScrollInfos.moveX;ai.y+=aj._autoScrollInfos.moveY;aj.setScrollerPosition(ai)},20)}function x(){if(this._autoScrollInfos.interval!==null){clearInterval(this._autoScrollInfos.interval);this._autoScrollInfos.interval=null}}function F(ak){var am=this._getScroller().getContent();var aj=P(ak,am);var al=this.getScrollerPosition();this._autoScrollInfos.moveY=0;if(aj.x>=-this._leftContainerWidth&&aj.x<=am.clientWidth+this._rightContainerWidth&&aj.y>=0&&aj.y<=am.clientHeight){var ai=50;if(aj.y<ai&&al.y!==0){this._autoScrollInfos.moveY=aj.y-ai}else{if(am.clientHeight-ai<aj.y&&am.clientHeight+al.y!==am.scrollHeight){this._autoScrollInfos.moveY=aj.y-(am.clientHeight-ai)}}}if(this._autoScrollInfos.moveY!==0&&this._autoScrollInfos.interval===null){ag.call(this,al)}else{if(this._autoScrollInfos.moveY===0){x.call(this)}}return this._autoScrollInfos.moveY!==0}var S=new w();var ah=I.inherit({name:"dataGridView",publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:true,category:"Behavior"},treeDocument:{defaultValue:null,type:"object"},dataSource:{defaultValue:null,type:"object"},cellSelection:{defaultValue:"multiple",type:"string"},defaultColumnDef:{defaultValue:{description:"",typeRepresentation:"string",getCellTypeRepresentation:function(aj){var ai=this.layout;if(ai){return ai.getColumnTypeRepresentation(aj.columnID)}return"string"},width:"auto",minWidth:40,autoRowHeightFlag:false,visibleFlag:true,editableFlag:false,editionPolicy:"EditionOnDoubleClick",resizableFlag:true,sortableFlag:true,groupableFlag:true,massUpdateAllowedFlag:true,pinned:"unpinned",autoSizePadding:0,allowUnsafeHTMLContent:false,shouldCellAllowUnsafeHTMLContentAt:function(aj){var ai=this.layout;if(ai){return ai.getColumnAllowUnsafeHTMLContent(aj.columnID)}return false},allowResetToUndefinedByUIFlag:false},type:"object"},columns:{defaultValue:[],type:"array"},sortModel:{defaultValue:null,type:"array"},layout:{defaultValue:null,type:"object"},cellClass:{defaultValue:O,type:"object"},rowGroupingOptions:{defaultValue:{depth:0,hideGroupedColumns:true,getGroupingNodeOptions:null},type:"object"},onContextualEvent:{defaultValue:function f(aj){var ai=[];if(aj&&aj.collectionView){ai=aj.collectionView.buildDefaultContextualMenu(aj)}return ai},type:"function"},rowReorderEnabledFlag:{defaultValue:true,type:"boolean",noNeedToApplyFlag:true},rowGroupingEnabledFlag:{defaultValue:true,type:"boolean",noNeedToApplyFlag:true},columnDragEnabledFlag:{defaultValue:true,type:"boolean"},onDragStartColumnHeader:{defaultValue:undefined,type:"function"},onDragEndColumnHeader:{defaultValue:undefined,type:"function"},onDragEnterColumnHeader:{defaultValue:undefined,type:"function"},onDragLeaveColumnHeader:{defaultValue:undefined,type:"function"},onDragColumnHeader:{defaultValue:undefined,type:"function"},onDragOverColumnHeader:{defaultValue:undefined,type:"function"},onDropColumnHeader:{defaultValue:undefined,type:"function"},rowDragEnabledFlag:{defaultValue:false,type:"boolean"},onDragStartRowHeader:{defaultValue:undefined,type:"function"},onDragEndRowHeader:{defaultValue:undefined,type:"function"},onDragEnterRowHeader:{defaultValue:undefined,type:"function"},onDragLeaveRowHeader:{defaultValue:undefined,type:"function"},onDragRowHeader:{defaultValue:undefined,type:"function"},onDragOverRowHeader:{defaultValue:undefined,type:"function"},onDropRowHeader:{defaultValue:undefined,type:"function"},cellDragEnabledFlag:{defaultValue:false,type:"boolean"},onDragStartCell:{defaultValue:undefined,type:"function"},onDragEndCell:{defaultValue:undefined,type:"function"},onDragEnterCell:{defaultValue:undefined,type:"function"},onDragLeaveCell:{defaultValue:undefined,type:"function"},onDragCell:{defaultValue:undefined,type:"function"},onDragOverCell:{defaultValue:undefined,type:"function"},onDropCell:{defaultValue:undefined,type:"function"},onDragStartBlank:{defaultValue:undefined,type:"function"},onDragEndBlank:{defaultValue:undefined,type:"function"},onDragEnterBlank:{defaultValue:undefined,type:"function"},onDragLeaveBlank:{defaultValue:undefined,type:"function"},onDragBlank:{defaultValue:undefined,type:"function"},onDragOverBlank:{defaultValue:undefined,type:"function"},onDropBlank:{defaultValue:undefined,type:"function"},focusNextEditableCellOnTabFlag:{defaultValue:false,type:"boolean",noNeedToApplyFlag:true},showCellActivationFlag:{defaultValue:true,type:"boolean"},showCellPreselectionFlag:{defaultValue:true,type:"boolean"},showEditableFeedbackFlag:{defaultValue:true,type:"boolean"},showRequiredFeedbackFlag:{defaultValue:true,type:"boolean"},showRowBorderFlag:{defaultValue:false,type:"boolean"},showModelChangesFlag:{defaultValue:false,type:"boolean"},showAlternateBackgroundFlag:{defaultValue:true,type:"boolean"},showRowIndexFlag:{defaultValue:true,type:"boolean"},showSelectionCheckBoxesFlag:{defaultValue:"OnOver",type:"string"},showOutlineFlag:{defaultValue:false,type:"boolean"},showRowHeaderBackgroundFlag:{defaultValue:true,type:"boolean"},showTreeIconsFlag:{defaultValue:true,type:"boolean"},showNodeKPIColorFlag:{defaultValue:false,type:"boolean"},placeholder:{defaultValue:m.NoObjectsFound,type:"string"},getCellTooltip:{defaultValue:null,type:"function",noNeedToApplyFlag:false}},_preBuild:function(){this._editionManagers=[];this._useClipboardFlag=true;this._properties.layout.value=new ab();this._contextualMenuBuilder=new n(this);this._selectAllCheckBoxListenChange=true;this._hasFlatTreeState=true;this._tweakerToGenerateCount=0;this._inOnAllCellsRendered=false;this._resetRowHeightsOnAllCellsRenderedFlag=false;this._modelMassUpdateDialog=null;this._parent();this.getContent().classList.add("wux-layouts-datagridview");this.elements.rowHeaderExtension=new e.Element("div",{"class":"wux-datagridview-layouts-row-header-extension"}).inject(this.elements.container);this._rowReorderDnDInfos={elements:{line:null,chip:null},direction:-1,dropAccepted:false};this._disableRowReorderCpt=0;this._autoScrollInfos={interval:null,moveX:0,moveY:0}},_applyProperties:function(ai){this._parent(ai);if(this.isDirty("dataSource")){this._applyDataSource(ai.dataSource)}if(this.isDirty("treeDocument")){this._applyTreeDocument(ai.treeDocument)}if(this.isDirty("defaultColumnDef")){this._applyDefaultColumnDef(ai.defaultColumnDef)}if(this.isDirty("layout")){this._applyLayout(ai.layout)}if(this.isDirty("columns")){this._applyColumns(ai.columns)}if(this.isDirty("sortModel")){this._applySortModel(ai.sortModel)}if(this.isDirty("columnDragEnabledFlag")){this._applyColumnDragEnabledFlag(ai.columnDragEnabledFlag)}if(this.isDirty("rowDragEnabledFlag")){this._applyRowDragEnabledFlag(ai.rowDragEnabledFlag)}if(this.isDirty("cellDragEnabledFlag")){this._applyCellDragEnabledFlag(ai.cellDragEnabledFlag)}if(this.isDirty("showCellActivationFlag")){this._applyShowCellActivationFlag(ai.showCellActivationFlag)}if(this.isDirty("showCellPreselectionFlag")){this._applyShowCellPreselectionFlag(ai.showCellPreselectionFlag)}if(this.isDirty("showEditableFeedbackFlag")){this._applyShowEditableFeedbackFlag(ai.showEditableFeedbackFlag)}if(this.isDirty("showRequiredFeedbackFlag")){this._applyShowRequiredFeedbackFlag(ai.showRequiredFeedbackFlag)}if(this.isDirty("showRowBorderFlag")){this._applyShowRowBorderFlag(ai.showRowBorderFlag)}if(this.isDirty("showAlternateBackgroundFlag")){this._applyShowAlternateBackgroundFlag(ai.showAlternateBackgroundFlag)}if(this.isDirty("showRowIndexFlag")){this._applyShowRowIndexFlag(ai.showRowIndexFlag)}if(this.isDirty("showSelectionCheckBoxesFlag")){this._applyShowSelectionCheckBoxesFlag(ai.showSelectionCheckBoxesFlag)}if(this.isDirty("showOutlineFlag")){this._applyShowOutlineFlag(ai.showOutlineFlag)}if(this.isDirty("showRowHeaderBackgroundFlag")){this._applyShowRowHeaderBackgroundFlag(ai.showRowHeaderBackgroundFlag)}if(this.isDirty("showTreeIconsFlag")){this._applyShowTreeIconsFlag(ai.showTreeIconsFlag)}if(this.isDirty("showNodeKPIColorFlag")){this._applyShowNodeKPIColorFlag(ai.showNodeKPIColorFlag)}if(this.isDirty("rowGroupingOptions")){this._applyRowGroupingOptions(ai.rowGroupingOptions)}},_applyTouchMode:function(){this._parent();if(this.touchMode){j=8}else{j=4}},_applyVirtualViewportSize:function(){this._parent();var ai=this.getStatusBarContainerHeight();this.elements.rowHeaderExtension.setStyle("bottom",ai+"px");var ak=this.layout.getLeftContainerWidth();if(ak===0){this.layout.collectionView.elements.leftScrollContainer.setAttribute("empty","");this.layout.collectionView.elements.leftHeaderPoolContainer.setAttribute("empty","");this.layout.collectionView.elements.leftSpacerContainer.setAttribute("empty","")}else{this.layout.collectionView.elements.leftScrollContainer.removeAttribute("empty");this.layout.collectionView.elements.leftHeaderPoolContainer.removeAttribute("empty","");this.layout.collectionView.elements.leftSpacerContainer.removeAttribute("empty","")}var aj=this.layout.getRightContainerWidth();if(aj===0){this.layout.collectionView.elements.rightScrollContainer.setAttribute("empty","");this.layout.collectionView.elements.rightHeaderPoolContainer.setAttribute("empty","");this.layout.collectionView.elements.rightSpacerContainer.setAttribute("empty","")}else{this.layout.collectionView.elements.rightScrollContainer.removeAttribute("empty");this.layout.collectionView.elements.rightHeaderPoolContainer.removeAttribute("empty","");this.layout.collectionView.elements.rightSpacerContainer.removeAttribute("empty","")}},_applyModel:function(ai){this._parent(ai);if(this.layout){this.layout.resetRowHeights()}var aj=this._activeCellStableID;this._updateXSOElements();this._updateActiveCell(aj)},_applyHeight:function(){this._parent();if(this.height!=="inherit"){if(!this.elements.container.style.position||this.elements.container.style.position==="static"){this.elements.container.style.position="relative"}}},_flashEffectOnCell:function(ak,ai){var aj=this._getViewAt(ai);if(aj){aj.getContent().classList.add(ak);aj.getContent().addEventListener("animationend",function(al){al.target.classList.remove(ak)})}},_flashEffectOnRow:function(ao,ak){var al=this.layout;var am=al.getLeafColumns();var ai=am.length;var an=al._leftPinnedRowcolumnID;for(var aj=an;aj<ai;aj++){this._flashEffectOnCell(ao,al.getCellIDFromCoordinates({rowID:ak,columnID:aj}))}},getFilterViewManager:function(){if(this._rowModel){return this._rowModel.getFilterViewManager()}return undefined},_applyDataSource:function(ai){if(this.dataSource&&this._isReady){if(this._rowModel===undefined){this._rowModel=new i({dataGridView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions})}this._rowModel.dataSource=this.dataSource}},_applyTreeDocument:function(ai){if(this.treeDocument){if(this._rowModel===undefined){this._rowModel=new h({dataGridView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions,treeDocument:this.treeDocument})}else{this._rowModel.treeDocument=this.treeDocument}}},hasFlatTreeState:function(){return this._hasFlatTreeState},_applyDefaultColumnDef:function(ai){var aj=this.defaultColumnDef;if(aj.description===undefined){aj.description=""}if(aj.typeRepresentation===undefined){aj.typeRepresentation="string"}if(aj.getCellTypeRepresentation===undefined){aj.getCellTypeRepresentation=function(al){var ak=this.layout;if(ak){return ak.getColumnTypeRepresentation(al.columnID)}return"string"}}if(aj.width===undefined){aj.width="auto"}if(aj.minWidth===undefined){aj.minWidth=40}if(aj.autoRowHeightFlag===undefined){aj.autoRowHeightFlag=false}if(aj.visibleFlag===undefined){aj.visibleFlag=true}if(aj.editableFlag===undefined){aj.editableFlag=false}if(this.defaultColumnDef.editionPolicy===undefined){this.defaultColumnDef.editionPolicy="EditionOnDoubleClick"}if(aj.resizableFlag===undefined){aj.resizableFlag=true}if(aj.sortableFlag===undefined){aj.sortableFlag=true}if(aj.groupableFlag===undefined){aj.groupableFlag=true}if(aj.massUpdateAllowedFlag===undefined){aj.massUpdateAllowedFlag=true}if(aj.pinned===undefined){aj.pinned="unpinned"}if(aj.autoSizePadding===undefined){aj.autoSizePadding=0}if(aj.allowUnsafeHTMLContent===undefined){aj.allowUnsafeHTMLContent=false}if(aj.shouldCellAllowUnsafeHTMLContentAt===undefined){aj.shouldCellAllowUnsafeHTMLContentAt=function(al){var ak=this.layout;if(ak){return ak.getColumnAllowUnsafeHTMLContent(al.columnID)}return false}}if(aj.allowResetToUndefinedByUIFlag===undefined){aj.allowResetToUndefinedByUIFlag=false}},_applyColumns:function(ai){var aj=this.layout;if(aj){aj.columns=this.columns}},_getColumnOrGroup:function(ai,al){var aj;for(var ak=0;ak<ai.length;ak++){var am=ai[ak];if(am){if(am.dataIndex===al){aj=am;break}else{if(am.children){aj=this._getColumnOrGroup(am.children,al);if(aj){break}}}}}return aj},getColumnOrGroup:function(ak){var aj=this.layout;var ai=(typeof ak==="string")?ak:aj.getColumnIdentifiers(ak).dataIndex;return this._getColumnOrGroup(aj._balancedColumnTree,ai)},addColumnOrGroup:function(aj,ai){var ak=this.columns;if(!ak){this.columns=[];ak=this.columns}if(ai===undefined){ai=ak.length}ak.splice(ai,0,aj);this.layout.applyColumns();this._requestDelayedModelData()},_removeColumnOrGroup:function(ai,al){var aj=0;for(var ak=0;ak<ai.length;ak++){var am=ai[ak];if(am){if(am.dataIndex===al){ai.splice(ak,1);am._parent=null;aj=1;break}else{if(am.children){aj=this._removeColumnOrGroup(am.children,al);if(aj){break}}}}}return aj},removeColumnOrGroup:function(ak){var aj=this.layout.getColumnIdentifiers(ak).dataIndex;var ai=this._removeColumnOrGroup(this.columns,aj);if(ai){this.layout.applyColumns()}},_applySortModel:function(ai){if(this._rowModel){if(this.findWidget){this.findWidget.close()}this._rowModel.sortModel=this.sortModel}},_applyLayout:function(ai){this._parent(ai)},_applyColumnDragEnabledFlag:function(ai){},_applyRowDragEnabledFlag:function(ai){this._updateFromRowDragEnabledState();this.invalidateLayout({updateCellContent:true,updateCellLayout:true,updateCellAttributes:false})},_applyCellDragEnabledFlag:function(ai){},_applyShowCellActivationFlag:function(ai){if(this.showCellActivationFlag){this.getContent().setAttribute("show-cell-activation","")}else{this.getContent().removeAttribute("show-cell-activation")}},_applyShowCellPreselectionFlag:function(ai){if(this.showCellPreselectionFlag){this.getContent().setAttribute("show-cell-preselection","")}else{this.getContent().removeAttribute("show-cell-preselection")}},_applyShowEditableFeedbackFlag:function(ai){this.invalidateLayout({updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})},_applyShowRequiredFeedbackFlag:function(ai){this.invalidateLayout({updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})},_applyShowRowBorderFlag:function(ai,aj){if(this.showRowBorderFlag){this.getContent().setAttribute("show-row-border","")}else{this.getContent().removeAttribute("show-row-border")}if(this.layout){this.layout.resetRowHeights()}},_applyShowModelChangesFlag:function(ai){this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})},_applyShowAlternateBackgroundFlag:function(ai){if(this.showAlternateBackgroundFlag){this.getContent().setAttribute("show-alternate-background","")}else{this.getContent().removeAttribute("show-alternate-background")}},_applyShowRowIndexFlag:function(ai){if(this.showRowIndexFlag){this.getContent().setAttribute("show-row-index","")}else{this.getContent().removeAttribute("show-row-index")}this.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},_applyShowSelectionCheckBoxesFlag:function(ai){if(G.getTouchMode()){this.getContent().setAttribute("show-selection-check-boxes",true)}else{if(this.showSelectionCheckBoxesFlag!==false){this.getContent().setAttribute("show-selection-check-boxes",this.showSelectionCheckBoxesFlag)}else{this.getContent().removeAttribute("show-selection-check-boxes")}}this.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},_applyShowOutlineFlag:function(ai){if(this.showOutlineFlag){this.getContent().setAttribute("show-outline","")}else{this.getContent().removeAttribute("show-outline")}},_applyShowRowHeaderBackgroundFlag:function(ai){if(this.showRowHeaderBackgroundFlag){this.getContent().setAttribute("show-row-header-background","")}else{this.getContent().removeAttribute("show-row-header-background")}},_applyShowTreeIconsFlag:function(ai){if(this._isReady){var aj=this.layout.getColumnIndex("tree");if(aj>=0){this._updateRenderedColumn(aj,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}}},_applyShowNodeKPIColorFlag:function(ai){this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})},_updateFromRowDragEnabledState:function(){if(this.rowDragEnabledFlag){this.getContent().setAttribute("row-drag-enabled","")}else{this.getContent().removeAttribute("row-drag-enabled")}},reapplySortModel:function(){if(this._rowModel){this._rowModel._applySortModel(this.sortModel)}},initialize:function(){this._manageCellRequests();if(this.dataSource){this._applyDataSource()}if(this.treeDocument){this._applyTreeDocument()}if(this.sortModel){this.reapplySortModel()}this._applyColumns();this.layout._applyPreferencesOnColumns();this._manageUserInteractions();this._manageDragAndDrop()},destroy:function(){if(this._modelMassUpdateDialog){this._modelMassUpdateDialog.destroy();this._modelMassUpdateDialog=null}this._parent()},displayModalLoader:function(ai,aj){if(!this._loaderDisplayed){this._loaderDisplayed=new aa()}if(this._loaderDisplayed._loaderCounter===0){M.createModal(this.getContent(),this._loaderDisplayed.elements.container)}if(!ai){ai=L.loading}this._loaderDisplayed.on(ai);if(aj){if(this._loaderDisplayed._loaderCounter===1){H.onNodeRendered(this._loaderDisplayed.elements.container,aj)}else{aj()}}},removeModalLoader:function(ai){if(this._loaderDisplayed){if(!ai){ai=L.loading}this._loaderDisplayed.off(ai)}if(this._loaderDisplayed._loaderCounter<=0){M.removeModal(this.getContent());this._loaderDisplayed=undefined}},_displayEmptyContentMessage:function(){if(this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage")){return}var aj=e.createElement("div",{"class":"wux-datagridview-emptycontentmessage"});var ai=e.createElement("div");ai.textContent=this.placeholder;ai.inject(aj);aj.inject(this.elements.poolContainerSync)},_removeEmptyContentMessage:function(){var ai=this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage");if(ai){ai.destroy()}},_registerPools:function(){this._parent();var ai=this.cellClass;this._registerPool("__row_header__",this.elements.leftPoolContainer,p);this._registerPool("__topleft_row_header__",this.elements.leftHeaderPoolContainer,p);this._registerPool("__top_item__",this.elements.headerPoolContainer,a);this._registerPool("__topleft_item__",this.elements.leftHeaderPoolContainer,a);this._registerPool("__topright_item__",this.elements.rightHeaderPoolContainer,a);this._registerPool("__tree_item__",this.elements.poolContainer,E);this._registerPool("__left_tree_item__",this.elements.leftPoolContainer,E);this._registerPool("__right_tree_item__",this.elements.rightPoolContainer,E);this._registerPool("__odd_row__",this.elements.poolContainer,U);this._registerPool("__even_row__",this.elements.poolContainer,U);this._registerPool("__left_odd_row__",this.elements.leftPoolContainer,U);this._registerPool("__left_even_row__",this.elements.leftPoolContainer,U);this._registerPool("__right_odd_row__",this.elements.rightPoolContainer,U);this._registerPool("__right_even_row__",this.elements.rightPoolContainer,U)},getTreeDocument:function(){return(this._rowModel?this._rowModel._getTreeDocument():undefined)},getTypeRepresentationFactory:function(){return S},supportsKeyboardNavigation:function(){return true},supportsSelection:function(){return true},supportsLightRendering:function(){return true},supportsCustomScrolling:function(){return true},setToolbar:function(ak){var ai=JSON.parse(ak);var am=this.getTypeRepresentationFactory();if(ai.enums){for(var an in ai.enums){am.registerEnum(an,ai.enums[an])}}if(ai.typeRepresentations){am.registerTypeRepresentations(ai.typeRepresentations)}var aj=W.prototype.createTreeDocument(ai);var al=new W({items:aj,overflowManagement:"dropdown",direction:"horizontal",typeRepresentationFactory:am,context:this});return al},getCellAttributesAt:function(av){var ap=this.layout;var ar=this._parent(av);if(av.rowID<=-1){if(this.columnDragEnabledFlag){ar.draggable=true;if(this._draggedColumnOrGroup){var at=ap.getColumnOrGroupFromCoordinates(av);if(at&&at._isMoving){ar["is-moving"]=true}}}if(av.rowID===-1){var ak=ap._getCellTypeRepresentation(av);if(ak){ar["type-representation"]=ak}var al=this.sortModel;if(al&&(al.length>0)){var aq=ap.getDataIndexFromColumnIndex(av.columnID);var an;for(var am=0;am<al.length;am++){if(al[am].dataIndex===aq){an=al[am].sort;break}}if(an!==undefined){ar["sort-direction"]=an;if(al.length>1){ar["sort-order"]=am+1}}}}}else{var ai=this.model[av.rowID];if(ai){if(ai.getChangeStates()&TreeNodeModelChangeStates.NodeToBeRemoved){ar["to-be-removed"]=true}else{if(ai.getChangeStates()&TreeNodeModelChangeStates.NodeAdded){ar.added=true}}if(av.columnID===-1){if(this._rowModel&&!this._rowModel.shouldBeSelected(ai)){ar.unselectable=true}}else{if((av.columnID>=0)&&this.cellDragEnabledFlag){ar.draggable=true}}}if(av.columnID>=0){var ao=ap.getColumnEditionPolicy(av.columnID);if(ao!=="EditionInPlace"){ar.lite=""}if(this.showRequiredFeedbackFlag&&this.getCellRequiredState(av.cellID)){ar["is-required"]=""}if(this.showEditableFeedbackFlag&&(ao!=="EditionInPlace")&&this.getCellEditableState(av.cellID)){ar["is-editable"]=""}}if(this._draggedColumnOrGroup){var au=this.layout.getLeafColumns();var aj=au[av.columnID];if(aj&&aj._isMoving){ar["is-moving"]=true;if(aj._isFirstColumnMoving){ar["is-first-column-moving"]=true}}}}return ar},_setPreselectedCell:function(am){var al=this._getPreselectedCellID();this._parent(am);if(al!==am){this._preselectedCellStableID=(am!==undefined)?this._getXSOElementFromCellID(am):undefined;var ai=this._preselectedRowID;var ak;if(am!==undefined){var aj=this.layout.getCellCoordinatesAt(am);ak=aj.rowID}if(ai!==ak){this._preselectedRowID=ak;if(ai!==undefined){this._updateRenderedRowCellsAttributes(ai)}if(this._preselectedRowID!==undefined){this._updateRenderedRowCellsAttributes(this._preselectedRowID)}}}},_updateRenderedRowCellsAttributes:function(al){var ak=this.layout;var am=ak.getLeafColumns();var ai=am.length;var an=ak._leftPinnedRowcolumnID;for(var aj=an;aj<ai;aj++){this._updateRenderedCellAttributes(ak.getCellIDFromCoordinates({rowID:al,columnID:aj}))}},_updateRenderedRow:function(am,aj){var al=this.layout;var an=al.getLeafColumns();var ai=an.length;var ao=al._leftPinnedRowcolumnID;for(var ak=ao;ak<ai;ak++){this.updateCellView(al.getCellIDFromCoordinates({rowID:am,columnID:ak}),aj)}},_updateRenderedColumn:function(am,aj){var al=this.layout;var ai=al.getMinMaxVisibleRowIDs();for(var ak=ai.minRowID;ak<=ai.maxRowID;ak++){this.updateCellView(al.getCellIDFromCoordinates({rowID:ak,columnID:am}),aj)}},_updateColumnHeaderCells:function(aj){var an=this.layout;var am=3+(an.rowsHeader?1:0);for(var ak=0;ak<an._columnItemsByDepth.length;ak++){var al=an._columnItemsByDepth[ak];for(var ai=0;ai<al.length;ai++){this.updateCellView(am,aj);am++}}},_freeUpColumnCells:function(al,an){var ak=this.layout;var ai=this.model.length;var am=ak.columnsHeader?-1:0;for(var aj=am;aj<ai;aj++){this._freeUpCell(ak.getCellIDFromCoordinates({rowID:aj,columnID:al}),an)}},endRendering:function(){this._parent();if((this._tweakerToGenerateCount===0)&&!this._activeScroller){this._onAllCellsRendered()}},_onAllCellsRendered:function(){if(!this._inOnAllCellsRendered&&this.isInitialized()){this._inOnAllCellsRendered=true;if(this._resetRowHeightsOnAllCellsRenderedFlag){this._resetRowHeightsOnAllCellsRenderedFlag=false;this.layout.resetRowHeights()}this._inOnAllCellsRendered=false;this.fire("allCellsRendered")}},_addTweakerToGenerate:function(){this._tweakerToGenerateCount++},_removeTweakerToGenerate:function(){this._tweakerToGenerateCount--;if(!this._isRendering()&&(this._tweakerToGenerateCount==0)){this._onAllCellsRendered()}},_resetRowHeightsOnAllCellsRendered:function(){this._resetRowHeightsOnAllCellsRenderedFlag=true},isCellPreselected:function(al){var aj=false;var ak=this.layout;var ai=ak.getCellCoordinatesAt(al);aj=((ai.rowID===this._preselectedRowID)&&(ai.rowID>-1));return aj},sizeColumnToFit:function(aq,aw){var ar=this.layout;aw=e.extend({isUserInteraction:false,computeAllRows:false},aw);var au=ar.getColumnIndex(aq);var ao;if(aw.computeAllRows){ao={minRowID:0,maxRowID:this.model.length-1}}else{ao=ar.getMinMaxVisibleRowIDs()}var ak=ar.getColumnMinWidth(au);var ax=ar.getColumnAutoSizePadding(aq);var al=false;for(var ap=ao.minRowID;ap<=ao.maxRowID;ap++){var at=this.layout.getCellIDFromCoordinates({rowID:ap,columnID:au});var an=false;var av=this._getRenderedCellAt(at);if(!av){av=this._renderCell(at,{updateCellContent:false,updateCellLayout:"ignore",updateCellAttributes:false});an=true}if(av&&av.component){al=true;var ai=av.component.computeContentSize();var am=2;var aj=ai+am+ax;if(aj>ak){ak=aj}if(an){this._freeUpCell(at,1)}}}if(ak!==undefined&&al){ar.setColumnWidth(aq,ak,{isUserInteraction:aw.isUserInteraction})}},sizeAllColumnsToFit:function(aj){var al=this.layout;if(!al.isValid()){al.prepareLayout()}var am=this.layout.getLeafColumns();var ai=am.length;this.prepareUpdateView();for(var ak=0;ak<ai;ak++){this.sizeColumnToFit(ak,aj)}this.pushUpdateView({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false},true)},_applyRowGroupingOptions:function(ai){this._properties.rowGroupingOptions.value=e.extend({depth:0,hideGroupedColumns:true,getGroupingNodeOptions:null},this.rowGroupingOptions)},setFindStr:function(am,aj,al,ai){this._muteFind=false;var ap=this.findStr;var ao=this.matchCase;this.matchCase=aj;this.findStr=am;if(this.findStr!=""){var ak;if(ap===this.findStr&&this.matchCase!==ao&&this.matchCase===true){ak=this._matchingNodeModel}var aq=this;this._matchingFoundArray=[];this._matchingCellID=[];this._matchingNodeModel=[];this._findAllCellIDsMatchingFindStr(this.findStr,this.matchCase,ak);this.numberOfFoundResults=this._computeNumberOfFoundResults();this.findWidget.count=this.numberOfFoundResults;if(ap!=""){this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}if(this._matchingCellID.length>0){if(al!==undefined){if(al<this._matchingCellID.length){if(al>0){this._currentFound=al-1}}else{this._currentFound=this._matchingCellID.length-1}this.findWidget.setCurrentValue(this._currentFound+1)}else{this._currentFound=0}if(!ai){this.ensureCellVisible(this._matchingCellID[this._currentFound])}}for(var an=0;an<this._matchingCellID.length;an++){this.updateCellView(this._matchingCellID[an],{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}}else{if(ap!=""){this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false});this._removeCurrentFoundCellFeedback()}}},_findAllCellIDsMatchingFindStr:function(ai,aj,ak){if(this._rowModel){this._rowModel._findAllCellIDsMatchingFindStr(ai,aj,ak)}},_getCellValueAsStringForFind:function(ar,ao,ap){if(ap==="color"||ap==="bool"||ap==="boolean"||ap==="icon"||ap==="image"){return undefined}var an=ar.cellID;var aj=ar.nodeModel;if(!aj){return undefined}var ak=this.getModelAt(an);if(ak===undefined){return ak}var aq;var au=this.layout.getColumnOptionValue(ar.columnID,"getCellValueAsStringForFind");if(au){return au.call(this,ar)}if(ao==="tree"&&ap==="string"){aq=aj.options.label}else{if(ap==="url"||ap==="urlExternalLink"){aq=ak.label}else{aq=aj.options.grid[ao]}}if(this.getTypeRepresentationFactory()&&this.getTypeRepresentationFactory().typeReps&&this.getTypeRepresentationFactory().typeReps[ap]&&this.getTypeRepresentationFactory().typeReps[ap].semantics&&this.getTypeRepresentationFactory().typeReps[ap].semantics.possibleValues){var am=this.getTypeRepresentationFactory().typeReps[ap].semantics.possibleValues;if(e.is(am,"object")){aq=undefined;var ai=Object.keys(am);for(var al=0;al<ai.length;al++){if(am[ai[al]]===ak){aq=ai[al];break}}return aq}}if(e.is(aq,"string")||e.is(aq,"number")){if(ap==="progress"){aq=aq+"%"}else{if(ap==="percentage"){aq=aq+" %"}}return aq.toString()}else{if(e.is(aq,"date")){var at={year:"numeric",month:"short",day:"numeric"};if(ap==="date"){}else{if(ap==="time"){at={hour:"numeric",minute:"numeric"}}}return aq.toLocaleDateString(WUX.currentLanguage,at)}}return aq},_getIndexesOfMatchingString:function(ak,aj){var am=[];var ai=0;var al=ak.indexOf(aj);while(al!=-1){am.push(al+ai);al=ak.indexOf(aj,al+aj.length)}return am},_getSelectedIndexFromMatchingCellID:function(ai){var aj=0;for(var ak=0;ak<this._matchingFoundArray.length;ak++){if(ak>ai){break}var al=aj;aj+=this._matchingFoundArray[ak].length;if(ak===ai){if(aj>this._currentFound){return this._currentFound-al}}}return -1},_getCellIDFromCurrentMatchingIndex:function(ai){var aj=0;for(var ak=0;ak<this._matchingFoundArray.length;ak++){var al=aj;aj+=this._matchingFoundArray[ak].length;if(aj>ai){return this._matchingCellID[ak]}}return -1},_computeNumberOfFoundResults:function(){var aj=0;for(var ai=0;ai<this._matchingFoundArray.length;ai++){aj+=this._matchingFoundArray[ai].length}return aj},goToPreviousMatchingCell:function(){if(this._muteFind===true){this._muteFind=false;this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}var ai;if(this._currentFound===0){ai=this.numberOfFoundResults-1}else{ai=this._currentFound-1}this._changeMatchingCell(ai)},goToNextMatchingCell:function(){if(this._muteFind===true){this._muteFind=false;this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}var ai;if(this._currentFound===this.numberOfFoundResults-1){ai=0}else{ai=this._currentFound+1}this._changeMatchingCell(ai)},closeFind:function(){if(this.findWidget){this._muteFind=true;this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false});this._removeCurrentFoundCellFeedback()}},destroyFind:function(){if(this.findWidget){this.findWidget.close();this.findWidget.destroy()}this.findStr=""},_removeCurrentFoundCellFeedback:function(){if(this._matchingCellID&&this._currentFound<this._matchingCellID.length){var aj=this._matchingCellID[this._currentFound];if(aj){var ai=this._getViewAt(aj);if(ai){ai.getContent().removeClassName("datagridView-cell-current-find")}}}},_changeMatchingCell:function(al){if(this._currentFound===al){return}var aj=this._getCellIDFromCurrentMatchingIndex(al);var ak=this._getCellIDFromCurrentMatchingIndex(this._currentFound);this._currentFound=al;var ai=this._getViewAt(ak);if(ai){ai.getContent().removeClassName("datagridView-cell-current-find")}if(aj&&ak){this.ensureCellVisible(aj);this.updateCellView(aj,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false});this.updateCellView(ak,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}},groupRows:function(ai){if(this._rowModel){if(this.findWidget){this.findWidget.close()}this._rowModel.groupRows(ai)}},createGroupingUI:function(){var an=this;var ao=undefined;var am=function(ar,aq){if((an._draggedRowID===-1)&&an.rowGroupingEnabledFlag){ar.preventDefault()}};var ai=function(av,aq){var aw=an.getDraggedColumnData(av);if(aw&&(aw.rowID===-1)&&an.layout.getColumnOptionValue(aw.columnID,"groupableFlag")){var au={label:aw.label,value:an.layout.getColumnOptionValue(aw.columnID,"dataIndex"),index:undefined};var at=aq.chipCellView?aq.chipCellView.associatedModelItem:undefined;if(at){var ar=aq.dropPosition;if(ar==="left"){au.index=ao.getChipPosition(at.chipOptions.label)}else{if(ar==="right"){au.index=ao.getChipPosition(at.chipOptions.label)+1}}}ao.addChip(au)}av.preventDefault();return true};ao=new t({shape:t.SHAPE.OVAL,placeholder:m.GroupingUIPlaceholder,onDragOverCell:function(ar,aq){return am(ar,aq)},onDragOverBlank:function(ar,aq){return am(ar,aq)},onDropCell:function(ar,aq){return ai(ar,aq)},onDropBlank:function(ar,aq){return ai(ar,aq)}});var ap=true;var al=true;ao.getContent().addEventListener("change",function(ar){if(ar&&ar.dsModel&&ap){var aq=[];ar.dsModel.getAllChipsOptions().forEach(function(at){aq.push(at.value)});al=false;an.groupRows({dataIndexesToGroup:aq});an.layout._saveGroupingOptionsInPreferences();al=true}});var ak=this.getTreeDocument();if(ak){var an=this;var aj=function(at){if(al&&an._rowModel._groupingOptions&&an._rowModel._groupingOptions.dataIndexesToGroup){ap=false;ao.removeAllChips();for(var aq=0;aq<an._rowModel._groupingOptions.dataIndexesToGroup.length;aq++){var ar=an._rowModel._groupingOptions.dataIndexesToGroup[aq];ao.addChip({label:an.layout.getColumnOptionValue(ar,"text"),value:ar})}ap=true}};ak.addEventListener("groupChildren",aj);aj()}return ao},getCellEditableState:function(al){var ak=this.layout;var aj=ak.getCellCoordinatesAt(al);if(aj.columnID===-1||aj.rowID<=-1){return false}else{var ai=ak.getColumnGetCellEditableState(aj.columnID);if(ai){var am=this.getLightCellInfosAt(al);am.nodeModel=this.model[aj.rowID];return ai.call(this,am)}return ak.getColumnEditableFlag(aj.columnID)}return false},getCellRequiredState:function(ai){return false},_getCellSemantics:function(ak){var aj=this.layout;if((ak.columnID>-1)&&(ak.rowID>-1)){var ai=aj.getColumnGetCellSemantics(ak.columnID);if(ai){return ai.call(this,ak)}}return null},_getCellKPIColor:function(ak){var ai=this.layout;if((ak.columnID>-1)&&(ak.rowID>-1)){var aj=ai.getColumnGetCellKPIColor(ak.columnID);if(aj){return aj.call(this,ak)}}return null},_computeCellIDFromActiveCell:function(aj,al,ai){var ak=this.getActiveCellID();if(ai&&(this._getLastRangeCellID()>=0)&&((aj==="up")||(aj==="right")||(aj==="down")||(aj==="left")||(aj==="pageup")||(aj==="pagedown"))){ak=this._getLastRangeCellID()}return this.layout._computeCellIDFromCell(ak,aj,al,ai)},onDragStartCellDefault:function(aj,ai){},onDragEndCellDefault:function(aj,ai){},onDragEnterCellDefault:function(aj,ai){},onDragLeaveCellDefault:function(aj,ai){},onDragCellDefault:function(aj,ai){},onDragOverCellDefault:function(ak,aj){if(this.getRowReorderEnabledState()&&aj.nodeModel){var ai=c.call(this,ak,aj);if(ai){ak.preventDefault()}}},onDropCellDefault:function(aj,ai){if(this.getRowReorderEnabledState()&&ai.nodeModel){u.call(this);var ak=s.call(this,aj,ai);if(ak){aj.preventDefault();return}}},getRowReorderEnabledState:function(){return this.rowDragEnabledFlag&&this.rowReorderEnabledFlag&&this._disableRowReorderCpt===0},enableRowReordering:function(){this._disableRowReorderCpt--},disableRowReordering:function(){this._disableRowReorderCpt++},onDragStartRowHeaderDefault:function(ao,aj){if(!this.rowDragEnabledFlag){return}var ak={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Row_Options:{"dswebux/x-datagridview.row.options.label+json":aj.nodeModel.options.label,"dswebux/x-datagridview.row.options.icons+json":aj.nodeModel.options.icons,"dswebux/x-datagridview.row.options.grid+json":aj.nodeModel.options.grid,"dswebux/x-datagridview.row.id+json":aj.rowID}}};ao.dataTransfer.setData("text",JSON.stringify(ak));if(ao.dataTransfer.setDragImage){var an=this.layout.getColumnIndex("tree");if(an!==undefined){var al=this.layout.getCellIDFromCoordinates({rowID:aj.rowID,columnID:an});var ai=false;var ap=this._getRenderedCellAt(al);if(!ap){ap=this._renderCell(al,{updateCellContent:false,updateCellLayout:"ignore",updateCellAttributes:false});ai=true}if(ap&&ap.component){ao.dataTransfer.setDragImage(ap.component.getContent(),10,10)}if(ai){var am=this;setTimeout(function(){am._freeUpCell(al,1)},0)}}}},onDragEndRowHeaderDefault:function(aj,ai){},onDragEnterRowHeaderDefault:function(aj,ai){},onDragLeaveRowHeaderDefault:function(aj,ai){u.call(this)},onDragRowHeaderDefault:function(aj,ai){},onDragOverRowHeaderDefault:function(ak,aj){if(this.getRowReorderEnabledState()&&aj.nodeModel){var ai=c.call(this,ak,aj);if(ai){ak.preventDefault()}}},onDropRowHeaderDefault:function(aj,ai){if(this.getRowReorderEnabledState()&&ai.nodeModel){u.call(this);var ak=s.call(this,aj,ai);if(ak){aj.preventDefault();return}}},onDragStartColumnHeaderDefault:function(ap,ai){if(this.columnDragEnabledFlag){var an=this.layout;this._draggedColumnOrGroup=an.getColumnOrGroupFromCoordinates({rowID:ai.rowID,columnID:ai.columnID});this._draggedRowID=ai.rowID;if(this._draggedColumnOrGroup){this._draggedColumnOrGroup._isMoving=true;Y.processTreeChildren(this._draggedColumnOrGroup.children,function(aq){aq._isMoving=true});this._updateColumnHeaderCells({updateCellContent:false,updateCellLayout:false,updateCellAttributes:true});var al=Y.getLeafItems(this._draggedColumnOrGroup);for(var ak=0;ak<al.length;ak++){var am=al[ak];if(ak===0){am._isFirstColumnMoving=true}var ao=an.getColumnIndex(am.dataIndex);this._updateRenderedColumn(ao,{updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})}}}var aj={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Column_Options:{"dswebux/x-datagridview.column.label+json":ai.cellModel,"dswebux/x-datagridview.row.id+json":ai.rowID,"dswebux/x-datagridview.column.id+json":ai.columnID}}};ap.dataTransfer.setData("text",JSON.stringify(aj))},onDragEndColumnHeaderDefault:function(ap,ak){if(this._draggedColumnOrGroup){var ao=this.layout;this._draggedColumnOrGroup._isMoving=false;Y.processTreeChildren(this._draggedColumnOrGroup.children,function(aq){aq._isMoving=false});var am=Y.getLeafItems(this._draggedColumnOrGroup);for(var al=0;al<am.length;al++){var an=am[al];if(al===0){an._isFirstColumnMoving=false}}this._draggedColumnOrGroup=null;var ai=ao._getColumnTreeItemCount();ao._computeColumnItems();var aj=false;if(ao._getColumnTreeItemCount()!==ai){aj=true}this.invalidateLayout({updateCellContent:aj,updateCellLayout:true,updateCellAttributes:true})}},onDragEnterColumnHeaderDefault:function(aj,ai){u.call(this)},onDragLeaveColumnHeaderDefault:function(aj,ai){},onDragColumnHeaderDefault:function(aj,ai){},onDragOverColumnHeaderDefault:function(ay,al){if(this.columnDragEnabledFlag&&this._draggedColumnOrGroup){ay.dataTransfer.dropEffect="move";ay.preventDefault();if(this._draggedColumnOrGroup){var az=this.layout;var ar=false;var ai;var aB=az.getColumnOrGroupFromCoordinates({rowID:al.rowID,columnID:al.columnID});var at=az.getColumnOrGroupPinned(this._draggedColumnOrGroup);var au=az.getColumnOrGroupPinned(aB);if(at===au){var aA=Z(ay).offsetX;var aj;if(al.rowID===-1){ai=al.columnID;aj=aA}else{var ax=0;var ao=Y.getLeafItems(aB);for(var aw=0;aw<ao.length;aw++){var ak=ao[aw];var an=az.getColumnIndex(ak.dataIndex);var av=az.getColumnComputedWidth(an);if(aA<=ax+av){ai=an;aj=aA-ax;break}ax+=av}}if(ai!==undefined){var ap=az.getColumnOrGroupComputedWidth(this._draggedColumnOrGroup);var aq=az.getColumnComputedWidth(ai);var am=az.getFirstLeafColumnIndex(this._draggedColumnOrGroup);if(((az._orderedColumnsReverseIndexes[am]<az._orderedColumnsReverseIndexes[ai])&&(aj>(aq/2))&&(aj>(aq-ap)))||((az._orderedColumnsReverseIndexes[am]>az._orderedColumnsReverseIndexes[ai])&&(aj<(aq/2))&&(aj<ap))){ar=true}}}if(ar){this.layout.moveColumnOrGroup(this._draggedColumnOrGroup,ai,{isUserInteraction:true})}}}},onDropColumnHeaderDefault:function(aj,ai){aj.preventDefault()},onDragEnterBlankDefault:function(aj,ai){u.call(this)},_processDragAndDropCallbacks:function(an,ar){if(!ar){return}if(an.type==="dragstart"){if(this.findWidget){this.findWidget.close()}if(an.dataTransfer){var am=an.target.getBoundingClientRect();var al=an.clientX-am.left;var aj=an.clientY-am.top;if(typeof(an.dataTransfer.setDragImage)==="function"){an.dataTransfer.setDragImage(an.target,al,aj)}}}if(an.type==="dragover"){var ai=F.call(this,an);if(ai){return}}else{if(an.type==="dragstart"&&ar.columnID===-1&&ar.rowID>=0){Object.getPrototypeOf(this).__rowReorderDnDInfos={source:this._uuid,node:ar.nodeModel}}else{if(an.type==="dragend"){if(!this._rowReorderDnDInfos.dropAccepted){s.call(this,an,ar)}Object.getPrototypeOf(this).__rowReorderDnDInfos=null;x.call(this);u.call(this)}}}var ap={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var at=ap[an.type];var aq=ar;var ao=this;function ak(ay,au){var ax=true;var av=ao[ay+au];var aw=ao[ay+au+"Default"];if(av){ax=av.call(ao,an,aq);if(ae){console.info("[dnd]",ay+au,">",ax,an.target)}}else{if(!aw){if(ae){console.warn("[dnd]","cannot find",ay+au,"callback")}}}if(aw&&ax){if(ae){if(av&&ax){console.info("\t>[dnd]","dev want to continue to the default behavior for ",ay+au," callback")}else{console.info("\t>[dnd]","use the default behavior for ",ay+au," callback")}}aw.call(ao,an,aq)}}if(ar&&ar.cellView){if(ar.columnID===-1){ak(at,"RowHeader")}else{if(ar.rowID<=-1){ak(at,"ColumnHeader")}else{ak(at,"Cell")}}}else{ak(at,"Blank")}},_manageDragAndDrop:function(){this.addEventListener("dragstart",this._processDragAndDropCallbacks.bind(this));this.addEventListener("drop",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragover",this._processDragAndDropCallbacks.bind(this));this.addEventListener("drag",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragend",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragleave",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragenter",this._processDragAndDropCallbacks.bind(this))},getDraggedRowData:function(aj){var ai=aj.dataTransfer.getData("text");try{if(ai!==""){var ak=JSON.parse(ai);if(ak&&ak.data.DataGridView_Row_Options!==undefined){return{uuid:ak.source.uuid,label:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.label+json"],icons:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.icons+json"],grid:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.grid+json"],rowID:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.id+json"]}}}}catch(aj){console.warn('the element being in dataTransfer type "DataGridView_Row_Options" is not parsable usable JSON.parse')}},getDraggedColumnData:function(aj){var ai=aj.dataTransfer.getData("text");try{if(ai!==""){var al=JSON.parse(ai);if(al&&al.data.DataGridView_Column_Options!==undefined){return{uuid:al.source.uuid,label:al.data.DataGridView_Column_Options["dswebux/x-datagridview.column.label+json"],rowID:al.data.DataGridView_Column_Options["dswebux/x-datagridview.row.id+json"],columnID:al.data.DataGridView_Column_Options["dswebux/x-datagridview.column.id+json"]}}}}catch(ak){console.warn('the element being in dataTransfer type "DataGridView_Column_Label" is not parsable usable JSON.parse')}},_getSelectionCheckBox:function(am){var ai;var ak=this.layout.getCellIDFromCoordinates({rowID:am,columnID:-1});var al=this._getViewAt(ak);if(al){var aj=al.getContent().querySelector(".wux-datagridview-selection-checkbox");if(aj){ai=aj.dsModel}}return ai},_updateSelectAllCheckBox:function(){if(this.layout.columnsHeader){var ai=this._getSelectionCheckBox(-1);if(ai){var al=this.getNodesXSO();if(al){var am=al.isEmpty();ai.checkFlag=!am;var ak=this.isEveryVisibleNodeSelected();var aj=this._selectAllCheckBoxListenChange;this._selectAllCheckBoxListenChange=false;ai.mixedState=!am&&!ak;this._selectAllCheckBoxListenChange=aj}}}},_getCellTooltip:function(ai){if(this.getCellTooltip){return this.getCellTooltip(ai)}else{return this.getCellDefaultTooltip(ai)}},getCellDefaultTooltip:function(aj){var ai=this;return{getAllInformationCB:function(){if(aj.rowID<0){var ao=ai.layout.getColumnOrGroupFromCoordinates(aj);if(ao.description){return{model:{shortHelp:ao.description},updateModel:false}}}if(!aj.cellModel){return{model:{shortHelp:""},updateModel:false}}var am=aj.cellView.elements.container.offsetWidth;var al=aj.cellView.computeContentSize();var aq=am<al;var ak="";var an;if(aq){var ap=aj.cellView._getReusableContent();if(ap){ak=ap.getStringFromValue(ap.value);an=Q.getUnsafeHTMLContentValueToApply(ai.layout.getColumnShouldCellAllowUnsafeHTMLContentAt(aj.columnID).call(ai,aj))}}if(typeof an!=="undefined"){return{model:{shortHelp:ak,allowUnsafeHTMLShortHelp:an,allowUnsafeHTMLLongHelp:an,allowUnsafeHTMLTitle:an},updateModel:false}}return{model:{shortHelp:ak},updateModel:false}}}},defaultOnCellRequest:function(ai){var aq=this;var aB=aq.layout;var ao=aB.getLeafColumns();var az=ao[ai.columnID];var ar=false;if((ai.rowID>=0)&&(ai.columnID>=0)){if(az.dataIndex==="tree"){var am=ai.cellView;am.showIconsFlag=aq.showTreeIconsFlag;am.flatTreeFlag=aq.hasFlatTreeState();var av=aq.model[ai.rowID];if(am.nodeModel!==av){am.nodeModel=av}else{am._applyNodeModel(av)}am.height=aB.getRowHeight(ai.rowID);aq._setTweakerForCell(ai);ar=true}else{var ax=aB._getCellTypeRepresentation(ai);if(ax){aq._setTweakerForCell(ai);ar=true}else{var aw=ai.cellModel;if(typeof aw==="number"){aw+=""}if(Q.getUnsafeHTMLContentValueToApply(aB.getColumnShouldCellAllowUnsafeHTMLContentAt(ai.columnID).call(this,ai))){ai.cellView.getContent().setHTML(aw)}else{ai.cellView.getContent().textContent=aw}}}ai.cellView._updateTooltip(this._getCellTooltip(ai))}else{if((ai.columnID===-1)&&aB.rowsHeader){var ay=ai.cellView.getContent().querySelector(".wux-datagridview-selection-checkbox");if(ay){var ak=ay.dsModel;if(ak){var ap=aq.getNodesXSO();if(ap){var aj=ak.preventTriggeringChangeEvent;ak.preventTriggeringChangeEvent=true;if(ai.rowID>=0){ak.checkFlag=ap.isIn(ai.nodeModel);ak.mixedState=false}else{var an=ap.isEmpty();ak.checkFlag=!an;var at=aq.isEveryVisibleNodeSelected();ak.mixedState=!an&&!at}ak.preventTriggeringChangeEvent=aj}}ai.cellView._updateTooltip({getAllInformationCB:function(){return{model:{shortHelp:ai.cellModel?ai.cellModel.toString():undefined},updateModel:false}}})}var aA=ai.cellView.getContent().querySelector(".wux-datagridview-selection-label");if(aA){aA.textContent=ai.cellModel}ai.cellView.showKPIColorFlag=aq.showNodeKPIColorFlag;ai.cellView.KPIColor=ai.nodeModel?ai.nodeModel.options.color:undefined}else{if((ai.rowID<=-1)&&(ai.columnID>=0)){aq._setTweakerForCell(ai);ar=true;if(this._rowModel&&this._rowModel._filterViewManager&&az){var al=az.dataIndex==="tree"?"label":az.dataIndex;var au=this._rowModel._filterViewManager.getFilterViews()[al];if(ai.cellView.elements.iconsContainer){if(au){au.inject(ai.cellView.elements.iconsContainer)}else{ai.cellView.elements.iconsContainer.empty()}}}ai.cellView._updateTooltip(this._getCellTooltip(ai))}else{ai.cellView._setReusableContent(null)}}}if(ai.columnID>=0){if(ar){ai.cellView.getContent().removeAttribute("no-tweaker")}else{ai.cellView.getContent().setAttribute("no-tweaker","")}}},_manageCellRequests:function(){var ai=this;ai.onCellRequest(function aj(am){var ak=ai.layout;if((am.rowID>=0)&&(am.columnID>=0)){var al=ak.getColumnOnCellRequest(am.columnID);if(al){return al.call(ai,am)}}ai.defaultOnCellRequest(am)})},_setTweakerForCell:function(ai){var aw=this;var aI=this.layout;var ax=false;if(ai.cellView){ai.cellView.getContent().removeClassName("datagridView-cell-current-find")}var aD;var aH;var aB=ai.cellModel;var ay;var aq=false;if((ai.rowID<=-1)&&(ai.columnID>=0)){aD="string";var am=aI.getColumnOrGroupFromCoordinates(ai);if(am){aH=am.icon}else{aH=aI.getColumnIcon(ai.columnID)}aq=true;if(ax){aB+=" cellID:"+ai.cellID+"  rowID: "+ai.rowID+" colID: "+ai.columnID}}else{if(ax){aD="string";aq=true;aB="cellID:"+ai.cellID+"  rowID: "+ai.rowID+" colID: "+ai.columnID}else{aD=aI._getCellTypeRepresentation(ai);var az=this.model[ai.rowID];if(az){var aj=az.options.grid;var at=aI.getLeafColumns();var aG=at[ai.columnID];if(aj.hasOwnProperty(aG.dataIndex)||(aB!==undefined)||(aI.getColumnGetCellValue(ai.columnID)!==undefined)){aq=true;ay=az.getReferenceValue(aG.dataIndex);if(ay===undefined){ay=e.clone(aB,false)}}}}}var aE=parseInt(Date.now());if(ai.cellView){ai.cellView._currentTimeStamp=aE}if(aD&&aq){var ap;var al=ai.cellView._getReusableContent();if(al&&al.__disposable__){var aK=S.getRegisteredTypeRepresentation(aD);if(!aK){aK={semantics:{possibleValues:S.getRegisteredEnum(aD)}}}ap=S.getTemplateIdentifierFromTypeRep(aK,"inlinedTemplate")}var aC=aI.getColumnShouldCellAllowUnsafeHTMLContentAt(ai.columnID).call(this,ai);var ao=aI.getColumnOptionValue(ai.columnID,"allowResetToUndefinedByUIFlag");var aL=aI.getColumnOptionValue(ai.columnID,"hyperlinkTarget");var av={touchMode:G.getTouchMode(),readOnly:!this._isCellInEdition(ai.cellID),showReferenceValueFlag:this.showModelChangesFlag,allowUnsafeHTMLContent:aC};if((ai.rowID<=-1)&&(ai.columnID>=0)){av.icon=aH}if(ay!==undefined){av.referenceValue=ay}if(ao!==undefined){av.allowResetToUndefinedByUIFlag=ao}if(ai.rowID>-1){var aA=aI.getColumnOptionValue(ai.columnID,"alignment");if(aA==="near"||aA==="center"||aA==="far"){av.alignment=aA}}if(aL!==undefined){av.hyperlinkTarget=aL}var ak=this._getCellSemantics(ai);if(ak){av=e.merge(ak,av)}av.context=ai;if(this._matchingCellID&&!this._muteFind){var aJ=this._matchingCellID.indexOf(ai.cellID);if(aJ!==-1){if(this._matchingCellID[aJ]===ai.cellID){var aF=this._matchingFoundArray[aJ];av.highlightModel={label:this.findStr,indexes:aF,selectedIndex:this._getSelectedIndexFromMatchingCellID(aJ)};if(ai.cellView&&this._getCellIDFromCurrentMatchingIndex(this._currentFound)===ai.cellID){ai.cellView.getContent().addClassName("datagridView-cell-current-find")}}else{av.highlightModel=undefined}}else{av.highlightModel=undefined}}else{av.highlightModel=undefined}if(al&&al.__disposable__&&(al.__disposable__.identifier===ap)){al.disableEvents();av.value=aB;var aK=S.getRegisteredTypeRepresentation(aD);if(!aK){aK={semantics:{possibleValues:S.getRegisteredEnum(aD)}}}var au=S.getTemplateIdentifierFromTypeRep(aK,"inlinedTemplate");var ar=S.getRegisteredTypeTemplate(au);Q.setTweakerProperties(al,av,aK,ar);al.enableEvents()}else{av.typePath=aD;av.context="inlinedTemplate";av.semantics={context:ai};av.needToCreateViewAfterRequireEnded=function(){if(ai.cellView&&ai.cellView._currentTimeStamp===aE){return true}else{return false}};aw._addTweakerToGenerate();av.onViewCreated=function(aM){ai.cellView._setReusableContent(aM);aw._removeTweakerToGenerate()};av.onFailure=function(aM){aw._removeTweakerToGenerate()};S.generateView(aB,av)}}else{ai.cellView._setReusableContent(null)}var an=this._getCellKPIColor(ai);if(an){ai.cellView.KPIColor=an;ai.cellView.showKPIColorFlag=true}else{ai.cellView.showKPIColorFlag=false}},_manageUserInteractions:function(){var ai=this;ai.addEventListener("change",function(am,an){if(ai._isCurrentlyCalledFromUIInteraction()&&an&&(an.columnID>=0)){if(an.cellView){var aj=an.cellView._getReusableContent();if(aj){var ak=aj.value;var al=aj.referenceValue;ai.setModelAt(an.cellID,ak,al);if(ai._matchingCellID&&!ai._muteFind){ai.setFindStr(ai.findStr,ai.matchCase,ai._currentFound,true)}}}}});ai.addEventListener("buttonclick",function(al,am){if(al.target.hasClassName("wux-datagridview-selection-checkbox")&&ai._selectAllCheckBoxListenChange){var aj=al.target.dsModel;if(aj){ai._selectAllCheckBoxListenChange=false;if(am.rowID>=0){if(am.nodeModel){if(aj.checkFlag){if(!al.options.shiftKey){ai.setActiveCell(am.cellID)}ai.selectNodeModel(am.nodeModel,true,al.options.shiftKey);var ak=ai.getTreeDocument();if(ak&&!ak.options.shouldBeSelected.call(ak,am.nodeModel)){aj.checkFlag=false}}else{ai.unselectNodeModel(am.nodeModel)}}}else{if(aj.checkFlag){ai.selectAllVisibleNodes()}else{ai.unselectAll()}}ai._selectAllCheckBoxListenChange=true}}});this._managePointerEvents();this._manageContextualMenu()},_manageContextualMenu:function(){var ai=this;if(ai._ctxMenuToken===undefined){ai._ctxMenuToken=r.addEventListener(this.elements.container,{callback:function(al){var ak=ai.getCellInfosFromHtmlElement(al.info.target);if(ak){ai.setActiveCell(ak.cellID);var aj=ai.isCellOrNodeModelSelected(ak.cellID);if(!aj){ai.selectCell(ak.cellID,false)}}else{ai.setActiveCell(-1)}return ai.onContextualEvent.call(ai,{context:al.context,collectionView:ai,infos:al.info,data:al.data,cellInfos:ak})}})}},buildDefaultContextualMenu:function(aj,ai){return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(aj,ai):[]},loadCustomViews:function(ai,aj){},showCustomViewsDialog:function(){if(this._contextualMenuBuilder){this._contextualMenuBuilder.showCustomViewsDialog()}},showModelMassUpdateDialog:function(){if(!this._modelMassUpdateDialog){var ap=this;this._modelMassUpdateDialog=new v({identifier:this.identifier+"_MassUpdate",treeDocument:this.treeDocument,setNodeModelValueFunction:function(aw,ar,av){var at=aw.options.grid;if(at.hasOwnProperty(ar)||(ap.layout.getColumnGetCellValue(ar)!==undefined)){var au=ap.layout.getCellIDFromCoordinates({rowID:aw._getRowID(),columnID:ao.getColumnIndex(ar)});if(ap.getCellEditableState(au)){ap.setNodeModelValue(aw,ar,av);ap._flashEffectOnCell("ui-modified",au)}}},autoCloseFlag:false,resizableFlag:true,width:500,height:500})}var ak=[];var ao=this.layout;var aq=ao.getLeafColumns();var al=ao.getVisibleOrderedColumnsIndexes();for(var am=0;am<al.length;am++){var an=al[am];if(ao.getColumnEditableFlag(an)&&ao.getColumnMassUpdateAllowedFlag(an)){var aj=aq[an];if(aj){var ai={name:aj.dataIndex,label:aj.text,typeRepresentation:ao.getColumnTypeRepresentation(an)};ak.push(ai)}}}this._modelMassUpdateDialog.attributes=ak;this._modelMassUpdateDialog.resetAttributesValues();this._modelMassUpdateDialog.immersiveFrame=this.getContainingImmersiveFrame();this._modelMassUpdateDialog.visibleFlag=true},getContainingImmersiveFrame:function(){var ai=H.firstParentWithClass(this.getContent(),"wux-windows-immersive-frame");return(ai)?ai.dsModel:undefined},_onPrivateScrollEnd:function(){if((this._tweakerToGenerateCount===0)&&!this._renderingTaskInterrupted){this._onAllCellsRendered()}},_onPrivateReady:function(){if(this._tweakerToGenerateCount===0){this._onAllCellsRendered()}},_requestDelayedModelData:function(){if(this.onDelayedModelDataRequest){var ai=this;var an=this.layout;var am=ai.getViewportDimensions();if(am.height>0){var aj=an.getMinMaxVisibleRowIDs();var ak=aj.minRowID;var al=aj.maxRowID;var ao=an.getDisplayedColumnsIndexes();ai._rowModel.prepareUpdate();ai.onDelayedModelDataRequest.call(ai,{collectionView:ai,startNodeIndex:ak,endNodeIndex:al,displayedColumnsIndexes:ao});ai._rowModel.pushUpdate()}}},cellShouldBeSelected:function(aj){var ai=this.layout.getCellCoordinatesAt(aj);return((ai.rowID>=0)&&(!this.layout.rowsHeader||(ai.columnID!==-1)))},cellShouldBeUnselected:function(ai){return this.cellShouldBeSelected(ai)},getEditionManager:function(ak){var ai=this.layout.getCellCoordinatesAt(ak);var aj=this.layout.getColumnEditionPolicy(ai.columnID);if(!this._editionManagers[aj]){if(aj==="EditionOnDoubleClick"){this._editionManagers[aj]=new q()}else{if(aj==="EditionOnClick"){this._editionManagers[aj]=new N()}else{if(aj==="EditionOnOver"){this._editionManagers[aj]=new B()}else{if(aj==="EditionInPlace"){this._editionManagers[aj]=new g()}else{return null}}}}if(this._editionManagers[aj]){this._editionManagers[aj].collectionView=this}}return this._editionManagers[aj]},_onEditionModeChanged:function(al,aj){if(!aj){var ak=this.layout;var ai=ak.getCellCoordinatesAt(al);if(ak.getColumnAutoRowHeightFlag(ai.columnID)){ak.resetRowHeight(ai.rowID)}}},_managePointerEvents:function(){var ai=this;this._selectionHasBeenDoneOnDown=false;H.addEventOnElement(this,this,l.POINTERDOWN,function(aj,ak){ai.callMethodFromUIInteraction("_onCapturePointerDown",aj,ak)},true);H.addEventOnElement(this,this,l.POINTERMOVE,function(aj,ak){ai.callMethodFromUIInteraction("_onPointerMove",aj,ak)});H.addEventOnElement(this,this,l.POINTERUP,function(aj,ak){ai.callMethodFromUIInteraction("_onPointerUp",aj,ak)});H.addEventOnElement(this,this,l.POINTERHIT,function(aj,ak){ai.callMethodFromUIInteraction("_onPointerHit",aj,ak)});H.addEventOnElement(this,this,"dblclick",function(al,am){if(z){var aj=ai.layout;var ak=aj.getLeafColumns();if(k>=0&&k<ak.length){if(aj.getColumnResizableFlag(k)===true){ai.sizeColumnToFit(k,{isUserInteraction:true});if(aj.getColumnAutoRowHeightFlag(k)||aj.hasAutoWidthColumnWithAutoRowHeightFlag()){aj.resetRowHeights()}}}}})},_onPointerHit:function(an,ap){if(ap&&(ap.rowID===-1)){if(an.multipleHitCount===1&&!this._selectionHasBeenDoneOnDown){if(ap.columnID>-1){this._manageCellSelection(an,ap)}}this._selectionHasBeenDoneOnDown=false;if(!z){var aj=this.layout;var ak=aj.getColumnSortableFlag(ap.columnID);if(ak){var al=aj.getDataIndexFromColumnIndex(ap.columnID);var ao=[];var am;var aq=this.sortModel;if(aq&&(aq.length>0)){for(var ai=0;ai<aq.length;ai++){if(aq[ai].dataIndex===al){am=(aq[ai].sort==="asc")?"desc":"asc";ao.push({dataIndex:al,sort:am});if(!an.ctrlKey){break}}else{if(an.ctrlKey){ao.push(aq[ai])}}}}if(am===undefined){am="asc";ao.push({dataIndex:al,sort:am})}this.setPropertyFromUIInteraction("sortModel",ao);aj._saveColumnSortModelInPreferences()}}}},_onPointerUp:function(ai,aj){if(b&&(k!==undefined)&&((this.layout.getColumnAutoRowHeightFlag(k))||this.layout.hasAutoWidthColumnWithAutoRowHeightFlag())){this.layout.resetRowHeights()}b=false;this.getContent().removeAttribute("is-resizing-column")},_onPointerMove:function(ak,al){if(b&&(k!==undefined)){var ai=this.layout.getColumnPinned(k);var aj=0;if(ai==="right"){aj=X+(y-ak.clientX)}else{aj=X+(ak.clientX-y)}aj=Math.max(0,aj);this.layout.setColumnWidth(k,aj,{isUserInteraction:true});return}this._computeResizedColumnID(ak,al)},_onCapturePointerDown:function(ao,aq){if(ao.target.hasClassName&&ao.target.hasClassName("wux-layouts-treeview-expander")){return}this.PointerDownScope=true;this._computeResizedColumnID(ao,aq);if(z&&(k!==undefined)&&(k>=0)){b=true;ao.preventDefault();ao.stopPropagation();ao.stopImmediatePropagation();y=ao.clientX;X=this.layout.getColumnComputedWidth(k)}else{if(aq&&(aq.rowID!==-1)){var ai=this.getEditionManager(aq.cellID);if(ai){ai.onCellPointerDown(aq.cellID)}this._selectionHasBeenDoneOnDown=false;if(aq.columnID>-1&&!l.isTouchEvent(ao)){this._manageCellSelection(ao,aq);this._selectionHasBeenDoneOnDown=true}}else{if(!aq){var al=false;if((ao.target===this.elements.scroller.getContent())||(ao.target===this.elements.rightScroller.getContent())){var ap=ao.target.getDimensions();var ar=this.layout.getContentDimensions();var aj=this.layout.getRightContainerWidth();var an=e.Utils.Client.getScrollbarWidth();var ak=((ao.target===this.elements.scroller.getContent())&&(ap.width<ar.width));var am=((ap.height<ar.height)&&(((aj===0)&&(ao.target===this.elements.scroller.getContent()))||((aj!==0)&&(ao.target===this.elements.rightScroller.getContent()))));if((ak&&(ao.offsetY>=ap.height-an)&&(ao.offsetY<=ap.height))||(am&&(ao.offsetX>=ap.width-an)&&(ao.offsetX<=ap.width))){al=true}}if(!al){if(this.selectionBehavior.unselectAllOnEmptyArea){this.unselectAll()}this.setActiveCell(-1)}}}}this.PointerDownScope=false},_manageCellSelection:function(ak,al){var ai=(this.selectionBehavior.toggle||ak.ctrlKey);var aj=this.isCellOrNodeModelSelected(al.cellID);if(aj&&this._isCellInEdition(al.cellID)){this.setActiveCell(al.cellID);return}if(ai&&aj){this.unselectCell(al.cellID);this.setActiveCell(al.cellID)}else{this.selectCell(al.cellID,ai,ak.shiftKey)}},_computeResizedColumnID:function(ai,ap){var ar=this;var al=Q.debounce(function(){if(b===false){ar.getContent().removeAttribute("is-resizing-column")}},1);var ak=this.layout;if(ap&&(ap.columnID>-1)&&((ap.rowID<=-1)||(ap.columnID===ak._lastLeftPinnedColumnIndex)||(ap.columnID===ak._firstRightPinnedColumnIndex)||(ap.columnID===ak._firstUnpinnedColumnIndex))){k=-1;var am=ak.getColumnOrGroupFromCoordinates(ap);var aj,an,aq,ao;if(am){aj=ak.getColumnOrGroupComputedWidth(am);an=ak.getColumnOrGroupPinned(am);aq=ak.getFirstLeafColumnIndex(am);ao=ak.getLastLeafColumnIndex(am)}else{aj=ak.getColumnComputedWidth(ap.columnID);an=ak.getColumnPinned(ap.columnID);aq=ap.columnID;ao=ap.columnID}if((ai.offsetX>=0)&&(ai.offsetX<=j)){if(an==="right"){k=aq}else{if((ap.rowID<=-1)||(ap.columnID===ak._firstUnpinnedColumnIndex)){k=ak._getPreviousVisibleColumnID(aq)}}}else{if((ai.offsetX>=aj-j)&&(ai.offsetX<=aj)){if(an==="right"){if(ap.rowID<=-1){k=ak._getNextVisibleColumnID(ao)}}else{if((ap.rowID<=-1)||(ap.columnID===ak._lastLeftPinnedColumnIndex)){k=ao}}}}}else{k=undefined;if(((ai.target===this.elements.leftScrollContainer)||(ai.target===this.elements.leftSpacerContainer))&&(ai.offsetX>=this.elements.leftScrollContainer.clientWidth-j)){k=ak._lastLeftPinnedColumnIndex}else{if(((ai.target===this.elements.rightScrollContainer)||(ai.target===this.elements.rightScroller.getContent())||(ai.target===this.elements.rightSpacerContainer))&&(ai.offsetX<=j)){k=ak._firstRightPinnedColumnIndex}}}if((k>=0)&&ak.getColumnResizableFlag(k)){z=true;ar._preventScroll=true;this.getContent().setAttribute("is-resizing-column","true")}else{z=false;ar._preventScroll=false;k=undefined;al()}},_getNodeModelAt:function(aj){var ai=this.layout.getCellCoordinatesAt(aj);if(this._rowModel){return this._rowModel.getVisibleNodeModel(ai.rowID)}return undefined},getModelAt:function(am){var al=this.layout;var aq=al.getCellCoordinatesAt(am);if(aq.rowID<=-1){var an=al.getColumnOrGroupFromCoordinates(aq);if(an){return aq.columnID>-1?an.text:""}}else{if(aq.columnID===-1){return""+(aq.rowID+1)}else{if(aq.columnID>-1){var aj=al.getColumnGetCellValue(aq.columnID);if(aj){var ap=this.getLightCellInfosAt(am);ap.nodeModel=this.model[aq.rowID];return aj.call(this,ap)}var ai=this.model[aq.rowID];if(ai){var ao=al.getDataIndexFromColumnIndex(aq.columnID);if(ao==="tree"){var ak=al._getCellTypeRepresentation({cellID:am,columnID:aq.columnID,rowID:aq.rowID,cellModel:ai.options.label,nodeModel:ai});if(ak==="string"){return ai.options.label}}return ai.getAttributeValue(ao)}else{console.log("!! No TreeNodeModel at rowID = "+aq.rowID);return""}}else{return""}}}},setModelAt:function(al,am,an){var ak=this.layout;var ai=ak.getCellCoordinatesAt(al);var ao=this.model[ai.rowID];if(ao){var aj=ak.getDataIndexFromColumnIndex(ai.columnID);this.setNodeModelValue(ao,aj,am,an)}else{if(ai.rowID!==-1){console.log("!! setModelAt NO TreeNodeModel at rowID = "+ai.rowID+" cellID = "+al)}}},setNodeModelValue:function(ai,ao,ap,at){if(ai){var al=this.layout;var an=ai._getRowID();var ak=al.getColumnIndex(ao);var am=al.getCellIDFromCoordinates({rowID:an,columnID:ak});var ar=al.getColumnSetCellValue(ao);if(ar){var aq=this.getLightCellInfosAt(am);aq.nodeModel=ai;if(at===undefined){at=ai.getReferenceValue(ao);if(at===undefined){at=e.clone(ap,false)}}ai.setReferenceValue(ao,at);return ar.call(this,aq,ap)}if(ao==="tree"){var aj=al._getCellTypeRepresentation({cellID:am,columnID:ak,rowID:an,cellModel:ap,nodeModel:ai});if(aj==="string"){ai.setLabel(ap)}}ai.setAttribute(ao,ap)}},getCellInfosAt:function(ak){var aj=this.getModelAt(ak);var ai=this.layout.getCellCoordinatesAt(ak);var al=this.model[ai.rowID];return{cellID:ak,columnID:ai.columnID,rowID:ai.rowID,cellModel:aj,nodeModel:al}},getLightCellInfosAt:function(aj){var ai=this.layout.getCellCoordinatesAt(aj);return{cellID:aj,columnID:ai.columnID,rowID:ai.rowID}},getXSOElementID:function(ai){return ai?ai.id:undefined},_getXSOElementFromCellID:function(al){var ak=this.layout;var ai=ak.getCellCoordinatesAt(al);var aj=ak.getDataIndexFromColumnIndex(ai.columnID);var am=this.model[ai.rowID];return{id:(ai.rowID+"_"+aj),rowID:ai.rowID,columnDataIndex:aj,nodeModel:am}},_getCellIDFromXSOElement:function(ai){var al=-1;if(ai){var am=ai.rowID;var ak=this.layout;var aj=ak.getColumnIndex(ai.columnDataIndex);al=ak.getCellIDFromCoordinates({rowID:am,columnID:aj})}return al},_updateXSOElements:function(){var ai=this.getCellsXSO();if(ai){var ak=ai.get();var aj=this;ak.forEach(function(al){var an=aj.model[al.rowID];if(an!==al.nodeModel){aj.unselectCell(aj._getCellIDFromXSOElement(al));if(al.nodeModel.isVisible()){var am=aj.layout.getCellIDFromCoordinates({rowID:al.nodeModel._getRowID(),columnID:aj.layout.getColumnIndex(al.columnDataIndex)});aj.selectCell(am,true,false,false)}}})}},_updateActiveCell:function(ai){if(ai){if(!ai.nodeModel){this.setActiveCell(-1);return}var ak=undefined;if(ai.rowID>=0&&ai.rowID<this.model.length){ak=this.model[ai.rowID]}if(ak!==ai.nodeModel){if(ai.nodeModel.isVisible()){var aj=this.layout.getCellIDFromCoordinates({rowID:ai.nodeModel._getRowID(),columnID:this.layout.getColumnIndex(ai.columnDataIndex)});this.setActiveCell(aj,false)}else{this.setActiveCell(-1)}}}},_onSpaceKeyPressed:function(){var ak=this.getActiveCellID();var al=this._getNodeModelAt(ak);if(al){var aj=this.getNodesXSO();if(aj){var ai=aj.isIn(al);if(ai){this.unselectNodeModel(al)}else{this.selectNodeModel(al,true,false)}}}},_copyToPlainText:function(){var at=this.getNodesXSO();var av=this;var aA="";var am=undefined;if(!at.isEmpty()){am=at.get().filter(function ax(aC){return aC.isVisible()})}if(am&&am.length>0){am.sort(function(aD,aC){if(aD._rowID<=aC._rowID){return -1}else{return 1}});for(var al=0;al<am.length;al++){var ao=am[al];var aw=av.layout.getCellsFromNodeModel(ao,true);for(var aB=0;aB<aw.length;aB++){var ai=av.getCellInfosAt(aw[aB]);var ak=av._getCellValueForCopy(ai);if(ak!==undefined){aA+=ak}if(aB<aw.length-1){aA+="\t"}}if(al<am.length-1){aA+="\n"}}}else{var az=this.getCellsXSO();if(!az.isEmpty()){var aq=av.layout._getXSORectangularShape();if(aq===undefined){ac("ClipboardError","ClipboardActionKoMultipleSelection")}else{for(var au=aq.minRowID;au<aq.minRowID+aq.height;au++){var ap=aq.minColumnID;for(var ar=0;ar<aq.width;ar++){var ay={rowID:au,columnID:ap};var an=av.layout.getCellIDFromCoordinates(ay);var aj=av.getCellInfosAt(an);var ak=av._getCellValueForCopy(aj);if(ak!==undefined){aA+=ak}if(ar<aq.width-1){aA+="\t"}ap=this.layout._getNextVisibleColumnID(ap)}if(au<aq.minRowID+aq.height-1){aA+="\n"}}}}}return aA},_pasteFromPlainText:function(aH){var am=ad(aH);if(!am||!am.length||!am[0]||!am[0].length){return}var aF=am.length;var aG=am[0].length;for(var aC=1;aC<aF;aC++){if(am[aC].length!==aG){ac("ClipboardError","InconsistentNbColumnsPerRowsInClipboard");return}}var at=this.getNodesXSO();var ak=undefined;if(!at.isEmpty()){ak=at.get().filter(function aw(aI){return aI.isVisible()})}if(ak&&ak.length>0){var aj=this.layout.getVisibleOrderedColumnsIndexes();var az=aj.length;if(az!==aG){ac("ClipboardError","NbColumnsOfClipboardNotEqualToNbVisibleColumns");return}else{ak.sort(function(aJ,aI){if(aJ._rowID<=aI._rowID){return -1}else{return 1}});this._rowModel.prepareUpdate();this.prepareUpdateView();var aq=0;for(var aB=0;aB<aj.length;aB++){var an=aj[aB];var aE=0;for(var av=0;av<am.length;av++){var ax={rowID:ak[av+aE]._rowID,columnID:an};var al=this.layout.getCellIDFromCoordinates(ax);var ap=am[av][aq];if(this.getCellEditableState(al)){var ai=this.getCellInfosAt(al);this.setModelAt(al,this._processCellValueFromPaste(ai,ap));this._flashEffectOnCell("ui-modified",al)}else{this._flashEffectOnCell("ui-notmodified",al)}if(av+aE===ak.length-1){break}if(av===am.length-1&&ak.length>am.length){av=-1;aE+=am.length}}aq++}this._rowModel.pushUpdate();this.pushUpdateView()}}else{var ay=this.getCellsXSO();var au=this.getActiveCellID();var ar=ay.get();var ao=undefined;if(ar.length>1){ao=this.layout._getXSORectangularShape();if(ao===undefined){ac("ClipboardError","MultipleSelection");return}au=this.layout.getCellIDFromCoordinates({rowID:ao.minRowID,columnID:ao.minColumnID})}else{if(ar.length===1){au=this._getCellIDFromXSOElement(ar[0])}}this._rowModel.prepareUpdate();this.prepareUpdateView();var aA=this.layout.getCellCoordinatesAt(au);var aE=0;for(var av=0;av<am.length;av++){var aD=aA.columnID;for(var aq=0;aq<am[av].length;aq++){var ax={rowID:aA.rowID+av+aE,columnID:aD};var al=this.layout.getCellIDFromCoordinates(ax);var ai=this.getCellInfosAt(al);var ap=am[av][aq];if(this.getCellEditableState(al)){this.setModelAt(al,this._processCellValueFromPaste(ai,ap));this._flashEffectOnCell("ui-modified",al)}else{this._flashEffectOnCell("ui-notmodified",al)}aD=this.layout._getNextVisibleColumnID(aD);if(aD===-1){break}if(ao){if(aq===ao.width-1){break}}}if(ao){if(av+aE===ao.height-1){break}if(av===am.length-1&&ao.height>am.length){av=-1;aE+=am.length}}}this._rowModel.pushUpdate();this.pushUpdateView()}},getCellIDAsString:function(aj){var ak=this.layout.getCellCoordinatesAt(aj);var ai=-1;if(ak.columnID>-1){ai=this.layout._orderedColumnsReverseIndexes[ak.columnID]}return ak.rowID+":"+ai},getAsCSV:function(al){var ar=this.getNodesXSO();var au=this;var aF=this.layout;var aC="";var aq=undefined;if(al&&al.onlySelectedRows){if(!ar.isEmpty()){aq=ar.get().slice();aq.sort(function(aJ,aI){if(aJ._rowID<=aI._rowID){return -1}else{return 1}})}}else{aq=au.model}if(!aq){return}var av=(al?al.columnKeys:undefined);var ao=aF.getLeafColumns();if(!av){if(al&&al.allColumns){av=new Array(ao.length);for(var ap=0;ap<ao.length;ap++){av[ap]=ap}}else{av=aF.getVisibleOrderedColumnsIndexes()}}else{for(var aD=0;aD<av.length;aD++){av[aD]=aF.getColumnIndex(av[aD])}}var aG=(al&&al.columnSeparator?al.columnSeparator:",");var aB,aA,aj,aw,aE,ax=[],an=[];for(aB=0;aB<av.length;aB++){aw=aF.getColumnOrGroupFromCoordinates({rowID:-1,columnID:av[aB]});ax=[];aE=aw;while(aE){ax.push(aE);aE=aE._parent}for(aA=0;aA<aF._getColumnTreeDepth();aA++){if(!an[aA]){an[aA]="";if(al.addLevelInformation){if(al.forceQuotes){an[aA]+='""'}an[aA]+=aG}}aj=(ax[aA]&&ax[aA].text)?ax[aA].text:"";aj=aj.replace(/\"/g,'""');if((al&&al.forceQuotes)||aj.search(aG)!==-1){an[aA]+='"'+aj+'"'}else{an[aA]+=aj}if(aB<av.length-1){an[aA]+=aG}}}var az;for(az=(an.length-1);az>=0;az--){aC+=an[az];aC+="\n"}for(var at=0;at<aq.length;at++){var aH=aq[at];var ak=false;for(var aD=0;aD<av.length;aD++){var am=aF.getCellIDFromCoordinates({rowID:aH._rowID,columnID:av[aD]});var ai=au.getCellInfosAt(am);if(al.addLevelInformation&&!ak&&ai&&ai.nodeModel){ak=true;aC+=ai.nodeModel._nodeDepth;aC+=aG}if(ai.cellModel!==undefined){var ay=au._getCellValueForExport(ai);if(typeof ay==="string"){ay=ay.replace(/\"/g,'""');if((al&&al.forceQuotes)||ay.search(aG)!==-1){aC+='"'+ay+'"'}else{aC+=ay}}}if(aD<av.length-1){aC+=aG}}if(at<aq.length-1){aC+="\n"}}return aC},isCellSelected:function(an){var aj=false;var am=this.layout;var ai=am.getCellCoordinatesAt(an);if((ai.columnID===am._leftPinnedRowcolumnID)||(ai.columnID===am._unpinnedRowcolumnID)||(ai.columnID===am._rightPinnedRowcolumnID)||(ai.columnID===-1)){var ao=this._getNodeModelAt(an);if(ao){var al=this.getNodesXSO();if(al){aj=al.isIn(ao)}}}else{var ak=this.cellSelection;if((ak==="single")||(ak==="multiple")){aj=(this._XSO&&this._XSO.isIn(this._getXSOElementFromCellID(an)))}}return aj},isCellOrNodeModelSelected:function(am){var aj=false;var al=this.rowSelection;var ai=this.cellSelection;if((ai==="single")||(ai==="multiple")){aj=this.isCellSelected(am)}else{if((al==="single")||(al==="multiple")){var an=this._getNodeModelAt(am);if(an){var ak=this.getNodesXSO();if(ak){aj=ak.isIn(an)}}}}return aj},_getCellValueForExport:function(aj){var ai=undefined;if(aj.nodeModel._isFromOriginalModel()){ai=this.layout.getColumnOptionValue(aj.columnID,"getCellValueForExport")}if(!(ai instanceof Function)){ai=V}return ai.call(this,aj)},_getCellValueForCopy:function(aj){var ai=undefined;if(aj.nodeModel._isFromOriginalModel()){ai=this.layout.getColumnOptionValue(aj.columnID,"getCellValueForCopy")}if(!(ai instanceof Function)){ai=V}return ai.call(this,aj)},_getCellValueForSort:function(ak,aj){var ai=this.layout.getColumnOptionValue(aj,"getCellValueForSort");if(!(ai instanceof Function)){ai=af}return ai.call(this,ak,aj)},_processCellValueFromPaste:function(ak,ai){var aj=undefined;if(ak.nodeModel._isFromOriginalModel()){aj=this.layout.getColumnOptionValue(ak.columnID,"processCellValueFromPaste")}if(!(aj instanceof Function)){aj=T}return aj.call(this,ak,ai)},insertRowCallback:function(ai,ak,aj){},});return ah});define("DS/DataGridView/RowModelServerSide",["DS/DataGridView/RowModelBase","DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel",],function(c,b,a,e){var d=c.inherit({name:"RowModelServerSide",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},dataSource:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"},},_applyProperties:function(f){this._parent(f);if(this.isDirty("dataSource")){this._applyDataSource(f.dataSource)}if(this.isDirty("sortModel")){this._applySortModel(f.sortModel)}},getFilterViewManager:function(){return null},_loadRows:function(k){if(!this._treeDocument){return}if(!k){k=this._treeDocument._getTrueRoot()}if(!k){return}if(k._dgv_allRowsLoaded){return}var q=this.dataGridView;var m=this;var o=[];var n=k.getParents(true);if(n.length>=1){for(var j=n.length-1;j>0;j--){o.push(n[j].options.label)}o.push(k.options.label)}var p;p=(k.getChildren()?k.getChildren().length:0);var h=p+100;var g={startRow:p,endRow:h,sortModel:m.sortModel,rowGrouping:m._groupingOptions,groupKeys:o};var f=function(v,u){m.prepareUpdate();for(var t=0;t<v.length;t++){var s=v[t];var r=new e({label:s.tree,icons:(s.icon?[s.icon]:undefined),grid:s,children:s.dgv_group?[]:undefined});k.addChild(r)}if(u>-1){k._dgv_allRowsLoaded=true}if(p===0){k.preExpandDone()}m._syncModel();if(m._modalLoaderDisplayed===true){q.removeModalLoader();m._modalLoaderDisplayed=false}if(q.model&&q.model.length===0){q._displayEmptyContentMessage()}else{q._removeEmptyContentMessage()}m._gettingRowsFlag=false;m.pushUpdate()};var l=function(){if(m._modalLoaderDisplayed===true){q.removeModalLoader();m._modalLoaderDisplayed=false}m._gettingRowsFlag=false};m._gettingRowsFlag=true;if(q.model.length===0){q.displayModalLoader("Loading data");m._modalLoaderDisplayed=true}m.dataSource.getRows({request:g,successCallback:f,failCallback:l})},getVisibleNodeModel:function(j){if(j<0){return undefined}var g=this.dataGridView;var k=undefined;if(j<g.model.length){k=g.model[j]}var i=k;if(!i&&g.model.length){i=g.model[g.model.length-1]}if(this._gettingRowsFlag!==true){var f=undefined;if(k){f=i.getParent()}if(!f){f=this._treeDocument._getTrueRoot()}if(i&&f){var h=i._getLocalID();if(h+20>f.getNumberOfChildren()){this._loadRows(f)}}else{if(!k||k!=i){this._loadRows(f)}}}return k},_isModelBeingFetched:function(){return this._gettingRowsFlag},_getTreeDocument:function(){if(!this._treeDocument){this._treeDocument=new a({useAsyncPreExpand:true});this._listenToTreeDocument();var f=this;this._treeDocument.onPreExpand(function(g){var h=false;var i=g.target;if(i){if(i.getChildren()!==undefined&&i.getChildren().length===0){i.setState({state:"expanding"});f._loadRows(i);h=true}}if(!h){i.preExpandDone()}})}return this._treeDocument},_resetTreeDocument:function(){this.dataGridView.getCellsXSO().empty();if(this._treeDocument){this._treeDocument.empty()}if(this.dataSource){this._getTreeDocument();this._syncModel();this.getVisibleNodeModel(0)}},_applyDataSource:function(f){if(this.dataGridView._isReady){this._resetTreeDocument()}},_applySortModel:function(f){if(this.dataGridView._isReady){this._resetTreeDocument()}},_doGroupingOnModel:function(f){if(this.dataGridView._isReady){this._resetTreeDocument()}},_findAllCellIDsMatchingFindStr:function(f,g,h){throw"_findAllCellIDsMatchingFindStr is not implemented on the ROWModelServerSide"}});return d});
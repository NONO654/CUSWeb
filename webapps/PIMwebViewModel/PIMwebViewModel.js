/*!  Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/PIMwebViewModel/PIMwebUtils",["DS/WAFData/WAFData"],function(i){var h=function(k){return{input_physical_ids:[k],label:"PIMwebIsr"+Date.now(),primitives:[{navigate_to_rel:{id:1,filter:{bo_type:["dsc_Model_Category_Ref"]}}},{navigate_to_rel:{id:2}},{navigate_to_sr:{id:3,filter:{semantics:["5"],role:["79"]},mode:"last"}},{navigate_to_rel:{id:4,filter:{bo_type:["dsc_Result_Category_Ref"]}}},{navigate_to_rel:{id:5}}],patterns:{model:[{id:1},{id:2},{id:3}],itfCtxt:[{id:4},{id:5}]},fileAttributes:[],version:3}},j=function(k){return{input_physical_ids:[k],label:"PIMwebIsrToContext"+Date.now(),primitives:[{navigate_to_rel:{id:1,filter:{bo_type:["dsc_Model_Category_Ref"]}}},{navigate_to_rel:{id:2}},{navigate_to_sr:{id:3,filter:{semantics:["5"],role:["79"]},mode:"last"}}],patterns:{model:[{id:1},{id:2},{id:3}]},fileAttributes:[],version:3}},c=function(k){return{input_physical_ids:k,label:"PIMwebItfCtxt"+Date.now(),primitives:[{navigate_to_sr:{id:1,filter:{semantics:["6"],role:["198"]},mode:"last"}},{navigate_to_rel:{id:2}},{navigate_to_sr:{id:3,filter:{semantics:["5"],role:["201"]},mode:"path"}},{navigate_to_sr:{id:4,filter:{semantics:["5"],role:["197"]},mode:"path"}}],patterns:{ms:[{id:1}],r2sca:[{id:4}],sca2occ:[{id:1},{id:2},{id:3}]},attributes:["ds6w:label","ds6w:type","owner","current","bo.PLMEntity.V_description","bo.PLMPIMMetricReference.V_Itf_Analysis","bo.PLMPIMMetricReference.V_Itf_Previous_Analysis","bo.PLMPIMMetricReference.V_Itf_Type","bo.PLMPIMMetricReference.V_Itf_User_Type","bo.PLMPIMMetricReference.V_Itf_Real_Tolerance_Used_For_Computation","bo.PLMPIMMetricReferenceClashContact.V_Itf_Penetration_Value","bo.PLMPIMMetricReferenceClashContact.V_Itf_FirstPointFoundClash","bo.PLMPIMMetricReferenceClashContact.V_Itf_SecondPointFoundClash","bo.PLMPIMMetricReferenceClearance.V_Itf_Distance_Min","bo.PLMPIMMetricReferenceClearance.V_Itf_FirstPointFoundClearance","bo.PLMPIMMetricReferenceClearance.V_Itf_SecondPointFoundClearance"],fileAttributes:[],version:3}},e=function(k){return{input_physical_ids:k,label:"PIMwebItfMetric"+Date.now(),primitives:[{navigate_from_sr:{id:1,filter:{semantics:["6"],role:["198"]}}},{navigate_from_rel:{id:2}}],patterns:{itfCtxt:[{id:1}],isr:[{id:1},{id:2,iter:2}]},attributes:[],fileAttributes:[],version:3}},b=function(k){return{input_physical_ids:k,label:"PIMwebNavigateOneLevel"+Date.now(),primitives:[{navigate_to_rel:{id:1}}],patterns:{ref:[{id:1}]},fileAttributes:[],version:3}},d=function(m,o,k,l){var n={};Object.keys(m).forEach(function(p){n[p]=m[p]});n.method=o;n.url=(m.baseURL?m.baseURL:require("DS/PADUtils/PADUtilsServices").get3DSpaceUrl())+k;if(!n.securityContext){n.securityContext=require("DS/PADUtils/PADSettingsMgt").getSetting("pad_security_ctx")}n.tenant=n.tenant===null?"":("&tenant="+require("DS/PADUtils/PADUtilsServices").getPlatformId());n.data=l;return n},a=function(k){return i.authenticatedRequest(k.url+"?SecurityContext="+k.securityContext+k.tenant,{method:k.method,headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:k.securityContext},data:JSON.stringify(k.data),timeout:k.timeout,onComplete:k.onComplete,onFailure:k.onFailure,onTimeout:k.onTimeout||k.onFailure})};var g=Object.create({}),f=Object.getPrototypeOf(g);f._DEFAULT_PAGGING=500;f._navigateFromIsr=function(k){return a(d(k,"POST","/cvservlet/navigate",h(k.isrID)))};f._navigateFromIsrToContext=function(k){return a(d(k,"POST","/cvservlet/navigate",j(k.isrID)))};f._navigateFromContextualInterferences=function(k){return a(d(k,"POST","/cvservlet/navigate",c(k.ctxIDs)))};f._setAttrValue=function(k){return a(d(k,"POST","/resources/PIMwebModel/setAttributeValue",k.data))};f._navigateFromMetricToIsr=function(k){return a(d(k,"POST","/cvservlet/navigate",e(k.metricIDs)))};f._navigateOneLevel=function(k){return a(d(k,"POST","/cvservlet/navigate",b(k.ids)))};return g});define("DS/PIMwebViewModel/PIMwebUnits",["i18n!DS/PIMwebViewModel/assets/nls/PIMwebViewModel"],function(b){var a={Types:{Length:{name:"Length",defaultValue:"mm"},Angle:{name:"Angle",defaultValue:"deg"},Volume:{name:"Volume",defaultValue:"mm3"},Area:{name:"Area",defaultValue:"mm2"}},Length:{mm:{name:"mm",nls:b.units.mm,ratio:1},cm:{name:"cm",nls:b.units.cm,ratio:Math.pow(10,-1)},m:{name:"m",nls:b.units.m,ratio:Math.pow(10,-3)},km:{name:"km",nls:b.units.km,ratio:Math.pow(10,-6)},inch:{name:"inch",nls:b.units.inch,ratio:1/25.4},foot:{name:"foot",nls:b.units.foot,ratio:1/304.8}},Angle:{deg:{name:"deg",nls:b.units.deg,ratio:1},rad:{name:"rad",nls:b.units.rad,ratio:Math.PI/180}},Volume:{mm3:{name:"mm3",nls:b.units.mm3,ratio:1},cm3:{name:"cm3",nls:b.units.cm3,ratio:Math.pow(10,-3)},m3:{name:"m3",nls:b.units.m3,ratio:Math.pow(10,-9)},km3:{name:"km3",nls:b.units.km3,ratio:Math.pow(10,-18)},inch3:{name:"inch3",nls:b.units.inch3,ratio:1/16387.064},foot3:{name:"foot3",nls:b.units.foot3,ratio:1/28316846.6}},Area:{mm2:{name:"mm2",nls:b.units.mm2,ratio:1},cm2:{name:"cm2",nls:b.units.cm2,ratio:Math.pow(10,-2)},m2:{name:"m2",nls:b.units.m2,ratio:Math.pow(10,-6)},km2:{name:"km2",nls:b.units.km2,ratio:Math.pow(10,-12)},inch2:{name:"inch2",nls:b.units.inch2,ratio:1/645.16},foot2:{name:"foot2",nls:b.units.foot2,ratio:1/92903.04}}};return Object.freeze(a)});define("DS/PIMwebViewModel/PIMwebIsr",["UWA/Core","UWA/Class","DS/CoreEvents/ModelEvents","DS/PIMwebViewModel/PIMwebUtils"],function(m,s,k,i){var p=1,e={},l={1:"Clash",2:"Contact",3:"Clearance",4:"Contact",5:"NoInterference",6:"Undefined"},j={1:"OK",2:"KO",3:"NotAnalyzed",4:"NotAnalyzed",5:"NotAnalyzed"},b={"bo.PLMEntity.V_description":"itfDescription","bo.PLMPIMMetricReference.V_Itf_Analysis":"itfAnalysis","bo.PLMPIMMetricReference.V_Itf_Previous_Analysis":"itfPrevAnalysis","bo.PLMPIMMetricReference.V_Itf_Type":"itfSystemType","bo.PLMPIMMetricReference.V_Itf_User_Type":"itfUserType","bo.PLMPIMMetricReference.V_Itf_Real_Tolerance_Used_For_Computation":"itfTolerance","bo.PLMPIMMetricReferenceClashContact.V_Itf_Penetration_Value":"itfQuantifier","bo.PLMPIMMetricReferenceClearance.V_Itf_Distance_Min":"itfQuantifier","bo.PLMPIMMetricReferenceClashContact.V_Itf_FirstPointFoundClash":"itfQtfPt1","bo.PLMPIMMetricReferenceClashContact.V_Itf_SecondPointFoundClash":"itfQtfPt2","bo.PLMPIMMetricReferenceClearance.V_Itf_FirstPointFoundClearance":"itfQtfPt1","bo.PLMPIMMetricReferenceClearance.V_Itf_SecondPointFoundClearance":"itfQtfPt2",owner:"itfOwner",current:"itfCurrent"},g=["physicalid","type","itfMetricName","itfOwner","itfCurrent","itfDescription","itfAnalysis","itfPrevAnalysis","itfSystemType","itfUserType","itfTolerance","itfQuantifier","itfQtfPt1","itfQtfPt2"],o=["physicalid","itfCtxName"];function q(v){var u=Number(v);return isNaN(u)||u<0?null:u}function n(v){var u=Number(v);return isNaN(u)?null:u}function r(u){Object.keys(u).forEach(function(v){var w=b[v];if(w){u[w]=u[v];delete u[v]}});return u}function h(u){u.itfCtxName=u["ds6w:label"];r(u);Object.keys(u).forEach(function(v){if(o.indexOf(v)===-1){delete u[v]}});return u}function d(u){u.itfMetricName=u["ds6w:label"];u.type=u["ds6w:type"];r(u);Object.keys(u).forEach(function(v){if(g.indexOf(v)===-1){delete u[v]}});return u}function c(x,w){var u,v;for(u in x){if(x.hasOwnProperty(u)&&x[u]===w){v=u}}return v}function f(v){var u=String(window.widget?window.widget.id+"_":"")+v;window.top.performance.measure(u,u)}function t(u){window.top.performance.mark(String(window.widget?window.widget.id+"_":"")+u)}var a=(function(){var v=[],u=0,x=5,z=0,y=function(A,C,B){f("PIM_QueryCtx_"+A);u--;a();setTimeout(function(){B(C)},0)},w=function(B,A){t("PIM_QueryCtx_"+A);var C=m.clone(B,false);C.onComplete=function(D){y(A,D,B.onComplete)};C.onFailure=function(D){y(A,D,B.onFailure)};C.onTimeout=function(D){y(A,D,B.onTimeout||B.onFailure)};i._navigateFromContextualInterferences(C)};return function(A){if(A){v.push(A)}if(v.length&&u<x){u++;z++;w(v.shift(),z)}}}());return s.extend({init:function(z){var B=this,y={physicalid:z.id,isrContext:[],nbItfs:-1,itfs:{}},A=new k(),x=function(D,C){return A.publish({event:D,data:C,context:B})};function u(H){if(!H||!H.contextualIDs||!H.onProgress||!H.onComplete||!H.onFailure){return}if(H.contextualIDs.length===0){H.onComplete({itfIDs:[],metricIDs:[]});return}var I=Math.floor((H.contextualIDs.length-1)/i._DEFAULT_PAGGING)+1,C=0,G=[],D=false,F;function E(J){if(D){return}G.push.apply(G,J.itfIDs);if(J.error){D=true;J.error.step="Metrics";J.error.isrID=y.physicalid;H.onFailure(J.error)}else{if(G.length===H.contextualIDs.length){H.onComplete({isrID:y.physicalid,itfIDs:G})}}}if(H.loadInterferingParts){F=function(M){var J=M.itfIDs,L=[],K=[];if(y.isrContext.length){J.forEach(function(P){var N=y.itfs[P],O=[y.isrContext[0].physicalid];if(N.r2sca){N.r2sca.forEach(function(Q){if(L.indexOf(Q.physicalid)===-1){L.push(Q.physicalid)}O.push(Q.physicalid)})}if(N.metricID&&e[N.metricID]&&e[N.metricID].sca2occ){e[N.metricID].sca2occ.forEach(function(S){var Q=O.slice();for(var R=0;R<S.length;++R){if(S[R].type==="VPMInstance"){if(L.indexOf(S[R].physicalid)===-1){L.push(S[R].physicalid)}}Q.push(S[R].physicalid)}K.push(Q)})}})}if(L.length){i._navigateOneLevel({ids:L,onComplete:function(P){var O=JSON.parse(P),N={};if(!O||!O.infos||O.infos.status!=="OK"||!O.result){return}O.result.forEach(function(Q){N[Q.input_object.physicalid]=Q.outputs.ref[0].physicalid});K.forEach(function(S){for(var Q=S.length-1,R;Q>=0;--Q){R=N[S[Q]];if(R){S.splice(Q+1,0,R)}}});H.onProgress({interferingParts:K,itfIDs:J,isrID:y.physicalid,metrics:M.metricIDs});E({itfIDs:J})},onFailure:function(){H.onProgress({itfIDs:J,isrID:y.physicalid,metrics:M.metricIDs});E({itfIDs:J})}})}else{H.onProgress({itfIDs:J,isrID:y.physicalid,metrics:M.metricIDs});E({itfIDs:J})}}}else{F=function(J){H.onProgress(J);E(J)}}while(C<I&&!D){performance.mark("iteration"+C);a({ctxIDs:H.contextualIDs.slice(C*i._DEFAULT_PAGGING,(C+1)*i._DEFAULT_PAGGING),onComplete:function(X){if(D){return}var Y=JSON.parse(X);if(!Y||!Y.infos||Y.infos.status!=="OK"||!Y.result){return}Y=Y.result;var U=Y.length,W=[],L=[],J,T,O,V,Q,K,S,N,M,R,P;for(V=0;V<U;++V){J=Y[V];T=h(J.input_object);O=J.outputs.ms?J.outputs.ms[0]:null;W.push(T.physicalid);if(O&&L.indexOf(O.physicalid)===-1){L.push(O.physicalid)}if(O&&!e[O.physicalid]){e[O.physicalid]=d(O)}else{if(O&&e[O.physicalid]){O=e[O.physicalid]}}if(O&&!O.ctxt){O.ctxt=[]}if(O&&O.ctxt&&O.ctxt.indexOf(T.physicalid)===-1){O.ctxt.push(T.physicalid)}T.metricID=O?O.physicalid:null;y.itfs[T.physicalid]=T;if(J.outputs.r2sca&&J.outputs.r2sca.length){T.r2sca=[];for(Q=0,R=J.outputs.r2sca[0].elements.length;Q<R;++Q){N=J.outputs.r2sca[0].elements[Q];T.r2sca.push({physicalid:N.physicalid,label:N["ds6w:label"],type:N["ds6w:type"]})}}if(J.outputs.sca2occ&&O&&!O.sca2occ){O.sca2occ=[];for(Q=0,R=J.outputs.sca2occ.length;Q<R;++Q){S=J.outputs.sca2occ[Q];M=[];for(K=0;K<S.elements.length;++K){N=S.elements[K];M.push({physicalid:N.physicalid,label:N["ds6w:label"],type:N["ds6w:type"]})}P=typeof S.sr_id==="number"?S.sr_id-1:Q;O.sca2occ[P]=M}}}F({itfIDs:W,metricIDs:L})},onFailure:function(J){D=true;if(!J){J={}}J.step="Metrics";H.onFailure(J)}});C++}}function w(D){if(!y.physicalid){D.onFailure({error:"No valid Simulation ID parameter (iSimulationID)"});D.onFailure({step:"Simulation"});return}var C=p++;t("PIM_QueryIsr_"+C+"_"+y.physicalid);i._navigateFromIsr({isrID:y.physicalid,onComplete:function(G){f("PIM_QueryIsr_"+C+"_"+y.physicalid);var I=JSON.parse(G),E;if(!I||!I.result||I.result.length!==1){D.onFailure({step:"Simulation"});return}E=I.result[0];if(!E||Object.keys(E.outputs).length===0){D.onFailure({step:"Simulation"});return}y.label=E.input_object["ds6w:label"];y.type=E.input_object["ds6w:type"];y.nbItfs=E.outputs.itfCtxt?E.outputs.itfCtxt.length:0;var F=E.outputs.model?E.outputs.model[0]:null,H=(E.outputs.itfCtxt)?(E.outputs.itfCtxt.map(function(J){return J.physicalid})):[];y.isrContext=F?[{physicalid:F.physicalid,label:F["ds6w:label"],type:F["ds6w:type"]}]:[];if(D.contextLoadMode==="AllParts"){D.onProgress({context:F?[F.physicalid]:[]})}u({loadInterferingParts:D.contextLoadMode==="InterferingPartsOnly",contextualIDs:H,onProgress:D.onProgress,onComplete:D.onComplete,onFailure:D.onFailure})},onFailure:function(E){f("PIM_QueryIsr_"+C+"_"+y.physicalid);if(!E){E={}}E.step="Simulation";D.onFailure(E)}})}function v(D){var C=p++;t("PIM_QueryIsrToContext_"+C+"_"+y.physicalid);i._navigateFromIsrToContext({isrID:y.physicalid,onComplete:function(F){f("PIM_QueryIsrToContext_"+C+"_"+y.physicalid);var G=JSON.parse(F),E;if(!G||!G.result||G.result.length!==1){D.onFailure();return}y.label=G.result[0].input_object["ds6w:label"];E=G.result[0].outputs&&G.result[0].outputs.model?G.result[0].outputs.model[0]:null;if(E&&y.isrContext.length===0){y.isrContext.push({label:E["ds6w:label"],physicalid:E.physicalid,type:E["ds6w:type"]})}u({loadInterferingParts:true,contextualIDs:D.contextualIDs,onProgress:D.onProgress,onComplete:D.onComplete,onFailure:D.onFailure})},onFailure:function(){f("PIM_QueryIsrToContext_"+C+"_"+y.physicalid);D.onFailure()}})}this._fetch=function(C){if(!y.physicalid||!C||!C.onProgress||!C.onComplete||!C.onFailure){C.onFailure();return}if(!C.contextualIDs){w(C)}else{if(C.contextualIDs.length>0){v(C)}}};this.getIsrContextIDs=function(){return y.isrContext.map(function(C){return C.physicalid})};this.getItfIDs=function(){return Object.keys(y.itfs)};this.getInterferences=function(C){var E=[],D=!C?Object.keys(y.itfs):!Array.isArray(C)?[C]:C;D.forEach(function(G){var H=y.itfs[G],F=e[H.metricID];var I={itfuid:G,itfModelId:y.physicalid,itfCtxName:H.itfCtxName,itfR2Sca:H.r2sca};if(F){I.itfMetricName=F.itfMetricName;I.itfSystemType=l[F.itfSystemType];I.itfUserType=l[F.itfUserType];I.itfAnalysis=j[F.itfAnalysis];I.itfPrevAnalysis=j[F.itfPrevAnalysis];I.itfQuantifier=q(F.itfQuantifier);I.itfDescription=F.itfDescription;I.itfTolerance=q(F.itfTolerance);I.itfOwner=F.itfOwner;I.itfCurrent=F.itfCurrent;I.itfSca2occ=F.sca2occ;I.itfQtfPt1=I.itfQuantifier>0&&F.itfQtfPt1&&F.itfQtfPt1.length===3?F.itfQtfPt1.map(n):null;I.itfQtfPt2=I.itfQuantifier>0&&F.itfQtfPt2&&F.itfQtfPt2.length===3?F.itfQtfPt2.map(n):null;if(!I.itfQtfPt1||!I.itfQtfPt2){I.itfQtfPt1=I.itfQtfPt2=null}I.mID=F.physicalid;I.mType=F.type}else{I.itfMetricName=I.itfSystemType=I.itfUserType=I.itfAnalysis=I.itfPrevAnalysis=I.itfQuantifier=undefined;I.itfDescription=I.itfTolerance=I.itfOwner=I.itfCurrent=I.itfSca2occ=undefined}E.push(I)});return E};this.updateInterference=function(I){if(!I.id||!y.itfs[I.id]||typeof I.param!=="string"){x("itfUpdateFailed",[{id:I.id}]);return}var F=y.itfs[I.id],E=e[F.metricID],C,H,G;switch(I.param){case"itfCtxName":C=F.physicalid;H="PLMEntity.V_Name";G=I.newValue;break;case"itfMetricName":C=E?E.physicalid:null;H="PLMEntity.V_Name";G=I.newValue;break;case"itfUserType":C=E?E.physicalid:null;H="PLMPIMMetricReference.V_Itf_User_Type";G=c(l,I.newValue);break;case"itfAnalysis":C=E?E.physicalid:null;H="PLMPIMMetricReference.V_Itf_Analysis";G=c(j,I.newValue);break;case"itfDescription":C=E?E.physicalid:null;H="PLMEntity.V_description";G=I.newValue;break;default:}if(C){var D={data:{id:C,attrName:H,attrValue:G},onComplete:function(K){var L=typeof K==="string"?JSON.parse(K):{},J=[];if(L&&L.status==="success"){if(I.param==="itfCtxName"){F.itfCtxName=G;J.push(I.id)}else{E[I.param]=G;Array.prototype.push.apply(J,E.ctxt)}}else{J.push(I.id)}x("itfUpdateSuccess",J.map(function(M){return{id:M}}))},onFailure:function(){x("itfUpdateFailed",[{id:I.id}])}};i._setAttrValue(D)}else{setTimeout(function(){x("itfUpdateFailed",[{id:I.id}])},0)}};this.isPartiallyLoaded=function(){return y.nbItfs===-1};this.getAlias=function(){return y.label};this.subscribe=function(D,C){if(!D||!C){return null}return A.subscribe({event:D},C)};this.unsubscribe=function(C){if(C===null||C===undefined){return}A.unsubscribe(C)}}})});define("DS/PIMwebViewModel/PIMwebIsrMgr",["DS/PIMwebViewModel/PIMwebIsr","DS/PIMwebViewModel/PIMwebUtils","DS/CoreEvents/ModelEvents"],function(f,h,c){var g={},d={},i=new c();function a(l){var k=g[l];if(!k){window.console.log(l+" has not been loaded");return -1}k.lock++;return 0}function j(l){var k=g[l];if(!k){window.console.log(l+" has not been loaded");return -1}k.lock--;if(k.lock===0){k=g[l]=null;delete g[l]}return 0}function b(l,k){return i.publish({event:l,data:k})}function e(l){var k=g[l];if(!k){var m=new f({id:l});g[l]=k={isr:m,lock:0};d[l]=[];d[l].push(m.subscribe("itfUpdateSuccess",function(n){n.isrID=l;b("itfUpdateSuccess",n)}));d[l].push(m.subscribe("itfUpdateFailed",function(n){n.isrID=l;b("itfUpdateFailed",n)}))}return k.isr}return Object.freeze({subscribe:function(l,k){if(!l||!k||(l!=="itfUpdateSuccess"&&l!=="itfUpdateFailed")){window.console.error("Invalid event name");return null}return i.subscribe({event:l},k)},unsubscribe:function(k){if(k===null||k===undefined){return undefined}return i.unsubscribe(k)},getLoadedIsr:function(){var k={};Object.keys(g).forEach(function(l){k[l]=g[l].isr});return k},getIsr:function(l){var k=g[l];return k?k.isr:null},loadIsr:function(m){if(!m||!m.isrID||!m.onProgress||!m.onComplete||!m.onFailure){window.console.error("Invalid arguments");return}var l=m.isrID,k=e(l);if(k.isPartiallyLoaded()){k._fetch({contextLoadMode:m.contextLoadMode,onProgress:function(n){m.onProgress({itfIDs:n.itfIDs,context:n.context,interferingParts:n.interferingParts,isrID:l,isr:k})},onComplete:function(){m.onComplete({isrID:l,isr:k,wasFullyLoaded:false});if(g[l].lock===0){window.console.log("isr has not been locked!!!")}},onFailure:function(n){delete g[l];k=null;m.onFailure(n)}})}else{m.onProgress({itfIDs:k.getItfIDs(),context:k.getIsrContextIDs(),isrID:l,isr:k});m.onComplete({isrID:l,isr:k,wasFullyLoaded:true})}},loadIsrFromMetrics:function(k){if(!k||!k.metrics||!k.onProgress||!k.onComplete||!k.onFailure){k.onFailure();return}h._navigateFromMetricToIsr({metricIDs:k.metrics,onComplete:function(o){var l=JSON.parse(o),p={},m=[],n;if(!l||!l.infos||l.infos.status!=="OK"||!l.result){k.onFailure();return}l=l.result;if(!l||!Array.isArray(l)){k.onFailure();return}l.forEach(function(q){n=q.outputs.isr?q.outputs.isr[0].physicalid:null;if(!n){m.push(q.input_object.physicalid);return}if(!p[n]){p[n]={itfC:[],itfM:[],label:q.outputs.isr[0]["ds6w:label"]}}p[n].itfC=p[n].itfC.concat(q.outputs.itfCtxt.map(function(r){return r.physicalid}));if(p[n].itfM.indexOf(q.input_object.physicalid)===-1){p[n].itfM.push(q.input_object.physicalid)}});Object.freeze(p);k.onFilterIsr({isrIDs:p,metricsWithoutIsr:m,onComplete:function(s){var r=s.length,q=function(){if(--r===0){k.onComplete()}};if(s.length===0){r=1;q();return}s.forEach(function(u){if(p[u]){var t=e(u);t._fetch({contextualIDs:p[u].itfC,onProgress:k.onProgress,onComplete:function(){k.onComplete({isrID:u,isr:t,wasFullyLoaded:false});if(g[u].lock===0){window.console.log("isr has not been locked!!!")}q()},onFailure:function(){k.onFailure({isrID:u,isr:t,wasFullyLoaded:false})}})}})}})},onFailure:function(){k.onFailure()}})},lockIsr:a,unlockIsr:j})});
define("DS/SMAWebXMaterialUI/SMAWebXMaterialManager",["UWA/Core",],function(b){var a=b.Class.extend({defaultOptions:{events:{onDragStart:function(c){b.log("Begin drag of material "+c.title+" id "+c.matid)},onDragEnd:function(c){b.log("End drag of material "+c.title+" id "+c.matid)},onDrop:function(c){b.log("Material "+c.title+" id "+c.matid+" was dropped on the graphics canvas")}}},init:function(c){this.options=b.extend(this.defaultOptions,c)}});return a.singleton({uninitializedCalls:"throw"})});define("DS/SMAWebXMaterialUI/SMAWebXMaterialPalette",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","UWA/Class/View","DS/Tree/FileTreeView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","WebappsUtils/WebappsUtils","DS/W3DXComponents/Skeleton","DS/UIKIT/Accordion","DS/SMAWebXMaterialUI/SMAWebXMaterialManager","text!DS/SMAWebXMaterialUI/assets/data/materials.json","css!DS/SMAWebXMaterialUI/assets/styles/style.css",],function(i,k,z,r,m,l,n,f,g,d,b,s){var a=function(C){var B=i.createElement("span",{text:C,styles:{visibility:"hidden"}});B.inject(document.body);var A=B.offsetWidth;B.remove();return A};var w=f.getWebappsBaseUrl()+"SMAWebXMaterialUI/assets/icons/I_Material_Nav_core144x108.png";var o=i.Class.Model.extend({defaults:{title:"",content:"",matid:NaN,kind:"",thumbnail:w},idAttribute:"matid"});var h=i.Class.Model.extend({defaults:{title:""},idAttribute:"matid",isRenderable:function(A){return A!=="title"},hasCustomRenderer:function(){return false}});var p=i.Class.Model.extend({defaults:{title:""},idAttribute:"matid",isRenderable:function(A){return A!=="title"},hasCustomRenderer:function(A){return A==="RGB"},getCustomDOM:function(B){var A=B==="RGB"?this.get("RGB"):"";if(A){return[{tag:"div",title:"#"+A,"class":"mat-rgb-box",styles:{"background-color":"#"+A}}]}}});var c=JSON.parse(s);var q=(function(F){var A=[],E,D;var G=-1;for(var C=0;C<F.length;++C){E=F[C];A.push({title:E.classification,kind:"folder",matid:G--,count:E.materials.length});for(var B=0;B<E.materials.length;++B){D=E.materials[B];A.push({title:D.name,kind:"material",matid:D.matid,description:D.description,rendering:i.extend(D.rendering,{title:D.name}),simulation:i.extend(D.simulation,{title:D.name})})}}return A})(c);var j=q.filter(function(A){return A.kind==="material"}).reduce(function(B,A){return B.length>A.title.length?B:A.title},"");var t=i.Class.Collection.extend({model:o,getSelectedMaterial:function(B){var A=this.where({kind:"material",matid:B})[0];return A},doFilter:function(A){A=A.toLowerCase();var E,C=[],G=[],F=0;for(var D=0;D<=q.length;++D){var B=q[D]||{kind:"folder"};if(B.kind==="folder"){if(E&&G.length>0){C.push(i.extend(E,{count:G.length}));Array.prototype.push.apply(C,G)}E=B;G=[]}else{if(B.title.toLowerCase().indexOf(A)>=0){++F;G.push(B)}}}this.reset();this.add(C,{silent:true});this.dispatchEvent("filtered");return F}});var v=i.Class.Collection.extend({model:h});var u=i.Class.Collection.extend({model:p});var x=i.Class.View.extend({tagName:"div",className:"folderView",setup:function(A){this.options=A;this.listenTo(this.collection,"filtered",this.filter)},render:function(){var C=this;var D=new l({useAsyncPreExpand:false,shouldBeEditable:function(){return false},shouldAcceptDrag:function(E){return E.options.kind==="material"},shouldAcceptDrop:function(){return false}});var B=a(j);var A=new m({treeDocument:D,apiVersion:2,height:"auto",defaultCellWidth:B,onDragStartCell:function(G,H){var E=H.nodeModel.options.data;if(E.get("kind")==="material"){var F={objectType:"material",title:E.get("title"),matid:E.get("matid")};G.dataTransfer.setData("text",JSON.stringify({data:{items:[F]}}));if(b.options.events.onDragStart){b.options.events.onDragStart(F)}}},onDragEndCell:function(G,H){var E=H.nodeModel.options.data;if(E.get("kind")==="material"){var F={objectType:"material",title:E.get("title"),matid:E.get("matid")};if(b.options.events.onDragEnd){b.options.events.onDragEnd(F)}}},onDropCell:function(){}}).inject(C.container);A.getManager().onCellClick(function(E){console.log(E);if(E.model.options.value.options.data.get("kind")==="material"){C.dispatchEvent("onItemViewSelect",E.model.options.value.options.data)}});C.tree=A;C._buildTree();return this},_buildTree:function(){var B=this;var C=B.tree.getDocument();var A=null;this.collection.forEach(function(D){if(D.get("kind")==="folder"){A=new n({label:D.get("title")+'<span class="mat-hitcount"> ('+D.get("count")+")</span>",kind:"folder",data:D});C.addChild(A)}else{A.addChild(new n({label:D.get("title"),kind:"material",data:D}))}})},filter:function(){var A=this;var B=A.tree.getDocument();B.empty();A._buildTree();B.expandAll()}});var y=i.Class.View.extend({tagName:"div",className:"generic-detail",render:function(){var A=this;A.container.setStyles({"text-align":"left",background:"white",margin:"10px"});A.table=i.createElement("table",{"class":"table mat-table",styles:{width:"100%","margin-top":"20px"}});i.createElement("tr",{html:[{tag:"th",text:"Property"},{tag:"th",text:"Value"}]}).inject(A.table);A.collection.forEach(function(C){var B=C._attributes;for(var E in B){if(B.hasOwnProperty(E)&&C.isRenderable(E)){var D=[{tag:"span",text:C.get(E),}];if(C.hasCustomRenderer(E)){D=C.getCustomDOM(E)}i.createElement("tr",{html:[{tag:"td",text:E,styles:{width:"200px"}},{tag:"td",html:D}]}).inject(A.table)}}});A.table.inject(A.container);return this},show:function(){}});var e=g.extend({init:function(A){var C=this;var D={contents:{useInfiniteScroll:false,usePullToRefresh:false}};var B={materials:{collection:function(){return new t(q)},viewOptions:D,view:x,idCardOptions:{thumbnailUrl:function(){return this.get("thumbnail")},facets:function(){var F=this;var G=[];if(F.get("rendering")){G.push({text:"Appearance",icon:"clipboard",handler:g.getRendererHandler("rendering")})}if(F.get("simulation")){G.push({text:"Simulation",icon:"clipboard",handler:g.getRendererHandler("simulation")})}return G}},fetchMode:"once"},simulation:{collection:function(F,G){var H=G._modelKey.get("id");return new v([G._modelKey.get("simulation")])},view:y,viewOptions:{type:"simulation"},collectionOptions:{type:"simulation"},idCardOptions:{attributesMapping:{title:"title",content:"content"},actions:[]},fetchMode:"once"},rendering:{collection:function(F,G){var H=G._modelKey.get("id");return new u([G._modelKey.get("rendering")||{}])},view:y,viewOptions:{type:"rendering"},collectionOptions:{type:"rendering"},idCardOptions:{attributesMapping:{title:"title"}},fetchMode:"once"}};var E={root:"materials",responsiveTrigger:function(F){if(F.state==="contracted"){}else{}},events:{onItemSelect:function(F){},onSlide:function(F,G){},onRouteChange:function(F){i.log("In route: "+F)}}};C._parent(B,E)},doFilter:function(B,D){var A=this.getCollectionAt(0);var C=A.doFilter(B);D({count:C})}});return e});define("DS/SMAWebXMaterialUI/SMAWebXMaterialUICmd",["UWA/Core","UWA/Controls/Abstract","DS/Core/Events","DS/StateCommandEngine/StateCommand","DS/StateCommandEngine/PathElementAgent","DS/Windows/Panel","DS/Windows/ImmersiveFrame","DS/Controls/LineEditor","DS/DataDragAndDrop/DataDragAndDrop","DS/Selection/PSOManager","DS/Selection/HSOManager","DS/SMAWebXMaterialUI/SMAWebXMaterialManager","DS/SMAWebXMaterialUI/SMAWebXMaterialPalette"],function(f,p,o,k,m,i,l,r,e,q,h,b,g){function d(w,t,v){var u=null;return function(){if(v){f.log(v)}var x=[];for(var y=0;y<arguments.length;y++){x.push(arguments[y])}if(u){clearInterval(u)}u=setTimeout(function(){u=null;w.apply(null,x)},t)}}var n=r.inherit({buildView:function(){var t=this;t._parent();t.elements.reset=f.createElement("a",{"class":"mat-search-reset",title:"Reset",styles:{display:"none"},events:{click:function(u){t.value=""}}}).inject(this.elements.container);t.elements.hitcount=f.createElement("span",{"class":"mat-hitcount mat-search-count",}).inject(this.elements.container)},handleEvents:function(){var t=this;t._parent();t.addEventListener("change",d(function(u){if(u.dsModel.value&&u.dsModel.value.length>=3){t.fire("filter")}else{if(u.dsModel.value.trim().length===0){t.hideStats();t.fire("reset")}}},500))},showStats:function(t){this.elements.hitcount.textContent="("+t+")";this.elements.reset.show()},hideStats:function(){this.elements.hitcount.textContent="";this.elements.reset.hide()}});var c={ALL:"all",FILTER:"filterResults"};var j=[c.ALL,c.FILTER];var s=p.extend({init:function(t){this._parent(t);this._buildPanel()},_buildPanel:function(){var t=this;t.elements.container=f.createElement("div",{id:"materialPanel",styles:{padding:"5px",position:"absolute",top:"2px",bottom:"5px",left:"5px",right:"5px"}});t._buildFilter();t._buildSkeletons()},_buildFilter:function(){var u=this;var t=new n({placeholder:"Filter",autoCommitFlag:true,styles:{width:"100%"}});t.getContent().setStyles({width:"100%"});t.getContent().getChildren()[0].setStyles({width:"100%"});t.addEventListener("filter",function(v){u.onFilter(v.dsModel.value)});t.addEventListener("reset",function(v){u.onReset()});u.elements.filter=t;u.elements.filter.inject(u.elements.container)},_buildSkeletons:function(){var v=this,t,w;v.elements.skeletons={};for(var u=0;u<j.length;++u){v.elements[j[u]]=t=new g();w=f.createElement("div",{styles:{position:"absolute",top:"40px",bottom:"0px",left:"0px",right:"0px","background-color":"white",display:"none"}});w.setContent(t.render());v.elements.container.grab(w)}v.elements[c.ALL].getContent().getParent().show()},onFilter:function(t){var u=this;u.elements[c.ALL].getContent().getParent().hide();var v=u.elements[c.FILTER];v.slideBack();v.getContent().getParent().show();v.doFilter(t,function(w){u.elements.filter.showStats(w.count)})},onReset:function(){var t=this;var u=t.elements[c.FILTER];u.getContent().getParent().hide();u.slideBack();this.elements[c.ALL].getContent().getParent().show()}});var a=k.extend({init:function(t){t=t||{};this._parent(t,{mode:"undefined",isAsynchronous:true})},beginExecute:function(){var t=this;e.droppable(t.getFrameWindow().getViewer().canvas,{drop:function(){var w=arguments[arguments.length-1];var A=w.dataTransfer.getData("text");var v=JSON.parse(A);if(v&&v.data&&Array.isArray(v.data.items)&&v.data.items.length>0&&v.data.items[0].objectType==="material"){var u=v.data.items[0].title;var z=v.data.items[0].matid;var y=null;var x=q.get();if(x.length>0){h.add(x);y={pathElement:x[0].pathElement.clone()}}b.options.events.onDrop.call(null,{objectType:"material",title:u,matid:z,cso:y})}},over:d(function(v,u){var w=new MouseEvent("mousemove",u);v.dispatchEvent(w)},1000/25,"")});return this._parent()},buildGraph:function(){var u=this;var t=this.createInitialState("FirstState");u.pathElementAgent=new m({agentId:"materialAgent",frameWindow:u.getFrameWindow(),withPrevaluation:false,withHSO:true,withPSO:true,withUndoStep:false,pickingMode:"repHybrid",prePickingMode:"repHybrid",pickingFilter:function(){return true},prePickingFilter:function(){return true}});this.addTransition({iEvent:u.pathElementAgent,iInitialState:t,iFinalState:t,iCondition:null,iAction:null})},execute:function(){var u=this;var t=320;var v=610;u.dialog=new i({title:"Material",content:new s(),width:t,height:v,position:{at:"center",offsetX:-t/2,offsetY:-v/2},immersiveFrame:u.getFrameWindow().getImmersiveFrame(),resizableFlag:true});u.dialog.minWidth=320;u.dialog.minHeight=300;u.dialog.inject(u.getFrameWindow().getUIFrame());u.dialog.addEventListener("close",u.end.bind(u));return u._parent()},endExecute:function(){var t=this;e.clean(t.getFrameWindow().getViewer().canvas);if(t.pathElementAgent){t.pathElementAgent.deactivate();t.pathElementAgent.deactivateAgentControl();t.pathElementAgent=null}if(t.dialog){t.dialog.hide();t.dialog.destroy();t.dialog=null}return this._parent()}});return a});
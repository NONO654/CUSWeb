/*!  Copyright 2017 Dassault Systemes. All rights reserved. */
define(["DS/Redux/Redux","DS/SMAPoweredByState/ad-state-store","DS/SMAPoweredByMonitors/ad-monitor-manager","DS/SMAPoweredByState/ad-state-domain/actions","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAPoweredByState/ad-state-domain-managed-data/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/selectors","DS/SMAPoweredByState/ad-state-defs","DS/SMAPoweredByState/ad-state-redux-observer"],function(a,e,l,c,d,i,h,f,g){var b={};var k="uploadjobdata";function j(r){var p=false,o=new g(),n=e.getStore(),q=a.bindActionCreators(c,e.getStore().dispatch),s=[],m=function(t){if(t===f.PersistenceOperation.READING){p=true}else{if(p){r.mdUnsubscribe();r.mdUnsubscribe=null;s.forEach(function(u){q.processUploadJob(u.id)})}}};if(r.mdUnsubscribe){r.mdUnsubscribe()}s=d.uploadJobs(n.getState()).filter(function(t){return(d.isJobSuccessful(n.getState(),t)&&!d.isUploadJobProcessed(n.getState(),t))});if(s.length>0){r.mdUnsubscribe=o.observeStore({store:n,select:h.managedDataPersistenceOperation,onChange:m,compareFunc:function(v,t){var u=v?v:null;return u===t}});a.bindActionCreators(i,n.dispatch).refreshManagedData()}}b.startUploadJobMonitor=function(m){var n=(typeof m!=="undefined")&&(m!==null)?m:60;return l.startMonitor(k,null,{firstTime:true},j,null,n)};b.stopUploadJobMonitor=function(){l.stopMonitorsOfType(k)};return b});
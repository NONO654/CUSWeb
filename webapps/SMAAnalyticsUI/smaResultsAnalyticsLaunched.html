<?xml version="1.0" encoding="utf-8"?>
<!--  DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xmlns:widget="http://www.netvibes.com/ns/">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="inline" content="true" />
<meta name="debugMode" content="true" />

<title>Results Analytics Widget</title>

<!-- D3 -->
<script type="text/javascript" src="../../simulationcentral/smaAdvise3rdPartyJS/d3-latest.min.js"></script>

<script type="text/javascript">
			var userLang = sessionStorage.userLang || 'en';
			console.log('Target Language is: ' + userLang);
			var f = "../webapps";
			var requirejs = {config:{ i18n:{ locale:userLang}},
			paths: {DS: f,UWA: f + "/UWA2/js",qwery: f + "/lib/qwery"}};
		</script>

<!-- Amd Loader before UWA -->
<script	type="text/javascript" src="../AmdLoader/AmdLoader.js" ></script>

<!-- UWA.extendElement wasn't being recognized until this was included, would break UWA/Controls/Drags -->
<!-- script type="text/javascript" src="../c/UWA/js/UWA_W3C_Alone.js"></script -->

<!-- jQuery and jQuery UI -->
<script type="text/javascript" src="../../plugins/libs/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript" src="../../plugins/libs/jqueryui/1.10.3/js/jquery.ui.custom.min.js"></script>

<!-- Enovia scripts -->
<script type="text/javascript" src="../../common/scripts/emxUIConstants.js"></script>
<script type="text/javascript" src="../../common/scripts/emxUICore.js"></script>

<!-- Help -->
<script type="text/javascript" src="../../simulationcentral/smaAdviseHelp.js"></script>

<!-- Application scripts -->
<script type="text/javascript" src="../SMAAnalyticsDataTable/SMAAnalyticsDataTable.js"></script>

<!-- 3DPlay prereqs -->
<script type="text/javascript" src="../WebappsUtils/WebappsUtils.js"></script>
<script type="text/javascript" src="../WebVisualization/WebVisualization.js"></script>

<link rel="stylesheet" href="../UIKIT/UIKIT.css" type="text/css" />

<link rel="import" href="../SMAProcSP/sp-base/sp-base.html" />

<!-- Application html -->
<link rel="import" href="../SMAAnalyticsElements/ra-exp-textarea/ra-exp-textarea.html"/>
<link rel="import" href="../SMAAnalyticsElements/ra-approx-table/ra-approx-table.html"/>
<link rel="import" href="../SMAAnalyticsElements/ra-hc-tooltip/ra-hc-tooltip.html"/>
<link rel="import" href="../SMAAnalyticsElements/ra-normal-distrib/ra-normal-distrib.html"/>

<!-- Application CSS -->
<link rel="stylesheet" type="text/css" href="SMAAnalyticsUI.css" ></link>
<link rel="stylesheet" type="text/css" href="../SMAAnalyticsDataTable/SMAAnalyticsDataTable.css" ></link>
<link rel="stylesheet" type="text/css" href="../SMAAnalyticsCompareTable/SMAAnalyticsCompareTable.css" ></link>
<link rel="stylesheet" type="text/css" href="../../simulationcentral/styles/smaAdviseHelp.css" ></link>

<STYLE type="text/css">
.module{
margin:0px!important;
width:100%!important;
position: absolute!important;
bottom: 0px!important;
top: 0px!important;
border-width:0px!important;
border-style:none!important;
}
.moduleContent {
width: 100%!important;
padding: 0px!important;
bottom: 0px!important;
top: 0px!important;
position: absolute!important;
}
.moduleHeader {
height: 0 !important;
padding:0 !important;
margin:0 !important;
}
.moduleFooter {
height:0px !important;
display:none !important;
}
.moduleWrapper {
position: absolute!important;
width: 100%!important;
height: 100%!important;
}
html {
overflow-y: auto !important;
}
</STYLE>

<script type="text/javascript">
//<![CDATA[
//*******************************************************************************************************

require.config(
      // paths
      {
          baseUrl : '../'
      }
);
//*******************************************************************************************************
	//fix for IE which does not have "console" defined unless debugger is opened
	// this fix breaks if/when the debugger is opened and then closed (fyi)
	if(!window.console) {
       window.console = {
           log : function(){},
           warn : function(){},
           error : function(){},
           time : function(){},
           timeEnd : function(){},
           info: function(){}
       }
   }
   
	//========================================================
	/**
	 * Polyfill the CustomEvent() constructor functionality 
	 * in Internet Explorer 9 and higher 
	 */
	//========================================================
	(function () {
		if ( typeof window.CustomEvent === "function" ) return false;
		function CustomEvent (event, params) {
			params = params || { bubbles: false, cancelable: false, detail: null };
			var evt = document.createEvent( 'CustomEvent' );
			evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );
			return evt;
		}
		CustomEvent.prototype = window.Event.prototype;
		window.CustomEvent = CustomEvent;
	})();
	
   var servantFromParent = null;
   function setAdviseCaseId(caseId) {
  	//debugger;
   	console.log("CaseId is"+ caseId);
   	require(['DS/SMAAnalyticsUI/SMAAnalyticsJQuery'],
			function ($simjq) {
   		
			    var isWebInWin = window.dscef && window.dscef.sendString;
			    if (isWebInWin) {
			    	//window.dscef.openDevTools();			    	
			        $simjq.ajax('../../resources/slmservices/advise/caseInfo?oid=' + caseId).then(function (response) {
			            //TODO: parse the response to send to Win side
			            /*  var parser = new DOMParser();
                        var xmlDoc = parser.parseFromString(response, "text/xml"); */
                      
                       console.log(response); 
                       var caseInfo = {}; 
                       var dataSets = response.getElementsByTagName("dataSet");
                       var dataSetInfoList = [];
                       for(var i=0; i < dataSets.length;i++) {
                       	var dataSetInfo = {};
                       	var dataSetStr = dataSets.item(i);
                       	dataSetInfo.plmOID = dataSetStr.getAttribute('plmOID');
                       	dataSetInfo.physicalID = dataSetStr.getAttribute('physicalID'); 
                       	dataSetInfo.title = dataSetStr.getAttribute('title');
                       	dataSetInfo.fileName = dataSetStr.getAttribute('fileName');
                       	dataSetInfo.name = dataSetStr.getAttribute('name');
                       	dataSetInfo.dataSetType = dataSetStr.getAttribute('typeName');
                       	dataSetInfoList.push(dataSetInfo);
                       }
			            var approximations = response.getElementsByTagName("Approximation");
			            var approximationList = [];
			            for (var i = 0; i < approximations.length; i++) {
			                var approxStr = approximations.item(i);
			                var approxInfo = {};
			                approxInfo.plmOID = approxStr.getAttribute('plmOID');
			                approxInfo.physicalID = approxStr.getAttribute("physicalID");
			                approximationList.push(approxInfo);
			            }
			            caseInfo.Approximations = approximationList;
			            caseInfo.Datasets = dataSetInfoList;
			            /* approximations.forEach(function (approximation) {
					        var approxId = approximation.getAttribute();
					        approximationList.concat(approxId);
					    }); */
					    // This will send the message to the c++ side. 
			            // When c++ side is done with the downloads, it will send a message to this html
			            // That message will be received by the function webInWinReceiveMessageCallback above
			            // with the message "CASE_FILES_DOWNLOADED", and 
			            // that will then call loadRestClientCode
			            window.dscef.sendString('downloadCaseData', JSON.stringify(caseInfo));
			        });
			    }
			});
   }
   
   function webInWinMessageRecevied(encodedMessage){
	   var decodedMsgString = decodeURIComponent(encodedMessage)
	   console.log("Message received from Wintop is"+decodedMsgString);
	   var message = JSON.parse(decodedMsgString);
	   var fullModName = message.fullModName;
	   console.log('ModName is' +fullModName);
	   var modName = message.modName;
	   console.log('ModName is'+modName);
	   require([fullModName],function(modName){
		   var functionParameters = message.parameters;
		   console.log(modName);
		   modName['handleMessage'].call(modName, functionParameters);
	   });
	   /* require(['DS/SMAAnalyticsUI/SMAAnalyticsWebInWinActions'],function(WebInWinActions){
		   var decodedMsgString = decodeURIComponent(encodedMessage)
		   console.log("Message received from Wintop is"+decodedMsgString);
		   var message = JSON.parse(decodedMsgString);
		   var functionName = message.messageId;
		   var functionParameters = message.parameters;
		   console.log(functionParameters);
		   WebInWinActions[functionName].call(WebInWinActions, functionParameters);
	   }); */
   }
   function setServantFromParent(adviseLaunchInfo){
	  
		var isWebInWin = window.dscef && window.dscef.sendString;
	    if(isWebInWin){
	    	adviseLaunchInfo = decodeURIComponent(adviseLaunchInfo);
	    	adviseLaunchInfo = JSON.parse(adviseLaunchInfo);
	    }
	   	console.log("Session info"+sessionInfo);
	    console.info("Setting servant from parent to "+ adviseLaunchInfo.servantURL);
	    if(isWebInWin)
    	{
	    	//window.dscef.openDevTools();
			//debugger;	
    	}
		servantFromParent = adviseLaunchInfo.servantURL;

		if(window.widget) {
	   	var servantURL = widget.getValue('servantURL');
	   	if(servantFromParent!==servantURL) {
		   console.info("Setting servant from parent on widget "+ adviseLaunchInfo.servantURL +"; widget option was "+servantURL);
		   widget.setValue('servantURL',adviseLaunchInfo.servantURL); // this should force on load again
	   	}
		}
	   	window.adviseLaunchInfo = adviseLaunchInfo;
		
	    
		if(isWebInWin)
		{
			sessionInfo.caseID = window.parent.adviseLaunchInfo.caseID;
			sessionInfo.noServant = window.parent.adviseLaunchInfo.noServant;
			sessionInfo.widgetID = window.parent.adviseLaunchInfo.widgetID || '';
			sessionInfo.dashboardURL= window.parent.adviseLaunchInfo.dashboardURL || '';
			sessionInfo.platformID= window.parent.adviseLaunchInfo.platformId;
			sessionInfo.platformServices = (window.parent.adviseLaunchInfo.platformServices) ? JSON.parse(window.parent.adviseLaunchInfo.platformServices) : '';
			sessionInfo.servant = window.parent.adviseLaunchInfo.servantURL;
			sessionInfo.catiaHVUrl = window.parent.adviseLaunchInfo.CATIA_HVPubAddress;
			sessionInfo.catiaHVPort = window.parent.adviseLaunchInfo.CATIA_HVPort;
			sessionInfo.catiaPartID = window.parent.adviseLaunchInfo.CATIA_PartID;
			sessionInfo.secCtx = window.parent.adviseLaunchInfo.secCtx;
			console.log(JSON.stringify(adviseLaunchInfo));
			loadRestClientCode(); 
		}
		else{
			window.adviseLaunchInfo = adviseLaunchInfo;
		}
	   	//FIXME: if the widget is already loaded, we need to update the html
	   	// FIXME: remove this!!! no UI here;
	   	// setting the widget option should fire an event that can then look at the station name and update the UI
	   	var textElem = document.getElementsByClassName('sim-ui-footer-station-text')[0];
	   	var stationName = adviseLaunchInfo.stationDisplayName;
	   	textElem.textContent = stationName;
	   	var stationElem = document.getElementsByClassName('sim-ui-footer-station')[0];
	   	var balloonTxt = adviseLaunchInfo.stationIP;
	   	if(stationName != adviseLaunchInfo.stationIP) {
	   		balloonTxt = stationName + " - " + adviseLaunchInfo.stationIP;
	   	}
	   	if(balloonTxt){
	   		stationElem.setAttribute('title', balloonTxt);	
	   	}
	   	
   }

    var isWebInWin = window.dscef && window.dscef.sendString;
    if (isWebInWin) {
    	var adviseLaunchInfo = {
		};
    	
        window.parent.adviseLaunchInfo = adviseLaunchInfo;
        //loadRestClientCode();
    }
   /*  function webInWinReceiveMessageCallback(text) {
        if(text && text.equals("CASE_FILES_DOWNLOADED")) {
        	
        }
    } */
    
	var sessionInfo = {
			caseID: '',
			caseStateString: 'In Process',
			loaded: false,
			servant: '',
			previewPage:{},
			definePage:{},
			shopPage:{},
			predictPage:{},
			comparePage:{},
			elicitPage:{},
			recommendPage:{},
			noServant: window.parent.adviseLaunchInfo.noServant,
			widgetID: window.parent.adviseLaunchInfo.widgetID || '',
			dashboardURL: window.parent.adviseLaunchInfo.dashboardURL || '',
			widgetViewType: window.parent.adviseLaunchInfo.widgetViewType || '',
			secCtx: window.parent.adviseLaunchInfo.secCtx || '',
			eedJobID: window.parent.adviseLaunchInfo.eedJobID,
			eedServerID: window.parent.adviseLaunchInfo.eedServerID,
			platformID: window.parent.adviseLaunchInfo.platformId,
			secureStation : window.parent.adviseLaunchInfo.secureStation,
			datasetsList : window.parent.adviseLaunchInfo.datasetsList?JSON.parse(window.parent.adviseLaunchInfo.datasetsList):[],
			platformServices : (window.parent.adviseLaunchInfo.platformServices) ? JSON.parse(window.parent.adviseLaunchInfo.platformServices) : '',
			switches : window.parent.adviseLaunchInfo.switches,
			catiaHVUrl : '',
			catiaHVPort : '',
			catiaPartID:''
	};

	Object.defineProperty(sessionInfo, 'previewPage', {
	    value: {},
	    configurable: true
	    });
	Object.defineProperty(sessionInfo, 'definePage', {
	    value: {},
	    configurable: true
	    });
	Object.defineProperty(sessionInfo, 'shopPage', {
	    value: {},
	    configurable: true
	    });
	Object.defineProperty(sessionInfo, 'predictPage', {
	    value: {},
	    configurable: true
	    });
	Object.defineProperty(sessionInfo, 'comparePage', {
	    value: {},
	    configurable: true
	    });
	Object.defineProperty(sessionInfo, 'elicitPage', {
	    value: {},
	    configurable: true
	    });
	Object.defineProperty(sessionInfo, 'recommendPage', {
	    value: {},
	    configurable: true
	    });

	function loadLaunchedClientCode() {
		require(['DS/SMAAnalyticsUI/SMAAnalyticsJQuery', 'DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils'],
				function($simjq, NLSUtils) {
					// deal with data-text
					$simjq('[data-text]').each(function (i, d){
						var element = $simjq(d);
						try{
							element.text(NLSUtils.translate(element.attr('data-text')));
						}catch(e){
							console.error('Translation Error');
						}
					});

					$simjq('[title]').each(function (i, d){
						var element = $simjq(d);
						try{
							element.attr('title', NLSUtils.translate(element.attr('title')));
						}catch(e){
							console.error('Translation Error');
						}

					});
					loadRestClientCode();
				});
		}
	function setColors(cssEditor, AdviseConstants) {
		var pareto = [
			['.pareto .dataTable-body-tableCell','background','LIGHT'],
			['table.tablesorter tbody tr.paretoDesign td','background','LIGHT'],

			['table.tablesorter tbody tr.paretoDesign.selectedRow td','background','HIGHLIGHT'],
			['.pareto .dataTable-body-tableCell.highlightedCell','background','HIGHLIGHT'],

			['.paretoDesign .dataSourceCell.highlightedCell','stroke','DEFAULT'],
			['.sim-ui-pcplot-pareto','stroke','DEFAULT'],
			['.paretoDesign .dataSourceCell','fill','DEFAULT'],
			['.paretoDesign .dataSourceCell.highlightedCell','stroke','DEFAULT'],
			['.HMPareto','stroke','DEFAULT'],
			['.sim-ui-param-control-histogram-pareto rect ','stroke','DEFAULT']
		];
		pareto.forEach(function (st){
			cssEditor.addStyle(st[0],st[1],AdviseConstants.PARETO_COLORS[st[2]]);
		});

	}
	function loadRestClientCode() {
		require(['DS/SMAAnalyticsUI/SMAAnalyticsJQuery',
			         'DS/SMAAnalyticsUI/SMAAnalyticsUICommon',
			         'DS/SMAAnalyticsUI/SMAAnalyticsProxy',
			         'text!DS/SMAAnalyticsUI/assets/ResultsAnalyticsConstants.json',
			         'DS/SMAAnalyticsUI/SMAAnalyticsCssEditor',
			         'DS/SMAAnalyticsUI/SMAAnalyticsPageCommon',
			         'DS/SMAAnalyticsUI/SMAAnalyticsMarkers',
			         'DS/SMAAnalyticsUI/SMAAnalyticsPreviewPage',
			         'DS/SMAAnalyticsUI/SMAAnalyticsDefinePage',
			         'DS/SMAAnalyticsUI/SMAAnalyticsShopPage',
			         'DS/SMAAnalyticsUI/SMAAnalyticsPredictPage',
			         'DS/SMAAnalyticsUI/SMAAnalyticsComparePage',
			         'DS/SMAAnalyticsUI/SMAAnalyticsElicitPage',
			         'DS/SMAAnalyticsUI/SMAAnalyticsRecommendPage',
			         'DS/SMAAnalyticsUI/SMAAnalyticsBasket',
			         'DS/SMAAnalyticsUI/SMAAnalyticsPopover',
			         'DS/SMAAnalyticsUI/SMAAnalyticsToolbarButton',
			         'DS/SMAAnalyticsUI/SMAAnalyticsViewButton',
			         'DS/SMAAnalyticsUI/SMAAnalyticsNavigator',
			         'DS/SMAAnalyticsCompareTable/SMAAnalyticsHierarchicalTable',
			         'DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils',
			         'DS/SMAAnalyticsUI/SMAAnalyticsUtils', 
			   		 'DS/SMAAnalyticsUI/SMAAnalyticsFileUpload',
			         'DS/Windows/ImmersiveFrame'],
			function(
					$simjq,
					UICommon,
					proxy,
					AdviseConstants,
					CssEditor,
					PageCommon,
					DatasetMarkers,
					previewPage,
					definePage,
					shopPage,
					predictPage,
					comparePage,
					elicitPage,
					recommendPage,
					basket,
					Popover,
					ToolbarButton,
					ViewButton,
					Navigator,
					HierarchicalTable,
					NLSUtils,
					AdviseUtils,
					FileUploader,
					WUXImmersiveFrame){
				'use strict';
				//IMPORTANT: This is the first thing that needs to happen. The document object contains all the templates
				HierarchicalTable.registerTableWebComponents(document, proxy, AdviseUtils, CssEditor, FileUploader);
				window.proxy = proxy; //FIXME:global
				AdviseConstants = JSON.parse(AdviseConstants);
				if(localStorage.getItem("RA_INTERACTIVE_DESIGN") === 'true')
				{
					proxy.setCATIAHVUrl(sessionInfo.catiaHVUrl);
					proxy.setCATIAHVPort(sessionInfo.catiaHVPort);
					proxy.setCATIAPartID(sessionInfo.catiaPartID);
					
				}
				
				//sd4 - allow user preferences for Pareto, dominated and infeasible colors
				var cssEditor = new CssEditor();
				for(var i = 0; i < document.styleSheets.length; i++){
					if(typeof document.styleSheets[i].href === 'string' && document.styleSheets[i].href.indexOf('SMAAnalyticsUI') > -1){
						cssEditor.setStyleSheet(document.styleSheets[i]);
						break;
					}
				}
				setColors(cssEditor, AdviseConstants);
				//if(sessionInfo.widgetID) {
				// lets always hide the title container
				// TODO: remove title container from the DOM and any references from teh scripts and CSS
				cssEditor.addStyle('div.sim-ui-page', 'top', '0px');
				cssEditor.addStyle('div.sim-ui-title-container', 'display', 'none');
				//}
				
				// remove the 'false' to hide the station info while in the interactive viewer
				if (isWebInWin && false) {
					// find the bottom bar and hide it if possible
					cssEditor.addStyle('#footerNav','right','0px!important');
					cssEditor.addStyle('#footerStation','display','none!important');
				}

		    	var bodyElem = document.querySelector('body');
				if (isWebInWin) {
			    	if (bodyElem !== null) {
			    		// we're in the interactive viewer
			    		bodyElem.classList.add('ra-catia-wiw');
			    	}
				} else {
			    	if (bodyElem !== null) {
			    		// we're on the dashboard and not in the interactive viewer
			    		bodyElem.classList.add('ra-dashboard');
			    	}
				}

				addContextualDocsLinkToGlobalToolBar();
				proxy.caseData = null;

				function downloadSavedFiles(callbackFn, deferredObj, fileName){
					$simjq.ajax({
						type: 'GET',
						url: '../../resources/slmservices/advise/caseTicket?oid='
							+sessionInfo.caseID +'&action=download&fname='+fileName
						}).done(function(ticket){

							if(ticket !== null){
								ticket= encodeURIComponent($simjq(ticket).find('Ticket').text().trim());
								var xhr = new XMLHttpRequest();
								xhr.onload =  function(){
									if (xhr.readyState === 4 && xhr.status === 200){
										var blob = new Blob([this.response], {type: 'application/json'});
										if(callbackFn) {
											callbackFn(blob);
										}
									}
								};
								//FIXME: use the fcs url from the ticket
								xhr.open('POST', '../../servlet/fcs/checkout', true);
								xhr.setRequestHeader('Cache-Control', 'no-cache');
								xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
								xhr.responseType = 'arraybuffer';

								var data = '__fcs__jobTicket='+ticket+'&__fcs__attachment=false';
								// this needs to be like the form
								xhr.send(data);
							}
							else{
								 deferredObj.resolve();
							}
				   });

				};
				function loadSavedJSONCase(){

					var changeLogDeferred = $simjq.Deferred();



					proxy.changeLog = [];
					//download the changelog and set it to the changelog object in the worker
					downloadSavedFiles(function(blob){
						if(blob){
							var reader = new FileReader();
							reader.addEventListener("loadend", function() {
							   // reader.result contains the contents of blob as a typed array
							   proxy.changeLog = JSON.parse(this.result);
							   changeLogDeferred.resolve();
							});

							reader.readAsText(blob);
						}
					}, changeLogDeferred, 'changelog.txt');

					var deferredObj = new $simjq.Deferred();
					downloadSavedFiles(function(blob){
						if(blob){

							var reader = new FileReader();
							reader.addEventListener("loadend", function() {
							   // reader.result contains the contents of blob as a typed array
							   var modResult = this.result.split('NaN').join('null');
							   var caseData = JSON.parse(modResult);
							   //create worker
							   //in case of multiple workers with entire data, replicate this routine
							   proxy.worker = new Worker('../SMAAnalyticsWorkers/SMAAnalyticsWorker.js');

								/*
								*	Proxy worker function to be called on the front end.
								*	a random id is generated and posted when call is made to the worker
								*	worker replies with the same ID which is then used as an identifier
								* 	for the call back function
								*	command = corresponding command on the worker.
								*	args = an object of arguments as needed on the worker.
								*
								*/
								//list of listeners have a id: callbackFn mapping
								proxy.worker.listeners = {};
								proxy.worker.evaluate = function(command, args, callback){

								   //http://stackoverflow.com/a/19964557
								   var id = new Array(36+1).join((Math.random().toString(36)+'00000000000000000')
										   					.slice(2, 18)).slice(0, 36);

								   proxy.worker.postMessage({'command':command, 'args':args, 'id': id});

								   //callback is mapped to the ID
								   proxy.worker.listeners[id] = callback;

								};

								//when the worker responds, call the callbackfunction
								proxy.worker.onmessage = function(event){
									   if(proxy.worker.listeners[event.data.id]){
										   proxy.worker.listeners[event.data.id](event);
										   //if the command is "set" it is likely that meta data is updated
										   //if meta data is returned from worker
										   //case data needs to be updated on the client
										   if(event.data.metaData){
											   proxy.caseData = event.data.metaData;
										   }
										   delete proxy.worker.listeners[event.data.id];
									   }
								};

							   proxy.worker.evaluate('setCaseData', [caseData, sessionInfo.caseID, proxy.changeLog],
									   function(){
								 //TODO: remove non-meta data
									delete caseData.selectedExplorationDataView;
									delete caseData.explorationDataViews;

									proxy.caseData = caseData;

									changeLogDeferred.done(function(){
										deferredObj.resolve();
									});

							   });

							});
							reader.readAsText(blob);
						}
					}, deferredObj, 'case.json');
					return deferredObj;
				}

				function showLoadingMessage(messageText) {
					var splashMessage = document.querySelector('.sim-ui-splash-progressmessage');
					if(splashMessage !== null){
						messageText += ' raLaunched';
						if(window.parent.adviseLaunchInfo){
							// var localStation = window.parent.adviseLaunchInfo.localStationName || '';
							// if(localStation.length > 0){
							//	messageText += '<br>Station: ' + localStation;
							// }
							var thisStation = window.parent.adviseLaunchInfo.stationName || '';
							if(thisStation.length > 0){
								messageText += '<br>Station: ' + thisStation;
							}
						}
						splashMessage.textContent = messageText;
					}
				}

				function removeLoadingMessage(){
					//$simjq(".sim-ui-blocking-background").remove();
					//$simjq(".sim-ui-blocking-message").remove();
				}

				//-------------------------------------------------------------
				// Once we receive the Servant Url from the BB save it to the
				// local storage, so that this can be used if the user to
				// relaunch the same case if the servant is alive.
				// Placing this code here also ensures that we can fetch the
				// servant details even if the launch failed due to mixed
				// content issues.
				//-------------------------------------------------------------
				var saveServantToLocStorage = function(info){
					if (typeof (Storage) !== 'undefined') {
						localStorage['smaAnalyticsCase' + info.caseID] =
							JSON.stringify({
								'lastUpdateTime' : Date.now(),
								'servantURL' : sessionInfo.servant,
								'stationName' : window.parent.adviseLaunchInfo.stationName,
								'stationIP' : window.parent.adviseLaunchInfo.stationIP });
					}
				};


				var startApp = function() {
					if(sessionInfo.caseID===''|| (!sessionInfo.noServant && sessionInfo.servant==='')){
						console.log("startapp did nothing");
						return;
					}
					else if(sessionInfo.noServant && !proxy.caseData){
						alert('Need a saved case to run RA Lite!');
						return;
					}

					// Persist the servant info in local storage
					saveServantToLocStorage(sessionInfo);

					//PageCommon.setupTutorial();
					if(window.parent.adviseLaunchInfo.noServant === true){
						showLoadingMessage('Loading RA Lite...');
						document.getElementById('footerStation').style.display = 'none';
						document.getElementById('footerNav').style.right = '0px';
					}
					else{
						showLoadingMessage('Reading the data file...');
					}
					showLoadingMessage('calling connectTo...');
					
					proxy.connectTo(sessionInfo.caseID, sessionInfo.caseStateString, sessionInfo.servant, true);

					showLoadingMessage('connected ...');
					proxy.setHelpHandler(function(event){
						var topic = event && event.helpTopic;
						if(!topic || topic.toLowerCase()==='tutorial') {
							helpClickEvent('', '');
						}
						else {
							var smaAdvHelpJSPPath = '../../simulationcentral/smaResultsAnalyticsHelp/' + 'ResultsAnalytics' + topic + '.html';
							helpClickEvent(topic, smaAdvHelpJSPPath);
						}
					});
					showLoadingMessage('Initializing UI calls...');

					// create an immersive frame and set to proxy
	                var iF = new WUXImmersiveFrame({
	                    identifier: 'RAImmersiveFrame'
	                });
	                iF.inject(document.body,'top');
	                proxy.setImmersiveFrame(iF);
	                
					console.log("Calling initialize");
					proxy.initialize(function() {

						// If RA is in widget mode set the widget ID to the
						// proxy.
						proxy.setWidgetID(sessionInfo.widgetID);
						proxy.setDashboardURL(sessionInfo.dashboardURL);
						proxy.setEEDJobId(sessionInfo.eedJobID);
						proxy.setEEDServerId(sessionInfo.eedServerID);
						proxy.setPlatFormId(sessionInfo.platformID);
						
						proxy.setSwitchesFromWidget(sessionInfo.switches);
						
						
						// Set widget view type here, to catch any resizes that
						// happened during launch
						try {
							sessionInfo.widgetViewType =  window.parent._WIDGET_VIEW_TYPE.indexOf(':') > -1 ?
															window.parent._WIDGET_VIEW_TYPE.split(':')[1] :
																window.parent._WIDGET_VIEW_TYPE;
						} catch(ex) {
						}

						if(window.parent.showLoadingMessage) {
							window.parent.showLoadingMessage('Creating UI...');
						}
						proxy.removeAllEventListeners();
						// Page commons
						PageCommon.initializeCommon();
						// sd4 - Data set markers
						DatasetMarkers.initializeDataSetMarkers(proxy);
						// Preview data page
						previewPage(sessionInfo,'previewpage');
						// Define parameters page
						definePage(sessionInfo, {
							pageObject : {},
							viewObject : {
								hierarchyView : $simjq('#parameterhierarchyview'),
								definitionView : $simjq('#parameterdefinitionview'),
								mappingView : $simjq('#parametermappingview')
							},
							controlPanelObject : {},
							contentPanelObject : {}
						});
						// Shop page
						shopPage(sessionInfo, 'shopdesignspage');
						// Predict page
						predictPage(sessionInfo, 'predictpage');
						// Compare page
						comparePage(sessionInfo, 'comparedesignspage');
						// Elicit Preferences page
						elicitPage(sessionInfo, 'elicitpreferencespage');
						//Recommend page
						recommendPage(sessionInfo,'recommenddesignpage');
						// all common toolbars
						$simjq('.sim-ui-panel-content-toolbarbutton')
								.adviseToolbarButton();
						// basket
						$simjq('.sim-ui-basket').adviseBasket();
						// station name
						var tooltipTxt = $simjq('.sim-ui-footer-station').attr('title');
						$simjq('.sim-ui-footer-station-icon')
							.tooltip({ content : tooltipTxt})
							.click(function() {
								var wnd = window.open(sessionInfo.servant + 'executeCommand?commandName=getLogFile', '_blank', 'height=500,width=1000,menubar=no,location=no,left=200,top=200');
								//var loghtml = $simjq('#sim-ui-log-html-window').html();
								//wnd.document.write(loghtml);
								//$simjq(wnd.document).ready(function() {
								//	if(wnd.refreshLog){
								//		wnd.refreshLog(sessionInfo.servant);
								//	}
								//});

							});
						// navigator
						function redrawNavigator(){
							var visibleID = Navigator.createNavigationBar($simjq('#footerNav'), proxy.getWorkflowDefinition());

							//FIXME: get this from case as well
							Navigator.navigateTo(null, visibleID);
						}

						redrawNavigator();

						// the widget specific resize function here
						function widgetResizeCallback(){
							try {
								if(typeof sessionInfo.widgetID === 'undefined' ||
									sessionInfo.widgetID === null ||
									sessionInfo.widgetID.length === 0){
									return;
								} else {
									document.querySelector('#titleContainer').classList.add('ra-widget-noshow');
									[].forEach.call(document.querySelectorAll('.sim-ui-page'), function(el){
										el.classList.add('ra-widget-page');
									});
									[].forEach.call(document.querySelectorAll('.sim-ui-panel-content'), function(el){
										el.classList.add('ra-widget-noborder');
									});
									if(typeof sessionInfo.widgetViewType === 'undefined' ||
									sessionInfo.widgetViewType === null ||
									sessionInfo.widgetViewType.length === 0){
										return;
									}

									// First get the viewtype from the data from the run advise job html
									var isMax = (sessionInfo.widgetViewType==='maximized'?true:false);
									if(isMax){
										document.querySelector('.sim-ui-panel-content-view').classList.remove('ra-widget-noborder');
										[].forEach.call(document.querySelectorAll('#footer,#footerStation,#basket'), function(el){
											el.classList.remove('ra-widget-noshow');
										});
									} else {
										document.querySelector('.sim-ui-panel-content-view').classList.add('ra-widget-noborder');
										[].forEach.call(document.querySelectorAll('#footer,#footerStation,#basket'), function(el){
											el.classList.add('ra-widget-noshow');
										});
									}
								}
							} catch(ex){
								console.log('Error performing the widget resize actions inside RA.');
								return;
							}
						};
						function postServantToWidget(){
							if(typeof window.parent.adviseLaunchInfo !== 'undefined'){
								if(typeof window.parent.adviseLaunchInfo.postServantToWidget === 'function'){
									window.parent.adviseLaunchInfo.postServantToWidget();
								}
							}
						};
						function closeRAServantFrom3DD(caseId){
							if(typeof window.parent.adviseLaunchInfo !== 'undefined'){
								if(typeof window.parent.adviseLaunchInfo.closeRAServantFrom3DD === 'function'){
									window.parent.adviseLaunchInfo.closeRAServantFrom3DD(caseId);
								}
							}
						};
						widgetResizeCallback();
						postServantToWidget();


						proxy.setNavigatorObject(Navigator);
						proxy.addEventListener(function(events){
							if ($simjq.isArray(events)) {
								for(var i =0; i<events.length;i++){
									var e = events[i];
									if(e.iaEventType && e.iaEventType === AdviseConstants.EVENT_TYPE_CASE_METADATA_CHANGED){
										redrawNavigator();
										return;
									}
								}
							}
						});
						//hide splash screen
						$simjq('.sim-ui-advise-splash-background').hide();
						UICommon.alertMessage(UICommon.SUCCESS, NLSUtils.translate('Opened case'));

						PageCommon.setupRankingSelections();

						// This event fires only when a case is saved from the dashboard
						window.addEventListener('message', function(e) {
							if(e.data.length > 0){
								if(e.data.indexOf('TRIGGER_RA_SAVE')>-1){
									// FIXME : This is the old save call from
									// 3DSpace launcher. Can be removed.
									var event = {};
									event.eventID = 'save';
									proxy.propagateEvent(event);
								} else if(e.data.indexOf('WIDGET_RESIZE')>-1){
									sessionInfo.widgetViewType = JSON.parse(msgTxt).WIDGET_RESIZE;
									// if(e.data.indexOf(':') > -1){
									// 	sessionInfo.widgetViewType = e.data.split(':')[1];
									// 	widgetResizeCallback();
									// }
								} else if(e.data.indexOf('CLOSE_RA_SERVANT')>-1){
									if(e.data.indexOf(':') > -1){
										var caseID = e.data.split(':')[1];
										closeRAServantFrom3DD(caseID);
									}
								}
								else if(e.data.indexOf('GET_SESS_DEF')>-1){
                                    proxy.widgetSavePreProcess();
                                }
							}
						});

						if(window.parent&&window.parent.adviseLaunchDone) {
							window.parent.adviseLaunchDone();
				       	}
					});
				}; // end of startApp

				// call start app now that the code can only get here after the widget has been loaded.
				if(adviseLaunchInfo.noServant){
					loadSavedJSONCase().done(function(){
						startApp();
					});
				}
				else{
					startApp();
				}

		   }); // end of require callback
	} // end of loadLaunchedClientCode
   var myWidget = {
	        onLoad: function() {
	        	var servantURL = '';
	        	if(window.widget) {
	        		servantURL = widget.getValue('servantURL') || '';
	        	}
	        	if(window.parent.adviseLaunchInfo.noServant === true){
	        		sessionInfo.caseID = window.parent.adviseLaunchInfo.caseID;
	            	loadLaunchedClientCode();
	            	return;
	        	}
	        	console.info("widget onload: servant url option: " + servantURL);
	        	if(servantFromParent!=null){
	        		console.info("Widget load setting servant from parent to "+ servantFromParent);
	        		sessionInfo.caseID = window.parent.adviseLaunchInfo.caseID;
	        		sessionInfo.servant = servantFromParent;
	        		loadLaunchedClientCode();
	        	} else if(!sessionInfo.loaded && servantURL && servantURL.length>5 && (!window.parent || !window.parent.adviseLaunchInfo)) {
	        		console.info("Widget load setting servant from widget option value no parent "+ servantURL);
	        		sessionInfo.caseID = window.parent.adviseLaunchInfo.caseID;
	            	sessionInfo.servant = servantURL;
	            	loadLaunchedClientCode();
	        	} else if(window.parent&&window.parent.adviseLaunchInfo && window.parent.adviseLaunchInfo.servantURL && window.parent.adviseLaunchInfo.servantURL.length>1) {
	        		console.info("Widget load getting and setting servant from parent "+ window.parent.adviseLaunchInfo.servantURL);
	            	sessionInfo.servant = window.parent.adviseLaunchInfo.servantURL;
	            	sessionInfo.caseID = window.parent.adviseLaunchInfo.caseID;
	            	loadLaunchedClientCode();

	        	} else {
	        		console.info("Application already loaded");
	        	}
	         },
	};
	var loadHTable = function () {
		var adviseJS = document.createElement('script');
		adviseJS.src = '../SMAAnalyticsCompareTable/SMAAnalyticsCompareTable.js';
		adviseJS.type = 'text/javascript';
		adviseJS.onload = loadOtherScripts;
		// Error handling
		adviseJS.onerror = function() {
			alert('Could not load Results Analytics module. Please check the installation.');
			if(window.parent) {
				window.parent.history.back();
			}
		}
		// Insert the created object to the html head element
		var head = document.getElementsByTagName('head').item(0);
		head.appendChild(adviseJS);
	};
    // Not currently used
	var loadCmpExpEditor = function () {
		var adviseJS = document.createElement('script');
		adviseJS.src = '../SMAProcWebAuthoringUtils/cmp-expression-editor/cmp-expression-editor.js';
		adviseJS.type = 'text/javascript';
		adviseJS.onload = loadHTable;
		// Error handling
		adviseJS.onerror = function() {
			alert('Could not load cmp-expression-editor module. Please check the installation.');
			if(window.parent) {
				window.parent.history.back();
			}
		}
		// Insert the created object to the html head element
		var head = document.getElementsByTagName('head').item(0);
		head.appendChild(adviseJS);
	};
	
	//*********************************************************************
	// Generic function to load scripts to the page
	//*********************************************************************
	var loadScriptToPage = function(id, src, onLoad, onError, async, defer) {
		if (typeof src === 'undefined' || src === null || !(src.length > 0)) return;
		
		var script = document.createElement('script');
	    script.src = src;
	    if (typeof id !== 'undefined' && id !== null && id.length > 0) {
	    	script.id = id;
	    }
	    if (defer === true) {
	    	script.defer = true;
	    }
	    if (typeof onLoad === 'function')
	    	script.onload = onLoad;
	    script.onerror = function() {
	    	console.error('Could not load the script' + src);
	    	if (typeof onError === 'function')
	    		onError();
	    };
	    script.async = (async === true) ? true : false;
	    script.type = 'text/javascript';
	    document.head.appendChild(script);
	};
	
	//*********************************************************************
	// Load Muuri JS, HighCharts and all its dependencies. Muuri is used to 
	// construct responsive, draggable grids.
	//*********************************************************************
	var loadGridAndChartDependencies = function() {
		var extScriptLoadErr = function (err) {
			console.error ('Could not load the external js module. ', err);
		};
		require(['VENHammer/2.0.8/hammer'],
			function(Hammer) {
				if (typeof Hammer !== 'undefined' && Hammer !== null) {
					var extScripts = [
						{ 'id': 'web-anim-js', 'src': '../VENWebAnimationJS/web-animations.min.js'},
						{ 'id': 'muuri-js', 'src': '../SMAVenMuuri/muuri.min.js'},
						{ 'id': 'hc-js', 'src': '../SMAVenHighcharts/6.0.7/highcharts.js'},
						{ 'id': 'hc-exporting-js', 'src': '../SMAVenHighcharts/6.0.7/modules/exporting.js'},
						{ 'id': 'hc-off-exporting-js', 'src': '../SMAVenHighcharts/6.0.7/modules/offline-exporting.js'},
						{ 'id': 'hc-boost-js', 'src': '../SMAVenHighcharts/6.0.7/modules/boost.js'}
					];
					while (oScript = extScripts.shift())
						loadScriptToPage (oScript.id, oScript.src, undefined, extScriptLoadErr);
				} else {
					extScriptLoadErr ('Hammer js module is undefined.')
				}
			},
			function(err) {
				extScriptLoadErr(err);
			}
		);
	};

	var loadOtherScripts = function(){
		
		loadGridAndChartDependencies();
		
		var adviseJS = document.createElement('script');
		adviseJS.src = '../SMAAnalyticsUI/SMAAnalyticsUI.js';
		adviseJS.type = 'text/javascript';
		adviseJS.onload = myWidget.onLoad;
		// Error handling
		adviseJS.onerror = function() {
			alert('Could not load Results Analytics module. Please check the installation.');
			if(window.parent) {
				window.parent.history.back();
			}
		}
		// Insert the created object to the html head element
		var head = document.getElementsByTagName('head').item(0);
		head.appendChild(adviseJS);
	};
	var loadPlatformJS = function(){
		// first load the platform script
		var platformScript = document.createElement('script');
		platformScript.src = '../Polymer-0.5.5/webcomponents-lite.min.js';
		//platformScript.src = '../Polymer/platform.js';
		platformScript.type = 'text/javascript';
		platformScript.defer = true;
		platformScript.id = 'platformScript'; // This will help us in referencing the object later for removal
		// once that is loaded, then continue with the rest of the application
		platformScript.onload = function() {
            loadHTable();
        };

		// Error handling
		platformScript.onerror = function() {
			alert('Could not load the required "Polymer/platform.js" module. Please check the installation.');
			if(window.parent) {
					if(window.parent.showLoadingMessage) {
						window.parent.showLoadingMessage('Stopping the servant...');
					}
					if(window.parent.adviseLaunchInfo && window.parent.adviseLaunchInfo.servantURL) {
					jQuery.ajax(window.parent.adviseLaunchInfo.servantURL+'stop')
						.done(function() {
							window.parent.history.back();
						});
				} else {
					window.parent.history.back();
				}
			}
		}
		// Insert the created object to the html head element
		var head = document.getElementsByTagName('head').item(0);
		head.appendChild(platformScript);
	};

	if(window.widget) {
	    window.widget.addEvent('onLoad', loadPlatformJS);
		window.widget.addEvent('onUpdatePreferences', loadPlatformJS);
	} else {
		console.info("Widget is not defined; loading page directly!");
		loadPlatformJS();
	}
	window.onbeforeunload = removeGlobalLinks;
   	window.onunload = removeGlobalLinksTryAgain;
//]]>
</script>
</head>
<body onunload="removeGlobalLinks();" oncontextmenu="return false">
<!-- HTML definitions for the Application -->
		<div id="titleContainer" class="sim-ui-title-container">
			<div id="titleText" class="sim-ui-title-text"></div>
			<div id="exitButton" class="sim-ui-panel-content-toolbarbutton"
				data-icon="exit" style="border:none!important; margin:0px!important; box-shadow:none!important"></div>
		</div>
		<div id="previewpage" data-name="Preview"
			data-showbasket="false" class="sim-ui-page">
			<div id="previewpageContentPanel" class="sim-ui-panel-content"
				style="left: 2px">
				<div id="previewpageview" class="sim-ui-panel-content-view"
					data-primary="true">
					<div id='sim-ui-preview-containerDiv'></div>
				</div>

				<div id="previewtoolbar" class="sim-ui-panel-content-toolbar">
					<!--  <div class="sim-ui-panel-content-toolbarbutton"
						data-icon="save" data-scope="app" title="Save"></div> -->
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="restore" data-scope="app" title="Restore"></div>
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="copyto" data-scope="app" title="Copy Chart To Report"></div>
					<!-- <div class="sim-ui-panel-content-toolbarbutton"
						data-icon="help" data-scope="app" title="Help"></div> -->
					<!-- div id="previewUploadButton2"
						class="sim-ui-panel-content-toolbarbutton" title="Upload"></div>
					<div id="previewclipboardButton"
						class="sim-ui-panel-content-toolbarbutton" title="Clipboard"></div -->
				</div>

			</div>
		</div>
		<div id="definepage" data-name="Define"
			data-showbasket="false" class="sim-ui-page">
			<div id="definecontentpanel" class="sim-ui-panel-content">
				<div id="parameterhierarchyview" class="sim-ui-panel-content-view"
						data-primary="false">
				</div>
				<div id="parametermappingview" class="sim-ui-panel-content-view"
						data-primary="false">
				</div>
				<div id="parameterdefinitionview" class="sim-ui-panel-content-view"
						data-primary="true">
				</div>
				<div id="interactiveviewermapview" class="sim-ui-panel-content-view" data-primary="false"></div>
				<div id="definepagetoolbar"
					class="sim-ui-panel-content-toolbar">
					
					<div class="sim-ui-panel-content-toolbarbutton ra-wiw-save wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-database-save"
						data-scope="app" title="Save"></div>
						
					<div class="sim-ui-panel-content-toolbarbutton" id="def-restore"
						data-icon="restore" data-scope="app" title="Restore"></div>
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="copyto" data-scope="app" title="Copy Chart To Report"></div>
				</div>
				<div id="definepageviewbar" class="sim-ui-panel-content-viewbar">
					<div id="parameterhierarchyviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="icon_mindmap" data-view="parameterhierarchyview" title="Parameter Hierarchy">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Hierarchy">Hierarchy</div>
					</div>
					
					<div id="parametermappingviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="icon_parametermap" data-view="parametermappingview" title="Parameter Mapping">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Mapping">Mapping</div>
					</div>
					
					<div id="parameterdefinitionviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="icon_pde" data-view="parameterdefinitionview" title="Parameter Definitions">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Define">Define</div>
					</div>
					
					<div id="interactiveviewermapviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="icon_parametermap" data-view="interactiveviewermapview" title="Parameter Mapping">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Mapping">Mapping</div>
					</div>
				</div>
			</div>
		</div>
		<div id="shopdesignspage" data-name="Explore" class="sim-ui-page">
			<div id="shopdesignscontrolpanel" class="sim-ui-panel-control">
				<div id="parametercontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameters">Parameters</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton sim-ui-panel-controlgroup-search">
							<input class="sim-ui-panel-controlgroup-search-input" type="text"/>
							</div>
							<!-- <div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-pencil"
								title="Edit Parameters"></div>-->
							<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
								data-helpTopic="Parameters" title="Help"></div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel">
					</div>
				</div>
				<div id="shopPageControlGroupContainer">
					<div id="overallscorefilter" class="sim-ui-panel-controlgroup">
						<div class="sim-ui-panel-controlgroup-headerbar"
							data-collapseable="true">
							<div class="sim-ui-panel-controlgroup-headertext" data-text="Overall Score">Overall Score</div>
							<div class="sim-ui-panel-controlgroup-toolbar">
								<div id="overallScoreViewButton" class="sim-ui-panel-controlgroup-toolbarbutton ui-icon"
									title="Histogram View"></div>
								<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
									data-helpTopic="Scoring" title="Help"></div>
								<div
									class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
									onclick="return toggleCollapseExpand(event);"></div>
							</div>
						</div>
						<div class="sim-ui-panel-controlgroup-contentpanel"></div>
					</div>
					<div id="feasibilityfiltercontrol" class="sim-ui-panel-controlgroup">
						<div class="sim-ui-panel-controlgroup-headerbar"
							data-collapseable="true">
							<div class="sim-ui-panel-controlgroup-headertext" data-text="Feasibility">Feasibility</div>
							<div class="sim-ui-panel-controlgroup-toolbar">
								<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
									data-helpTopic="Feasibility" title="Help"></div>
								<div
									class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
									onclick="return toggleCollapseExpand(event);"></div>
							</div>
						</div>
						<div class="sim-ui-panel-controlgroup-contentpanel">
							<table>
								<tr>
									<td style="color: rgb(25, 95, 105); width:50%;"><input id="bestFilterCheckBox" type="checkbox"
										onclick="return proxy.toggleFilter('best');"></input><span id="bestFilterLabel">Best Alternatives</span></td>
									<td style="color: rgb(145, 45, 45); width:50%;"><input id="infeasibleFilterCheckBox" type="checkbox"
										onclick="return proxy.toggleFilter('infeasible');"></input><span id="infeasibleFilterLabel">Infeasible</span></td>
								</tr>
								<tr>
									<td style="color: rgb(0, 206, 209);"><input id="dominatedFilterCheckBox" type="checkbox"
										onclick="return proxy.toggleFilter('dominated');"></input><span id="dominatedFilterLabel">Dominated</span></td>
									<td style="color: rgb(145, 145, 145);"><input id="excludedFilterCheckBox"
										type="checkbox" onclick="return proxy.toggleFilter('excluded');"></input><span id="excludedFilterLabel">Excluded</span></td>
								</tr>
							</table>
						</div>
					</div>
					<div id="sim-ui-dataSourceFilter" class="sim-ui-panel-controlgroup">
						<div class="sim-ui-panel-controlgroup-headerbar"
							data-collapseable="true">
							<div class="sim-ui-panel-controlgroup-headertext"  data-text="Data Sources">Data Sources</div>
							<div class="sim-ui-panel-controlgroup-toolbar">
								<div
									class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
									onclick="return toggleCollapseExpand(event);"></div>
							</div>
						</div>
						<div class="sim-ui-panel-controlgroup-contentpanel">
							<table>
							</table>
						</div>
					</div>
					<div id="shopdesignspagerankingmethodcontrol" class="sim-ui-panel-controlgroup">
						<div class="sim-ui-panel-controlgroup-headerbar"
							data-collapseable="true">
							<div class="sim-ui-panel-controlgroup-headertext"  data-text="Ranking Method">Ranking Method</div>
							<div class="sim-ui-panel-controlgroup-toolbar">
								<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
									data-helpTopic="Scoring" title="Help"></div>
								<div
									class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
									onclick="return toggleCollapseExpand(event);"></div>
							</div>
						</div>
						<div class="sim-ui-panel-controlgroup-contentpanel"
							style="text-align: center;">
							<select id="shopdesignspagerankingMethodSelection" class="rankingMethodSelection"
								style="margin-top: 5px; margin-bottom: 5px; width: 50%">
								<option value="WEIGHTED_SUM" data-text="Weighted Sum">Weighted Sum</option>
								<option value="TOPSIS" data-text="TOPSIS">TOPSIS</option>
							</select>
						</div>
					</div>

					<div id="shopdesignspagecollapsedState"
						class="sim-ui-panel-control-collapsed" style="display: none;" data-text="Parameter Controls and Filters">
						Parameter Controls and Filters</div>
				</div>
			</div>
			<div id="shopdesignscontentpanel" class="sim-ui-panel-content">
				<!-- div id="thumbnailView" class="sim-ui-panel-content-view"
					data-primary="false">Thumbnail goes here</div-->
				<div id="tableView" class="sim-ui-panel-content-view"
					data-primary="true">
				</div>
				<div id="scatterViewMVP" class="sim-ui-panel-content-view"
					data-primary="false">
					<div id="scatterPlotMatrix"></div>
					<div id="scatterPlotMatrixFooter">
						<div id="MVPselectionDiv0" class="sim-ui-scatter-selectionDiv sim-ui-scatterMVP"></div>
						<div id="MVPselectionDiv1" class="sim-ui-scatter-selectionDiv sim-ui-scatterMVP"></div>
						<div id="MVPselectionDiv2" class="sim-ui-scatter-selectionDiv sim-ui-scatterMVP"></div>
					</div>
				</div>
				<!-- div id="scatterView" class="sim-ui-panel-content-view"
					data-primary="false">scatter goes here</div-->
				<div id="mapView" class="sim-ui-panel-content-view"
					data-primary="false"></div>

				<div id="historyView" class="sim-ui-panel-content-view" data-primary="false"></div>
				
				<!-- <div id="mgridhistoryview" class="sim-ui-panel-content-view" data-primary="false">
					<div id="history-mg-container" class="mgrid-container"></div>
				</div> -->

				<div id="toolbar" class="sim-ui-panel-content-toolbar">
					<!--<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="save" data-scope="app" title="Save"></div>-->
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="restore" data-scope="app" title="Restore"></div>
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="copyto" data-scope="app" title="Copy Chart To Report"></div>
					<div id="exploreDownload" class="sim-ui-panel-content-toolbarbutton"
						data-icon="export" data-scope="app" title="Export Data To File"></div>
					<!-- <div id="helpButton" class="sim-ui-panel-content-toolbarbutton"
						data-icon="help" data-scope="app" title="Help"></div> -->
					<!-- div id="clipboardButton" class="sim-ui-panel-content-toolbarbutton"
						data-icon="clipboard" data-scope="shopdesignspage" title="Clipboard"></div -->
				</div>
				<div id="viewbar" class="sim-ui-panel-content-viewbar">
					<!--div id="thumbnailViewButton"
						class="sim-ui-panel-content-viewbutton" data-view="thumbnailView"
						data-icon="thumbnail" title="Thumbnail View"></div-->
					<div id="tableViewButton" class="sim-ui-panel-content-viewbutton"
						data-view="tableView" data-icon="table" title="Table View">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Table">Table</div>
					</div>
					<div id="historyViewButton" class="sim-ui-panel-content-viewbutton"
						data-view="historyView" data-icon="ra-fonticonChartLine"  title="History View">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="History">History</div>
					</div>
					<div id="scatterViewButtonMVP" class="sim-ui-panel-content-viewbutton"
						data-view="scatterViewMVP" data-icon="scatter" title="Scatter Plot View">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Scatter">Scatter</div>
					</div>
					<!--div id="scatterViewButton" class="sim-ui-panel-content-viewbutton"
						data-view="scatterView" data-icon="scatter" title="Scatter Plot View"></div-->
					<div id="mapViewButton" class="sim-ui-panel-content-viewbutton"
						data-view="mapView" data-icon="som"  title="Map View">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Map">Map</div>
					</div>
				</div>
				<div id="designCountStatusPanel" class="sim-ui-panel-content-status-panel">
				</div>
			</div>
		</div>

		<div id="predictpage" data-name="Predict"
			data-showbasket="true" class="sim-ui-page">
			<div id="predictcontrolpanel" class="sim-ui-panel-control">

				<div id="predictapproxcontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Approximations">Approximations</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div id="approxSettings"
								class="approx-control-button sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-plus"></div>
							<div
								class="approx-control-button sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>

					<div class="sim-ui-panel-controlgroup-contentpanel">
						<ra-approx-table></ra-approx-table>
					</div>
				</div>

				<div id="predictcontrolmeasurediv">

					<div id="predictinputscontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
							<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameters - Input">Parameters - Input</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton sim-ui-panel-controlgroup-search">
								<input id="predictinputssearch" class="sim-ui-panel-controlgroup-search-input" type="text"/>
							</div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel">
					</div>
				</div>

				<div id="predictoutputscontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
							<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameters - Output">Parameters - Output</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton sim-ui-panel-controlgroup-search">
								<input id="predictoutputssearch" class="sim-ui-panel-controlgroup-search-input" type="text"/>
							</div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel">
					</div>
				</div>

				<div id="predictotherscontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameters - Unknown">Parameters - Unknown</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton sim-ui-panel-controlgroup-search">
								<input id="predictotherssearch" class="sim-ui-panel-controlgroup-search-input" type="text"/>
							</div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel">
					</div>
				</div>

					<!-- div id="predictstatuscontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext">Prediction Status</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton sim-ui-panel-controlgroup-search">
							<input class="sim-ui-panel-controlgroup-search-input" type="text"/>
							</div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel sim-ui-predictStatusControlPanel">
							<div class="sim-ui-predictControl-text"></div>
					</div>
					</div-->
					</div>
			</div>

			<div id="predictcontentpanel" class="sim-ui-panel-content">

				<div id="profilerview" class="sim-ui-panel-content-view"
						data-primary="true">
				</div>

				<div id="measureview" class="sim-ui-panel-content-view"
						data-primary="false">
				</div>
				
				<div id="optimize-mgrid-view" class="sim-ui-panel-content-view" data-primary="false">
					<div id="optimize-no-opt-banner"></div>
					<div id="optimize-main" class="show-opt">
						<div id="optimize-content">
							<div id="optimize-mg-container" class="mgrid-container"></div>
						</div>
						<!-- <div class="optimize-sidepanel">
							<div class="optimize-sidepanel-toggle"></div>
							<div id="optimize-paramgrid-inner"></div>
						</div> -->
						<!-- <div id="optimize-footer"></div> -->
					</div>
					
				</div>

				<div id="statusview" class="sim-ui-panel-content-view"
					data-primary="false">

					<div class="sim-ui-statusView-statusTitle"></div>
					<div class="sim-ui-statusView-statusSubTitle"></div>
					<div class="sim-ui-statusView-statusBarBorder">
						<div class="sim-ui-statusView-statusBarContainer">
							<div class="sim-ui-statusView-statusBar"></div>
						</div>
					</div>
					<button class="sim-ui-statusView-button"></button>
					<div class="sim-ui-statusView-errorDetails"></div>

				</div>

				<div id="predictpagetoolbar"
					class="sim-ui-panel-content-toolbar">
					
					<div class="sim-ui-panel-content-toolbarbutton ra-wiw-save wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-database-save"
						data-scope="app" title="Save"></div>
						
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="restore" data-scope="app" title="Restore"></div>

					<div id="addPredDesignButton" data-scope="app" class="sim-ui-panel-content-toolbarbutton"
						data-icon="add_design" data-scope="app" title="Add Predicted Alt."></div>
						
					<div id="runOptimize" class="sim-ui-panel-content-toolbarbutton opt-settings"
						data-icon="play_large" data-scope="app"></div>
					<div id="stopOptimize" class="sim-ui-panel-content-toolbarbutton opt-settings"
						data-icon="stop" data-scope="app"></div>
					<div id="viewParametersOptimize" class="sim-ui-panel-content-toolbarbutton opt-settings"
						data-icon="parameters" data-scope="app"></div>
					<div id="settingsOptimize" class="sim-ui-panel-content-toolbarbutton opt-settings"
						data-icon="options" data-scope="app"></div>
					<div id="showimprov" class="sim-ui-panel-content-toolbarbutton opt-settings"
						data-icon="show_all_line" data-scope="app" style="opacity: 0.85"></div>
					<div id="clearOptimize" class="sim-ui-panel-content-toolbarbutton opt-settings"
						data-icon="exclude" data-scope="app"></div>
					<div id="optimizeResDownload" class="sim-ui-panel-content-toolbarbutton opt-settings"
						data-icon="export" data-scope="app"></div>
						
					<div class="sim-ui-panel-content-predictStatus">
						<div class="sim-ui-panel-content-predictStatus-fixed"></div>
						<div class="sim-ui-panel-content-predictStatus-text"></div>
					</div>
				</div>

				<div id="predictpageviewbar" class="sim-ui-panel-content-viewbar">
					<div id="profilerviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="profiler" data-view="profilerview" title="Profiler">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Profiler">Profiler</div>
					</div>
					
					<div id="measureviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="measure" data-view="measureview" title="Measure">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Measure">Measure</div>
					</div>
					
					<div id="optimize-mgrid-view-button"
						class="sim-ui-panel-content-viewbutton" data-icon="optimize" data-view="optimize-mgrid-view" style="display:none" title="Optimize">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Optimize">Optimize</div>
					</div>
				</div>
			</div>
		</div>
		<div id="comparedesignspage" data-name="Compare"
			class="sim-ui-page">
			<div id="comparedesignscontrolpanel" class="sim-ui-panel-control">
				<div id="radarplotcontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Objective Comparison">Objective Comparison</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-extlink ra-popout"></div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div id="radarplotcontrolcontentpanel" class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
				<div id="designalternativescontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Alternatives">Alternatives</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
				<div id="modelviewcontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Files">Files</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
				<div id="compareparamfiltercontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameter View">Parameter View</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
				<div id="comparedesignset" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Compare">Compare</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
								data-helpTopic="Scoring" title="Help"></div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel" style="text-align:center"></div>
				</div>
				<div id="comparedesignspagerankingmethodcontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Ranking Method">Ranking Method</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
								data-helpTopic="Scoring" title="Help"></div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"
						style="text-align: center;">
						<select id="comparedesignspagerankingMethodSelection" class="rankingMethodSelection"
							style="margin-top: 15px; width: 50%">
							<option value="WEIGHTED_SUM" data-text="Weighted Sum">Weighted Sum</option>
							<option value="TOPSIS" data-text="TOPSIS">TOPSIS</option>
						</select>
					</div>
				</div>
				<div id="comparedesignspagecollapsedstate"
					class="sim-ui-panel-control-collapsed" style="display: none;" data-text="Parameter Controls and Filters">
					Parameter Controls and Filters</div>
			</div>
			<div id="comparedesignscontentpanel" class="sim-ui-panel-content">
				<div id="comparedesignsthumbnailview2" class="sim-ui-panel-content-view"
					data-needs-images="true" data-primary="true"></div>
				<!-- the template below is used for building the ecommerce table -->
				<template id="SMAAnalyticsECommerceTable">
					<div class="smaAdviseEcommerceBase">
						<div class="smaAdviseEcommerceHeader">
							<div class="smaAdviseEcommerceHeadOuter">
								<div class="smaAdviseEcommerceHeadInner"></div>
							</div>
						</div>
						<div class="smaAdviseEcommerceMain">
							<div class="smaAdviseEcommerceContentOuter">
								<div class="smaAdviseEcommerceContentInner">
								</div>
							</div>
						</div>
						<div class="smaAdviseEcommerceFooter">
							<div class="smaAdviseEcommerceFooterOuter">
								<div class="smaAdviseEcommerceFooterInner">
								</div>
							</div>
						</div>
						<div class="smaAdviseTable-leftbar"></div>
						<div class="smaAdviseTable-rightbar"></div>
					</div>
				</template>
				<template id="smaAdviseECommerceHeaderRow">
					<row-head>
					</row-head>
				</template>
				<template id="smaAdviseECommerceDataHead">
					<data-handle></data-handle>
					<h1 data-text="Alt. Name">Alt. Name</h1>
					<div class="data-head-flags"><span class="smaAdviseIsRecommended"></span></div>
					<div class="smaAdviseHeaderImgContainer">
						<div class="missing-image" data-text="No Image">No Image</div>
						<img src="" />
					</div>
				</template>
				<template id="smaAdviseECommerceDataGroup">
					<row-head>
						<data-handle></data-handle>
						<!-- <span class="collapse-group ui-icon ui-icon-triangle-1-n sim-ui-panel-controlgroup-toolbarbutton"></span>
						<h1 class="group-name display-name"></h1> -->
					</row-head>
				</template>
				<template id="smaAdviseECommerceDataRow">
					<row-head>
						<data-handle></data-handle>
					</row-head>
				</template>
				<div id="comparedesignsecomview" class="sim-ui-panel-content-view">
				</div>

				<div id="comparedesignstoolbar" class="sim-ui-panel-content-toolbar">
					
					<div class="sim-ui-panel-content-toolbarbutton ra-wiw-save wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-database-save"
						data-scope="app" title="Save"></div>
						
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="restore" data-scope="app" title="Restore"></div>
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="copyto" data-scope="app" title="Copy Chart To Report"></div>
				</div>
				<div id="comparedesignsviewbar" class="sim-ui-panel-content-viewbar">
					<div id="comparedesignstableviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="compare_icon" data-view="comparedesignsthumbnailview2" title="Thumbnail View">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Thumbnail">Thumbnail</div>
					</div>

					<div id="comparedesignsecommviewbutton"
						class="sim-ui-panel-content-viewbutton" data-icon="table" data-view="comparedesignsecomview" title="Table View">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Table">Table</div>
					</div>
				</div>
			</div>
		</div>
		<div id="elicitpreferencespage" data-name="Collaborate"
			class="sim-ui-page">
			<div id="elicitpreferencescontrolpanel" class="sim-ui-panel-control">
				<div id="ellicitweightscontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameter Weight">Parameter Weight</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton sim-ui-panel-controlgroup-search">
							<input class="sim-ui-panel-controlgroup-search-input" type="text"/>
							</div>
							<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
								data-helpTopic="PriorityWeightCalculations" title="Help"></div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
				<div id="elicitpreferencespagerankingmethodcontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Ranking Method">Ranking Method</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
								data-helpTopic="Scoring" title="Help"></div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"
						style="text-align: center;">
						<select id="elicitpreferencespagerankingMethodSelection" class="rankingMethodSelection"
							style="margin-top: 15px; width: 50%">
							<option value="WEIGHTED_SUM" data-text="Weighted Sum">Weighted Sum</option>
							<option value="TOPSIS" data-text="TOPSIS">TOPSIS</option>
						</select>
					</div>
				</div>
				<div id="parametermodelcontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameters by Group">Parameters by Group</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
				<div id="parametertypecontrol" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Parameter Priority">Parameter Priority</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-help"
								data-helpTopic="PriorityWeightCalculations" title="Help"></div>
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
				<div id="comparedesignspagecollapsedstate"
					class="sim-ui-panel-control-collapsed" style="display: none;" data-text="Parameter Controls and Filters">
					Parameter Controls and Filters</div>
			</div>
			<div id="elicitpreferencescontentpanel" class="sim-ui-panel-content">
				<div id="elicitpreferencespageview" class="sim-ui-panel-content-view" data-primary="true">
					<div id="sim-ui-elicit-alternateDesignRankingDiv" class="sim-ui-elicit-contentHolderDiv" data-text="Bar chart etc.">Bar chart etc.</div>
					<div class="sim-ui-radialClusterContainer sim-ui-elicit-contentHolderDiv">
						<div id="sim-ui-elicit-parameterPreferencesDiv" data-text="Bracket chart etc.">Bracket chart etc.</div>
					</div>
					<div id="sim-ui-elicit-designParameterSummaryDiv" class="sim-ui-elicit-contentHolderDiv" data-text="Compare table">Compare table</div>
					<div class="sim-ui-page-elicit-error-message" data-text="no_alternatives_in_basket">There are no alternatives in the basket!</div>
				</div>
				<div id="sessionview" class="sim-ui-panel-content-view" data-primary="false">
					<div id="sessionManager" class="sim-ui-session-section"></div>
					<div id="sessionDiscussion" class="sim-ui-session-section"></div>
				</div>
				<div id="elicitpreferencespagetoolbar"
					class="sim-ui-panel-content-toolbar">
					<!-- <div class="sim-ui-panel-content-toolbarbutton"
						data-icon="save" data-scope="app" title="Save"></div> -->
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="restore" data-scope="app" title="Restore"></div>
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="copyto" data-scope="app" title="Copy Chart To Report"></div>
					<!-- <div class="sim-ui-panel-content-toolbarbutton"
						data-icon="help" data-scope="app" title="Help"></div> -->
					<!-- <div id="helpbutton" class="sim-ui-panel-content-toolbarbutton"
						data-icon="help" data-scope="elicitpreferencespage" title="Help"></div>
					<div id="refershbutton" class="sim-ui-panel-content-toolbarbutton"
						data-icon="refresh" data-scope="elicitpreferencespage" title="Restore"></div>
					<div id="downloadbutton" class="sim-ui-panel-content-toolbarbutton"
						data-icon="download" data-scope="elicitpreferencespage" title="Download"></div> -->
				</div>
				<div id="elicitpreferencesviewbar" class="sim-ui-panel-content-viewbar">
					<div id="preferencesViewButton"
						class="sim-ui-panel-content-viewbutton" data-icon="collaborate_view" data-view="elicitpreferencespageview">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Collaborate">Collaborate</div>
					</div>
					<div id="sessionViewButton"
						class="sim-ui-panel-content-viewbutton" data-icon="ra-fonticonUserAdd" data-view="sessionview">
						<div class="sim-ui-panel-content-viewbutton-text" data-text="Session">Session</div>
					</div>
				</div>
			</div>
		</div>
		<div id="recommenddesignpage" data-name="Recommend"
			class="sim-ui-page">
			<div id="recommenddesigncontentpanel" class="sim-ui-panel-content">
				<div id="designview" class="sim-ui-panel-content-view" data-primary="true" style="overflow: auto;">
				<div class="sim-ui-page-recommend-error-message" data-text="no_alternatives_in_basket">There are no alternatives in the basket!</div>
				<select class="sim-ui-page-recommend-label"> <option value="Alternative #" data-text='Alternative_pound'>Alternative #</option></select>
				<div class="sim-ui-page-recommend-container">
					<div id="sim-ui-page-recommend-images-container" class="sim-ui-page-recommend-images-container sim-ui-table-cell">
						<div class="sim-ui-table-cell-inner">
							<select class="sim-ui-page-recommend-imageselector"></select>
							<div class="sim-ui-page-recommend-image-panel">
								<img class="sim-ui-page-recommend-image" />
							</div>
						</div>
					</div>
					<div id="sim-ui-page-recommend-parameters-container" class="sim-ui-page-recommend-parameters-container sim-ui-table-cell">
						<div class="sim-ui-table-cell-inner">
							<select class="sim-ui-page-recommend-parameters-selector"></select>
							<div id="sim-ui-page-recommend-parameters-table" class="sim-ui-page-recommend-parameters-table"></div>
						</div>
					</div>
					<div id="sim-ui-page-recommend-notes-container" class="sim-ui-page-recommend-notes-container sim-ui-table-cell">
						<div class="sim-ui-table-cell-inner">
							<select class="sim-ui-page-recommend-commentBox-selector">
								<option selected value="#sim-ui-recommend-comments-outer" data-text="Comments">Comments</option>
								<option value="#sim-ui-recommend-likes-outer" data-text="Likes">Likes</option>
								<option value="#sim-ui-recommend-notes-outer" data-text="Notes">Notes</option>
							</select>
							<div id="sim-ui-recommend-comments-outer" class="sim-ui-recommend-commentBox"></div>
							<div id="sim-ui-recommend-likes-outer" class="sim-ui-recommend-commentBox"></div>
							<div id="sim-ui-recommend-notes-outer" class="sim-ui-recommend-commentBox">
								<div id="sim-ui-page-recommend-notes" class="sim-ui-page-recommend-notes" contenteditable="true"></div>
								<div class="sim-ui-recommend-notes-buttons">
									<span id="save-recommended-notes" data-text="Apply Changes">Apply Changes</span>
									<span id="undo-recommended-notes" data-text="Revert Changes">Revert Changes</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="sim-ui-page-recommend-requirementstreemap" style="min-height: 500px;border: #ccc 2px solid;margin: 5px;">
				</div>
				</div>


				<div id="toolbar1" class="sim-ui-panel-content-toolbar">
					<!-- <div class="sim-ui-panel-content-toolbarbutton"
						data-icon="save" data-scope="app" title="Save"></div> -->
					<div class="sim-ui-panel-content-toolbarbutton"
						data-icon="restore" data-scope="app" title="Restore"></div>
					<div id="recommendedSharePDF" class="sim-ui-panel-content-toolbarbutton"
						data-icon="export" data-scope="app" title="Share"></div>
					<div id="openPS" class="sim-ui-panel-content-toolbarbutton"
						data-icon="SMAExeOpenInPS" data-scope="app" title="Performance Study"></div>
				</div>
				<div id="viewbar1" class="sim-ui-panel-content-viewbar">
					<div id="designViewButton" class="sim-ui-panel-content-viewbutton"
						data-view="designview"></div>
				</div>
			</div>
			<!--  commented out til I get around to fixing the back end -->
			<!--  <div id="recommendcontrolpanel" class="sim-ui-panel-control">
				<div id="recommendReportFilesList" class="sim-ui-panel-controlgroup">
					<div class="sim-ui-panel-controlgroup-headerbar"
						data-collapseable="true">
						<div class="sim-ui-panel-controlgroup-headertext" data-text="Additional Files for Reporting">Additional Files for Reporting</div>
						<div class="sim-ui-panel-controlgroup-toolbar">
							<div
								class="sim-ui-panel-controlgroup-toolbarbutton ui-icon ui-icon-triangle-1-n"
								onclick="return toggleCollapseExpand(event);"></div>
						</div>
					</div>
					<div class="sim-ui-panel-controlgroup-contentpanel"></div>
				</div>
			</div>-->
		</div>
		<!-- Globals -->
		<div id="footer" class="sim-ui-footer">
				<div id="footerNav" class="sim-ui-navigator-container">	</div>
				<div id="footerStation" class="sim-ui-footer-station" title="">
					<span class="sim-ui-footer-station-icon"></span>
					<span class="sim-ui-footer-station-text"></span>
				</div>
		</div>
		<div id="basket" class="sim-ui-basket">
			<div id="basket-icon" class="sim-ui-basket-icon" title="Basket"></div>
			<div id="basket-count" class="sim-ui-basket-count">0</div>
			<div id="basket-popover" class="sim-ui-basket-popover"></div>
		</div>

<div class="sim-ui-advise-alert-message">
<div class="sim-ui-advise-alert-message-text"></div>
</div>

<div id="sim-ui-global-spinner" class="sim-spinnerHidden">
	<div class="sim-ui-veil" id="sim-ui-veil">
	</div>
	<div class="loading"></div>
</div>
<!-- End of HTML definitions -->

</body>
</html>

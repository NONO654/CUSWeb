define("DS/DELWebMfgAssetsDefOccurenceModel/AbstractTreeDocument",["UWA/Core","DS/Logger/Logger","UWA/Class/Options","DS/Tree/TreeDocument","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/Resources"],function(e,c,h,a,g,f){var i=a.extend(h,{name:"AbstractTreeDocument",_logger:null,_context:null,_treelistview:null,init:function k(l){this._parent(l);this._logger=c.getLogger(i);this._context=this.getOption("context");this._treelistview=this.getOption("treelistview");this.onPreExpand(this._onPreExpand.bind(this))},getTreeListView:function d(){return this._treelistview},getNodeModel:function j(o,m){var n=null;m=m||{};if(!o){this._logger.warn("No value to search for");return null}n=this.search({match:function l(t){var q=false,p=null,s=null,r=t.nodeModel;if(true===m.searchInstancePID){p=r.getInstancePID();if(m.searchReferencePID){s=e.is(p,"string")?p:null;p=r.getReferencePID()}}else{if(true===m.searchAbsolutePath){p=r.getAbsolutePath().toString();o=o.toString()}else{if(true===m.searchPathToScope){p=r.getPathToScope().toString();o=o.toString()}else{p=r.getReferencePID()}}}if((o===p)||((e.is(s,"string")&&(s!=="")&&(o===s)))){q=true}return q},useTransaction:false});if(m.returnFirstOne){if(0<n.length){n=n[0]}else{n=null}}return n},_onPreExpand:function b(t){var w,v,p,r,o,u=this,l=this._context,s=this.alertManager,n=function n(x){o.preExpandDone();o.pushUpdate();if(""!==x){o.setState({state:x})}},q=function q(){var x="";if(!o.hasChildren()){u._treelistview.utils.fillReferenceTreeNode(o)}if(!o.hasChildren()){x="noChildren"}n(x)},m=function m(){s.add({className:"error",message:f.getNLSValue("Error.ExpandFailed.Title")});v.set("queriedForChildren",false);n("collapsed")};if(e.is(t)&&e.is(t.data)&&e.is(t.data.nodeModel)){o=t.data.nodeModel;if(e.is(o)){r=o.getReferencePID();if(e.is(r,"string")&&(""!==r)){v=g.references.get(r);if(e.is(v)){o.prepareUpdate();p=v.get("queriedForChildren");if(p){q(o)}else{w={ordered:false,context:this,doNotExpand:true,onFailure:m,onTimeout:m,onCancel:m};g.getDescendantsFromServer(v.id,q,w)}}}}}}});return i});define("DS/DELWebMfgAssetsDefOccurenceModel/AbstractTreeNodeModel",["UWA/Core","UWA/Controls/Abstract","DS/Logger/Logger","DS/Tree/TreeNodeModel","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/ModelPreferences"],function(d,O,c,t,x,G,M,p){var B={BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight",TOP_LEFT:"topLeft",TOP_RIGHT:"topRight",};var A=function A(R){R=R||{};this._logger=c.getLogger(A);this._isPopulated=false;this._isFiltered=false;this._referencePID=null;this._instancePID=null;this._type=null;this.options={label:"",badges:this._badges,icons:[],grid:{},thumbnail:null,useAsyncPreExpand:true};this.setReferencePID(R.referencePID);this.setReferenceType(R.referenceType);this.options=d.extend(this.options,R);if(R.instancePID){this.setInstancePID(R.instancePID)}t.call(this,this.options);this.onHighlight(this._onHighlight);this.onUnhighlight(this._onUnhighlight);this.object={};this.options.grid["ds6w:type"]=this.getReferenceType();this.object.type=this.getReferenceType()};function g(R){if(!R._getFilterInfo){R._getFilterInfo=A.prototype._getFilterInfo.bind(R);R._getChildrenFilterInfo=A.prototype._getChildrenFilterInfo.bind(R);R._removeChildrenFilterInfo=A.prototype._removeChildrenFilterInfo.bind(R);R.filterInChild=A.prototype.filterInChild.bind(R);R.filterOutChild=A.prototype.filterOutChild.bind(R)}}A.prototype=Object.create(t.prototype);A.prototype.constructor=A;A.prototype.name="AbstractTreeNodeModel";A.prototype.getID=function m(){return this.getReferencePID()};A.prototype.isPopulated=function Q(){return this._isPopulated};A.prototype.setPopulated=function q(R){if(!d.is(R,"boolean")){return null}this._isPopulated=R;return this.isPopulated()};A.prototype.setReferencePID=function n(R){if(!d.is(R,"string")){return null}this._referencePID=R;return this.getReferencePID()};A.prototype.setInstancePID=function u(R){if(!d.is(R,"string")){return null}this._instancePID=R;return this.getInstancePID()};A.prototype.setReferenceType=function o(R){if(!d.is(R,"string")){return null}this._type=R;return this.getReferenceType()};A.prototype.getReferencePID=function P(){return this._referencePID};A.prototype.getInstancePID=function C(){return this._instancePID};A.prototype.getReferenceType=function H(){return this._type};A.prototype.checkChildren=function v(V,S){var T,U,R;S=S||{};if(!d.is(V,"function")){return false}T=this.getChildren();if(!d.is(T,"array")){return false}U=T.length;if(0>=U){return false}if("every"===S.type){R=T.every(V)}else{R=T.some(V)}return R};A.prototype.pushRelatedObject=function L(R,S){var T=this.options.grid[S];S=S||"R_Name.relation";T=T||[];T.push(R);this.setAttribute(S,T)};A.prototype.getScopes=function j(U){var T,S,V;U=U||{};T=M.connections.where({from:this.getReferencePID(),type:"ProductImplementLink"}).map(function R(W){return W._attributes},this);S=M.connections.where({to:this.getReferencePID(),type:"ProductImplementLink"}).map(function R(W){return W._attributes},this);if(U.from&&U.to){V=T.concat(S)}else{if(U.to){V=S}else{V=T}}return V};A.prototype.getImplementLinks=function k(){var S=this.getInstancePID(),T=this.getPathToScope();return M.connections.filter(function(X){var W="ProductImplementLinkOcc"===X.get("type")||"ProcessImplementLinkOcc"===X.get("type"),U=X.get("from"),V=X.get("to"),Y;if(d.is(U,"array")){U=U[U.length-1]}Y=S===U||d.Json.encode(T)===d.Json.encode(V);return W&&Y}).map(function R(U){return U._attributes})};A.prototype.isScoped=function E(){return M.connections.some(function R(T){var S="ProductImplementLink"===T.get("type"),U=this.getReferencePID()===T.get("from")||this.getReferencePID()===T.get("to");return S&&U},this)};A.prototype.setIsFiltered=function D(R){if(d.is(R,"boolean")){this._isFiltered=R}};A.prototype.updateFilterBadge=function w(){if(this._isFiltered){this.setBadges({bottomRight:"filter"})}else{this.setBadges({bottomRight:""})}};A.prototype.isImplemented=function F(){var R=this.getInstancePID(),T=this.getPathToScope();return M.connections.some(function S(X){var W="ProductImplementLinkOcc"===X.get("type")||"ProcessImplementLinkOcc"===X.get("type"),U=X.get("from"),V=X.get("to"),Y;if(d.is(U,"array")){U=U[U.length-1]}Y=R===U||d.Json.encode(T)===d.Json.encode(V);return W&&Y})};A.prototype.hasLink=function J(){return this.isScoped()||this.isImplemented()};A.prototype.isUnderScope=function z(){var R=this.isRoot(),S;if(R){return false}S=this.getParent();if(!S){this._logger.warn("ERROR: No parent");return false}return S.isScopedOrUnderScope()};A.prototype.isScopedOrUnderScope=function i(){var S=false,R=this.isRoot(),T;if(this.isScoped()){S=true}else{if(R){S=false}else{T=this.getParent();if(T){S=T.isScopedOrUnderScope()}}}return S};A.prototype.getRootPID=function s(){var S=this.getRoot(),R=d.is(S)?S.getReferencePID():null;return R};A.prototype.getAbsolutePath=function y(){var R=this.getParents().reverse(),S=R.map(function T(U){return U.getInstancePID()}).concat([this.getInstancePID()]).slice(1);return S};A.prototype.getSiblingsPID=function K(){var R=this.getParent(),S,T=[];if(d.is(R)){S=R.getChildren();if(d.is(S,"array")){T=S.map(function U(V){return V.getInstancePID()})}}return T};A.prototype.getUpperScopePath=function b(){var R=this.getFirstParentWithAScopeNode(),S=d.is(R)?R.getAbsolutePath():[];return S};A.prototype.getPathToScope=function a(){var S=this.getUpperScopePath();var R=[];if(d.is(S,"array")){R=this.getAbsolutePath().slice();R.splice(0,S.length)}return R};A.prototype.getFirstParentWithAScopeNode=function l(){var S,R=null,T;if(this.isRoot()){return null}S=this;do{R=S.getParent();if(R){T=d.is(R.isScoped)&&R.isScoped()}S=R}while(!T&&S);return R};A.prototype.getImplementForScope=function f(){var R;if(!this.isScoped()){this._logger.warn("No implement for scope as node is not scoped");return null}if(!this.isUnderScope()){this._logger.warn("No implement for scope as node is not under a scope");return null}R=this.getImplementLinks();if(!d.is(R,"array")){this._logger.warn("No implement for scope found");return null}if(1>R.length){this._logger.warn("No implement for scope found");return null}return R};A.prototype.getScopedNodeAbsolutePath=function r(R){var Z,Y,U,X,T,S,V=this,W=[];if(!this.isScoped()){return null}if(!this.isUnderScope()){Z=V.getScopes()[0];Y=Z.to;if(!d.is(R.getNodeModel,"function")){return}U=R.getNodeModel(Y,{searchReferencePID:true,});T=U[0];X=T.getAbsolutePath()}else{V=this;W=[];do{Z=V.getScopes()[0];if(!V.isUnderScope()){break}S=V.getImplementForScope(Z,R);if(!d.is(S)){W=null;break}W=S[0].to.concat(W);V=V.getFirstParentWithAScopeNode()}while(d.is(V));X=W}return X};A.prototype.getScopedNode=function I(){var U,S,X,T,W,V=null,R;if(!this.isScoped()){return null}U=this.getTreeDocument();if(!U){return null}X=this.getBodyTreeListView().getDocument();S=this;if(!this.isUnderScope()){T=S.getScopes()[0];if(T){W=T.to;if(d.is(X.getNodeModel,"function")){V=X.getNodeModel(W,{searchReferencePID:true});return V}}}else{R=this.getScopedNodeAbsolutePath(X);if(!d.is(R,"array")){T=S.getScopes()[0];W=T.to;if(d.is(X.getNodeModel,"function")){V=X.getNodeModel(W,{searchReferencePID:true});return V}}if(d.is(X.getNodeModel,"function")){V=X.getNodeModel(R,{searchAbsolutePath:true,returnFirstOne:true,});return V}}};A.prototype.getBodyTreeListView=function N(){var R=this.getTreeDocument(),S=R._context;return S.getBodyTreeListView()};A.prototype.updateBI=function e(){var S=this,T=this.getReferenceType(),R=p.PPRTypes[T],U=function U(){var V=x.getIconURLFromKey("Scope"),W={bottomLeft:V,};if(S.isScoped()){S.setBadges(W)}else{S.setBadges({bottomLeft:""})}};if(R==="PROCESS"){U()}};A.prototype._getFilterInfo=function(R){if(!this.options._filterInfo&&Boolean(R)){this.options._filterInfo={}}return this.options._filterInfo};A.prototype._getChildrenFilterInfo=function(R){if(!this.options._childrenFilterInfo&&Boolean(R)){this.options._childrenFilterInfo={}}return this.options._childrenFilterInfo};A.prototype._removeFilterInfo=function(){delete this.options._filterInfo};A.prototype._removeChildrenFilterInfo=function(){delete this.options._childrenFilterInfo};A.prototype.filterInChild=function(S){var Z=this._getChildrenFilterInfo(),X,T,W,aa,V,R,Y;if(Z){X=Z.childrenBeforeFiltering;if(X){T=X.indexOf(S);if(T>=0){W=S._getFilterInfo();if(W&&W.parentBeforeFiltering===this){aa=this.getChildren();if(d.is(aa,"array")){aa.every(function U(ab){var ac=true;R=X.indexOf(ab);if(R>T){V=ab;ac=false}return ac})}delete W.parentBeforeFiltering;if(d.is(S.options.isRootAttached)){if(S.options.isRootAttached===true){this.insertBefore(S,V)}}else{this.insertBefore(S,V)}if(d.is(this.setState,"function")){this.setState({state:Z.expandStateBeforeFiltering})}S._removeFilterInfo();Y=Z.filteredOutChildren.indexOf(S);Z.filteredOutChildren.splice(Y,1);if(Z.filteredOutChildren.length===0){this._removeChildrenFilterInfo()}}}}}};A.prototype.filterOutChild=function(V){var R=this.getChildren(),U,S,T;if(R.indexOf(V)<0){throw"Not a child"}U=this._getChildrenFilterInfo(true);if(!U.childrenBeforeFiltering){U.childrenBeforeFiltering=R&&R.length>0?R.slice(0):[];T={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"};if(d.is(this._expandState)){U.expandStateBeforeFiltering=T[this._expandState]}}S=V._getFilterInfo(true);S.parentBeforeFiltering=this;if(d.is(this.removeChild,"function")){this.removeChild(V)}else{this.removeRoot(V,true,true)}if(d.is(this.setState,"function")){this.setState({state:U.expandStateBeforeFiltering})}if(!U.filteredOutChildren){U.filteredOutChildren=[]}U.filteredOutChildren.push(V)};A.prototype.filterOut=function(){var R=this.isRoot()?this.getTreeDocument():this.getParent();if(R!==null){g(R);R.filterOutChild(this)}};A.prototype.filterIn=function(R){var V=this._getFilterInfo(),T,S,U;if(V&&V.parentBeforeFiltering){T=V.parentBeforeFiltering;g(T);T.filterInChild(this)}if(R){U=this._getChildrenFilterInfo();if(U&&U.childrenBeforeFiltering){S=U.childrenBeforeFiltering}else{S=this.getChildren()}if(S){S.forEach(function(W){W.filterIn(R)})}}};A.prototype.displayStatus=function h(U,R,V,T){var S=d.is(V)?V:"transparent",W=d.is(T)?T:"";this.setAttribute(U,{colorCode:S,tooltip:W,status:R})};return A});
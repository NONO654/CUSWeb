/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcOpenInPSCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices"],function(a,c,b){var d=a.extend({execute:function(){var f=c.getCurrentProcess();var g=f&&f.getoid()||null;var e={mode:"viewondrop",collabspaces:c.getCurrentContext(),processData:{id:g,objectType:"Simulation"}};b.displayInTransientWidget("SIMDISB_AP","Performance Study",e)}});return d});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflCloseProcessCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/ContextualBar","DS/SMAProcWebApp/SMAProcWidgetInit"],function(c,b,d){var a=c.extend({execute:function(){b.hide();d.closeSimulation()}});return a});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflRefreshProcessCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/ContextualBar","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebApp/SMAProcWidgetInit"],function(b,a,c,d){return b.extend({execute:function(){c.hideLoader();a.hide();d.onRefresh()}})});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcSetMainStepCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/Selection/CSOManager","DS/ApplicationFrame/ContextualMenu","DS/JSCMM/SMAJSCMMStep","DS/SMAProcWebDiagram/graph","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebAsyncUtils/SMAProcWebTransactionManager","DS/SMAProcWebAsyncUtils/Step/MainStep","i18n!DS/SMAProcWebCMMUtils/assets/nls/SMAProcWebAuthoringNLS"],function(c,i,e,f,k,d,b,h,g,a){var j=c.extend({execute:function(){f.hide();console.log("Executing: @"+this._id);var m=e.get()||[];var l=m[0]||null;if(!(l instanceof k)){b.alert(a["Please select a step"])}else{h.add(new g(l),{updateUI:function(){d.updateGraph(d.getCurrentProcess(),false)},success:function(p){var o=require("DS/SMAProcWebDiagram/graph");var n=o.processDiagram.nodeMap;var r=n[p.getId()].views.main.display.elt;var q=n[p.getParent().getId()].views.main.display.elt;r.addMainStepIcon();q.removeMainStepIcon(n);b.displayNotification(a["SetMainStep.success.notification"],{messageType:"success"})},failed:function(){b.displayNotification(a["SetMainStep.error.notification"],{messageType:"error"})},rollbackComplete:function(){d.updateGraph(d.getCurrentProcess(),false)}})}}});return j});define("DS/SMAProcWebCmds/SMAWflAutOpenInPCN",["UWA/Core","DS/Logger/Logger","module","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices"],function(e,d,c,b,g,i,a){var h=d.getLogger(c);var f=b.extend({execute:function(){h.log("Executing: @"+this._id);if(this._id==="SMAProcWebActionBarOpenInPCNCmdHdr"){var j=i.getCurrentProcess();var k=j.getPhysicalId();this.openInPCN(k,"Simulation Process","SIMPRCN_AP");g.getCommand(this._id).end()}},openInPCN:function(k,j,q){var l=i.getCurrentContext();var n=window.widget.getValue("x3dPlatformId");if(!n){n="OnPremise"}var p={contextId:l,envId:n,objectId:k,objectType:j,serviceId:"3DDashboard"};var m={protocol:"3DXContent",version:"1.0",source:"SIMPRCW_AP",data:{items:[p]}};var o=this;require(["UWA/Utils/InterCom"],function(r){var t="com.ds."+window.widget.id;var s=new r.Socket(t);s.subscribeServer("com.ds.compass",window.parent);s.dispatchEvent("onSetObject",p,t);s.dispatchEvent("onSetX3DContent",m,t);s.addListener("launchApp",(function(u,w){if(u.response!=="COMPLETE"){var v="Failed to open process in Process Composer";if(u.response==="no_install_selected"){v+=" because several installations are present. Please launch Process Composer from the compass."}a.displayNotification(v,{messageType:"error"});h.warn("PCW : App "+w.appId+" is not available. status is :"+u.response)}else{s.dispatchEvent("onResetObject",{},t);s.dispatchEvent("onResetX3DContent",{},t)}s.disconnect();delete o.compassEventSocket}));s.dispatchEvent("onLaunchApp",{appId:q},t);a.displayNotification("Opening the process in Process Composer.",{messageType:"info"})})}});return f});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcClearMainStepCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/Selection/CSOManager","DS/ApplicationFrame/ContextualMenu","DS/JSCMM/SMAJSCMMStep","DS/SMAProcWebDiagram/graph","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebAsyncUtils/SMAProcWebTransactionManager","DS/SMAProcWebAsyncUtils/Step/MainStep","i18n!DS/SMAProcWebCMMUtils/assets/nls/SMAProcWebAuthoringNLS","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils"],function(c,i,e,f,l,d,b,h,g,a,k){var j=c.extend({execute:function(){f.hide();console.log("Executing: @"+this._id);var n=e.get()||[];var m=n[0]||null;if(!(m instanceof l)){b.alert(a["Please select a step"])}else{k.clearMainStep(m,{onSuccess:function(q){d.updateGraph(d.getCurrentProcess(),false);var p=require("DS/SMAProcWebDiagram/graph");var o=p.processDiagram.nodeMap;var r=o[q.getId()].views.main.display.elt;r.removeMainStepIcon();b.displayNotification(a["ClearMainStep.success.notification"],{messageType:"success"})},onFail:function(){b.displayNotification(a["ClearMainStep.success.notification"],{messageType:"error"})}})}}});return j});define("DS/SMAProcWebCmds/SMAProcWebCmdsUtils",["DS/Selection/CSOManager","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMException/SMAProcWebCMMError","DS/SMAProcWebExceptionManager/SMAProcWebErrorManager"],function(d,c,b,e){var a={getSelectedObject:function(g){var k=d.get()||[];var j=k[0];var l=null;var f="Select ";if(j===null||j===undefined){j=c.getCurrentProcess()}l=(g&&g.types)?g.types:["process","activity"];for(var h=0;h<l.length;h++){if((l[h]==="process"&&j.isProcess())||(l[h]==="activity"&&j.isActivity())||(l[h]==="step"&&j.isStep())||(l[h]==="gateway"&&j.isGateway())){return j}if(h===l.length-1){f+="or "+l[h]+"."}else{if(h===l.length-2){f+=l[h]+" "}else{f+=l[h]+", "}}}if(!(g&&g.silent)){e.notifyError(new b("Error",f),{autoRemove:false,})}return null}};return a});define("DS/SMAProcWebCmds/SMAProcWebCmds",function(){return{}});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcDeleteCmd",["DS/ApplicationFrame/Command","DS/Selection/CSOManager","DS/JSCMM/SMAJSCMMActivity","DS/JSCMM/SMAJSCMMStep","DS/ApplicationFrame/ContextualMenu","DS/SMAProcWebDiagram/graph","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebAsyncUtils/SMAProcWebTransactionManager","DS/SMAProcWebAsyncUtils/Activity/Delete","DS/SMAProcWebAsyncUtils/Step/Delete","DS/SMAProcWebAsyncUtils/Gateway/Delete","DS/SMAProcWebAsyncUtils/SequenceFlow/Delete","i18n!DS/SMAProcWebCMMUtils/assets/nls/SMAProcWebAuthoringNLS"],function(c,e,j,m,g,d,b,k,i,n,f,h,a){var l=c.extend({execute:function(){var u=e.get()||[];var t=u[0];var p=null;if(!t){b.alert(a["Please select an activity step"])}else{if(t instanceof j){var o=t;var s=o.getProcess();p=o.getParent();b.confirm({title:a["ActivityDelete.title"],message:a["ActivityDelete.message"],onOkay:function(){b.showLoader();k.add(new i(o),{updateUI:function(w){if(w){for(var v=0;v<w.length;v++){d.removeNode(w[v].getId())}}d.updateGraph()},success:function(){b.hideLoader();b.displayNotification(a["ActivityDelete.success.notification"],{type:"success"});d.updateGraphAll()},failed:function(){b.hideLoader();b.displayNotification(a["ActivityDelete.error.notification"],{type:"error"})},rollbackComplete:function(){d.updateGraph((p!==undefined&&p!==null&&!(p.isProcess()))?p:s,true)},after:function(){}})}})}else{if(t instanceof m){var q=t;p=q.getParent();b.confirm({title:a["StepDelete.title"],message:a["StepDelete.message"],onOkay:function(){b.showLoader();k.add(new n(q),{updateUI:function(v){if(v){d.removeNode(v.getId())}d.updateGraph()},success:function(){b.hideLoader();b.displayNotification(a["StepDelete.success.notification"],{type:"success"});d.updateGraphAll()},failed:function(){b.hideLoader();b.displayNotification(a["StepDelete.error.notification"],{type:"error"})},rollbackComplete:function(){d.updateGraph()},after:function(){}})}})}else{if(t&&t.isGateway&&t.isGateway()){var r=t;p=r.getParent();b.confirm({title:a["GatewayDelete.title"],message:a["GatewayDelete.message"],onOkay:function(){b.showLoader();k.add(new f(r),{updateUI:function(v){if(v){d.removeNode(v.getId())}d.updateGraph((p.isProcess())?p:p.getProcess(),true)},success:function(){b.displayNotification(a["GatewayDelete.success.notification"],{type:"success"});b.hideLoader();d.updateGraphAll()},failed:function(){b.hideLoader();b.displayNotification(a["GatewayDelete.error.notification"],{type:"error"})},after:function(){}})}})}else{if(t&&t.type==="EDGE"){b.confirm({title:a["EdgeDelete.title"],message:a["EdgeDelete.message"],onOkay:function(){b.showLoader();k.add(new h(t.parent,t.from,t.to),{updateUI:function(v){d.updateGraph((v.isProcess())?v:v.getProcess(),true)},success:function(){b.displayNotification(a["EdgeDelete.success.notification"],{type:"success"});b.hideLoader();d.updateGraphAll()},failed:function(){b.hideLoader();b.displayNotification(a["EdgeDelete.error.notification"],{type:"error"})},after:function(){}})}})}}}}}g.hide();d.unhighlight()}});return l});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflSearchProcessCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/ContextualBar","DS/SMAProcWebApp/SMAProcWidgetInit"],function(c,b,d){var a=c.extend({execute:function(){b.hide();d.searchSimulations()}});return a});var __awaiter=(this&&this.__awaiter)||function(a,c,b,d){return new (b||(b=Promise))(function(i,h){function e(j){try{f(d.next(j))}catch(k){h(k)}}function g(j){try{f(d["throw"](j))}catch(k){h(k)}}function f(j){j.done?i(j.value):new b(function(k){k(j.value)}).then(e,g)}f((d=d.apply(a,c||[])).next())})};var __generator=(this&&this.__generator)||function(i,d){var j={label:0,sent:function(){if(k[0]&1){throw k[1]}return k[1]},trys:[],ops:[]},e,h,k,c;return c={next:b(0),"throw":b(1),"return":b(2)},typeof Symbol==="function"&&(c[Symbol.iterator]=function(){return this}),c;function b(f){return function(g){return a([f,g])}}function a(g){if(e){throw new TypeError("Generator is already executing.")}while(j){try{if(e=1,h&&(k=h[g[0]&2?"return":g[0]?"throw":"next"])&&!(k=k.call(h,g[1])).done){return k}if(h=0,k){g=[0,k.value]}switch(g[0]){case 0:case 1:k=g;break;case 4:j.label++;return{value:g[1],done:false};case 5:j.label++;h=g[1];g=[0];continue;case 7:g=j.ops.pop();j.trys.pop();continue;default:if(!(k=j.trys,k=k.length>0&&k[k.length-1])&&(g[0]===6||g[0]===2)){j=0;continue}if(g[0]===3&&(!k||(g[1]>k[0]&&g[1]<k[3]))){j.label=g[1];break}if(g[0]===6&&j.label<k[1]){j.label=k[1];k=g;break}if(k&&j.label<k[2]){j.label=k[2];j.ops.push(g);break}if(k[2]){j.ops.pop()}j.trys.pop();continue}g=d.call(i,j)}catch(f){g=[6,f];h=0}finally{e=k=0}}if(g[0]&5){throw g[1]}return{value:g[0]?g[1]:void 0,done:true}}};define("DS/SMAProcWebCmds/SMAProcSupportabilityCmd",["require","exports","DS/ApplicationFrame/Command","DS/Usage/TrackerAPI"],function(c,b,a,e){var d=a.extend({defaultOptions:{isAsynchronous:true},execute:function(){var f=this;window.require(["DS/SMAProcWebSupportabilityUtils/diagnostics/strategies/PremadeDiagnostics","DS/SMAProcWebSupportabilityUtils/logging/loggables/PremadeLoggables","DS/SMAProcWebSupportabilityUI/ZipJSArchiver","DS/SMAProcWebSupportabilityUtils/platform/SessionInfo","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebAuthoringUI/SupportabilityComponent","DS/SMAProcWebSupportabilityUtils/SupportabilityAPI","DS/SMAProcWebCMMUtils/SMAJSCMMConfig","DS/JSCMM/SMAJSCMMUtils","DS/Selection/CSOManager","DS/SMAProcWebCmds/SMAProcAdapterValidators"],function(r,I,J,h,l,j,F,m,i,G,E){function k(K){return new Promise(function(M,L){K({onSuccess:M,onFailure:L})})}function p(O){if(O==null){return[]}var M=[O];if(O.getChildren){for(var N=0,L=O.getChildren();N<L.length;N++){var P=L[N];var K=p(P).filter(function(Q){return Q!=null});M.push.apply(M,K)}}return M}function n(){return __awaiter(this,void 0,void 0,function(){var V,T,K,Q,L,O,M,S,N,U,R,P;return __generator(this,function(W){switch(W.label){case 0:V=[];T=l.getCurrentProcess();K=p(T);return[4,l.openProcessAsPromise(T.getPhysicalId())];case 1:V=(W.sent()).getAllActivities();for(Q=0;Q<V.length;Q++){L=V[Q].getId();for(O=0,M=K;O<M.length;O++){S=M[O];if(S.getId()===L){V[Q]=S;break}}}N=function(X){return __generator(this,function(Y){switch(Y.label){case 0:if(X.getSteps){V.push.apply(V,X.getSteps())}if(!(X.isActivity&&X.isActivity())){return[3,2]}return[4,k(function(Z){return l.getActivityExecOptions(X,Z)})];case 1:Y.sent();Y.label=2;case 2:return[2]}})};U=0,R=V;W.label=2;case 2:if(!(U<R.length)){return[3,5]}P=R[U];return[5,N(P)];case 3:W.sent();W.label=4;case 4:U++;return[3,2];case 5:V.push(T);return[2,V]}})})}function u(){return __awaiter(this,void 0,void 0,function(){var K;return __generator(this,function(L){switch(L.label){case 0:K=G.get()[0];if(!(K.isActivity&&K.isActivity())){return[3,2]}return[4,k(function(M){return l.getActivityExecOptions(K,M)})];case 1:L.sent();L.label=2;case 2:return[2,K]}})})}function t(){return __awaiter(this,void 0,void 0,function(){var K,L;return __generator(this,function(M){switch(M.label){case 0:K=[];if(!(G.get().length===0)){return[3,2]}return[4,n()];case 1:K=M.sent();return[3,6];case 2:return[4,u()];case 3:L=M.sent();if(!(L.isProcess&&L.isProcess())){return[3,5]}return[4,n()];case 4:K=M.sent();return[3,6];case 5:K=[L];if(L.getSteps){K.push.apply(K,L.getSteps())}M.label=6;case 6:return[4,g(K)];case 7:M.sent();return[2,K]}})})}function v(K){return K.filter(function(L){return L.getPhysicalId!=null}).map(function(L){return{physicalId:L.getPhysicalId(),name:L.getName()}})}function o(N){var O=[];for(var L=0,K=N;L<K.length;L++){var M=K[L];if(M.getDataType()===i.DataType.PLMObject){if(M.getValue()&&M.getValue().getPhysicalId&&M.getValue().getPhysicalId()){O.push({physicalId:M.getValue().getPhysicalId(),name:M.getParent().getName()})}}}return O}function C(O){function S(T,U){var V=[];if(T&&T.getPhysicalId){V.push({physicalId:T.getPhysicalId(),name:U+" - "+T.getName()})}if(T&&T.isContentContainer&&T.isContentContainer()){var X=T.getContentChildren();for(var Y=0,Z=X;Y<Z.length;Y++){var W=Z[Y];V.push.apply(V,S(W,U+" - "+T.getName()))}}return V}var K=[];for(var N=0,M=O;N<M.length;N++){var P=M[N];if(P.getContentChildren){for(var R=0,Q=P.getContentChildren();R<Q.length;R++){var L=Q[R];K.push.apply(K,S(L,P.getName()))}}}return K}function g(K){return __awaiter(this,void 0,void 0,function(){var L,O,Q,N,M,P;return __generator(this,function(R){switch(R.label){case 0:L=0;O=function(T,S,U){L++;l.getContent(T,S,{onSuccess:function(Y){var W=Y.getContentChildren();if(W!==undefined){for(var V=0;V<W.length;V++){var X=W[V];if(X.isContentContainer&&X.isContentContainer()){O(T,X,U)}}L--;if(L===0){if(typeof U!=="undefined"&&U.onSuccess){U.onSuccess()}}}},onFailure:function(){if(typeof U!=="undefined"&&U.onFailure){U.onFailure()}}})};Q=function(S){return __generator(this,function(T){switch(T.label){case 0:if(!S.isActivity()){return[3,2]}return[4,k(function(U){return O(S,S,U)})];case 1:T.sent();T.label=2;case 2:return[2]}})};N=0,M=K;R.label=1;case 1:if(!(N<M.length)){return[3,4]}P=M[N];return[5,Q(P)];case 2:R.sent();R.label=3;case 3:N++;return[3,1];case 4:return[2]}})})}function x(K){return __awaiter(this,void 0,void 0,function(){var M,P,N,L,O;return __generator(this,function(Q){switch(Q.label){case 0:M=[];P=function(W){var R,V,T,U,S;return __generator(this,function(X){switch(X.label){case 0:if(!W.getSteps){return[2,"continue"]}R=W.getSteps();V=function(aa){var ab,Z,Y;return __generator(this,function(ac){switch(ac.label){case 0:return[4,k(function(ad){return l.updateStep(aa,ad)})];case 1:ab=ac.sent();Z=ab.getExtensionConfig();if(Z){Y=Z.getProperties();Y=Y.map(function(ad){ad.parent=W;return ad});M.push.apply(M,Y)}return[2]}})};T=0,U=R;X.label=1;case 1:if(!(T<U.length)){return[3,4]}S=U[T];return[5,V(S)];case 2:X.sent();X.label=3;case 3:T++;return[3,1];case 4:return[2]}})};N=0,L=K;Q.label=1;case 1:if(!(N<L.length)){return[3,4]}O=L[N];return[5,P(O)];case 2:Q.sent();Q.label=3;case 3:N++;return[3,1];case 4:return[2,M]}})})}function w(K){return __awaiter(this,void 0,void 0,function(){var Q,U,O,M,R,L,P,S,T,N;return __generator(this,function(V){switch(V.label){case 0:Q=[];U=function(W){var X;return __generator(this,function(Y){switch(Y.label){case 0:if(!W.isActivity()){return[3,3]}return[4,k(function(Z){return l.getParametersInPLM(W,Z)})];case 1:X=Y.sent();return[4,k(function(Z){return l.refreshDataFlows(W,Z)})];case 2:Y.sent();X=X.getParameters();Q.push.apply(Q,X);Y.label=3;case 3:return[2]}})};O=0,M=K;V.label=1;case 1:if(!(O<M.length)){return[3,4]}R=M[O];return[5,U(R)];case 2:V.sent();V.label=3;case 3:O++;return[3,1];case 4:L=[];P=[];for(S=0,T=Q;S<T.length;S++){N=T[S];if(L.indexOf(N.getId())===-1){L.push(N.getId());P.push(N)}}return[2,P]}})})}function y(N){var M=[];for(var L=0,K=N;L<K.length;L++){var P=K[L];for(var R=0,Q=P.getFromSeqFlows();R<Q.length;R++){var S=Q[R];var O=S.getConditionalExpression?S.getConditionalExpression():"";if(!O){continue}M.push({parent:P,expression:O})}}return M}function q(N){var K=[];for(var L=0,O=N;L<O.length;L++){var M=O[L];if(M.getExpression&&M.getExpression()){K.push({parent:M.getParent(),expression:M.getExpression()})}}return K}function D(L){var M=[];for(var N=0,K=L;N<K.length;N++){var O=K[N];if(O.getExpression&&O.getExpression()){M.push({parent:O.parent,expression:O.getExpression()})}}return M}function z(){if(!l.getCurrentProcess()){return null}return l.getCurrentProcess().getPhysicalId()}function B(){return __awaiter(this,void 0,void 0,function(){var K,O,N,M,L;return __generator(this,function(P){switch(P.label){case 0:return[4,t()];case 1:K=P.sent();O=v(K);return[4,w(K)];case 2:N=P.sent();M=y(K);return[4,x(K)];case 3:L=P.sent();O.push.apply(O,C(K));O.push.apply(O,o(N));M.push.apply(M,q(N));M.push.apply(M,D(L));return[2,{processId:z(),objects:K,ids:O,parameters:N,expressions:M,properties:L}]}})})}function H(){return __awaiter(this,void 0,void 0,function(){var O,N,L,M,K;return __generator(this,function(P){switch(P.label){case 0:O=new h(m.getConnectionParameters());N=F.Diagnostics.createDefaultRunner(O);L=undefined;if(localStorage.getItem("SUPPORTABILITY_DEBUG_MODE")){L=F.Monitors.createMonitors()}M=F.Logs.createDefaultLogs(new J(),O,L);return[4,B()];case 1:K=P.sent();console.log(K);N.addDiagnostic(new r.LicenseDiagnostic(O,["Process_Composer"]));N.addDiagnostic(new r.ObjectAccessDiagnostic(O,K.ids,"read"));N.addDiagnostic(new r.ObjectAccessDiagnostic(O,K.ids,"modify"));N.addDiagnostic(new r.ParameterDiagnostic(K.parameters));N.addDiagnostic(new r.ExpressionDiagnostic(K.expressions,K.parameters));N.addDiagnostic(new r.ActivityDiagnostic(K.objects));N.addDiagnostic(new r.DataflowDiagnostic(K.objects,K.parameters));N.addDiagnostic(new r.AdapterDiagnostic(K.objects));M.addFile("ObjectAccess.txt",new I.ObjectAccessLog(O,K.ids),M.scenario().Traces.Client);M.addFile("SimulationData.json",new I.SimulationData(K.objects),M.scenario().Description);M.addFile("Process-"+K.processId+".json",new I.ProcessDetails(O,K.processId),M.scenario().Description);F.Logs.addScreenshot(M,L);return[2,new j(N,M,L)]}})})}var A=f;var s=e.getTimer("PCWSupportability",{appID:"SIMPRCW_AP"});s.start();H().then(function(M){var L=M;var N=A.getFrameWindow();var K=N?N.getUIFrame():null;if(K){L.addEventListener("onClose",function(){if(this.parentNode&&this.parentNode.removeChild){this.parentNode.removeChild(this)}},false);K.appendChild(L);A.end();s.stop()}})})}});return d});define("DS/SMAProcWebCmds/SMAProcAdapterValidators",["require","exports","DS/SMAProcWebSupportabilityUtils/diagnostics/strategies/ExpressionDiagnostic","DS/SMAProcWebSupportabilityUtils/diagnostics/DiagnosticUtils"],function(a,b,e,f){function h(j){if(!g(j.name)){return f.error(j.parent.getName()+" has an invalid rule: Rule #"+j.id+" needs a title.")}if(!g(j.sourceFileName)){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+" is missing the the source file name.")}if(!i(["input","output","both","none"],j.impactRel_C)){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+"'s Input/Output has an invalid value.")}if(!i(["referenced","owned"],j.contentRel_C)){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+"'s Owned/Reference has an invalid value.")}if(g(j.referenceId)&&j.titleSpecification==="titleEqualsFileName"){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+" has a reference ID but has the wrong title specification.")}if(j.enabled==="false"){return f.unknown(j.parent.getName()+" has a disabled rule ("+j.name+").")}return null}function c(j){if(!g(j.name)){return f.error(j.parent.getName()+" has an invalid rule: Rule "+j.id+" needs a title.")}if(!g(j.sourceDocTitle)){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+" is missing the content title.")}if(j.enabled==="false"){return f.unknown(j.parent.getName()+" has a disabled rule ("+j.name+").")}return null}function d(j){if(!g(j.name)){return f.error(j.parent.getName()+" has an invalid rule: Rule "+j.id+" needs a title.")}if(!g(j.sourceDocTitle)){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+" is missing the content title.")}if(!i(["referenced","owned","all"],j.contentRel)){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+"'s Owned/Reference has an invalid value.")}if(!i(["all","input","output","both","none"],j.impactRel)){return f.error(j.parent.getName()+" has an invalid rule: "+j.name+"'s Input/Output has an invalid value.")}if(j.enabled==="false"){return f.unknown(j.parent.getName()+" has a disabled rule ("+j.name+").")}return null}function i(j,k){return j.indexOf(k)!==-1}function g(j){return !(j===null||j===undefined||typeof j==="undefined"||j==="")}return{CalculatorValidator:function(j){return function(k){var l=new e([{parent:k,expression:k.getExtensionConfig().getPropertyByName("expression").getValue()}],j);return l.getStatus()}},DownloadValidator:function(){return function(v){var t=[];var s=v.getExtensionConfig().getPropertyByName("rules").getValue();var k=new DOMParser();var n=k.parseFromString(s,"text/xml");var x=n.getElementsByTagName("Rule");for(var r=0;r<x.length;r++){var w={};for(var p=0;p<x[r].attributes.length;p++){w[x[r].attributes[p].name]=x[r].attributes[p].value}w.parent=v;t.push(w)}var m=[];for(var o=0,q=t;o<q.length;o++){var u=q[o];var l=d(u);if(l){m.push(l)}}return Promise.resolve(m)}},UploadValidator:function(){return function(v){var t=[];var s=v.getExtensionConfig().getPropertyByName("rules").getValue();var k=new DOMParser();var n=k.parseFromString(s,"text/xml");var x=n.getElementsByTagName("Rule");for(var r=0;r<x.length;r++){var w={};for(var q=0;q<x[r].attributes.length;q++){w[x[r].attributes[q].name]=x[r].attributes[q].value}w.parent=v;t.push(w)}var m=[];for(var p=0,o=t;p<o.length;p++){var u=o[p];var l=h(u);if(l){m.push(l)}}return Promise.resolve(m)}},DeleteValidator:function(){return function(v){var t=[];var s=v.getExtensionConfig().getPropertyByName("rules").getValue();var k=new DOMParser();var n=k.parseFromString(s,"text/xml");var x=n.getElementsByTagName("Rule");for(var r=0;r<x.length;r++){var w={};for(var q=0;q<x[r].attributes.length;q++){w[x[r].attributes[q].name]=x[r].attributes[q].value}w.parent=v;t.push(w)}var m=[];for(var p=0,o=t;p<o.length;p++){var u=o[p];var l=c(u);if(l){m.push(l)}}return Promise.resolve(m)}}}});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflCreateProcessCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/ContextualBar","DS/SMAProcWebApp/SMAProcWidgetInit"],function(b,a,d){var c=b.extend({execute:function(){a.hide();d.createSimulation()}});return c});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/myDefaultCmd",["DS/ApplicationFrame/Command"],function(a){var b=a.extend({execute:console.warn.bind(console,"Default empty command - no implementation provided")});return b});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflFlowItemCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/Selection/CSOManager","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/ContextualBar","DS/SMAProcWebDiagram/graph","DS/JSCMM/SMAJSCMMExtensionManager","DS/Core/PointerEvents"],function(g,c,l,f,m,j,d,k,h){var b=15;function e(n){i.style.left=n.pageX-b+"px";i.style.top=n.pageY-b+"px";i.style.display="block";d.highlight(n.pageX,n.pageY)}var i=i=new g.Element("img",{id:"ghostImage",src:"",styles:{pointerEvents:"none",position:"absolute"}});var a=c.extend({init:function(n){this._parent(n,{mode:"exclusive",isAsynchronous:true});if(c.__commands===undefined){c.__commands=[]}c.__commands[this._id]={state:"INIT"}},execute:function(){i.inject(this.getFrameWindow().getUIFrame());console.log("Executing: @"+this._id);var s=c.__commands[this._id].state;if(s==="INIT"){c.__commands[this._id].state="PICKED";c.__activeCommand=this._id;console.log("State: "+c.__commands[this._id].state);var p;for(var q=0;q<this._arguments.length;q++){if(this._arguments[q].ID==="Image"){var n=this._arguments[q].Value;p=require.toUrl("DS"+n);break}else{if(this._arguments[q].ID==="type"){var o=this._arguments[q].Value;p=k.getIconForExtension(o);break}}}if(p){i.src=p;this.getFrameWindow().getUIFrame().addEventListener(h.POINTERMOVE,e,true)}if(d.processDiagram){var r=o||(this._id==="SMAProcWebActionBarEmptyActivityCmdHdr"?"activity":"gateway");d.processDiagram.startCommand(r);this.endNormally=false;d.processDiagram.addEvent("onEndCommand",function(){this.endNormally=true;this.end()},this)}}},endExecute:function(){console.log("Stop: @"+this._id);c.__commands[this._id].state="INIT";c.__activeCommand="";if(d.processDiagram){d.processDiagram.removeEvent("onEndCommand",null,this);if(!this.endNormally){d.processDiagram.cancelCommand()}}this.getFrameWindow().getUIFrame().removeEventListener(h.POINTERMOVE,e,true);if(i){i.src="";i.style.display="none";d.unhighlight()}}});return a});
/*!  Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcListCustomAdapterCmd",["DS/ApplicationFrame/Command","DS/Usage/TrackerAPI","DS/Logger/Logger","module"],function(b,f,a,d){var c=a.getLogger(d);var e=b.extend({defaultOptions:{isAsynchronous:true},execute:function(){var g=this;var h=f.getTimer("PCWCustomAdapterList",{appID:"SIMPRCW_AP"});h.start();require(["DS/SMAProcWebAuthoringUI/CustomAdapterEditor"],function(k){var j=new k();var l=g.getFrameWindow();var i=l?l.getUIFrame():null;if(i){j.addEventListener("onClose",function(){if(this.parentNode&&this.parentNode.removeChild){this.parentNode.removeChild(this)}},false);i.appendChild(j);g.end();h.stop()}},function(i){c.error("Error while loading RenameEditor:"+i,i);g.end();h.stop()})}});return e});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcViewCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebDiagram/graph"],function(a,b){var c=a.extend({execute:function(){if(!b){return}switch(this._id){case"SMAProcWebActionBarZoomInHdr":b.zoom(1);break;case"SMAProcWebActionBarZoomOutHdr":b.zoom(-1);break;case"SMAProcWebActionBarFitAllCmdHdr":b.fitAllIn();break;case"SMAWflResetAllPositionCmdHdr":var f=b.getCurrentProcess();if(f){f.resetPosition();var d=f.getAllActivities();for(var e=0;e<d.length;e++){d[e].resetPosition()}}b.updateGraph(f,true);break;default:}}});return c});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcExtensionEditorCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/Selection/CSOManager","DS/ApplicationFrame/CommandsManager","DS/ApplicationFrame/ContextualBar","DS/JSCMM/SMAJSCMMActivity","DS/JSCMM/SMAJSCMMStep","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMParameterUtils","DS/SMAProcWebCMMUtils/SMAJSCMMDataFlowUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebCMMException/SMAProcWebCMMError","DS/SMAProcWebExceptionManager/SMAProcWebErrorManager","DS/SMAProcWebCMMUtils/SMAProcWebAuthoringNLSUtils","DS/Logger/Logger","module","DS/WebappsUtils/Performance","DS/Usage/TrackerAPI","DS/SMAProcWebAuthoringUI/AdapterEditor","DS/SMAProcWebAuthoringUI/SMAProcWebProcessComposer","i18n!DS/SMAProcWebCmds/assets/nls/SMAProcExtensionEditorCmd"],function(UWA,AFRCommand,CSOManager,cm,ContextualBar,SMAJSCMMActivity,SMAJSCMMStep,SMAJSCMMAuthoringUtils,SMAJSCMMParameterUtils,SMAJSCMMDataFlowUtils,SMAProcWebAuthoringServices,SMAProcWebCMMError,SMAProcWebErrorManager,SMAProcWebAuthoringNLSUtils,Logger,module,perf,TrackerAPI,AdapterEditor,SMAProcWebProcessComposer,i18nSMAProcExtensionEditorCmd){var logger=Logger.getLogger(module);var STEPCONSTANTS={UPLOADSTEP:"com.dassault_systemes.sma.adapter.Upload",DOWNLOADSTEP:"com.dassault_systemes.sma.adapter.Download",DELETESTEP:"com.dassault_systemes.sma.adapter.DeleteContent"};var applyExtensionEditor=function(editorImpl){if(editorImpl&&editorImpl.Apply){try{editorImpl.Apply()}catch(e){logger.error("Error on Apply for",editorImpl,e)}}};var saveStepData=function(activity,step,callback){var extensionConfig=step.getExtensionConfig();extensionConfig.propertiesToJSON();SMAJSCMMAuthoringUtils.saveStep(step,{onSuccess:function(){SMAJSCMMParameterUtils.saveAllParameters([activity],{onSuccess:function(){var dataContainers=[activity];if(activity.getParent()){dataContainers.push(activity.getParent())}SMAJSCMMDataFlowUtils.saveAllDataFlows(dataContainers,{onSuccess:function(_data){logger.log("Dataflows are saved for current activity")},onFailure:function(_data){logger.log("Dataflows could not be saved for current activity")}});SMAProcWebAuthoringServices.displayClosableMessages("success",["ParameterSave.success"],true);logger.log("save parameters successful");if(typeof callback!=="undefined"&&callback.onSuccess){callback.onSuccess()}},onFailure:function(){SMAProcWebAuthoringServices.displayClosableMessages("error",["ParameterSave.error"],true);logger.log("save parameters failed");if(typeof callback!=="undefined"&&callback.onFailure){callback.onFailure()}}});SMAProcWebAuthoringServices.displayClosableMessages("success",["StepSave.success"],true);logger.log("save step successful")},onFailure:function(data){var errorMessage=SMAProcWebAuthoringNLSUtils.translate(["StepSave.error"]);if(data.length>0&&data.indexOf("access")>-1){errorMessage=errorMessage+SMAProcWebAuthoringNLSUtils.translate(["Modify_AccessMessage"])}SMAProcWebErrorManager.notifyError(new SMAProcWebCMMError("Error",errorMessage),{autoRemove:false});if(typeof callback!=="undefined"&&callback.onFailure){callback.onFailure()}}})};var getAllSimulationData=function(activity,callback){SMAJSCMMAuthoringUtils.getAllSimulationData(activity,{onSuccess:function(){if(typeof callback!=="undefined"&&callback.onSuccess){callback.onSuccess()}},onFailure:function(){if(typeof callback!=="undefined"&&callback.onFailure){callback.onFailure()}}})};var contentCount=0;var getContent=function(activity,contentContainer,callback){contentCount++;SMAJSCMMAuthoringUtils.getContent(activity,contentContainer,{onSuccess:function(data){logger.log("Inside getContent success");var childContent=data.getContentChildren();if(childContent!==undefined){for(var i=0;i<childContent.length;i++){var content=childContent[i];if(content.isContentContainer&&content.isContentContainer()){getContent(activity,content,callback)}}contentCount--;if(contentCount===0){if(typeof callback!=="undefined"&&callback.onSuccess){callback.onSuccess()}}}},onFailure:function(){if(typeof callback!=="undefined"&&callback.onFailure){callback.onFailure()}}})};var closeEditor=function(cmd,panel,step,activity){if(panel.parentNode){panel.parentNode.removeChild(panel)}if(activity){activity.removeParameterObservers();SMAJSCMMParameterUtils.clearTemporaryParameters(activity);activity.setPotentialParameters(null);activity.setPotentialParametersUpdateFlag(false)}cmd.end();setTimeout(function(){SMAProcWebProcessComposer.validate(step,activity)},100)};var buildErrorEditor=function(adapterEditor,errorMessage){var errorHtml=UWA.createElement("div",{styles:{textAlign:"center"},html:[{html:{tag:"p",text:(errorMessage||i18nSMAProcExtensionEditorCmd.StepCanOnlyBeEditedInPCN)}},{html:{tag:"button","class":"btn btn-default",text:i18nSMAProcExtensionEditorCmd.OpenProcessInPCN,events:{click:function(){cm.getCommand("SMAProcWebActionBarOpenInPCNCmdHdr").begin()}}}}]});adapterEditor.setAdapterContent(errorHtml)};var isStepJSP=function(stepName){return(stepName===STEPCONSTANTS.UPLOADSTEP||stepName===STEPCONSTANTS.DOWNLOADSTEP||stepName===STEPCONSTANTS.DELETESTEP)};var Command=AFRCommand.extend({defaultOptions:{isAsynchronous:true},execute:function(){if(ContextualBar){ContextualBar.hide()}var cmd=this;var csos=CSOManager.get()||[];var cso=csos[0];var activity=null;var step=null;if(cso){if(cso instanceof SMAJSCMMStep){activity=cso.getParent();step=cso}else{if(cso instanceof SMAJSCMMActivity){activity=cso;step=cso.getMainStep()}else{this.cancel();return}}if(isStepJSP(step.getExtensionName())){this.showStepJSP(activity,step);this.end()}else{SMAJSCMMAuthoringUtils.updateStep(step,{onSuccess:function(updatedStep){SMAJSCMMAuthoringUtils.getExtensionDescriptor(updatedStep.getExtensionName(),{onSuccess:function(descriptor){cmd.showExtensionEditor(activity,updatedStep,descriptor)},onFailure:function(){SMAProcWebAuthoringServices.displayNotification("Failed to get step data: "+updatedStep.getExtensionName(),{messageType:"error"});cmd.end()}})},onFailure:function(){SMAProcWebAuthoringServices.displayNotification("Failed to update the step: "+step.getExtensionName(),{messageType:"error"});cmd.end()}})}}},showStepJSP:function(activity,step){var extensionName=step.getExtensionName(),objectAction;switch(extensionName){case STEPCONSTANTS.DOWNLOADSTEP:objectAction="showDownloadRules";break;case STEPCONSTANTS.UPLOADSTEP:objectAction="showUploadRules";break;case STEPCONSTANTS.DELETESTEP:objectAction="showDeleteRules";break;default:objectAction=null;break}var url=SMAJSCMMAuthoringUtils.getAuthenticatedJspUri("/simulationcentral/smaDiagramming.jsp?"+SMAJSCMMAuthoringUtils.toQueryString({objectAction:objectAction,objectId:activity.getPhysicalId(),stepId:step.getId(),adapterName:extensionName}));SMAProcWebAuthoringServices.displayInWebUXDialog(url,activity,step.getName())},showExtensionEditor:function(activity,step,ExtensionDesc){var cmd=this;var uiFrame=this.getFrameWindow().getUIFrame();var myPanel=document.createElement("div");var wc=null;var moduleSrc=ExtensionDesc.getModuleSrc();var amdPath=ExtensionDesc.getAmdPath();var webpageUrl=ExtensionDesc.getWebpageUrl();var webEditorUrl=moduleSrc||amdPath||webpageUrl;var webCompName=ExtensionDesc.getWebComponent();var displayName=step.getName();var extensionConfig=step.getExtensionConfig();if(webCompName==="cmp-script"){moduleSrc=require.toUrl("DS/SMAProcWebScript/cmp-script.js")}if(webCompName==="cmp-csedirector"){amdPath="DS/SMAProcWebCSEDirector/CmpCsedirector"}perf.mark("start"+webCompName);var timerId=webCompName+"Tracker";var timer=TrackerAPI.getTimer(timerId,{appID:"SIMPRCW_AP"});timer.start();var adapterEditor=new AdapterEditor();adapterEditor.editorTitle=displayName;myPanel.appendChild(adapterEditor);if(uiFrame){uiFrame.appendChild(myPanel)}adapterEditor.addEventListener("onOK",function(e){e.stopPropagation();applyExtensionEditor(wc&&wc.ExtensionEditorImpl);function saveStep(){saveStepData(activity,step,{onSuccess:function(){closeEditor(cmd,myPanel,step,activity)},onFailure:function(){closeEditor(cmd,myPanel,step,activity)}})}if(activity&&step){SMAJSCMMAuthoringUtils.saveTempSimulationData_Promise(activity).then(saveStep,function(ex){console.error(ex);saveStep()})}},false);adapterEditor.addEventListener("onApply",function(e){e.stopPropagation();applyExtensionEditor(wc&&wc.ExtensionEditorImpl);saveStepData(activity,step)},false);adapterEditor.addEventListener("onCancel",function(e){e.stopPropagation();step.resetExtensionConfig();closeEditor(cmd,myPanel,step,activity)},false);if(!step.hasWebEditor()||!webEditorUrl||!webCompName){logger.warn("Missing web editor name <"+webCompName+"> or URL: "+webEditorUrl);buildErrorEditor(adapterEditor);return}var importEditor=new Promise(function(resolve,reject){try{if(moduleSrc){eval("import(moduleSrc).then(resolve, reject)")}else{if(amdPath){require([amdPath],resolve,reject)}else{if(webpageUrl){Polymer.Base.importHref([webpageUrl],resolve,reject)}else{reject(new Error("No editor URL defined"))}}}}catch(e){reject(e)}});var allSimulationData=new Promise(function(resolve,reject){getAllSimulationData(activity,{onSuccess:resolve,onFailure:reject})});var activityContent=new Promise(function(resolve,reject){getContent(activity,activity,{onSuccess:resolve,onFailure:reject})});var activityParametersInPLM=new Promise(function(resolve,reject){SMAJSCMMAuthoringUtils.getParametersInPLM(activity,{onSuccess:resolve,onFailure:reject})});var activityParametersInPLMForAllNeighbours=new Promise(function(resolve,reject){SMAJSCMMAuthoringUtils.getParametersInPLMForAllNeighbours(activity,{onSuccess:resolve,onFailure:reject})});var activityDataflow=new Promise(function(resolve,reject){SMAJSCMMAuthoringUtils.getDataFlowsInPLM(activity,{onSuccess:resolve,onFailure:reject})});var activityParentDataflow=new Promise(function(resolve,reject){SMAJSCMMAuthoringUtils.getDataFlowsInPLM(activity.getParent(),{onSuccess:resolve,onFailure:reject})});importEditor.then(function(){return Promise.all([allSimulationData,activityContent,activityParametersInPLM,activityParametersInPLMForAllNeighbours,activityDataflow,activityParentDataflow])}).then(function(){perf.measure("measure"+webCompName,"start"+webCompName);var perfMeasures=perf.getEntriesByName("measure"+webCompName)||[];var perfMeasuresText=perfMeasures.map(function(measure){return"  "+measure.duration+"ms (start: "+measure.startTime+")"}).join("\n");logger.log("web editor "+webCompName+" loaded in:\n"+perfMeasuresText);if(!(activity.getPotentialParametersUpdateFlag())){var potentialParam_NEW=SMAJSCMMParameterUtils.getPotentialParameters(activity);activity.setPotentialParameters(potentialParam_NEW);activity.setPotentialParametersUpdateFlag(true)}wc=document.createElement(webCompName);var DELAY_INIT=20;var DELAY_RETRY=100;var checkForReadiness=function(retry){if(wc.ExtensionEditorImpl){var ret="UpdateUI method is not implemented on: "+webCompName;if(wc.ExtensionEditorImpl.UpdateUI){try{ret=wc.ExtensionEditorImpl.UpdateUI(activity,step,extensionConfig)}catch(e){logger.error("Error on UpdateUI for",wc,e);ret="Error when calling UpdateUI on: "+webCompName+"\nMessage: "+e.message}}if(adapterEditor){if(typeof ret==="string"){logger.warn("Error return by <"+webCompName+">: "+ret);buildErrorEditor(adapterEditor,ret);wc.ExtensionEditorImpl=null}}setTimeout(function(){var adaptereditorloadedEvent=new CustomEvent("adaptereditorloaded",{detail:{editorDialog:adapterEditor,editorContent:wc}});perf.measure("measure"+step.getName(),"start"+webCompName);var perfMeasures=perf.getEntriesByName("measure"+step.getName())||[];var perfMeasuresText=perfMeasures.map(function(measure){return"  "+measure.duration+"ms (start: "+measure.startTime+")"}).join("\n");logger.log("Adapter Editor for step "+step.getName()+" loaded in:\n"+perfMeasuresText);document.dispatchEvent(adaptereditorloadedEvent)},DELAY_INIT)}else{if(retry>0){setTimeout(checkForReadiness.bind(this,retry-1),DELAY_RETRY)}else{logger.warn("Loaded <"+webCompName+"> from URL: "+webEditorUrl+" successfully but ExtensionEditorImpl is "+typeof wc.ExtensionEditorImpl);buildErrorEditor(adapterEditor)}}};adapterEditor.setAdapterContent(wc);var RETRY=60;checkForReadiness(RETRY)},function(error){logger.error("Error loading activity info:",error);if(adapterEditor){logger.warn("Error loading activity info:",error);buildErrorEditor(adapterEditor)}cmd.end()})}});return Command});
/*!  Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAInstantiateAdapterCmd",["DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebApp/SMAProcWidgetInit","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebCommonControls/import!DS/SMAProcSP/sp-search/sp-search.html","module"],function(d,f,c,a,e){var b={execute:function(j,i,l,k){var h=j;var g=document.createElement("sp-search");g.addEventListener("change",function(o){var n=o&&o.detail&&o.detail.getSelectedObjects()||[];var m=n[0];var p=d.getAuthenticatedJspUri("/simulationcentral/smaDiagramming.jsp?"+d.toQueryString({objectAction:"showInstantiationPage",objectId:m.objectId,parentOID:h.getoid(),connected:i,fromAct:l,toAct:k}));c.displayInWebUXDialog(p,j,"Instantiation Page - "+j.getName())});g.search('flattenedtaxonomies:"types/Simulation Template" AND template_95_type:"Simulation Activity"');window.top.addEventListener("message",function(n){var m=JSON.parse(n.data);if(m.operation==="Instantiate"){f.onRefresh()}})}};return b});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcDisconnectCmd",["DS/ApplicationFrame/Command","DS/Selection/CSOManager","DS/ApplicationFrame/ContextualMenu","DS/SMAProcWebDiagram/graph","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebAsyncUtils/SMAProcWebTransactionManager","DS/SMAProcWebAsyncUtils/Activity/Disconnect","i18n!DS/SMAProcWebCMMUtils/assets/nls/SMAProcWebAuthoringNLS"],function(d,f,g,e,c,h,a,b){var i=d.extend({execute:function(){console.log("Executing: @"+this._id);var n=f.get()||[];var m=n[0];if(m===null||m===undefined){c.alert(b["Please select an activity or step"])}else{if(m&&m.isActivity&&m.isActivity()){var j=m;var k=j.getParent();var l=j.getProcess();c.confirm({title:b["ActivityDisconnect.title"],message:b["ActivityDisconnect.message"],onOkay:function(){c.showLoader();h.add(new a(j),{updateUI:function(){j.setPosition({connected:false});e.updateGraph((k&&!(k.isProcess()))?k:l,true,true)},success:function(){c.displayNotification(b["ActivityDisconnect.success.notification"],{type:"success"});e.updateGraphAll(true)},failed:function(){c.displayNotification(b["ActivityDisconnect.error.notification"],{type:"error"})},rollbackComplete:function(){e.updateGraph((k&&!(k.isProcess()))?k:l,true)},after:function(){c.hideLoader()}})}})}}g.hide();e.unhighlight()}});return i});
/*! Copyright 2016 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflAutPLMContentsCmd",["UWA/Core","DS/Logger/Logger","module","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMWebServicesUtils","DS/WebappsUtils/WebappsUtils","DS/JSCMM/SMAJSCMMActivity","DS/JSCMM/SMAJSCMMStep","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/ContextualBar","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices"],function(g,d,c,b,k,n,e,f,i,m,h,p,j,a){var l=d.getLogger(c);var o=b.extend({execute:function(){var t=h.getSelectedObject();if(!t){return}var s=t;if(t instanceof m&&t.getParent){s=t.getParent()}if(localStorage.getItem("SIMPRCW_AP_ENABLE_CONTENT_EDITOR")==="true"){var r=new Promise(function(v,u){n.getContent(s,s,{onSuccess:v,onFailure:u})});r.then(function(){console.log("SMAWflAutPLMContentsCmd: contents are successfully loaded from PLM for: "+s.getoid());require(["DS/SMAProcWebAuthoringUI/ContentEditor"],function(y){var x=new y();if(x){var A=s.getDataContainer();x.setDataContainer(A,s);var z=p.getFrameWindow(),u=z?z.getUIFrame():null;if(u){j.hide();var w=x.is+"-closed";var v=function(){x.removeEventListener(w,v);if(x.parentNode&&x.parentNode.removeChild){x.parentNode.removeChild(x)}};x.addEventListener(w,v);u.appendChild(x);x.show()}}})})}else{var q=n.getAuthenticatedJspUri("/simulationcentral/smaDiagramming.jsp?"+n.toQueryString({objectAction:"showContent",objectId:s.getoid()}));if(t.isActivity()){q=q+"&isActivity=true"}a.displayInWebUXDialog(q,t,"Content - "+t.getName())}}});return o});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcRenameCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/Logger/Logger","module"],function(c,b,a,e){var d=a.getLogger(e);var f=c.extend({defaultOptions:{isAsynchronous:true},execute:function(){var i=b.getSelectedObject({types:["process","activity","step"]});if(!i){return}var g=i;var h=this;require(["DS/SMAProcWebAuthoringUI/RenameEditor"],function(m){var k=new m();k.flowitem=g;var l=h.getFrameWindow();var j=l&&l.getUIFrame();if(j){j.appendChild(k)}h.end()},function(j){d.error("Error while loading RenameEditor:"+j,j);h.end()})}});return f});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcAutExperienceCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAProcWebCMM3DXContentUtils"],function(b,a,d,c,f){var e=b.extend({execute:function(){var i=a.getSelectedObject();if(!i){return}var g=i&&i.getPhysicalId&&i.getPhysicalId()||null;var h=f.get3DXContent({objectId:g,objectType:i._data.busType,displayName:i.getName()});var j={X3DContentId:JSON.stringify(h),collabspaces:c.getCurrentContext()};d.displayInTransientWidget("SIMEXPS_AP","Process Studio",j)}});return e});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcAutGatewayEditorCmd",["DS/ApplicationFrame/Command","DS/Selection/CSOManager","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/Logger/Logger","module"],function(d,f,c,b,g){var e=b.getLogger(g);var a=d.extend({defaultOptions:{isAsynchronous:true},execute:function(){var h=this;var j=c.getSelectedObject({types:["gateway"]});if(!j){return}var i=j;require(["DS/SMAProcWebAuthoringUI/GatewayEditor"],function(l){var n=new l();n._gateway=i;var p=h.getFrameWindow();var k=p&&p.getUIFrame();try{var m=require("DS/ApplicationFrame/ContextualBar");if(m){m.hide()}}catch(o){}if(k){k.appendChild(n)}h.end()},function(k){e.error("Error while loading GatewayEditor:"+k,k);h.end()})}});return a});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcAutLifecycleCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebCMMUtils/SMAProcWebCMM3DXContentUtils"],function(b,a,c,e){var d=b.extend({execute:function(){var i=a.getSelectedObject();if(!i){return}var f=i&&i.getPhysicalId&&i.getPhysicalId()||null;var h=e.get3DXContent({objectId:f,objectType:i._data.busType,displayName:i.getName()});var g={X3DContentId:JSON.stringify(h)};c.displayInTransientWidget("ENOLCMI_AP","Lifecycle",g)}});return d});
/*! Copyright 2016 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcExecutionOptionsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/ContextualBar"],function(g,e,b,d,c,a){var f=e.extend({execute:function(){console.log("Executing: @"+this._id);if(this._id==="SMAProcWebExecutionOptionCmdHdr"||this._id==="SMAProcWebStepExecutionOptionCmdHdr"||this._id==="SMAProcWebActivityOptionsCmdHdr"){var h=d.getSelectedObject({types:["process","activity","step"]});if(!h){return}b.disableAll();if(h.isActivity()||h.isProcess()){require(["DS/SMAProcWebAuthoringUtils/cmp-execution-option/cmp-execution-option"],function(){var l=document.createElement("cmp-execution-option");if(l){h.isActivity()?l._activity=h:l._process=h;var k=new g.Element("div");var j=c.getFrameWindow(),i=null;if(j){i=j.getUIFrame()}if(k&&i){a.hide();k.appendChild(l);k.inject(i)}}})}else{if(h.isStep()){require(["DS/SMAProcWebAuthoringUtils/cmp-execution-option/cmp-execution-option"],function(){var l=document.createElement("cmp-execution-option");if(l){if(!h.isRunSubFlowStep()){l._step=h}var k=new g.Element("div");var j=c.getFrameWindow(),i=null;if(j){i=j.getUIFrame()}if(k&&i){a.hide();k.appendChild(l);k.inject(i)}}})}}}}});return f});
/*! Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflAutImpactGraphCmd",["UWA/Core","module","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/ContextualBar"],function(e,c,b,h,f,i,a,j,g){var d=b.extend({execute:function(){var m=f.getSelectedObject();if(!m){return}var k=m;var l=i.getAuthenticatedJspUri("/simulationcentral/smaDiagramming.jsp?"+i.toQueryString({objectAction:"showImpactGraph",objectId:k.getoid()}));a.displayInWebUXDialog(l,m,"Impact Graph - "+m.getName())}});return d});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcRunCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/Logger/Logger","module","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/JSCMM/SMAJSCMMProcess","DS/JSCMM/SMAJSCMMActivity"],function(c,i,b,e,d,g,f,h){var a=c.extend({execute:function(){var n=null;var m=null;var l=null;var k=g.getSelectedObject();if(!k){return}if(k instanceof f){n=k.getoid()}else{if(k instanceof h){m=k.getoid();l=k.getName();n=i.getCurrentProcess().getoid()}}var j={mode:"viewondrop",collabspaces:i.getCurrentContext(),processData:{id:n,activityId:m||"",activityTitle:l||"",objectType:"Simulation",operation:"run",envId:window.widget&&window.widget.getValue&&window.widget.getValue("x3dPlatformId")}};b.displayInTransientWidget("SIMDISB_AP","Performance Study",j)}});return a});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflAutDataFlowCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/ContextualBar","DS/JSCMM/SMAJSCMMStep","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils"],function(e,b,c,a,g,d,f){var h=e.extend({init:function(i){this.dataFlowTable=null;this._parent(i,{mode:"exclusive",isAsynchronous:true})},execute:function(){var j,m;j=d.getSelectedObject({types:["process","activity","step"]});if(j instanceof g){j=j.getParent()}if(!j){j=f.currentProcess}if(j){m=j.getDataContainer();if(m){var l=this.dataFlowTable&&this.dataFlowTable.getDataContainer();if(m===l){return}if(this.dataFlowTable){this.dataFlowTable.saveAndLoad(j)}else{this._loadDataFlowTable(j)}}}if(j){var i=b.getCommands();for(var n in i){var k=i[n];if(k.getId()!==this.getId()){k.disable()}}}},_loadDataFlowTable:function(i){require(["DS/SMAProcWebAuthoringUI/DataflowEditor"],function(){var k,j;this.dataFlowTable=document.createElement("cmp-dataflow-editor-modal");this.dataFlowTable.toggleActivitySelection(i,"GRAPH",true);k=c.getFrameWindow();j=k&&k.getUIFrame();if(j){a.hide();this.dataFlowTable.addEventListener("onClose",function(){this._onCloseDataFlowTable()}.bind(this),false);j.appendChild(this.dataFlowTable)}}.bind(this))},cancelExecute:function(){this.dataFlowTable&&this.dataFlowTable.onClose()},_onCloseDataFlowTable:function(){b.enableAll();this.end();if(this.parentNode&&this.parentNode.removeChild){this.parentNode.removeChild(this)}this.dataFlowTable=null}});return h});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcAutPropertiesCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/Logger/Logger","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","module"],function(c,e,b,a,f){var d=b.getLogger(f);var g=c.extend({execute:function(){var j=a.getSelectedObject();if(!j){return}var h=j&&j.getPhysicalId()&&j.getPhysicalId()||null;var i={getSecurityContext:function(){return{SecurityContext:e.getCurrentContext()}},getSelectedNodes:function(){return[{getID:function(){return h}}]}};require(["DS/LifecycleControls/EditPropDialog"],function(l){var k=new l();k.launchProperties(i)},function(k){d.warn("Failed to load LifecycleControls widget: "+k,k)})}});return g});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflAutParametersCmd",["DS/ApplicationFrame/Command","DS/ApplicationFrame/FrameWindowsManager","DS/JSCMM/SMAJSCMMProcess","DS/JSCMM/SMAJSCMMActivity","DS/JSCMM/SMAJSCMMStep","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/Usage/TrackerAPI","DS/Logger/Logger","module"],function(b,k,f,h,j,g,e,d,c){var i=d.getLogger(c);var a=b.extend({init:function(l){this.parameterTable=null;this._parent(l,{mode:"exclusive",isAsynchronous:true})},execute:function(){var n=g.getSelectedObject({types:["process","activity","step"]});if(!n){return}var l=null;if(n instanceof j){l=n.getParent()}else{if(n instanceof f||n instanceof h){l=n}}var p=k.getFrameWindow(),m=p&&p.getContextualUIManager();if(m){m.hideContextualMenus()}if(this.parameterTable&&this.parameterTable.getDataContainer){var o=this.parameterTable.getDataContainer();if(l&&l.getDataContainer&&l.getDataContainer()===o){return}this.parameterTable.save().then(function(){this.loadParameterTable(l)}.bind(this))}else{this.loadParameterTable(l)}},loadParameterTable:function(l){var m=this;var o=e.getTimer("PCWParametersTable",{appID:"SIMPRCW_AP"});o.start();var n=l.getDataContainer();require(["DS/SMAProcWebAuthoringUI/ParameterEditor"],function(q){o.stop();if(!m.parameterTable){m.parameterTable=new q();var r=k.getFrameWindow(),p=r&&r.getUIFrame();if(p){m.parameterTable.addEventListener("onClose",function(){if(this.parentNode&&this.parentNode.removeChild){m.parameterTable=null;m.end();this.parentNode.removeChild(this)}},false);p.appendChild(m.parameterTable)}else{m.end()}}else{m.end()}if(m.parameterTable&&m.parameterTable.setDataContainer){m.parameterTable.setDataContainer(n)}},function(p){i.error("Failed to load parameter editor:",p);m.end()})},cancelExecute:function(){this.parameterTable&&this.parameterTable.onCancel()}});return a});
/*! Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAProcWebEditImageCmd",["UWA/Core","module","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/ContextualBar"],function(d,c,b,h,e,i,a,j,g){var f=b.extend({execute:function(){var m=e.getSelectedObject();if(!m){return}var k=m;g.hide();var l=i.getAuthenticatedJspUri("/simulationcentral/smaDiagramming.jsp?"+i.toQueryString({objectAction:"showImagePage",objectId:k.getoid()}));a.displayInWebUXDialog(l,m,"Edit Image - "+m.getName())}});return f});
/*! Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/SMAProcWebCmds/SMAWflAutAttributeGrpsCmd",["UWA/Core","module","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/ContextualBar"],function(d,c,b,h,e,i,a,j,g){var f=b.extend({execute:function(){var m=e.getSelectedObject();if(!m){return}var k=m;var l=i.getAuthenticatedJspUri("/simulationcentral/smaDiagramming.jsp?"+i.toQueryString({objectAction:"showAttributeGrpsPage",objectId:k.getoid()}));a.displayInWebUXDialog(l,m,"Attribute Groups - "+m.getName())}});return f});define("DS/SMAProcWebCmds/SMAProcAutRelExplorerCmd",["DS/ApplicationFrame/Command","DS/SMAProcWebCmds/SMAProcWebCmdsUtils","DS/SMAProcWebAuthoringUtils/SMAProcWebAuthoringServices","DS/SMAProcWebCMMUtils/SMAProcWebCMM3DXContentUtils"],function(b,a,c,e){var d=b.extend({execute:function(){var i=a.getSelectedObject();if(!i){return}var f=i&&i.getPhysicalId&&i.getPhysicalId()||null;var g=e.get3DXContent({objectId:f,objectType:i._data.busType,displayName:i.getName()});var h={X3DContentId:JSON.stringify(g)};c.displayInTransientWidget("ENORIPE_AP","Relational Explorer",h)}});return d});
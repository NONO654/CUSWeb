/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
(function(b){var a=null;Polymer({is:"sp-cos",properties:{},ready:function(){if(!a){this.refreshCosConfigurations()}},getCosConfiguration:function(c){var d=this;var e=function(){if(!a&&c&&c.onFailure){c.onFailure(new Error("cos configuration not available"))}if(a&&c&&c.onComplete){var f=JSON.parse(JSON.stringify(a));c.onComplete(f)}};if(!a||c.refresh){d.refreshCosConfigurations(function(){d.async(e)})}else{e()}},getDefaultServerId:function(){var c=null;(a||[]).some(function(d){if(d.isDefault){c=d.id;return true}});return c},getUrlForServer:function(f,e){var d=null,c=f||this.getDefaultServerId();if(c==="smaexe.eed.test"){c="3DOrchestrate.Server"}(a||[]).some(function(g){if(g.id===c){d=g.fullCosUrl;return true}});return d},getUrlForDefaultServer:function(c){return this.getUrlForServer(null,c)},requestCosVersionForServer:function(e,d){var c=this.getUrlForServer(e);require(["DS/SMAProcSP/sp-cos/CosAPIWrapper"],function(f){f.getCosVersion(c,d)})},requestCosVersionForDefaultServer:function(c){return this.requestCosVersionForServer(null,c)},getPrivateStationInfo:function(c){var d=c||{};require(["DS/SMAExeJsAPI/CosAPI"],function(e){e.init();e.getPrivateStationInfo({onComplete:function(f){if(d.onComplete){d.onComplete(f)}},onFailure:function(f){if(d.onFailure){d.onFailure(f)}}})})},getPrivateStationInfoMatched:function(f,e,c,d){var g=d||{};require(["DS/SMAExeJsAPI/CosAPI"],function(h){h.init();h.getPrivateStationInfoMatched(f,e,c,{onComplete:function(i){if(g.onComplete){g.onComplete(i)}},onFailure:function(i){if(g.onFailure){g.onFailure(i)}}})})},refreshCosConfigurations:function(c){var e=function(f){var g=JSON.parse(f.response);a=g.COSConfiguration||g.configurations||g;if(c){c()}},d=function(){a=null;if(c){c()}};this.$.cosConfigurationsWS.sendRequest({uri:this.$.dashboard.getMcsUri()+this.$.cosConfigurationsWS.uri,onComplete:e,onError:d})},utils:{isCosVersionSameOrNewer:function(e,h,c){var d=e||{SystemInfo:{}};var g=parseInt(d.SystemInfo["@minor"],10)||0;var f=parseInt(d.SystemInfo["@fix"],10)||0;if(g>h||(g===h&&f>=c)){return true}else{return false}}}})}(this));
define("DS/DELWebMfgAssetsDefUIGenericLinksView/GenericLinksViewDDManager",["UWA/Core","DS/Logger/Logger","UWA/Class","DS/DELWebMfgAssetsDefUIServices/AbstractDragAndDropManager","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/Resources"],function(g,c,b,d,a,f){var e=d.singleton({name:"GenericLinksViewDDManager",_logger:null,init:function(h){this._parent(h);if(c){this._logger=c.getLogger(e)}},onDragEndCell:function(i,h){return false},onDragEnterRowHeader:function(i,h){return false},onDragLeaveRowHeader:function(i,h){return false},onDragEnterColumnHeader:function(i,h){return false},onDragLeaveColumnHeader:function(i,h){return false},onDragEnterCell:function(i,h){return false},onDragLeaveCell:function(i,h){return false},onDragOverCell:function(i,h){return false},onDragEnterBlank:function(i,h){return false},onDragLeaveBlank:function(i,h){return false},onDropCell:function(i,h){a.AlertManager.add({className:"error",message:f.getNLSValue("NotAuthorized",null,"AbstractDragAndDropManager")});return false},onDropBlank:function(i,h){a.AlertManager.add({className:"error",message:f.getNLSValue("NotAuthorized",null,"AbstractDragAndDropManager")});return false}});return e});define("DS/DELWebMfgAssetsDefUIGenericLinksView/GenericLinksView",["UWA/Core","UWA/Class/Debug","DS/Core/Events","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/Selection","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIGenericLinksView/GenericLinksViewDDManager","DS/DELWebMfgAssetsDefUIServices/AttributeUtil","DS/DELWebMfgAssetsDefUIServices/TableViewPreferences","DS/DELWebMfgAssetsDefUIServices/CommandsManager","DS/DELWebMfgAssetsDefUIServices/AbstractView"],function(f,m,e,h,o,g,c,n,l,k,a,j){var i=j.extend(m,{_modelEvents:{onChange:function(p){this.treeListView.utils.updateAttributes(p);return this},"onChange:displayModel":function(q){var p=q.get("displayModel");if(q.isReference()){if(p.hasChanged(this._refCount)){if(p.get(this._refCount)===0){this.treeListView.utils.hide(q,true)}else{if(p.previous(this._refCount)===0){if(p.get(this._refNodes)===0){this.treeListView.utils.addToTreeList(q)}}}}if(p.hasChanged(this._refNodes)){if(p.get(this._refNodes)===0){if(p.get(this._refCount)>0){this.treeListView.utils.addToTreeList(q)}}else{if(p.get(this._refNodes)>1){if(p.previous(this._refNodes)===1){this.treeListView.utils.hide(q,true)}}}}}return this},onRemove:function(p){var s,q,r;if(p.isConnection()){q=p.get("type");if(this._connectionTypes.indexOf(q)!==-1){r=h.references.get(p.get("from"));if(!f.is(r)){s=h.references.get(p.get("to"));if(f.is(s)){s.get("displayModel").decrementCounter(this._refCount)}}else{if(r.get("displayModel").getInt(this._dependingCounterAttribute)>0){s=h.references.get(p.get("to"));if(f.is(s)){s.get("displayModel").decrementCounter(this._refCount)}}}}}else{this.treeListView.utils.hide(p)}return this},onAdd:function(q,u,p){var r,t,s;if(q.isConnection()){r=q.get("type");if(this._connectionTypes.indexOf(r)!==-1){t=h.references.get(q.get("from"));if(t.get("displayModel").getInt(this._dependingCounterAttribute)>0){s=h.references.get(q.get("to"));s.get("displayModel").incrementCounter(this._refCount)}}}else{if(q.isInstance()){this.treeListView.utils.addToTreeList(q,p)}}return this}},_modelDocEvents:{onAdd:function(p,q){a.changeDocCmdAvailability(p,q,this.treeListView)},onRemove:function(p,q){a.changeDocCmdAvailability(p,q,this.treeListView)}},setup:function(){var p=this,v=this.options.modelPreferences,q=this.options.name,t=false,u,r,s;if(!v||!q){return}if(v.handleSelection){t=true}this._connectionTypes=[];for(u in v.ConnectionTypes){if(v.ConnectionTypes.hasOwnProperty(u)){this._connectionTypes.push(u)}}switch(q){case"LeftBloc":this._refCount="refCountLeftBloc";this._refNodes="nodesInLeftBloc";break;case"RightBloc":this._refCount="refCountRightBloc";this._refNodes="nodesInRightBloc";break;default:}this._dependingCounterAttribute=(v&&v.considerAllNodes)?"nodesInTableView":"asRootInTableView";this.listenTo(this.options.referenceCollection,this._modelEvents);this.listenTo(this.options.instanceCollection,this._modelEvents);this.listenTo(this.options.connectionCollection,this._modelEvents);this.listenTo(this.options.documentConnectionCollection,this._modelDocEvents);r={className:this.options.viewPreferences.Title,nodesCounter:this._refNodes};r=f.extend(r,n.getDDBehavior());r=f.extend(r,c.getEditionManager(this));r=f.extend(r,this._getContextualMenu());s=k.getGenericViewPreference(this.options.viewPreferences);this.treeListView=c.createTreelistview({treelistviewOptions:r,preferences:s,name:q});this._handleEvents("selectedInGenericView",{isCrossHighlight:true,isManageCommandAvailability:true,isSelectedFor3DView:true,isHandleSelection:t});this.render();e.subscribe({event:"DELWebMfgAssetsDefUI/prepareUpdate"},function(){p.treeListView.utils._treeDocument.prepareUpdate()});e.subscribe({event:"DELWebMfgAssetsDefUI/pushUpdate"},function(){p.treeListView.utils._treeDocument.pushUpdate()});e.subscribe({event:"DELWebMfgAssetsDefUI/emptyView"},function(){p.treeListView.utils._treeDocument.removeRoots()})},render:function b(){var p;this.setContainer(this.treeListView.getContent());p=this.container;if(f.is(this.options.renderTo)){p.inject(this.options.renderTo)}return this},destroy:function(){this.stopListening();this._parent()},_getContextualMenu:function d(){var p=this,r={};r.onContextualMenuReady=function q(w){var x={},t=[],u=w.nodeModel,v={},s=w.manager;if(!f.is(w)){return}if(f.is(this.getVirtualCoordinates,"function")){x=this.getVirtualCoordinates()}if(-1===x.virtualRowID){t=[{icon:"url("+g.getIconURLFromKey("SortAToZ")+")",label:"Sort A to Z",callback:function(){s.sortColumnContent(x.virtualColumnID,{sortOrder:"asc"})}},{icon:"url("+g.getIconURLFromKey("SortZToA")+")",label:"Sort Z to A",callback:function(){s.sortColumnContent(x.virtualColumnID,{sortOrder:"desc"})}}]}else{if(0<=x.virtualRowID){if(f.is(u)){if(!u.isSelected()){p.treeListView.getDocument().unselectAll();u.select()}}v={node:u,selectedNodes:p.treeListView.getDocument().getXSO().get(),column:p.treeListView.options.columns[w.virtualColumnID]};v.infos=l.getNodeAndColumnInfos(u,v.column);t=c.buildContextualMenuNodes(["Relations","EditAttribute"],o.getActionBarContext(),v);t.push({type:"separator"});t=t.concat(c.buildContextualMenuNodes(["CapableResourceBL"],o.getActionBarContext()));t.push({type:"separator"});t=t.concat(c.buildContextualMenuNodes(["AttachDocument","SearchDocument","ManageDocuments"],o.getActionBarContext()));t.push({type:"separator"});t=t.concat(c.buildContextualMenuNodes(["Refresh","ExploreInWebApp"],o.getActionBarContext()));t.push({type:"separator"})}}return t.concat(c.buildContextualMenuNodes(c.getDefaultContextualMenu(),o.getActionBarContext()))};return r}});return i});
define("DS/DELWebMfgItemDefUI/InitialMFNWidgetLayout",["DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgItemDefUtils/DOMNaming","DS/DELWebMfgItemDefCommands/CommandsManager"],function(a,d,b){var c={_widget:null,setWidget:function e(g){c._widget=g},sortMFNView:function f(j){var g=null,i=null,l=null,o=null,n=null,k;if(j.AV){a.CommandsCheckHeaderManager.getCmd("showAuxiliaryView").setState(true)}else{a.CommandsCheckHeaderManager.getCmd("showAuxiliaryView").setState(false)}n="BODY";g=widget.getElement(d.selectors.bodyContainer);l=c._widget.getBodyTreeListView();o=c._widget.getBodyGraphView();i=g.hasClassName(d.classes.showGraphView);var m=a.CommandsCheckHeaderManager.getCmd("ProductsParts");if(!j.LGV&&!j.LV){if(m.getState()!=false){m.setState(false)}}else{if(j.LGV){if(m.getState()!=true){m.setState(true)}if(!i){o.setModel(l.getDocument());g.toggleClassName(d.classes.showGraphView)}}else{if(j.LV){if(m.getState()!=true){m.setState(true)}if(i){k=l.getManager();k.loadDocument(o.getModel());g.toggleClassName(d.classes.showGraphView)}}}}b._manageGraphCommandsAvailability(n);n="MBOM";g=widget.getElement(d.selectors.mbomContainer);l=c._widget.getMBOMTreeListView();o=c._widget.getMBOMGraphView();i=g.hasClassName(d.classes.showGraphView);var h=a.CommandsCheckHeaderManager.getCmd("ManufacturingItems");if(!j.RGV&&!j.RV){if(h.getState()!=false){h.setState(false)}}else{if(j.RGV){if(h.getState()!=true){h.setState(true)}if(!i){o.setModel(l.getDocument());g.toggleClassName(d.classes.showGraphView)}}else{if(j.RV){if(h.getState()!=true){h.setState(true)}if(i){k=l.getManager();k.loadDocument(o.getModel());g.toggleClassName(d.classes.showGraphView)}}}}b._manageGraphCommandsAvailability(n)}};return c});define("DS/DELWebMfgItemDefUI/Widget",["DS/DELWebMfgItemDefUIPanel/ActionViewManager","UWA/Core","UWA/Utils/InterCom","DS/Core/Events","DS/Logger/Logger","DS/ApplicationFrame/FrameWindow","DS/DELWebMfgItemDefUIPanel/ToolBar","DS/DELWebMfgItemDefUIPanel/ProgressIndicatorBar","DS/DELWebMfgAssetsDefUIControls/BlocLayout","DS/DELWebMfgAssetsDefUIServices/CommandsManager","DS/DELWebMfgAssetsDefUIControls/Preferences","DS/DELWebMfgAssetsDefModelServices/ModelPreferences","DS/DELWebMfgItemDefCommands/CommandsManager","DS/DELWebMfgAssetsDefInstanceModel/InstanceCollection","DS/DELWebMfgAssetsDefReferenceModel/ReferenceCollection","DS/DELWebMfgAssetsDefConnectionModel/ConnectionCollection","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefInstanceModel/InstanceModel","DS/DELWebMfgItemDefModels/ReferenceDisplayModel","DS/DELWebMfgItemDefModels/InstanceDisplayModel","DS/DELWebMfgItemDefUIViews/DropView","DS/DELWebMfgAssetsDefUIServices/CreateLinkUtil","DS/DELWebMfgItemDefUIViews/MBOMView","DS/DELWebMfgItemDefUIViews/BodyView","DS/DELWebMfgItemDefUIGraphViews/BodyGraphView","DS/DELWebMfgItemDefUIGraphViews/MBOMGraphView","DS/DELWebMfgAssetsDefUIAuxiliaryView/AuxiliaryView","DS/DELWebMfgAssetsDefUIControls/LinksUI","DS/UIKIT/Mask","DS/DELWebMfgItemDefUtils/DOMNaming","DS/DELWebMfgItemDefKeyBindings/KeyBindingHandler","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/ApplicationFrame/CommandsManager","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/DocumentUtility","DS/DELWebMfgAssetsDefModelServices/DocumentObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/ExternalEventsUtils","DS/DELWebMfgAssetsDefModelServices/Selection","DS/DELWebMfgAssetsDefModelServices/IndexedDBUtils","DS/DELWebMfgAssetsDefModelServices/CustoParametersSet","DS/DELWebMfgAssetsDefUIServices/TooltipUtils","DS/DELWebMfgAssetsDefUIServices/TableViewPreferences","DS/DELWebMfgItemDefUI/InitialMFNWidgetLayout","DS/DELWebMfgAssetsDefModelServices/BIUtils","DS/DELWebMfgAssetsDefUIServices/SecurityContext","DS/Core/Events","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil","i18n!DS/DELWebMfgItemDefUI/assets/nls/MGI_NLS","i18n!DS/DELWebMfgItemDefUI/assets/nls/MGI_Infos_NLS","i18n!DS/DELWebMfgItemDefUI/assets/nls/MGI_Errors_NLS","i18n!DS/DELWebMfgItemDefUI/assets/nls/MGI_Success_NLS","i18n!DS/DELWebMfgAssetsDefModelServices/assets/nls/MGA_NLS","text!DS/DELWebMfgItemDefUI/assets/rsc/MGI_RSC.json","text!DS/DELWebMfgAssetsDefModelServices/assets/rsc/MGA_RSC.json","text!DS/DELWebMfgItemDefUI/assets/config/MBOMTreeListView.json","text!DS/DELWebMfgItemDefUI/assets/config/BodyTreeListView.json","text!DS/ENOCollabSharingCmds/assets/catnls/CollabSharing_Workbench.CATNls","text!DS/ENOCollabSharingCmds/assets/catrsc/CollabSharing_Workbench.CATRsc","css!DS/UIKIT/UIKIT.css","css!DS/DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUI.css","css!DS/DELWebMfgItemDefUI/assets/css/custom"],function(aw,aZ,aI,P,Q,z,aP,e,I,a9,N,h,aE,aK,aR,aM,ap,a5,ad,m,ba,aq,k,bf,aJ,E,an,bd,o,aG,g,aQ,l,aO,bb,a3,n,aY,W,j,ai,bg,av,C,ay,G,aX,u,D,bj,L,a6,q,Z,T,X,aD,A,az,ae,r,bh){var al={_logger:null,_frameWindow:null,_blocLayout:null,_references:null,_instances:null,_connections:null,_erMode:false,_bodyDropView:null,_bodyGraphView:null,_bodyTreeListView:null,_mbomDropView:null,_mbomGraphView:null,_mbomTreeListView:null,_actionDiv:null,_mbomTreeListToolBar:null,_mbomGraphToolBar:null,_bodyTreeListToolBar:null,_bodyGraphToolBar:null,_progressBar:null,_xso:null,_xmlModelRelations:"DELWebMfgItemDefUI/DELWebMfgItemDefModelRelations",_isLoaded:false,name:"MfgItemWidget",focus:"None",actionOpened:false,VIEWS:{MBOM:"MBOM",BODY:"BODY",ACTION:"ACTION",AUXILIARY:"AUXILIARY"},init:function ax(){al._frameWindow=null;al._blocLayout=null;al._logger=null;al._bodyDropView=null;al._bodyGraphView=null;al._bodyTreeListView=null;al._mbomDropView=null;al._mbomGraphView=null;al._mbomTreeListView=null;al._actionDiv=null;al._progressBar=null},manageCommandsAvailability:function s(){aE.onSelectionChanged()},onLoad:function aT(){if(Q){al._logger=Q.getLogger(al);al._logger.log("onLoad")}a3.setWidgetTrigram("MFN");widget.body.empty();aG.mask(widget.body);if(!widget.getValue("x3dSharedId")&&!widget.getValue("x3dAppId")){widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"DELWebMfgAssets_appId"})}l.addCATRscFile(bh,"ENOCollabSharingCmds");l.addRscFile(A,"DELWebMfgAssetsDefUI");l.addRscFile(aD,"DELWebMfgItemDefUI");l.addCATNlsFile(r);l.addNlsFile(X);l.addNlsFile(a6);l.addNlsFile(q);l.addNlsFile(Z);l.addNlsFile(T);al._buildProgressBar();if(a3.isStandAlone()){require(["DS/DELWebMfgAssetsDefModelServicesTst/standAloneModelUtils"],function(bm){if(al._logger){al._logger.log("Test module IS there")}bm.standAloneModelUtils(a3);require(["css!DS/UWA2/assets/css/standalone.css","css!DS/DELWebMfgAssetsDefCommandsTst/DELWebMfgAssetsDefUITST.css"],function(){var bp=document.getElementsByClassName("module"),br=document.getElementsByClassName("moduleContent"),bo;if(bp){for(bo=(bp.length-1);bo>=0;bo--){bp[bo].classList.add("module-MGATST");bp[bo].classList.remove("module")}}if(br){for(bo=(br.length-1);bo>=0;bo--){br[bo].classList.add("moduleContent-MGATST");br[bo].classList.remove("moduleContent")}}a3.getInitPromise({preferences:N,securityContext:D,xmlModelRelation:al._xmlModelRelations}).then(function bq(){widget.setValue("showRequirementsInRelationPanel","true");al._initApp.call(al,bm)})},function bn(bp){var bo;if(al._logger){al._logger.log("Test CSS is NOT there")}if(null!==bp.requireModules){bo=bp.requireModules&&bp.requireModules[0];require.undef(bo)}})},function(bn){var bm;if(al._logger){al._logger.log("Test module is NOT there")}if(bn.requireModules!==null){bm=bn.requireModules&&bn.requireModules[0];require.undef(bm)}})}else{a3.getInitPromise({preferences:N,securityContext:D,xmlModelRelation:al._xmlModelRelations}).then(function bl(bm){al._initApp.call(al,null);al._initAlerts=bm})}widget.addEvent("DELWebMfgItemDefUI/editWidgetLayout",aX.sortMFNView);aX.setWidget(al)},onViewChange:function F(){},_searchCallBackAddSuccess:function a(bl){var bm=al.getMBOMView().isAcceptedType(bl);var bn=al.getBodyView().isAcceptedType(bl);if(bm){bl.setDisplayModel({asRootInTableView:true})}if(bn){bl.setDisplayModel({asRootInBodyView:true})}},onResize:function O(){aZ.Event.dispatchEvent(al.getBlocLayout().getContent(),"onBlocLayoutResizeEnd")},_initApp:function p(bo){var bn=[],bp=["DELWebMfgItemDefUI/DELWebMfgItemDefUIConfig","DELWebMfgItemDefUI/DELWebMfgItemDefUIBOMView","DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIEditLinkAttributes","DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIInsertCmdFormAttribute"];bp.forEach(function(br){bn.push(new Promise(function bq(bt,bs){a3.getXMLValues(br,bt,bs)}))});Promise.all(bn).then(function bl(bt){var bq=bt[0],br=bt[1];bb.TableView=bq.Config.Preferences.TableView;bb.LeftBloc=bq.Config.Preferences.LeftBloc;bb.RightBloc=bq.Config.Preferences.RightBloc;bb.AuxiliaryView=bq.Config.Preferences.AuxiliaryView;bb.TableView.Title=l.getNLSValue("TableView.Title");bb.LeftBloc.Title=l.getNLSValue("LeftBloc.Title");bb.RightBloc.Title=l.getNLSValue("RightBloc.Title");bb.TableView.Name="TableView";bb.LeftBloc.Name="LeftBloc";bb.RightBloc.Name="RightBloc";bb.processGraphViewPreferences(br,"BOMView");a3.retrieveAttributesInfo({uiConfig:"DELWebMfgItemDefUI/DELWebMfgItemDefUIConfig",insertCmd:"DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIInsertCmdFormAttribute",editLink:"DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIEditLinkAttributes",bomView:"DELWebMfgItemDefUI/DELWebMfgItemDefUIBOMView"},function bs(){al._loadAll.call(al,bo)})},function bm(){a3._logger.error("ModelUtils.retrieveAttributesInfo call FAILED!!!")})},_loadAll:function ao(bn){var bo,bm,bl,bq;a3.getXMLValues("DELWebMfgItemDefUI/DELWebMfgItemDefRelationsDialogDisplayAttributeConfig");if(!al._isLoaded){bg.init({widgetTrigram:"MFN"})}if(!al._isLoaded){aO.init({widgetTrigram:"MFN"})}aO.setWidget(al);aO.createUIContainer();aO.buildProgressBarContainer();aO.createLinkViewTypeFilter();a5.setDisplayModelClass(m);ad.setDisplayModelClass(ba);if(!al._isLoaded){ap.init({standAloneModelUtils:bn,VIEWS:al.VIEWS})}widget.CollectionUtils=ap;a3.getXMLValues("DELWebMfgItemDefUI/DELWebMfgItemDefUIRelationsColumnMapping",function bp(bs){a3.getXMLValues("DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIRelationsDisplayAttributeConfig",function br(bt){if(!al._isLoaded){aY.init({CollectionUtils:ap,ModelUtils:a3,relAttrToRelations:bs,iUIConfigRelValues:bt});W.init({modelUtils:a3,uiUtils:aO,collectionUtils:ap});j.init({ModelUtils:a3});ai.init();ay.init();av.init()}bo=l.getIconURLFromKey("AppIcon");widget.setIcon(bo);aO.updateWidgetTitle();bq=al._buildFrameWindow(al._onActionBarReady);if(bq){aO._frameWindow=bq;if(!al._isLoaded){o.init({relationDisplayAttributeConfigXML:"DELWebMfgItemDefUI/DELWebMfgItemDefRelationsDialogDisplayAttributeConfig",widgetTrigram:"MFN",context:aZ.extend(al,bg._context)})}bm=bq.getUIFrame();if(bm){bl=al._buildDom(bm);if(bl){if(a3.isStandAlone()){al._init({uiFrame:bm,standAlone:bn})}else{al._init({uiFrame:bm})}al._loadRootStoredPref()}}}a3.populateDocumentPolicies()})})},_loadRootStoredPref:function ag(){var bn,bm,bl;bn=aZ.Json.decode(widget.getValue(N.getRootsPrefName()));if(aZ.is(bn.Default)){bm=bn.Default;Object.keys(bm).forEach(function(bo){switch(bo){case"MBOM":bl=al.getMBOMView();break;case"BODY":bl=al.getBodyView();break;default:bl=al._auxiliaryView}bj.publish({event:"/DELWebMfgItemDefUI/ViewLoaded/"});if(bm[bo].length>0){bl._loadStoredRoots(bm[bo])}})}},onRefresh:function aS(){var bl=function bl(){var bq,bp=["AlternateCommand","OriginCommand","CapableResourceCommand"];if(aZ.is(al.actionOpened)&&al.actionOpened===true){al.closeActionView();for(bq=0;bq<bp.length;bq++){aO.CommandsCheckHeaderManager.getCmd(bp[bq]).setState(false)}}},bn={onComplete:bl,context:this},bo=al.getBodyView().getTreeListView(),bm=al.getMBOMView().getTreeListView();if(bo.utils._filterProxy){bo.utils._filterProxy.clear()}if(bm.utils._filterProxy){bm.utils._filterProxy.clear()}aO.refreshWidget(bn)},onReset:function a8(){widget.body.empty();al.destroy();al.init();al.onLoad()},onSearch:function ac(bl){var br,bm,bq,bp,bo,bn;if(aZ.is(bl,"string")){bm=bl.split(":");if(aZ.is(bm,"array")){if(bm.length>1){bq=bm[0];bp=bm[1]}}}bo=aZ.is(bq,"string")?bq.replace(/^\s+/g,"").replace(/\s+$/g,""):"";bn=aZ.is(bp,"string")?bp.replace(/^\s+/g,"").replace(/\s+$/g,""):"";if(aZ.is(bo)&&aZ.is(bn)&&bo!==""&&bn!==""){br={type:bo,externalId:bn};ap.references.fetch({data:br,proxy:"passport",headers:a3.getHeaders(),wait:true,remove:false,onComplete:function bs(bt,bu){bu.forEach(function(bx){var bw=bt.get(bx.PID);var bv=al.getMBOMView().isAcceptedType(bw);var by=al.getBodyView().isAcceptedType(bw);if(bv){bw.setDisplayModel({asRootInTableView:true})}if(by){bw.setDisplayModel({asRootInBodyView:true})}})}})}},endEditPreferences:function aB(){var bl;aO.updateWidgetTitle();if(D.isChanged()){D.updateSecurityContext();a3.populateDocumentPolicies()}if(C.isChanged()){for(bl in a3.xmlCache){if(a3.xmlCache.hasOwnProperty(bl)){delete a3.xmlCache[bl]}}widget.body.querySelectorAll("div.ui-container").forEach(function bm(bn){bn.remove()});G._TVColumnsPrefValue=null;G._consumedItemsPrefValue=null;G._capableResourcesPrefValue=null;G._widgetLayoutPrefValue=null;al._initApp.call(al,null);bj.subscribe({event:"/DELWebMfgItemDefUI/ViewLoaded/"},function(){aE.rebindXSO()})}},destroy:function c(){if(al._logger){al._logger.log("destroy")}if(al._frameWindow){delete (al._frameWindow)}if(al._blocLayout){delete (al._blocLayout)}if(al._logger){delete (al._logger)}if(al._bodyDropView){delete (al._bodyDropView)}if(al._bodyGraphView){delete (al._bodyGraphView)}if(al._bodyTreeListView){delete (al._bodyTreeListView)}if(al._mbomDropView){delete (al._mbomDropView)}if(al._mbomGraphView){delete (al._mbomGraphView)}if(al._mbomTreeListView){delete (al._mbomTreeListView)}},_buildFrameWindow:function aA(bl){if(al._logger){al._logger.log("_buildFrameWindow")}al._frameWindow=new z({workbench:"DELWebMfgItemDefUI.xml",workbenchModule:"DELWebMfgItemDefUI",viewer:"none",minHeight:0,context:aZ.extend(al,bg._context),language:widget.lang});if(al._frameWindow){al._frameWindow.onActionBarReady(function(){if(aZ.is(bl,"function")){bl.call(this,null)}})}return al._frameWindow},_buildDom:function H(bs){var br=this,bn,bl,bq,bt,bp,bm;if(al._logger){al._logger.log("_buildDom")}if(!bs){return false}bn=aZ.createElement("main",{"class":g.construction.main});al._mainDiv=bn;bl=aZ.createElement("div",{"class":g.construction.mainMessages}).inject(bs);br._mainBlocLayout=aO.createMainBlocLayout({minSize:"250px",rows:[{columns:2}]});br._blocLayout=aO.createInnerBlocLayout({rows:[{columns:3}]});aO.AlertManager.inject(bl,"top");bq=br._buildBodyDom();bt=br._buildMBOMDom();bp=aZ.createElement("div",{styles:{width:"100%",height:"100%"}});bm=aZ.createElement("div",{styles:{width:"100%",height:"100%"}});al._bodyContainer=bp;al._mbomContainer=bm;al._actionDiv=aZ.createElement("div",{"class":"actionView",styles:{width:"100%",height:"100%"}});al._leftPercent=0.5;al._middlePercent=0.5;al._rightPercent=0.333;al.getBlocLayout().getContent().addEvent("onBlocLayoutResizeEnd",function(){var bv=document.body.clientWidth;var bu=al._bodyContainer.clientWidth;var bx=al._mbomContainer.clientWidth;var bw=al._actionDiv.clientWidth;if(0!==bw){al._rightPercent=(bw)/bv}if(0!==bx){al._middlePercent=(bx)/bv}if(0!==bu){al._leftPercent=(bu)/bv}});br._blocLayout.setColumnContent(0,0,al._bodyContainer);br._blocLayout.setColumnContent(0,1,al._mbomContainer);br._blocLayout.setColumnContent(0,2,al._actionDiv);br._auxiliaryViewDom=br._buildAuxiliaryViewDom();al._bodyContainer.onclick=function(){al.setFocus(al.VIEWS.BODY)};al._mbomContainer.onclick=function(){al.setFocus(al.VIEWS.MBOM)};al._actionDiv.onclick=function(){al.setFocus(al.VIEWS.ACTION)};br._auxiliaryViewDom.onclick=function bo(){al.setFocus(al.VIEWS.AUXILIARY)};br._mainBlocLayout.setColumnContent(0,0,br._auxiliaryViewDom);br._mainBlocLayout.setColumnContent(0,1,br._blocLayout.getContent());br._mainBlocLayout.inject(bn);bn.inject(bs);al._frameWindow.inject(aO.getMGAElement("UIContainer"));aO._bodyViewDockingElement=aO.createTableViewDockingElement();aO._tableViewDockingElement=aO.createTableViewDockingElement();aO._actionViewDockingElement=aO.createTableViewDockingElement();aO._bodyViewDockingElement.freeZoneContent=bq;aO._tableViewDockingElement.freeZoneContent=bt;aO._bodyViewDockingElement.inject(al._bodyContainer);aO._tableViewDockingElement.inject(al._mbomContainer);this._initActionViewManager();return true},_initActionViewManager:function K(){if(!al._isLoaded){aw.init({_context:this})}},_buildBodyDom:function a2(){var bl;if(al._logger){al._logger.log("_buildPSDom")}bl=aZ.createElement("div",{"class":g.construction.bodyContainer,html:[{tag:"div","class":g.construction.bodyDrop},{tag:"div","class":g.construction.bodyMessages},{tag:"div","class":g.construction.bodyTreeListView,html:[{tag:"div","class":g.construction.bodyTreeListToolBar}]},{tag:"div","class":g.construction.bodyGraphView,html:[{tag:"div","class":g.construction.bodyGraphToolBar}]}]});return bl},_buildMBOMDom:function aC(){var bl;if(al._logger){al._logger.log("_buildMBOMDom")}bl=aZ.createElement("div",{"class":g.construction.mbomContainer,html:[{tag:"div","class":g.construction.mbomDrop},{tag:"div","class":g.construction.mbomMessages},{tag:"div","class":g.construction.mbomTreeListView,html:[{tag:"div","class":g.construction.mbomTreeListToolBar}]},{tag:"div","class":g.construction.mbomGraphView,html:[{tag:"div","class":g.construction.mbomGraphToolBar}]}]});return bl},_buildAuxiliaryViewDom:function a1(){if(al._logger){al._logger.log("_buildMGAAuxiliaryViewDom")}aO.createAuxiliaryViewDom();aO._auxiliaryViewTypeFilter.inject(aO._auxiliaryViewToolBar);aO._auxiliaryViewToolBar.inject(aO._auxiliaryBlocContainer);aO._auxiliaryViewContainer.inject(aO._auxiliaryBlocContainer);return aO._auxiliaryBlocContainer},_init:function aF(bl){var bm;if(!al._isLoaded){if(al._logger){al._logger.log("_init")}bm={standAloneModelUtils:bl.standAlone,referenceDisplayModel:m,instanceDisplayModel:ba};if(ap.references){ap.reload(bm)}else{ap.init(bm)}ap.references.addEvent("onValidationFailure",function(bo,bn){var bq={},bp;bq[bn.param]=bn.paramValue;bp=l.getNLSValue(bn.key,bq,"ValidationError");aO.AlertManager.add({className:"warning",message:bp})});u.init()}else{if(ap.references){ap.reload(bm)}}al._initMBOM(bl.uiFrame);al._initPS(bl.uiFrame);al._initAuxiliaryView(bl.uiFrame);al._xso=bg;al._injectProgressBar()},_initAuxiliaryView:function a4(){al._auxiliaryView=new bd({className:"auxiliaryView",renderTo:aO.getMGAElement("AuxiliaryViewContainer"),referenceCollection:ap.references,instanceCollection:ap.instances,documentConnectionCollection:ap.documentsConnection,isManageCommandAvailability:false,context:al})},_initMBOM:function f(bp){var bq=bp.getElement(g.selectors.mbomDrop),bl=bp.getElement(g.selectors.mbomTreeListToolBar),bo=bp.getElement(g.selectors.mbomTreeList),bs=bp.getElement(g.selectors.mbomGraphToolBar),bt=bp.getElement(g.selectors.mbomGraph),bn=aZ.Json.decode(az),br,bm;if(al._logger){al._logger.log("_initMBOM")}if(bn){al._mbomView=new bf({renderTo:bo,context:al,constructionOptions:bn,acceptedTypes:["PROCESS"]});al._mbomDropView=new aq({container:bq,accepts:["CreateAssembly"]});al._mbomTreeListView=al.getMBOMView().getTreeListView();al._bottomBloc={treeListView:al._mbomTreeListView};al._mbomGraphView=new an(aZ.extend({renderTo:bt,context:al},bn));al._mbomTreeListView.utils._graphView=al._mbomGraphView;br={toolBarIcon:"CreateAssembly",Buttons:[{command:"ToggleGraphView",toolTip:"Cmd.ToggleGraphView.Title"},{command:"EditTVColumns",toolTip:"EditTVColumnsCmd.TITLE"},{command:"MBOMAddCommand",toolTip:"Cmd.MBOMAddCommand.Title"}]};bm={toolBarIcon:"CreateAssembly",Buttons:[{command:"ToggleGraphView",toolTip:"Cmd.ToggleGraphView.Title"},{command:"ToggleOverview",toolTip:"Cmd.ToggleOverview.Title"},{command:"ToggleOrientation",toolTip:"Cmd.ToggleOrientation.Title"},{command:"Reframe",toolTip:"Cmd.Reframe.Title"},{command:"ReframeOn",toolTip:"Cmd.ReframeOn.Title"}]};al._mbomTreeListToolBar=new aP(br,al,"MBOM");al._mbomTreeListToolBar.inject(bl);al._mbomGraphToolBar=new aP(bm,al,"MBOM");al._mbomGraphToolBar.inject(bs)}aO.setAcceptedTypesInTableView(["PROCESS"])},_initPS:function V(bp){var bm=bp.getElement(g.selectors.bodyDrop),bn=bp.getElement(g.selectors.bodyTreeListToolBar),br=bp.getElement(g.selectors.bodyTreeList),bs=bp.getElement(g.selectors.bodyGraphToolBar),bq=bp.getElement(g.selectors.bodyGraph),bo=aZ.Json.decode(ae),bl,bt;if(al._logger){al._logger.log("_initPS")}if(bo){al._bodyView=new aJ({renderTo:br,context:al,constructionOptions:bo,acceptedTypes:["PRODUCT","PART","RESOURCE"],referenceCollection:ap.references,instanceCollection:ap.instances,connectionCollection:ap.connections,documentConnectionCollection:ap.documentsConnection});al._bodyTreeListView=al.getBodyView().getTreeListView();al._leftBloc={treeListView:al._bodyTreeListView};al._bodyDropView=new aq({container:bm,accepts:["VPMReference","Part"]});al._bodyGraphView=new E(aZ.extend({renderTo:bq,context:al},bo));bl={toolBarIcon:"Product",Buttons:[{command:"ToggleGraphView",toolTip:"Cmd.ToggleGraphView.Title"},{command:"EditTVColumns",toolTip:"EditTVColumnsCmd.TITLE"},{command:"ProductAddCommand",toolTip:"Cmd.ProductAddCommand.Title"}]};bt={toolBarIcon:"Product",Buttons:[{command:"ToggleGraphView",toolTip:"Cmd.ToggleGraphView.Title"},{command:"ToggleOverview",toolTip:"Cmd.ToggleOverview.Title"},{command:"ToggleOrientation",toolTip:"Cmd.ToggleOrientation.Title"},{command:"Reframe",toolTip:"Cmd.Reframe.Title"},{command:"ReframeOn",toolTip:"Cmd.ReframeOn.Title"}]};al._bodyTreeListToolBar=new aP(bl,al,"BODY");al._bodyTreeListToolBar.inject(bn);al._bodyGraphToolBar=new aP(bt,al,"BODY");al._bodyGraphToolBar.inject(bs)}},_render:function ar(bu){var bv=false,by,bl=null,bn,bq,br,bm,bx,bw,bo,bp,bs,bt;if(al._logger){al._logger.log("_render")}if(bu){widget.body.empty();aG.mask(widget.body);if(aZ.is(bu.inject,"function")){bu.inject(widget.body);bv=true}}this.getBlocLayout().setColumnsWidth(0,[2],0,{});this.getBlocLayout().addFixedColumns([{row:0,column:2}]);aO.getMGAElement("MainBlocLayout").setColumnsWidth(0,[0],0,{minSize:0});setTimeout(function(){aG.unmask(widget.body);if(L.isViewPersistanceOn()){bp=(widget.getValue("MFNViewProducts")==="true")?true:false;bs=(widget.getValue("MFNViewMBOM")==="true")?true:false;bt=(widget.getValue("MFNViewAuxiliary")==="true")?true:false;if(!bp){al.closeMFNView("Products")}else{if(!bs){al.closeMFNView("MBOM")}}if(bt){aO.getMGAElement("MainBlocLayout").setColumnsWidth(0,[0],250)}}},1000);by=G.getWidgetLayoutValues();if(by){if(by.AV){aO.CommandsCheckHeaderManager.getCmd("showAuxiliaryView").setState(true)}else{if(!by.AV){aO.CommandsCheckHeaderManager.getCmd("showAuxiliaryView").setState(false)}}bw="BODY";bl=widget.getElement(g.selectors.bodyContainer);bq=this.getBodyTreeListView();bx=this.getBodyGraphView();bn=bl.hasClassName(g.classes.showGraphView);br=aO.CommandsCheckHeaderManager.getCmd("ProductsParts");if(!by.LGV&&!by.LV){if(br.getState()!==false){br.setState(false)}}else{if(by.LGV){if(br.getState()!==true){br.setState(true)}if(!bn){bx.setModel(bq.getDocument());bl.toggleClassName(g.classes.showGraphView)}}else{if(by.LV){if(br.getState()!==true){br.setState(true)}if(bn){bo=bq.getManager();bo.loadDocument(bx.getModel());bl.toggleClassName(g.classes.showGraphView)}}}}aE._manageGraphCommandsAvailability(bw);bw="MBOM";bl=widget.getElement(g.selectors.mbomContainer);bq=this.getMBOMTreeListView();bx=this.getMBOMGraphView();bn=bl.hasClassName(g.classes.showGraphView);bm=aO.CommandsCheckHeaderManager.getCmd("ManufacturingItems");if(!by.RGV&&!by.RV){if(bm.getState()!==false){bm.setState(false)}}else{if(by.RGV){if(bm.getState()!==true){bm.setState(true)}if(!bn){bx.setModel(bq.getDocument());bl.toggleClassName(g.classes.showGraphView)}}else{if(by.RV){if(bm.getState()!==true){bm.setState(true)}if(bn){bo=bq.getManager();bo.loadDocument(bx.getModel());bl.toggleClassName(g.classes.showGraphView)}}}}aE._manageGraphCommandsAvailability(bw)}return bv},_onActionBarReady:function J(){var bo,bn,bl;if(al._logger){al._logger.log("_onActionBarReady")}al._render(aO.getMGAElement("UIContainer"));a9.initialize();if(!al._isLoaded){aE.init({context:al})}if(!al._isLoaded){k.init({widgetTrigram:"MFN",context:al})}if(aZ.is(al._initAlerts)&&aZ.is(al._initAlerts.warnings,"array")){al._initAlerts.warnings.forEach(function(bq){aO.AlertManager.add({className:"warning",message:bq})})}bo=function bo(bu){var bt,br,bv,bx,bw,bq,bs;bu.preventDefault();bu.stopPropagation();bt=al.getMBOMTreeListView().getDocument().getSelectedNodes();bv=function bv(){var by=al.getMBOMTreeListView().getDocument().getRoots(),bz;if(aZ.is(by)){bz=by[0];if(aZ.is(bz)){bz.select()}}};if(!bt){bv();return}bx=bt[0];if(!bx){bv();return}if(bx.hasChildren()){bw=bx.getChildren()[0];bw.select();bx.unselect()}else{if(bx.getNextBrother()){br=bx.getNextBrother();br.select();bx.unselect()}else{if(bx.isRoot()){bx.unselect();bv();return}else{bs=bx.getParent();while(bs&&!bs.getNextBrother()&&!bs.isRoot()){bs=bs.getParent()}br=bs.getNextBrother();if(br){br.select();bx.unselect()}else{if(bs.getPreviousBrother()){bq=bs.getPreviousBrother();bq.select();bx.unselect()}else{bx.unselect();bv();return}}}}}};new aQ({domElement:al._mbomContainer,onTab:bo,onDownArrow:bo,onUpArrow:function bm(){var br=al.getMBOMTreeListView().getDocument().getSelectedNodes(),bq=al.getMBOMTreeListView().getManager(),bv,bu,bt,bs=function bs(){var bw=bq.getRows().length,bx=bq.getRow(bw-1)[1].options.value;bx.select()};if(!br){bs();return}bv=br[0];if(!bv){bs();return}bu=bv._rowID;bt=bq.getRow(bu-1)[1].options.value;if(!bt||0===bu){bv.unselect();bs();return}bv.unselect();bt.select()},onCtrlA:function bp(){al.getMBOMTreeListView().getDocument().selectAll()}});bl=function bl(){aO.AlertManager.add({className:"info",message:l.getNLSValue("Info.UseProductWidget.Title")})};new aQ({domElement:al._bodyContainer,onCtrlC:bl,onCtrlV:bl,onCtrlX:bl,onSuppr:bl,onBackspace:bl,onCtrlA:function bp(){al.getBodyTreeListView().getDocument().selectAll()},onTab:function bo(bq){bq.preventDefault();bq.stopPropagation()}});bn=function bn(bq){al._logger.log("Authoring Context UI init message: "+JSON.stringify(bq));al._isLoaded=true;widget.dispatchEvent("DELWebMfgItemDefUI/endLoadingWidget")};aO.initAuthoringContextUI({context:al,onComplete:bn})},_buildProgressBar:function a7(){this._progressBar=new e({statusFlag:false,infiniteFlag:true,displayStyle:"lite",visibleFlag:false,emphasize:"info"})},_injectProgressBar:function b(){this._progressBar.inject(aO.getMGAElement("ProgressBar"))},isActionViewOpen:function am(){return al.actionOpened},openActionView:function bc(){var bl,bm;if(false===this.isActionViewOpen()){bl=document.body.clientWidth;bm=al._rightPercent*bl;this.getBlocLayout().removeFixedColumns([{row:0,column:2}]);this.getBlocLayout().setColumnsWidth(0,[2],bm,{});al.actionOpened=true;aZ.Event.dispatchEvent(al.getBlocLayout().getContent(),"onBlocLayoutResizeEnd")}},closeActionView:function R(){if(true===this.isActionViewOpen()){this.getBlocLayout().setColumnsWidth(0,[2],0,{});this.getBlocLayout().addFixedColumns([{row:0,column:2}]);al.actionOpened=false;aZ.Event.dispatchEvent(al.getBlocLayout().getContent(),"onBlocLayoutResizeEnd");aw.destroyView()}},openMFNView:function y(bq){var bo=document.body.clientWidth,bm=0,bn,bp,bl;switch(bq){case"Products":bm=al._leftPercent*bo;bp=0;bl=0;break;case"MBOM":bm=al._middlePercent*bo;bp=0;bl=1;break;default:bm=100;bp=1;bl=1}bn=this.getBlocLayout();bn.removeFixedColumns([{row:bp,column:bl}]);bn.setColumnsWidth(0,[bl],bm,{});aZ.Event.dispatchEvent(al.getBlocLayout().getContent(),"onBlocLayoutResizeEnd")},closeMFNView:function ah(bo){var bn,bl,bm;switch(bo){case"Products":bn=0;bl=0;break;case"MBOM":bn=0;bl=1;break;default:bn=1;bl=1}bm=this.getBlocLayout();bm.setColumnsWidth(0,[bl],0,{});bm.addFixedColumns([{row:bn,column:bl}]);aZ.Event.dispatchEvent(al.getBlocLayout().getContent(),"onBlocLayoutResizeEnd")},isInGraphMode:function aN(bm){var bl=null;if(al.VIEWS.MBOM===bm){bl=widget.getElement(g.selectors.mbomContainer)}else{if(al.VIEWS.BODY===bm){bl=widget.getElement(g.selectors.bodyContainer)}}if(!bl){al._logger.warn("View does not implement a graph");return false}return bl.hasClassName(g.classes.showGraphView)},setRightBloc:function bk(bl){al._rightBloc=bl},setFocus:function aL(bl){if((al.VIEWS.ACTION===bl)||(bl!==al.focus)){al.focus=bl;al._logger.log("focused "+bl);aE._onFocusChange(al.focus);al._bodyContainer.removeClassName("focus");al._mbomContainer.removeClassName("focus");al._actionDiv.removeClassName("focus");aO.getMGAElement("AuxiliaryBlocContainer").removeClassName("focus");if(al.VIEWS.BODY===al.focus){al._bodyContainer.addClassName("focus")}else{if(al.VIEWS.MBOM===al.focus){al._mbomContainer.addClassName("focus")}else{if(al.VIEWS.ACTION===al.focus){al._actionDiv.addClassName("focus")}else{if(al.VIEWS.AUXILIARY===al.focus){aO.getMGAElement("AuxiliaryBlocContainer").addClassName("focus")}}}}al.show6WTagsForActiveView(bl)}},show6WTagsForActiveView:function au(bl){var bp=al.getBodyView().getTreeListView(),bo=al.getMBOMView().getTreeListView(),bn=bp.utils._filterProxy,bm=bo.utils._filterProxy;if(bl===al.VIEWS.BODY&&aZ.is(bn)&&aZ.is(bm)){bn.tagNavigatorProxy.activate();bm.tagNavigatorProxy.deactivate();bn.setActiveView(bl);bm.setActiveView(bl)}else{if(bl===al.VIEWS.MBOM&&aZ.is(bn)&&aZ.is(bm)){bm.tagNavigatorProxy.activate();bn.tagNavigatorProxy.deactivate();bm.setActiveView(bl);bn.setActiveView(bl)}else{if(aZ.is(bm)&&aZ.is(bn)){bm.tagNavigatorProxy.deactivate();bn.tagNavigatorProxy.deactivate();bm.setActiveView(bl);bn.setActiveView(bl)}}}},getBlocLayout:function aW(){return al._blocLayout},getFocus:function w(){return al.focus},getFocusTab:function a0(){if(al.VIEWS.BODY===al.focus){return"LeftUI"}else{if(al.VIEWS.MBOM===al.focus){return"TableUI"}else{if(al.VIEWS.ACTION===al.focus){return"RightUI"}}}},getActionDiv:function M(){return al._actionDiv},getMbomDropView:function i(){return al._mbomDropView},getBodyDropView:function ab(){return al._bodyDropView},getCommand:function B(bl){return n.getCommand(bl,al)},getReferenceCollection:function be(){return ap.references},getInstanceCollection:function at(){return ap.instances},getConnectionCollection:function t(){return ap.connections},getCollections:function aV(){return{references:ap.references,instances:ap.instances,connections:ap.connections}},getMBOMTreeListView:function d(){return al._mbomTreeListView},getView:function aj(){return al.getMBOMTreeListView()},getCurrentView:function ak(){return al.focus||"None"},getFocusedView:function bi(){switch(al.getCurrentView()){case al.VIEWS.MBOM:return al.getMBOMTreeListView();case al.VIEWS.BODY:return al.getBodyTreeListView();case al.VIEWS.ACTION:return aw._view._actionView.treeListView;case al.VIEWS.AUXILIARY:return aO.getMGAElement("TreeUI");default:return null}},getBodyTreeListView:function S(){return al._bodyTreeListView},getMBOMView:function U(){return al._mbomView},getBodyView:function x(){return al._bodyView},getMBOMGraphView:function af(){return al._mbomGraphView},getBodyGraphView:function v(){return al._bodyGraphView},getFrameWindow:function aa(){return al._frameWindow},getUIFrame:function aH(){return al._frameWindow.getUIFrame()},getAlertManager:function aU(){return aO.AlertManager},getXSO:function Y(){return al._xso}};return al});
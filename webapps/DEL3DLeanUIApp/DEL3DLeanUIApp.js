define("DS/DEL3DLeanUIApp/App",["UWA/Core","pluginDS!DS/VENBackbone/backbone.1.3.3/backbone","pluginDS!DS/VENBackboneRadio/backbone.radio.2.0.0/backbone.radio","pluginDS!DS/VENJSON2/json2/json2","pluginDS!DS/VENMarionette/backbone.marionette.3.5.1/backbone.marionette","DS/Logger/Logger","DS/DEL3DLeanViews/LoadingView","DS/DEL3DLeanViews/MainView","DS/DEL3DLeanResources/ResourcesManager","DS/DEL3DLeanSession/Session.manager","DS/DEL3DLeanHttpRequest/MessageHandler"],function(e,k,l,c,h,a,f,i,b,g,j){var d=h.Application.extend({region:"body",_mainView:null,_loadingView:null,_errorChannel:l.channel("error"),constructor:function d(){h.Application.prototype.constructor.apply(this,arguments);this._logger=a.getLogger(d)},showLoadingView:function(){this._loadingView=new f();this.showView(this._loadingView)},getLoadingView:function(){return this._loadingView},getMapView:function(){return this._mainView.getMapView()},showVersion:function(){if(e.is(this._loadingView)){this._loadingView.showVersion()}},onStart:function(){var m=this;this.getRegion().detachView();k.history.start();this._mainView=new i({loadingView:this._loadingView});this.showView(this._mainView);this._mainView.getLoadingView().setProgressionAndMessage(80,b.getTranslation("Loading_01"));g.initSession().then(function(){j.init(g.getSession().id);m._mainView.getLoadingView().setProgressionAndMessage(100,b.getTranslation("Loading_02"))},function(n){m._errorChannel.trigger("loading:cancel",n)})}});return d});define("DS/DEL3DLeanUIApp/3DLean",["UWA/Core","pluginDS!DS/VENJQuery/jquery.1.11.1/jquery","UWA/Class/Promise","pluginDS!DS/VENBackboneRadio/backbone.radio.2.0.0/backbone.radio","DS/DEL3DLeanUIApp/App","DS/DEL3DLeanViews/LoadingView","DS/DEL3DLeanResources/ResourcesManager","DS/DEL3DLeanEnums/Model.enum","DS/DEL3DLeanSession/Session.manager","DS/DEL3DLeanViews/Utils/UIUtils","DS/Logger/Logger","DS/DEL3DLeanLibs/DEL3DLHighstock","text!DS/DEL3DLeanUIApp/assets/config/config.nls.json"],function(e,f,k,n,d,h,c,j,i,b,a,l,g){var m={l3DLeanApp:null,logger:null,_currentPercent:10,_percent:0,_$progressBar:null,_$loadingText:null,_failed:false,_fullscreen:false,_errorChannel:n.channel("error"),_configurationOpened:0,_initGlobalVars:function(){Math.trunc=Math.trunc||function(p){if(isNaN(p)){return NaN}if(p>0){return Math.floor(p)}return Math.ceil(p)};var o=e.getGlobal();o.sessionLoaded=false;o.sessionToken=null;o.privateTeamCollabSpace=null;o._IS_MS=/Edge\/|Trident\/|MSIE /.test(navigator.userAgent);o._IS_EDGE=/Edge\/\d+/.test(navigator.userAgent);o._IS_FIREFOX=navigator.userAgent.toLowerCase().indexOf("firefox")>0},_reloadCacheIfNeeded:function(){var p=a.getLogger();var o=e.Class.Promise.deferred();require.config({urlArgs:"bust="+(new Date()).getTime()});require(["text!DS/DEL3DLeanViews/assets/CHANGELOG.md"],function(r){try{var v=r.length;var s=Number(window.localStorage.getItem("savedLength"));window.localStorage.setItem("savedLength",v);if(!e.is(e.getGlobal().jasmine)&&e.is(s)&&v!==s){window.location.reload(true)}else{var q=e.getGlobal();var u=r.indexOf("Version");var w=r.indexOf("\r");q.version=r.substr(u,w-u);p.info("3DLean version: "+q.version);o.resolve()}}catch(t){o.resolve()}},function(){p.warn("impossible to load CHANGELOG.md");o.resolve()});require.config({urlArgs:""});return o.promise},onLoad:function(){var q=[];var o=null;o=this._reloadCacheIfNeeded();this.getMobileMedia().addListener(f.proxy(this.hideOrShowWhiteBar,this));this._initGlobalVars();var r=this;b.initAnimationStyle();this.endEdit();this.l3DLeanApp=new d();this.logger=a.getLogger(this.l3DLeanApp);this.l3DLeanApp.showLoadingView();o.then(function(){if(widget.getValue("AutoFullscreen")==="true"||widget.getValue("AutoFullscreen")===true){widget.dispatchEvent("onViewRequest",{type:"fullscreen"})}r.l3DLeanApp.showVersion()});q.push(o);g=e.Json.decode(g);var s=this.onReject.bind(this);for(var p=0;p<g.length;p++){o=c.loadFile(g[p]);q.push(o)}o=i.init();q.push(o);q.push(l);k.all(q).then(function(){r.l3DLeanApp.start()},s)},onReject:function(o){this._errorChannel.trigger("loading:cancel",o)},onRefresh:function(){this._configurationOpened--;if(this._configurationOpened<=0){window.location.reload(true)}},onEdit:function(){this._configurationOpened=3},endEdit:function(){var p=widget.getPreferences();var q=0;for(q=0;q<p.length;q++){var o=p[q];switch(o.name){case"Animations":b.setAnimations(o.value);break;case"WidgetTitle":widget.setTitle(o.value);break;default:break}}},onViewChange:function(o){if(!e.is(this.$whiteBar)&&o.type==="fullscreen"){var p=f(window.top.document).find(".wi-"+widget.id+" .moduleContent.ifwe-fullscreen-space-optimized");if(p.length>0&&p.css("paddingTop")==="43px"){this.$whiteBar=p}}this._fullscreen=o.type==="fullscreen";this.hideOrShowWhiteBar()},isFullscreen:function(){return this._fullscreen},isOnMobile:function(){return this.getMobileMedia().matches},getMobileMedia:function(){return window.matchMedia("(max-width: 958px)")},hideOrShowWhiteBar:function(){if(e.is(this.$whiteBar)){if(this.isFullscreen()&&!this.isOnMobile()){this.$whiteBar.css("paddingTop","14px")}else{this.$whiteBar.css("paddingTop","")}}}};return m});
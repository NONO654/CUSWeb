define("DS/SMAProcWebContents/ContentToolbar",["DS/SMAProcWebCommonControls/Polymer","DS/SMAProcWebCommonControls/utils","DS/Controls/ProgressBar","DS/SMAProcWebContents/PolyUtils","DS/SMAProcWebContents/ContentUtils","DS/SMAProcWebCMMUtils/SMAWINAuthoringUtils","text!DS/SMAProcWebContents/ContentToolbar.html","DS/SMAProcWebAuthoringUtils/cmp-parameter-create/cmp-parameter-create-modal","UWA/Utils",],function(f,b,c,g,e,d,a){b.registerDomModule(a);f({is:"pcw-sdk-content-toolbar",properties:{category:{type:String,},fileTypes:{type:String,},plmTypes:{type:String},expandedTypes:{type:String,computed:"_computeExpandedType(plmTypes)"},idle:{type:Boolean,value:true}},listeners:{"inputFile.change":"_fileChange","param-create-done":"_onParamAdded"},created:function(){},_computeExpandedType:function(h){if(h){return e.expandTypes(h)}},setContentService:function(h){this.service=h},ready:function(){this.targetUI={};this.isReady=true;this.uniqueId="div_"+UWA.Utils.getUUID().replace(/-/g,"_");var h=this;f.dom(this.$.progressContainer).appendChild(new c({shape:"circular",infiniteFlag:true}).getContent());f.dom(this.root).appendChild(UWA.createElement("div",{id:this.uniqueId,styles:{display:"none"},events:{PCWSelectedContentChanged:function(j){var i={plmobject:j.detail.content,target:h.targetUI.content};h.service.publish("content-added",i)}}}));this.showProgressBar=this.showProgressBar.bind(this);this.hideProgressBar=this.hideProgressBar.bind(this)},_getAssetUrl:function(h){return require.toUrl("DS/SMAProcWebCommonControls/assets/"+h)},setTargetUI:function(i,h){this.targetUI[i]=h;if(i==="content"){if(!this.addDndEvent){this.addDndEvent=true;this.listen(h,"dnd-file","_handleDnD")}}},_handleDnD:function(i){var h=i.detail;if(h.type==="content"){this.handleUploadFiles(h.files)}else{if(h.type==="reference"){this.handleReferencedContent(h.objectId)}}},computeClass:function(h){return"toolbar "+h},onParamCreate:function(){var h=this;g.waitTillReady(this.$.paramCreateModal,"setDialogHeading",function(i){var j=h.service.getActivity();i.setDataContainer(j)})},onCreateVDoc:function(){this._showFileCreationDialog(true)},onCreateNVDoc:function(){this._showFileCreationDialog(false)},onSearch:function(){if(d.isWebInWin()){this.service.search(this.expandedTypes,this.uniqueId)}else{this.service.search(this.expandedTypes,this.targetUI.content)}},_showFileCreationDialog:function(i){if(!this.service){console.error("content service not set");return}this._isVersioned=i;if(d.isWebInWin()){var h="Simulation Document - "+(i?"Versioned":"Non Versioned");this.service.addOwnedContent(h,this.uniqueId)}else{this.$.inputFile.click()}},_fileChange:function(i){i&&i.stopPropagation();var h=i.target.files;this.handleUploadFiles(h)},handleUploadFiles:function(j){var i=this;var h=e.getDefaultCategory(this.service.getActivity());this.showProgressBar();this.service.uploadFiles(h,j,this.fileTypes,this._isVersioned).then(function(k){var l=Object.assign({},k,{target:i.targetUI.content});i.service.publish("content-added",l);i.hideProgressBar()},function(k){console.error(k);i.hideProgressBar()})},_addReferenceContent:function(h){this.showProgressBar();this.servce.handleReferencedContent(h).then(this.hideProgressBar,this.hideProgressBar)},_onParamAdded:function(h){h&&h.stopPropagation();if(h.detail.success){var i=h.detail.parameter;this.service.publishParametersCreated([i],this.targetUI.param)}},showProgressBar:function(){this.$.progressContainer.style.display="inline-block"},hideProgressBar:function(){this.$.progressContainer.style.display="none"}})});
var __extends=(this&&this.__extends)||(function(){var a=Object.setPrototypeOf||({__proto__:[]} instanceof Array&&function(e,c){e.__proto__=c})||function(f,c){for(var e in c){if(c.hasOwnProperty(e)){f[e]=c[e]}}};return function(f,c){a(f,c);function e(){this.constructor=f}f.prototype=c===null?Object.create(c):(e.prototype=c.prototype,new e())}})();define("DS/SMAProcWebContents/pcw-sortable-dnd-list-manager",["require","exports","DS/SMAProcWebContents/WUXControlUtil","i18n!DS/SMAProcWebContents/assets/nls/SMAProcWebContentsNLS.json","UWA/Utils"],function(e,d,b,g,c){var f="\n   {\n      display: flex;\n      position: relative; \n      width: 100%;\n   }\n   .dnd-inline {\n      display: inline-block;\n      vertical-align: middle;\n   }\n   [draggable] {\n      -moz-user-select: none;\n      -khtml-user-select: none;\n      -webkit-user-select: none;\n      user-select: none;\n      /* Required to make elements draggable in old WebKit */\n      -khtml-user-drag: element;\n      -webkit-user-drag: element;\n   }\n   .dnd-component-parent {\n      list-style-type: none;\n      width:100%;\n      margin: 0;\n      padding: 0;\n   }\n   .dnd-draggable-row {\n      padding: 4px;\n      margin-top: 3px;\n      cursor: move;\n      height:auto;\n   }\n   .dnd-draggable-row .dnd-drag-list-content {\n      text-align: center;\n   }\n   .dnd-draggable-row .dnd-drag-icon {\n      width: 15px;\n      font-size: 16px;\n   }\n   .dnd-draggable-row .dnd-body {\n      width:100%;\n      padding: 8px 6px 6px 6px;\n      height: 100%;\n   }\n   .dnd-draggable-row:hover {\n      background: #e0e0e0;\n      padding: 4px;\n      margin-top: 3px;\n   }\n   .dnd-draggable-row.dnd-drag-elem {\n      opacity: 0.4;\n   }\n   .dnd-draggable-row.dnd-over {\n      background: #e0e0e0;\n   }\n   .dnd-draggable-row .dnd-element-delete {\n      background: none;\n      border: none;\n      font-size: 14px;\n      width:30px;\n   }\n   .dnd-drag-li-container {\n      display: block;\n      width: 100%;\n      height: auto;\n   }\n   .dnd-selected {\n      background: #f2f2f2;\n      padding: 4px;\n      margin-top: 3px;\n   }\n";c.setCss("pcw-sortable-dnd-list-style",f,"pcw-sortable-dnd-list-manager");var a=(function(i){__extends(h,i);function h(j){var k=i.call(this)||this;k._dragElementsObj=null;k._dragSrcEl=null;k._dndUlElem=null;k._dragElementsObj=j?j:{uiElem:null,selectedIndex:-1};return k}h.prototype.connectedCallback=function(){if(this._dragElementsObj&&this._dragElementsObj.uiElem){this._dndUlElem&&this._dndUlElem.parentElement.removeChild(this._dndUlElem);this.init()}};h.prototype.init=function(l){if(l){this._dragElementsObj=l}var n=this.getElementsByClassName("dnd-component-parent");if(n&&n.length===0){this._dndUlElem=document.createElement("ul");this._dndUlElem.classList.add("dnd-component-parent")}else{this._dndUlElem=n[0]}for(var j=0;j<this._dragElementsObj.uiElem.length;j++){var k=this._appendListContainer(this._dragElementsObj.uiElem[j]);this._dndUlElem.appendChild(k)}this.appendChild(this._dndUlElem);var m=this.querySelectorAll(".dnd-component-parent .dnd-draggable-row");for(var j=0;j<m.length;j++){if(!this._getReadOnly()){this._addDnDHandlers(m[j])}}};h.prototype._getReadOnly=function(){return this.hasAttribute("readonly")};h.prototype._getDelete=function(){return this.hasAttribute("delete")};h.prototype.setReadOnly=function(j){if(Boolean(j)){this.setAttribute("readonly","")}else{this.removeAttribute("readonly")}if(this._dragElementsObj.uiElem){this._dndUlElem&&this._dndUlElem.parentElement.removeChild(this._dndUlElem);this.init()}};h.prototype.setDelete=function(j){if(Boolean(j)){this.setAttribute("delete","")}else{this.removeAttribute("delete")}};h.prototype._handleDragStart=function(k,j){if(!this._getReadOnly()){this._dragSrcEl=j;k.dataTransfer.effectAllowed="move";j.classList.add("dnd-drag-elem")}};h.prototype._handleDragOver=function(k,j){k.preventDefault();if(!this._getReadOnly()){j.classList.add("dnd-over");k.dataTransfer.dropEffect="move"}return false};h.prototype._handleDragLeave=function(k,j){k.preventDefault();j.classList.remove("dnd-over")};h.prototype._handleDrop=function(m,l){m.preventDefault();m.stopImmediatePropagation();if(!this._getReadOnly()){if(this._dragSrcEl!=l){var j=l.parentElement;var o=null;var n=null;for(var k=0;k<j.childElementCount;k++){if(j.children[k].classList.contains("dnd-drag-elem")){n=k}else{if(j.children[k].classList.contains("dnd-over")){o=k}}}if(o!==null&&n!==null){l.parentElement.removeChild(this._dragSrcEl);this._dragElementsObj.uiElem.splice(o,0,this._dragElementsObj.uiElem.splice(n,1)[0]);this._dragSrcEl.classList.remove("dnd-drag-elem");if(o>n){l.insertAdjacentElement("afterend",this._dragSrcEl)}else{if(o<n){l.insertAdjacentElement("beforebegin",this._dragSrcEl)}}this._dragElementsObj.selectedIndex=o}}}l.classList.remove("dnd-over");l.classList.remove("dnd-drag-elem");return false};h.prototype._handleDragEnd=function(k,j){j.classList.remove("dnd-drag-elem")};h.prototype._addDnDHandlers=function(j){var k=this;j.addEventListener("dragstart",function(l){k._handleDragStart(l,j)},false);j.addEventListener("dragover",function(l){k._handleDragOver(l,j)},false);j.addEventListener("drop",function(l){k._handleDrop(l,j)},false);j.addEventListener("dragend",function(l){k._handleDragEnd(l,j)},false);j.addEventListener("dragleave",function(l){k._handleDragLeave(l,j)},false)};h.prototype._appendListContainer=function(p){var m=this;var k=p.ui;k.classList.add("dnd-body");var n=document.createElement("li");n.setAttribute("draggable","true");n.classList.add("dnd-draggable-row");var j=document.createElement("div");j.classList.add("dnd-drag-li-container");var q=document.createElement("span");q.classList.add("dnd-inline");q.classList.add("dnd-drag-icon");q.innerHTML='<i class= "wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot " ></i>';var o=document.createElement("span");o.classList.add("dnd-inline");o.classList.add("dnd-drag-list-content");o.appendChild(k);j.appendChild(q);j.appendChild(o);if(this._getDelete()){o.style.width="calc(100% - 45px)";var l=document.createElement("span");l.classList.add("dnd-inline");var r=b.createElement("button",{classList:"dnd-element-delete",html:'<i class= "wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash " ></i>'});if(this._getReadOnly()){r.setAttribute("disabled","")}else{b.setToolTip(r,{title:g["SortableDNDListMgr.tooltip.title"],shortHelp:g["SortableDNDListMgr.tooltip.deleteIcon"],position:"left"});r.addEventListener("click",function(s){m._removeElement(p)},false)}l.appendChild(r);j.appendChild(l)}else{o.style.width="calc(100% - 15px)"}n.appendChild(j);n.addEventListener("focus",function(s){m._setSelection(s,n)});n.addEventListener("click",function(s){m._setSelection(s,n)});return n};h.prototype._removeElement=function(j){var k=j.ui.parentElement.parentElement.parentElement;k.parentElement.removeChild(k);var l=this._dragElementsObj.uiElem.indexOf(j);this._dragElementsObj.uiElem.splice(l,1);if(this._dragElementsObj.selectedIndex===l){this._dragElementsObj.selectedIndex=-1}};h.prototype._setSelection=function(l,k){l.preventDefault();this._clearSelection();if(this._dndUlElem.contains(l.target)){this._dragElementsObj.selectedIndex=Array.prototype.slice.call(this._dndUlElem.children).indexOf(k)}else{this._dragElementsObj.selectedIndex=-1}var j=this._dragElementsObj.selectedIndex;if(j!==-1&&this._dragElementsObj.uiElem[j]&&!this._dragElementsObj.uiElem[j].ui.parentElement.parentElement.parentElement.classList.contains("dnd-selected")){this._dragElementsObj.uiElem[j].ui.parentElement.parentElement.parentElement.classList.add("dnd-selected")}this.dispatchEvent(new CustomEvent("pcw-dnd-row-selected",{detail:{elem:k}}))};h.prototype._clearSelection=function(){var j=this.querySelectorAll("pcw-sortable-dnd-list-manager ul li.dnd-selected");if(j){for(var k=0;k<j.length;k++){j[k].classList.remove("dnd-selected")}}};return h}(HTMLElement));window.customElements.define("pcw-sortable-dnd-list-manager",a);return a});
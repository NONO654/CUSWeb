define("DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsNewCaseDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/LineEditor"],function(e,d,c,a){var b={showDialog:function(f){return new Promise(function(k,j){var g="",i=false;var h=function(){var p=new e.Element("div",{id:"ra-copy-case"});var n=new e.Element("div",{"class":"ra-copy-dialog-title",text:f.label,style:{width:"100%"}});var q=new e.Element("div",{"class":"ra-copy-dialog-content"});n.inject(p);var o=new a({placeholder:f.placeHolder?f.placeHolder:"",requiredFlag:true,escapeHTML:true,value:f.value?f.value:""}).inject(q);o.addEventListener("change",function(){g=o.value;i=true});var m=q.getChildren()[0].getChildren()[0];m.addClassName("ra-copy-dialog-content");q.inject(p);return p};var l=new d({title:f.header,content:h(),minWidth:100,modalFlag:true,immersiveFrame:f.immersiveFrame,usePaddingFlag:true,buttons:{Cancel:new c({onClick:function(o){var m=o.dsModel;var n=m.dialog;n.close();j()}}),Ok:new c({disabled:false,label:f.okButtonLabel,onClick:function(o){var m=o.dsModel,n=m.dialog;var p="";if(i){p=g}else{p=f.value}if(e.is(p)&&p.length>0){n.close();k(p)}}})}})})}};return b});define("SMAAnalyticsWidget/SMAAnalyticsSetupDataProvider",[],function(){function d(g){g=JSON.parse(g);var h=g.inputs;var f={};h.forEach(function(i){f[i.ID]=(i.max+i.min)/2});return f}function e(f,g){this.executeSupport("getApproximationParameters",{approxId:f.approxId,commandGroup:"approximation"},function(h){g(d(h))})}function c(g,i){var h={commandGroup:"approximation",evalType:"matrix",approxId:g.approxId,baselinePoint:JSON.stringify(g.data.baselinePoint),sweepValues:{},paramIds:JSON.stringify([g.data.param1.id,g.data.param2.id])};h.sweepValues[g.data.param1.id]=g.data.param1.values;h.sweepValues[g.data.param2.id]=g.data.param2.values;var f=function(j){i(JSON.parse(j)[g.approxId])};this.executeSupport("evaluateApproximations",h,f)}function a(m,k,j,l){k=k||{};var g=this.serverURL+"executeCommand?commandName="+m;g=this.appendRequestIDs(g,j,l);var i;var f=Object.keys(k);if(typeof k!=="undefined"){for(var h in k){if(k.hasOwnProperty(h)){i=typeof k[h]==="string"?encodeURIComponent(k[h]):encodeURIComponent(JSON.stringify(k[h]));g+="&"+h+"="+i}}}return{url:g,dataString:i}}function b(f){var g={getApproximationParameters:true,getCreatedApproximations:true,getParameterHierarchyAsJson:true,getCorrelationDataAsJson:true,getReliabilityDataAsJson:true};f.setDefaultRequest(function(m,j,l,i,k){if(typeof j==="function"){l=j;j={}}if(typeof l!=="function"){l=function(){}}j=j||{};var h;if(typeof g[m]==="undefined"){h=this.getPostURL(m,j,i,k)}else{h=a.call(this,m,j,i,k)}this.makeHTTPPostRequest(h.url,h.dataString,l)});f.registerSupport("getBaselinePoint",e);f.registerSupport("evaluateApproximation",c)}return b});define("DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsConfirmDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button"],function(d,b,a){var c={showDialog:function(e){return new Promise(function(i,h){var g=function(j){var k=d.createElement("div",{id:"ra-confirm-dialog",text:j.label});return k};var f=new b({title:e.header,content:g(e),minWidth:400,minHeight:100,resizableFlag:false,modalFlag:true,immersiveFrame:e.immersiveFrame,usePaddingFlag:true,buttons:{Ok:new a({onClick:function(l){var j=l.dsModel;var k=j.dialog;k.close();i()}}),Cancel:new a({onClick:function(l){var j=l.dsModel;var k=j.dialog;k.close();h()}}),}})}.bind(this))}};return c});define("DS/SMAAnalyticsWidget/SMAAnalyticsWidgetInit",["UWA/Core","UWA/Promise","DS/UIKIT/Mask","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLoadModule"],function(h,j,e,a){var d=false;var p=false;var i=true;var b=false;var g=false;var l=false;var c=null;var o=function(q){if(!c){c={onBackArrowClick:q.onBackArrowClick,onViewChange:q.onViewChange,onResize:function(){widget.setValue("lastviewsize",widget.getView().type)},onRefresh:function(){if(i===true){q.onRefresh(window.widget._frameWnd.getUIFrame())}},onEdit:function(){if(!l){g=false;b=false}if(b){b=false}else{b=true;if(!p){a.refreshStations().then(function(){if(!g){l=true;p=true;window.widget.dispatchEvent("onEdit")}},function(){console.warn("Failed to refresh station list")})}}},endEdit:function(){g=true;l=false;p=false}};if(q){window.widget.addEvents(c)}}};var f=function(q){return new j(function(s,r){require(["UWA/String","DS/W3DXComponents/Views/Temp/TempHandlebars","DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils","DS/SMAAnalyticsLauncher/SMAAnalyticsServantCache","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLaunchModule"],function(y,x,w,A,z,t){try{w.loadRAWidgetAsset();window.widget._ra_translator=w;t.setMCSUri(q.serverUrl);t.setFrameWindow(window.widget._frameWnd);t.loadEED();x.registerHelper("raTranslate",function(B){return window.widget._ra_translator.translate(B)});x.registerHelper("raSanitize",function(B){if(h.is(B,"string")&&B.length>0){if(!isNaN(parseFloat(B))){return B}else{if(y.escapeHTML(B)===B){return B}return""}}else{if(h.is(B,"number")){return B}}return""});z.set3DSpaceURL(q.serverUrl);z.setCSRF(q.csrf);z.setTranslator(window.widget._ra_translator);A.refreshAll()["finally"](s)}catch(v){var u=new Error(w.translate("ERROR_LOAD_SOURCE"));u.originalError=v;r(u)}},function(t){var u=new Error("Error loading the widget prerequisites...");u.originalError=t;r(u)})})};var k=function(){return new j(function(r,q){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(s){s.getPlatformServices({onComplete:function(t){window._platformServices=t;r()},onFailure:function(){r()}})})})};var n=function(){return new j(function(r,q){require(["SMAAnalyticsWidget/SMAAnalyticsWidgetSkeleton"],function(v){var u=window.widget._frameWnd.getUIFrame();u.addEventListener("launchRA",function(w){v.bones.setRoute("/analyticscases/"+w.detail.caseId+"?f=3")});v.onLoad(u);var t=window.widget.data;var s;if(t){s=t.caseId}o(v);if(s&&s.length>0){v.bones.setRoute("/analyticscases/"+s+"?f=0")}r()},function(s){var t=new Error(window.widget._ra_translator.translate("ERROR_LOAD_SKELETON"));t.originalError=s;q(t)})})};var m=function(){return new j(function(r,q){a.loadServerPrereqs().then(f).then(n).then(k).then(r,q)["catch"](q)})};return{load:m,notifs:a.notifs}});define("SMAAnalyticsWidget/SMAAnalyticsCustomPageTree",["UWA/Core","DS/Core/Core","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tree/TreeNodeView"],function(e,d,b,a){var c=function(f){if(typeof f==="undefined"){f={}}this.expandedNodesMap={};this.treeDocument=f.treeDocument||new a();f.treeDocument=this.treeDocument;f.apiVersion=2;f.onDragStartCell=function(h,g){this.onDragStartCell(h,g)}.bind(this);f.onDragEndCell=function(h,g){this.onDragEndCell(h,g)}.bind(this);f.height="auto";f.expanderStyle="triangle";f.show=f.show||{rowHeaders:false,columnHeaders:false};this.renderFunction=f.renderFunction||"colorShapeMapToElement";f.columns=f.columns||[{dataIndex:"tree",width:"auto"},{dataIndex:"filter",width:22,onCellRequest:function(g){this["filterMapToElement"](g)}.bind(this)},{dataIndex:"colorShapeMap",width:50,onCellRequest:function(g){this[this.renderFunction](g)}.bind(this)}];this.tree=new b(f)};c.prototype.onExpand=function(f){this.expandedNodesMap[f]=true};c.prototype.onCollapse=function(f){delete this.expandedNodesMap[f]};c.prototype.onDragStartCell=function(j,i){var h=i.nodeModel.options.data,g=j.target;try{window.DS.RAComponents.droptarget.setDragStartData(h);window.DS.RAComponents.chartdroptarget.setDragStartData(h);window.DS.RAComponents.gridcontainer.setDragStartData(h)}catch(f){console.warn("Error setting dragstart data",j)}if(typeof j.dataTransfer.setDragImage==="function"){j.dataTransfer.setDragImage(g,0,0)}j.dataTransfer.setData("text",JSON.stringify(h))};c.prototype.onDragEndCell=function(){try{window.DS.RAComponents.droptarget.clearDragData();window.DS.RAComponents.chartdroptarget.clearDragData();window.DS.RAComponents.gridcontainer.clearDragData()}catch(f){console.warn("Error clearing dragstart data",f)}};c.prototype.data=function(f){if(typeof f!=="undefined"){this._data=f;this.initializeData()}else{return this._data}return this};c.prototype.initializeData=function(){console.log("WARNING! Initialization not defined on custom page tree.")};c.prototype.rootElement=function(f){if(typeof f!=="undefined"){this.root=f;this.tree.inject(this.root)}else{return this.root}return this};return c});define("SMAAnalyticsWidget/SMAAnalyticsWidgetProxy",["UWA/Core","UWA/Utils","UWA/Class","UWA/String","UWA/Class/Promise","DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData","DS/UIKIT/Mask","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLaunchModule","DS/Usage/TrackerAPI","DS/Usage/UsageManager"],function(e,j,b,f,l,n,m,c,g,k,a,i,d){var h=b.extend({serverURL:"",activeCollabSpace:"",ADVISE_SERVICE_LOC:"/resources/slmservices/advise/",BPS_SERVICE_LOC:"/resources/bps/",FCS_CHECKOUT_LOC:"/servlet/fcs/checkout",FCS_COMMIT_LOC:"/resources/slmservices/fcs/commit",FCS_TICKET_LOC:"/resources/slmservices/fcs/ticket",ENO_LIFECYCLE_LOC:"/resources/lifecycle/",PNO_PERSON_LOC:"/resources/modeler/pno/person/",PASSPORT_AS_PROXY:"passport",EED_URL:"",EED_TICKET:"",_dsallowed:["Simulation","Document","Simulation Document - Versioned","Simulation Document - NonVersioned","Simulation Job","DesignSight","VPMReference"],_extensions:".zrf, .nrf, .3dxml, .stp, .stpz, .jpg, .jpeg, .png, .gif, .tif, .tiff, .bmp, .flv , .avi , .mov , .wmv , .mpg , .mpeg , .mp4 , .m4v , .rm , .webm , .mkv , .mp3 , .wav , .aac , .m4a , .wma , .ra , .ogg , .doc , .docx , .ppt , .pptx , .pps , .ppsx , .xls , .xlsx , .xlsm , .pdf , .zip , .txt , .csv .tsv",_translator:null,_notificationManager:null,_csrf_header_name:"ENO_CSRF_TOKEN",_csrf_token:"",_skeleton:null,_PLATFORM_PREFERENCE_KEY:"platform",EED_RUN_AS:false,RA_RUN_AS:false,getPlatformId:function(){return widget.getValue(this._PLATFORM_PREFERENCE_KEY)},set3DSpaceURL:function(o){if(this.isNotEmpty(o,true)&&j.isValidUrl(o)){this.serverURL=o}},get3DSpaceURL:function(){if(!this.isNotEmpty(this.serverURL,true)){var o=document.querySelector("#spDashboard");if(typeof o!=="undefined"&&o!==null){this.serverURL=o.getMcsUri()}}return this.serverURL},setCSRF:function(o){if(e.is(o)){if(e.is(o.header,"string")&&o.header.length>0){this._csrf_header_name=o.header}if(e.is(o.token,"string")&&o.token.length>0){this._csrf_token=o.token}}},textSanitize:function(p,o){var q=/[.'"#$@%*,?\\<>[\]|:]/;p=p.trim();if(e.is(p,"string")&&p.length>0){if(e.is(o)&&q.test(p)){return""}if(!isNaN(parseFloat(p))){return p}else{if(f.escapeHTML(p)===p){return p}return""}}else{if(e.is(p,"number")){return p}}return""},isSaveAuthorised:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"checkUserAuthForSave?caseOID=";o=o||"";p+=o;return q.uwaDataRequest_GET({url:p,type:"text"})},_doSave:function(p,o,q){return new l(function(u,t){var s=function(v,w){return new l(function(y,x){a.saveCaseInServant(v,w).then(y,x)}.bind(this))};var r=[];if(e.is(q)&&e.is(q.activeViews)&&q.activeViews.size>0){q.activeViews.forEach(function(v){v.dispatchEvent("onSaveCaseClick",{eventType:"save"});if(typeof v._servantSavePreProcessorPromise==="function"){r.push(v._servantSavePreProcessorPromise())}},this);if(r.length===0){s(p).then(u,t)}else{l.all(r).then(function(w){var v;if(Array.isArray(w)){v=w[0]}s(p,v).then(u,function(x){console.warn("Failure saving the case data in the servant",x);t(x)})}.bind(this),function(v){console.warn("Failed to trigger the servant save due to save preprocessor failure",v);t(v)}.bind(this))}}else{s(p).then(u,t)}}.bind(this))},saveCaseHandler:function(p,s){var o=s.getActiveIdCard().model.id;var r=widget._frameWnd.getUIFrame();var q=function(){if(c.isMasked(r)){c.unmask(r)}};if(!this.ifBlockActionClick(s,"save")){c.mask(r,this.translate("SAVING"));this.isSaveAuthorised(o).then(function(){this._doSave(o,p,s).then(this.showSuccessNotification.bind(this,"",this.translate("SAVE_SUCCESS")),this.showErrorNotification.bind(this,"",this.translate("SAVE_ERROR")))["catch"](this.showErrorNotification.bind(this,"",this.translate("SAVE_ERROR")))["finally"](q)}.bind(this),function(){q();this.showErrorNotification("",this.translate("SAVE_UNAUTH_ERROR"))}.bind(this))["catch"](function(){q();this.showErrorNotification("",this.translate("SAVE_UNAUTH_ERROR"))})}},setSkeleton:function(o){if(e.is(o)){this._skeleton=o}},getSkeleton:function(){return this._skeleton},_initNotifManager:function(){this._notificationManager=g;k.setNotificationManager(this._notificationManager);k.setFadeOutPolicy(1);k.setStackingPolicy(0)},showErrorNotification:function(r,p,o){if(!e.is(this._notificationManager)){this._initNotifManager()}var q={level:"error",sticky:false};q.title=e.is(r,"string")?r:"";q.message=e.is(p,"string")?p:this._translator.translate("RA_ERROR");if(e.is(o,"string")&&o.length>0){q.category=o}this._notificationManager.addNotif(q)},showWarningNotification:function(r,p,o){if(e.is(p,"string")&&p.length>0){if(!e.is(this._notificationManager)){this._initNotifManager()}var q={level:"warning",sticky:false};q.title=e.is(r,"string")?r:"";q.message=e.is(p,"string")?p:this._translator.translate("RA_ERROR");if(e.is(o,"string")&&o.length>0){q.category=o}this._notificationManager.addNotif(q)}},showInfoNotification:function(r,p,o){if(!e.is(this._notificationManager)){this._initNotifManager()}var q={level:"info",sticky:false};q.title=e.is(r,"string")?r:"";q.message=e.is(p,"string")?p:"";if(e.is(o,"string")&&o.length>0){q.category=o}this._notificationManager.addNotif(q)},showSuccessNotification:function(r,p,o){if(!e.is(this._notificationManager)){this._initNotifManager()}var q={level:"success",sticky:false};q.title=e.is(r,"string")?r:"";q.message=e.is(p,"string")?p:"";if(e.is(o,"string")&&o.length>0){q.category=o}this._notificationManager.addNotif(q)},toggleServantActionsInSkeleton:function(r,v,w){if(typeof r==="undefined"||r===null){return}var t=["save"].concat(w&&Array.isArray(w)?w:[]),q=r.getActiveIdCard(),o=q.options.actions;if(q&&Array.isArray(o)&&o.length>0){var w=q.elements.actionsSection.querySelector(".actions-list");if(w){var p=w.querySelectorAll("span.fonticon");if(p&&p.length>0){var x=o.filter(function(z){return t.indexOf(z.name)>-1}).map(function(z){return z.icon});var B=[];for(var u=0;u<p.length;u++){var A=p[u];for(var s=0;s<A.classList.length;s++){var y=A.classList[s];if(x.filter(function(z){return y.indexOf(z)>-1},this).length>0){B.push(A)}}}B.forEach(function(z){if(v){z.parentElement.classList.remove("idc-disabled")}else{z.parentElement.classList.add("idc-disabled")}},this)}}}},ifBlockActionClick:function(s,v){if(typeof s==="undefined"||s===null){return true}var r=true,p=s.getActiveIdCard(),o=p.options.actions||[],w;if(p){for(var t=0;t<o.length;t++){if(v===o[t].name){w=t;break}}var u=p.elements.actionsSection.querySelector(".actions-list");if(u){var q=u.querySelectorAll("span.fonticon")||[];if(q&&typeof q[w]!==undefined){r=q[w].parentElement.classList.contains("idc-disabled")}}}return r},getCSRFToken:function(o){return new l(function(q,p){if(e.is(o,"boolean")&&o===true){this._csrf_token=""}if(this._csrf_token.length>0){q(this._csrf_token)}else{m.authenticatedRequest(this.serverURL+"/resources/slmservices/token/CSRF",{type:"text",method:"GET",onComplete:function(r){this._csrf_token=r;q(r)}.bind(this),onFailure:p})}}.bind(this))},overrideProxyMethod:function(p,o){this[p]=o},setTranslator:function(o){if(typeof o!=="undefined"&&o!==null){this._translator=o}},translate:function(o,p){if(this._translator!==null){return this._translator.translate(o,p)}},htmlUnescape:function(o){return String(o).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},getModifiedInterval:function(s){try{var q=new Date(s),p=Date.now(),o=(p-q)/1000;var t=Math.round(o/86400);if(t==1){return(t.toString()+" "+this.translate("DAY_AGO"))}else{if(t>=1){return(t.toString()+" "+this.translate("DAYS_AGO"))}else{if((t=Math.round(o/3600))==1){return t.toString()+" "+this.translate("HR_AGO")}else{if((t=Math.round(o/3600))>=1){return(t.toString()+" "+this.translate("HRS_AGO"))}else{if((t=Math.round(o/60))==1){return(t.toString()+" "+this.translate("MIN_AGO"))}else{if((t=Math.round(o/60))>=1){return(t.toString()+" "+this.translate("MINS_AGO"))}else{return(t.toString()+" "+this.translate("SECS_AGO"))}}}}}}}catch(r){return"1"+this.translate("SECS_AGO")}},getFormattedDate:function(o){var p=new Date(o);return p.toDateString()+" "+p.toLocaleTimeString()},checkExtension:function(o){return(this._extensions.indexOf(this.getExtension(o))!==-1)},isValidDStype:function(o){return this._dsallowed.indexOf(o)>-1},isNotEmpty:function(p,o){if(typeof p!=="undefined"&&p!==null){if(o){return p.length>0}return true}else{return false}},uwaDataRequest_GET:function(s){var v=this;if(!s){return}var p=s.url||"",t=s.params||{},r=s.headers||{},u=s.data||{},z=s.type||"json",x=s.timeout,o=s.cache||-1,w=!(typeof s.authenticatedRequest!=="undefined"&&s.authenticatedRequest===false);if(!r.hasOwnProperty("Accept")){r.Accept="*/*, application/json"}for(var y in t){if(t.hasOwnProperty(y)){u[y]=t[y]}}if(p.indexOf("?")>-1){p+="&"}else{p+="?"}p+="SecurityContext="+encodeURIComponent(v.getMyCollabSpace());var q=(w===true)?m.authenticatedRequest:m.request;return new l(function(B,A){var C={type:z,method:"GET",allowCrossOriginRequest:true,cache:o,onComplete:B,onFailure:A};if(r){C.headers=r}if(u){C.data=u}if(x){C.timeout=x}q(p,C)})},uwaDataRequest_POST:function(s){var v=this;if(!s){return}var p=s.url||"",t=s.params||{},r=s.headers||{},u=s.data||{},A=s.type||"json",x=s.timeout,B=s.addSecContext,o="",w=!(typeof s.authenticatedRequest!=="undefined"&&s.authenticatedRequest===false);if(!r.hasOwnProperty("Accept")){r.Accept="*/*, application/json"}for(var z in t){if(t.hasOwnProperty(z)){o+=z+"="+t[z]+"&"}}if(o.length>1){p+=o.substring(0,o.length-1)}var q=(w===true)?m.authenticatedRequest:m.request;var y=true;return new l(function(F,E){var C=function(I,J,H){F(I)};var D=function(H){if(y){y=false;if(e.is(H)&&e.is(H.message,"string")&&H.message.indexOf('ResponseCode with value "401"')>-1){v.getCSRFToken(true).then(function(I){G.headers[this._csrf_header_name]=I;q(p,G)},E)}else{E(H)}}else{E(H)}};var G={type:A,method:"POST",allowCrossOriginRequest:true,onComplete:C.bind(this),onFailure:D.bind(this)};G.headers=r;if(!r.hasOwnProperty("SecurityContext")){G.headers.SecurityContext=v.getMyCollabSpace()}G.data=u;G.data.SecurityContext=G.headers.SecurityContext;if(A==="json"){G.data=JSON.stringify(G.data)}if(x){G.timeout=x}v.getCSRFToken().then(function(){G.headers[this._csrf_header_name]=this._csrf_token;q(p,G)}.bind(v),E)}.bind(v))},uwaDataRequest_PUT:function(s){var v=this;if(!s){return}var p=s.url||"",t=s.params||{},r=s.headers||{},u=s.data,A=s.type||"json",x=s.timeout,o="",w=!(typeof s.authenticatedRequest!=="undefined"&&s.authenticatedRequest===false);for(var z in t){if(t.hasOwnProperty(z)){u[z]=t[z]}}if(o.length>1){p+=o.substring(0,o.length-1)}var q=(w===true)?m.authenticatedRequest:m.request;var y=true;return new l(function(E,D){var B=function(H,I,G){E(H)};var C=function(G){if(y){y=false;if(e.is(G)&&e.is(G.message,"string")&&G.message.indexOf('ResponseCode with value "401"')>-1){v.getCSRFToken(true).then(function(H){F.headers[this._csrf_header_name]=H;q(p,F)},D)}else{D(G)}}else{D(G)}};var F={type:A,method:"PUT",allowCrossOriginRequest:true,onComplete:B.bind(this),onFailure:C.bind(this)};r.SecurityContext=v.getMyCollabSpace();F.headers=r;if(u){F.data=u;if(A==="json"){F.data=JSON.stringify(F.data)}}if(x){F.timeout=x}v.getCSRFToken().then(function(){F.headers[this._csrf_header_name]=this._csrf_token;q(p,F)}.bind(v),D)}.bind(v))},getMyCollabSpace:function(){return widget.getValue("collabspaces")},getPreferenceCollabSpace:function(){return widget.getValue("createcollabspaces")},getCaseList:function(){var p=this,o=p.serverURL+p.ADVISE_SERVICE_LOC+"listAnalyticsCases";return p.uwaDataRequest_GET({url:o})},removeDatasetsFromAnalyticsCase:function(o,p){var r=this,q=r.serverURL+r.ADVISE_SERVICE_LOC+"removeFromAnalyticsCase";return r.uwaDataRequest_POST({url:q,type:"text",data:{caseid:o,objectids:p}})},getParametersList:function(p){var q=this,o=q.serverURL+q.ADVISE_SERVICE_LOC+"getAllParametersForRequirement";p=p||"";return q.uwaDataRequest_GET({url:o,params:{requirements:p}})},getConnectedRequirementsList:function(o,q){var r=this,p=r.serverURL+r.ADVISE_SERVICE_LOC+"listAnalyticsRequirements";o=o||"";return r.uwaDataRequest_GET({url:p,params:{caseid:o,exported:q}})},getConnectedDecisions:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"getConnectedDecisions";o=o||"";return q.uwaDataRequest_GET({url:p,params:{caseid:o}})},getConnectedDatasets:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"listDataSets";o=o||"";return q.uwaDataRequest_GET({url:p,params:{caseid:o}})},listCaseFiles:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"listCaseFiles";o=o||"";return q.uwaDataRequest_GET({url:p,params:{caseid:o}})},monitorBulletinBoardForTopic:function(r,o,p){var q=this;return q.uwaDataRequest_GET({url:q.EED_URL+"/job/"+r+"/monitor",authenticatedRequest:false,data:{Topic:o,TimeStamp:0},headers:{EEDTicket:p,Credentials:""},type:"xml"})},getAllSecurityContexts:function(){var p=this,o=p.serverURL+p.BPS_SERVICE_LOC+"cspaces";return p.uwaDataRequest_GET({url:o})},getEEDInfo:function(){var p=this,o=p.serverURL+p.ADVISE_SERVICE_LOC+"getEEDInfo";return p.uwaDataRequest_GET({url:o})},getEEDRunAsStatus:function(){var p=this,o={url:p.EED_URL+"/admin/runAsEnabled",headers:{EEDTicket:p.EED_TICKET},authenticatedRequest:false};return p.uwaDataRequest_GET(o)},createSecurityContextPreference:function(p){var q={name:"collabspaces",type:"list",label:"Collaborative Space",options:[],defaultValue:null};if(Array.isArray(p.cspaces)){p=p.cspaces;for(var o=0;o<p.length;o++){q.options.push({value:p[o].name,label:p[o].displayName})}q.defaultValue=p[0].name;widget.addPreference(q)}},isARunAsStation:function(q){var o=(q.GeneralInfo["@disableRunAs"]||"").toUpperCase(),p=false;if(o.length===0){p=true}else{if(o==="DEFAULT"||o==="ENABLED"){p=true}else{if(o==="DISABLED"||o==="UNSECURED"){p=false}}}return p},createStationPreference:function(p){var t=this,r=[];if(typeof p==="string"){p=JSON.parse(p)}if(p&&p.StationList){var q=p.StationList.Station;r.push({value:"",label:""});r.push({value:"{localhost}",label:"{localhost}"});if(!Array.isArray(q)){q=[q]}for(var o=0;o<q.length;o++){var s=q[o];if(s&&s["@name"]&&s["@name"].length>0&&s.GeneralInfo&&s.GeneralInfo["@hostIP"]&&s.GeneralInfo["@hostIP"].length>3){if(t.RA_RUN_AS&&t.EED_RUN_AS){if(!t.isARunAsStation(s)){continue}}r.push({value:s["@name"],label:s["@name"]})}}}widget.addPreference({name:"stations",type:"list",label:"Stations",options:r,defaultValue:null})},getActiveStationsList:function(p){var r=this,q=p.eedUrl||"",o={url:q+"/admin/station/query",headers:{Accept:"application/json"},authenticatedRequest:false,data:{ActiveOnly:true,AllowedUser:n.getUser().login}};return r.uwaDataRequest_GET(o)},setAttributesToCase:function(o,q){if(!q){return null}var r=this,p=r.serverURL+r.ADVISE_SERVICE_LOC+"setCaseAttribute";return r.uwaDataRequest_POST({url:p,type:"text",data:{oid:o,attributes:JSON.stringify(q)}})},setSingleCaseAttribute:function(o,q,p){return this.uwaDataRequest_POST({url:this.serverURL+this.ADVISE_SERVICE_LOC+"setCaseAttribute",type:"text",data:{oid:o,attributeName:q,value:p}})},getCaseLaunchInfo:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"getAnalyticsLaunchInfo";return q.uwaDataRequest_GET({url:p,params:{caseID:o,mcsURI:encodeURIComponent(q.get3DSpaceURL())}})},createAnalyticsCaseObject:function(r,q){var s=this,o=s.serverURL+s.ADVISE_SERVICE_LOC+"createAnalyticsCaseObject",p={};if(s.isNotEmpty(q,true)){p.description=q}if(s.isNotEmpty(r,true)){p.title=r}return s.uwaDataRequest_POST({url:o,type:"text",timeout:60000,data:p,headers:{SecurityContext:s.getPreferenceCollabSpace()}})},downloadFile:function(r,t){var u=this,p=l.deferred();if(!u.isNotEmpty(r.ticket,true)||!u.isNotEmpty(r.fileExtension,true)){p.reject("Invalid / empty ticket for file download")}else{var o=r.url,q=new XMLHttpRequest(),s="__fcs__jobTicket="+r.ticket+"&__fcs__attachment=false";if(!u.isNotEmpty(o,true)){o=u.FCS_CHECKOUT_LOC}q.onload=function(x){if(q.readyState===4){if(q.status===200){var w=new Blob([this.response],{type:"application/"+r.fileExtension}),v=window.URL||window.webkitURL;if(t===true){p.resolve(w)}else{p.resolve(v.createObjectURL(w))}}else{p.reject()}}};q.open("POST",o,true);q.setRequestHeader("Cache-Control","no-cache");q.setRequestHeader("Content-type","application/x-www-form-urlencoded");q.responseType="arraybuffer";q.send(s)}return p.promise},triggerFileDownload:function(s,q,o,p){var r=this;if(!r.isNotEmpty(s,true)||!r.isNotEmpty(o,true)){console.warn("Invalid input parameters provided for file download")}r.getFCSTicket({action:"download",title:s,oId:o}).then(function(t){r.downloadFile({ticket:encodeURIComponent(t.ticket),fileExtension:q,url:t.fcsUrl},true).then(function(v){try{if(typeof window.navigator.msSaveOrOpenBlob==="undefined"){var u=p.createElement("a");p.body.appendChild(u);u.setAttribute("style","display: none");u.href=window.URL.createObjectURL(v);u.download=s;u.click()}else{window.navigator.msSaveOrOpenBlob(v,s)}}catch(w){console.warn("Error downloading file: "+s,[w])}},function(u){console.warn("Error downloading file: "+s,[u])})},function(t){console.warn("Error obtaining FCS download ticket",[t])})},getCaseInfo:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"caseInfo";o=o||"";return q.uwaDataRequest_GET({url:p,params:{oid:o},type:"xml"})},getBusinessObjectsInfo:function(p){var q=this,o=q.serverURL+q.ADVISE_SERVICE_LOC+"objectInfo";p=p||"";return q.uwaDataRequest_GET({url:o,params:{objectIds:p,SecurityContext:q.getMyCollabSpace()},type:"json"})},createDocumentObject:function(q){var r=this,o=r.serverURL+r.ADVISE_SERVICE_LOC+"createDocumentObjectForRA",p={};if(r.isNotEmpty(q,true)){p={title:q}}return r.uwaDataRequest_POST({url:o,type:"text",timeout:60000,data:p})},connectDatasetsToCase:function(o,u,r,t){var v=this,p=v.serverURL+v.ADVISE_SERVICE_LOC+"connectObjectsToAnalyticsCase",s={caseid:o,objectids:u},q=l.deferred();if(!v.isNotEmpty(o,true)){q.reject("No analytics case was provided.")}if(!v.isNotEmpty(u,true)){q.reject("No business objects to connect.")}if(r===true){s.relationship="relationship_AnalyticsRecommended"}v.uwaDataRequest_POST({url:p,type:"text",data:s,headers:{SecurityContext:e.is(t)&&t===true?v.getPreferenceCollabSpace():v.getMyCollabSpace()}}).then(function(w){q.resolve(w)},function(w){q.reject(w)});return q.promise},fcsCommit:function(o){var p=this;return p.uwaDataRequest_PUT({url:p.serverURL+p.FCS_COMMIT_LOC,data:o,type:"text"})},fcsCheckin:function(u,s){var t=this,p=new FormData(),w={},r=l.deferred(),o=e.extend(w,{csrfTokenName:this._csrf_header_name,noOfFiles:1,parentId:u.oId,objectId:u.oId,__fcs__jobTicket:s.ticket,fileName0:u.file.name,bfile0:u.file,"file-title":u.file.name,"file-description":u.file.name,format0:"generic",store:"STORE"});for(var v in o){p.append(v,o[v])}var q=new XMLHttpRequest();q.open("POST",s.fcsUrl);q.onreadystatechange=function(){if(q.readyState===4){if(q.status===200){r.resolve(q.responseText)}else{console.error("Error checking in the file to FCS.");r.reject(q.responseText)}}};q.send(p);return r.promise},getFCSTicket:function(p){var r=this,q="?",o=l.deferred();if(!r.isNotEmpty(p)){o.reject("Missing input data for FCS ticket.");return o.promise}p.SecurityContext=r.getMyCollabSpace();if(r.isNotEmpty(p.format,true)){p.fformat=p.format;delete p.format}if(r.isNotEmpty(p.title,true)){p.fname=p.title;delete p.title}if(r.isNotEmpty(p.oId,true)){p.oid=p.oId;delete p.oId}r.uwaDataRequest_GET({url:r.serverURL+r.FCS_TICKET_LOC,type:"text",params:p}).then(function(t){var s={};s.ticket=t.split("<Ticket>")[1].split("</Ticket>")[0];s.fcsUrl=t.split("<FcsUrl>")[1].split("</FcsUrl>")[0];o.resolve(s)},function(s){console.error("Error obtaining the FCS ticket",s);o.reject({})});return o.promise},uploadFileTo3DSpace:function(r){var s=this,q=l.deferred();if(!s.isNotEmpty(r)){q.reject("No files were identified for upload.");return q.promise}if(!s.isNotEmpty(r.oId,true)){q.reject("No object id found to connect the file to.");return q.promise}var p=function(t){console.error("File upload failed",t);q.reject(t)},o=function(t){console.log("File was committed successfully into the business object");q.resolve(t)};s.getFCSTicket({action:"checkin",format:"generic",store:"STORE",title:r.title,oId:r.oId}).then(function(t){s.fcsCheckin(r,t).then(function(u){s.fcsCommit(u).then(function(v){q.resolve(v)},p)},p)},p);return q.promise},_connectFileToSomething:function(o,p){return new l(function(r,q){this.uploadFileTo3DSpace({oId:p,title:o.name,file:o}).then(r,q)}.bind(this))},getEncryptedCredentials:function(o){var p=this;return p.uwaDataRequest_GET({url:o,type:"text",timeout:1000000000,headers:{Accept:"text/plain; charset=utf-8","Content-Type":"text/plain; charset=utf-8"}})},addView:function(o){if(this.views===undefined){this.views=[]}this.views.push(o)},removeView:function(o){if(this.views!==undefined){var p=this.views.indexOf(o);if(p>-1){this.views.splice(p,1)}}},_getApproximationsFromRequirement:function(o){return new l(function(q,p){this.uwaDataRequest_GET({url:this.serverURL+this.ADVISE_SERVICE_LOC+"/"+o+"/relatedObjects?objectTypes=type_Approximation&recurseLevel=1"}).then(function(r){if(!e.is(r)){p()}q(r[o]||[])},p.bind(this))}.bind(this))},handleX3DContent:function(){return new l(function(q,p){var s=widget.getValue("X3DContentId"),r="";if(!e.is(s)){p()}var o=e.is(s,"string")?JSON.parse(s):s;if(e.is(o)&&e.is(o.data)&&e.is(o.data.items)){r=o.data.items[0]}if(!e.is(r,"string")||r.length===0){p()}this.getBusinessObjectsInfo(r).then(function(t){if(!e.is(t)){p()}if(t.typename==="Analytics Case"){q({id:t.plmOID,oInfo:null})}else{if(t.typename==="Requirement"){this._getApproximationsFromRequirement(t.plmOID).then(function(u){this.createAnalyticsCaseObject("","").then(function(v){this.connectDatasetsToCase(v.caseid,t.plmOID+";"+u.objectId).then(function(w){},p)}.bind(this),p)}.bind(this),p)}}}.bind(this),p)}.bind(this))},saveViewStateInfo:function(p,o){console.log("Saving View "+p);if(this.serializedViewStateInfo===undefined){this.serializedViewStateInfo={}}this.serializedViewStateInfo[p]=o},restoreViewStateInfo:function(o){if(o!==null&&o!==""){this.serializedViewStateInfo=JSON.parse(o)}else{this.serializedViewStateInfo={}}console.log("Viewstate restoration complete!")},getViewStateInfo:function(o){if(this.serializedViewStateInfo===undefined){return}return this.serializedViewStateInfo[o]},saveCaseData:function(o){console.log("Received command to save case: "+o);this.views.forEach(function(p){if(typeof p.save==="function"){p.save()}},this);this.saveFileTo3DSpace(o,"ViewState.json",this.serializedViewStateInfo,"")},saveFileTo3DSpace:function(o,v,p,q){console.log("Received command to save file"+v+" for: "+o);var t=v;var u=new Blob([JSON.stringify(p)],{type:q});var s;try{s=new File([u],t)}catch(r){s=u;s.name=v}this.uploadFileTo3DSpace({oId:o,title:t,file:s}).then(function(){console.log(t+" upload successful")},function(){console.log(t+" upload failed")})},getFileFrom3DSpace:function(o,r,q){var p=this;return new l(function(t,s){p.getFCSTicket({action:"download",title:r,oId:o}).then(function(u){p.downloadFile({ticket:encodeURIComponent(u.ticket),fileExtension:q,url:u.fcsUrl},true).then(function(v){t(v)},function(v){s("Error downloading file: "+r+" :: "+v)})},function(u){s("Error downloading file: "+r+" :: "+u)})})},pingServant:function(o){return new l(function(s,r){if(!e.is(o)){r()}if(!j.isValidUrl(o.uri)||!e.is(o.caseId,"string")||!e.is(o.token,"string")||o.userId!==n.getUser().login){r()}var q=o.uri+"ping",p={method:"GET",cache:-1,headers:{"ra-from-user":o.userId,"X-CSRFToken":o.token},data:{caseID:o.caseId,_t:Date.now()},onComplete:s,onFailure:r,onError:r};m.request(q,p)})},getCaseHistory:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"getHistory";o=o||"";return q.uwaDataRequest_GET({url:p,params:{objectid:o},headers:{SecurityContext:q.getMyCollabSpace()}})},getConnectedAttrGroups:function(o){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"getAttributeGroups";o=o||"";return q.uwaDataRequest_GET({url:p,params:{caseid:o},headers:{SecurityContext:q.getMyCollabSpace()}})},connectAttrGroupsToCase:function(o,q){var s=this,p=s.serverURL+s.ADVISE_SERVICE_LOC+"connectAttributeGroups",r={caseid:o,attrgroupids:q};return s.uwaDataRequest_POST({url:p,timeout:60000,data:r,headers:{SecurityContext:s.getMyCollabSpace(),"Content-Type":"json"}})},disconnectAttrGroup:function(o,q){var s=this,p=s.serverURL+s.ADVISE_SERVICE_LOC+"disconnectAttributeGroup",r={caseid:o,attrgroupid:q};return s.uwaDataRequest_POST({url:p,timeout:60000,data:r,headers:{SecurityContext:s.getMyCollabSpace(),"Content-Type":"json"}})},getAttributes:function(o,r){var q=this,p=q.serverURL+q.ADVISE_SERVICE_LOC+"getAttributes";return q.uwaDataRequest_GET({url:p,params:{caseid:o,attributegroupid:r},headers:{SecurityContext:q.getMyCollabSpace()}})},deleteObjects:function(p){var r=this,o=r.serverURL+r.ADVISE_SERVICE_LOC+"deleteObjects",q={objectids:p};return r.uwaDataRequest_POST({url:o,timeout:60000,data:q,headers:{SecurityContext:r.getMyCollabSpace(),"Content-Type":"json"}})},copyCase:function(o,r){var s=this,p=s.serverURL+s.ADVISE_SERVICE_LOC+"copyAnalyticsCase",q={caseid:o,title:r};return s.uwaDataRequest_POST({url:p,timeout:60000,data:q,headers:{SecurityContext:s.getPreferenceCollabSpace(),"Content-Type":"json"}})},reviseCase:function(o){var r=this,p=r.serverURL+r.ENO_LIFECYCLE_LOC+"revise/major",q={data:[{physicalid:o}],folderid:null};return r.uwaDataRequest_POST({url:p,timeout:60000,data:q,headers:{SecurityContext:r.getMyCollabSpace(),"Content-Type":"json"}})},demoteCase:function(o){var r=this,p=r.serverURL+r.ADVISE_SERVICE_LOC+"demote",q={objectid:o};return r.uwaDataRequest_POST({url:p,timeout:60000,data:q,headers:{SecurityContext:r.getMyCollabSpace(),"Content-Type":"json"}})},promoteCase:function(o){var r=this,p=r.serverURL+r.ADVISE_SERVICE_LOC+"promote",q={objectid:o};return r.uwaDataRequest_POST({url:p,timeout:60000,data:q,headers:{SecurityContext:r.getMyCollabSpace(),"Content-Type":"json"}})},getObjIdFromPhyId:function(q){var r=this,o=r.serverURL+r.BPS_SERVICE_LOC+"PhyIdToObjId/phyIds",p={phyIds:[q]};return r.uwaDataRequest_POST({url:o,timeout:60000,data:p,headers:{SecurityContext:r.getMyCollabSpace(),"Content-Type":"json"}})},getFullNameFromTrigram:function(o){var q=this,p=q.serverURL+q.PNO_PERSON_LOC+o;return q.uwaDataRequest_GET({url:p,headers:{SecurityContext:q.getMyCollabSpace()}})},checkCaseForObjectIds:function(p){var r=this,o=r.serverURL+r.ADVISE_SERVICE_LOC+"checkCaseForObjectIds",q={objectids:p};return r.uwaDataRequest_POST({url:o,timeout:60000,data:q,headers:{SecurityContext:r.getMyCollabSpace(),"Content-Type":"json"}})},setAttributes:function(p){var q=this,o=q.serverURL+q.ADVISE_SERVICE_LOC+"setAttributes";return q.uwaDataRequest_POST({url:o,timeout:60000,data:p,headers:{SecurityContext:q.getMyCollabSpace(),"Content-Type":"json"}})},getImmersiveFrame:function(){var o=widget._frameWnd,p=o.getImmersiveFrame();p.inject(document.body);return p},reroute:function(o){var p=this;if(p._skeleton.getState()==="collapsed"&&o.indexOf("?")===-1){p._skeleton.setContractedLayout().then(function(){p._skeleton.setRoute(o)})}else{p._skeleton.setRoute(o)}},setUserSpecificSecCtx:function(v){function u(x,A){for(var z=0;z<x.length;z++){var y=A(x[z]);if(y){return x[z];break}}}var r=["ctx::VPLMProjectLeader","ctx::VPLMCreator","ctx::VPLMExperimenter"],p=(typeof v.model!=="undefined")?v.model.get("organization"):v.get("organization"),t=(typeof v.model!=="undefined")?v.model.get("project"):v.get("project"),o=widget.getPreference("createcollabspaces").options;var q=undefined;widget.setValue("collabspaces",decodeURI(widget.getValue("createcollabspaces")));for(var s=0;s<r.length;s++){var w=r[s]+"."+p+"."+t;q=u(o,function(x){return decodeURIComponent(x.value)===w});if(e.is(q)){break}}if(e.is(q)){widget.setValue("collabspaces",decodeURIComponent(q.value))}},});return h.prototype});define("DS/SMAAnalyticsWidget/views/SMAAnalyticsHistoryView",["UWA/Core","DS/Tree/TreeListView","i18n!DS/SMAAnalyticsNLS/assets/nls/SMAAnalyticsWidgetNLSfile","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel"],function(g,c,d,b,f){var e=function(h){return{height:"auto",enableDragAndDrop:false,isSortable:true,infiniteScrolling:true,enableKeyboardNavigation:true,defaultCellHeight:41,resize:{columns:true,rows:false},columns:[{text:d.HISTORY_ACTION,dataIndex:"Action",isEditable:false,isSortable:true,isDraggable:false,width:"15%"},{text:d.DESCRIPTION,dataIndex:"Description",isEditable:false,isSortable:false,width:"auto"},{text:d.HISTORY_USER,dataIndex:"User",isEditable:false,isSortable:true,isDraggable:false},{text:d.HISTORY_TIME,dataIndex:"Time",isEditable:false,isSortable:true,isDraggable:false,width:"20%"},{text:d.STATE,dataIndex:"State",isEditable:false,isSortable:true}],treeDocument:h}};var a={};a.render=function(l){var k=new b({useAsyncPreExpand:true});var j=[];if(l){l.forEach(function(n){var m=new f({label:n.Action,grid:n});k.addChild(m)})}var h=e(k);var i=new c(h);i.getManager().hideColumn(0);return i};return a});define("SMAAnalyticsWidget/SMAAnalyticsDataSetDetailView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView","text!SMAAnalyticsWidget/views/SMAAnalyticsWidgetDataSetDetailsView.html"],function(d,c,a){var b=c.extend({template:function(){return a},tagName:"div",className:"link-detail",model:null,init:function(e){if(e&&e.model){this.model=e.model}this._parent(arguments)},onRender:function(){}});return b});define("DS/SMAAnalyticsWidget/views/SMAAnalyticsApproximationView",["UWA/Core",],function(c,a){var b={};b.render=function(e,d){var f=c.createElement("ra-approximation-view",{approximation:e});return f};return b});define("SMAAnalyticsWidget/SMAAnalyticsItemView",["UWA/Core","W3DXViews/ItemViewTile"],function(c,b){var a=b.extend({tag:"div",className:"analytics-item",DOMEvents:{"click .analytics-item-container":"onClickCalled"},template:'            <div class="analytics-item-container">                <div class="body">                    <div class="analytics-item-icon" {{#if icon}}style="background-image: url({{icon}});"{{/if}}></div>                    <div class="analytics-item-title">{{title}}</div>                    <div class="analytics-item-name">{{name}}</div>                    <div class="analytics-item-owner">{{owner}}</div>                    <div class="analytics-item-subtitle">{{subtitle}}</div>                    <div class="analytics-item-content">{{content}}</div>                </div>                <div class="footer">                </div>            </div>        '});return a});define("SMAAnalyticsWidget/SMAAnalyticsParameterDetailView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView","text!SMAAnalyticsWidget/views/SMAAnalyticsWidgetParameterDetailsView.html"],function(d,c,a){var b=c.extend({template:function(){return a},tagName:"div",className:"link-detail",model:null,init:function(e){if(e&&e.model){this.model=e.model}this._parent(arguments)},onRender:function(){}});return b});define("DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsExecutionDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/Windows/ImmersiveFrame","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/Controls/ComboBox"],function(g,d,c,b,f,a){var e={showDialog:function(h){var j="",l=new b();l.inject(document.body);var i=function(){var o=new g.Element("div",{id:"ra-execution-dialog"});var n=new g.Element("div",{"class":"ra-copy-dialog-title",text:f.translate("EXEC_STATIONS"),style:{width:"100%"}});var p=new g.Element("div",{"class":"ra-copy-dialog-content"});n.inject(o);var q=new a({placeholder:f.translate("TITLE")}).inject(p);q.addEventListener("change",function(){j=q.value});var m=p.getChildren()[0];m.addClassName("ra-copy-dialog-content");p.inject(o);return o};var k=new d({title:f.translate("EXEC_CONFIG"),content:i(),minWidth:100,minHeight:400,modalFlag:true,immersiveFrame:l,usePaddingFlag:true,buttons:{Cancel:new c({onClick:function(o){var m=o.dsModel;var n=m.dialog;n.close()}}),Ok:new c({disabled:false,label:f.translate("SAVE_BUTTON"),onClick:function(p){var m=p.dsModel,o=widget._frameWnd.getUIFrame(),n=m.dialog;n.close()}},h)}},h)}};return e});define("SMAAnalyticsWidget/SMAAnalyticsListModel",["UWA/Core","UWA/Class/Model","DS/PlatformAPI/PlatformAPI","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(e,c,a,d){var b=c.extend({caseDescriptionType:0,title:"Results Analytics Cases",defaults:function(){var g,f;try{g=a.getUser();f=widget.getPreferences().length>0?widget.getPreferenceLabel("collabspaces"):""}catch(h){}return{id:"",physicalId:"",name:"",icon:"",title:"",subtitle:"",description:"",author:e.is(g)?g.firstName+" "+g.lastName:"",owner:e.is(g)?g.firstName+" "+g.lastName:"",date:"",content:name,project:f,image:d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png",lastComment:"",lastCommentAuthor:"",enoviaURL:window.enoviaURL,reqList:[],type:"",recommendedImage:d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png",running:false,revision:"",originated:""}},setCaseDescriptionType:function(f){this.set("caseDescriptionType",f)}});return b});define("DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCaseListViewUtils",["UWA/Core","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","SMAAnalyticsWidget/SMAAnalyticsListModel","DS/SMAAnalyticsLauncher/SMAAnalyticsServantCache","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLaunchModule","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsConfirmDialog","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsNewCaseDialog","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsCaseDialog","DS/Usage/TrackerAPI"],function(h,f,n,d,k,a,p,o,c,e,j){var m=function(r,q){return new Promise(function(t,s){p.getCaseInfo(r).then(function(v){try{var x=h.Json.xmlToJson(v).CaseInfo||{};x.id=r;var u=h.is(q)?q.collection:widget.__caseCollection__;if(!u){u=q.model.collection}t(u.addNewCaseModel(x))}catch(w){s()}},function(){s()})})};var l=function(){return new Promise(function(s,r){var q=widget.data.objectIds;if(q){g(q).then(s,r)}else{s()}})};var g=function(q){return new Promise(function(u,t){var s=[],r;if(q.indexOf("|")!==-1){s=q.split("|")}else{s.push(q)}if(s.length>0){p.checkCaseForObjectIds(s).then(function(v){var w=v.newCase;if(w){p.createAnalyticsCaseObject(v.newCaseName).then(function(z){var y=j.getCounter("RACreateAnalyticsCaseSuccess",{appID:"SIMREII_AP"});y.inc();var x=z;var A="";if(s.length===1){A=s[0]}else{s.forEach(function(B){A+=B+";"})}p.connectDatasetsToCase(x,A).then(function(){widget.data.caseID=x;u()},function(B){u()})},function(x){u()})}else{widget.data.caseID=v.caseId;u()}},function(v){u()})}})};function i(u){u=!h.is(u)?p.getSkeleton():u;if(u){try{var r=u.getRoute()||"",q=r.indexOf("f="),t=0;if(q>-1){t=parseInt(r.substring(q+2));if(t>0){p.reroute(r.substring(0,q)+"f=0")}else{throw {}}}else{throw {}}}catch(s){p.reroute("/analyticscases")}}}var b={};b.deleteAnalyticsCase=function(q,t){var s=p.translate("CASE_DELETE_MESSAGE");if(Array.isArray(q)){s=p.translate("CASES_DELETE_MESSAGE")}var r={immersiveFrame:p.getImmersiveFrame(),label:s,header:p.translate("ARE_YOU_SURE"),};o.showDialog(r).then(function(){var u=[],x=widget._frameWnd.getUIFrame();var w=widget.getValue("collabspaces"),v=n.getUser();if(Array.isArray(q)){p.setUserSpecificSecCtx(q[0]);q.forEach(function(y){if(w.indexOf(y.get("organization"))>=0){u.push(y.id)}else{p.showWarningNotification("",y.get("title")+" - "+p.translate("CASE_REM_FAIL_COLLAB"))}},q)}else{p.setUserSpecificSecCtx(q);if(w.indexOf(q.model.get("organization"))>=0){u.push(q.model.id)}else{p.showWarningNotification(q.model.get("title"),p.translate("CASE_REM_FAIL_COLLAB"))}}if(u.length>0){f.mask(x);u.forEach(function(y){var z=k.getCachedServantForCase(y);if(h.is(z)){a.stopServant(z).then(function(){p.showSuccessNotification("",p.translate("CLOSE_SUCCESS"))},function(A){})}});p.deleteObjects(u).then(function(A){var z=A.success;var C=A.error;if(z&&z.length>0){if(Array.isArray(q)){var D=q[0].collection;z.forEach(function(E){D.remove(E)},q);var y=D.pages*D.numResults;var B=D.pages*z.length;if(y-B>5){D.fetch()}if(C){p.showWarningNotification("",p.translate("FEW_CASE_REM_FAIL"))}else{p.showSuccessNotification("",p.translate("CASES_REM_SUCCESS"))}}else{q.model.collection.remove(z[0]);if(t){i(t)}p.showSuccessNotification("",p.translate("CASE_REM_SUCCESS"))}}else{p.showErrorNotification("",p.translate("CASE_REM_FAIL"))}f.unmask(x)},function(y){f.unmask(x);p.showErrorNotification("",p.translate("CASE_REM_FAIL"))})}})};b.copyCase=function(q){var s=q.model.get("title");var r={immersiveFrame:p.getImmersiveFrame(),header:p.translate("COPY_DIALOG")+s,okButtonLabel:p.translate("COPY"),value:s+"-"+p.translate("COPY")};c.showDialog(r).then(function(t){var u=widget._frameWnd.getUIFrame();f.mask(u);p.copyCase(q.model.id,t).then(function(x){var w=x.status;if(w==="failed"){f.unmask(u);p.showSuccessNotification("",p.translate("CASE_COPY_FAILED"))}else{var v=x.id;m(v,q).then(function(y){f.unmask(u);if(h.is(y)){p.reroute("/analyticscases/"+y.id+"/?f=0")}else{p.showErrorNotification(p.translate("CREATE_CASE_FAILED"))}},function(){f.unmask(u);p.showErrorNotification(p.translate("CREATE_CASE_FAILED"))});p.showSuccessNotification("",p.translate("CASE_COPY_SUCCESS"))}},function(v){f.unmask(u);p.showErrorNotification("",p.translate("CASE_COPY_FAILED"))})})};b.reviseCase=function(q){var r={immersiveFrame:p.getImmersiveFrame(),label:p.translate("CASE_REVISE_MESSAGE"),header:p.translate("ARE_YOU_SURE"),};p.setUserSpecificSecCtx(q);o.showDialog(r).then(function(){var s=widget._frameWnd.getUIFrame();f.mask(s);p.reviseCase(q.model.id).then(function(u){u=h.is(u,"string")?JSON.parse(u):u;var t=u.status;if(t==="failure"){f.unmask(s);var w=u.report[0].error||"";p.showErrorNotification("",p.translate("CASE_REVISE_FAIL")+w)}else{if(u.results[0]){var v=u.results[0].physicalid;p.getObjIdFromPhyId(v).then(function(y){var x=y.ObjIds[0];m(x,q).then(function(z){f.unmask(s);if(h.is(z)){p.reroute("/analyticscases/"+z.id+"/?f=0");p.showSuccessNotification("",p.translate("CASE_REVISE_SUCCESS"));q.model.set("icon",p.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconSmallHigherRevision.png");q.model.set("iconTitle",p.translate("HIGHER_REVISION_EXISTS"))}else{p.showErrorNotification("",p.translate("CASE_REVISE_FAIL"))}},function(){f.unmask(s);p.showErrorNotification("",p.translate("CASE_REVISE_FAIL"))}.bind(q))},function(){f.unmask(s);p.showErrorNotification("",p.translate("CASE_REVISE_FAIL"))}.bind(q))}}},function(t){f.unmask(s);p.showErrorNotification("",p.translate("CASE_REVISE_FAIL")+t)}.bind(q))}.bind(q))};b.launchRA=function(q){var r=new CustomEvent("launchRA",{detail:{caseId:q.model.id},bubbles:true});p.setUserSpecificSecCtx(q);q.container.dispatchEvent(r)};b.closeMultipleAnalyticsCase=function(r){var q=[];r.forEach(function(u){var t=u.id,w=u.get("title"),v=k.getCachedServantForCase(t);if(h.is(v)){q.push(t)}else{p.showWarningNotification(w,p.translate("CASE_NOT_RUNNING"))}});if(q.length>0){var s=widget._frameWnd.getUIFrame();f.mask(s);a.shutDownMultipleLaunchedCase(q).then(function(t){t.forEach(function(u){r.forEach(function(v){if(v.id===u){v.set("running",false)}})});f.unmask(s);p.showSuccessNotification("",p.translate("CLOSE_SUCCESS_MULTIPLE"))},function(t){f.unmask(s)},r)}};b.closeAnalyticsCase=function(r){var q=r.model.id,u=r.model.get("title"),s=r.model,t=k.getCachedServantForCase(q);if(h.is(t)){a.shutDownLaunchedCase(q).then(function(){s.set("running",false)},function(v){s.set("running",false)},s)}else{p.showWarningNotification(u,p.translate("CASE_NOT_RUNNING"))}};b.stopCase=function(r,t){var q=r.model.id,s=k.getCachedServantForCase(q);if(h.is(s)){a.shutDownLaunchedCase(q).then(function(){this.model.set("running",false);p.toggleServantActionsInSkeleton(this.bones,false);var u=widget._frameWnd.getContent().querySelector("#analytics-frame");if(h.is(u)){u.parentNode.removeChild(u)}t.activeViews.forEach(function(v){v.dispatchEvent("onCloseCaseClick",{eventType:"close"})});i(t)}.bind(this))}else{if(t){i(t)}else{p.showWarningNotification("",p.translate("CASE_NOT_RUNNING"))}}};b.createNewCase=function(r,t){if(h.is(t)){if(t.result){t=t.result}var u=[];for(var q in t){if(t.hasOwnProperty(q)){u.push(m.call(this,q,r))}}Promise.all(u).then(function(v){if(Array.isArray(v)&&h.is(v[0])){if(widget._joinexsession_){widget._joinexsession_===false;var w=p.getSkeleton();if(h.is(w)){p.reroute("/analyticscases/"+v[0].get("id")+"/?f=3&joinexsession=true")}}else{r.selectItemView(v[0])}}},function(){console.warn("Failed to update the case collection...")})}else{var s={immersiveFrame:p.getImmersiveFrame(),header:p.translate("CREATE_CASE"),okButtonLabel:p.translate("CREATE_CASE_BUTTON")};e.showDialog(s).then(function(v){var w=widget._frameWnd.getUIFrame();f.mask(w,p.translate("CREATING_CASE"));p.createAnalyticsCaseObject(v.title,v.description).then(function(y){var x=j.getCounter("RACreateAnalyticsCaseSuccess",{appID:"SIMREII_AP"});x.inc();if(h.is(y,"string")&&y.length>0){m(y,r).then(function(z){if(h.is(z)){if(h.is(r)){r.selectItemView(z)}else{p.reroute("/analyticscases/"+z.id+"/?f=0")}}else{p.showErrorNotification(p.translate("CREATE_CASE_FAILED"))}f.unmask(w)},function(){f.unmask(w);p.showErrorNotification(p.translate("CREATE_CASE_FAILED"))})}else{f.unmask(w);p.showErrorNotification(p.translate("CREATE_CASE_FAILED"))}},function(){f.unmask(w);p.showErrorNotification(p.translate("CREATE_CASE_FAILED"))})},function(){console.log("Case creation cancelled !!!")})}};b.collectionPreProcessing=function(){widget._RA_FIRST_TIME_LOADING_=true;return new Promise(function(r,q){var s=widget._frameWnd.getUIFrame();f.mask(s,p.translate("LOADING_ANALYTICS_CASE"));l().then(r,q)})};b.collectionPostProcessing=function(s){if(h.is(widget._RA_FIRST_TIME_LOADING_)&&widget._RA_FIRST_TIME_LOADING_){widget._RA_FIRST_TIME_LOADING_=false}else{return}var u=widget._frameWnd.getUIFrame();if(f.isMasked(u)){f.unmask(u)}var t={caseid:widget.data.sesscaseid,servanttoken:widget.data.sesstoken,eedjobid:widget.data.sessjobid,eedServer:widget.data.sesseed,eer:widget.data.sessstation};if(h.is(t.caseid)&&h.is(t.servanttoken)&&h.is(t.eedServer)&&h.is(t.eedjobid)){widget._joinexsession_=true;var r={};r[t.caseid]=[];b.createNewCase(s,r);widget._RA_}else{var q=widget.data.caseID||widget.getValue("lastactivecase");if(q){var r={};r[q]=[];b.createNewCase(s,r)}}};return b});define("SMAAnalyticsWidget/SMAAnalyticsCustomPageProxy",["UWA/Core","UWA/Class","UWA/Class/Promise","UWA/Utils","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/WebappsUtils/WebappsUtils","DS/SMAAnalyticsUtils/SMAAnalyticsParseUtils","DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils","text!SMAAnalyticsWidget/assets/AvailableCharts.json","text!SMAAnalyticsWidget/assets/UnAvailableCharts.json","text!SMAAnalyticsWidget/assets/ChartingCustomizations.json","text!SMAAnalyticsWidget/assets/InitialChartRequest.json"],function(f,a,g,d,m,c,e,b,j,i,k,l){function h(){}h.prototype._servantURL="";h.prototype._servantToken="";h.prototype._currentUser="";h.prototype.filters={};h.prototype.varGroup=null;h.prototype.rowNameMap=null;h.prototype.formulation=null;h.prototype.basketRecommended=[];h.prototype.setServantDetails=function(n){h.prototype._servantURL=n.uri;h.prototype._servantToken=n.token;h.prototype._currentUser=n.userId};h.prototype.syncWithServant=function(){var o=UWA.Promise.deferred();var n=h.prototype.getParameterHierarchy();var q=h.prototype.syncRowNameMap();var p=h.prototype.getFormulationData();UWA.Promise.all([n,q,p]).then(function(r){o.resolve(r)});return o.promise};h.prototype.setFiltersAndSync=function(q){var r=UWA.Promise.deferred();var p=[];if(!h.prototype.filters.display.paretoSeen){p.push({"@class":"LogicalCondition",type:"ROW_GRADE_EQUALS",rowGrade:"GRADE_PARETO"})}if(!h.prototype.filters.display.dominatedSeen){p.push({"@class":"LogicalCondition",type:"ROW_GRADE_EQUALS",rowGrade:"GRADE_DOMINATED"})}if(!h.prototype.filters.display.infeasibleSeen){p.push({"@class":"LogicalCondition",type:"ROW_GRADE_EQUALS",rowGrade:"GRADE_INFEASIBLE"})}if(!h.prototype.filters.display.excludedSeen){p.push({"@class":"LogicalCondition",type:"ROW_GRADE_EQUALS",rowGrade:"GRADE_EXCLUDED"})}var n=h.prototype.filters.paramFilters||[];n.forEach(function(s){p.push(s)});n=h.prototype.filters.rowTagFilters||[];n.forEach(function(s){p.push(s)});n=h.prototype.filters.dataSetFilters||[];n.forEach(function(s){if(!s.checked){p.push({"@class":"LogicalCondition",type:"ROW_TAG_VALUE_EQUALS",tagName:"DATA_SET",tagValue:s.alias})}});q=q||{};q.iaEventSource="filter";q.iaEventType=AdviseConstants.EVENT_TYPE_FILTER_CHANGED;var o="setExplorationFilterFromJson";h.prototype.executeCommand({commandName:o,data:{filter:JSON.stringify(p)}}).done(function(s){h.prototype.processFilters(s)}).fail(function(){r.reject()});return r.promise};h.prototype.executeCommand=function(o,t,u){if(o.data||o.commandName){t=o.data;o=o.commandName}var n=UWA.Promise.deferred();var s=h.prototype._servantURL+"executeCommand?commandName="+o;var r=s,p={cors:"cors",allowCrossOriginRequest:true,noProxy:"true",headers:{"ra-from-user":h.prototype._currentUser,"X-CSRFToken":h.prototype._servantToken},onComplete:function(v){n.resolve(v);if(u&&typeof u==="function"){u(v)}},onFailure:function(v){n.reject(t);if(u&&typeof u==="function"){u(v)}}};if(t&&Object.keys(t).length>0){p.data=t}var q=UWA.Ajax.request(r,p);return n.promise};h.prototype.getDataMaps=function(n){if(typeof h.prototype.dataMaps==="undefined"){h.prototype.getAvailableCharts(function(){n(h.prototype.dataMaps)})}else{n(h.prototype.dataMaps)}};h.prototype.getAvailableCharts=function(t){var n=localStorage.getItem("_CUSTOM_CHARTS_DEV_ON_")||false;var o=JSON.parse(j);if(n==="true"||n===true){var r=JSON.parse(i);for(var p in r){if(!r.hasOwnProperty(p)){continue}o[p]=r[p]}}var s={chartTemplates:o};var q=JSON.parse(k);h.prototype.data=s;if(typeof q!=="undefined"){h.prototype.dataMaps=q;h.prototype.data.dataMaps=q}if(typeof t==="function"){if(typeof s.chartTemplates!=="undefined"){t(s.chartTemplates)}else{t(s)}}};h.prototype.getInitialChartRequest=function(){var n=JSON.parse(l);return n};h.prototype.getServerFileUrl=function(n){var o=c.getWebappsBaseUrl();return o+n};h.prototype.getRowListInfo=function(p,o){o=o||{};var n=UWA.Promise.deferred();h.prototype.executeCommand({commandName:"getRowListInfoAsJson",data:{rowIdList:JSON.stringify(p)}}).done(function(q){o.content=e.getJSONFromResponse(q);n.resolve(o.content)});return n.promise};h.prototype.decodeVarGroupFields=function(){var o=function(q){try{q.displayName=decodeURIComponent(q.displayName);if(q.unit){q.unit=decodeURIComponent(q.unit)}if(q.notes){q.notes=decodeURIComponent(q.notes)}}catch(p){}};var n=function(r){var q;try{r.displayName=decodeURIComponent(r.displayName)}catch(p){}for(q=0;q<((r.groups&&r.groups.length)||0);q++){n(r.groups[q])}for(q=0;q<((r.parameters&&r.parameters.length)||0);q++){o(r.parameters[q])}};n(h.prototype.varGroup)};h.prototype.getParameterFiltersAndHierarchy=function(){var n=UWA.Promise.deferred();h.prototype.executeCommand({commandName:"getExplorationFilterAsJson"}).done(function(p){var o=e.getJSONFromResponse(p);o.forEach(function(q){if(q.priorityWeight){h.prototype.varGroup=q}});h.prototype.processFilters(o);h.prototype.decodeVarGroupFields();n.resolve(p)});return n.promise};h.prototype.getParameterHierarchy=function(){var n=UWA.Promise.deferred();h.prototype.executeCommand({commandName:"getParameterHierarchyAsJson"}).done(function(o){h.prototype.varGroup=e.getJSONFromResponse(o);h.prototype.decodeVarGroupFields();n.resolve(o)});return n.promise};h.prototype.syncRowNameMap=function(){var n=UWA.Promise.deferred();h.prototype.executeCommand({commandName:"getRowsWithNames"}).done(function(o){h.prototype.rowNameMap=e.getJSONFromResponse(o);n.resolve(h.prototype.rowNameMap)});return n.promise};h.prototype.setNameForRow=function(p,o){if(!p){return}if(o===null){o=""}var n=UWA.Promise.deferred();h.prototype.executeCommand({commandName:"setRowName",data:{rowId:p,rowName:o}}).done(function(q){h.prototype.rowNameMap=e.getJSONFromResponse(q);var r={};r.iaEventSource="setNameForRow";r.iaEventType=AdviseConstants.EVENT_TYPE_DATASET_CHANGED;h.prototype.propagateEvent(r);n.resolve(h.prototype.rowNameMap)});return n.promise};h.prototype.getNameForAlternative=function(p,n){var q=b.translate("Alternative")+" ";if(n){q=b.translate("Alt."," ")}if(h.prototype.rowNameMap){var o=h.prototype.rowNameMap[p];if(o&&o.length&&o.length>1){return q+" "+o}}return q+p};h.prototype.syncBasketFiles=function(){return proxy.getFilesForRowIDList(h.prototype.basket)};h.prototype.getConstraintBounds=function(n){var p=null;var o=null;if(!h.prototype.formulation){console.error("formulation is null!!");return[p,o]}if(!h.prototype.formulation.objectives){return[p,o]}h.prototype.formulation.constraints.forEach(function(q,r){if(r.parameterID===n){if(r.type==="LESS_THAN"){o=r.boundValue}if(r.type==="GREATER_THAN"){p=r.boundValue}if(p!==null&&o!==null){return false}}});return[p,o]};(h.prototype.getObjective=function(n,o){var p=null;if(!h.prototype.formulation){console.error("formulation is null!!");return null}if(!h.prototype.formulation.objectives){return null}h.prototype.formulation.objectives.forEach(function(r,q){if(q.parameterID===n){if(q.type==="MINIMIZE"||q.type==="MAXIMIZE"||q.type==="TARGET"){p={type:q.type,value:q.value||null};return false}}});if(p!==null){if(typeof o!=="undefined"&&o===true){return p}else{return p.type}}else{return p}}),(h.prototype.getFormulationData=function(){var n=UWA.Promise.deferred();h.prototype.executeCommand({commandName:"getFormulationAsJson"}).done(function(o){h.prototype.formulation=e.getJSONFromResponse(o);n.resolve(h.prototype.formulation)});return n.promise}),(h.prototype.getRecommendedDesign=function(){if(h.prototype.basketRecommended===null||typeof h.prototype.basketRecommended==="undefined"){h.prototype.basketRecommended=[]}return h.prototype.basketRecommended});(h.prototype.getCompleteURL=function(n){return h.prototype._baseURL+n}),(h.prototype.propagateEvent=function(n){});(h.prototype.findParameter=function(n,r,o){if(!r){r=h.prototype.varGroup}var q={};q.depth=0;q.parentString="-root-,";q.parentList=[];if(o){q.parents=o;q.parentString=o.parentString+r.displayName;o.parentList=o.parentList||[];q.parentList=o.parentList.slice();q.parentList.push(r.displayName);q.groupName=r.displayName;q.groupID=r.ID;q.depth=o.depth+1}var s=null;if(n==="overallscore"){s=h.prototype.varGroup.score;return s}if(r.score&&r.score.ID&&r.score.ID===n){s=r.score;return s}var p=null;if(r.parameters){r.parameters.forEach(function(t){if(t.ID===n){p=t;p.parents=q;return false}})}if(p===null&&r.groups){r.groups.forEach(function(t){p=h.prototype.findParameter(n,t,q);return p===null})}return p});(h.prototype.processFilters=function(n){h.prototype.filters.scoreFilters=[];h.prototype.filters.paramFilters=[];h.prototype.filters.rowTagFilters=[];n.forEach(function(q){if(q.parameterID){h.prototype.filters.paramFilters.push(q)}else{if(q.rowGrade){}else{if(q.tagName){if(q.tagName==="DATA_SET"){var p=q.tagValue;for(var o=0;o<dataSetFilters.length;o++){if(dataSetFilters[o].alias===p){dataSetFilters[o].checked=false;break}}}else{h.prototype.filters.rowTagFilters.push(q)}}else{if(typeof q.totalDesigns!=="undefined"&&typeof q.displayedDesigns!=="undefined"){h.prototype.filters.designCounter=q}}}}})});(h.prototype.setParametricFilter=function(p,q,o,r,n){h.prototype.setFilterOnProxy(p,q,o,r,n);return h.prototype.setFiltersAndSync(r)});(h.prototype.setFilterOnProxy=function(s,u,q,o,t,p){h.prototype.filters.paramFilters=h.prototype.filters.paramFilters||[];var r=-1;if(s==="overallscore"){s=h.prototype.varGroup.score.ID}h.prototype.filters.paramFilters.forEach(function(x,w){if(x.parameterID===s&&x.type===u){r=w;return false}});if(r>-1){h.prototype.filters.paramFilters.remove(r)}var v=false;if(u==="GREATER_THAN"&&q===h.prototype.findParameter(s).max){v=true}else{if(u==="LESS_THAN"&&q===h.prototype.findParameter(s).min){v=true}else{if(u==="IN_RANGE"&&q===t){v=true}else{if(u==="ONE_OF"&&q===null){v=true}}}}var n=null;if(!v){if(u==="IN_RANGE"){n={"@class":"ParametricCondition",type:u,parameterID:s,range:[q,t],filterName:p}}else{if(u==="ONE_OF"){n={"@class":"ParametricCondition",type:u,parameterID:s,valueList:q,filterName:p}}else{n={"@class":"ParametricCondition",type:u,parameterID:s,boundValue:q,filterName:p}}}h.prototype.filters.paramFilters.push(n)}});return h});define("SMAAnalyticsWidget/dialogs/SMAAnalyticsExecutionConfigDialog",["UWA/Core","DS/UIKIT/Modal","SMAAnalyticsWidget/SMAAnalyticsCustomPageProxy"],function(g,c,a){var e=new a();var d=e.getServerFileUrl("/SMAAnalyticsWidget/dialogs/compute-config-dialog.html");var f=new c({renderTo:document.body,className:"executionConfig",closable:true,header:"<h4>Execution Configuration</h4>",footer:'<button type="submit" class="btn btn-primary">Save</button> <button type="button" class="btn btn-cancel">Cancel</button>'});f.getContent().getElement(".btn-primary").addEvent("click",function(){alert();f.hide()});f.getContent().getElement(".btn-cancel").addEvent("click",function(){f.hide()});var b={};b.show=function(){var i=g.createElement("div",{id:"dialogBody"});f.setBody(i);var h=e.getServerFileUrl("/SMAAnalyticsElements/ra-compute-config-page/ra-compute-config-page.html");Polymer.Base.importHref(h,function(k){var j=g.createElement("ra-compute-config-page");i.appendChild(j)},function(j){alert(j)});f.show()};return b});define("DS/SMAAnalyticsWidget/views/requirement/SMAAnalyticsReqListViewUtils",["UWA/Core","DS/UIKIT/Mask","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsConfirmDialog",],function(e,c,d,a){var b={};b.disconnectRequirement=function(f){var g={immersiveFrame:d.getImmersiveFrame(),label:d.translate("RD_DELETE_MESSAGE"),header:d.translate("ARE_YOU_SURE"),};a.showDialog(g).then(function(){var h=widget._frameWnd.getUIFrame();c.mask(h);d.removeDatasetsFromAnalyticsCase(f.model.collection.selectedCase,f.model.id).then(function(i){f.model.collection.remove(f.model.id);c.unmask(h);d.showSuccessNotification("",d.translate("RD_REM_SUCCESS"))},function(i){c.unmask(h);d.showErrorNotification("",d.translate("RD_REM_FAIL"))})})};b.createNewRequirement=function(h,j){var f=[];if(e.is(j)){for(var g in j){if(j.hasOwnProperty(g)){var i=j[g];i.forEach(function(k){f.unshift(h.collection.addObjToCollection(k))},this)}}}if(f.length>0){h.render();h.selectItemView(f[0])}};return b});define("SMAAnalyticsWidget/SMAAnalyticsSimJobWrapper",["UWA/Core","UWA/Class","UWA/Class/Promise","UWA/Utils","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Modal","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(g,c,f,b,e,a,h){var d=c.extend({_caseId:"",_currentUserLogin:"",_spCos:null,_spDashboard:null,_spMcsService:null,_spCosService:null,_privateStationInfo:null,_eedServerId:"",_eedTicket:"",_supportedTypes:["SIMULATION","SIMULATION PROCESS","SIMULATION JOB","SIMULATION DOCUMENT - VERSIONED","SIMULATION DOCUMENT - NONVERSIONED"],_datasetsForResultExt:[],_otherDatasets:[],_exDatasets:[],_appDataXML:"",_jobs:[],_extractedJobs:[],_unExtractedJobs:[],_connectedResponse:"",_BULLETIN_BOARD_TOPIC:"RA_DRIVER_SELECTION",_runCount:0,_runCountLimit:90,_runningFine:false,_hasInList:function(j,k,i){if(!(k.length>0)){return false}return(k.filter(function(l){if(i&&i===true){return(l.toLowerCase().indexOf(j.toLowerCase())>-1)}else{return l.indexOf(j)>-1}}).length>0)},_createEXML:function(){return new f(function(n,m){var j="";if(this._privateStationInfo!==null){j="{localhost}"}else{j=widget.getValue("stations")||"";if(j==="{localhost}"){m()}}var l=this._unExtractedJobs.map(function(p){return p.id});var i='<?xml version="1.0" encoding="UTF-8"?><fiper_Model rootComponentId="812da46e-811e-11e2-ae82-e9ce6b18c519" version="7.419.0"><Properties modelId="6a53ba4c-811e-11e2-ae82-e9ce6b18c519" modelName="AdviseJobResults" modelVersion="7.419.0"/><Component id="812da46e-811e-11e2-ae82-e9ce6b18c519" name="AdviseJobResults" type="com.dassault_systemes.smacomponent.advjobresults" ><Variable dispName="caseId" id="812da46e-811e-11e2-ae82-e9ce6b18c519:caseid" mode="Input" name="caseId" role="Parameter" structure="Scalar" type="com.engineous.datatype.String" parentId="812da46e-811e-11e2-ae82-e9ce6b18c519"><Value><![CDATA['+this._caseId+"]]></Value></Variable>";var k='<Variable dispName="resultsObjects" id="812da46e-811e-11e2-ae82-e9ce6b18c519:resobj" mode="Input" name="resultsObjects" role="Parameter" structure="Array" type="com.engineous.datatype.String" parentId="812da46e-811e-11e2-ae82-e9ce6b18c519" dims="['+l.length+']">';l.forEach(function(q,p){k+='<Value index="['+p+']"><![CDATA['+q+"]]></Value>"},this);k+="</Variable>";i+=k;var o="";if(j.length>0){o='<Variable id="812da46e-811e-11e2-ae82-e9ce6b18c519:affinities" name="affinities" role="Property" structure="Aggregate" mode="Local" parentId="812da46e-811e-11e2-ae82-e9ce6b18c519" type="com.engineous.datatype.String"><Variable dispName="Host" id="812da46e-811e-11e2-ae82-e9ce6b18c519:Host" mode="Local" name="Host" role="Property" structure="Scalar" type="com.engineous.datatype.String" parentId="812da46e-811e-11e2-ae82-e9ce6b18c519:affinities"><Value>'+j+"</Value></Variable></Variable>";i+=o}i+="</Component></fiper_Model>";n(h.htmlUnescape(i))}.bind(this))},_loadEED:function(){return new f(function(j,i){this._spCos.getCosConfiguration({onComplete:j.bind(this,(this._eedServerId=this._spCos.getDefaultServerId())),onFailure:i})}.bind(this))},_getEEDTicket:function(){return new f(function(j,i){this._spCosTickets=document.querySelector("#spCosTickets");this._spCosTickets.cosTicketUrl=h.get3DSpaceURL()+"/resources/eepservices/cos/configurations/"+this._eedServerId+"/ticket";this._spCosTickets.getServerTicket(this._eedServerId,this._caseId,true,function(k,l){this._eedTicket=l;j(this._eedTicket)}.bind(this),i)}.bind(this))},_getPrivateStationInfo:function(){return new f(function(l,k){try{var j=null;this._spCos.requestCosVersionForServer(this._eedServerId,{onComplete:function(m){if(this._spCos.utils.isCosVersionSameOrNewer(m,418,3)){this._spCos.getPrivateStationInfo({onComplete:function(o){for(var n=0;n<o.length;n++){if(o[n].info.cosid===this._eedServerId||o[n].info.cosid===this._spCos.getDefaultServerId()){if(b.matchUrl(h.get3DSpaceURL(),o[n].info.spaceurl)){if(o[n].info.user===this._currentUserLogin){j=o[n];break}}}}if(typeof j!=="undefined"&&j!==null){var p={};p.name=j.info.name;p.ip=j.info.ip;p.cosID=j.info.cosid;p.user=j.info.user;p.isPrivate=true;p.uri=j.uri;this._privateStationInfo=p;l()}else{l()}}.bind(this),onFailure:l})}else{l()}}.bind(this),onFailure:l})}catch(i){k()}}.bind(this))},_claimJob:function(i){return new f(function(k,j){if(typeof i==="undefined"||i===null||i.length===0){j()}if(typeof this._privateStationInfo==="undefined"||this._privateStationInfo===null){k(i)}else{var l=new XMLHttpRequest();l.open("GET",this._privateStationInfo.uri+"/station/claim?jobids="+i);l.onload=function(){if(l.readyState===4&&l.status===200){k(i)}else{j()}};l.send()}}.bind(this))},_launchRunner:function(i){return new f(function(o,n){var m=new SPRun();var k=this._spCos.getUrlForServer(this._eedServerId);m.simOID=this._caseId;m.timeout=20000;m.runURL=k+"/execution/run";m.cosPubkeyURL=k+"/execution/pubkey";m.encryptURL=h.get3DSpaceURL()+"/resources/slmservices/data/getEncryptedCreds?SecurityContext="+widget.getValue("collabspaces");m.addEventListener("success",function(p){o(p.detail.result.EEDJobID)});m.addEventListener("error",function(){n({message:"sp-run failure."})});if(this._privateStationInfo!==null){m.runInfo="<RunInfo logLevel='Debug' submissionHost='"+this._privateStationInfo.name+"'></RunInfo>";var j=b.loadXml(this._appDataXML),l=j.getElementsByTagName("Application")[0].appendChild(j.createElement("HasLocalHost"));l.appendChild(j.createTextNode("true"));m.runEXML({},i,this._caseId,"",false,b.xmlToString(j),true)}else{m.runInfo="<RunInfo logLevel='Debug' submissionHost=''></RunInfo>";m.runEXML({},i,this._caseId,"",false,this._appDataXML,false)}}.bind(this))},_getTranslatedError:function(i){if(typeof i==="undefined"||i===null||i.length===0){return h.translate("FATAL_JOBPROC_ERROR")}switch(i){case"RA Driver cannot run - Isight already running.":return h.translate("JOBPROC_ISIGHT_RUNNING_ERROR");default:return h.translate("FATAL_JOBPROC_ERROR")}},_monitorBulletinBoard:function(i,k,l,j){this._runCount++;if(this._runCount>this._runCountLimit){if(confirm(h.translate("CONTINUE_RES_EXTRN"))===true){this._runCount=0;this._runCountLimit=90;window.setTimeout(function(){if(this._runningFine===false){clearInterval(k);j()}}.bind(this),20000)}else{clearInterval(k);j()}}this._getEEDTicket().then(function(m){h.monitorBulletinBoardForTopic(i,this._BULLETIN_BOARD_TOPIC,m).then(function(p){console.info(p);this._runningFine=true;var u=UWA.Json.xmlToJson(p),q=u.MonitoringMessages||null,o=q.length!==null?q.status:"";if(o.toLowerCase()==="running"){var t=q.MessageList.Message,r=JSON.parse(t[t.length-1].nodeValue),n=r.adapter_status.toLowerCase();if(n==="success"){clearInterval(k);l()}else{if(n==="failure"||n==="complete"){var s=this._getTranslatedError(r.adapter_message);if(n==="failure"&&s.indexOf("Isight already running")>-1){this._createModalAlert({message:s,close:function(){clearInterval(k);j()}})}else{clearInterval(k);j()}}}}else{if(o.toLowerCase()==="done"){clearInterval(k);j()}}}.bind(this),function(n){console.warn(n);this._runningFine===false}.bind(this))}.bind(this),j)},_waitForExtraction:function(i,l,j){var k=setInterval(function(){this._monitorBulletinBoard(i,k,l,j)}.bind(this),2000);window.setTimeout(function(){if(this._runningFine===false){clearInterval(k);j()}}.bind(this),20000)},_getLaunchInfo:function(){return new f(function(j,i){h.getCaseLaunchInfo(this._caseId).then(function(k){this._appDataXML=unescape(encodeURIComponent(h.htmlUnescape(k.encodedJobXML)));j(k)}.bind(this),i)}.bind(this))},_createEEDJob:function(){return new f(function(j,i){this._loadEED().then(this._getLaunchInfo.bind(this)).then(this._getPrivateStationInfo.bind(this)).then(this._createEXML.bind(this)).then(this._launchRunner.bind(this)).then(this._claimJob.bind(this)).then(j,i)["catch"](i)}.bind(this))},_doResultsExtraction:function(i){return new f(function(k,j){if(!Array.isArray(i)){j()}this._createEEDJob().then(function(l){this._waitForExtraction(l,k,j)}.bind(this))}.bind(this))},_getJobsForSimulationProcess:function(i){return new f(function(n,m){var l="",j=[];if(!Array.isArray(i)||i.length===0){if(typeof i==="string"){l=i}else{m()}}else{i.forEach(function(p){l+=p+";"},this)}if(l.substring(l.length)===";"){l=l.slice(0,-1)}var o={Accept:"application/json"},k={uri:h.get3DSpaceURL()+"/resources/slmservices/advise/getAttachedSimulationJobs?objectids="+l,verb:"GET",headers:o,onComplete:function(s){var r=JSON.parse(s.response);for(var p in r){var q=r[p];if(q.length>0){q.forEach(function(t){j.push({id:t.physicalId,title:t.title})})}}n(j)},onError:m};this._spMcsService.sendRequest(k)}.bind(this))},_connectAllDatasets:function(){return new f(function(j,i){var k="";this._jobs.forEach(function(l){if(this._exDatasets.indexOf(l.id)===-1){k+=l.id+";"}},this);this._otherDatasets.forEach(function(l){if(this._exDatasets.indexOf(l.id)===-1){k+=l.id+";"}},this);delete this._otherDatasets;if(k.substring(k.length-1)===";"){k.slice(0,-1)}h.connectDatasetsToCase(this._caseId,k).then(function(l){this._connectedResponse=l;j()}.bind(this),i)}.bind(this))},_listAttachedFiles:function(i){return new f(function(l,k){var m={Accept:"application/json"},j={uri:h.get3DSpaceURL()+"/resources/slmservices/advise/"+i+"/listAttachedFilesForCase",verb:"GET",headers:m,onComplete:function(o){var n=JSON.parse(o.response);l(n||{})},onError:k};this._spMcsService.sendRequest(j)}.bind(this))},_sortExtractedHierarchy:function(i){return new f(function(k,j){this._listAttachedFiles(i.id).then(function(l){if(typeof l["hierarchy.json"]!=="undefined"){this._extractedJobs.push(i)}else{this._unExtractedJobs.push(i)}k()}.bind(this),j)}.bind(this))},_indexSimJobs:function(){return new f(function(k,j){var i="";this._datasetsForResultExt.forEach(function(l){if(l.type.toUpperCase()==="SIMULATION JOB"){this._jobs.push({id:l.id,title:l.title})}else{i+=l.id+";"}},this);delete this._datasetsForResultExt;if(i.length>0){this._getJobsForSimulationProcess(i).then(function(l){this._jobs=l;k()}.bind(this),j)}else{k()}}.bind(this))},attachJobsToCase:function(){return new f(function(j,i){this._indexSimJobs().then(function(){this._connectAllDatasets().then(j,i)}.bind(this),i)}.bind(this))},getJobsForHierarchyExtraction:function(){return new f(function(k,j){var i=[];this._jobs.forEach(function(l){i.push(this._sortExtractedHierarchy.call(this,l))},this);f.all(i).then(k,j)}.bind(this))},setExistingDatasets:function(i){i=i||[];this._exDatasets=i.map(function(j){return j.physicalId})},_sortDataset:function(i){return new f(function(l,k){var j={id:i.objectId,type:i.objectType,context:i.contextId,title:i.displayName};if(this._hasInList(i.objectType,this._supportedTypes,true)){if(i.objectType.toUpperCase().indexOf("SIMULATION DOCUMENT")>-1){this._listAttachedFiles(i.objectId).then(function(n){var p=false;for(var m in n){if(n.hasOwnProperty(m)){var o=m.substr(m.lastIndexOf(".")).toLowerCase();if(o===".nrf"||o===".zrf"){p=true;break}}}if(p===true){this._datasetsForResultExt.push(j)}else{this._otherDatasets.push(j)}l()}.bind(this),function(){this._otherDatasets.push(j);l()}.bind(this))}else{this._datasetsForResultExt.push(j);l()}}else{if(h.isValidDStype(i.objectType)){this._otherDatasets.push(j);l()}}}.bind(this))},_getCaseDefinition:function(i){return new f(function(k,j){h.getCaseInfo(i).then(function(n){try{var l=UWA.Json.xmlToJson(n).CaseInfo.Definition;if(typeof l==="undefined"||l===null||l.length===0){k({})}else{k(JSON.parse(l))}}catch(m){k({})}},j)})},_persistUserSelection:function(i){return new f(function(m,l){var k=widget.body.getElement("ra-driver-browser"),j=k.listDataset||[];k.parentNode.removeChild(k);this._getCaseDefinition(this._caseId).then(function(o){var n={};j.forEach(function(q){if(Array.isArray(q.selections)){var p=[];q.selections.forEach(function(s){var r=q.hierarchy.filter(function(t){return s===t.name},this)[0];p.push({name:s,hasSubFlow:r._HAS_SUBFLOW_})},this);n[q.id]={title:q.title,selections:p}}},this);o.multi_driver_selection=n;h.setSingleCaseAttribute(this._caseId,"Definition",JSON.stringify(o)).then(m,l)}.bind(this),l)}.bind(this))},_launchRADriverBrwser:function(){return new f(function(k,j){var i=g.createElement("ra-driver-browser");i.listDataset=this._extractedJobs;i.inject(widget.body);i.addEventListener("selectiondone",function(l){this._persistUserSelection(l).then(k,j)}.bind(this));i.showRA()}.bind(this))},_createModalAlert:function(r){if(document.querySelector(".modal.modal-root")!==null){return}var o="",p=true,n=r.title||"",q=r.message||"",m=r.oklabel||"Ok",j=r.closelabel||"Close",l=this;if(n.length==0){n="Results Analytics"}if(typeof r.ok==="function"){o+='<button type="button" class="btn btn-primary" id="ra-mok">'+m+"</button>";p=false}if(typeof r.close==="function"){o+='<button type="button" class="btn btn-default" id="ra-mcancel">'+j+"</button>";p=false}var k=document.querySelector(".moduleWrapper")||r.backupTarget;var i=new a({closable:p,header:"<h4>"+n+"</h4>",body:"<p>"+q+"</p>",footer:o}).inject(k);i.getContent().getElements(".btn").forEach(function(s){s.addEvent("click",function(){i.destroy();if(s.id==="ra-mok"){r.ok.call(l)}if(s.id==="ra-mcancel"){r.close.call(l)}})});i.show()},canExtractResults:function(i){return new f(function(l,k){if(!Array.isArray(i)){k()}var j=[];i.forEach(function(m){j.push(this._sortDataset(m))},this);f.all(j).then(function(){if(this._datasetsForResultExt.length>0){l()}else{k()}}.bind(this),k)}.bind(this))},getConnectedData:function(){return this._connectedResponse||""},executeJobResults:function(){return new f(function(j,i){this.attachJobsToCase().then(function(){this.getJobsForHierarchyExtraction().then(function(){if(this._unExtractedJobs.length>0){this._doResultsExtraction(this._unExtractedJobs).then(function(){this._unExtractedJobs.forEach(function(k){this._extractedJobs.push(k)},this);this._unExtractedJobs=[];this._launchRADriverBrwser.call(this).then(j,i)}.bind(this),i)}else{this._launchRADriverBrwser.call(this).then(j,i)}}.bind(this),i)}.bind(this),i)}.bind(this))},isOn:function(){var i=window.localStorage.getItem("MULTI_DRIVER")||false;if(i===true||i==="true"||i===1){return true}else{return false}},init:function(i){if(i&&i.caseId){this._caseId=i.caseId}this._spCos=document.querySelector("#spCos");this._spDashboard=document.querySelector("#spDashboard");this._spMcsService=document.querySelector("#spMcsService");this._spCosService=document.querySelector("#spCosService");this._currentUserLogin=e.getUser().login;this._datasetsForResultExt=[];this._exDatasets=[];this._extractedJobs=[];this._unExtractedJobs=[];this._otherDatasets=[];this._jobs=[]}});return d});define("SMAAnalyticsWidget/SMAAnalyticsDNDHelper",["UWA/Core","UWA/Class","UWA/Class/Promise","DS/PlatformAPI/PlatformAPI","DS/DataDragAndDrop/DataDragAndDrop","DS/UIKIT/Mask","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","SMAAnalyticsWidget/SMAAnalyticsSimJobWrapper","DS/Usage/TrackerAPI"],function(f,a,g,i,h,d,j,c,e){var b=a.extend({dragClass:"",caseId:"",dropDeferred:null,dropZone:null,view:null,type:"",_connectedResponse:null,_dsallowed:["Simulation","Document","Simulation Document - Versioned","Simulation Document - NonVersioned","Simulation Job","DesignSight","VPMReference"],_extensions:".zrf, .nrf, .3dxml, .stp, .stpz, .jpg, .jpeg, .png, .gif, .tif, .tiff, .bmp, .flv, .avi, .mov, .wmv, .mpg, .mpeg, .mp4, .m4v, .rm, .webm, .mkv, .mp3, .wav, .aac, .m4a, .wma, .ra, .ogg, .doc, .docx, .ppt, .pptx, .pps, .ppsx, .xls, .xlsx, .xlsm, .pdf, .zip, .txt, .csv, .tsv",_reqallowed:["Requirement"],_decallowed:["Decision"],_selectedModel:null,getConnectedResponse:function(){return this._connectedResponse},getSelectedModel:function(){return this._selectedModel},getExtension:function(k){if(!f.is(k,"string")){return}var l,m="";l=k.match(/\.([^.]+)$/);if(l!==null&&l.length===2){m=l[1].toLowerCase()}return m},checkExtension:function(k){return(this._extensions.indexOf(this.getExtension(k))!==-1)},isValidDSObject:function(l){var k=0;switch(this.type){case"DATASET":k=this._dsallowed.indexOf(l);break;case"REQUIREMENT":k=this._reqallowed.indexOf(l);break;case"DECISION":k=this._decallowed.indexOf(l);break}if(k>-1){return true}else{return false}},maskHandlr:function(k){try{if(k===true||k==="true"){d.mask(widget.body)}else{d.unmask(widget.body)}}catch(l){console.warn("Error displaying the loading spinner.")}},resolveDropDeferred:function(k){this.maskHandlr(false);if(typeof this.dropDeferred!=="undefined"&&this.dropDeferred!==null){if(k){this.dropDeferred.resolve()}else{this.dropDeferred.reject()}}},itExists:function(m){var n=this;if(!n.type){return false}var k=[];switch(n.type){case"DATASET":k=n.view.model.get("datasetsList")||[];break;case"REQUIREMENT":k=[];break;case"DECISIONS":k=[];break}if(k.length===0){return false}for(var l=0;l<k.length;l++){if(k[l].physicalId===m){return true}}return false},checkJobAttach:function(k,p){var q=this,s=[],u={},v=q.model?q.model.id:q.caseId;u[v]=[];var w=function(x){u[v].push(x[v][0])};for(var t=0;t<p.length;t++){var o=p[t],n="";if(o.type==="Simulation"){if(o.latestJobStatus!=="Completed"){var l=o.latestSuccessfulJob||"";if(l!==""){var m=confirm(j.translate("LTST_JOB1")+" "+o.title+j.translate("LTST_JOB2"));n=m?o.latestJob:o.latestSuccessfulJob}else{var r=confirm(j.translate("LTST_JOB1")+" "+o.title+j.translate("LTST_JOB3"));n=r?o.latestJob:""}if(n.length>0){s.push(j.connectDatasetsToCase(v,n).then(function(x){w(JSON.parse(x))},function(x){console.error("Error attaching job to case.",x)}))}else{q.resolveDropDeferred(false)}}}}if(s.length>0){g.all(s).then(function(){if(u[v].length>0){q._connectedResponse=JSON.stringify(u)}q.resolveDropDeferred(true)})}},connectDatasets:function(k,o){if(typeof k==="undefined"||k===null){this.resolveDropDeferred(false);return}var n=this,l=k.data?k.data.items?k.data.items:[]:[],m="";l.forEach(function(p){if(!n.itExists(p.objectId)){if(n.isValidDSObject(p.objectType)){m+=p.objectId+";"}else{alert(p.displayName+j.translate("ATTACH_ERR"))}}});if(m.length>0){j.connectDatasetsToCase(n.model?n.model.id:n.caseId,m).then(function(q){var r=false,s=JSON.parse(q);if(s){var t=s[n.caseId];for(var p=0;p<t.length;p++){if(t[p].type==="Simulation"&&t[p].latestJobStatus!=="Completed"){r=true;break}}if(!r){console.log("Successfully connected dropped objects to the case.");n._connectedResponse=q;n.resolveDropDeferred(true)}else{n.checkJobAttach(q,t)}}else{n.resolveDropDeferred(false)}},function(p){console.error("Error connecting the dropped objects to the case.");n.resolveDropDeferred(false)})}else{n.resolveDropDeferred(false)}},createCase:function(l,p){console.log("create and connect");var m=this;var k=function(q){m.resolveDropDeferred(q)};var o="",n="";if(m.view.model){o=m.view.model.get("title")||"";n=m.view.model.get("description")||"";if(o==="New Analytics Case"){o=""}}j.createAnalyticsCaseObject(o,n).then(function(r){console.log("Successfully created a new case.");var q=e.getCounter("RACreateAnalyticsCaseSuccess",{appID:"SIMREII_AP"});q.inc();if(typeof r!=="undefined"&&r!==null){m.view.model.set("id",r);m.view.model.set("image",j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");m.view.model.set("recommendedImage",j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");m.view.model.set("project",j.getMyCollabSpace())}m.caseId=r;m.connectDatasets(l,p)},function(r){var q=e.getCounter("RACreateAnalyticsCaseFail",{appID:"SIMREII_AP"});q.inc();console.error("Error creating a new case.");k(false)})},createBO:function(o,r){var q,n=this,k="",p=null;k=widget.getPreferenceLabel("collabspaces");var l=function(t,u){var s=this;j.createDocumentObject(q).then(function(v){var w=v;j.uploadFileTo3DSpace({oId:w,title:q,file:t}).then(function(){var y=[{objectId:w,objectType:"Simulation Document - NonVersioned",displayName:t.name}],x={data:{items:y}};if(s.caseId.length>0){s.connectDatasets(x,u)}else{s.createCase(x,u)}})})};for(var m=0;(p=o[m]);m++){q=p.name;if(n.checkExtension(q)){l.call(n,p,r)}}},enableDragDrop:function(){var k=this;if(typeof k.dropZone==="undefined"||k.dropZone===null){console.error("no drop zone defined");this.resolveDropDeferred(false);return}h.droppable(k.dropZone,{over:function(){return true},enter:function(){arguments[0].classList.add(k.dragClass)},leave:function(){arguments[0].classList.remove(k.dragClass)},drop:function(){k.maskHandlr(true);try{var o=arguments[0],q=arguments[1],p=arguments[2],n=null;if(o==null||typeof o==="undefined"){n=null}else{n=o.length>0?JSON.parse(o):null}q.classList.remove(k.dragClass);var l=null;try{l=p.dataTransfer.files||p.target.files}catch(m){}k.getDroppedCases(n?n.data:null).then(function(u){var t=u.objectId,s=this.view.collection.toArray();var r=s.filter(function(v){return(u.objectId===v.id||u.objectId===v.get("physicalId"))})[0];this._connectedResponse=null;if(typeof r!=="undefined"&&r!==null){this._selectedModel=r;this.resolveDropDeferred(true)}else{this.resolveDropDeferred(false)}}.bind(k),function(){var r=this;if(r.caseId.length>0&&r.caseId!=="0000.0000.0000"){r.connectDataToCase(o,l,r.caseId.length).then(function(s){this._connectedResponse=s;this.resolveDropDeferred(true)}.bind(r),r.resolveDropDeferred.bind(r,false))}else{r.createNewCase().then(function(s){r.caseId=s;r.connectDataToCase(o,l,s).then(function(t){this._connectedResponse=t;this.resolveDropDeferred(true)}.bind(r),r.resolveDropDeferred.bind(r,false))},r.resolveDropDeferred.bind(r,false))}}.bind(k))}catch(m){console.error(m);k.maskHandlr(false)}}});return this},createBOForFiles:function(k,o){var p=this,v=[],u=[],q;var s=function(y,x){var w=g.deferred();j.createDocumentObject(y).then(function(z){j.uploadFileTo3DSpace({oId:z,title:y,file:x}).then(function(){u.push({objectId:z,objectType:"Simulation Document - NonVersioned",displayName:x.name});w.resolve()},function(){w.reject()})},function(){w.reject()});return w.promise};var l=function(){var w=g.deferred();if(!p.caseId.length>0){j.createAnalyticsCaseObject(t,p.view.model?p.view.model.get("description")||"":"").then(function(y){var x=e.getCounter("RACreateAnalyticsCaseSuccess",{appID:"SIMREII_AP"});x.inc();p.caseId=y;p.view.model.set("id",y);p.view.model.set("image",j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");p.view.model.set("recommendedImage",j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");p.view.model.set("project",j.getMyCollabSpace());w.resolve(p.caseId)},function(){var x=e.getCounter("RACreateAnalyticsCaseFail",{appID:"SIMREII_AP"});x.inc();w.reject()})}else{w.resolve(p.caseId)}return w.promise};var r=function(){p.connectDatasets({data:{items:u}},o)};for(var n=0;n<k.length;n++){var m=k[n],t=m.name;if(p.checkExtension(t)){v.push(s(t,m))}}g.all(v).then(function(){if(u.length>0){l().then(function(){console.log("last step");p.connectDatasets({data:{items:u}},o)})}})},init:function(k){if(!k){console.error("No options were received by the drag and drop helper");this.resolveDropDeferred(false);return}if(k.dropZone){this.dropZone=k.dropZone}if(k.dragClass){this.dragClass=k.dragClass}if(k.dragClass){this.dragClass=k.dragClass}if(k.caseId){this.caseId=k.caseId}if(k.view){this.view=k.view}if(k.dropDeferred){this.dropDeferred=k.dropDeferred}if(k.type){this.type=k.type}this.enableDragDrop.call(this)},runConnectHandler:function(k){return new g(function(n,m){if(!Array.isArray(k)||k.length===0){m();return}var l="";k.forEach(function(o){if(!this.itExists(o.objectId)){if(this.isValidDSObject(o.objectType)){l+=o.objectId+";"}}},this);if(l.length>0){j.connectDatasetsToCase(this.caseId,l).then(n,m)}else{m()}}.bind(this))},handleFileUpload:function(k){var l=this;return new g(function(n,m){if(l.checkExtension(k.name)){j.createDocumentObject(k.name).then(function(o){j.uploadFileTo3DSpace({oId:o,title:k.name,file:k}).then(function(){n({objectId:o,objectType:"Simulation Document - NonVersioned",displayName:k.name})},m)},m)}else{m()}})},createObjectsForFiles:function(k){var l=this;return new g(function(o,n){var m=[];[].forEach.call(k,function(p){m.push(l.handleFileUpload(p))});g.all(m).then(o,n)})},createNewCase:function(){var k=this;return new g(function(m,l){j.createAnalyticsCaseObject("","").then(function(o){var n=e.getCounter("RACreateAnalyticsCaseSuccess",{appID:"SIMREII_AP"});n.inc();if(typeof o!=="undefined"&&o!==null){k.view.model.set("id",o);k.view.model.set("image",j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");k.view.model.set("recommendedImage",j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");k.view.model.set("project",j.getMyCollabSpace());k.view.model.set("downselected",0);k.view.model.set("basketPointCount",0)}m(o)},l)})},prepDroppedData:function(l,k){return new g(function(o,n){if((l===null||l.length===0)&&k===null){n()}if(l!==null&&l.length>0){l=JSON.parse(l);o(l.data.items?l.data.items:[])}else{var m=k||[];if(m.length===0){n()}else{this.createObjectsForFiles(m).then(function(p){o(Array.isArray(p)?p:[])},n)}}}.bind(this))},connectDataToCase:function(m,l,k){var n=this;return new g(function(p,o){this.prepDroppedData(m,l).then(function(q){var r=new c({caseId:k});if(r.isOn()===true){r.canExtractResults(q).then(function(){r.setExistingDatasets(this.view.model.get("datasetsList")||[]);r.executeJobResults().then(function(){p(r.getConnectedData())},function(){delete r;this.runConnectHandler(q).then(p,o)}.bind(this))}.bind(this),function(){delete r;this.runConnectHandler(q).then(p,o)}.bind(this))}else{delete r;this.runConnectHandler(q).then(p,o)}}.bind(this),o)}.bind(this))},getDroppedCases:function(k){return new g(function(m,l){if(!Array.isArray(k.items)){l()}var n=k.items.filter(function(o){return("analytics case"===o.objectType.toLowerCase())},this);if(n.length===0){l()}else{m(n[0])}}.bind(this))}});return b});define("SMAAnalyticsWidget/SMAAnalyticsRqtDetailView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView","text!SMAAnalyticsWidget/views/SMAAnalyticsWidgetDataSetDetailsView.html","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(e,c,a,d){var b=c.extend({template:function(){return a},tagName:"div",className:"link-detail",model:null,domEvents:{"change .datasets-details-input":"persistUserInput"},onRender:function(){return true},init:function(f){if(f&&f.model){this.model=f.model}this._parent(arguments)},persistUserInput:function(f){var g=f.target?f.target:f.srcElement,h=this;if(g.defaultValue===g.value){return}var i="";switch(g.id){case"ra-reqdescription":i="description";break;case"ra-reqtitle":i="Title";break;default:i="";break}if(i===""||g.value===""){g.value=g.defaultValue;return}d.setSingleCaseAttribute(h.model.id,i,encodeURIComponent(g.value)).then(function(){g.defaultValue=g.value;this.model.set(i.toLowerCase(),g.value)}.bind(h),function(){g.value=g.defaultValue;console.error("Error changing the case attribute -"+i)})}});return b});define("DS/SMAAnalyticsWidget/views/decisions/SMAAnalyticsDecListViewUtils",["UWA/Core","DS/UIKIT/Mask","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsConfirmDialog",],function(e,c,d,b){var a={};a.disconnectDecision=function(f){var g={immersiveFrame:d.getImmersiveFrame(),label:d.translate("RD_DELETE_MESSAGE"),header:d.translate("ARE_YOU_SURE"),};b.showDialog(g).then(function(){var h=widget._frameWnd.getUIFrame();c.mask(h);d.removeDatasetsFromAnalyticsCase(f.model.collection.selectedCase,f.model.id).then(function(i){f.model.collection.remove(f.model.id);c.unmask(h);d.showSuccessNotification("",d.translate("RD_REM_SUCCESS"))},function(i){c.unmask(h);d.showErrorNotification("",d.translate("RD_REM_FAIL"))})})};a.createNewDecision=function(h,j){var f=[];if(e.is(j)){for(var g in j){if(j.hasOwnProperty(g)){var i=j[g];i.forEach(function(k){f.unshift(h.collection.addObjToCollection(k))},this)}}}if(f.length>0){h.render();h.selectItemView(f[0])}};return a});define("SMAAnalyticsWidget/SMAAnalyticsTablePageView",["UWA/Core","UWA/Class/View","UWA/Class/Promise","DS/UIKIT/Mask","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLaunchModule","DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","text!SMAAnalyticsWidget/views/SMAAnalyticsWidgetDataView.html"],function(f,b,h,d,a,c,i,e){var g=b.extend({events:{onFacetSelect:"onFacetSelect"},_launcher:null,_caseId:"",_tableContainer:null,_launchDialog:null,_mcsUri:"",_loadedCaseId:null,__servantDetails:"",_advHtmlUri:"",getServantDetails:function(l,k){var j={caseId:k._caseId,servantURL:l.uri,token:l.token,widgetID:widget.id,widgetViewType:widget.getView().type,userId:l.userId,secCtx:widget.getValue("collabspaces"),eerName:l.eer,stationDisplayName:l.eer,stationIP:l.eerIP||"",mcsUri:k._mcsUri,dashboardURL:window.location.protocol+"//"+window.location.host};return j},_setDataToAnalyticsFrame:function(m,j){this.__servantDetails=this.getServantDetails(m,j);var k=JSON.stringify({SERVANT_STARTED:this.__servantDetails});var l=document.querySelector("#table-frame").contentWindow;l.postMessage(k,j._mcsUri);j._launchDialog.destroy();d.unmask(widget.body)},_handleAnalyticsMessage:function(j){console.log("Message received:"+j);if(typeof j==="string"){j=JSON.parse(j)}console.log(j)},_handlePopout:function(l){var k=this;var j="DS/TransientWidget/TransientWidget";require([j],function(m){m.showWidget(k._mcsUri+"/webapps/SMAAnalyticsCompWidget/SMAAdviseComponentWidget.htm","Results Analytics",{raactivecase:"raactivecase",rachartid:"DataTable",racasetitle:"",collabspaces:widget.getValue("collabspaces"),raservantdetails:JSON.stringify({SERVANT_STARTED:k.__servantDetails})})})},_loadAnalyticsHtml:function(l){this._advHtmlUri=this._mcsUri+"/common/emxFrameworkContextManager.jsp?forwardUrl=/webapps/SMAAnalyticsUI/SMAAnalyticsWidgetTablePageView.html?&SecurityContext="+widget.getValue("collabspaces");this.container.insertAdjacentHTML("afterbegin",e);this._tableContainer=this.container.querySelector(".link-frame-with-toolbar");this._tableContainer.onload=this._setDataToAnalyticsFrame.bind(this,JSON.parse(l),this);this._tableContainer.setAttribute("src",this._advHtmlUri);var k=this;window.addEventListener("message",function(m){k._handleAnalyticsMessage(m)});this._loadedCaseId=this._caseId;var j=this.container.querySelector("#ra-dv-popout");j.addEventListener("click",function(){k._handlePopout()})},_launchServant:function(){return new h(function(k,j){this._launcher.getServant(this._caseId,false).then(k,j)}.bind(this))},onFacetSelect:function(k){this._mcsUri=i.get3DSpaceURL();this._launcher.setFrameWindow(widget._frameWnd);this._launcher.setMCSUri(this._mcsUri);if(this._loadedCaseId===this._caseId){return}d.mask(widget.body);var j=this.model;this._launchDialog=this._launcher.getLaunchDialog();this._caseId=j.get("id");this._launchServant().then(this._loadAnalyticsHtml.bind(this),function(m){var l=m.getRoute();m.setRoute(l.substring(0,l.indexOf("f="))+"f=0");d.unmask(widget.body)}.bind(this,k))["catch"](function(){d.unmask(widget.body)})},init:function(j){this._launcher=a;this._parent.call(this,j)}});return g});define("SMAAnalyticsWidget/SMAAnalyticsParameterCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","SMAAnalyticsWidget/SMAAnalyticsListModel","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(f,d,b,c,e){var a=b.extend({model:c,selectedRequirement:"",setup:function(h,g){this.selectedRequirement=g._modelKey.get("id")},sync:function(g,j,h){var i=null;switch(g){case"read":e.getParametersList(this.selectedRequirement).then(function(k){k=k["analytics-requirement"]||k.requirementsList;if(!Array.isArray(k)){h.onFailure("failed to get the list of parameters for the requirement")}else{if(k[0].parametersList){h.onComplete(k[0].parametersList)}else{h.onFailure("failed to get the list of parameters for the requirement")}}},function(k){h.onFailure("failed to get the list of parameters for the requirement")});break;default:h.onFailure("unsupported operation")}return{cancel:function(){}}},parse:function(h){var g=h;if(f.is(h,"string")&&h.length>0){g=JSON.parse(h)}g=g["analytics-parameter"]||g.parameterList;if(Array.isArray(g)){g.forEach(function(i){i.parametername=f.is(i.name,"string")?i.name:"";i.displayType=e.translate(i.type);i.requirementname=i.parametername;i.content=f.is(i.type,"string")?i.displayType:"";i.image=f.is(i.image,"string")?i.image:e.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/widgetdefaultthumbnail.png";i.enoviaURL=e.get3DSpaceURL();i.subtitle=e.translate("AN_PARAM")},this)}return g}});return a});define("DS/SMAAnalyticsWidget/collections/SMAAnalyticsCollection",["UWA/Core","UWA/Class/Model","DS/UIKIT/Mask","DS/SMAAnalyticsCommon/SMAAnalyticsCaseModel","UWA/Class/Collection","DS/SMAAnalyticsCommon/SMAAnalyticsSearch","DS/SMAAnalyticsCommon/SMAAnalyticsSearchUtils","DS/SMAAnalyticsCommon/SMAAnalyticsTagger","DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCaseListViewUtils","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsLauncher/SMAAnalyticsServantCache"],function(f,c,e,a,g,b,j,i,d,k,h){return g.extend({model:a,search:"*",_search_in_progress:false,setUpComplete:false,nextStart:null,numResults:60,nRetResults:-1,loadingFirstTime:true,pages:0,searchTerm:"",scrollView:null,recentResult:0,addNewCaseModel:function(p){if(f.is(p)){var l=this.findWhere({id:p.physicalId});if(l){return l}var o=this.toArray();var m=new a();m.set("id",p.physicalId);m.set("physicalId",p.physicalId);m.set("title",p.title||"");m.set("subtitle",k.getModifiedInterval(p.modified));m.set("owner",p.owner||"");m.set("revision",p.revision);var n=h.getCachedServantForCase(p.physicalId);if(f.is(n)){m.set("running",true)}o.unshift(m);this.reset();this.set(o);return m}else{return undefined}},setup:function(m,l){widget.__caseCollection__=this;this._parent(m,l)},tagChange:function(l){var m=widget._frameWnd.getUIFrame();e.mask(m);this._search_in_progress=true;this.setUpComplete=false;this.nextStart=null;this.loadMoreData()},parse:function(q){var o=widget._frameWnd.getUIFrame();if(e.isMasked(o)){e.unmask(o)}if(!q){return[]}if(this._search_in_progress){this._search_in_progress=false;this.reset();if(this.searchTerm&&this.searchTerm!==""){this._noResultNotification(q.infos.nresults)}}var p=[];this.nRetResults=q.infos.nresults;this.nextStart=f.is(q.infos.next_start)?q.infos.next_start:null;var m=this;if(q instanceof String){q=JSON.parse(q)}if(typeof q==="undefined"||q===null){q=[]}var n=[];if(q.results){n=q.results}this.pages++;i.onTagChange(this.tagChange.bind(this));i.onSearchChange(this.tagChange.bind(this));var l=j.transform(q);i.set(q.facets);m.setUpComplete=true;l.analyticsCase.forEach(function(r){var s=h.getCachedServantForCase(r.id);if(f.is(s)){r.set("running",true)}});p=this._models.concat(l.analyticsCase);return p},hasNextPage:function(){if(f.is(this.nRetResults)&&this.nRetResults===0){return false}return true},loadMoreData:function(l){var m=this;var n={onComplete:function(o){if(!l){if(o.hasNextPage()){o.scrollView.endLoading();o.scrollView.useInfiniteScroll(true)}else{o.scrollView.useInfiniteScroll(false)}}else{if(o.hasNextPage()){l.onComplete()}else{o.scrollView.useInfiniteScroll(false)}}}};if(this.loadingFirstTime){this.loadingFirstTime=false;setTimeout(function(){l.onComplete()},3000)}else{this.setUpComplete=false;this.fetch(n)}},_getRecentData:function(l){return new Promise(function(n,m){b.getData({onComplete:function(o){n(o)},onError:function(o){m(o)},servicename:"recent",addFilter:l.search})})},_getSearchData:function(m){var l=this;return new Promise(function(o,n){b.getData({onComplete:function(p){o(p)},onError:function(p){n(p)},filterTags:m.tags,addFilter:m.search,next_start:l.nextStart,nresults:l.numResults,servicename:"search"})})},_preProcessing:function(){var l=this;return new Promise(function(n,m){if(l.loadingFirstTime){d.collectionPreProcessing().then(n,m)}else{n()}})},_noResultNotification:function(l){if(l===0){k.showInfoNotification("","Sorry, no matches found.")}},sync:function(p,o,l){var n=this;switch(p){case"read":f.log("fetching analytics cases");var m=i.getFilters();n.searchTerm=m.search;n._preProcessing().then(function(){n._getSearchData(m).then(function(q){n._getRecentData(m).then(function(r){if(r.results){q.results=r.results.concat(q.results)}l.onComplete(q)},function(r){l.onComplete(q)})},function(q){f.log("Failed to get search data");var r=widget._frameWnd.getUIFrame();if(e.isMasked(r)){e.unmask(r)}l.onComplete(null);k.showWarningNotification("","Invalid search.");n.scrollView.useInfiniteScroll(false)}.bind(n))}.bind(n))}}})});define("DS/SMAAnalyticsWidget/views/decisions/SMAAnalyticsDecCustomView",["UWA/Core","UWA/Class/Promise","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Layout/ListView","DS/SMAAnalyticsWidget/views/decisions/SMAAnalyticsDecListViewUtils",],function(d,g,i,h,f,e){var c="onAddToCollectionEvent";var a=function(){if(!this.hasEvent(c)){this.addEvent(c,function(j){if(d.is(j)&&d.is(j.detail)){e.createNewDecision(this,j.detail)}}.bind(this))}this._parent.apply(this,arguments)};var b={AnalyticsGridScrollView:i.extend({onRender:a}),AnalyticsListView:f.extend({onRender:a})};return b});define("DS/SMAAnalyticsWidget/views/requirement/SMAAnalyticsReqCustomView",["UWA/Core","UWA/Class/Promise","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Layout/ListView","DS/SMAAnalyticsWidget/views/requirement/SMAAnalyticsReqListViewUtils",],function(d,f,i,h,e,g){var c="onAddToCollectionEvent";var a=function(){if(!this.hasEvent(c)){this.addEvent(c,function(j){if(d.is(j)&&d.is(j.detail)){g.createNewRequirement(this,j.detail)}}.bind(this))}this._parent.apply(this,arguments)};var b={AnalyticsGridScrollView:i.extend({onRender:a}),AnalyticsListView:e.extend({onRender:a})};return b});define("SMAAnalyticsWidget/SMAAnalyticsLaunchView",["UWA/Core","UWA/Utils","UWA/Class/View","UWA/Class/Promise","DS/UIKIT/Mask","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLaunchModule"],function(e,f,b,h,c,i,a){var d=[];var g=b.extend({events:{onFacetSelect:"onFacetSelect",onSaveCaseClick:"_onSaveCaseClick"},_launcher:null,_caseId:"",_mcsUri:"",_analyticsContainer:null,_skeleton:null,_viewName:"launchviewpage",_refreshLaunchViewForNBChanges:false,_onSaveCaseClick:function(){},_servantSavePreProcessorPromise:function(){return new h(function(l,k){var n=document.querySelector("#analytics-frame");n=(n?n.contentWindow:undefined);if(!e.is(n)){l({})}else{var j;var m=function(p){window.clearTimeout(j);if(e.is(p)){var o={};if(e.is(p.sessionInfo,"string")&&p.sessionInfo.length>0){o.sessionInfo=p.sessionInfo}if(e.is(p.definition,"string")&&p.definition.length>0){o.definition=p.definition}l(o)}else{l()}}.bind(this);this.removeEvent("SET_SESS_DEF");this.addEvent("SET_SESS_DEF",m);n.postMessage("GET_SESS_DEF",this._mcsUri);j=window.setTimeout(l,60000)}}.bind(this))},init:function(j){this._launcher=a;this._parent(j)},onFacetSelect:function(j){if(!e.is(this.model.get("datasetsList"))){i.getObjIdFromPhyId(this.model.get("id")).then(function(l){var k=l.ObjIds[0];i.getCaseInfo(k).then(function(p){var p=UWA.Json.xmlToJson(p).CaseInfo||{};var m=[],n=p.dataSet;if(UWA.is(n)){if(Array.isArray(n)){m=n}else{m.push(n)}this.model.set("datasetsList",[]);var o=this.model.get("datasetsList");m.forEach(function(q){o.push({id:q.plmOID,name:q.name,title:q.title,physicalId:q.physicalID,type:q.typeName,fromSimulation:q.fromSimulation||""})},this)}this._launchRA(j)}.bind(this))}.bind(this))}else{this._launchRA(j)}},_launchRA:function(n){this._mcsUri=i.get3DSpaceURL();var k=this.model;this._caseId=k.get("id");widget.setValue("lastactivecase",this._caseId);if(this._skeleton===null){this._skeleton=n}if(!n.activeViews){n.activeViews=new Set()}else{if(n.activeViews.size>0){var l=false;n.activeViews.forEach(function(o){if(this.model.get("id")!==o.model.get("id")){l=true}},this);if(l){n.activeViews=new Set()}}}n.activeViews.add(this);var m=widget._frameWnd.getContent().querySelector("#analytics-frame");var j=n.history.fragment;if(e.is(j,"string")&&j.indexOf("joinexsession=true")>-1){this._launcher.joinExistingSession(widget.data.sesscaseid,widget.data.sesseed,widget.data.sessjobid,widget.data.sessstation||"",widget.data.sesstoken).then(function(o){this.model.set("running",true);this.render();i.toggleServantActionsInSkeleton(n,true);this._setUpAnalyticsLoadEvents.call(this,o)}.bind(this),this._servantLaunchFailureHandler.bind(this,n))["catch"](this._servantLaunchFailureHandler.bind(this,n))}else{if(this._refreshLaunchViewForNBChanges){m.parentNode.removeChild(m);m=undefined;this._refreshLaunchViewForNBChanges=false}if(e.is(m)&&m!==null){}else{this._launchServant().then(function(o){this.model.set("running",true);this.render();i.toggleServantActionsInSkeleton(n,true);this._setUpAnalyticsLoadEvents.call(this,o)}.bind(this),this._servantLaunchFailureHandler.bind(this,n))["catch"](this._servantLaunchFailureHandler.bind(this,n))}}this._preLoadAnalyticsHtml()},_setDataToAnalyticsFrame:function(o,k){var j={platformId:i.getPlatformId(),dashboardURL:f.isValidUrl(widget.widgetDomain)?widget.widgetDomain:"",mcsUri:k._mcsUri,widgetId:widget.id,language:widget.lang,secCtx:widget.getValue("collabspaces"),widgetViewType:widget.getView().type,caseId:k._caseId,userId:o.userId,eedServerId:k._launcher.getEEDServerId(),eedJobId:o.eedJobId||"",eerName:o.eer||"",stationDisplayName:o.eer||"",stationIP:o.eerIP||"",servantURL:o.uri,token:o.token,timeout:widget.getValue("timeout"),secureStation:o.secureStation,datasetsList:k.model.get("datasetsList")?JSON.stringify(k.model.get("datasetsList")):undefined,platformServices:JSON.stringify(window._platformServices)};if(e.is(o.userList)){j.userList=o.userList}if(e.is(o.collaborationUser)){j.collaborationUser=o.collaborationUser}var l={};if(window.localStorage&&window.localStorage.getItem){l.RAOPT_REFRESH_INTERVAL_S=window.localStorage.getItem("RAOPT_REFRESH_INTERVAL_S")}j.switches=l;var m=JSON.stringify({SERVANT_STARTED:j});var n=document.querySelector("#analytics-frame").contentWindow;n.postMessage(m,k._mcsUri)},_widgetMsgListeners:function(p){var o=this;if(e.is(p.data,"string")&&p.data.length>0){if(p.data.indexOf("LAUNCH_COMPLETE")>-1){o._onLaunchComplete.call(o)}else{if(p.data.indexOf("PAGE_CHANGE")>-1){o._onAppPageChange.call(o)}else{if(p.data.indexOf("SET_SESS_DEF")>-1){var q=p.data.split("::");var k,l;if(q.length>0){k=q[1];try{l=JSON.parse(k)}catch(p){l={}}o.dispatchEvent("SET_SESS_DEF",l)}}}}}else{if(p.data.eventType&&p.data.eventType==="CASE_MODIFIED"){if(o._skeleton!==null){if(p.data.viewSource==="RA_NOTEBOOK"){o._refreshLaunchViewForNBChanges=true}else{p.data.viewSource=o._viewName}o._skeleton.dispatchEvent("CASE_MODIFIED",p.data)}}else{if(p.data.eventType&&p.data.eventType==="NOTIFICATION"){if(p.data.eventSubType&&p.data.eventSubType===2){i.showErrorNotification("",p.data.messageText)}else{if(p.data.eventSubType&&p.data.eventSubType===1){i.showWarningNotification("",p.data.messageText)}else{if(p.data.eventSubType&&p.data.eventSubType===3){i.showSuccessNotification("",p.data.messageText)}else{i.showInfoNotification("",p.data.messageText)}}}}else{if(p.data.eventType&&p.data.eventType==="OPEN_PS"){var n=widget.id,r="preview-";if(n&&(n.substr(0,r.length)===r)){i.showWarningNotification("",i.translate("TRANSIENT_MODE_WARNING"));return}var m=p.data.data;m.envId=widget.getValue("x3dPlatformId")||"OnPremise";var j="DS/TransientWidget/TransientWidget",s={protocol:"3DXContent",version:"0.1",source:"SIMREII_AP",widgetId:widget.id,data:{items:[m]}};require([j],function(t){var u={mode:"panel",height:800,width:700};t.showWidget("SIMDISB_AP","",{X3DContentId:JSON.stringify(s)},u)})}}}}},_setUpRAFrameListener:function(){d.forEach(function(k){window.removeEventListener("message",k)});var j=this._widgetMsgListeners.bind(this);window.addEventListener("message",j);d.push(j)},onCaseModified:function(j){if(j.viewSource===this._viewName){}},_onLaunchComplete:function(){if(c.isMasked(widget.body)){c.unmask(widget.body)}},_onAppPageChange:function(){},_preLoadAnalyticsHtml:function(){this._setUpRAFrameListener.call(this);var j=this._mcsUri+"/common/emxFrameworkContextManager.jsp?forwardUrl=/simulationcentral/smaRunAdviseJob.html&SecurityContext="+widget.getValue("collabspaces");this._analyticsContainer=e.createElement("iframe",{"class":"link-frame",src:j,sandbox:"allow-same-origin allow-forms allow-scripts allow-popups allow-top-navigation allow-modals",id:"analytics-frame"})},_setUpAnalyticsLoadEvents:function(j){if(!c.isMasked(widget.body)){c.mask(widget.body)}j=e.is(j,"string")?JSON.parse(j):j;this._analyticsContainer.onload=this._setDataToAnalyticsFrame.bind(this._analyticsContainer,j,this);this.container.appendChild(this._analyticsContainer)},_launchServant:function(j){return new h(function(l,k){this._launcher.getServant(this._caseId,false).then(l,k.bind(this,j))}.bind(this))},_servantLaunchFailureHandler:function(k){var j=k.getRoute();k.setRoute(j.substring(0,j.indexOf("f="))+"f=0");if(c.isMasked(widget.body)){c.unmask(widget.body)}}});return g});define("SMAAnalyticsWidget/SMAAnalyticsDataSetCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","SMAAnalyticsWidget/SMAAnalyticsListModel","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(f,c,a,b,e){var d=a.extend({model:b,urlRoot:e.get3DSpaceURL(),url:e.get3DSpaceURL()+"/resources/slmservices/advise/listDataSets",selectedCase:"",setup:function(h,g){this.selectedCase=g._modelKey.get("id")},sync:function(g,i,h){switch(g){case"read":e.getConnectedDatasets(this.selectedCase).then(h.onComplete,h.onFailure);break;default:h.onFailure("unsupported operation");break}return{cancel:function(){}}},parse:function(i){var g=this,h=[];if(i instanceof String){i=JSON.parse(i)}if(typeof i==="undefined"||i===null){i=[]}if(typeof i.analyticsDataSet!=="undefined"&&i.analyticsDataSet!==null){if(Array.isArray(i.analyticsDataSet)){h=i.analyticsDataSet}}else{if(i.analyticsDataSetList!=="undefined"&&i.analyticsDataSetList!==null){if(Array.isArray(i.analyticsDataSetList)){h=i.analyticsDataSetList}}}if(Array.isArray(h)){h.forEach(function(k){if(k.date){try{k.date=new f.Date(k.date).toLocaleDateString()}catch(l){}}if(k.owner){k.author=k.owner}var j="";if(typeof k.owner!=="undefined"&&k.owner.length>0){j+=e.translate("OWNER")+": "+k.owner}k.content=j;k.subtitle=k.type;if(k.type&&k.type.toLowerCase().indexOf("job")>-1){k.image=e.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/simProcess.png"}else{k.image=e.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/simDoc.png"}if(k.name){k.datasetname=k.name}k.enoviaURL=e.get3DSpaceURL()})}return h}});return d});define("DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCustomView",["UWA/Core","UWA/Class/Promise","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Layout/ListView","DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCaseListViewUtils",],function(f,h,j,i,g,b){var d="onAddToCollectionEvent";var a=function(){if(!this.hasEvent(d)){this.addEvent(d,function(k){if(f.is(k)&&f.is(k.detail)){b.createNewCase(this,k.detail)}}.bind(this))}if(!this.collection.hasEvent("onSync")){this.listenTo(this.collection,{onSync:function(){b.collectionPostProcessing(this)}.bind(this)})}this._parent.apply(this,arguments)};var e=function(l,k){widget.setValue("lastactivecase",k.model.get("id"))};var c={AnalyticsGridScrollView:j.extend({onRender:a,onItemViewSelect:e}),AnalyticsTableScrollView:i.extend({onRender:a,onItemViewSelect:e}),AnalyticsListView:g.extend({onRender:a,onItemViewSelect:e})};return c});define("SMAAnalyticsWidget/SMAAnalyticsCaseCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","UWA/Utils","SMAAnalyticsWidget/SMAAnalyticsListModel","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsLauncher/SMAAnalyticsServantCache","DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCaseListViewUtils"],function(d,a,e,f,b,i,g,c){var h=e.extend({model:b,urlRoot:i.get3DSpaceURL(),addNewCaseModel:function(n){if(d.is(n)){var j=this.findWhere({id:n.id});if(j){return j}var m=this._models;this.reset();var l=new b();var k=[];l.set("id",n.id);l.set("title",n.title||"");l.set("name",n.name||"");l.set("casename",n.name||"");l.set("subtitle",i.getModifiedInterval(n.modified));l.set("project",n.project);l.set("organization",n.organization);l.set("content",n.owner);l.set("owner",n.owner||"");l.set("description",d.is(n.description,"string")?n.description:"");l.set("author",n.originator||"");l.set("downselected",0);l.set("basketPointCount",0);l.set("state",i.translate(n.currentState)||"");l.set("updatedInterval",i.getFormattedDate(n.modified));l.set("physicalId",n.physicalId);l.set("image",i.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");l.set("recommendedImage",i.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png");l.set("enoviaURL",i.get3DSpaceURL());l.set("revision",n.revision);l.set("originated",i.getFormattedDate(n.originated));if(d.is(n.dataSet)){if(!Array.isArray(n.dataSet)){n.dataSet=[n.dataSet]}n.dataSet.forEach(function(o){if(i.isValidDStype(o.typeName)){k.push({id:o.plmOID||"",physicalId:o.physicalID||"",title:o.title||"",type:o.typeName||"",name:o.name||""})}},this)}l.set("datasetsList",k);if(k.length>0){l.set("datasets",true);l.set("datasetsCount",k.length)}else{l.set("datasets",false);l.set("datasetsCount",0)}this.unshift(l);this.push(m);return l}else{return undefined}},sync:function(j,l,k){switch(j){case"read":c.collectionPreProcessing().then(function(){i.getCaseList().then(k.onComplete,k.onFailure)},k);break;default:k.onFailure("Unsupported Operation");break}return{cancel:function(){}}},parse:function(l){var j=this,k=[];if(l instanceof String){l=JSON.parse(l)}if(typeof l==="undefined"||l===null){l=[]}if(typeof l.analyticsCase!=="undefined"&&l.analyticsCase!==null){if(Array.isArray(l.analyticsCase)){k=l.analyticsCase}}else{if(l.analyticsCaseList!=="undefined"&&l.analyticsCaseList!==null){if(Array.isArray(l.analyticsCaseList)){k=l.analyticsCaseList}}}k.forEach(function(o){if(o.name){o.casename=o.name}if(o.owner){o.author=o.owner}o.title=o.title;o.content=o.owner;o.subtitle=i.getModifiedInterval(o.time);o.enoviaURL=i.get3DSpaceURL();o.updatedInterval=i.getFormattedDate(o.time);o.originated=i.getFormattedDate(o.originated);o.launchadvise=true;o.type="AnalyticsCase";if(o.state){o.state=i.translate(o.state)}var n=g.getCachedServantForCase(o.id);if(d.is(n)){o.running=true}if(typeof o.image==="undefined"||o.image===null||o.image===""){o.image=i.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png";o.recommendedImage=i.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png"}var m=o.higherRevisionExists;if(m){o.iconTitle=i.translate("HIGHER_REVISION_EXISTS");o.icon=i.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconSmallHigherRevision.png"}if(typeof o.datasetsCount!=="undefined"&&o.datasetsCount>0){o.datasets=true}else{o.datasets=false;o.datasetsCount=0}if(typeof o.requirementsCount!=="undefined"&&o.requirementsCount>0){o.requirements=true}else{o.requirements=false;o.requirementsCount=0}if(typeof o.downselected==="undefined"||o.downselected===null){o.downselected=0}if(typeof o.basketPointCount==="undefined"||o.basketPointCount===null){o.basketPointCount=0}});return k},setup:function(){widget.__caseCollection__=this},getAnalyticsCaseObject:function(k){var j=this.get(k)._attributes.physicalId;return new Promise(function(l){var m={data:{items:[{objectId:j}]}};l(m)})}});return h});define("SMAAnalyticsWidget/SMAAnalyticsDragNDrop",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Promise","DS/DataDragAndDrop/DataDragAndDrop","DS/UIKIT/Mask","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","SMAAnalyticsWidget/SMAAnalyticsSimJobWrapper","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsCaseDialog","DS/Usage/TrackerAPI",],function(g,a,j,h,i,d,k,c,b,f){var e=a.extend(j,{_settings:{_allowedPLMTypes:["Simulation","Document","Simulation Document - Versioned","Simulation Document - NonVersioned","Simulation Job","VPMReference","Requirement","Decision","Approximation","Test Execution"],_allowedfileTypes:".zrf, .nrf, .3dxml, .stp, .stpz, .jpg, .jpeg, .png, .gif, .tif, .tiff, .bmp, .flv, .avi, .mov, .wmv, .mpg, .mpeg, .mp4, .m4v, .rm, .webm, .mkv, .mp3, .wav, .aac, .m4a, .wma, .ra, .ogg, .doc, .docx, .ppt, .pptx, .pps, .ppsx, .xls, .xlsx, .xlsm, .pdf, .zip, .txt, .csv, .tsv"},_options:{},_caseId:"",_isExport:false,_dropZone:null,_frm:null,_selectedModel:null,_view:null,_TYPE_ANALYTICS_CASE:"analytics case",_onCompleteCallBack:undefined,_mask:function(l){if(!g.is(this._frm)){if(g.is(widget)&&g.is(widget._frameWnd)){this._frm=widget._frameWnd.getUIFrame()}else{this._frm=widget.body}}if(!g.is(l,"string")){l=k.translate("LOADING")}d.mask(this._frm,l)},_unmask:function(){if(g.is(this._frm)&&d.isMasked(this._frm)){d.unmask(this._frm)}},_getFileExtension:function(l){var m,n="";m=l.match(/\.([^.]+)$/);if(m!==null&&m.length===2){n=m[0].toLowerCase()}return n},_onComplete:function(l,m){this._unmask();if(g.is(l,"string")){k.showSuccessNotification("",l)}if(this._flushOnComplete===true){this._flushDropZone()}if(typeof this._onCompleteCallBack==="function"){if(g.is(m,"string")&&m.length>0){this._onCompleteCallBack(JSON.parse(m))}else{m=g.is(m)?m:{};this._onCompleteCallBack(m)}}},_onFailure:function(m,l){this._unmask();if(g.is(m,"string")&&m.length>0){k.showErrorNotification("",m)}if(this._flushOnComplete===true){this._flushDropZone()}if(typeof this._onFailureCallBack==="function"){this._onFailureCallBack(l)}},_flushDropZone:function(){this._caseId=""},_connectDatasetObjects:function(l){return new h(function(o,n){this._mask(k.translate("CONNECT_DS"));var m="";l.forEach(function(p){m+=p.objectId+";"},this);if(m.length>2){m=m.slice(0,-1);k.connectDatasetsToCase(this._caseId,m,this._isExport,this._isNewCase).then(function(p){this._unmask();p=g.is(p,"string")?JSON.parse(p):p;o(p)}.bind(this),n)}}.bind(this))},_processISightResults:function(l){return new h(function(p,o){var n=new c({caseId:this._caseId});var m=function(q){this._unmask();if(q===true){k.showWarningNotification("",k.translate("ISIGHT_RES_EXT_FAIL"))}o()};if(n.isOn()===true){n.canExtractResults(l).then(function(){this._mask(k.translate("PROCESS_ISIGHT_RES"));n.setExistingDatasets(this.view.model.get("datasetsList")||[]);n.executeJobResults().then(function(){p(n.getConnectedData());this._unmask()}.bind(this),m.bind(this,true))}.bind(this),m.bind(this,false))}else{m.call(this,false)}}.bind(this))},_createNewCase:function(m,l){this._isNewCase=false;return new h(function(o,n){if(!g.is(this._caseId,"string")||this._caseId.length===0){this._mask(k.translate("CREATING_CASE"));this._isNewCase=true;var p=function(){k.showErrorNotification("",k.translate("CREATE_CASE_FAILED"));n()};k.createAnalyticsCaseObject(m,l).then(function(r){var q=f.getCounter("RACreateAnalyticsCaseSuccess",{appID:"SIMREII_AP"});q.inc();if(g.is(r,"string")&&r.length>0){this._caseId=r;this._unmask();o(r)}else{p()}}.bind(this),p)}else{o(this._caseId)}}.bind(this))},_handleFileUpload:function(l){return new h(function(n,m){k.createDocumentObject(l.name).then(function(o){k.uploadFileTo3DSpace({oId:o,title:l.name,file:l}).then(function(){n({objectId:o,objectType:"Simulation Document - NonVersioned",displayName:l.name})},m)},m)})},_uploadFilesToPLM:function(l){this._mask(k.translate("UPLOAD_DS"));return new h(function(o,n){var m=[];[].forEach.call(l,function(p){m.push(this._handleFileUpload(p))}.bind(this));h.all(m).then(function(p){this._unmask();o(p)}.bind(this),n)}.bind(this))},_handleFileDrop:function(o,m,l){var p=function(q){var s=q[this._caseId];if(s.length===0){this._onFailure(k.translate("CONNECT_DS_FAIL"))}else{var r=this._isNewCase===true?k.translate("CREATE_CASE_SUCCESS",this._caseName):k.translate("CONNECT_DS_SUCCESS");this._onComplete(r,q)}};var n=function(){if(this._isNewCase){this._onFailure(k.translate("ERROR_FILE_UPLOAD"))}else{this._onFailure(k.translate("CONNECT_DS_FAIL"))}};this._uploadFilesToPLM(o).then(function(q){if(Array.isArray(q)&&q.length>0){this._createNewCase(m,l).then(this._processISightResults.bind(this)).then(function(r){p.call(this,r)}.bind(this),function(){this._connectDatasetObjects(q).then(function(r){p.call(this,r)}.bind(this),n.bind(this))}.bind(this))["catch"](n.bind(this))}else{n()}}.bind(this),n.bind(this))},_openDroppedCase:function(m){this._caseId=m.objectId;var l=this._view.collection.toArray();var n=l.filter(function(o){return(this._caseId===o.id||this._caseId===o.get("physicalId"))},this)[0];if(g.is(n)){this._selectedModel=n;this._onComplete(this._selectedModel)}else{this._onFailure(k.translate("CASE_OPEN_ERROR"))}},_getDroppedCases:function(l){return new h(function(n,m){if(!Array.isArray(l)){m()}var o=l.filter(function(p){return(this._TYPE_ANALYTICS_CASE===p.objectType.toLowerCase())},this);if(o.length===0){m(l)}else{n(o[0])}}.bind(this))},_handleDataDrop:function(o,m,l){var p=function(q){var s=q[this._caseId];if(s.length===0&&!this._isNewCase){this._onFailure(k.translate("CONNECT_DS_FAIL_DUP"))}else{var r=this._isNewCase===true?k.translate("CREATE_CASE_SUCCESS",this._caseName):k.translate("CONNECT_DS_SUCCESS");this._onComplete(r,q)}};var n=function(){this._onFailure(k.translate("CONNECT_DS_FAIL"))};this._getDroppedCases.call(this,o).then(this._openDroppedCase.bind(this),function(q){if(Array.isArray(q)&&q.length>0){this._createNewCase(m,l).then(this._processISightResults.bind(this)).then(function(r){p.call(this,r)}.bind(this),function(){this._connectDatasetObjects(q).then(function(r){p.call(this,r)}.bind(this),n.bind(this))}.bind(this))["catch"](n.bind(this))}else{if(g.is(this._caseId)&&this._caseId.length>0){n()}else{this._onFailure(k.translate("CONNECT_DS_FAIL_NEW"))}}}.bind(this))},_getDroppedFiles:function(o){var m=[],n;if(!g.is(o)){return[]}if(g.is(o.dataTransfer)&&g.is(o.dataTransfer.files)){n=o.dataTransfer.files}else{if(g.is(o.target)&&g.is(o.target.files)){n=o.target.files}}if(n.length>0){for(var l=0;l<n.length;l++){if(this._settings._allowedfileTypes.indexOf(this._getFileExtension(n[l].name))>-1){m.push(n[l])}}}return m},_getDroppedObjects:function(l){if(g.is(l,"string")&&l.length>0){l=JSON.parse(l);l=l.data}else{if(g.is(l,"object")){l=l.data}else{l=undefined}}if(g.is(l)&&Array.isArray(l.items)){return l.items.filter(function(m){return(this._settings._allowedPLMTypes.indexOf(m.objectType)>-1)},this)}else{return[]}},_validateDroppedObjects:function(n){var m="VALID_DS";if(g.is(n,"string")&&n.length>0){n=JSON.parse(n);n=n.data}else{if(g.is(n,"object")){n=n.data}else{n=undefined}}if(g.is(n)&&Array.isArray(n.items)){var l=n.items.length;n.items.forEach(function(o){if(o.objectType==="Analytics Case"){if(l>1){m="INVALID_DS"}else{m=o.objectId}}})}return m},_dragDrop:function(n,l,p){l.classList.remove(this._dragClass);var o=this._getDroppedObjects(n);var m=this._getDroppedFiles(p);if(Array.isArray(o)&&o.length>0){this._handleDataDrop(o,null)}else{if(Array.isArray(m)&&m.length>0){this._handleFileDrop(m,null)}else{this._onFailure(k.translate("INVALID_DS"))}}},_dragLeave:function(l){if(g.is(this._dragClass)){l.classList.remove(this._dragClass)}},_dragEnter:function(l){if(g.is(this._dragClass)){l.classList.add(this._dragClass)}},_dragOver:function(){return true},_initializeDropZone:function(){var l={over:this._dragOver.bind(this),enter:this._dragEnter.bind(this),leave:this._dragLeave.bind(this),drop:this._dragDrop.bind(this)};i.droppable(this._dropZone,l)},getAllowedFileTypes:function(){return this._settings._allowedfileTypes||""},getAllowedPLMTypes:function(){if(Array.isArray(this._settings._allowedPLMTypes)){return this._settings._allowedPLMTypes.toString()}else{return""}},setAllowedFileTypes:function(l){if(g.is(l,"string")){this._settings._allowedfileTypes=l}},setAllowedPLMTypes:function(l){var m=[];if(g.is(l,"string")){if(l.indexOf(",")>-1){m=l.split(",")}else{m.push(l)}}this._settings._allowedPLMTypes=m},setObjectId:function(l){this._caseId=l},setExportReq:function(l){this._isExport=l},setFlushFlag:function(l){this._flushOnComplete=l},handleLocalFileSelect:function(o,l){if(typeof l==="function"){this._onCompleteCallBack=l}var n=this._getDroppedFiles(o);if(Array.isArray(n)&&n.length===0){this._onFailure(k.translate("INVALID_DS_FILES"));return}if(Array.isArray(n)&&n.length>0){if(!g.is(this._caseId,"string")||this._caseId.length===0){var m=this._getNewCaseDialogOption();b.showDialog(m).then(function(p){widget.setValue("collabspaces",decodeURI(widget.getValue("createcollabspaces")));this._handleFileDrop.call(this,n,p.title,p.description)}.bind(this))["catch"](function(){console.log("File upload cancelled !!")})}else{this._handleFileDrop.call(this,n,null)}}},handleDrop:function(r,l){if(typeof l==="function"){this._onCompleteCallBack=l}var q=r.dataTransfer.getData("text");if(!UWA.is(q)||(UWA.is(q)&&q.length===0)){try{q=r.dataTransfer.getData("text/searchitems")}catch(r){}}var o=this._validateDroppedObjects(q);if(o==="INVALID_DS"){this._onFailure(k.translate("INVALID_DS_TYPES",this._allowedPLMTypesNLS()));return}else{if(o!=="VALID_DS"){k.getObjIdFromPhyId(o).then(function(t){var u=t.ObjIds[0];var s={};s[u]=[];this._onComplete(k.translate("CASE_OPENING"),s)}.bind(this));return}}if(q===""||r.dataTransfer.files.length>0){var n=this._getDroppedFiles(r);if(n.length===0){this._onFailure(k.translate("INVALID_DS_FILES"));return}}else{var p=this._getDroppedObjects(q);if(Array.isArray(p)&&p.length===0){this._onFailure(k.translate("INVALID_DS_TYPES",this._allowedPLMTypesNLS()));return}}var n=this._getDroppedFiles(r);var m=this._getNewCaseDialogOption();if(!g.is(this._caseId,"string")||this._caseId.length===0){b.showDialog(m).then(function(s){if(Array.isArray(p)&&p.length>0){this._handleDataDrop(p,s.title,s.description)}else{if(Array.isArray(n)&&n.length>0){widget.setValue("collabspaces",decodeURI(widget.getValue("createcollabspaces")));this._handleFileDrop(n,s.title,s.description)}else{this._onFailure(k.translate("INVALID_DS"))}}}.bind(this))["catch"](function(){console.log("Upload cancelled !!")})}else{if(Array.isArray(p)&&p.length>0){this._handleDataDrop(p,null)}else{if(Array.isArray(n)&&n.length>0){this._handleFileDrop(n,null)}else{this._onFailure(k.translate("INVALID_DS"))}}}},handleSPSearch:function(o,l){if(typeof l==="function"){this._onCompleteCallBack=l}if(Array.isArray(o)&&o.length>0){var n=o.filter(function(p){return(this._settings._allowedPLMTypes.indexOf(p.objectTypeValue)>-1)},this);if(Array.isArray(n)&&n.length>0){if(!g.is(this._caseId,"string")||this._caseId.length===0){var m=this._getNewCaseDialogOption();b.showDialog(m).then(function(p){this._handleDataDrop(n,p.title,p.description)}.bind(this))["catch"](function(){console.log("Upload cancelled !!")})}else{this._handleDataDrop(n,null)}}else{this._onFailure(k.translate("INVALID_SEARCH"))}}else{this._onFailure(k.translate("INVALID_SEARCH"))}},_getNewCaseDialogOption:function(){return{immersiveFrame:k.getImmersiveFrame(),header:k.translate("CREATE_CASE"),okButtonLabel:k.translate("CREATE_CASE_BUTTON")}},_allowedPLMTypesNLS:function(){var l=new Map();this._settings._allowedPLMTypes.forEach(function(n){l.set(n,k.translate(n))});var m;l.forEach(function(n){m=(!m)?n:m+","+n});return m},initializeDropUtil:function(){if(g.is(widget)&&g.is(widget._frameWnd)){this._frm=widget._frameWnd.getUIFrame()}else{this._frm=widget.body}},init:function(l){if(!g.is(l)||!g.is(l.dropZone)){return}if(g.is(widget)&&g.is(widget._frameWnd)){this._frm=widget._frameWnd.getUIFrame()}else{this._frm=widget.body}this._caseId=g.is(l.caseId,"string")?l.caseId:"";this._dropZone=g.is(l.dropZone)?l.dropZone:null;this._dragClass=g.is(l.dragClass)?l.dragClass:null;this._view=g.is(l.view)?l.view:null;this._onCompleteCallBack=typeof l.onComplete==="function"?l.onComplete:function(){};this._onFailureCallBack=typeof l.onFailure==="function"?l.onFailure:function(){};this._onTimeOutCallBack=typeof l.onTimeOut==="function"?l.onTimeOut:function(){};this._flushOnComplete=g.is(l.flushOnComplete,"boolean")?l.flushOnComplete:false;this._isExport=g.is(l.isExport,"boolean")?l.isExport:false;this._initializeDropZone.call(this)}});return e});define("SMAAnalyticsWidget/SMAAnalyticsTemplateView",["UWA/Core","UWA/Utils","UWA/Class/View","UWA/Class/Promise","DS/UIKIT/Mask","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLaunchModule"],function(e,f,b,g,c,i,a){var d=[];var h=b.extend({events:{onFacetSelect:"onFacetSelect",onSaveCaseClick:"_onSaveCaseClick",onCloseCaseClick:"onCloseCaseClick"},_launcher:null,_caseId:"",_mcsUri:"",_analyticsContainer:null,_skeleton:null,_viewName:"templateviewpage",onCloseCaseClick:function(){try{var k=widget._frameWnd.getContent().querySelector("#template-frame");if(k){k.parentNode.removeChild(k);delete this._analyticsContainer}}catch(j){console.warn("Error purging the template view.",j)}},_onSaveCaseClick:function(){},_servantSavePreProcessorPromise:function(){return new g(function(l,k){var n=document.querySelector("#template-frame");n=(n?n.contentWindow:undefined);if(!e.is(n)){l({})}else{var j;var m=function(p){window.clearTimeout(j);if(e.is(p)){var o={};if(e.is(p.sessionInfo,"string")&&p.sessionInfo.length>0){o.sessionInfo=p.sessionInfo}if(e.is(p.definition,"string")&&p.definition.length>0){o.definition=p.definition}l(o)}else{l()}}.bind(this);this.removeEvent("SET_SESS_DEF");this.addEvent("SET_SESS_DEF",m);n.postMessage("GET_SESS_DEF",this._mcsUri);j=window.setTimeout(l,60000)}}.bind(this))},init:function(j){this._launcher=a;this._parent(j)},onFacetSelect:function(n){this._mcsUri=i.get3DSpaceURL();var k=this.model;this._caseId=k.get("id");widget.setValue("lastactivecase",this._caseId);if(this._skeleton===null){this._skeleton=n}if(!n.activeViews){n.activeViews=new Set()}else{if(n.activeViews.size>0){var l=false;n.activeViews.forEach(function(o){if(this.model.get("id")!==o.model.get("id")){l=true}},this);if(l){n.activeViews=new Set()}}}n.activeViews.add(this);var m=widget._frameWnd.getContent().querySelector("#template-frame");var j=n.history.fragment;if(e.is(j,"string")&&j.indexOf("joinexsession=true")>-1){this._launcher.joinExistingSession(widget.data.sesscaseid,widget.data.sesseed,widget.data.sessjobid,widget.data.sessstation||"",widget.data.sesstoken).then(function(o){this.model.set("running",true);this.render();i.toggleServantActionsInSkeleton(n,true);this._setUpAnalyticsLoadEvents.call(this,o)}.bind(this),this._servantLaunchFailureHandler.bind(this,n))["catch"](this._servantLaunchFailureHandler.bind(this,n))}else{if(e.is(m)&&m!==null){}else{this._launchServant().then(function(o){this.model.set("running",true);this.render();i.toggleServantActionsInSkeleton(n,true);this._setUpAnalyticsLoadEvents.call(this,o)}.bind(this),this._servantLaunchFailureHandler.bind(this,n))["catch"](this._servantLaunchFailureHandler.bind(this,n))}}this._preLoadAnalyticsHtml()},_setDataToAnalyticsFrame:function(n,k){var j={platformId:i.getPlatformId(),dashboardURL:f.isValidUrl(widget.widgetDomain)?widget.widgetDomain:"",mcsUri:k._mcsUri,widgetId:widget.id,language:widget.lang,secCtx:widget.getValue("collabspaces"),widgetViewType:widget.getView().type,caseId:k._caseId,userId:n.userId,eedServerId:k._launcher.getEEDServerId(),eedJobId:n.eedJobId||"",eerName:n.eer||"",stationDisplayName:n.eer||"",stationIP:n.eerIP||"",servantURL:n.uri,token:n.token,timeout:widget.getValue("timeout"),secureStation:n.secureStation,datasetsList:k.model.get("datasetsList"),platformServices:JSON.stringify(window._platformServices)};if(e.is(n.userList)){j.userList=n.userList}if(e.is(n.collaborationUser)){j.collaborationUser=n.collaborationUser}var l=JSON.stringify({SERVANT_STARTED:j});var m=document.querySelector("#template-frame").contentWindow;m.postMessage(l,k._mcsUri)},_widgetMsgListeners:function(l){var k=this;if(e.is(l.data,"string")&&l.data.length>0){if(l.data.indexOf("LAUNCH_COMPLETE")>-1){k._onLaunchComplete.call(k)}else{if(l.data.indexOf("PAGE_CHANGE")>-1){k._onAppPageChange.call(k)}else{if(l.data.indexOf("SET_SESS_DEF")>-1){var m=l.data.split("::");var n,j;if(m.length>0){n=m[1];try{j=JSON.parse(n)}catch(l){j={}}k.dispatchEvent("SET_SESS_DEF",j)}}}}}else{if(l.data.eventType&&l.data.eventType==="CASE_MODIFIED"){if(k._skeleton!==null){l.data.viewSource=k._viewName;k._skeleton.dispatchEvent("CASE_MODIFIED",l.data)}}else{if(l.data.eventType&&l.data.eventType==="NOTIFICATION"){}}}},_setUpRAFrameListener:function(){d.forEach(function(k){window.removeEventListener("message",k)});var j=this._widgetMsgListeners.bind(this);window.addEventListener("message",j);d.push(j)},onCaseModified:function(j){if(j.viewSource===this._viewName){}},_onLaunchComplete:function(){if(c.isMasked(widget.body)){c.unmask(widget.body)}},_onAppPageChange:function(){},_preLoadAnalyticsHtml:function(){this._setUpRAFrameListener.call(this);var j=this._mcsUri+"/common/emxFrameworkContextManager.jsp?forwardUrl=../webapps/SMAAnalyticsUI/SMAAnalyticsNotebook.html&SecurityContext="+widget.getValue("collabspaces");this._analyticsContainer=e.createElement("iframe",{"class":"link-frame",src:j,sandbox:"allow-same-origin allow-forms allow-scripts allow-popups allow-top-navigation allow-modals",id:"template-frame"})},_setUpAnalyticsLoadEvents:function(j){if(!c.isMasked(widget.body)){c.mask(widget.body)}j=e.is(j,"string")?JSON.parse(j):j;this._analyticsContainer.onload=this._setDataToAnalyticsFrame.bind(this._analyticsContainer,j,this);this.container.appendChild(this._analyticsContainer)},_launchServant:function(j){return new g(function(l,k){this._launcher.getServant(this._caseId,false).then(l,k.bind(this,j))}.bind(this))},_servantLaunchFailureHandler:function(k){var j=k.getRoute();k.setRoute(j.substring(0,j.indexOf("f="))+"f=0");if(c.isMasked(widget.body)){c.unmask(widget.body)}}});return h});define("SMAAnalyticsWidget/SMAAnalyticsChartsTree",["UWA/Core","DS/Core/Core","DS/Tree/Tree","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tree/TreeNodeView","SMAAnalyticsWidget/SMAAnalyticsCustomPageTree","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(d,f,b,a,e,h,g,i){var c=function(j){g.call(this,j)};c.prototype=Object.create(g.prototype);c.prototype.constructor=c;c.prototype.initializeData=function(){var k=new e({label:"Available Charts"});for(var j in this.data){var l=this.data[j];var m=new e({label:l.title,icons:[i.get3DSpaceURL()+"/webapps/SMAAnalyticsWidget/assets/icons/"+l.icon]});k.addChild(m)}this.treeDocument.addRoot(k)};return c});define("SMAAnalyticsWidget/SMAAnalyticsRequirementCollection",["UWA/Core","UWA/Class/Collection","SMAAnalyticsWidget/SMAAnalyticsListModel","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(e,b,c,d){var a=b.extend({model:c,selectedCase:"",setup:function(g,f){this.selectedCase=f._modelKey.get("id")},addObjToCollection:function(g){if(e.is(g)){var h=this._models;this.reset();var f=new c();f.set("id",g.id);f.set("title",g.title||"");f.set("name",g.name||"");f.set("requirementname",g.name||"");f.set("icon",d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconReqTypeRequirement.png");f.set("image",d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/widgetdocthumbnail.png");f.set("subtitle",g.modified?d.getModifiedInterval(g.modified):"");f.set("owner",g.owner||"");f.set("description",g.description||"");f.set("originated",g.originated||"");f.set("modified",g.modified||"");f.set("vault",g.vault||"");f.set("policy",g.policy||"");f.set("type",g.type||"");f.set("physicalId",g.physicalId||"");f.set("state",g.state||"");f.set("revision",g.revision||"");f.set("content",g.owner||"");this.unshift(f);this.push(h);return f}},sync:function(f,h,g){switch(f){case"read":d.getConnectedRequirementsList(this.selectedCase).then(g.onComplete,g.onFailure);break;default:g.onFailure("unsupported operation");break}return{cancel:function(){}}},parse:function(g){var f=g;if(e.is(g,"string")&&g.length>0){f=JSON.parse(g)}if(!f){return null}f=f["analytics-requirement"]||f.requirementsList;if(Array.isArray(f)){f.forEach(function(h){try{if(e.is(h.originated,"string")){h.originated=new e.Date(h.originated).toLocaleDateString()}if(e.is(h.modified,"string")){h.modified=new e.Date(h.modified).toLocaleDateString()}}catch(i){}h.author=e.is(h.owner)?h.owner:"";h.content=h.author;h.subtitle=h.date?d.getModifiedInterval(h.date):"";h.type="Requirement";h.icon=d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconReqTypeRequirement.png";h.image=e.is(h.image,"string")&&h.image.length>0?h.image:d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/widgetdocthumbnail.png";h.enoviaURL=d.get3DSpaceURL();h.requirementname=e.is(h.name,"string")?h.name:""})}return f}});return a});define("DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsHistoryDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/SMAAnalyticsWidget/views/SMAAnalyticsHistoryView","i18n!DS/SMAAnalyticsNLS/assets/nls/SMAAnalyticsWidgetNLSfile"],function(f,d,c,b,e){var a={showDialog:function(i,k,j){var g=function(n){var l=f.createElement("div",{id:"caseHistory"});var m=b.render(n);l.appendChild(m.getContent());return l};var h=new d({title:e.RA_CASE_HISTORY+i,content:g(k),minWidth:600,minHeight:400,resizableFlag:true,modalFlag:true,allowMaximizeFlag:false,maximizeButtonFlag:false,immersiveFrame:j,usePaddingFlag:true,buttons:{Ok:new c({label:e.CLOSE,onClick:function(n){var l=n.dsModel;var m=l.dialog;m.close()}})}})}};return a});define("DS/SMAAnalyticsWidget/views/SMAAnalyticsAttributeView",["UWA/Core","DS/Tree/TreeListView","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/DatePicker","DS/Controls/SpinBox","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/Editor"],function(e,g,k,a,f,c,i,l,b,j){var h;var d=e.Class.extend({init:function(p){h=this;h._model=null;h._treeDocument=null;h.onChangeEvent=false;h.newComboValue=null;var o=new a({useAsyncPreExpand:true});var n=[];if(p){p.forEach(function(r){var q=new f({label:r.name,grid:r});o.addChild(q)})}h._treeDocument=o;var m=this.getAttributeViewOptions();h._attributeView=new g(m);h._attributeView.getManager().hideColumn(0);this._parent()},getAttributeViewOptions:function(){var m=this;return{height:"300px",width:"800px",enableDragAndDrop:false,isEditable:true,isSortable:true,infiniteScrolling:true,enableKeyboardNavigation:true,defaultCellHeight:41,resize:{columns:true,rows:false},columns:[{text:k.translate("TITLE"),dataIndex:"name",isEditable:false,isSortable:true,width:"auto"},{text:k.translate("DESCRIPTION"),dataIndex:"description",isEditable:false,isSortable:true,width:"15%"},{text:k.translate("VALUE"),dataIndex:"value",isEditable:false,isSortable:false,width:"23%",onCellRequest:function(p){if(!p.isHeader){var q=p.nodeModel;var o=p.manager;if(m.newComboValue){p.nodeModel.options.grid.value=m.newComboValue;m.newComboValue=null}var n=m.formatValueCell(p);p.cellView.getContent().setHTML(n)}}},{text:k.translate("TYPE"),dataIndex:"type",isEditable:false,isSortable:true,width:"auto",onCellRequest:function(o){if(!o.isHeader){var n=o.nodeModel.options.grid.type.toUpperCase();o.cellView.getContent().textContent=k.translate("ATTR_TYPE_"+n)}}},{text:k.translate("ATTR_DEFAULT"),dataIndex:"default",isEditable:false,isSortable:true,isDraggable:false,width:"20%"},{text:k.translate("ATTR_MAND"),dataIndex:"mandatory",isEditable:false,isSortable:false,width:"12%"},{text:k.translate("ATTR_INP_OUT"),dataIndex:"inputoutput",isEditable:true,isSortable:true,width:"auto"},{text:k.translate("ATTR_MIN"),dataIndex:"minimum",isEditable:false,isSortable:true,width:"auto"},{text:k.translate("ATTR_MAX"),dataIndex:"maximum",isEditable:false,isSortable:true,width:"auto"}],treeDocument:h._treeDocument}},formatValueCell:function(o){var n=o.nodeModel.options.grid;var r=n.type.toUpperCase(),q=n.choicesList.length>0?n.choicesList:[],p=p,s=n.value,u=n.valuetype,m=this.getLineEditor(n);if(u==="multivalue"){}switch(r){case"INTEGER":if(q.length>0){m=this.getCombobox(o)}else{m=this.getSpinBox(o.nodeModel.options.grid)}break;case"REAL":if(q.length>0){m=this.getCombobox(o)}else{m=this.getSpinBox(o.nodeModel.options.grid)}break;case"TIMESTAMP":m=this.getDatePicker(o.nodeModel.options.grid);break;case"STRING":if(q.length>0){m=this.getCombobox(o)}break;case"MULTILINE":m=this.getEditor(o.nodeModel.options.grid);break;case"BOOLEAN":if(q||q.length===0){n.choicesList=["True","False"]}m=this.getCombobox(o);break;default:break}var t=m.elements.container.getElementsByClassName("wux-ui-state-undefined");if(t.length>0){t[0].addClassName("wux-controls-lineeditor");t[0].removeClassName("wux-ui-state-undefined")}return m},getDatePicker:function(m){return new c({value:new Date(m.value),timePickerFlag:true,timePickerPrecision:"sec"})},getLineEditor:function(m){return new b({value:m.value,requiredFlag:m.mandatory})},getEditor:function(m){return new j({value:m.value,requiredFlag:m.mandatory,newLineMode:"Enter"})},getCombobox:function(p){var r=p.nodeModel.options.grid;var m=[],q=r.value,s=0;for(var o=0;o<r.choicesList.length;o++){if(e.typeOf(q)==="string"){if(q.toUpperCase()===r.choicesList[o].toUpperCase()){s=o}}else{if(q===r.choicesList[o]){s=o}}m[o]={labelItem:r.choicesList[o],valueItem:r.choicesList[o]}}var n=new l({elementsList:m,currentValue:m[s].labelItem,currentLabel:m[s].valueItem,enableSearchFlag:true,autocompleteFlag:true});n.addEventListener("change",function(t){t.preventDefault();t.stopPropagation();this.nodeModel.options.grid.value=t.dsModel.currentValue;this.manager.updateRowView(this.virtualRowID)}.bind(p));return n},getSpinBox:function(r){var q=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,o=r.type,m=1,n=0,p=r.value;if(o==="integer"){if(p){p=parseInt(p)}if(r.minimum){q=parseInt(r.minimum)}if(r.maximum){s=parseInt(r.maximum)}}else{if(p){p=parseFloat(p)}m=0.1;n=10;if(r.minimum){q=parseFloat(r.minimum)}if(r.maximum){s=parseFloat(r.maximum)}}return new i({value:p,minValue:q,maxValue:s,stepValue:m,decimals:n})},getView:function(){return h._attributeView}});return d});define("DS/SMAAnalyticsWidget/views/requirement/SMAAnalyticsReqListView",["UWA/Core","DS/W3DXComponents/Skeleton","DS/W3DXComponents/Views/EmptyView","DS/W3DXComponents/Collections/ActionsCollection","SMAAnalyticsWidget/SMAAnalyticsRequirementCollection","DS/SMAAnalyticsCommon/views/SMAAnalyticsContentSet","DS/SMAAnalyticsWidget/views/requirement/SMAAnalyticsReqCustomView","DS/SMAAnalyticsCommon/views/SMAAnalyticsTileView","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","SMAAnalyticsWidget/SMAAnalyticsRqtDetailView","DS/SMAAnalyticsWidget/views/requirement/SMAAnalyticsReqListViewUtils"],function(e,a,d,g,j,k,b,f,m,c,i){var l={},h=function(s,n,r){var q=n.model.get("physicalId");if(q){var p=widget.getValue("x3dPlatformId")||"OnPremise";var t={protocol:"3DXContent",version:"1.1",widgetId:widget.id,source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,data:{items:[{envId:p,objectId:q,displayName:n.model.get("name"),displayType:n.model.get("type"),objectType:n.model.get("type"),serviceId:"3DSpace"}]}};try{r.dataTransfer.setData("text/searchitems",JSON.stringify(t))}catch(o){}finally{r.dataTransfer.setData("text",JSON.stringify(t))}}else{m.showErrorNotification(m.translate("ERROR_REFRESH_PAGE"))}};l.getRenderer=function(){return{collection:j,view:k,viewOptions:{contents:{selectionMode:"oneToOne",useInfiniteScroll:false,usePullToRefresh:false,headerOnEmpty:false,viewtype:"requirements",views:[{id:"tile",view:b.AnalyticsGridScrollView,itemView:f,title:"Tile View"},{id:"list",view:b.AnalyticsListView,itemView:f}],itemViewOptions:{contextualActions:[{text:m.translate("DISCONNECT"),fonticon:"trash",handler:i.disconnectRequirement},{className:"divider"}]},emptyView:d,events:{onItemViewDrag:h}}},idCardOptions:{title:m.translate("REQUIREMENTS"),selectedFacet:0,facets:[{text:m.translate("REQUIREMENT_DET"),icon:"newspaper",handler:a.getRendererHandler(c)},{text:m.translate("PROPERTIES"),icon:"list",handler:a.getRendererHandler("plmparameters")}]}}};return l});define("DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsAttributeDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/Windows/ImmersiveFrame","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsWidget/views/SMAAnalyticsAttributeView","DS/UIKIT/Mask"],function(d,i,g,e,h,a,b){var f;var c=d.Class.extend({init:function(j,l,m){f=this;f._model=j;f._data=l;f._title=m;f._attrView=this._getContent();var k=d.createElement("div",{id:"caseAttribute"});f._attrView.inject(k);f._content=k},showDialog:function(){var l=h.getImmersiveFrame(),j=this._model.id;var k=new i({title:h.translate("RA_CASE_ATTR_GROUP")+this._title,content:this._attrView,minWidth:600,minHeight:400,resizableFlag:true,modalFlag:false,allowMaximizeFlag:true,maximizeButtonFlag:true,immersiveFrame:l,usePaddingFlag:true,buttons:{Ok:new g({disabled:false,label:h.translate("SAVE_BUTTON"),onClick:function(s){var p=s.dsModel.dialog,o=p.content,m=o.getManager(),t=m.getRoots(),n=[],r=widget._frameWnd.getUIFrame();b.mask(r,h.translate("SAVING_ATTR"));t.forEach(function(u){var v={name:u.options.grid.name,value:u.options.grid.value};n.push(v)});var q={caseid:j,attributes:n};h.setAttributes(q).then(function(u){if(u.status==="success"){h.showSuccessNotification("",h.translate("SAVE_ATTR_SUCCESS"));p.close()}else{h.showErrorNotification("",h.translate("SAVE_ATTR_FAIL"))}b.unmask(r)},function(u){h.showErrorNotification("",h.translate("SAVE_ATTR_FAIL"));b.unmask(r)})}}),Close:new g({label:h.translate("CLOSE"),onClick:function(o){var m=o.dsModel;var n=m.dialog;n.close()}})}})},_getContent:function(){var j=new a(this._data.attributes);return j.getView()}});return c});define("DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsApproximationDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/SMAAnalyticsWidget/views/SMAAnalyticsApproximationView","i18n!DS/SMAAnalyticsNLS/assets/nls/SMAAnalyticsWidgetNLSfile"],function(f,b,a,c,d){var e={showDialog:function(j,g,k){var h=function(l){var m=f.createElement("div",{id:"caseApproximation"});var n=c.render(l);m.appendChild(n);return m};var i=new b({title:d.RA_CASE_APPROXIMATION+j,content:h(g),minWidth:600,minHeight:400,resizableFlag:true,modalFlag:true,allowMaximizeFlag:false,maximizeButtonFlag:false,immersiveFrame:k,usePaddingFlag:true,buttons:{Ok:new a({label:d.CLOSE,onClick:function(n){var l=n.dsModel;var m=l.dialog;m.close()}})}})}};return e});define("SMAAnalyticsWidget/SMAAnalyticsCaseDetailsView",["UWA/Core","UWA/Class/Promise","DS/W3DXComponents/Views/Item/TileView","text!SMAAnalyticsWidget/views/SMAAnalyticsWidgetDataSetDetailsView.html","SMAAnalyticsWidget/SMAAnalyticsDragNDrop","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsLauncher/SMAAnalyticsServantCache","DS/UIKIT/Mask","DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsHistoryDialog","DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsAttributeDialog","DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsConfirmDialog","DS/SMAAnalyticsWidget/dialogs/SMAAnalyticsApproximationDialog"],function(e,j,a,h,g,m,i,c,b,d,l,k){var f=a.extend({loadingWindowedMode:false,createDrop:false,tagName:"div",className:"link-detail",model:null,defaultCaseImage:m.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png",domEvents:{"click #ra-cd-ds-remove":"addRemoveHandler","click .dataset-details-createbtn":"createClick","click #dataset-details-dsmin-remove":"removeIndividualDataSet","click #dataset-details-maturity-href":"openLifecycleWidget","click #ra-cd-owner":"openMOAPage","click #dataset-details-state-href":"openLifeCyclePage","click #ra-cd-maturity":"openLifeCyclePage","click #ra-cd-recommended":"downloadRecommendedDesigns","click #dataset-details-recommended-download":"downloadRecommendedDesigns","click #ra-cd-basketpoint":"downloadBasketPointDesigns","click #dataset-details-basketpoint-download":"downloadBasketPointDesigns","click #ra-cd-ds-download":"downloadAllDesigns","click #dataset-details-dsmin-download":"downloadAllDesigns","click #dataset-details-history":"viewCaseHistory","click .case-attribute-group":"viewAttributeGroup","click #dataset-details-add-attributes":"searchAttributes","click #dataset-attributes-dsmin-remove":"removeIndividualAttributes","click #ra-demote-button":"demoteCaseMaturity","click #ra-promote-button":"promoteCaseMaturity","click #dataset-details-approximation":"viewCaseApproximation","change #spSearchAttributes":"onChangeAttributes","change .ra-cd-ds-chkbx":"checkEventHandler","change .datasets-details-input":"persistUserInput","change .ra-cd-ds-desc-ta":"persistUserInput"},events:{onFacetSelect:"onFacetSelect"},template:function(){return h},downloadRecommendedDesigns:function(){try{if((parseInt(this.model.get("downselected"))||0)<=0){return}m.triggerFileDownload("recommended.tsv","tsv",this.model.id,document)}catch(n){this.model.set("downselected",0)}},downloadBasketPointDesigns:function(){try{if((parseInt(this.model.get("basketPointCount"))||0)<=0){return}m.triggerFileDownload("basket.tsv","tsv",this.model.id,document)}catch(n){this.model.set("basketPointCount",0)}},downloadAllDesigns:function(){m.triggerFileDownload("dataset.tsv","tsv",this.model.id,document)},downloadViewStateInfo:function(n){var p=this;try{m.getFileFrom3DSpace(n.get("id"),"ViewState.json","json").then(function(r){var q=new FileReader();q.onloadend=function(){var s=q.result;console.log("Restored ViewState Data: "+s);m.restoreViewStateInfo(s)};q.readAsText(r)},function(q){console.error("Error downloading Viewstate file: "+q)})}catch(o){}},handleDSDesignsDownload:function(o){var n=this;return new j(function(q,p){m.listCaseFiles(o).then(function(r){if(typeof r["dataset.tsv"]!=="undefined"){n.model.set("enableDownload",true);if(n.model.get("datasetsCount")>0){n.model._attributes.datasetsList[0].enableDownload=true}}else{delete n.model._attributes.enableDownload;if(n.model.get("datasetsCount")>0){delete n.model._attributes.datasetsList[0].enableDownload}}q()},function(r){console.warn("Error retrieving downselected data.",[r]);q()})})},getFullOwnerName:function(){var o=this;var n=this.model.get("owner");return new j(function(q,p){m.getFullNameFromTrigram(n).then(function(s){var r=s.firstname+" "+s.lastname;o.model.set("ownerFullName",r);o.model.set("content",r);q()},function(r){o.model.set("ownerFullName",n);o.model.set("content",n);q()})})},getFullAuthorName:function(){var o=this;var n=this.model.get("author");return new j(function(q,p){m.getFullNameFromTrigram(n).then(function(s){var r=s.firstname+" "+s.lastname;o.model.set("authorFullName",r);q()},function(r){o.model.set("authorFullName",n);q()})})},getAttributeGroups:function(){var n=this;return new j(function(p,o){m.getConnectedAttrGroups(n.model.id).then(function(q){if(!e.is(q)){n.model.set("attributeList",[]);p()}if(e.is(q,"string")){q=JSON.parse(q)}if(e.is(q)&&e.is(q.attributeGroups)){n.model.set("attributeList",q.attributeGroups)}p()},function(){console.warn("Failed to get the list of attached attribute groups.");p()})})},openLifeCyclePage:function(){var o="/common/emxNavigator.jsp?ContentPage=",n=encodeURIComponent("emxLifecycle.jsp?toolbar=SMACommon_LifecycleToolbar&header=Common.LifeCycle.PageHeading&export=false&mode=basic&HelpMarker=SMACommon_NavTreeLifecycle&emxSuiteDirectory=simulationcentral&treeLabel=Root&otherTollbarParams=&suiteKey=SimulationCentral&StringResourceFileId=smaSimulationCentralStringResource&SuiteDirectory=simulationcentral&objectId="+this.model.id+"&widgetId="+widget.id);window.open(m.get3DSpaceURL()+o+n)},openMOAPage:function(){var o="/common/emxNavigator.jsp?ContentPage=",n=encodeURIComponent("emxIndentedTable.jsp?objectId="+this.model.id+"&program=emxDomainAccess:getObjectAccessList&table=DomainAccess&editLink=true&selection=multiple&toolbar=DomainAccessToolBar&header=emxFramework.DomainAccess.AccessView&expandLevelFilter=true&editRootNode=false&objectBased=false&hideRootSelection=true&displayView=details&showClipboard=false&HelpMarker=emxhelpmultipleownershipaccess&massUpdate=false&widgetId="+widget.id);window.open(m.get3DSpaceURL()+o+n)},removeIndividualDataSet:function(n){if(!confirm(m.translate("DISCNCT_DATAST_CONFRM"))){return}var o=n.target?n.target:n.srcElement,p=this,q=o.parentNode.id||"";if(q.length===0){console.error("Dataset id is missing from the view element.");return}m.removeDatasetsFromAnalyticsCase(this.model.id,q).then(function(t){var r=p.model.get("datasetsList")||[];for(var s=0;s<r.length;s++){if(r[s].id===q){r.splice(s,1);break}}m.showSuccessNotification("",m.translate("DS_REM_SUCCESS"));p.model.dispatchEvent("onChange")},function(r){m.showErrorNotification("",m.translate("DS_REM_FAIL"))})},persistUserInput:function(o){var p=o.target?o.target:o.srcElement,q=this,r="",n="";if(!e.is(p.value,"string")||p.value.length===0||p.defaultValue===p.value){return""}switch(p.id){case"ra-casedescription":r="description";break;case"ra-casetitle":r="Title";break;default:r="";break}if(r===""){p.value=p.defaultValue;return""}n=m.textSanitize(p.value,e.is(p.id==="ra-casetitle")?true:undefined);if(n.length==0){p.value=p.defaultValue;m.showWarningNotification("",m.translate("INVALID_TXT"));return""}m.setSingleCaseAttribute(q.model.id,r,encodeURIComponent(n)).then(function(){p.defaultValue=n;this.model.set(r.toLowerCase(),n)}.bind(q),function(){p.value=p.defaultValue;m.showWarningNotification("",m.translate("ATTR_UPD_FAIL"))}.bind(q))},createClick:function(){var o=this.container.querySelector("#dataset-details-title .datasets-details-input").value||"",n=this.container.querySelector("#dataset-details-desc .datasets-details-input").value||"";if(o.length===0){alert(m.translate("NO_CASE_TITLE_ERR"))}else{m.createAnalyticsCaseObject(o,desc).then(function(p){console.log("Successfully created a new case.");widget.dispatchEvent("onRefresh")},function(p){console.log("Error creating a new case.");widget.dispatchEvent("onRefresh")})}},getImageForCase:function(n){var o=this;return new j(function(q,p){m.getFCSTicket({action:"download",title:"recommendeddesignimage.jpg",oId:n.get("id")}).then(function(r){m.downloadFile({ticket:encodeURIComponent(r.ticket),fileExtension:"jpg",url:r.fcsUrl}).then(function(s){n.set("recommendedImage",s);q()},function(s){n.set("recommendedImage",o.defaultCaseImage);n.set("image",o.defaultCaseImage);q()})},function(r){n.set("recommendedImage",o.defaultCaseImage);q()})})},updateCaseDetailsViewData:function(){return new j(function(q,p){var o=widget._frameWnd.getUIFrame();c.mask(o);var r=function(){if(c.isMasked(o)){c.unmask(o)}q()};var n=function(){if(c.isMasked(o)){c.unmask(o)}p()};m.getObjIdFromPhyId(this.model.get("id")).then(function(t){var s=t.ObjIds[0];m.getCaseInfo(s).then(function(u){try{var G=[];var u=e.Json.xmlToJson(u).CaseInfo||{};this.model.set("updatedInterval",m.getFormattedDate(u.modified));this.model.set("owner",u.owner);this.model.set("author",u.originator);this.model.set("authorFullName",u.originatorFullName);this.model.set("ownerFullName",u.ownerFullName);this.model.set("content",u.ownerFullName);this.model.set("revision",u.revision);this.model.set("description",typeof u.description==="object"?"":u.description);this.model.set("name",u.name);this.model.set("casename",u.name);this.model.set("state",m.translate(u.currentState));this.model.set("originated",m.getFormattedDate(u.originated));this.model.set("project",u.project);this.model.set("organization",u.organization);this.model.set("up_to_date",m.translate(u.up_to_date));var v=u.higherRevisionExists;if(v==="true"){this.model.set("icon",m.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconSmallHigherRevision.png")}else{this.model.set("icon","")}this.model.set("state",m.translate(u.currentState));this.model.set("subtitle",m.getModifiedInterval(u.modified));var z=u.Definition;if(e.is(z,"string")&&z.length>0){z=JSON.parse(z)}if(e.is(z.basketpoint)){var x=!isNaN(z.basketpoint)?parseInt(z.basketpoint):0;this.model.set("basketPointCount",x);if(x>0){G.push(this.handleDSDesignsDownload(this.model.get("id")))}}G.push(this.getAttributeGroups());if(e.is(z.downselected)){var D=!isNaN(z.downselected)?parseInt(z.downselected):0;this.model.set("downselected",D);if(D>0){G.push(this.getImageForCase(this.model))}else{this.model.set("image",this.defaultCaseImage)}}else{this.model.set("image",this.defaultCaseImage)}var w=[],y=u.Approximation;if(e.is(y)){this.model.set("approximationList",[]);var E=this.model.get("approximationList");if(Array.isArray(y)){w=y}else{w.push(y)}w.forEach(function(H){E.push({id:H.plmOID,name:H.name,title:H.title,type:H.typeName,revision:H.revision,owner:H.owner,modified:H.modified,description:H.description,state:H.currentState,originated:H.originated,author:H.originator,project:H.project})},this)}else{this.model.set("approximationList",[])}var F=[],B=u.dataSet;if(e.is(B)){if(Array.isArray(B)){F=B}else{F.push(B)}this.model.set("datasetsList",[]);var A=this.model.get("datasetsList");F.forEach(function(H){A.push({id:H.plmOID,name:H.name,title:H.title,physicalId:H.physicalID,type:H.typeName,fromSimulation:H.fromSimulation||""})},this)}if(G.length>0){j.all(G).then(r.bind(this),n.bind(this))}else{r()}}catch(C){n()}}.bind(this),n.bind(this))["catch"](n.bind(this))}.bind(this))}.bind(this))},onFacetSelect:function(p){m.setUserSpecificSecCtx(this);widget.setValue("lastactivecase",this.model.id);i.hasLiveServant.call(i,this.model.id).then(function(){m.toggleServantActionsInSkeleton(p,true)},function(){m.toggleServantActionsInSkeleton(p,false)});this.isInLaunchedState=true;var n=this;this.updateCaseDetailsViewData()["finally"](function(){n.render();if(e.is(i.getCachedServantForCase(n.model.id))){var r=new e.Element("div",{styles:{textAlign:"center",width:"100%",lineHeight:"7"}});r.setAttribute("id","uploadContainerblocked");r.textContent=m.translate("ADD_DS_BLOCKED");var q=document.getElementById("dataset-details-drop-zone");q.replaceChild(r,document.getElementById("dataset-drop-box"))}});try{}catch(o){}},init:function(n){if(n&&n.model){var o=this;o.model=n.model;o.createDrop=true}this._parent(arguments)},checkEventHandler:function(r){var p=r.srcElement||r.target;if(p.id==="ra-cd-ds-selectall"){var n=this.container.querySelectorAll(".ra-cd-ds-chkbx:not(#ra-cd-ds-selectall)");for(var o=0;o<n.length;o++){if(!n[o].checked===p.checked){n[o].click()}}}else{if(p.checked){p.parentElement.parentElement.classList.add("ra-cd-ds-highlighted");p.classList.add("ra-cd-ds-checked")}else{p.parentElement.parentElement.classList.remove("ra-cd-ds-highlighted");p.classList.remove("ra-cd-ds-checked");this.container.querySelector("#ra-cd-ds-selectall").checked=false}var q=this.container.querySelector("#ra-cd-ds-remove");if(this.container.querySelectorAll(".ra-cd-ds-checked").length>0){q.classList.remove("disabled")}else{if(!q.classList.contains("disabled")){q.classList.add("disabled")}}}},removeDSFromModelView:function(n){var o=this.model.get("datasetsList")||[];[].forEach.call(n,function(q){var r=q.getAttribute("data-oid")||"",p=o.length;if(r!==""){while(p--){if(o[p].id===r){o.splice(p,1);q.parentNode.removeChild(q);break}}}});this.container.querySelector("#ra-cd-ds-selectall").checked=false},removeDataSets:function(n){var o=this.container.querySelectorAll(".ra-cd-ds-tr.ra-cd-ds-highlighted"),q="",p=this;if(o.length===0){return}[].forEach.call(o,function(r){q+=r.getAttribute("data-oid")+","});if(q.substr(q.length-1)===","){q=q.substr(0,q.length-1)}m.removeDatasetsFromAnalyticsCase(this.model.id,q).then(function(r){m.showSuccessNotification("",m.translate("DS_REM_SUCCESS"));n.classList.remove("selected");p.removeDSFromModelView(o)},function(r){m.showSuccessNotification("",m.translate("DS_REM_FAIL"));n.classList.remove("selected")})},addRemoveHandler:function(p){var o=p.srcElement||p.target,n=o.parentNode;n.classList.remove("disabled");if(!n.classList.contains("selected")){[].forEach.call(document.querySelectorAll(".ra-cd-ds-button.selected"),function(q){q.classList.remove("selected")});n.classList.add("selected")}if(n.id==="ra-cd-ds-add"){}else{if(this.container.getElements(".ra-ds-row").length===0){alert(m.translate("NO_DS_CONNECTED"));n.classList.remove("selected");return}if(confirm(m.translate("DISCNCT_DATAST_CONFRM"))){this.removeDataSets(n)}else{n.classList.remove("selected")}}},handleCheckBoxes:function(o){for(var n=0;n<o.length;n++){o[n].addEventListener("change",this.checkEventHandler,false)}},handleAddRemButtons:function(){var n=this;[].forEach.call(document.querySelectorAll(".ra-cd-ds-button"),function(o){o.addEventListener("click",n.addRemoveHandler.bind(n),false)})},isValidDSObject:function(o){var n=["Simulation","Simulation Document - Versioned","Simulation Document - NonVersioned","Requirement","Decision"];if(n.indexOf(o)>-1){return true}else{return false}},itExists:function(o,n){if(n.length===0){return false}[].forEach.call(n,function(p){selectedids+=el.getAttribute("data-oid")+",";if(p.getAttribute("data-oid")===o){return true}});return false},injectDropBox:function(){var p=function(q){var s=q[this.model.id];if(!this.model.get("datasetsList")){this.model.set("datasetsList",[])}var r=this.model.get("datasetsList");s.forEach(function(t){if(m.isValidDStype(t.type)){r.push({id:t.id,name:t.name,title:t.title,physicalId:t.physicalId,type:t.type,fromSimulation:t.fromSimulation||""})}},this);this.render()};var n={caseId:this.model.id,dropZone:this.container.getElement("#dataset-details-drop-zone"),dragClass:"dropbox-hover",view:this,onComplete:p.bind(this),flushOnComplete:false};var o=new g(n)},onPostInject:function(){var o=this.container.getDocument(),n=o.querySelector(".description-section");this.injectDropBox.call(this);if(typeof n!=="undefined"&&n!==null){o.querySelector(".description-section").hide()}},onRender:function(){var p=this.container.getElementsByClassName("ra-create-input-page-container");var o=e.createElement("ra-create-input-page",{"flush-on-complete":"true"});if(p){o.objectId=this.model.id;var n={title:m.translate("DROP_DS"),upload:m.translate("UPLOAD"),dragdrop:m.translate("DDHERE"),search:m.translate("SEARCH")};o.raTitle=n;o.isExportReq=false;o.hideUpload=false;o.style.width="100%";o.plmTypes="Simulation,Document,Simulation Document - Versioned,Simulation Document - NonVersioned,Simulation Job,VPMReference,Requirement,Decision,Approximation,Test Execution";o.fileTypes=".zrf, .nrf, .xls, .xlsx, .xlsm, .zip, .csv, .tsv";o.addEventListener("onDataUploadCompleteEvent",function(q){var r=q.detail;var t=r[this.model.id];if(!this.model.get("datasetsList")){this.model.set("datasetsList",[])}var s=this.model.get("datasetsList");t.forEach(function(u){if(m.isValidDStype(u.type)){s.push({id:u.id,name:u.name,title:u.title,physicalId:u.physicalId,type:u.type,fromSimulation:u.fromSimulation||""})}},this);this.render()}.bind(this));p[0].appendChild(o)}return true},viewCaseHistory:function(n){var o=this;var p=widget._frameWnd.getUIFrame();c.mask(p);m.getCaseHistory(this.model.get("id")).then(function(q){b.showDialog(o.model.get("title"),q.history,m.getImmersiveFrame());c.unmask(p)},function(q){c.unmask(p);m.showErrorNotification("",m.translate("HIST_VIEW_FAIL"))})},viewAttributeGroup:function(o){var p=o.target?o.target:o.srcElement,q=this,s=p.parentNode.id||"",t=p.parentNode.title||"",r=widget._frameWnd.getUIFrame(),n=this.model.id;if(s.length===0){console.error("Attribute id is missing from the view element.");return}c.mask(r);m.getAttributes(n,s).then(function(v){var u=new d(q.model,v,t);u.showDialog();c.unmask(r)},function(u){c.unmask(r);m.showErrorNotification("",m.translate("ATTR_VIEW_FAIL"))})},viewCaseApproximation:function(n){var o=n.target?n.target:n.srcElement,p=this,r=o.parentNode.id||"",s=o.parentNode.title||"",q=widget._frameWnd.getUIFrame();if(r.length===0){console.error("Approximation id is missing from the view element.");return}c.mask(q);m.getCaseHistory(r).then(function(t){var w=p.model.get("approximationList"),u="",v={};w.forEach(function(x){if(x.id===r){u=x}});v.data=u;v.history=t.history;v.immersiveFrame=m.getImmersiveFrame();k.showDialog(s,v,m.getImmersiveFrame());c.unmask(q)},function(t){c.unmask(q);m.showErrorNotification("",m.translate("HIST_VIEW_FAIL"))})},searchAttributes:function(){if(this.isTransientRAWidget()){return}var n=document.getElementById("spSearchAttributes");n.search()},demoteCaseMaturity:function(n){var o=this.model.get("state"),q=this;if(o===m.translate("Private")){m.showWarningNotification("",m.translate("CASE_CANNOT_DEMOTE"));return}var p={immersiveFrame:m.getImmersiveFrame(),label:m.translate("RA_CASE_DEMOTE"),header:m.translate("ARE_YOU_SURE"),};l.showDialog(p).then(function(){m.demoteCase(q.model.id).then(function(r){if(r.status==="success"){q.updateCaseDetailsViewData()["finally"](function(){q.render()})}else{m.showErrorNotification("",m.translate("CASE_DEMOTE_FAILED"))}},function(r){m.showErrorNotification("",m.translate("CASE_DEMOTE_FAILED"))}.bind(q))}.bind(q))},promoteCaseMaturity:function(n){var o=this.model.get("state"),q=this;if(o===m.translate("Obsolete")){m.showWarningNotification("",m.translate("CASE_CANNOT_PROMOTE"));return}var p={immersiveFrame:m.getImmersiveFrame(),label:m.translate("RA_CASE_PROMOTE"),header:m.translate("ARE_YOU_SURE"),};l.showDialog(p).then(function(){m.promoteCase(q.model.id).then(function(r){if(r.status==="success"){q.updateCaseDetailsViewData()["finally"](function(){q.render()})}else{m.showErrorNotification("",m.translate("CASE_PROMOTE_FAILED"))}},function(r){m.showErrorNotification("",m.translate("CASE_PROMOTE_FAILED"))}.bind(q))}.bind(q))},removeIndividualAttributes:function(n){if(!confirm(m.translate("DISCNCT_ATTR_CONFRM"))){return}var o=n.target?n.target:n.srcElement,p=this,r=o.parentNode.id||"",q=widget._frameWnd.getUIFrame();if(r.length===0){console.error("Attribute id is missing from the view element.");return}c.mask(q,m.translate("ATTR_DISCONNECTING"));m.disconnectAttrGroup(this.model.id,r).then(function(v){var s=v.error;if(s){m.showErrorNotification("",m.translate("ATTR_REM_FAIL"))}else{var u=p.model.get("attributeList")||[];for(var t=0;t<u.length;t++){if(u[t].id===r){u.splice(t,1);break}}m.showSuccessNotification("",m.translate("ATTR_REM_SUCCESS"));p.model.dispatchEvent("onChange")}c.unmask(q)},function(s){m.showErrorNotification("",m.translate("ATTR_REM_FAIL"));c.unmask(q)})},isTransientRAWidget:function(){var n=widget.id,o="preview-";if(n&&(n.substr(0,o.length)===o)){m.showWarningNotification("",m.translate("TRANSIENT_MODE_WARNING"));return true}return false},openLifecycleWidget:function(){if(this.isTransientRAWidget()){return}var n="DS/TransientWidget/TransientWidget",q=this.model.get("physicalId"),p=this.model.get("title");var o={protocol:"3DXContent",version:"0.1",source:"SIMREII_AP",widgetId:widget.id,data:{items:[{envId:widget.getValue("x3dPlatformId")||"OnPremise",objectId:q,displayName:p,objectType:this.model.get("type"),displayType:this.model.get("type")}]}};if(q){require([n],function(r){var s={mode:"panel",height:800,width:700};r.showWidget("ENOLCMI_AP",p,{X3DContentId:JSON.stringify(o)},s)})}},onChangeAttributes:function(p){var q=this;if(!this.model.get("attributeList")){this.model.set("attributeList",[])}var o=this.model.get("attributeList");var n=p.detail.getSelectedObjects();var s=[];n.forEach(function(u){var t=false;o.forEach(function(v){if(v.physicalId===u.objectId){t=true}});if(!t){s.push(u.objectId)}});if(s.length===0){m.showWarningNotification("",m.translate("ATTR_ADD_DUP"))}else{var r=widget._frameWnd.getUIFrame();c.mask(r,m.translate("ATTR_CONNECTING"));m.connectAttrGroupsToCase(q.model.id,s).then(function(t){t=e.is(t,"string")?JSON.parse(t):t;var v=t.error;if(v){m.showErrorNotification("",v)}else{var u=t.success;u.forEach(function(w){o.push({id:w.id,name:w.name,title:w.title,physicalId:w.physicalId,type:w.type})},q);q.render();m.showSuccessNotification("",m.translate("ATTR_ADD_SUCCESS"))}c.unmask(r)},function(t){c.unmask(r);m.showErrorNotification("",m.translate("ATTR_ADD_FAIL"))})}}});return f});define("SMAAnalyticsWidget/SMAAnalyticsParametersTree",["UWA/Core","DS/Core/Core","DS/Tree/TreeNodeModel","DS/Tree/TreeNodeView","SMAAnalyticsWidget/SMAAnalyticsCustomPageTree","DS/SMAAnalyticsUI/SMAAnalyticsSvgShapes","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/Windows/Dialog","DS/Controls/Button","DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils"],function(b,d,c,g,e,i,j,k,h,a){var f=function(l){e.call(this);this.initialized=false;this.roots={};this.parameterIdNodeMap={};this.shapeGenerator=new i();this.cpProxy=l};f.prototype=Object.create(e.prototype);f.prototype.constructor=f;f.prototype.addRoot=function(l){var m=l.ID||l.id;this.removeRoot(m);this.roots[m]=this.makeNode(l);this.treeDocument.addRoot(this.roots[m])};f.prototype.setData=function(m){for(var l in this.roots){this.removeRoot(l)}this.addData(m)};f.prototype.removeRoot=function(l){if(typeof this.roots[l]==="undefined"){return}try{this.treeDocument.removeRoot(this.roots[l])}catch(m){}delete this.roots[l]};f.prototype.addData=function(l){if(!this.initialized){this.data(l);return}var m=this;if(!(this.data() instanceof Array)){this._data=[this.data()]}if(!(l instanceof Array)){l=[l]}l.forEach(function(n){m.addRoot(n)})};f.prototype.makeNode=function(l){var o=this;var r=l.properties&&l.properties.name?l.properties.name:l.displayName;var m={id:l.ID||l.id,source:l.source||"",properties:l};m.properties.id=m.properties.ID||m.properties.id;if(typeof l.name!=="undefined"){m.name=l.name}if(l.type=="CONSTRAINT"){m.type="CONSTRAINT"}else{if(typeof l.groups!=="undefined"||typeof l.parameters!=="undefined"){m.type="GROUPS"}else{m.type="PARAMETER"}}var p={label:decodeURIComponent(r),data:m,grid:{colorShapeMap:{colorMap:"",shapeMap:""}}};if(m.type==="PARAMETER"){p.grid=this.getParameterMaps(m);var q=l.role||"UNKNOWN";q=q.toLowerCase();if(q==="input"){p.icons=[{iconName:"login"}]}else{if(q==="output"){p.icons=[{iconName:"logout"}]}}}var n=new c(p);if(m.type==="PARAMETER"){this.parameterIdNodeMap[m.properties.id]=n}n.onPostCollapse(function(s){o.onCollapse(l.id)});n.onPostExpand(function(s){o.onExpand(l.id)});var o=this;if(typeof l.groups!=="undefined"){l.groups.forEach(function(s){s.source=s.source||l.source||l.id;n.addChild(o.makeNode(s))})}if(typeof l.parameters!=="undefined"){l.parameters.forEach(function(s){s.source=s.source||l.source||l.id;if(s.structure!=="ARRAY"){n.addChild(o.makeNode(s))}})}if(m.properties.id&&this.expandedNodesMap[m.properties.id]){n.expand()}return n};f.prototype.getParameterMaps=function(m){var l={colorShapeMap:{colorMap:"",shapeMap:""}};if(typeof m.properties.colorMap!=="undefined"){l.colorShapeMap.colorMap=m.properties.colorMap}if(typeof m.properties.shapeMap!=="undefined"){l.colorShapeMap.shapeMap=m.properties.shapeMap}return l};f.prototype.colorShapeMapToElement=function(v){if(!v.nodeModel.options.grid.colorShapeMap){console.log("No colorShapeMap:");console.log(v.nodeModel.options.grid);return}var o=v.nodeModel.options.grid.colorShapeMap.colorMap||{};var l=o.colors;var n=v.cellView.reuseCellContent("colorShapeMapElement");n.setHTML("");var r=null;if(typeof l!=="undefined"){if(o.type=="linear"){r=new b.Element("div",{styles:{height:"20%",padding:"5%",background:"linear-gradient(to right, "+l[0]+", "+l[1]+")",width:"100%"}})}else{r=new b.Element("div",{styles:{height:"20%",width:"100%",display:"flex"}});var p=4;if(l.length<p){p=l.length}for(var u=0;u<l.length;u++){if(u>2&&u!=l.length-1){continue}var t=new b.Element("div",{styles:{height:"100%",width:100/p+"%"}});if(!(u==2&&u!=l.length-1)){t.style.backgroundColor=l[u]}r.appendChild(t)}}n.appendChild(r)}var q=v.nodeModel.options.grid.colorShapeMap.shapeMap||{};var m=q.shapes;if(typeof m!=="undefined"){var s=new b.Element("div",{styles:{height:r===null?"60%":"40%",padding:"5%",width:"100%"}});symbolComponent=null;for(var u=0;u<m.length;u++){if(u>2&&u!=m.length-1){continue}if(u==2&&u!=m.length-1){symbolComponent=new b.Element("div",{styles:{height:"100%",width:"25%"}})}else{symbolComponent=this.shapeGenerator.generate({imgHeight:10,imgWidth:10,shape:m[u].toLowerCase()})}s.appendChild(symbolComponent)}n.appendChild(s)}else{if(r!==null){r.style.height="55%"}}};f.prototype.filterMapToElement=function(p){try{if(!window.localStorage.getItem("RA_EXPERIMENTAL")){return}}catch(o){return}var n=p.nodeModel.options.data;var q=p.cellView.reuseCellContent("colorShapeMapElement");q.setHTML("");var m=this;if(n.id==="Requirements"){}else{if(n.type==="PARAMETER"){var l=new b.Element("img",{src:j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/filter_inactive.png",styles:{height:"50%",width:"100%",position:"relative",top:"8px"}});if(n.properties.filters){l=new b.Element("img",{src:j.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/filter_active.png",styles:{height:"50%",width:"100%",position:"relative",top:"8px"}})}q.appendChild(l);q.addEvent("click",function(r){console.log("clicked for:");console.log(n);m.editFilter(n)})}}};f.prototype.editFilter=function(C){var s=this;var t=j.getImmersiveFrame();var l=new b.Element("div");var B=document.createElement("table");var A=document.createElement("tr");var o=document.createElement("td");o.textContent=a.translate("Range");var m=document.createElement("td");m.textContent="["+C.properties.min+", "+C.properties.max+"]";A.appendChild(o);A.appendChild(m);var y=document.createElement("tr");var w=document.createElement("td");w.textContent=a.translate("Filter less than");var v=document.createElement("td");var u=document.createElement("input");v.appendChild(u);y.appendChild(w);y.appendChild(v);var x=document.createElement("tr");var r=document.createElement("td");r.textContent=a.translate("Filter greater than");var q=document.createElement("td");var p=document.createElement("input");q.appendChild(p);x.appendChild(r);x.appendChild(q);var n=[null,null];if(C.properties.filters){C.properties.filters.forEach(function(D){if(D.type==="GREATER_THAN"){n[1]=D.boundValue}else{n[0]=D.boundValue}})}u.value=n[0]===null?"":n[0];p.value=n[1]===null?"":n[1];B.appendChild(A);B.appendChild(y);B.appendChild(x);var z=new k({title:a.translate("Filter")+"-"+C.properties.displayName||C.properties.name,content:B,immersiveFrame:t,buttons:{Cancel:new h({onClick:function(F){var D=F.dsModel;var E=D.dialog;console.log("on Cancel button : dialog title = "+E.title);E.close()}}),Ok:new h({onClick:function(F){var D=F.dsModel;var E=D.dialog;console.log("on OK button : dialog title = "+E.title);E.close();console.log(C);if(s.cpProxy){}}})}})};f.prototype.initializeData=function(){this.initialized=true;this.registerReusableContent();if(this.data() instanceof Array){this.data().forEach(function(l){this.addRoot(l)})}else{this.addRoot(this.data())}};f.prototype.registerReusableContent=function(){var l=this;this.tree.getManager().registerReusableCellContent({id:"colorShapeMapElement",buildContent:l.getColorShapeMapElement})};f.prototype.getColorShapeMapElement=function(){var l=new b.Element("div",{styles:{display:"flex","vertical-align":"middle",height:"100%",width:"100%","flex-direction":"column"}});return l};return f});define("SMAAnalyticsWidget/SMAAnalyticsDOCollection",["UWA/Core","UWA/Class/Collection","SMAAnalyticsWidget/SMAAnalyticsListModel","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy"],function(e,a,b,d){var c=a.extend({model:b,selectedCase:"",setup:function(g,f){this.selectedCase=f._modelKey.get("id")},addObjToCollection:function(g){if(e.is(g)){var h=this._models;this.reset();var f=new b();f.set("id",g.id);f.set("title",g.title||g.name||"");f.set("name",g.name||"");f.set("requirementname",g.name||"");f.set("image",d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/widgetdocthumbnail.png");if(g.type==="Requirement"){f.set("icon",d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconReqTypeRequirement.png")}else{if(g.type==="Decision"){f.set("icon",d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconSmallDecision.gif")}}f.set("subtitle",g.modified?d.getModifiedInterval(g.modified):"");f.set("owner",g.owner||"");f.set("content",g.owner||"");f.set("description",g.description||"");f.set("originated",g.originated||"");f.set("modified",g.modified||"");f.set("vault",g.vault||"");f.set("policy",g.policy||"");f.set("state",g.state||"");f.set("type",g.type||"");f.set("physicalId",g.physicalId||"");f.set("revision",g.revision||"");this.unshift(f);this.push(h);return f}},sync:function(g,j,h){switch(g){case"read":var f=this.selectedCase;var i;d.getConnectedDecisions(f).then(function(k){i=k;d.getConnectedRequirementsList(f,true).then(function(l){if(l&&l.requirementsList){i=i.concat(l.requirementsList)}h.onComplete(i)},function(){h.onComplete(i)})},h.onFailure);break;default:h.onFailure("unsupported operation");break}return{cancel:function(){}}},parse:function(g){var f=g;if(e.is(g,"string")&&g.length>0){f=JSON.parse(g)}if(Array.isArray(f)){f.forEach(function(h){try{if(e.is(h.originated,"string")){h.originated=new e.Date(h.originated).toLocaleDateString()}if(e.is(h.modified,"string")){h.subtitle=d.getModifiedInterval(h.modified);h.modified=new e.Date(h.modified).toLocaleDateString()}}catch(i){}h.title=h.title||h.name||" ";h.subtitle=h.modified?d.getModifiedInterval(h.modified):"";h.author=e.is(h.owner)?h.owner:"";h.content=h.owner;h.image=e.is(h.image,"string")&&h.image.length>0?h.image:d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/widgetdocthumbnail.png";if(h.type==="Requirement"){h.icon=d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconReqTypeRequirement.png"}else{if(h.type==="Decision"){h.icon=d.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/iconSmallDecision.gif"}}h.enoviaURL=d.get3DSpaceURL();h.requirementname=e.is(h.name,"string")?h.name:""})}return f}});return c});define("SMAAnalyticsWidget/SMAAnalyticsCustomPageView",["UWA/Core","DS/Core/Core","UWA/Class/Promise","DS/W3DXComponents/Views/Item/TileView","text!SMAAnalyticsWidget/views/SMAAnalyticsWidgetCustomPageView.html","SMAAnalyticsWidget/SMAAnalyticsCustomPageProxy","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils","WebappsUtils/WebappsUtils","SMAAnalyticsWidget/SMAAnalyticsParametersTree","SMAAnalyticsWidget/SMAAnalyticsChartsTree","SMAAnalyticsWidget/SMAAnalyticsSetupDataProvider","DS/Windows/ImmersiveFrame","DS/ApplicationFrame/FrameWindow","DS/Windows/Panel","DS/Windows/Dialog","DS/UIKIT/Mask","DS/SMAAnalyticsLauncher/SMAAnalyticsWidgetLaunchModule","DS/SMAAnalyticsCompareTable/SMAAnalyticsHierarchicalTable","DS/SMAAnalyticsCompareTable/SMAAnalyticsDetailsTable","DS/SMAAnalyticsUtils/SMAAnalyticsParseUtils"],function(h,a,c,s,b,l,o,i,f,e,j,u,m,t,r,g,w,d,q,n,k){console.log("Defining custom page...");var v=new l();var p=s.extend({events:{onFacetSelect:"onFacetSelect",onSaveCaseClick:"onSaveCaseClick",onCloseCaseClick:"onCloseCaseClick"},loadingWindowedMode:false,newCaseMode:false,createDrop:false,tagName:"div",className:"link-detail",model:null,_chartsConfig:{},_viewName:"customchartspage",_launcher:null,_launchDialog:null,_servantDetails:null,_caseDirty:false,_caseModifiedEvents:[],_datasetId:null,maxAlternateivesInInformationPanel:10,template:function(){return b},_servantLaunchFailureHandler:function(y){var x=y.getRoute();y.setRoute(x.substring(0,x.indexOf("f="))+"f=0")},_launchServant:function(x){return new c(function(z,y){this._launcher.getServant(x,false).then(z,y)}.bind(this))},_populateParametermap:function(y,x){for(var B in x.parameters){var C=x.parameters[B];y.set(C.ID,C)}for(var z in x.groups){var A=x.groups[z];this._populateParametermap(y,A)}},defaultPanelSetting:function(){return{currentDockArea:4,height:-1,width:-1}},viewState:{},domEvents:{},defaultCaseImage:o.get3DSpaceURL()+"/webapps/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png",onFacetSelect:function(z){try{if(document.querySelector(".panel.right.active").style.transform.split("(")[1].split(",").map(function(A){return Number(A.split("px")[0])})[0]>10){document.querySelectorAll(".skeleton-ctrl-collapse")[1].click()}}catch(y){}w.mask(this.frmWindow.getContent());var x=this.model;this._caseId=x.get("id");z.activeViews.add(this);this._launchServant(x.get("id")).then(function(F){if(h.is(F,"string")){F=JSON.parse(F)}this._servantDetails=F;v.setServantDetails(F);v.syncWithServant();o.toggleServantActionsInSkeleton(z,true);if(!this.initialized){this.initialize(F.uri)}else{if(this.initialized===true){var C=document.querySelector("ra-dataprovider");if(C){C.setRequestProcessor(function(G){G.setRequestHeader("X-CSRFToken",F.token);G.setRequestHeader("ra-from-user",F.userId)});C.setServerURL(F.uri,F.token,F.userId)}if(this._caseDirty){var D=false;this._caseModifiedEvents.forEach(function(H){if(H.eventSubType==="constraintChanged"||H.eventSubType==="parametersDeleted"){D=true}else{if(H.eventSubType==="parameterChanged"){D=true;var G=new Map();this._populateParametermap(G,H.modifiedGroup);H.parameterMap=G}}}.bind(this));if(D){var E=this;this.updateParameterTrees().then(function(){E.updateAllParamMapsInParamTree()})}var A=document.querySelector("ra-simplecontainer");if(A){var B={eventType:"CASE_MODIFIED",events:this._caseModifiedEvents};A.propagateChartEvent(B,[A])}this._caseDirty=false;this._caseModifiedEvents=[]}}}w.unmask(this.frmWindow.getContent())}.bind(this),function(){this._servantLaunchFailureHandler(z)}.bind(this))},registerHierarchyTable:function(){var x={isLink:function(B){if(B.startsWith("http://")||B.startsWith("https://")){return true}return false},formatExp:function(E,C){C=C||4;var F=d3.format("."+(C-1)+"e");var B;var D;if(String(E).length<=C+4){return String(E).replace(/\+/g,"")}if(String(E)[0]==="-"){C--}B=d3.format("."+(C+1)+"g");D=B(E).replace(/\+/g,"");if(D.length<=C+4){return D}return F(E).replace(/\+/g,"")},getScrollWidth:function(){if(window._RA_SCROLL_WIDTH){return window._RA_SCROLL_WIDTH}var C=document.createElement("div");document.body.appendChild(C);C.style.position="absolute";C.style.width="100px";C.style.height="100px";C.style.overflow="scroll";C.style.top="-9999px";var B=C.offsetWidth-C.clientWidth;document.body.removeChild(C);window._RA_SCROLL_WIDTH=B;return B}};var y=function(){};function A(){this.styleSheet=null;this.styleRules={}}A.prototype.setStyleSheet=function(B){this.styleSheet=B};A.prototype.addStyle=function(D,C,B){if(typeof this.styleRules[D]==="undefined"){this.styleSheet.insertRule(D+" { "+C+" : "+B+" }",0);this.styleRules[D]=this.styleSheet.cssRules[0]}else{this.styleRules[D].style[C]=B}};A.prototype.removeStyle=function(C,B){if(typeof this.styleRules[C]!=="undefined"){this.styleRules[C].style[B]=""}};var z=function(){this.setUploadWrapperElement=y;this.uploadFilesWithDragDrop=y;this.setSuccessCallBack=y};q.registerTableWebComponents(document,v.__proto__,x,A,z,"SMAAnalyticsCompareTable")},init:function(x){this.registerHierarchyTable();if(x&&x.model){this.model=x.model}this._parent(arguments);this.frmWindow=new t({viewer:"none",height:"100%"});this.frmWindow.getViewerFrame().style.background="white";this.frmWindow.inject(this.container);this.uiFrame=this.frmWindow.getUIFrame();this.uiFrame.insertAdjacentHTML("afterbegin",b);this.immersiveFrame=this.frmWindow.getImmersiveFrame();this._launcher=d;this._launcher.setFrameWindow(widget._frameWnd);this.shadystuff()},shadystuff:function(){this.container.setAttribute("draggable","");d3.select(this.uiFrame).style({height:"100%",width:"100%"});d3.select(this.uiFrame.parentElement).style({bottom:"0px"})},getPanelProperty:function(y,x){if(typeof this.viewState[y]!=="undefined"){return this.viewState[y][x]}},storePanelProperty:function(z,x,y){if(typeof this.viewState[z]==="undefined"){this.viewState[z]={}}this.viewState[z][x]=y},setupDefaultPanels:function(C){var A=this;this.descriptorsPanelContent=document.createElement("div");this.dataPanelContent=document.createElement("div");this.formatPanelContent=document.createElement("div");this.informationPanelContent=h.createElement("div");this.informationPanelContent.setAttribute("id","infoPanel");this.informationPanelContent.classList.add("no_alts");this.informationPanelContent.style.width="100%";this.informationPanelContent.style.height="100%";this.informationPanelContent.style["background-color"]="white";this.infoLabel=document.createElement("div");this.infoLabel.classList.add("ra-moreinfolabel");this.informationPanelContent.appendChild(this.infoLabel);this.stylePanelContent=document.createElement("div");var y=document.createElement("div");y.textContent=i.translate("NO_CHART_SELECTED");this.stylePanelContent.appendChild(y);if(this.descriptorsPanel){this.descriptorsPanel.content=this.descriptorsPanelContent}else{this.descriptorsPanel=this.getPanel({title:i.translate("Charts"),content:this.descriptorsPanelContent,currentDockArea:2,height:175,width:1000,resizableFlag:true,identifier:"CustomPageViewChartsPanel"},"descriptorsPanel")}if(this.dataPanel){this.dataPanel.content=this.dataPanelContent}else{this.dataPanel=this.getPanel({title:i.translate("Data"),content:this.dataPanelContent,currentDockArea:4,resizableFlag:true,minWidth:150,minHeight:150,height:600,width:350,identifier:"CustomPageViewDataPanel"},"dataPanel")}if(this.formatPanel){this.formatPanel.content=this.formatPanelContent}else{this.formatPanel=this.getPanel({title:i.translate("Configuration"),content:this.formatPanelContent,currentDockArea:8,height:350,width:500,resizableFlag:true,identifier:"CustomPageViewParametersPanel"},"formatPanel")}if(this.informationPanel){this.informationPanel.content=this.informationPanelContent}else{this.informationPanel=this.getPanel({title:i.translate("Selection Information"),content:this.informationPanelContent,currentDockArea:8,height:350,width:500,resizableFlag:true,identifier:"CustomPageViewInformationPanel"},"informationPanel")}var z={formatPanel:this.formatPanel,dataPanel:this.dataPanel,descriptorsPanel:this.descriptorsPanel,informationPanel:this.informationPanel};var B,x;for(B in z){x=z[B];x.addEventListener("resize",function(D){console.log(B+" resized!")});x.addEventListener("move",function(D){console.log(B+" moved!")});x.addEventListener("placechange",function(D){console.log(B+" changed!")});x.addEventListener("stopWindowDrag",function(D){console.log("End Format drag!");D.dsModel.customPageHandle.panelEventHandler(B,D)});x.addEventListener("stopResize",function(D){console.log("End Format Resize!");D.dsModel.customPageHandle.panelEventHandler(B,D)})}},panelEventHandler:function(z,y){var x=y.dsModel;this.storePanelProperty(z,"currentDockArea",x._properties.currentDockArea.value);this.storePanelProperty(z,"width",x._properties.width.value);this.storePanelProperty(z,"height",x._properties.height.value);if(z==="informationPanel"){this.resizeInformationPanel()}},getPanel:function(y,z){y.immersiveFrame==undefined?(y.immersiveFrame=this.immersiveFrame):"";y.closeButtonFlag==undefined?(y.closeButtonFlag=false):"";y.resizableFlag==undefined?(y.resizableFlag=true):"";y.currentDockArea==undefined?(y.currentDockArea=this.getPanelProperty(z,"currentDockArea")):"";y.width==undefined?(y.width=this.getPanelProperty(z,"width")):"";y.height==undefined?(y.height=this.getPanelProperty(z,"height")):"";y.position==undefined?(y.position=this.getPanelProperty(z,"position")):"";if(y.position==undefined){delete y.position}var x=new r(y);x.customPageHandle=this;return x},initializeParameterTree:function(){this.parameterTree=new e(v);var x=this.parameterTree.tree.getContent();if(x){x.classList.add("ra-datatree")}this.paramRootNodes={}},initializeStylePanel:function(){var x=v.getServerFileUrl("/SMAAnalyticsCharting/stylePanel/ra-stylepanel.html");var y=this.stylePanelContent;Polymer.Base.importHref(x,function(){var A=document.createElement("ra-stylepanel");A.setAttribute("id","stylePanel");var z=document.querySelector("ra-simplecontainer");if(z){z.setStylePanel(A)}y.appendChild(A)})},initializeControls:function(){var x=v.getServerFileUrl("/SMAAnalyticsCharting/controlPanels/ra-controlpanel.html");var y=this.formatPanelContent;Polymer.Base.importHref(x,function(){var A=document.createElement("ra-controlpanel");A.setAttribute("id","formatControlPanel");A.setAttribute("data-rec-id","customcharts.controlpanel");var z=document.querySelector("ra-simplecontainer");if(z){z.setControlPanel(A)}y.appendChild(A)})},initializeGridContainer:function(A){var z=this;var x=v.getServerFileUrl("/SMAAnalyticsCharting/chartContainers/ra-simplecontainer.html");var y=this.container.querySelector("ra-dataprovider");Polymer.Base.importHref(x,function(G){var E=document.createElement("ra-simplecontainer");E.chartBaseUrl(v.getServerFileUrl);var D=document.getElementById("mainContentDiv").querySelector("ra-simplecontainer");D?D.parentElement.removeChild(D):null;document.getElementById("mainContentDiv").appendChild(E);E.setDataProvider(y);E.set3DSpaceURL(o.get3DSpaceURL());var I=document.getElementById("formatControlPanel");if(I){E.setControlPanel(I)}var B=document.getElementById("stylePanel");if(B){E.setStylePanel(B)}E.setEventBridge(z);window.DS.RAObjects.parameterToColorMap={};window.DS.RAObjects.userColersForParameterSet=new Set();window.DS.RAObjects.shapeToColorMap={};window.DS.RAObjects.userShapesForParameterSet=new Set();window.DS.RAObjects.assignedLinearParamColorDimension={};window.DS.RAObjects.assignedDiscreteParamColorDimension={};window.DS.RAObjects.nextColorMapNumericIndex=0;window.DS.RAObjects.nextColorMapDiscreteIndex=0;window.DS.RAObjects.assignedLinearParamShapeDimension={};window.DS.RAObjects.assignedDiscreteParamShapeDimension={};window.DS.RAObjects.nextShapeMapNumericIndex=0;window.DS.RAObjects.nextShapeMapDiscreteIndex=0;var K=parseInt(localStorage.getItem("_CUSTOM_CHARTS_LOG_LEVEL_"));if(isNaN(K)){window.DS.RAObjects.logDebugLevel=0}else{window.DS.RAObjects.logDebugLevel=K}try{var F="Chartconfig_"+z.model.id;var C=widget.getValue(F);var J=false;if(C!==undefined){if(z._servantDetails.eedJobId===C.eedJobId){delete C.eedJobId;z._chartsConfig=C;z.restoreChartsConfig(E);J=true}else{widget.setValue(F,undefined)}}if(J===false){o.getFileFrom3DSpace(z.model.id,"Charts.json","json").then(function(M){var L=new FileReader();L.onloadend=function(){var N=L.result;console.log("Restored Charts Data: "+N);z._chartsConfig=JSON.parse(N);z.saveChartsPreference();z.restoreChartsConfig(E)};L.readAsText(M)},function(L){})}z.initializeAVSLibrary()}catch(H){}})},saveChartsPreference:function(){var y=Object.assign({},this._chartsConfig);y.eedJobId=this._servantDetails.eedJobId;var x="Chartconfig_"+this.model.id;widget.setValue(x,y)},initializeAVSLibrary:function(){var x=v.getInitialChartRequest();x.datasetId=this._datasetId;this.container.querySelector("ra-dataprovider").executeSupport("initializeAVSLibrary",x)},restoreChartsConfig:function(x){var B=this;var y=Object.assign({},B._chartsConfig);if(y.shapeToColorMap!==undefined){window.DS.RAObjects.shapeToColorMap=JSON.parse(y.shapeToColorMap);for(var E in window.DS.RAObjects.shapeToColorMap){window.DS.RAObjects.userShapesForParameterSet.add(window.DS.RAObjects.shapeToColorMap[E])}delete y.shapeToColorMap}if(y.parameterToColorMap!==undefined){window.DS.RAObjects.parameterToColorMap=JSON.parse(y.parameterToColorMap);for(var E in window.DS.RAObjects.parameterToColorMap){window.DS.RAObjects.userColersForParameterSet.add(window.DS.RAObjects.parameterToColorMap[E])}delete y.parameterToColorMap}if(y.assignedLinearParamColorDimension!==undefined){var D=JSON.parse(y.assignedLinearParamColorDimension);window.DS.RAObjects.assignedLinearParamColorDimension=D;for(var z in D){B.propagateChartEvent({eventType:"paramMapUpdate",paramId:z,colorMap:D[z]})}delete y.assignedLinearParamColorDimension}if(y.assignedDiscreteParamColorDimension!==undefined){var D=JSON.parse(y.assignedDiscreteParamColorDimension);window.DS.RAObjects.assignedDiscreteParamColorDimension=D;for(var z in D){B.propagateChartEvent({eventType:"paramMapUpdate",paramId:z,colorMap:D[z]})}delete y.assignedDiscreteParamColorDimension}if(y.nextColorMapNumericIndex!==undefined){window.DS.RAObjects.nextColorMapNumericIndex=y.nextColorMapNumericIndex;delete y.nextColorMapNumericIndex}if(y.nextColorMapDiscreteIndex!==undefined){window.DS.RAObjects.nextColorMapDiscreteIndex=y.nextColorMapDiscreteIndex;delete y.nextColorMapDiscreteIndex}if(y.assignedLinearParamShapeDimension!==undefined){var D=JSON.parse(y.assignedLinearParamShapeDimension);window.DS.RAObjects.assignedLinearParamShapeDimension=D;for(var z in D){B.propagateChartEvent({eventType:"paramMapUpdate",paramId:z,shapeMap:D[z]})}delete y.assignedLinearParamShapeDimension}if(y.assignedDiscreteParamShapeDimension!==undefined){var D=JSON.parse(y.assignedDiscreteParamShapeDimension);window.DS.RAObjects.assignedDiscreteParamShapeDimension=D;for(var z in D){B.propagateChartEvent({eventType:"paramMapUpdate",paramId:z,shapeMap:D[z]})}delete y.assignedDiscreteParamShapeDimension}if(y.nextShapeMapNumericIndex!==undefined){window.DS.RAObjects.nextShapeMapNumericIndex=y.nextShapeMapNumericIndex;delete y.nextShapeMapNumericIndex}if(y.nextShapeMapDiscreteIndex!==undefined){window.DS.RAObjects.nextShapeMapDiscreteIndex=y.nextShapeMapDiscreteIndex;delete y.nextShapeMapDiscreteIndex}for(var C in y){var A=y[C];A.configuration.latestParameters=B.latestParameters;A.configuration.latestConstraints=B.latestConstraints}x.restore(y)},initializeChartDescriptors:function(){var y=localStorage.getItem("_CUSTOM_CHARTS_DEV_ON_")||false;var x=this.descriptorsPanelContent;var z=v.getServerFileUrl("/SMAAnalyticsCharting/chartDescriptor/ra-chartdescriptor.html");Polymer.Base.importHref(z,function(){v.getAvailableCharts(function(D){window.DS.RAObjects.dataMaps=v.dataMaps;var C,E,A,B;for(A in D){E=D[A];if(E.hidden&&!y){continue}B=o.get3DSpaceURL()+"/webapps/SMAAnalyticsWidget/assets/icons/"+E.icon;C=document.createElement("ra-chartdescriptor");C.setData({id:A,type:window.DS.RAComponents.chartConstants.dragTypes.CHART,source:E.source,properties:E});C.setIconUrl(B);x.appendChild(C)}})})},initialize:function(){this.initialized=true;o.addView(this);var x=o.getViewStateInfo(this._viewName);if(x!=null&&typeof x!=="undefined"){this.viewState=x}if(Object.keys(this.viewState).length==0){this.viewState={descriptorsPanel:this.defaultPanelSetting(),dataPanel:this.defaultPanelSetting(),formatPanel:this.defaultPanelSetting(),informationPanel:this.defaultPanelSetting()}}this.setupDefaultPanels();this.initializeParameterTree();this.initializeStylePanel();var A=f.getWebappsBaseUrl();var B=v.getServerFileUrl("/SMAAnalyticsCharting/ra-setup.html");var y=v.getServerFileUrl("/SMAAnalyticsCharting/ra-dataprovider.html");var z=this;Polymer.Base.importHref(B,function(){window.DS.RAObjects.NLSUtils=i;Polymer.Base.importHref(y,function(){var C=document.querySelector("ra-dataprovider");if(C===null){C=document.createElement("ra-dataprovider")}C.setServerURL(z._servantDetails.uri,z._servantDetails.token,z._servantDetails.userId);u(C);C.registerSupport("getDataMaps",function(D,E){v.getDataMaps(E)});z.immersiveFrame.elements.container.appendChild(C);z.updateParameterTrees().then(function(){z.parameterTree.rootElement(z.dataPanelContent);this.initializeMoreInfoPanel(C);z.initializeGridContainer(z.parameterTree);z.initializeChartDescriptors();z.initializeControls()}.bind(this))}.bind(this))}.bind(this))},initializeMoreInfoPanel:function(x){x.executeSupport("getSelectionFlagColumn",{},function(A){var z=JSON.parse(A),y={allSelectedRowIndices:[],selectedRawRowIndices:[]};if(z instanceof Array){z.forEach(function(C,B){if(C>0){y.allSelectedRowIndices.push(B);y.selectedRawRowIndices.push(B)}})}this.updateInformationPanel(y)}.bind(this))},updateAllParamMapsInParamTree:function(){if(window.DS.RAObjects.assignedLinearParamColorDimension!==undefined){for(var x in window.DS.RAObjects.assignedLinearParamColorDimension){this.propagateChartEvent({eventType:"paramMapUpdate",paramId:x,colorMap:window.DS.RAObjects.assignedLinearParamColorDimension[x]})}}if(window.DS.RAObjects.assignedDiscreteParamColorDimension!==undefined){for(var x in window.DS.RAObjects.assignedDiscreteParamColorDimension){this.propagateChartEvent({eventType:"paramMapUpdate",paramId:x,colorMap:window.DS.RAObjects.assignedDiscreteParamColorDimension[x]})}}if(window.DS.RAObjects.assignedLinearParamShapeDimension!==undefined){for(var x in window.DS.RAObjects.assignedLinearParamShapeDimension){this.propagateChartEvent({eventType:"paramMapUpdate",paramId:x,shapeMap:window.DS.RAObjects.assignedLinearParamShapeDimension[x]})}}if(window.DS.RAObjects.assignedDiscreteParamShapeDimension!==undefined){for(var x in window.DS.RAObjects.assignedDiscreteParamShapeDimension){this.propagateChartEvent({eventType:"paramMapUpdate",paramId:x,shapeMap:assignwindow.DS.RAObjects.assignedDiscreteParamShapeDimensionedMap[x]})}}},updateParameterTrees:function(){var y=h.Promise.deferred();var B=this;var x=function(C){var D=function(F){console.log(F);var H=JSON.parse(F);var E=H.inputs.map(function(J){var I={id:J.id,source:C.id,type:"PARAMETER",properties:J};I.properties.parameterType="approximation";I.properties.parameterRole="input";I.properties.name=J.alias||J.displayName;return I});var G=H.outputs.map(function(J){var I={id:J.id,source:C.id,type:"PARAMETER",properties:J};I.properties.parameterType="approximation";I.properties.parameterRole="output";I.properties.name=J.alias||J.displayName;return I});C.groups=[{id:"inputs",type:"GROUP",displayName:"inputs",parameters:E,properties:{name:"inputs"}},{id:"outputs",type:"GROUP",displayName:"outputs",parameters:G,properties:{name:"outputs"}}];C.properties={};C.properties.name=C.alias||C.displayName;B.parameterTree.addData(C)};return D};var A=function(C){var D=JSON.parse(C);Object.keys(D).forEach(function(F){var E=D[F];if(E.status==="READY"){dataProvider.executeSupport("getApproximationParameters",{approxId:F,commandGroup:"approximation"},x(E))}})};var z=function(G){var H=k.getJSONFromResponse(G);var F=H;H.forEach(function(J){if(J.priorityWeight){F=J;return false}});H.forEach(function(K){if(K["@class"]==="ParametricCondition"){var J=K.parameterID;var L=v.findParameter(J,F);if(L){L.filters=L.filters||[];L.filters.push(K)}}});this._datasetId=F.ID;var C=new Map();this._populateParametermap(C,F);B.latestParameters=C;B.parameterTree.addData(F);var D=[];this.model.get("datasetsList").forEach(function(J){D.push(J.title)});var E={};E.parameters=[{id:"index",ID:"Index",type:"PARAMETER",displayName:"Index",name:"Score",source:F.ID,properties:{ID:"Index",parameterType:"analytics",name:"Index"}},{id:"Score",ID:"Score",type:"PARAMETER",displayName:"Score",name:"Score",source:F.ID,properties:{ID:"Score",parameterType:"analytics",name:"Score"}},{id:"Rank",ID:"Rank",type:"PARAMETER",displayName:"Rank",name:"Rank",source:F.ID,properties:{ID:"Rank",parameterType:"analytics",name:"Rank"}},{id:"GRADING",ID:"GRADING",type:"PARAMETER",dataType:"STRING",displayName:"Feasibility",name:"Feasibility",source:F.ID,parameterType:"analytics",discreteValues:["Dominated","Infeasible","Best","Excluded"],colorDataMap:"feasibilityColorMap",colors:["blue","red","green","gray"],stringSortedByFreqs:["Dominated","Infeasible","Best","Excluded"]},{id:"DATASET",ID:"DATASET",type:"PARAMETER",dataType:"STRING",displayName:"Dataset",name:"Dataset",source:F.ID,parameterType:"analytics",stringSortedByFreqs:D}];E.id="analytics";E.type="GROUP";E.displayName="Analytics";E.properties={};E.properties.parameterType="analytics";E.properties.parameterRole="input";E.properties.name=E.displayName;E.name=E.properties.name;B.parameterTree.addData(E);var I=function(L){if(typeof L==="undefined"||L===""){return}L=JSON.parse(L);B.latestConstraints=L;var K={id:"requirements",ID:"Requirements",type:"GROUP",displayName:"Requirements",name:"Requirements",source:"",properties:{id:"requirements",name:"Requirements"},groups:[]};var J={};Object.keys(L).forEach(function(P){var N=L[P];var M=N.sourceName;if(typeof J[M]==="undefined"){var O={id:M,name:M,source:M,type:"GROUP",parameters:[]};J[M]=O;O.properties=O;K.groups.push(O)}N.id=P;N.ID=P;N.name=N.sourceParameterName;if(N.type==="LESS_THAN"){N.name+=" < "}else{if(N.type==="GREATER_THAN"){N.name+=" > "}else{N.name+=" "+N.type+" "}}N.name+=N.boundValue;J[M].parameters.push({id:P,source:M,type:"CONSTRAINT",name:N.name,properties:N})});B.parameterTree.addData(K);y.resolve()};B.container.querySelector("ra-dataprovider").executeSupport("getConstraints",I)};v.getParameterFiltersAndHierarchy().then(z.bind(this));return y.promise},onRender:function(){return true},resizeInformationPanel:function(){if(this.paramDataTable&&this.paramDataTable.element){this.paramDataTable.element.resize()}},clearInformationPanel:function(){this.infoLabel.textContent=i.translate("NO_ALTERNATIVES_SELECTED");this.informationPanel.title=i.translate("Selection Information");this.informationPanelContent.classList.add("no_alts");return},updateInformationPanel:function(B){var z=this;if(!B.allSelectedRowIndices||(!B.allSelectedRowIndices[0]&&B.allSelectedRowIndices[0]!==0)){this.clearInformationPanel();return}try{w.mask(this.informationPanelContent);setTimeout(function(){w.unmask(z.informationPanelContent)},500);z.lastSelected=B.selectedRawRowIndices[0];z.informationPanel.title=v.__proto__.getNameForAlternative(z.lastSelected+1);if(B.allSelectedRowIndices.length>1){z.informationPanel.title=v.__proto__.getNameForAlternative(z.lastSelected+1,true)+"..."}var y=B.allSelectedRowIndices.map(function(C){return C+1});if(y.length>this.maxAlternateivesInInformationPanel){y=y.slice(0,this.maxAlternateivesInInformationPanel);if(y.indexOf(z.lastSelected+1)===-1){y.push(z.lastSelected+1)}}this.informationPanel.elements.container.setAttribute("data-moreInfoDesignId",JSON.stringify(y));var x=function(){return z.informationPanel};if(!this.paramDataTable){this.paramDataTable=new n.constr({targetElement:this.informationPanelContent,params:v.varGroup,getDesign:function(){var C=z.informationPanel.elements.container.getAttribute("data-moreInfoDesignId");return JSON.parse(C)},collectionSource:"raMoreInfoDesign",fixedWidth:100,attachSelector:"#infoPanel",myParentSelector:"#infoPanel",multiDisplay:true},h.Promise.deferred(),v.__proto__,w);this.informationPanelContent.classList.remove("no_alts");this.paramDataTable.element.resize()}else{this.paramDataTable.element.updateCollections();this.informationPanelContent.classList.remove("no_alts")}}catch(A){console.error("Error updating the moreinfo panel");console.error(A.stack)}},propagateChartEvent:function(B,A){if(!B.eventType){console.error("propagate chart event without a type! - check the source");console.error(B);console.error(A)}if(B.eventType==="paramMapUpdate"){var z=B.paramId;if(this.parameterTree.parameterIdNodeMap[z]!==undefined){var y=B.colorMap||this.parameterTree.parameterIdNodeMap[z].options.grid.colorShapeMap.colorMap;var x=B.shapeMap||this.parameterTree.parameterIdNodeMap[z].options.grid.colorShapeMap.shapeMap;try{this.parameterTree.parameterIdNodeMap[z].updateOptions({grid:{colorShapeMap:{colorMap:y,shapeMap:x}}})}catch(C){console.warn(parameterTree)}}}else{if(B.eventType==="selection"){console.log("Selection event received on the chart facet!");console.log(B);console.log(A);this.updateInformationPanel(B)}else{if(B.eventType==="clearSelection"){this.clearInformationPanel();this.container.querySelector("ra-dataprovider").executeSupport("unsetAllSelectionPoints",{datasetId:this._datasetId});this.dataProvider.executeSupport("unsetAllSelectionPoints",{chartId:chartId})}else{if(B.eventType==="mask"){try{A.forEach(function(E){if(E.controls){var F=E.parentElement;var D=F.querySelector(".MaskContainer");if(!D){D=h.createElement("div");D.classList.add("MaskContainer");D.style.width="50px";D.style.height="50px";D.style.position="absolute";D.style.top="calc(50% - 25px)";D.style.left="calc(50% - 25px)";D.style["border-radius"]="10px";F.appendChild(D)}else{if(D.maskTimeout){clearTimeout(D.maskTimeout)}}D.hasClassName=D.hasClassName||function(){return false};w.mask(D,"")}})}catch(C){}}else{if(B.eventType==="unmask"){try{A.forEach(function(E){if(E.controls){var F=E.parentElement;var D=F.querySelector(".MaskContainer");if(D){F.removeChild(D)}}})}catch(C){}}}}}}},updateChartsConfigPreference:function(y,x){this._chartsConfig[y]=x;this.updateChartGlobalConfig(this._chartsConfig);this.saveChartsPreference()},updateChartGlobalConfig:function(x){x.parameterToColorMap=JSON.stringify(window.DS.RAObjects.parameterToColorMap);x.shapeToColorMap=JSON.stringify(window.DS.RAObjects.shapeToColorMap);x.assignedLinearParamColorDimension=JSON.stringify(window.DS.RAObjects.assignedLinearParamColorDimension);x.assignedDiscreteParamColorDimension=JSON.stringify(window.DS.RAObjects.assignedDiscreteParamColorDimension);x.nextColorMapNumericIndex=window.DS.RAObjects.nextColorMapNumericIndex;x.nextColorMapDiscreteIndex=window.DS.RAObjects.nextColorMapDiscreteIndex;x.assignedLinearParamShapeDimension=JSON.stringify(window.DS.RAObjects.assignedLinearParamShapeDimension);x.assignedDiscreteParamShapeDimension=JSON.stringify(window.DS.RAObjects.assignedDiscreteParamShapeDimension);x.nextShapeMapNumericIndex=window.DS.RAObjects.nextShapeMapNumericIndex;x.nextShapeMapDiscreteIndex=window.DS.RAObjects.nextShapeMapDiscreteIndex},deleteChartFromChartsConfigPreference:function(x){if(this._chartsConfig[x]!==undefined){delete this._chartsConfig[x];this.saveChartsPreference()}},render:function(){},show:function(){},onSaveCaseClick:function(){console.log("Custom page view state:"+this.viewState);o.saveViewStateInfo(this._viewName,this.viewState);var x=document.querySelector("ra-simplecontainer");var y;if(x){y=x.save()}this.updateChartGlobalConfig(y);o.saveFileTo3DSpace(this.model.id,"Charts.json",y,"")},onCaseModified:function(y){if(y.viewSource===this._viewName){return}this._caseDirty=true;if(y.eventSubType==="constraintChanged"){var z=y.modifiedConstraint;z.name=z.sourceParameterName;if(z.type==="LESS_THAN"){z.name+=" < "}else{if(z.type==="GREATER_THAN"){z.name+=" > "}else{z.name+=" "+z.type+" "}}z.name+=z.boundValue;var x=false;this._caseModifiedEvents.forEach(function(A){if(A.eventSubType===y.eventSubType&&z.parameterID===A.modifiedConstraint.parameterID&&z.type===A.modifiedConstraint.type){A.modifiedConstraint=z;x=true}});if(x!==true){this._caseModifiedEvents.push(y)}}else{if(y.eventSubType==="parameterChanged"){var x=false;this._caseModifiedEvents.forEach(function(A){if(A.eventSubType===y.eventSubType){A.modifiedGroup=y.modifiedGroup;x=true}});if(x!==true){this._caseModifiedEvents.push(y)}}else{if(y.eventSubType==="filtersChanged"){this._caseModifiedEvents.push(y)}else{if(y.eventSubType==="datasetChanged"){this._caseModifiedEvents.push(y)}else{if(y.eventSubType==="parametersDeleted"){var x=false;this._caseModifiedEvents.forEach(function(A){if(A.eventSubType===y.eventSubType){y.deletedParams.forEach(function(B){A.deletedParams.push(B);x=true})}});if(x!==true){this._caseModifiedEvents.push(y)}}}}}}},onCloseCaseClick:function(){var x=document.querySelector("ra-simplecontainer");this.initialized=false;var y="Chartconfig_"+this.model.id;widget.setValue(y,undefined);if(x&&x.removeAllCharts){x.removeAllCharts()}}});return p});define("DS/SMAAnalyticsWidget/views/decisions/SMAAnalyticsDecListView",["UWA/Core","DS/W3DXComponents/Skeleton","DS/W3DXComponents/Views/EmptyView","DS/W3DXComponents/Collections/ActionsCollection","SMAAnalyticsWidget/SMAAnalyticsDOCollection","DS/SMAAnalyticsCommon/views/SMAAnalyticsContentSet","DS/SMAAnalyticsWidget/views/decisions/SMAAnalyticsDecCustomView","DS/SMAAnalyticsCommon/views/SMAAnalyticsTileView","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","SMAAnalyticsWidget/SMAAnalyticsRqtDetailView","DS/SMAAnalyticsWidget/views/decisions/SMAAnalyticsDecListViewUtils"],function(d,a,c,h,i,l,b,f,m,e,g){var k={},j=function(s,n,r){var q=n.model.get("physicalId");if(q){var p=widget.getValue("x3dPlatformId")||"OnPremise";var t={protocol:"3DXContent",version:"1.1",widgetId:widget.id,source:d.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,data:{items:[{envId:p,objectId:q,displayName:n.model.get("name"),displayType:n.model.get("type"),objectType:n.model.get("type"),serviceId:"3DSpace"}]}};try{r.dataTransfer.setData("text/searchitems",JSON.stringify(t))}catch(o){}finally{r.dataTransfer.setData("text",JSON.stringify(t))}}else{m.showErrorNotification(m.translate("ERROR_REFRESH_PAGE"))}};k.getRenderer=function(){return{collection:i,view:l,viewOptions:{contents:{selectionMode:"oneToOne",useInfiniteScroll:false,usePullToRefresh:false,headerOnEmpty:false,viewtype:"decisions",views:[{id:"tile",view:b.AnalyticsGridScrollView,itemView:f,title:"Tile View"},{id:"list",view:b.AnalyticsListView,itemView:f}],itemViewOptions:{contextualActions:[{text:m.translate("DISCONNECT"),fonticon:"trash",handler:g.disconnectDecision},{className:"divider"}]},emptyView:c,events:{onItemViewDrag:j}}},idCardOptions:{title:m.translate("DECISION_OBJECTS"),selectedFacet:0,facets:[{text:m.translate("DET"),icon:"newspaper",handler:a.getRendererHandler(e)},{text:m.translate("PROPERTIES"),icon:"list",handler:a.getRendererHandler("plmparameters")}]}}};return k});define("DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCaseListView",["UWA/Core","DS/W3DXComponents/Skeleton","DS/SMAAnalyticsCommon/SMAAnalyticsEmptyView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/RowView","DS/SMAAnalyticsWidget/collections/SMAAnalyticsCollection","DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCaseListViewUtils","DS/SMAAnalyticsCommon/views/SMAAnalyticsContentSet","DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCustomView","DS/SMAAnalyticsCommon/views/SMAAnalyticsTileView","DS/SMAAnalyticsCommon/views/SMAAnalyticsThumbnailView","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","SMAAnalyticsWidget/SMAAnalyticsCaseDetailsView","SMAAnalyticsWidget/SMAAnalyticsLaunchView","SMAAnalyticsWidget/SMAAnalyticsTablePageView","SMAAnalyticsWidget/SMAAnalyticsCustomPageView","SMAAnalyticsWidget/SMAAnalyticsTemplateView"],function(f,e,l,u,j,d,t,b,k,h,r,m,i,s,c,o,a){var q={},g=function(B,v,A){var y=v.model.get("physicalId");if(y){var x=widget.getValue("x3dPlatformId")||"OnPremise";var z={protocol:"3DXContent",version:"1.1",widgetId:widget.id,source:f.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,data:{items:[{envId:x,objectId:y,displayName:v.model.get("name"),displayType:v.model.get("type")||"Analytics Case",objectType:v.model.get("type")||"Analytics Case",serviceId:"3DSpace"}]}};try{A.dataTransfer.setData("text/searchitems",JSON.stringify(z))}catch(w){}finally{A.dataTransfer.setData("text",JSON.stringify(z))}}else{m.showErrorNotification(m.translate("ERROR_REFRESH_PAGE"))}},n=function(v){var w={onComplete:function(){if(v&&v.scroller){if(y.hasNextPage()){v.endLoading();v.useInfiniteScroll(true)}else{v.useInfiniteScroll(false)}}}};var x=this,y=this.collection;y.scrollView=v;if(y.hasNextPage()){y.loadMoreData(w)}else{v.useInfiniteScroll(false)}},p=function(){var z=this.model,x=this.contextualActions;if(x){var y=x.filter(function(A){return A.id==="stopServant"})[0],v=x.filter(function(A){return A.id==="launchRA"})[0],w=z.get("running");if(w){v.text=m.translate("RESUME_RA");y.disabled=false}else{v.text=m.translate("LAUNCH_RA");y.disabled=true}}};q.getRenderer=function(){return{collection:d,view:b,viewOptions:{actions:{collection:new u([{id:"newCase",title:m.translate("new_case"),icon:"plus",overflow:false},{id:"raHelp",title:m.translate("getting_help"),icon:"help-circled",overflow:true}]),events:{onActionClick:function(C,w,x){var B=w.model.get("id");if(B==="newCase"){t.createNewCase()}else{if(B==="raHelp"){var A=widget.data.lang,z="";if(A==="en"){z="English"}else{if(A==="fr"){z="French"}else{z="English"}}var y="SimResaWidgetUserMap/resa-c-ov.htm",v="http://help.3ds.com/HelpDS.aspx?P=11&L="+z+"&V=2019x&F="+y+"&contextscope=cloud";window.open(v)}}}}},buildMultiselActions:function(){var v=[];v.push({id:"delete",text:m.translate("DELETE_CASES"),fonticon:"trash",multisel:true,handler:t.deleteAnalyticsCase},{id:"stop",text:m.translate("CLOSE_SERVANT"),fonticon:"stop",multisel:true,handler:t.closeMultipleAnalyticsCase});return v},contents:{selectionMode:"nullToMany",useInfiniteScroll:true,usePullToRefresh:false,headerOnEmpty:false,viewtype:"casedetails",views:[{id:"tile",view:k.AnalyticsGridScrollView,itemView:h,title:m.translate("TILE_VIEW"),"default":window.widget&&window.widget.getValue("currentViewId")==="tile"},{id:"thumbnail",view:k.AnalyticsGridScrollView,itemView:r,title:m.translate("THUMBNAIL_VIEW"),"default":window.widget&&window.widget.getValue("currentViewId")==="thumbnail"},{id:"table",view:k.AnalyticsTableScrollView,itemView:j,title:m.translate("TABLE_VIEW"),"default":window.widget&&window.widget.getValue("currentViewId")==="table"},{id:"list",view:k.AnalyticsListView,itemView:h}],itemViewOptions:{contextualActions:[{text:m.translate("LAUNCH_RA"),fonticon:"play",id:"launchRA",handler:t.launchRA},{className:"divider"},{text:m.translate("COPY"),fonticon:"copy",handler:t.copyCase},{text:m.translate("REVISE"),fonticon:"flow-branch",handler:t.reviseCase},{text:m.translate("DELETE"),fonticon:"trash",handler:t.deleteAnalyticsCase},{className:"divider"},{text:m.translate("CLOSE_SERVANT"),fonticon:"stop",id:"stopServant",handler:t.closeAnalyticsCase}],events:{onRender:p}},headers:[{property:"title",sortable:true,label:m.translate("TITLE")},{property:"revision",sortable:true,label:m.translate("REVISION")},{property:"description",sortable:false,label:m.translate("DESCRIPTION")},{property:"project",sortable:true,label:m.translate("COLLAB_SPACE")},{property:"ownerFullName",sortable:true,label:m.translate("OWNER")},{property:"authorFullName",sortable:true,label:m.translate("AUTHOR")},{property:"originated",sortable:true,label:m.translate("TIME")}],emptyView:l,events:{onItemViewDrag:g,onInfiniteScroll:n}},events:{onSwitch:function(w,v,x){if(f.is(x)){widget.setValue("currentViewId",x)}}}},idCardOptions:function(){var w=localStorage.getItem("_RA_TEMPLATE_ON_")||false;var v=localStorage.getItem("_CUSTOM_CHARTS_ON_")||false;var x=localStorage.getItem("_RA_DATATAB_ON_")||false;var y=[{text:m.translate("CASE_DET"),icon:"newspaper",handler:e.getRendererHandler(i)},{text:m.translate("REQUIREMENTS"),icon:"target",handler:e.getRendererHandler("requirements")},{text:m.translate("RECOMMENDED"),icon:"trophy",handler:e.getRendererHandler("decisionobjects")},{text:m.translate("LAUNCH_RA"),icon:"play",handler:e.getRendererHandler(s)}];if(x){y.push({text:m.translate("Data"),icon:"database",handler:e.getRendererHandler(c)})}if(v){y.push({text:m.translate("CUSTOM_CHARTS"),icon:"chart-bubble",handler:e.getRendererHandler(o)})}if(w){y.push({text:m.translate("ANALYTICS_NOTEBOOK"),icon:"drawing",handler:e.getRendererHandler(a)})}return{title:m.translate("RA_CASES"),selectedFacet:0,facets:y,actions:[{text:m.translate("save_case"),icon:"floppy",handler:m.saveCaseHandler.bind(m),name:"save"},{text:m.translate("CLOSE"),icon:"close",handler:t.stopCase,name:"close"}]}}}};return q});define("SMAAnalyticsWidget/SMAAnalyticsWidgetSkeleton",["UWA/Core","DS/W3DXComponents/Skeleton","DS/UIKIT/Mask","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Item/TileView","SMAAnalyticsWidget/SMAAnalyticsCaseCollection","SMAAnalyticsWidget/SMAAnalyticsDataSetCollection","SMAAnalyticsWidget/SMAAnalyticsParameterCollection","SMAAnalyticsWidget/SMAAnalyticsCaseDetailsView","SMAAnalyticsWidget/SMAAnalyticsDataSetDetailView","SMAAnalyticsWidget/SMAAnalyticsParameterDetailView","SMAAnalyticsWidget/SMAAnalyticsWidgetProxy","DS/SMAAnalyticsWidget/views/caselist/SMAAnalyticsCaseListView","DS/SMAAnalyticsWidget/views/requirement/SMAAnalyticsReqListView","DS/SMAAnalyticsWidget/views/decisions/SMAAnalyticsDecListView"],function(g,e,r,a,j,d,i,f,l,o,m,p,q,k,b){var n=function(){var t=this.bones.getRoute()||"",s=t.indexOf("f=0");if(s>-1){var u=this.bones.getViewAt(1);if(g.is(u)&&typeof u.updateCaseDetailsViewData==="function"){u.updateCaseDetailsViewData.call(u)["finally"](function(){console.log("Updated casedetails data.")})}}};var c={launchedState:false,launchedHTML:null,callback:null,bones:null,height:"auto",unMaximizedHeight:null};var h={useInfiniteScroll:false,usePullToRefresh:false};c.onRefresh=function(s){if(!c.launchedState){c.onLoad(s)}};c.onBackArrowClick=function(){this.currIndex--;this.panelSlider.slideBack()};c.onViewChange=function(x){try{var s=widget.getViewportDimensions();var v=p.get3DSpaceURL()||document.getElementById("spDashboard").getMcsUri();if(g.is(widget.adviseContainer)){if(g.is(widget.adviseContainer.contentWindow)){widget.adviseContainer.contentWindow.postMessage(JSON.stringify({WIDGET_RESIZE:widget.getView().type}),v)}}var u=c.bones.getViewAt(0)||null;if(u){u.dispatchEvent("onResizeClick",x)}var t=c.bones.getViewAt(1)||null;if(t){t.dispatchEvent("onResizeClick",x)}}catch(w){console.warn("Error setting height to the skeleton")}};c.onLoad=function(u){if(this.bones!==null){this.bones.destroy()}if(this.launchedHTML===null){this.launchedHTML=widget.getElements(".sma-launched-widget")}var v={collection:d,collectionOptions:{type:p.translate("CASE_DET")},view:l,viewOptions:h,idCardOptions:{facets:[]}};var x={collection:i,view:null,viewOptions:h,collectionOptions:{type:p.translate("DATASETS")},idCardOptions:{facets:function(){return[{text:p.translate("DATASET_DET"),icon:null,handler:e.getRendererHandler(o)}]}}};var t={collection:f,view:a.extend({defaultOptions:{useInfiniteScroll:false,usePullToRefresh:false,itemView:j},events:{onItemViewSelect:"onItemViewSelect"}}),viewOption:h,collectionOptions:{type:p.translate("PROPERTIES")},idCardOptions:{facets:function(){return[{text:p.translate("PARAMETER_DET"),icon:null,handler:e.getRendererHandler(m)}]}}};var w={root:"analyticscases",useRootChanelView:true,events:{onSlide:function(){if(this.currentRoute==="/analyticscases/"){widget.setValue("lastactivecase","")}}}};this.bones=new e({analyticscases:q.getRenderer(),casedetails:v,datasets:x,requirements:k.getRenderer(),plmparameters:t,decisionobjects:b.getRenderer()},w);this.bones.addEvent("CASE_MODIFIED",function(y){this.activeViews.forEach(function(z){z.dispatchEvent("onCaseModified",y)})});var s=u.querySelector("#loading-message");if(s&&s.parentNode){s.parentNode.removeChild(s)}this.bones.render().inject(u,"top");p.setSkeleton(this.bones)};widget.getPreferenceLabel=function(w){var t=widget.getPreference(w),x=widget.getValue(w),v="";for(var u=0;u<t.options.length;u++){var s=t.options[u];if(s.value===x){v=s.label;break}}return v};return c});
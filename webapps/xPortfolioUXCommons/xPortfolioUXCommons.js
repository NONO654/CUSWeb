define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemModel",["UWA/Class/Model"],function(b){var a=b.extend({init:function(c){var f={};if(c.hasOwnProperty("id")){f=c}else{if(c.hasOwnProperty("@id")){f={id:c["@id"],};for(var d in c){if(c.hasOwnProperty(d)){var e=c[d];f[d]=e}}}}Array.prototype.splice.call(arguments,0,1,f);return this._parent.apply(this,arguments)}});return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewCollectionToolBar",["DS/ENOXCollectionToolBar/js/ENOXCollectionToolBar","i18n!DS/xPortfolioUXCommons/assets/nls/XModelListView","css!xPortfolioUXCommons/XModelListView/css/XModelListView.css"],function(c,b){var a=function(e,d,j){this._initMaps();this._model=e;this._opts={};this._opts.views=[];if(d.viewOptions){if(d.viewOptions.views){for(var f=0;f<d.viewOptions.views.length;f+=1){this._opts.views.push({id:d.viewOptions.views[f],text:this._localMap_text[d.viewOptions.views[f]],fonticon:this._localMap_fonticon[d.viewOptions.views[f]]})}}this._opts.currentView=d.viewOptions.currentView?d.viewOptions.currentView:d.viewOptions.views[0]}this._opts.currentSort=d.viewOptions.currentSort?d.viewOptions.currentSort:undefined;this._opts.sort=[];var f=0;var g=[];this._selectedGroupItem=null;for(f=0;f<d.viewOptions.grid.columns.length;f+=1){if(d.viewOptions.grid.columns[f].text!==""){this._opts.sort.push({id:d.viewOptions.grid.columns[f].dataIndex,text:d.viewOptions.grid.columns[f].text,type:(d.viewOptions.grid.columns[f].typeRepresentation==="number")?"integer":"string"});if(d.viewOptions.grid.columns[f].groupableFlag==true){g.push({id:d.viewOptions.grid.columns[f].dataIndex,text:d.viewOptions.grid.columns[f].text,selectable:true,isSelected:false,handler:function(){console.log();var k=this.getSelectedItems();var i=false;var l="";if(k.length==1&&k[0].isSelected){i=true;l=k[0].id}this.items.forEach(function(m){if(m.id!=l){m.isSelected=false}});if(!i&&this.options.target.hasClassName("selected")){this.options.target.removeClassName("selected")}else{this.options.target.addClassName("selected")}}})}}}this._opts.modelEvents=j;this._opts.withmultisel=d.withmultisel?d.withmultisel:false;this._opts.showItemCount=d.showItemCount==false?d.showItemCount:true;this._opts.filter={enableCache:true};this._opts.itemsName=d.toolbarOptions.itemsName;this._opts.itemName=d.toolbarOptions.itemName;this._opts.actions=this._getToolbarActions(d.toolbarOptions.actions);var h=this;if(UWA.is(this._opts.actions,"array")){if(g.length>0){this._opts.actions.push({id:"groupByAction",className:"group-by-action",title:b._groupByAction,text:b._groupByAction,fonticon:"horizontal-line",content:g,handler:function(k,l){var i=[];if(l.id){if(l.isSelected){l.elements.container.removeClassName("selected");l.isSelected=false}else{if(!l.elements.container.hasClassName("selected")){l.elements.container.addClassName("selected")}l.isSelected=true;h._selectedGroupItem=l;i.push(l.id)}}h._opts.modelEvents.publish({event:"xmodel-list-view-group-by-action",data:i})}})}}this._collectionToolBar=new c(this._opts);this._subscribeEvents();this._initSort()};a.prototype._subscribeEvents=function(){var d=this;this._opts.modelEvents.subscribe({event:"xmodel-list-item-on-add-selection"},function(){d._multiselectActions.forEach(function(e){d._opts.modelEvents.publish({event:"enox-collection-toolbar-enable-action",data:e})})});this._opts.modelEvents.subscribe({event:"xmodel-list-item-on-empty-selection"},function(){d._multiselectActions.forEach(function(e){d._opts.modelEvents.publish({event:"enox-collection-toolbar-disable-action",data:e})})});this._opts.modelEvents.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(f){var e=f.searchValue[0]||"";d._opts.modelEvents.publish({event:"xmodel-list-context-search-action",data:e})});this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-group-visibility"},function(e){var f=d._collectionToolBar._container.querySelector(".group-by-action");if(f){if(e){f.removeClassName("displaynone");f.removeClassName("selected");if(d._selectedGroupItem){d._selectedGroupItem.isSelected=false;d._selectedGroupItem.elements.container.removeClassName("selected");d._selectedGroupItem=null}}else{f.addClassName("displaynone")}}})};a.prototype._initMaps=function(){this._localMap_text={};this._localMap_text.DataGridView=b._dataGridView;this._localMap_text.TileView=b._tileView;this._localMap_text.ThumbnailView=b._thumbnailView;this._localMap_text.LargeThumbnailView=b._largeTileView;this._localMap_fonticon={};this._localMap_fonticon.DataGridView="view-list";this._localMap_fonticon.TileView="view-small-tile";this._localMap_fonticon.ThumbnailView="view-big-thb";this._localMap_fonticon.LargeThumbnailView="view-big-tile"};a.prototype._getToolbarActions=function(f){var d=[];this._multiselectActions=[];var e=this;f.forEach(function(g){var i=function(j,m){var k=[];if(g.allowSelectRetain){k.push(m.selected)}else{if(g.enableOnSelection){var l=[];e._model.getSelectedNodes().forEach(function(n){l.push(n.options)});k.push(l);k.push(e._model.getSelectedNodes())}}g.handler.apply(e._model,k)};var h={handler:i};if(g.enableOnSelection){h.disabled=true;e._multiselectActions.push(g.id)}UWA.merge(h,g);d.push(h)});return d};a.prototype.inject=function(d){this._collectionToolBar.inject(d)};a.prototype.attachResizeSensor=function(){this._collectionToolBar.attachResizeSensor()};a.prototype._initSort=function(){var d=this;this._opts.modelEvents.subscribe({event:"enox-collection-toolbar-sort-activated"},function(e){if(e&&e.sortAttribute&&e.sortOrder){console.log("sorting tree on "+e.sortAttribute+" "+e.sortOrder);console.log(d);var f={dataIndex:e.sortAttribute,sort:e.sortOrder.toLowerCase(),id:e.sortAttribute,order:e.sortOrder.toLowerCase()};d._collectionToolBar._activateCurrentSort(f);d._opts.modelEvents.publish({event:"xmodel-list-data-sort-action",data:f})}})};return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension",["UWA/Class","DS/Tree/TreeNodeModel","DS/WildcardSearchComponent/WildcardSearchComponent","DS/PlatformAPI/PlatformAPI",],function(b,e,c,a){var d=b.extend({_id:"data-extention",initialize:function(f){this._viewId=f.id;this._model=f.model;this._dataFilters={};this._searchFilters={};this._FILTER_ATTRIBUTES=["id","name","title","description","type","revision","responsible","owner","creator","maturity","state"];this._modelEvents=f.modelEvents;this._filterData={};this._searchFilter={};this._wildCardSearchComponent=new c();this._isFilterDataUpdating;this._filterNodeLevel=0;this.subscribeEvents()},subscribeEvents:function(){var f=this;this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){});this._modelEvents.subscribe({event:"xmodel-list-data-load-action"},function(g){f._loadData(g,this)});this._modelEvents.subscribe({event:"xmodel-list-data-item-add-action"},function(h){var g=f._addDataItem(h,this);f._modelEvents.publish({event:"xmodel-list-item-on-unselect-all"});f._modelEvents.publish({event:"xmodel-list-data-item-on-add-complete",data:g,context:g})});this._modelEvents.subscribe({event:"xmodel-list-add-many-items"},function(h){var g=f._addDataItem(h,this);f._modelEvents.publish({event:"xmodel-list-data-item-on-add-complete",data:g,context:g})});this._modelEvents.subscribe({event:"xmodel-list-data-item-remove-action"},function(g){f._removeDataItem(g)});this._modelEvents.subscribe({event:"xmodel-list-data-item-update-action"},function(g){f._updateDataItem(g,g.context)});this._modelEvents.subscribe({event:"xmodel-list-data-filter-action"},function(g){f.filter(g)});this._modelEvents.subscribe({event:"xmodel-list-data-search-action"},function(g){f._wildCardSearch(g)});this._modelEvents.subscribe({event:"xmodel-list-data-set-filter-node-level"},function(g){if(UWA.is(g,"number")){f._filterNodeLevel=g}});this._modelEvents.subscribe({event:"xmodel-list-get-filtered-data"},function(g){f._getFilteredData().then(function(){if(UWA.is(g,"function")){g(f._filterData)}})});this._model.subscribe({event:"matchSearch"},function(g){g.data.nodeModel.show()});this._model.subscribe({event:"unmatchSearch"},function(g){g.data.nodeModel.hide()});a.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(h){var g=h?(h.data?(h.data.authored?(h.data.authored.modified?h.data.authored.modified:[]):[]):[]):[];g.forEach(function(i,j){if(i){f._model.search({shouldStop:function(k){if(k.options.id===i){f._modelEvents.publish({event:"xmodel-list-data-item-need-refresh",data:i,context:k});return true}return false}})}})})},_loadData:function(i,g){var h=this;var f=h._model;if(g&&UWA.is(g,"object")){f=g}f.prepareUpdate();if(f.removeRoots){f.ungroupRoots();f.removeRoots()}if(f.removeChildren){f.removeChildren()}h._modelEvents.publish({event:"xmodel-list-reset-sort-model",data:{}});if(i&&i.member){this._isFilterDataUpdating=false;i.member.forEach(function(m,l){var k=h._getNodeOptions(m,l);if(f.options.useAsyncPreExpand){k.children=[]}var j=new e(k);f.addChild(j)});h._modelEvents.publish({event:"xmodel-list-view-update-grouping-action",data:f})}f.pushUpdate();this._updateFilterData()},_removeDataItem:function(i,h){var f=this._model;if(h&&UWA.is(h,"object")){f=h}this._isFilterDataUpdating=false;f.prepareUpdate();if(!UWA.is(i,"array")){i=[i]}var g=f.search({match:function(j){if(i.indexOf(j.nodeModel.options.id)!=-1){return true}return false}});if(g){g.forEach(function(j){j.hide();j.remove()})}f.pushUpdate();this._updateFilterData()},_updateDataItem:function(f,g){if(!(g||UWA.is(g,"object"))){var h=f.id?f.id:f["@id"];if(h){this._model.search({shouldStop:function(i){if(h==i.options.id){g=i;return true}return false}})}}if(g){g.prepareUpdate();g.updateOptions(this._getNodeOptions(f));g.pushUpdate()}return g},_addDataItem:function(i,j){var f=this._model;if(j&&UWA.is(j,"object")){f=j}this._isFilterDataUpdating=false;f.prepareUpdate();var h=f.getChildren()?f.getChildren().length:0;var g=new e(this._getNodeOptions(i,h));if(f.options.useAsyncPreExpand){g.options.children=[]}f.addChild(g);f.pushUpdate();this._updateFilterData();return g},_getNodeOptions:function(g,f){g.id=g.id?g.id:g["@id"];var h=g;var i={id:g.id?g.id:g["@id"],label:(g.title),description:g.description,subLabel:"",grid:h,icons:g.image?[g.image]:g.thumbnail?[g.thumbnail]:[],thumbnail:g.image?g.image:g.thumbnail?g.thumbnail:"",color:""};return i},filter:function(g){var l=[];if(g.id){var k=this;this._dataFilters[g.id]=g.content||{};this._model.prepareUpdate();var j;for(var f in k._dataFilters){if(k._dataFilters.hasOwnProperty(f)){var i=k._dataFilters[f];if(i.ids){if(!j){j=i.ids.filter(function(m){return k._filterData.hasOwnProperty(m)})}else{j=j.filter(function(m){return i.ids.indexOf(m)!=-1&&k._filterData.hasOwnProperty(m)})}}}}if(!j){j=[]}else{}var h=this._model.search({match:function(m){if(j.indexOf(m.nodeModel.options.id)!=-1){m.nodeModel.matchSearch();l.push(m.nodeModel.options.id);return true}m.nodeModel.unmatchSearch();return false},shouldStop:function(m){return m.getNodeDepth()>k._filterNodeLevel}});this._model.pushUpdate();this._modelEvents.publish({event:"xmodel-list-data-on-update"})}return l},_updateFilterData:function(){var f=this;f._filterData={};return new UWA.Promise(function(h,g){try{f._model.getChildren().forEach(function(j){f._filterData[j.options.id]=f._FILTER_ATTRIBUTES.reduce(function(l,k){if(!l){l={}}l[k]=j.options.grid.hasOwnProperty(k)?j.options.grid[k]:"";return l},{})});h()}catch(i){f._filterData={};g()}f._modelEvents.publish({event:"xmodel-list-filter-data-update-complete"});f._isFilterDataUpdating=false})},_getFilteredData:function(){var f=this;return new UWA.Promise(function(h,g){if(f._isFilterDataUpdating==false){return h()}else{f._modelEvents.subscribeOnce({event:"xmodel-list-filter-data-update-complete"},function(){h()});if(!f._isFilterDataUpdating){f._updateFilterData()}}})},_wildCardSearch:function(f){var h=this;if(f.id){this._searchFilters[f.id]=f.content||{};var g=f.content;this._getFilteredData().then(function(){var i=Object.keys(h._filterData).map(function(k){return h._filterData[k]});var j=g.value||"";h._wildCardSearchComponent.search(g.value,i,function(l){var m=[];if(l){m=l.map(function(n){return n.id})}var k=h.filter({id:f.id,content:{ids:m}});h._modelEvents.publish({event:"xmodel-list-data-on-search-complete",data:k})},["id"])})}},destroy:function(){}});return d});define("DS/xPortfolioUXCommons/XModelListView/js/ContextualMenuTweaker",["DS/Tweakers/TweakerBase","DS/Utilities/Utils","DS/Controls/Button","DS/Menu/ContextualMenu","DS/Menu/Menu",],function(h,g,c,d,f){var e=h.inherit({name:"contextualMenu",publishedProperties:{label:{defaultValue:"",type:"string"},icon:{defaultValue:{iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS},type:"string"},displayStyle:{defaultValue:"menuIcon",type:"string",category:"Appearance"}},});var b=function(j,i){h.prototype.baseViewModule.call(this,j,i)};g.applyMixin(b,h.prototype.baseViewModule);var a=function(j,i){b.call(this,j,i)};g.applyMixin(a,b);a.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var i=UWA.merge({},this._options.viewOptions);i.touchMode=this._tweaker._getCurrentTouchMode();i.displayStyle="lite";i.icon=this._tweaker.icon;i.allowUnsafeHTMLLabel=false;if(this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0){if(this._tweaker.value.menu.length==1){i.icon={iconName:this._tweaker.value.menu[0].fonticon.content,fontIconFamily:WUXManagedFontIcons.Font3DS}}}this._view=new c(i);this.setValue(this._tweaker.value)};a.prototype.handleEvents=function(){var k=this;var i=this._view;var j=this._tweaker.context;if(j){j.nodeModel.addEventListener("pushUpdate",function(){if(this.options.disableMenu!=undefined&&this.options.disableMenu!=k._tweaker.value.disabled){k._tweaker.value.disabled=this.options.disableMenu;k.setValue()}})}if(i){i.addEventListener("buttonclick",function(m){if(k._tweaker.value&&!(k._tweaker.value.disabled==true||(k._tweaker.value.menu&&k._tweaker.value.menu.length==1&&k._tweaker.value.menu[0]&&k._tweaker.value.menu&&k._tweaker.value.menu[0].state=="disabled"))){var n=k._tweaker.value.menu;if(n){if(n.length==1){n[0].action.callback(m)}else{var l=i.getContent().getBoundingClientRect();f.show(n,{position:{x:l.left,y:l.top+l.height}})}}}})}};a.prototype.setValue=function(){if(!this._view){return}this._view.icon=this.getMenuIcon();if(typeof this._tweaker.value==="undefined"||this._tweaker.value===null){this._view.value="undefined"}else{this._view.value=this._tweaker.value;if(this._tweaker.value&&(this._tweaker.value.disabled==true||(this._tweaker.value.menu&&this._tweaker.value.menu.length==1&&this._tweaker.value.menu[0]&&this._tweaker.value.menu&&this._tweaker.value.menu[0].state=="disabled"))){this._view.getContent().setAttribute("disabled",true)}else{this._view.getContent().removeAttribute("disabled")}if(this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0){this._view.show()}else{this._view.hide()}}};a.prototype.getMenuIcon=function(){var i={iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS};if(this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0){if(this._tweaker.value.menu.length==1){i={iconName:this._tweaker.value.menu[0].fonticon.content,fontIconFamily:WUXManagedFontIcons.Font3DS}}}return i};a.prototype.removeEvents=function(){if(!this._view){return}this._view.removeEventListener("buttonclick")};a.prototype._updateView=function(){this.setValue()};e.prototype.baseViewModule=b;e.prototype.VIEW_MODULES={menuIcon:{classObject:a,options:{viewOptions:{}}},readOnly:{classObject:a,options:{viewOptions:{displayStyle:"menuIcon"}}}};return e});define("DS/xPortfolioUXCommons/util/ScrollUtil",[],function(){var a={PIXEL_STEP:10,LINE_HEIGHT:40,PAGE_HEIGHT:800,maxWheelDelta:function(b){return{y:10,x:10}},normalizeWheel:function(d){var f=0,e=0,c=0,b=0;if("detail" in d){e=d.detail}if("wheelDelta" in d){e=-d.wheelDelta/120}if("wheelDeltaY" in d){e=-d.wheelDeltaY/120}if("wheelDeltaX" in d){f=-d.wheelDeltaX/120}if("axis" in d&&d.axis===d.HORIZONTAL_AXIS){f=e;e=0}c=f*this.PIXEL_STEP;b=e*this.PIXEL_STEP;if("deltaY" in d){b=d.deltaY}if("deltaX" in d){c=d.deltaX}if((c||b)&&d.deltaMode){if(d.deltaMode===1){c*=this.LINE_HEIGHT;b*=this.LINE_HEIGHT}else{c*=this.PAGE_HEIGHT;b*=this.PAGE_HEIGHT}}if(c&&!f){f=(c<1)?-1:1}if(b&&!e){e=(b<1)?-1:1}return{spinX:f,spinY:e,pixelX:c,pixelY:b}}};return a});define("DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil",["UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(d,b,c){var e=false;var a=d.singleton({_notificationsMgr:{},_defaultLevel:"info",_appendAppNameToMsg:false,_appNameStr:"",_msgLevels:{INFO:"info",WARNING:"warning",ERROR:"error",SUCCESS:"success"},init:function(f){if(e){console.log("nothing!!!")}if(f&&f.appName&&f.appName!=""){_appNameStr=f.appName}this._notificationsMgr=b;c.setNotificationManager(this._notificationsMgr)},showMessage:function(f){if(f&&f.message){this._notificationsMgr.addNotif({level:f.level?f.level:this._defaultLevel,message:this._appendAppNameToMsg?(this._appNameStr+f.message):f.message,sticky:f.isSticky?f.isSticky:false})}},showError:function(f){if(f&&f!=""){this.showMessage({level:this._msgLevels.ERROR,message:f})}},showInfo:function(f){if(f&&f!=""){this.showMessage({level:this._msgLevels.INFO,message:f})}},showSuccess:function(f){if(f&&f!=""){this.showMessage({level:this._msgLevels.SUCCESS,message:f})}}});a.init();return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension",["UWA/Class","DS/TaggerOnIndexComponent/TaggerOnIndexComponent"],function(a,b){var c=a.extend({_id:"tagger-extention",initialize:function(d){this._taggerId=d.id;this._model=d.model;this._modelEvents=d.modelEvents;this._friendTags=[];this.subscribeEvents();this._taggerComponent=b},subscribeEvents:function(){var d=this;this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){d._modelEvents.publish({event:"xmodel-list-get-filtered-data",data:function(e){d._setupTagger(e?Object.keys(e):[])}})});this._modelEvents.subscribe({event:"xmodel-list-tagger-activate-action"},function(){d._activateTagger()});this._modelEvents.subscribe({event:"xmodel-list-tagger-deactivate-action"},function(){d._deactivateTagger()});this._modelEvents.subscribe({event:"xmodel-list-tagger-update-friend-tags-action"},function(e){if(UWA.is(e,"array")){d._friendTags=e}});this._modelEvents.subscribe({event:"xmodel-list-data-on-search-complete"},function(e){d._filterTagger(e)});this._modelEvents.subscribe({event:"xmodel-list-tagger-init-action"},function(e){d._modelEvents.publish({event:"xmodel-list-get-filtered-data",data:function(f){d._setupTagger(f?Object.keys(f):[])}})})},_setupTagger:function(f){console.log("set up tagger");var e=this;var d={MyFriends:e._friendTags,onSetTagProxy:function(){e._modelEvents.publish({event:"xmodel-list-tagger-on-setup"})},onTagFilterChange:function(){console.log();var h=e._taggerComponent.getTagProxy(e._taggerId).getCurrentFilter();var i=h.filteredSubjectList;if(i&&i.length>0){var j={id:"taggerFilter",content:{ids:i}};e._modelEvents.publish({event:"xmodel-list-data-filter-action",data:j})}},onTagColor:function(h){console.log();e._setDataColor(h.coloredSubjects)},onTagUncolor:function(){console.log();e._unsetDataColor()},colorize:true};var g=f||[];this._taggerComponent.setTagProxy(this._taggerId,d,g)},_getDataIds:function(){var e=[];var d=this._model.getChildren();if(d){d.forEach(function(f){var g=f.options.id||f._id;e.push(g)})}return e},_setDataColor:function(d){this._modelEvents.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:true}});this._model.search({match:function(e){if(d.hasOwnProperty(e.nodeModel.options.id)){e.nodeModel.prepareUpdate();e.nodeModel.updateOptions({color:d[e.nodeModel.options.id]});e.nodeModel.setAttribute("color",d[e.nodeModel.options.id]);e.nodeModel.pushUpdate();return true}return false}})},_unsetDataColor:function(){this._modelEvents.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:false}});this._model.prepareUpdate();this._model.search({match:function(d){if(d.nodeModel.options.id){d.nodeModel.updateOptions({color:""});d.nodeModel.setAttribute("color","#ffffff00");return true}return false}});this._model.pushUpdate()},_filterTagger:function(d){if(this._taggerComponent.getTagProxy(this._taggerId)){this._taggerComponent.filterTags(this._taggerId,d)}},_activateTagger:function(){if(this._taggerComponent.getTagProxy(this._taggerId)){this._taggerComponent.activate(this._taggerId)}else{this._modelEvents.publish({event:"xmodel-list-tagger-init-action"})}},_deactivateTagger:function(){this._taggerComponent.deactivate(this._taggerId)},destroy:function(){this._taggerComponent.killTagProxy(this._taggerId)}});return c});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewEmptyContent",["DS/ENOXEmptyContent/js/ENOXEmptyContent"],function(b){var a=function(e,d,g,c){this._ENOXEmptyContent=new b(d.emptyContentOptions);this._ENOXEmptyContent.inject(c);this._modelEvents=g;console.log("hey i am the empty content");if(e.getChildren().length===0){c.classList.remove("displaynone")}var f=this;["addChild","removeChild"].forEach(function(h){e.addEventListener(h,function(){if(e.getChildren().length===0){c.classList.remove("displaynone");f._modelEvents.publish({event:"xmodel-list-is-empty",data:true})}else{c.classList.add("displaynone");f._modelEvents.publish({event:"xmodel-list-is-empty",data:false})}})})};return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListView",["DS/xPortfolioUXCommons/XModelListView/js/XModelListViewCollectionToolBar","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewEmptyContent","DS/DataGridView/DataGridView","DS/ENOXDataDragAndDrop/js/ENOXDataDragAndDrop","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/UIKIT/Mask","DS/Menu/ContextualMenu","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Tree/TreeDocument","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","i18n!DS/xPortfolioUXCommons/assets/nls/XModelListView","css!xPortfolioUXCommons/XModelListView/css/XModelListView.css"],function(o,e,b,m,p,c,q,g,j,h,d,a,l,n,i,f){var k=function(r){this._withToolBar=r.withToolBar!==undefined?r.withToolBar:true;this._initDivs();if(!r.viewOptions){r.viewOptions={}}if(!r.model){r.model=new a({})}this._model=r.model;this._options=r;this._id=r.id||"ViewId";this._useAsyncExpand=r.useAsyncExpand==true?true:false;this._model.options.useAsyncPreExpand=this._useAsyncExpand;this._groupedRows=[];this._modelEvents=r.modelEvents;this.useDragAndDrop=r.useDragAndDrop||false;var t=r.extensions||[];this._initExtensions_v1(t);if(this._withToolBar){this._initToolBar(this._model,r)}this._initListView(r.viewOptions);if(r.emptyContentOptions!=null){this._initEmptyContent(this._model,r)}this._subscribeEvents();if(widget&&UWA.is(widget,"object")){var s=this;widget.addEvent("onSearch",function(u){s._modelEvents.publish({event:"xmodel-list-dashboard-search-action",data:u})});widget.addEvent("onResetSearch",function(){s._modelEvents.publish({event:"xmodel-list-dashboard-search-action",data:""})})}};k.prototype._subscribeEvents=function(){var r=this;this._modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(s){if(r._groupedRows.length>0){var t=r._model.addEventListener("pushUpdate",function(){r._model.removeEventListener(t);r._switchView(s)});r._modelEvents.publish({event:"xmodel-list-view-group-by-action",data:[]})}else{r._switchView(s)}r._modelEvents.publish({event:"xmodel-list-toolbar-group-visibility",data:(s=="DataGridView")})});this._model.subscribe({event:"addChild"},function(s){console.log();var t=r._getContextualMenu(s.data.nodeModel);s.data.nodeModel.options.contextualMenu=t;r._onDataUpdate()});this._model.subscribe({event:"removeChild"},function(s){console.log();r._onDataUpdate()});this._modelEvents.subscribe({event:"xmodel-list-view-group-by-action"},function(t){if(!t){t=[]}var s=r._contentViews.DataGridView;if(s){r._groupedRows=t;s.groupRows({dataIndexesToGroup:t});r._modelEvents.publish({event:"xmodel-list-data-set-filter-node-level",data:r._groupedRows.length})}});this._modelEvents.subscribe({event:"xmodel-list-view-update-grouping-action"},function(u){var s=r._contentViews.DataGridView;if(s&&u){var t=r._groupedRows;if(UWA.is(t,"array")&&t.length>0){if(typeof groupRoots=="function"){u.groupRoots({propertiesToGroup:t})}}r._modelEvents.publish({event:"xmodel-list-data-set-filter-node-level",data:r._groupedRows.length})}});this._modelEvents.subscribe({event:"xmodel-list-view-expand-all-action"},function(){r._model.prepareUpdate();r._model.expandAll();r._model.pushUpdate()});this._modelEvents.subscribe({event:"xmodel-list-view-collapse-all-action"},function(){r._model.prepareUpdate();r._model.collapseAll();r._model.pushUpdate()});this._modelEvents.subscribe({event:"xmodel-list-data-on-load-start"},function(){if(r._container){g.mask(r._container)}});this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){if(r._container&&g.isMasked(r._container)){g.unmask(r._container)}});this._modelEvents.subscribe({event:"xmodel-list-context-search-action"},function(s){var t={id:"ContextSearch",content:{value:s}};r._modelEvents.publish({event:"xmodel-list-data-search-action",data:t})});this._modelEvents.subscribe({event:"xmodel-list-dashboard-search-action"},function(s){var t={id:"GlobalSearch",content:{value:s}};r._modelEvents.publish({event:"xmodel-list-data-search-action",data:t})});this._modelEvents.subscribe({event:"xmodel-list-data-sort-action"},function(t){var s=r._contentViews.DataGridView;if(s){s.sortModel=[t]}});this._modelEvents.subscribe({event:"xmodel-list-set-column-visibility-action"},function(t){var s=r._contentViews.DataGridView;if(s){s.layout.setColumnVisibleFlag(t.dataIndex,t.visibility)}});this._model.getXSO().onAdd(function(s){if(s.options&&s.options.id){console.log("on add selection ");r._modelEvents.publish({event:"xmodel-list-item-on-add-selection",data:{model:s.options.grid,items:r._model.getXSO().get()},context:s})}else{console.log();s.unselect()}});this._model.getXSO().onRemove(function(s){console.log("on remove selection ");if(s.options&&s.options.id){r._modelEvents.publish({event:"xmodel-list-item-on-remove-selection",data:{model:s.options.grid,items:r._model.getXSO().get()},context:s});if(r._model.getSelectedNodes()&&r._model.getSelectedNodes().length==0){console.log("empty selection");r._modelEvents.publish({event:"xmodel-list-item-on-empty-selection"})}}});this._modelEvents.subscribe({event:"xmodel-list-item-on-unselect-all"},function(){r._model.unselectAll()});this._modelEvents.subscribe({event:"xmodel-list-item-get-selection"},function(u){if(UWA.is(u,"function")){var t=r._model.getXSO().get();var s=t.map(function(v){return v.options.grid});u(s||[])}});this._modelEvents.subscribe({event:"xmodel-list-data-on-update"},function(){r._onDataUpdate()});this._modelEvents.subscribe({event:"xmodel-list-reset-sort-model"},function(){if(r._contentViews.DataGridView){r._contentViews.DataGridView.sortModel=null}});this._model.onPreExpand(function(s){r._modelEvents.publish({event:"xmodel-list-view-on-expand",data:{model:s.data.nodeModel.options.grid,nodeInfo:s.data},context:s.data.nodeModel})})};k.prototype._initEmptyContent=function(r,s){this._emptyContainer=document.createElement("div");this._emptyContainer.classList.add("mdllv-empty-container");if(!this._withToolBar){this._emptyContainer.classList.add("no-toolbar")}this._emptyContainer.classList.add("displaynone");this._XModelListViewEmptyContent=new e(r,s,this._modelEvents,this._emptyContainer);var t=this;this._modelEvents.subscribe({event:"xmodel-list-is-empty"},function(u){if(u){t._listContainer.classList.add("displaynone")}else{t._listContainer.classList.remove("displaynone")}});this._container.appendChild(this._emptyContainer)};k.prototype._initDivs=function(){this._container=UWA.createElement("div");this._container.classList.add("xmodel-list-view");this._collectionToolBarContainer=document.createElement("div");this._collectionToolBarContainer.classList.add("xmdllv-collectiontoolbar-container");this._listContainer=document.createElement("div");this._listContainer.classList.add("xmdllv-list-container");if(!this._withToolBar){this._listContainer.classList.add("no-toolbar");this._collectionToolBarContainer.classList.add("no-toolbar")}this._container.appendChild(this._collectionToolBarContainer);this._container.appendChild(this._listContainer)};k.prototype._initToolBar=function(r,s){this._collectionToolBar=new o(r,s,this._modelEvents);this._collectionToolBar.inject(this._collectionToolBarContainer)};k.prototype.attachResizeSensor=function(){this._collectionToolBar.attachResizeSensor()};k.prototype._setDragData=function(t,y){var x=[];for(var s=0;s<y.length;s++){var w=y[s]._getDataModel();var u=w?w._getData().grid:{id:"",type:"",modelID:""};var r={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:"",objectId:u.id,objectType:(u.type).trim()||"",objectName:u.name||"",displayType:(u.type).trim()||"",displayName:w._getData().label};x.push(r)}var v={protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widget_id:widget.id,data:{items:x}};t.dataTransfer.setData("Text",JSON.stringify(v));t.dataTransfer.effectAllowed="all"};k.prototype._initListView=function(s){this._views=s.views||["DataGridView"];this._currentView=s.currentView?s.currentView:this._views[0];this._contentViews={};var r={height:"inherit",displayedOptionalCellProperties:["contextualMenu","description","propertiesList"],allowUnsafeHTMLContent:false,model:this._model,};var v=this;var t={callback:function(E){var D=E.menu?E.menu:[];var z=E.cellInfos.nodeModel;if(v._contentViews[v._currentView]&&v._contentViews[v._currentView].activeNode){var C=v._contentViews[v._currentView].activeNode;if(z!=C){z=C;D=v._getContextualMenu(C)}}if(z&&z._listOfChildren==null){return D}if(z){var A=z.getTreeDocument();var y=true;var B=0;while(B<D.length&&y){if(D[B].id==="expand"){y=false}B++}if(y){D.push({type:"SeparatorItem"});D.push({id:"expand",type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-chevron-down"},title:i._expand_content,action:{callback:function(F){if(A!==undefined){z.expandAll()}}},state:z.isExpanded()?"disabled":"enabled"});D.push({id:"collapse",type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-eye-off"},title:i._hide_content,action:{callback:function(F){if(A!==undefined){z.collapseAll()}}},state:z.isExpanded()?"enabled":"disabled"})}}return D}};var x={label:"label",subLabel:"subLabel",description:"description"};UWA.extend(x,s.itemViewMapping||{});var u={getLabel:function(y){return UWA.is(x.label,"function")?x.label.call(this,y):y.options.grid[x.label]},getSubLabel:function(y){return UWA.is(x.subLabel,"function")?x.subLabel.call(this,y):y.options.grid[x.subLabel]},getDescription:function(y){return UWA.is(x.description,"function")?x.description.call(this,y):y.options.grid[x.description]}};var w=function(y){y.cellView.getContent().setAttribute("node-depth",y.nodeModel.getNodeDepth())};this._views.forEach(function(H){if(H==="DataGridView"){var G={identifier:s.identifier?s.identifier:v._options.id?v._options.id:undefined,treeDocument:v._model,_useClipboardFlag:true,cellSelection:"none",defaultColumnDef:{width:"auto",typeRepresentation:"string",groupableFlag:false,editionPolicy:"EditionOnClick"},onContextualEvent:function(M){var L=[];if(M&&M.collectionView&&M.cellInfos){var J=M.collectionView.columns.length;var I=M.cellInfos.columnID;var K=M.cellInfos.rowID;if(I!=0&&I!=1&&K===-1){L=M.collectionView.buildDefaultContextualMenu(M,{pin:true,firstColumnsVisibility:true,columnsManagement:true,sizeColumnToFit:false})}else{if(K>-1&&M.cellInfos.nodeModel){L=M.cellInfos.nodeModel.options.contextualMenu||[]}}}return L},rowDragEnabledFlag:v.useDragAndDrop,columnDragEnabledFlag:false,onDragStartRowHeader:function(I,J){var L=this.getTreeDocument()?this.getTreeDocument().getSelectedNodes():[];var K=(L&&L.length>0)?L:[J.nodeModel];v._setDragData(I,K)}};var y=s.grid;if(y.columns){for(var D=0,E=y.columns.length;D<E;D++){var C=y.columns[D];if(C&&C.dataIndex==="tree"){C.alwaysVisibleFlag=true;if(C.sortableFlag!=undefined&&C.sortableFlag===false){C.sortableFlag=true}C.minWidth=150;break}}if(s.contextualActions){y.columns.unshift({text:i._color,dataIndex:"color",typeRepresentation:"color",pinned:"left",width:"50",visibleFlag:false});y.columns.push({text:i._action,dataIndex:"contextualMenu",width:55,resizableFlag:false,allowUnsafeHTMLContent:true,alwaysVisibleFlag:true,sortableFlag:false,groupableFlag:false,typeRepresentation:"contextualMenuType",getCellValue:function(K){var J={menu:[],disabled:false};var I=v._getContextualMenu(K.nodeModel);if(I&&I.length>0){J.menu=I}if(K.nodeModel.options.disableMenu==true){J.disabled=true}return J},})}}UWA.merge(G,y);v._contentViews[H]=new b(G);var z={contextualMenuType:{stdTemplate:"contextualMenuTemplate",semantics:{}}};var A={contextualMenuTemplate:{path:"DS/xPortfolioUXCommons/XModelListView/js/ContextualMenuTweaker"}};if(y.typeRepresentations&&UWA.is(y.typeRepresentations,"object")){UWA.merge(z,y.typeRepresentations)}v._typeRepresentationFactory=v._contentViews[H].getTypeRepresentationFactory();v._typeRepresentationFactory.registerTypeTemplates(A);v._typeRepresentationFactory.registerTypeRepresentations(z);var B=s.editable;if(B){var F=["postEdit"];F.forEach(function(I){v._contentViews[H].addEventListener(I,function(L,M){if(L.dsModel&&L.dsModel.layout&&M&&M.nodeModel&&M.nodeModel.options&&M.nodeModel.options.grid){var K=[M.nodeModel.options.grid];var J=L.dsModel.layout.getDataIndexFromColumnIndex(M.columnID);J=J&&J==="tree"?"title":J;if(J==="description"&&M.nodeModel.options.description!=undefined){K[0].description=M.nodeModel.options.description}if(J!=undefined&&J!==""){v._modelEvents.publish({event:"list-view-update-inline-action",data:{model:K,name:J,value:M.cellModel,cell:M}})}}})})}v._contentViews[H]._applySortModelOrig=v._contentViews[H]._applySortModel;v._contentViews[H]._applySortModel=function(J){this._applySortModelOrig(J);if(this._isCurrentlyCalledFromUIInteraction()===true){var K=this.sortModel&&this.sortModel.length>0?this.sortModel[0]:undefined;if(K){var I={sortOrder:K.sort?K.sort.toUpperCase():undefined,sortAttribute:K.dataIndex?K.dataIndex:undefined};v._modelEvents.publish({event:"enox-collection-toolbar-sort-activated",data:I})}}}}else{if(H==="TileView"){v._contentViews[H]=new (p.inherit(u))(r);v._contentViews[H].onContextualEvent=t;v._contentViews[H].onPostCellRequest(w)}else{if(H==="ThumbnailView"){v._contentViews[H]=new (c.inherit(u))(r);v._contentViews[H].onContextualEvent=t;v._contentViews[H].onPostCellRequest(w)}else{if(H==="LargeThumbnailView"){v._contentViews[H]=new (q.inherit(u))(r);v._contentViews[H].onContextualEvent=t;v._contentViews[H].onPostCellRequest(w)}}}}if(v.useDragAndDrop){v._contentViews[H].useDragAndDrop=v.useDragAndDrop;v._contentViews[H].onDragStartCell=function(I,J){var L=this.getTreeDocument().getSelectedNodes()?this.getTreeDocument().getSelectedNodes():[];var K=(L&&L.length>0)?L:J.nodeModel;v._setDragData(I,K)};v._contentViews[H].onDragEnterBlankDefault=function(I){};v._contentViews[H].onDragEnterBlank=function(I){}}v._contentViews[H].addEventListener(h.POINTERHIT,function(I,J){if(J&&J.nodeModel&&J.nodeModel.options.id){if(I.multipleHitCount==2){console.log("xmodel-list-item-on-dblclickPOINTERHIT");v._modelEvents.publish({event:"xmodel-list-item-on-dblclick",data:{model:J.nodeModel.options.grid},context:J.nodeModel})}}});v._contentViews[H].addEventListener("click",function(K,L){if(L&&L.nodeModel&&L.nodeModel.options.id){console.log("xmodel-list-item-on-click");var I=K.target.getAttribute("href");if(I!=null&&I!=undefined){var J=K.dsModel.layout.getDataIndexFromColumnIndex(L.columnID);v._modelEvents.publish({event:"xmodel-list-item-on-link-click",data:{model:L.nodeModel.options.grid,linkId:J?J:I,}})}else{v._modelEvents.publish({event:"xmodel-list-item-on-click",data:{model:L.nodeModel.options.grid,event:K},context:L.nodeModel})}}})});this._switchView(this._currentView)};k.prototype._getSelectedItem=function(){var s=this._model.getXSO().get();var r=s.map(function(t){return t.options.grid});return r};k.prototype._switchView=function(r){var s=this._contentViews[r];if(s){this._currentView=r;UWA.extendElement(this._listContainer).setContent(s.getContent());if(this._currentView!="DataGridView"){this._modelEvents.publish({event:"xmodel-list-toolbar-group-visibility",data:false})}}};k.prototype.inject=function(r){r.appendChild(this._container)};k.prototype.getTypeRepresentationFactory=function(r){return this._typeRepresentationFactory};k.prototype._initExtensions_v1=function(u){var r={id:this._id,model:this._model,modelEvents:this._modelEvents};var v=this;v._extensions=[];var t=[];var s=[];if(u&&u instanceof Array&&u.length>0){u.forEach(function(x){switch(UWA.typeOf(x)){case"string":t.push(new UWA.Promise(function(z,y){require([x],function(A){z(A)},function(A){y("Error loading modules."+((A&&A.requireModules)?A:""))})}));break;case"class":s.push(x);break}})}console.log("[xModelListView:_initExtensions_v1] No. of Extension to initialize: "+s.length+" to resolve:  "+t.length);s.forEach(function(y){var x=new y();x.initialize(r);v._extensions.push(x)});function w(x){x.forEach(function(z){var y=new z();v._extensions.push(y)});v._extensions.forEach(function(y){y.initialize(r)})}if(t.length>0){UWA.Promise.all(t).then(w)}};k.prototype._initExtensions=function(s){var r={id:this._id,model:this._model,modelEvents:this._modelEvents};var t=this;t._extensions=[];function v(w){w.forEach(function(y){var x=new y();t._extensions.push(x)});t._extensions.forEach(function(x){x.initialize(r)})}function u(w){var x=w.map(function(y){switch(UWA.typeOf(y)){case"string":return new UWA.Promise(function(A,z){require([y],function(B){A(B)},function(B){z("Error loading modules."+((B&&B.requireModules)?B:""))})});break;case"class":return UWA.Promise.resolve(y)}});return UWA.Promise.all(x)}u(s).then(v)};k.prototype.addExtension=function(r){};k.prototype.filter=function(r){if(r.id){this._filters[r.id]=r.content||{};var t=r.content;if(t.ids){this._model.prepareUpdate();var s=this._model.search({match:function(u){if(t.ids.indexOf(u.nodeModel.options.id)!=-1){u.nodeModel.matchSearch();return true}u.nodeModel.unmatchSearch();return false}});this._model.pushUpdate()}}};k.prototype._onDataUpdate=function(){if(this._groupedRows.length==0){var s=0;var r=this._model.getChildren();if(r){var t=r.filter(function(u){return u.isVisible()});s=t.length}this._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:s})}};k.prototype._getContextualMenu=function(r){var t=[];if(this._options.viewOptions.contextualActions&&r.options.id){var s=this._options.viewOptions.contextualActions;if(UWA.is(this._options.viewOptions.contextualActions,"function")){s=this._options.viewOptions.contextualActions.call(r)}s.forEach(function(v){var u={id:v.id,type:"PushItem",title:v.text,state:v.state?v.state:"enabled",action:{callback:function(x,w){console.log(v.handler);console.log(r);if(UWA.is(v.handler,"function")){v.handler.call(r,r.options.grid)}}}};if(v.fonticon){u.fonticon={content:"wux-ui-3ds wux-ui-3ds-"+v.fonticon}}t.push(u)})}return t};k.prototype.destroy=function(r){this._extensions.forEach(function(s){s.destroy()})};k.prototype.isGrouped=function(r){return(this._groupedRows&&this._groupedRows.length>0)};return k});define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemCollection",["UWA/Class/Collection","DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemModel"],function(b,a){return b.extend({model:a,})});define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/WrappedAdvSetView",["UWA/Class/View","UWA/Class/Model","DS/ENOXAdvancedSetView/js/ActionsToolbar","DS/ENOXAdvancedSetView/js/ENOXAdvancedSetView","DS/ENOXAdvancedSetView/js/GridScrollView","DS/W3DXComponents/Views/Item/TileView","DS/Core/ModelEvents","DS/DataDragAndDrop/DataDragAndDrop","DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemModel","DS/Handlebars/Handlebars","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBar","DS/PlatformAPI/PlatformAPI","i18n!DS/xPortfolioUXCommons/assets/nls/WrappedAdvSetView","css!DS/xPortfolioUXCommons/WrappedAdvSetView/css/WrappedAdvSetView.css"],function(b,i,m,a,p,l,g,n,e,f,j,o,d,c){var k=[];var h=function(){};h.prototype.init=function(q,r){this._options=r;this._options.enableRefresh=true;this._parentUpdateChannel=q;this._bridgeModelEvent=new g();this._selectionCount=0;this._initDivs();this._initSubViews();this._subscribeToEvents();this.__pendingClick=0;this.__clearTimeout=0;this._listSelectedIds=[];this._listSelectedObjects=[]};h.prototype._initDivs=function(){var t=this;this._container=document.createElement("div");this._container.classList.add("wrapped-set-view-main-container");this._titleDiv=document.createElement("div",{id:"titleContainerDiv"});if(this._options.showTitle){this._titleDiv.classList.add("wrapped-set-view-title-container");this._container.appendChild(this._titleDiv);this._titleSpan=document.createElement("span");this._titleSpan.classList.add("wrapped-set-view-title-span");this._titleSpan.innerHTML=this._options.viewTitle?this._options.viewTitle:"";this._titleDiv.appendChild(this._titleSpan)}this._stdActionbarContainer=UWA.createElement("div",{id:"filterContainerDiv"});this._stdActionbarContainer.addClassName("wrapped-set-view-filter-container");this._advSetViewContainer=UWA.createElement("div");this._advSetViewContainer.classList.add("wrapped-set-view-set-container");if(this._options.isDroppable){var r=d.MSG_DROP_TO_CREATE_NEW_VALUE?d.MSG_DROP_TO_CREATE_NEW_VALUE:"Drop here to create new Value";if(this._options.dropMessage){r=this._options.dropMessage}var s=UWA.createElement("div",{styles:{margin:"auto"},html:[{tag:"span","class":"fonticon fonticon-plus",styles:{textAlign:"center",width:"100%",fontSize:"35px",}},{tag:"div",html:r,styles:{textAlign:"center",width:"100%",fontSize:"20px"}}],});var q=UWA.createElement("div",{styles:{width:"100%",height:"100%",position:"absolute",top:0,border:"5px #368ec4",borderStyle:"dashed",borderRadius:"5px",display:"flex",color:"#368ec4",backgroundColor:"#f6f3f3",opacity:".5"},html:s});n.droppable(this._advSetViewContainer,{over:function(w,u){var v=t._advSetViewContainer.getBoundingClientRect();if((u.x-10)>v.left&&(u.x+10)<v.right&&(u.y-10)>v.top&&(u.y+10)<v.bottom){var x=t._advSetViewContainer.offsetTop;if(x){if(q.getStyle("top")!=""+x+"px"){q.setStyles({top:""+x+"px",height:"calc( 100% - "+x+"px )"})}}if(!q.isInjected(t._advSetViewContainer)){q.inject(t._advSetViewContainer)}return true}else{q.remove()}return false},enter:function(v,u){},leave:function(w,u){var v=t._advSetViewContainer.getBoundingClientRect();if((u.x-10)<v.left||(u.x+10)>v.right||(u.y-10)<v.top||(u.y+10)>v.bottom){q.remove()}},drop:function(x,v,w){q.remove();var u=w.dataTransfer.items;t._parentUpdateChannel.publish({event:"wrapped-adv-set-view-drop-event",data:u})}})}this._container.appendChild(this._stdActionbarContainer);this._container.appendChild(this._advSetViewContainer)};h.prototype._initSubViews=function(){var q=this;this._stdActionbar=new j(this._getCollectionToolbarOptions());this._advSetView=new a(this._getSetViewOptions());this._advSetView.render().inject(this._advSetViewContainer);this._stdActionbar.inject(this._stdActionbarContainer);this._stdActionbar._modelEvents.subscribe({event:"enox-collection-toolbar-sort-activated"},function(r){q._bridgeModelEvent.publish({event:"advanced-set-view-sort",data:[{id:r.sortAttribute,desc:r.sortOrder==="DESC"?true:false}]})});this._stdActionbar._modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(r){q._bridgeModelEvent.publish({event:"advanced-set-view-switch",data:{id:r}})});this._hideDefActionbar();k.push(this._stdActionbar)};h.prototype._subscribeToEvents=function(){var r=this;var q=0;if(this._options.enableRefresh){o.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(t){console.log("Events from PlatformAPI");var s=t?(t.data?(t.data.authored?(t.data.authored.modified?t.data.authored.modified:[]):[]):[]):[];s.forEach(function(v,u){if(v){if(r._options.collection.get(v)){r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-refresh-item",data:v})}else{console.log("This WrappedAdvSetView instance's collection does not have this id!!!")}}})})}this._advSetView.listenTo(this._advSetView,{onItemViewClick:function(){console.log("On ItemView click");var u=arguments&&arguments.length>=3?arguments[2].model.id:null;var t=arguments&&arguments.length>=3?arguments[2].model._attributes.name:null;var s=arguments&&arguments.length>=3?arguments[2].model._attributes.version:null;r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-item-click",data:{id:u,name:t,version:s}})}});this._advSetView.listenTo(this._advSetView,{onItemViewDblClick:function(){console.log("onItemViewDblClick");var v=arguments&&arguments.length>=3?arguments[2].model.id:null;var u=arguments&&arguments.length>=3?arguments[2].model._attributes.name:null;var t=arguments&&arguments.length>=3?arguments[2].model._attributes.version:null;var s={};if(arguments.length>=3){s=arguments[2].model.toJSON();arguments[2].unSelect({silent:true})}UWA.merge(s,{id:v,name:u,version:t});r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-item-dbl-click",data:s})}});this._bridgeModelEvent.subscribe({event:"advanced-set-view-filtered"},function(){var s=r._advSetView.filteredCollection?r._advSetView.filteredCollection.length:0;r._stdActionbar._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:s})});this._parentUpdateChannel.subscribe({event:"wrapped-adv-set-view-resize"},function(t){var v=this,s;for(var u=0;u<v.length;u++){if(v[u]._container.offsetWidth>0){s=v[u];break}}if(s){s._resize()}if(t&&typeof(t)==="function"){t()}}.bind(k));this._parentUpdateChannel.subscribe({event:"wrapped-adv-set-view-fetch-selection-count"},function(s){if(s&&typeof(s)==="function"){s(r._selectionCount)}});this._parentUpdateChannel.subscribe({event:"wrapped-adv-set-view-filter"},function(s){r._bridgeModelEvent.publish({event:"advanced-set-view-filter",data:s})});this._bridgeModelEvent.subscribe({event:"advanced-set-view-filtered"},function(s){r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filtered",data:s})})};h.prototype.getSelectedIds=function(){return this._listSelectedIds};h.prototype.getSelectedObjects=function(){return this._listSelectedObjects};h.prototype.inject=function(q){q.appendChild(this._container)};h.prototype.getContent=function(){return this._container};h.prototype.destroy=function(){if(this._container&&this._container.parentElement){this._container.parentElement.removeChild(this._container)}};h.prototype._hideDefActionbar=function(){var q=this._container.getElementsByClassName("advanced-set-view-header set-header");if(q.length>0){q[0].style.setProperty("display","none")}};h.prototype._setReferenceCollection=function(s){var r=this;if(this._advSetView.currentViewId&&this._advSetView.contentsViews){if(this._advSetView.contentsViews[this._advSetView.currentViewId].nestedView){this._advSetView.contentsViews[this._advSetView.currentViewId].nestedView.deactivateMultisel()}}this._advSetView.collection.set(s.toArray());this._advSetView._referenceCollection=s.clone();var q=this._advSetView.collection?this._advSetView.collection.length:0;this._stdActionbar._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:q})};h.prototype._getSetViewOptions=function(){var s=this;var t=UWA.clone(s._options.itemViewMapping||{});UWA.merge(t,{title:"title",content:"description",image:"image"});var r=s._options.filters?s._options.filters:[];var q={collection:s._options.collection,lazyRender:true,contents:{selectionMode:"nullToMany",useInfiniteScroll:false,views:[{id:"tile",title:d.TILE?d.TILE:"Tile",view:p,itemView:l},{id:"thumbnail",title:d.THUMBNAIL?d.THUMBNAIL:"Thumbnail",view:p}],itemViewOptions:{mapping:t,attributes:{draggable:true},contextualActions:s._options.contextualActions?s._options.contextualActions:[]},events:{onItemViewDrag:function(z,w,y){if(w&&w.model){var v=w.model.toJSON();var x={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",contextId:"",objectId:v.id,objectType:"Hardware Product",displayName:v.name,displayType:"Hardware Product"};var u={protocol:"3DXContent",version:"1.1",source:"xModelApp",widgetId:widget.id,data:{items:[x]}};y.dataTransfer.setData("Text",JSON.stringify(u));console.log()}},onAddSelection:function(){s.__pendingClick+=1;if(s.__pendingClick>=2){clearTimeout(s.__clearTimeout)}var u=arguments;s.__clearTimeout=setTimeout(function(){if(s.__pendingClick>=2){s.__pendingClick=0;return}if(u&&u.length<2){console.log("Wrapped Adv Set view: Problem with received arguments!!!");return}var v=u[0].getSelection();s.__updateSelectedIdsAndObjectsList(v);s._parentUpdateChannel.publish({event:"wrapped-adv-set-view-selection-on-add",data:{parentView:u[0],itemView:u[1],unselectedId:u[1].id,selectedObject:{id:u[1].id,attributes:(u[1].attributes?u[1].attributes:(u[1]._attributes?u[1]._attributes:[]))},selectionCount:s._selectionCount,selectedIds:s._listSelectedIds,selectedObjects:s._listSelectedObjects}});s.__pendingClick=0},500)},onRemoveSelection:function(){if(arguments&&arguments.length<2){console.log("Wrapped Adv Set view: Problem with received arguments!!!");return}var u=arguments[0].getSelection();s.__updateSelectedIdsAndObjectsList(u);console.log("Wrapped Adv Set view: Item view onRemoveSelection: selection count: "+s._selectionCount);s._parentUpdateChannel.publish({event:"wrapped-adv-set-view-selection-on-remove",data:{parentView:arguments[0],itemView:arguments[1],unselectedObject:{id:arguments[1].id,attributes:(arguments[1].attributes?arguments[1].attributes:(arguments[1]._attributes?arguments[1]._attributes:[]))},unselectedId:arguments[1].id,selectionCount:s._selectionCount,allSelectedIds:s._listSelectedIds,allSelectedObjects:s._listSelectedObjects}})},onDeactivateMultisel:function(){s._parentUpdateChannel.publish({event:"wrapped-adv-set-view-selection-on-remove-all",data:arguments[1]});var u=arguments[0].getSelection();s.__updateSelectedIdsAndObjectsList(u)}},},events:{onInfiniteScroll:function(u){var w=u.collection,v={type:"json",onComplete:function(){u.scrollView.endLoading()}};if(w.state.totalRecords===null){w.getFirstPage(v)}else{if(w.hasNextPage()){w.getNextPage(UWA.extend(v,{remove:false,reset:false}))}else{u.container.removeClassName("loading");u.scrollView.useInfiniteScroll(false)}}}},actions:{view:m,collection:function(){var u=[];u.push({id:"filterby",title:"Filter By",overflow:false,type:"filter",multiSelect:true,key:[{name:"type",value:"Part",label:""},{name:"type",value:"Model",label:"Only models"}]});u.push({id:"sortby",title:"Sort By",overflow:false,type:"sort",key:[{name:"name",label:""},{name:"description",label:"Description"},{name:"type",label:"Type"},{}]});return u},modelEvents:s._bridgeModelEvent,events:{onActionClick:function(w,u,v){console.log("action clicked")}}},buildMultiselActions:function(v){var u=[];u.push({id:"delete",multisel:true,text:"Remove",fonticon:"trash",handler:function(w){console.log("delete")}});return u},modelEvents:s._bridgeModelEvent,filters:r};return q};h.prototype._getCollectionToolbarOptions=function(){var q=this._options.actionBarOptions?this._options.actionBarOptions:{};UWA.merge(q,{withmultisel:false,showItemCount:true,filter:{},actions:[],sort:[{id:"name",text:"Name",type:"string"}],views:[{id:"tile",text:(d.TILE?d.TILE:"Tile"),fonticon:"view-small-tile"},{id:"thumbnail",text:(d.THUMBNAIL?d.THUMBNAIL:"Thumbnail"),fonticon:"view-small-thb"}]});return q};h.prototype._getSorter=function(q){return function(s,r){if(s._attributes[q]&&r._attributes[q]&&(s._attributes[q]>r._attributes[q])){return 1}else{return -1}}};h.prototype._addSortersInAdvSetView=function(){this._advSetView.addCustomSorter("version",this._getSorter("version"));this._advSetView.addCustomSorter("id",this._getSorter("id"));this._advSetView.addCustomSorter("name",this._getSorter("name"));this._advSetView.addCustomSorter("type",this._getSorter("type"))};h.prototype.addItem=function(w,r){if(r){var v=this;var q=v._advSetView.currentViewId;var u=v._advSetView.contentsViews[q];var x=u?v._advSetView.contentsViews[q].nestedView:false;if(x){x.listenToOnce(x,"onAfterItemAdded",function(y){this.deactivateMultisel();this.addSelection(y.model);v._advSetView.scrollToItemView(y.model,{view:u})})}}if(w instanceof i){this._advSetView.collection.add(w);this._advSetView._referenceCollection.add(w);this._options.collection.add(w)}else{if(UWA.is(w,"object")){var s=new e(w);this._advSetView.collection.add(s);this._advSetView._referenceCollection.add(s);this._options.collection.add(s)}}var t=this._advSetView.collection?this._advSetView.collection.length:0;this._stdActionbar._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:t})};h.prototype.__updateSelectedIdsAndObjectsList=function(r){var q=this;this._listSelectedIds=[];this._listSelectedObjects=[];if(r&&r.length>0){r.forEach(function(s){if(s&&s.id){q._listSelectedIds.push(s.id);q._listSelectedObjects.push({id:s.id,attributes:(s.attributes?s.attributes:(s._attributes?s._attributes:[]))})}});this._selectionCount=r.length}else{this._selectionCount=0}console.log("Wrapped Adv set view:__updateSelectedIdsAndObjectsList: Selection count: "+this._selectionCount)};return h});define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/WrappedAdvSetViewWithFilters",["DS/xPortfolioUXCommons/WrappedAdvSetView/js/WrappedAdvSetView","DS/WildcardSearchComponent/WildcardSearchComponent","DS/TaggerOnIndexComponent/TaggerOnIndexComponent"],function(d,b,c){var a=function(){this.WrappedAdvSetView=new d()};a.prototype.init=function(h,e,f){this.tagFriends=f.tagFriends;this._CSearch=[];this._idProxy=h;var g=this;f.filters=f.filters?f.filters:[];f.filters.push({id:"tagFilter",callback:function(l,i){var j=true;var k=g.getTagProxy(g._idProxy);if(!l.WrappedAdvSetViewFilters){l.WrappedAdvSetViewFilters={}}if(l.collection&&l.collection._models&&l.collection._models[i]){(k.filteredSubjectList.indexOf(l.collection._models[i].id)===-1)?l.WrappedAdvSetViewFilters.WASVFTagger=false:l.WrappedAdvSetViewFilters.WASVFTagger=true}else{(k.filteredSubjectList.indexOf(l.id)===-1)?l.WrappedAdvSetViewFilters.WASVFTagger=false:l.WrappedAdvSetViewFilters.WASVFTagger=true}Object.keys(l.WrappedAdvSetViewFilters).forEach(function(m){if(l.WrappedAdvSetViewFilters[m]==false){j=false}});return j}});f.filters.push({id:"ContextSearchFilter",callback:function(n,j){var k=true;var m=[];for(var l=0;l<g._CSearch.length;l++){m.push(g._CSearch[l].id)}if(!n.WrappedAdvSetViewFilters){n.WrappedAdvSetViewFilters={}}if(n.collection&&n.collection._models&&n.collection._models[j]){(m.indexOf(n.collection._models[j].id)===-1)?n.WrappedAdvSetViewFilters.WASVFCSearch=false:n.WrappedAdvSetViewFilters.WASVFCSearch=true}else{(m.indexOf(n.id)===-1)?n.WrappedAdvSetViewFilters.WASVFCSearch=false:n.WrappedAdvSetViewFilters.WASVFCSearch=true}Object.keys(n.WrappedAdvSetViewFilters).forEach(function(i){if(n.WrappedAdvSetViewFilters[i]==false){k=false}});return k}});f.filters.push({id:"GlobalSearchFilter",callback:function(n,j){var k=true;var m=[];for(var l=0;l<g._GSearch.length;l++){m.push(g._GSearch[l].id)}if(!n.WrappedAdvSetViewFilters){n.WrappedAdvSetViewFilters={}}if(n.collection&&n.collection._models&&n.collection._models[j]){(m.indexOf(n.collection._models[j].id)===-1)?n.WrappedAdvSetViewFilters.WASVFGSearch=false:n.WrappedAdvSetViewFilters.WASVFGSearch=true}else{(m.indexOf(n.id)===-1)?n.WrappedAdvSetViewFilters.WASVFGSearch=false:n.WrappedAdvSetViewFilters.WASVFGSearch=true}Object.keys(n.WrappedAdvSetViewFilters).forEach(function(i){if(n.WrappedAdvSetViewFilters[i]==false){k=false}});return k}});this._options=f;this._parentUpdateChannel=e;this._TaggerOnIndexComponent=c;this.WrappedAdvSetView.init(e,f);this.WildcardSearch=new b();this._subscribeToEvents()};a.prototype._initContextSearch=function(){var f=this;var e=function(g){f._CSearch=g;f.WrappedAdvSetView._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filter",data:[{id:"ContextSearchFilter",exclude:false}]})};this.WrappedAdvSetView._stdActionbar._modelEvents.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(g){f.WildcardSearch.search(g.searchValue[0],f.WrappedAdvSetView._options.collection,e)})};a.prototype._initSearch=function(){var f=this;var e=function(g){f._GSearch=g;f.WrappedAdvSetView._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filter",data:[{id:"GlobalSearchFilter",exclude:false}]})};if(this.WrappedAdvSetView._options.applicationChannel){this.WrappedAdvSetView._options.applicationChannel.subscribe({event:"search-in-current-dashboard"},function(g){f.WildcardSearch.search(g,f.WrappedAdvSetView._options.collection,e)})}};a.prototype._initTagger=function(g){var f=this;var h=function(){f._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filter",data:[{id:"tagFilter",exclude:false}]})};var e={onTagFilterChange:h,MyFriends:this.tagFriends};f._TaggerOnIndexComponent.setTagProxy(f._idProxy,e,g)};a.prototype.getTagProxy=function(e){return this._TaggerOnIndexComponent.getTagProxy(e).getCurrentFilter()};a.prototype._initDivs=function(){this.WrappedAdvSetView._initDivs()};a.prototype._initSubViews=function(){this.WrappedAdvSetView._initSubViews()};a.prototype._subscribeToEvents=function(){this._initContextSearch();this._initSearch()};a.prototype.inject=function(e){this.WrappedAdvSetView.inject(e)};a.prototype.getContent=function(){return this.WrappedAdvSetView.getContent()};a.prototype.destroy=function(){this.WrappedAdvSetView.destroy()};a.prototype._hideDefActionbar=function(){this.WrappedAdvSetView._hideDefActionbar()};a.prototype._setReferenceCollection=function(g){this.WrappedAdvSetView._setReferenceCollection(g);var e=[];for(var f=0;f<g._models.length;f++){e.push(g._models[f].get("id"))}if(this._options.noPublishOnCreate==undefined||!this._options.noPublishOnCreate){this._initTagger(e)}};a.prototype.publishTags=function(){var e=[];for(var f=0;f<this.WrappedAdvSetView._advSetView._referenceCollection.length;f++){e.push(this.WrappedAdvSetView._advSetView._referenceCollection._models[f].get("id"))}if(e.length==0){this.clearTags()}else{this._initTagger(e)}};a.prototype.clearTags=function(){this._TaggerOnIndexComponent.killTagProxy(this._idProxy)};a.prototype._getSetViewOptions=function(){return this.WrappedAdvSetView._getSetViewOptions()};a.prototype._getCollectionToolbarOptions=function(){return this.WrappedAdvSetView._getCollectionToolbarOptions()};a.prototype._getSorter=function(e){return this.WrappedAdvSetView._getSorter(e)};a.prototype._addSortersInAdvSetView=function(){this.WrappedAdvSetView._addSortersInAdvSetView()};a.prototype.addItem=function(f,e){this.WrappedAdvSetView.addItem(f,e)};a.prototype.getSelectedIds=function(){return this.WrappedAdvSetView.getSelectedIds()};a.prototype.getSelectedObjects=function(){return this.WrappedAdvSetView.getSelectedObjects()};return a});
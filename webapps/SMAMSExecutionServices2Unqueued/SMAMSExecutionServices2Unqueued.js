/*! Copyright 2017 Dassault Systemes */
define("DS/SMAMSExecutionServices2Unqueued/Constants",[],function(){var a={};a.OS="OS";a.WINDOWS="WINDOWS";a.APPLICATION_NAME="ApplicationName";a.APPLICATION_VERSION="ApplicationVersion";a.EXECUTION_MODE="executionMode";a.OUTPUT_OBJECT_PARAM="outputObjectParam";a.SMA_MANIFEST=".sim";a.UPDATE_SIMULATION_RESULTS="UpdateSimulation_Results";a.UPDATE_SIMULATION_SEQUENCE="UpdateSimulation_Sequence";a.SEQUENCE_NAME="SequenceName";a.SIMULATION_PREFIX="Simulation_Prefix";a.SIMULATION_TITLE="Simulation_Title";a.SIMULATION_NAME_SEPARATOR=" - ";a.VISU_SPEC_CATALOG="VisuSpecCatalog";a.SPECIFICATION_CATALOG="SMAMultiScaleSpecificationCatalog";a.PLM_OBJECT="PLMObject";a.PLM_BATCH_ARGUMENTS="PLMBatchArguments";a.NEW_SIMULATION_RESULTS="NewSimulation_Results";a.EXPORTER="exporter";a.PARAMETER_ID="Parameter Id";a.LIGHTWEIGHT_RESULTS="Lightweight results";a.V6_UTILITY="com.dassault_systemes.sma.adapter.V6Utility";a.V6_SIM_IMPORT="com.dassault_systemes.sma.plugin.V6UtilPIsimImport";a.V6_RES_GENERATE="com.dassault_systemes.sma.plugin.V6UtilPIPhyResGenerate";a.REP_REFERENCE_TYPE="RFLVPMLogicalRepReference";a.FMU_REFERENCE_TYPE="LogicalFMUBehaviorRepRef";a.SIM_REFERENCE_TYPE="LogicalSimulationBehaviorRepRef";a.BEHAVIOR_PATH="BehaviorPath";a.TITLE="title";a.DESCRIPTION="description";a.GENERIC="generic";a.EXPERIMENT="Experiment";a.SYSTEM="System";a.LEFT="Left";a.CSE_DIRECTOR="CSE-Director";a.RIGHT="Right";a.RESULTS_GENERATION="Results Generation";a.RESULTS="Results";a.MATCH_FILE="*.sim,*.csv,*_outputFiles.zip,*.cgr";a.EMPTY_IMPORT_RULES="<ImportRules/>";a.LAST_ID="lastId";a.RULE="Rule";a.NAME="name";a.ID="id";a.ENABLED="enabled";a.TITLE_SPECIFICATION="titleSpecification";a.TITLE_EQUALS_FILENAME="titleEqualsFileName";a.PARAMETER_NAME="parameterName";a.IMPORT_DOC_TYPE_C="importDocType_C";a.CONTENT_REL_C="contentRel_C";a.REFERENCED="referenced";a.IMPACT_REL_C="impactRel_C";a.NONE="none";a.SOURCE_FILE_NAME="sourceFileName";a.DOC_DESCRIPTION="docDescription";a.RULES="rules";a.CDATA="<![CDATA]>";a.INTERNAL_DATA_TYPE="Simulation Category - Internal Data";a.NONVERSIONED_DOCUMENT_TYPE="Simulation Document - NonVersioned";a.stepConfiguration={};a.DOWNLOAD="Download";a.stepConfiguration[a.DOWNLOAD]={};a.stepConfiguration[a.DOWNLOAD].extensionType="com.dassault_systemes.sma.adapter.Download";a.FMU="Fmu";a.stepConfiguration[a.FMU]={};a.stepConfiguration[a.FMU].title="Approximation";a.stepConfiguration[a.FMU].extensionType="com.dassault_systemes.sma.adapter.ApproxModel";a.stepConfiguration[a.FMU].ruleProperty="ApproxModelDefinition";a.SIMULATION="Simulation";a.stepConfiguration[a.SIMULATION]={};a.stepConfiguration[a.SIMULATION].title="Abaqus Execution";a.stepConfiguration[a.SIMULATION].extensionType="com.dassault_systemes.sma.adapter.Foreman";a.stepConfiguration[a.SIMULATION].ruleProperty="simFileName";a.TD="3D";a.stepConfiguration[a.TD]={};a.stepConfiguration[a.TD].title="3D FMU";a.stepConfiguration[a.TD].extensionType="com.dassault_systemes.sma.adapter.CSEClient";a.stepConfiguration[a.TD].ruleProperty="clientModel";a.stepConfiguration[a.CSE_DIRECTOR]={};a.stepConfiguration[a.CSE_DIRECTOR].extensionType="com.dassault_systemes.sma.adapter.CSEDirector";a.EXPERIMENT_PARAMS="ExperimentParams";a.CLOUD_PARAMS="CloudParams";a.UPLOAD="Upload";a.stepConfiguration[a.UPLOAD]={};a.stepConfiguration[a.UPLOAD].extensionType="com.dassault_systemes.sma.adapter.Upload";a.SYS_FMU_FMU="*";a.DOWNLOAD2="download";a.APPROX_MODEL_IS_VALID="ApproxModelIsValid";a.APPROX_MODEL_TYPE_NAME="ApproxModelTypeName";a.COSIMULATION_FMU="Co-simulation FMU";a.APPROX_MODEL_TO_ACTIVITY_PARAM_INPUT_MAP="ApproxModelToActivityParamInputMap";a.APPROX_MODEL_TO_ACTIVITY_PARAM_OUTPUT_MAP="ApproxModelToActivityParamOutputMap";a.COSIM_CONFIG="CosimConfig.xml";a.SPEC_FILENAME="spec.xml";a.CPUS="cpus";a.FOREMAN_TYPE="foremanType";a.JOB_NAME="jobName";a.SPEC="spec";a.DOUBLE_PRECISION="doublePrecision";a.CO_SIMULATION="Co-simulation";a.PARAMETER_NAME_ESCAPE=/[\n#$@%**?\\<>[\]|:=.']/g;a.INTERACTION="interaction";a.CSE_FILE_NAME="CSECfgFileDisplayName";a.WEB_MONITORING="WebMonitoring";a.FMU_INSTANCE_NAME="FmuInstanceName";a.INPUT_SOURCE_FILE="InputSourceFile";a.RUNDIR="${rundir}/";return a});
/*! Copyright 2017 Dassault Systemes */
define("DS/SMAMSExecutionServices2Unqueued/Utils",["DS/SMAMSExecutionServices2Unqueued/Constants","i18n!DS/SMAMSExecutionServices2Unqueued/assets/nls/SMAMSExecutionServices2Unqueued.json"],function(b,c){var a={};a.createError=function(d){var f=d.key;delete d.key;var g=d.onFailure;delete d.onFailure;var h=new Error(c.get(f,d));if(g){g(h)}else{throw h}};a.getInternalData=function(f){var d=f.getContentChildren();for(var e=0;e<d.length;e++){if(d[e].getObjectType()===b.INTERNAL_DATA_TYPE){return d[e]}}a.createError({key:"Category not found",category:b.INTERNAL_DATA_TYPE,activity:f.getName()})};return a});
/*! Copyright 2017 Dassault Systemes */
define("DS/SMAMSExecutionServices2Unqueued/ExperimentUnqueued",["UWA/Core","DS/SMAProcWebAsyncUtils/Activity/Delete","DS/SMAProcWebCMMUtils/SMAJSCMMParameterUtils","DS/SMAProcWebCMMUtils/SMAJSCMMDataFlowUtils","DS/SMAProcWebAsyncUtils/SMAProcWebTransactionManager","DS/JSCMM/SMAJSCMMLayout","DS/JSCMM/SMAJSCMMPLMObject","DS/SMAMSExecutionServices2Unqueued/Constants","DS/SMAMSExecutionServices2Unqueued/Utils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMUtils","DS/JSCMM/SMAJSCMMParameter","DS/JSCMM/SMAJSCMMRule","DS/JSCMM/SMAJSCMMDataHandler","DS/JSCMM/SMAJSCMMDataFlow","DS/JSCMM/SMAJSCMMExtensionConfig","UWA/Utils"],function(i,l,u,n,h,e,g,v,d,f,b,o,c,a,s,j){var p=function(w){return w.replace(v.PARAMETER_NAME_ESCAPE,"_")};var r=function(w){return v.MATCH_FILE.slice(0).replace(/\*/g,w)};var k=function(w){return p(w+" "+v.RESULTS)};var q=function(z){var y=[];for(var w=0;w<z.length;w++){var x=[z[w].name,p(z[w].name)];y.push(x.join("\t"))}y.unshift(y.length);return y.join("\n")};var m=function(y){y=y.split("\n");y.shift();var x=[];for(var w=0;w<y.length;w++){x.push(y[w].split("\t"))}return x};var t=function(y){var x=function(B,D){var E=y.parentProcess.getAllActivities();for(var C=0;C<E.length;C++){if(!E[C].isActivity()){continue}if(E[C].getPhysicalId()===B){return E[C]}}d.createError({key:"Not found in process",process:y.parentProcess.getPhysicalId(),activity:B,onFailure:D})};var A=function(F,E){var B=y.parentProcess.getAllActivities();var D=-1;var C=function(){D++;if(D===B.length){F();return}if(B[D].isActivity()){var H={};H.onSuccess=C;H.onFailure=E;f.updateData(B[D],H)}else{C()}};var G={};G.onSuccess=C;G.onFailure=E;f.updateData(y.parentProcess,G)};var z=function(J,C){var E=y.parentProcess.getActivityByName(v.RESULTS_GENERATION);var F=E.getSteps()[1];var B,I;var G=function(M){var P=F.getExtensionConfig();var U=new j(M.createExtensionConfigData());U.setPropertyValue(v.OUTPUT_OBJECT_PARAM,v.RESULTS);var Q=U.getPropertyByName(v.PLM_BATCH_ARGUMENTS);var S=Q.findPropertyByName(v.UPDATE_SIMULATION_RESULTS);Q.removeProperty(S);var R=Q.findPropertyByName(v.UPDATE_SIMULATION_SEQUENCE);Q.removeProperty(R);U.setPropertyValue(v.PLM_OBJECT,"");var V=Q.findPropertyByName(v.VISU_SPEC_CATALOG);U.setPropertyValue(V,v.SPECIFICATION_CATALOG);var O=Q.findPropertyByName(v.NEW_SIMULATION_RESULTS);U.setPropertyValue(O,B);var N=y.parentProcess.getName();var X=Q.findPropertyByName(v.SIMULATION_TITLE);if(!X){X=Q.findPropertyByName(v.SIMULATION_PREFIX);N+=v.SIMULATION_NAME_SEPARATOR.trim()}U.setPropertyValue(X,N);var T=Q.findPropertyByName(v.SEQUENCE_NAME);if(I){U.setPropertyValue(T,I)}else{U.setPropertyValue(T,F.getName())}P.addPluginConfiguration(U);P.propertiesToJSON();var W={};W.onSuccess=J;W.onFailure=C;f.saveStep(F,W)};var H=function(){var M={};M.onSuccess=G;M.onFailure=C;f.getExtensionDescriptor(v.V6_SIM_IMPORT,M)};var L=function(){var O=F.getExtensionConfig();var Q=O.getPluginConfigurations()[0];var N=Q.getPropertyByName(v.PLM_BATCH_ARGUMENTS);if(i.is(N.findPropertyByName(v.NEW_SIMULATION_RESULTS))){J();return}var P=N.findPropertyByName(v.UPDATE_SIMULATION_RESULTS);B=P.getValue();var M=N.findPropertyByName(v.SEQUENCE_NAME);I=M.getValue();O.removePluginConfiguration(Q);H()};var K=function(){var M={};M.onSuccess=L;M.onFailure=C;f.updateData(y.parentProcess,M)};var D=function(){var M={};M.onSuccess=L;M.onFailure=C;f.updateStep(F,M)};if(i.is(F.getExtensionConfig())){K()}else{D()}};var w=function(C){var B=C.getSteps()[0];switch(B.getExtensionName()){case v.stepConfiguration[v.FMU].extensionType:return v.FMU;case v.stepConfiguration[v.SIMULATION].extensionType:return v.SIMULATION;case v.stepConfiguration[v.TD].extensionType:return v.TD;default:return B.getExtensionName()}};return{setSystem:function(D,F,E){var C=function(){var J={};J.onSuccess=F;J.onFailure=E;var I=y.experimentActivity.findParameterByName(v.SYSTEM);var G=new g({objectId:D});I.setValue(G);var H={};H.activity=y.experimentActivity;H.parameters=[I];f.modifyParametersInPLM([H],J)};var B=function(){var G={};G.onSuccess=C;G.onFailure=E;f.getParametersInPLM(y.experimentActivity,G)};A(B,E)},getSystem:function(C,B){var D={};D.onSuccess=function(){var E={};E.onSuccess=function(){var G=y.experimentActivity.findParameterByName(v.SYSTEM);var F=y.experimentActivity.getSimulationData(G.getValueAsString());C(F.getPhysicalId())};E.onFailure=B;f.getAllSimulationData(y.experimentActivity,E)};D.onFailure=B;f.getParametersInPLM(y.experimentActivity,D)},addBehavior:function(M,G,U){var T={};if(i.is(M.outputs)){T.type=v.FMU}else{if(i.is(M.analysisType)){T.type=v.SIMULATION}else{T.type=v.TD}}var R=function(){var Y={};Y.onSuccess=G;Y.onFailure=U;f.saveTempSimulationData(T.activity,Y)};var X=function(){var Y=T.step.getExtensionConfig();Y.propertiesToJSON();var Z={};Z.onSuccess=R;Z.onFailure=U;f.saveStep(T.step,Z)};var K=function(){var Z=function(){for(var ab=0;ab<M.outputs.length;ab++){var aa=M.outputs[ab];var ac=new o();u.addParameter(ac,T.activity);var ae=p(aa.name);ac.setName(ae);ac.setStructure(b.Structure.Scalar);ac.setMode(b.Mode.Out);ac.setDataType(b.DataType.Real);ac.setValue(0)}var ad={};ad.onSuccess=X;ad.onFailure=U;u.saveParameters(T.activity,ad)};var Y=function(){var ac=T.step.getExtensionConfig();var ae=ac.getPropertyByName(v.APPROX_MODEL_IS_VALID);ac.setPropertyValue(ae,true);var ab=ac.getPropertyByName(v.APPROX_MODEL_TYPE_NAME);ac.setPropertyValue(ab,v.COSIMULATION_FMU);var aa=ac.getPropertyByName(v.APPROX_MODEL_TO_ACTIVITY_PARAM_OUTPUT_MAP);ac.setPropertyValue(aa,q(M.outputs));var ad=ac.getPropertyByName(v.WEB_MONITORING);ac.setPropertyValue(ad,true);var af=ac.getPropertyByName(v.FMU_INSTANCE_NAME);ac.setPropertyValue(af,M.instancePhysicalId);Z()};Y()};var P=function(){var ae=function(){var ap=function(ar){var aA=new j(ar.createExtensionConfigData());var au=aA.getPropertyByName(v.PLM_BATCH_ARGUMENTS);var aB=au.findPropertyByName(v.NEW_SIMULATION_RESULTS);au.removeProperty(aB);var aw=new c(v.DOWNLOAD2);aw.parent=T.resultsActivity;aw.rule.objectParam=v.RESULTS;aw.rule.method=v.EXPORTER;var aE=aw.getRuleXML();aA.setPropertyValue(v.PLM_OBJECT,aE);aA.getPropertyByName(v.PLM_OBJECT).setValueKey(v.CDATA);var ax=au.findPropertyByName(v.UPDATE_SIMULATION_RESULTS);aA.setPropertyValue(ax,v.RUNDIR+M.instancePhysicalId+v.SMA_MANIFEST);var av=au.findPropertyByName(v.UPDATE_SIMULATION_SEQUENCE);aA.setPropertyValue(av,"");var aD=au.findPropertyByName(v.SIMULATION_PREFIX);aA.setPropertyValue(aD,"");var ay=au.findPropertyByName(v.SEQUENCE_NAME);aA.setPropertyValue(ay,T.repReference.getName());var az=au.findPropertyByName(v.VISU_SPEC_CATALOG);aA.setPropertyValue(az,"");aA.setPropertyValue(v.OUTPUT_OBJECT_PARAM,v.RESULTS);var at=T.v6Step.getExtensionConfig();at.setPropertyValue(v.EXECUTION_MODE,1);at.addPluginConfiguration(aA);at.propertiesToJSON();var aC={};aC.onSuccess=function(){z(X,U)};aC.onFailure=U;f.saveStep(T.v6Step,aC)};var aq=function(){var ar={};ar.onSuccess=ap;ar.onFailure=U;f.getExtensionDescriptor(v.V6_SIM_IMPORT,ar)};aq()};var ad=function(){var aw=v.V6_UTILITY;var ar=M.title;var aq=T.resultsActivity;var ap=T.resultsActivity.getSteps();var av=ap[ap.length-2];var au=T.lightweightStep;var at={};at.onSuccess=function(ax){T.v6Step=ax;ae()};at.onFailure=U;f.createStep(aq,av,au,ar,aw,at)};var af=function(){var ar=new c(v.DOWNLOAD2);ar.parent=T.resultsActivity;ar.rule.objectParam=k(M.title);ar.rule.sourceFileName=r(M.instancePhysicalId);var aq=T.downloadResults.getExtensionConfig();var au=aq.getPropertyValue(v.RULES);au=i.Utils.loadXml(au);var at=Number(au.documentElement.getAttribute(v.LAST_ID))+1;au.documentElement.setAttribute(v.LAST_ID,at);ar.rule.id=at;var ap=i.Utils.loadXml(ar.getRuleXML()).documentElement;au.documentElement.appendChild(ap);au=i.Utils.xmlToString(au,false);aq.setPropertyValue(v.RULES,au);aq.getPropertyByName(v.RULES).setValueKey(v.CDATA);aq.propertiesToJSON();var av={};av.onSuccess=ad;av.onFailure=U;f.saveStep(T.downloadResults,av)};var ag=function(){var aq={};aq.onSuccess=af;aq.onFailure=U;var ap=new s();ap.setFromParameter(T.resultsParameterOut);ap.setToParameter(T.resultsParameterIn);ap.setParent(y.experimentActivity);n.addDataflow(ap,y.experimentActivity);n.saveDataflows(y.experimentActivity,aq)};var ak=function(){var ap=new o();T.resultsParameterIn=ap;u.addParameter(ap,T.resultsActivity);ap.setName(k(M.title));ap.setStructure(b.Structure.Scalar);ap.setMode(b.Mode.In);ap.setDataType(b.DataType.PLMObject);var aq={};aq.onSuccess=ag;aq.onFailure=U;u.saveParameters(T.resultsActivity,aq)};var al=function(au){var aq=new j(au.createExtensionConfigData());var at=new c(v.DOWNLOAD2);at.parent=T.resultsActivity;at.rule.objectParam=v.RESULTS;at.rule.method=v.EXPORTER;var ap=at.getRuleXML();aq.setPropertyValue(v.PLM_OBJECT,ap);aq.getPropertyByName(v.PLM_OBJECT).setValueKey(v.CDATA);var ar=T.lightweightStep.getExtensionConfig();ar.setPropertyValue(v.EXECUTION_MODE,1);ar.addPluginConfiguration(aq);ar.propertiesToJSON();var av={};av.onSuccess=ak;av.onFailure=U;f.saveStep(T.lightweightStep,av)};var an=function(){var ap={};ap.onSuccess=al;ap.onFailure=U;f.getExtensionDescriptor(v.V6_RES_GENERATE,ap)};var aj=function(){var av=v.V6_UTILITY;var aq=v.LIGHTWEIGHT_RESULTS;var ap=T.resultsActivity;var au=T.downloadResults;var at=null;var ar={};ar.onSuccess=function(aw){T.lightweightStep=aw;an()};ar.onFailure=U;f.createStep(ap,au,at,aq,av,ar)};var ah=function(){var ap=new o();u.addParameter(ap,T.resultsActivity);ap.setName(v.RESULTS);ap.setStructure(b.Structure.Scalar);ap.setMode(b.Mode.InOut);ap.setDataType(b.DataType.PLMObject);var aq={};aq.onSuccess=aj;aq.onFailure=U;u.saveParameters(T.resultsActivity,aq)};var ao=function(){var aq=T.resultsActivity;var av=null;var au=null;var ar=v.DOWNLOAD;var ap=v.stepConfiguration[v.DOWNLOAD].extensionType;var at={};at.onSuccess=function(aw){T.downloadResults=aw;ah()};at.onFailure=U;f.createStep(aq,av,au,ar,ap,at)};var am=function(){var ap=T.resultsActivity.getExecutionOptions();ap.setPropertyValue(v.OS,v.WINDOWS);var aq={};aq.onSuccess=ao;aq.onFailure=U;f.modifyActivityExecOptions(T.resultsActivity,aq)};var ai=function(){var ap={};ap.onSuccess=am;ap.onFailure=U;f.getActivityExecOptions(T.resultsActivity,ap)};var aa=function(){var ap=y.experimentActivity;var ar=v.RESULTS_GENERATION;var av=y.rightGateway;var au=null;var aq=true;var at={};at.onSuccess=function(aw){T.resultsActivity=aw;ai()};at.onFailure=U;f.createActivity(ap,ar,av,au,aq,at)};var Z=function(){T.resultsActivity=y.parentProcess.getActivityByName(v.RESULTS_GENERATION);if(i.is(T.resultsActivity)){var ar=T.resultsActivity.getSteps();T.downloadResults=ar[0];T.lightweightStep=ar[ar.length-1];var ap=function(){var au={};au.onSuccess=ak;au.onFailure=U;f.updateStep(T.downloadResults,au)};var at=function(){var au={};au.onSuccess=ap;au.onFailure=U;f.updateStep(T.lightweightStep,au)};var aq=function(){var au={};au.onSuccess=function(){T.simParameter=T.resultsActivity.findParameterByName(v.RESULTS);at()};au.onFailure=U;f.getParametersInPLM(T.resultsActivity,au)};aq()}else{aa()}};var ac=function(){var aq=T.step.getExtensionConfig();var at=aq.getPropertyByName(v.JOB_NAME);aq.setPropertyValue(at,M.instancePhysicalId);var ar=new a().createDataHandlerConfig(T.activity,T.specDocument,v.SPEC_FILENAME);var au=aq.getPropertyByName(v.SPEC);aq.setPropertyValue(au,ar);au.setValueKey(v.CDATA);var ap=aq.getPropertyByName(v.CO_SIMULATION);aq.setPropertyValue(ap,true);if(T.type===v.SIMULATION){var av=aq.getPropertyByName(v.FOREMAN_TYPE);aq.setPropertyValue(av,M.analysisType)}if(T.type===v.SIMULATION||M.simResults===true){Z()}else{X()}};var ab=function(){var ap={};ap.onSuccess=ac;ap.onFailure=U;f.saveTempSimulationData(T.activity,ap)};var Y=function(){var aq=d.getInternalData(T.activity);var ap=false;var ar={};ar.onSuccess=function(at){T.specDocument=at;ab()};ar.onFailure=U;f.createOwnedDocument(y.experimentActivity,aq,ap,v.SPEC_FILENAME,ar)};Y()};var C=function(){var Y={};Y.onSuccess=function(){if(T.type===v.FMU){K()}else{P()}};Y.onFailure=U;f.saveStep(T.uploadStep,Y)};var L=function(){var Z=T.uploadStep.getExtensionConfig();var Y=i.Utils.loadXml(v.EMPTY_IMPORT_RULES);Y.documentElement.setAttribute(v.LAST_ID,1);var aa=Y.createElement(v.RULE);aa.setAttribute(v.NAME,v.UPLOAD);aa.setAttribute(v.ID,1);aa.setAttribute(v.ENABLED,true);aa.setAttribute(v.TITLE_SPECIFICATION,v.TITLE_EQUALS_FILENAME);aa.setAttribute(v.PARAMETER_NAME,v.RESULTS);aa.setAttribute(v.IMPORT_DOC_TYPE_C,v.NONVERSIONED_DOCUMENT_TYPE);aa.setAttribute(v.CONTENT_REL_C,v.REFERENCED);aa.setAttribute(v.IMPACT_REL_C,v.NONE);aa.setAttribute(v.SOURCE_FILE_NAME,r(M.instancePhysicalId));aa.setAttribute(v.DOC_DESCRIPTION,"");Y.documentElement.appendChild(aa);var ab=i.Utils.xmlToString(Y,false);Z.setPropertyValue(v.RULES,ab);Z.getPropertyByName(v.RULES).setValueKey(v.CDATA);Z.propertiesToJSON();C()};var S=function(){var Y=new o();T.resultsParameterOut=Y;u.addParameter(Y,T.activity);Y.setName(v.RESULTS);Y.setStructure(b.Structure.Scalar);Y.setMode(b.Mode.InOut);Y.setDataType(b.DataType.PLMObject);var Z={};Z.onSuccess=L;Z.onFailure=U;u.saveParameters(T.activity,Z)};var O=function(){var Z=T.activity;var ad=T.step;var ac=null;var aa=v.UPLOAD;var Y=v.stepConfiguration[v.UPLOAD].extensionType;var ab={};ab.onSuccess=function(ae){T.uploadStep=ae;S()};ab.onFailure=U;f.createStep(Z,ad,ac,aa,Y,ab)};var W=function(){var Y=T.step.getExtensionConfig();var aa=Y.getPropertyByName(v.stepConfiguration[T.type].ruleProperty);aa.setValueKey(v.CDATA);var Z=new c(v.DOWNLOAD2);Z.parent=T.activity;Z.rule.content=T.repReference;Z.rule.sourceFileName=v.SYS_FMU_FMU;Y.setPropertyValue(aa,Z.getRuleXML());O()};var H=function(){var Y=T.step.getExtensionConfig();var Z=Y.getPropertyByName(v.BEHAVIOR_PATH);Y.setPropertyValue(Z,T.pathId);W()};var F=function(){var Y={};Y.onSuccess=H;Y.onFailure=U;f.updateData(T.activity,Y)};var B=function(){var Y={};Y.onSuccess=function(){T.pathId=T.activity.getAllPathObject()[0].getId();F()};Y.onFailure=U;f.addOccurencePath(T.activity,M.instancePhysicalId,null,Y)};var N=function(){var Z=T.activity;var ad=null;var ac=null;var aa=v.stepConfiguration[T.type].title;var Y=v.stepConfiguration[T.type].extensionType;var ab={};ab.onSuccess=function(ae){T.step=ae;B()};ab.onFailure=U;f.createStep(Z,ad,ac,aa,Y,ab)};var E=function(){var Y=d.getInternalData(T.activity);var Z={};Z.onSuccess=function(aa){T.repReference=aa;N()};Z.onFailure=U;f.addReferencedContent(T.activity,Y,M.repPhysicalId,Z)};var J=function(){var Y={};Y.onSuccess=E;Y.onFailure=U;f.getContent(y.experimentActivity,T.activity,Y)};var D=function(){var Y=y.experimentActivity;var ab=T.activity;var aa=y.rightGateway;var Z={};Z.onSuccess=function(){T.activity.setPosition({connected:true});J()};Z.onFailure=U;f.createSeqFlow(Y,ab,aa,Z)};var V=function(){var Y=y.experimentActivity;var ab=y.leftGateway;var aa=T.activity;var Z={};Z.onSuccess=D;Z.onFailure=U;f.createSeqFlow(Y,ab,aa,Z)};var I=function(){T.activity.setFieldValue(v.DESCRIPTION,M.description);var Y={};Y.onSuccess=V;Y.onFailure=U;f.updatePLMObject(T.activity,[v.DESCRIPTION],Y)};var Q=function(){var Y=y.experimentActivity;var aa=M.title;var ad=null;var ac=null;var Z=false;var ab={};ab.onSuccess=function(ae){T.activity=ae;M.activityPhysicalId=ae.getPhysicalId();I()};ab.onFailure=U;f.createActivity(Y,aa,ad,ac,Z,ab)};Q()},removeBehavior:function(F,K,E){if(!h.isRunning()){h.start()}var J=x(F,E);if(!i.is(J)){return}var G=y.parentProcess.getActivityByName(v.RESULTS_GENERATION);var H=function(){var L=function(){var N={};N.success=K;N.failed=E;var M=new l(J);h.add(M,N)};A(L,E)};var B=function(){var L=G.findParameterByName(k(J.getName()));u.deleteParameter(L);var M={};M.onSuccess=function(){z(H,E)};M.onFailure=E;u.saveParameters(G,M)};var D=function(){if(i.is(G)){var L=function(){var P={};P.success=H;P.failed=E;var Q=new l(G);h.add(Q,P)};for(var N=0;N<G.getSteps().length;N++){var O=G.getSteps()[N];if(O.getName()===J.getName()){if(G.getSteps().length===3){A(L,E)}else{var M={};M.onSuccess=B;M.onFailure=E;f.deleteStep(O,M)}return}}}H()};var C=function(){var L=y.experimentActivity.getDataFlows();var N=[];for(var M=0;M<L.length;M++){if(L[M].getFromParameter().getParent()===J||L[M].getToParameter().getParent()===J){N.push(L[M])}}var O={};O.onSuccess=D;O.onFailure=E;f.deleteDataFlowsInPLM(y.experimentActivity,N,O)};var I=function(){var L={};L.onSuccess=C;L.onFailure=E;f.getDataFlowsInPLM(y.experimentActivity,L)};A(I,E)},getBehaviors:function(G,E){var F=y.leftGateway.getOutgoingFlowItems();var B=[];var D=1;var C=function(){if(D===F.length){G(B);return}var M=F[D++];var K=M.getSteps()[0];var J={};B.push(J);J.title=M.getName();J.description=M.getFieldValue(v.DESCRIPTION);J.activityPhysicalId=M.getPhysicalId();var O=function(){J.instancePhysicalId=M.getAllPathObject()[0].getOccPath()[0];var Q=d.getInternalData(M).getContentChildren();for(var P=0;P<Q.length;P++){if(Q[P].getObjectType()===v.REP_REFERENCE_TYPE||Q[P].getObjectType()===v.FMU_REFERENCE_TYPE||Q[P].getObjectType()===v.SIM_REFERENCE_TYPE){J.repPhysicalId=Q[P].getPhysicalId();try{C()}catch(R){E(R)}return}}d.createError({key:"PhysicalId not found",internalData:d.getInternalData(M).getPhysicalId(),onFailure:E})};var H=function(){var P=K.getExtensionConfig();var S=P.getPropertyByName(v.BEHAVIOR_PATH);var Q=P.getPropertyValue(S);var R={};R.onSuccess=O;R.onFailure=E;f.getOccurencePath(M,Q,R)};var N=function(){var P={};P.onSuccess=H;P.onFailure=E;f.updateStep(K,P)};var I=function(){var P={};if(i.is(K.getExtensionConfig())){P.onSuccess=H}else{P.onSuccess=N}P.onFailure=E;f.getContent(M,d.getInternalData(M),P)};var L=function(){var P={};P.onSuccess=I;P.onFailure=E;f.getContent(y.experimentActivity,M,P)};L()};C()},uploadSolverFile:function(G,F,C){var B=function(I){if(I.getContentChildren().length===0){d.createError({key:"No solver file",activity:y.experimentActivity.getPhysicalId(),onFailure:C});return}var H=I.getContentChildren()[0];var J={};J.onSuccess=F;J.onFailure=C;f.uploadFileToDocument(H,G,v.COSIM_CONFIG,J)};var D=function(){var I={};I.onSuccess=B;I.onFailure=C;var H=d.getInternalData(y.cseActivity);f.getContent(y.cseActivity,H,I)};var E=function(){var H={};H.onSuccess=D;H.onFailure=C;f.getContent(y.experimentActivity,y.cseActivity,H)};E()},downloadSolverFile:function(F,B){var E=function(I){if(I.getContentChildren().length===0){d.createError({key:"No solver file",activity:y.experimentActivity.getPhysicalId(),onFailure:B});return}var H=I.getContentChildren()[0];if(H.getFiles().length===0){d.createError({key:"No solver file",activity:y.experimentActivity.getPhysicalId(),onFailure:B});return}var G=H.getFiles()[0];var J={};J.onSuccess=F;J.onFailure=B;f.downloadFileFromDocument(H.getPhysicalId(),G.getName(),null,J)};var C=function(){var H={};H.onSuccess=E;H.onFailure=B;var G=d.getInternalData(y.cseActivity);f.getContent(y.cseActivity,G,H)};var D=function(){var G={};G.onSuccess=C;G.onFailure=B;f.getContent(y.experimentActivity,y.cseActivity,G)};D()},changeBehavior:function(D,E,J,C){var I=x(D,C);if(!i.is(I)){return}var F=I.getName();var B=k(I.getName());var K=function(){var R=y.parentProcess.getActivityByName(v.RESULTS_GENERATION);var M=R.getSteps()[0];var Q=function(){for(var S=0;S<R.getSteps().length;S++){var T=R.getSteps()[S];if(T.getName()===F){T.setName(E.title);var U={};U.onSuccess=J;U.onFailure=C;f.saveStep(T,U);return}}d.createError({key:"Step not found",activity:R.getPhysicalId(),step:F,onFailure:C})};var P=function(){var S=M.getExtensionConfig();var U=S.getPropertyValue(v.RULES);U=i.Utils.loadXml(U);var T=U.querySelector("["+v.PARAMETER_NAME+"='"+B+"']");T.setAttribute(v.PARAMETER_NAME,k(E.title));U=i.Utils.xmlToString(U,false);S.setPropertyValue(v.RULES,U);S.getPropertyByName(v.RULES).setValueKey(v.CDATA);S.propertiesToJSON();var V={};V.onSuccess=Q;V.onFailure=C;f.saveStep(M,V)};var L=function(){var S={};S.onSuccess=P;S.onFailure=C;f.updateStep(M,S)};var O=function(){var U={};U.onSuccess=L;U.onFailure=C;var T=R.findParameterByName(B);if(w(I)===v.TD&&!i.is(T)){J();return}T.setName(k(E.title));var S={};S.activity=R;S.parameters=[T];f.modifyParametersInPLM([S],U)};var N=function(){var S={};S.onSuccess=O;S.onFailure=C;f.getParametersInPLM(R,S)};N()};var H=function(){if(w(I)===v.FMU){J()}else{K()}};var G=function(){I.setFieldValue(v.TITLE,E.title);I.setFieldValue(v.DESCRIPTION,E.description);var L={};L.onSuccess=H;L.onFailure=C;f.updatePLMObject(I,[v.TITLE,v.DESCRIPTION],L)};G()},getProcessInfo:function(){var B={};B.title=y.parentProcess.getName();B.description=y.parentProcess.getFieldValue(v.DESCRIPTION);B.physicalId=y.parentProcess.getPhysicalId();return B},setProcessInfo:function(D,E,C){y.parentProcess.setFieldValue(v.TITLE,D.title);y.parentProcess.setFieldValue(v.DESCRIPTION,D.description);var B=function(){var I=null;var J=y.parentProcess.getActivityByName(v.RESULTS_GENERATION);if(J){I=J.getSteps()[1]}var G=function(){var N=I.getExtensionConfig();var Q=N.getPluginConfigurations()[0];var M=Q.getPropertyByName(v.PLM_BATCH_ARGUMENTS);var P=y.parentProcess.getName();var L=M.findPropertyByName(v.SIMULATION_TITLE);if(!L){L=M.findPropertyByName(v.SIMULATION_PREFIX);P+=v.SIMULATION_NAME_SEPARATOR.trim()}Q.setPropertyValue(L,P);N.propertiesToJSON();var O={};O.onSuccess=E;O.onFailure=C;f.saveStep(I,O)};var K=function(){var L={};L.onSuccess=G;L.onFailure=C;f.updateStep(I,L)};var H=function(){var L={};L.onSuccess=K;L.onFailure=C;f.updateData(J,L)};if(I){H()}else{E()}};var F=function(){var H={};H.onSuccess=B;H.onFailure=C;var G=y.parentProcess;f.openProcess(y.parentProcess.getPhysicalId(),{onSuccess:function(I){G._data.cestamp=I._data.cestamp;I=G;f.updatePLMObject(I,[v.TITLE,v.DESCRIPTION],H)},onFailure:function(){}})};F()},uploadSpec:function(E,J,H,D){var G=x(E,D);if(!i.is(G)){return}var I=w(G);if(I!==v.SIMULATION&&I!==v.TD){d.createError({key:"Not a simulation behavior or 3dfmu behavior",behavior:E,onFailure:D});return}var F=function(K){var N={};N.onSuccess=H;N.onFailure=D;var M=K.getContentChildren();for(var L=0;L<M.length;L++){if(M[L].getObjectType()===v.NONVERSIONED_DOCUMENT_TYPE){f.uploadFileToDocument(M[L],new Blob([J]),v.SPEC_FILENAME,N);return}}};var C=function(K){G=K;var L={};L.onSuccess=F;L.onFailure=D;f.getContent(G,d.getInternalData(G),L)};var B=function(){var K={};K.onSuccess=C;K.onFailure=D;f.getContent(y.experimentActivity,G,K)};B()},downloadSpec:function(B,I,E){var C=x(B,E);if(!i.is(C)){return}var D=w(C);if(D!==v.SIMULATION&&D!==v.TD){d.createError({key:"Not a simulation behavior or 3dfmu behavior",behavior:B,onFailure:E});return}var H=function(L){if(L.getContentChildren().length===0){d.createError({key:"No spec file",activity:C.getPhysicalId(),onFailure:E});return}var K=L.getContentChildren()[1];if(K.getFiles().length===0){d.createError({key:"No spec file",activity:C.getPhysicalId(),onFailure:E});return}var J=K.getFiles()[0];var M={};M.onSuccess=I;M.onFailure=E;f.downloadFileFromDocument(K.getPhysicalId(),J.getName(),null,M)};var F=function(J){C=J;var K={};K.onSuccess=H;K.onFailure=E;f.getContent(C,d.getInternalData(C),K)};var G=function(){var J={};J.onSuccess=F;J.onFailure=E;f.getContent(y.experimentActivity,C,J)};G()},setLinkInteractionConfiguration:function(E,J,I,D){var H=x(E,D);if(!i.is(H)){return}var K=w(H);if(v.SIMULATION!==K&&v.TD!==K){d.createError({key:"Not a simulation behavior or 3dfmu behavior",behavior:E,onFailure:D});return}var G=H.getSteps()[0];var B=function(){var L={};L.onSuccess=I;L.onFailure=D;f.saveStep(G,L)};var C=function(){var L=G.getExtensionConfig();var M=L.getPropertyByName(v.INTERACTION);L.setPropertyValue(M,JSON.stringify(J));L.propertiesToJSON();B()};var F=function(){var L={};L.onSuccess=C;L.onFailure=D;f.updateStep(G,L)};A(F,D)},getLinkInteractionConfiguration:function(B,G,E){var C=x(B,E);if(!i.is(C)){return}var F=C.getSteps()[0];var I=function(){var K=F.getExtensionConfig();var M=K.getPropertyByName(v.INTERACTION);var N=K.getPropertyValue(M);try{var L=(i.is(N)&&N!=="")?JSON.parse(N):{};G(L)}catch(J){E(J)}};var D=function(){var J={};J.onSuccess=I;J.onFailure=E;f.updateData(y.parentProcess,J)};var H=function(){var J={};J.onSuccess=I;J.onFailure=E;f.updateStep(F,J)};if(i.is(F.getExtensionConfig())){D()}else{H()}},updateBehaviorParameters:function(I,B,H,E){var D=x(B,E);if(!i.is(D)){return}if(v.FMU!==w(D)){d.createError({key:"Not an fmu behavior",behavior:B,onFailure:E});return}var F=D.getSteps()[0];var G=function(){var K,J;for(J=0;J<I.create.length;J++){K=new o();u.addParameter(K,D);var M=p(I.create[J].name);K.setName(M);K.setStructure(b.Structure.Scalar);K.setMode(b.Mode.In);K.setDataType(b.DataType.Real);if(i.is(I.create[J].startValue)){K.setValue(Number(I.create[J].startValue))}else{K.setValue(0)}}for(J=0;J<I.update.length;J++){K=D.findParameterByName(p(I.update[J].name));if(i.is(I.update[J].startValue)){K.setValue(Number(I.update[J].startValue))}else{K.setValue(0)}u.modifyParameter(K)}for(J=0;J<I.remove.length;J++){K=D.findParameterByName(p(I.remove[J].name));u.deleteParameter(K)}var L={};L.onSuccess=H;L.onFailure=E;u.saveParameters(D,L)};var C=function(){var L=F.getExtensionConfig();var J=L.getPropertyByName(v.APPROX_MODEL_TO_ACTIVITY_PARAM_INPUT_MAP);var N=L.getPropertyValue(J);N=N.split("\n");var Q=Number(N.shift())+I.create.length-I.remove.length;N.unshift(Q);var P,M;for(M=0;M<I.create.length;M++){P=I.create[M].name;P+="\t";P+=p(I.create[M].name);N.push(P)}for(M=0;M<I.remove.length;M++){P=I.remove[M].name;P+="\t";P+=p(I.remove[M].name);var K=N.indexOf(P);if(K===-1){d.createError({key:"Parameter not found",parameter:I.remove[M].name,behavior:B,onFailure:E});return}N.splice(K,1)}L.setPropertyValue(J,N.join("\n"));L.propertiesToJSON();var O={};O.onSuccess=G;O.onFailure=E;f.saveStep(F,O)};A(C,E)},getBehaviorParameters:function(D,K,C){var J=x(D,C);if(!i.is(J)){return}if(v.FMU!==w(J)){K([]);return}var F=J.getSteps()[0];var G=F.getExtensionConfig();var E=G.getPropertyByName(v.APPROX_MODEL_TO_ACTIVITY_PARAM_INPUT_MAP);var H=m(E.getValue());var B=function(){var O=[];var N=J.getParameters();for(var M=0;M<N.length;M++){if(N[M].getMode()!==b.Mode.In){continue}var P={};O.push(P);for(var L=0;L<H.length;L++){if(N[M].getName()===H[L][1]){P.name=H[L][0];break}}P.startValue=N[M].getValue()}K(O)};var I=function(){var L={};L.onSuccess=B;L.onFailure=C;f.getParametersInPLM(J,L)};I()},setSolverParameters:function(B,E,C){var D=y.cseActivity.getSteps()[0];var H=function(){var I={};I.onSuccess=E;I.onFailure=C;f.saveStep(D,I)};var G=function(){var K=D.getExtensionConfig();var I=K.getPropertyByName(v.EXPERIMENT_PARAMS);for(var M in B){if(B.hasOwnProperty(M)){var L=I.findPropertyByName(M);var J;if(B[M]!==null&&B[M]!==undefined){if(isNaN(B[M])===false&&B[M]!==""&&B[M]!==true&&B[M]!==false){J=Number(B[M])}else{J=B[M]}K.setPropertyValue(L,J)}}}K.propertiesToJSON();H()};var F=function(){var I={};I.onSuccess=G;I.onFailure=C;f.updateStep(D,I)};A(F,C)},getSolverParameters:function(D,B){var C=y.cseActivity.getSteps()[0];var F=function(){var K={};var H=C.getExtensionConfig();var G=H.getPropertyByName(v.EXPERIMENT_PARAMS);var J=G.getProperties();for(var I=0;I<J.length;I++){K[J[I].getName()]=J[I].getValue()}D(K)};var E=function(){var G={};G.onSuccess=F;G.onFailure=B;f.updateStep(C,G)};A(E,B)},setCloudProperty:function(D,E,B){var C=y.cseActivity.getSteps()[0];var H=function(){var I={};I.onSuccess=E;I.onFailure=B;f.saveStep(C,I)};var G=function(){var I=C.getExtensionConfig();var J=I.getPropertyByName(v.CLOUD_PARAMS);I.setPropertyValue(J,D);I.propertiesToJSON();H()};var F=function(){var I={};I.onSuccess=G;I.onFailure=B;f.updateStep(C,I)};A(F,B)},getSimulationConfiguration:function(B,F,D){var C=x(B,D);if(!i.is(C)){return}if(w(C)!==v.SIMULATION){d.createError({key:"Not a simulation behavior",behavior:B,onFailure:D});return}var E=C.getSteps()[0];var H=function(){var J=E.getExtensionConfig();var L={};var K=J.getPropertyByName(v.CPUS);L.cpus=J.getPropertyValue(K);var I=J.getPropertyByName(v.DOUBLE_PRECISION);L.doublePrecision=J.getPropertyValue(I);F(L)};var G=function(){var I={};I.onSuccess=H;I.onFailure=D;f.updateStep(E,I)};A(G,D)},setCloudParamsForResultsActivity:function(E,F,C){var D=y.parentProcess.getActivityByName(v.RESULTS_GENERATION);if(!i.is(D)){F();return}var B=function(){var G={};G.onSuccess=function(){var I=function(){for(var K in E){if(E.hasOwnProperty(K)){var L=D.findParameterByName(K);if(!i.is(L)){J();return}else{H();return}}}};var H=function(){var K=[];for(var L in E){if(E.hasOwnProperty(L)){var O=D.findParameterByName(L);O.setValue(E[L]);K.push(O)}}var M={};M.activity=D;M.parameters=K;var N={};N.onSuccess=F;N.onFailure=C;f.modifyParametersInPLM([M],N)};var J=function(){for(var K in E){if(E.hasOwnProperty(K)){var L=new o();u.addParameter(L,D);L.setName(K);L.setStructure(b.Structure.Scalar);L.setMode(b.Mode.Out);L.setDataType(b.DataType.String);L.setValue(E[K])}}var M={};M.onSuccess=F;M.onFailure=C;u.saveParameters(D,M)};A(I,C)};G.onFailure=C;f.getParametersInPLM(D,G)};B()},setApplicationInfo:function(B,G,H,F){var C=x(B,F);if(!i.is(C)){return}var E=function(){var I=C.getExecutionOptions();I.setPropertyValue(v.APPLICATION_NAME,G.name);I.setPropertyValue(v.APPLICATION_VERSION,G.version);var J={};J.onSuccess=H;J.onFailure=F;f.modifyActivityExecOptions(C,J)};var D=function(){var I={};I.onSuccess=E;I.onFailure=F;f.getActivityExecOptions(C,I)};D()},setSimulationConfiguration:function(D,H,J,C){var I=x(D,C);if(!i.is(I)){return}var F=I.getSteps()[0];var B=function(){var K={};K.onSuccess=J;K.onFailure=C;f.saveStep(F,K)};var G=function(){var M=F.getExtensionConfig();var N=M.getPropertyByName(v.CPUS);M.setPropertyValue(N,Number(H.cpus));var L=M.getPropertyByName(v.DOUBLE_PRECISION);var K=(H.doublePrecision==="true"||H.doublePrecision===true||H.doublePrecision===undefined);M.setPropertyValue(L,K);M.propertiesToJSON();B()};var E=function(){var K={};K.onSuccess=G;K.onFailure=C;f.updateStep(F,K)};A(E,C)}}};return t});
/*! Copyright 2015 Dassault Systemes */
define("DS/SMAMSExecutionServices2Unqueued/SMAMSExecutionServices2Unqueued",["UWA/Core","DS/SMAProcWebAsyncUtils/Activity/Delete","DS/SMAProcWebCMMUtils/SMAJSCMMParameterUtils","DS/SMAProcWebAsyncUtils/SMAProcWebTransactionManager","DS/JSCMM/SMAJSCMMLayout","DS/SMAMSExperimentServicesUnqueued/DocumentUnqueued","DS/SMAMSExecutionServices2Unqueued/Constants","DS/SMAMSExecutionServices2Unqueued/ExperimentUnqueued","DS/SMAMSExecutionServices2Unqueued/Utils","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMUtils","DS/JSCMM/SMAJSCMMParameter","DS/JSCMM/SMAJSCMMRule","DS/JSCMM/SMAJSCMMDataHandler","UWA/Utils"],function(d,i,n,k,l,b,o,h,g,m,a,f,e,j){var c={};c.create=function(r,y,s){var u={};var E=function(){var F=u.experimentActivity;var H=o.RIGHT;var K=u.cseActivity;var J=null;var G=true;var I={};I.onSuccess=function(L){u.rightGateway=L;y(new h(u))};I.onFailure=s;m.createGateway(F,H,K,J,G,I)};var A=function(){var F={};F.onSuccess=E;F.onFailure=s;m.saveTempSimulationData(u.cseActivity,F)};var w=function(G){var J=u.cseActivity.getSteps()[0];var H=J.getExtensionConfig();var K=H.getPropertyByName(o.CSE_FILE_NAME);H.setPropertyValue(K,o.COSIM_CONFIG);K=H.getPropertyByName(o.WEB_MONITORING);H.setPropertyValue(K,true);K=H.getPropertyByName(o.INPUT_SOURCE_FILE);K.setValueKey(o.CDATA);var F=new j();var I=F.createDataHandlerConfig(u.cseActivity,G,o.COSIM_CONFIG);H.setPropertyValue(K,I);H.propertiesToJSON();var L={};L.onSuccess=A;L.onFailure=s;m.saveStep(J,L)};var z=function(){var G=g.getInternalData(u.cseActivity);var F=false;var H={};H.onSuccess=w;H.onFailure=s;m.createOwnedDocument(u.experimentActivity,G,F,o.COSIM_CONFIG,H)};var p=function(){var F={};F.onSuccess=z;F.onFailure=s;m.getContent(u.experimentActivity,u.cseActivity,F)};var v=function(){var F=u.cseActivity;var K=null;var J=null;var H=o.CSE_DIRECTOR;var G=o.stepConfiguration[o.CSE_DIRECTOR].extensionType;var I={};I.onSuccess=p;I.onFailure=s;m.createStep(F,K,J,H,G,I)};var C=function(){var F=u.experimentActivity;var H=o.CSE_DIRECTOR;var K=u.leftGateway;var J=null;var G=true;var I={};I.onSuccess=function(L){u.cseActivity=L;v()};I.onFailure=s;m.createActivity(F,H,K,J,G,I)};var q=function(){var F=u.experimentActivity;var H=o.LEFT;var K=null;var J=null;var G=true;var I={};I.onSuccess=function(L){u.leftGateway=L;C()};I.onFailure=s;m.createGateway(F,H,K,J,G,I)};var t=function(){var F=new f();n.addParameter(F,u.experimentActivity);F.setName(o.SYSTEM);F.setMode(a.Mode.InOut);F.setStructure(a.Structure.Scalar);F.setDataType(a.DataType.PLMObject);var G={};G.onSuccess=q;G.onFailure=s;n.saveParameters(u.experimentActivity,G)};var x=function(){var F=u.parentProcess;var H=o.EXPERIMENT;var K=null;var J=null;var G=true;var I={};I.onSuccess=function(L){u.experimentActivity=L;t()};I.onFailure=s;m.createActivity(F,H,K,J,G,I)};var D=function(){u.parentProcess.setFieldValue(o.DESCRIPTION,r.description);var F={};F.onSuccess=x;F.onFailure=s;m.updatePLMObject(u.parentProcess,[o.DESCRIPTION],F)};var B=function(){var F={};F.simulationKind=o.EXPERIMENT;F.onSuccess=function(G){u.parentProcess=G;m.currentProcess=G;D()};F.onFailure=s;m.createProcess(r.title,F)};B()};c.load=function(p,r,q){var s={};s.onSuccess=function(u){var w=function(y){var x=u.getActivityByName(y);if(!d.is(x)){g.createError({key:"Not found in process",process:p,activity:y})}return x};var t={};try{t.experimentActivity=w(o.EXPERIMENT);t.leftGateway=w(o.LEFT);t.cseActivity=w(o.CSE_DIRECTOR);t.rightGateway=w(o.RIGHT)}catch(v){q(v);return}t.parentProcess=u;new l(u).runLayout();m.currentProcess=u;r(new h(t))};s.onFailure=q;m.openProcess(p,s)};return c});
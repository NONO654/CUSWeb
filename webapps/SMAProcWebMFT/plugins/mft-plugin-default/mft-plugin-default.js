require(["DS/SMAProcWebCommonControls/Polymer","DS/SMAProcWebCommonControls/utils","DS/SMAProcWebMFT/plugins/mft-plugin/mft-plugin","DS/SMAProcSP/sp-base/sp-base"],function(d,a,c,b){d({is:"mft-plugin-default",behaviors:[b,c],properties:{},ready:function(){},getPluginName:function(){return"com.dassault_systemes.sma.plugin.mft.Gloabalscape"},getRemoteProcesses:function(g,h,j){var f=this;var e={className:"com.dassault_systemes.smaexe.adapter.mft.rest.DefaultEditorServiceInterface",url:g,username:h,password:j,rootName:"/orchestrate",libraryFileName:"library.json"};var i={verb:"POST",uri:this.$.mftMcsDashboard.getMcsUri()+"/resources/slmservices/adapter/mft/editor/getRemoteProcesses",data:"data="+JSON.stringify(e),headers:{"Content-Type":"application/x-www-form-urlencoded"},onComplete:function(k){f._mftGetRemoteProcessesSuccess(k)},onError:function(k,m,l){f._mftGetRemoteProcessesError(k,m,l)}};this.$.mftMcsService.sendRequest(i)},_mftGetRemoteProcessesSuccess:function(e){this.setRemoteProcessesSuccess(JSON.parse(e.response))},_mftGetRemoteProcessesError:function(e,g,f){this.getProcessChooserElement().setRemoteProcessesError();if(e){console.log(e.status+": "+e.response);this.showMessage(e.response)}else{this.showMessage("Error getting remote processes, see log for details")}},_mftGetRemoteProcessesProxy:function(){var e=this;$.ajax({url:"https://vdevpril669am.ux.dsone.3ds.com:456/EFTClient/Account/Login.htm",type:"GET",beforeSend:function(f){},dataType:"html",success:function(g,h,f){e._mftGetRemoteProcessesProxySuccess(g,h,f)},error:function(f,h,g){e._mftGetRemoteProcessesProxyError(f,h,g)}})},_mftGetRemoteProcessesProxySuccess:function(e,g,f){console.log(g);console.log(f.getAllResponseHeaders())},_mftGetRemoteProcessesProxyError:function(e,g,f){},runRemoteProcessValidation:function(h,i,k,g){var f=this;this.validationStarted();this.setMftUrl(h);this.setMftUsername(i);this.setMftPassword(k);var e={className:"com.dassault_systemes.smaexe.adapter.mft.rest.DefaultEditorServiceInterface",url:f.getMftUrl(),username:f.getMftUsername(),password:f.getMftPassword(),rootName:"/orchestrate",processId:g};var j={verb:"POST",uri:this.$.mftMcsDashboard.getMcsUri()+"/resources/slmservices/adapter/mft/editor/runRemoteProcessValidation",data:"data="+JSON.stringify(e),headers:{"Content-Type":"application/x-www-form-urlencoded"},onComplete:function(l){f._mftRunRemoteProcessValidationSuccess(l)},onError:function(l,n,m){f._mftRunRemoteProcessValidationError(l,n,m)}};this.$.mftMcsService.sendRequest(j)},_mftRunRemoteProcessValidationSuccess:function(f){var e=JSON.parse(f.response);this.checkRemoteProcessValidation(this.getMftUrl(),this.getMftUsername(),this.getMftPassword(),e.processPath,e.workitemId)},_mftRunRemoteProcessValidationError:function(e,g,f){this.addValidationLogMessage("There was an error validating the remote process.");this.validationComplete()},checkRemoteProcessValidation:function(g,h,k,j,l){var f=this;this.setMftUrl(g);this.setMftUsername(h);this.setMftPassword(k);var e={className:"com.dassault_systemes.smaexe.adapter.mft.rest.DefaultEditorServiceInterface",url:f.getMftUrl(),username:f.getMftUsername(),password:f.getMftPassword(),processPath:j,workitemId:l};var i={verb:"POST",uri:this.$.mftMcsDashboard.getMcsUri()+"/resources/slmservices/adapter/mft/editor/checkRemoteProcessValidation",data:"data="+JSON.stringify(e),headers:{"Content-Type":"application/x-www-form-urlencoded"},onComplete:function(m){f._mftCheckRemoteProcessValidationSuccess(m)},onError:function(m,o,n){f._mftCheckRemoteProcessValidationError(m,o,n)}};this.$.mftMcsService.sendRequest(i)},_mftCheckRemoteProcessValidationSuccess:function(g){var e=JSON.parse(g.response);var f=this;if(e.status&&e.status=="running"&&!this.validationCancelled){this.addValidationLogMessage("The remote process validation is still in progress for '"+e.processPath+e.workitemId+"', waiting...");setTimeout(function(){f.checkRemoteProcessValidation(f.getMftUrl(),f.getMftUsername(),f.getMftPassword(),e.processPath,e.workitemId)},10000)}else{if(this.validationCancelled){this.addValidationLogMessage("The remote process validation was aborted.");this.validationComplete()}else{if(e.statusCode&&e.statusCode.trim()=="0"){this.addValidationLogMessage("The remote process was successfully validated.");if(e.statusMessage){this.addValidationLogMessage("Success message: "+e.statusMessage)}}else{this.addValidationLogMessage("The remote process is invalid.");if(e.statusMessage){this.addValidationLogMessage("Failure message: "+e.statusMessage)}}this.validationComplete()}}},_mftCheckRemoteProcessValidationError:function(e,g,f){this.addValidationLogMessage("There was an error validating the remote process.");this.validationComplete()}})});
define(["UWA/Core","UWA/Promise","DS/SMAPoweredByHandler/ADAbstractHandler","DS/SMAPoweredByHandler/abaqus/AbaqusActivityUtils","DS/SMAPoweredByHandler/activity/ActivityUtils","DS/SMAPoweredByHandler/abaqus/CreateWizardFacets","DS/SMAPoweredByHandler/abaqus/JobTile","DS/SMAPoweredByHandler/abaqus/JobFacets","DS/SMAPoweredByHandler/common/Actions","text!DS/SMAPoweredByHandler/assets/config/abaqus/custom.json","DS/SMAPoweredByHandler/abaqus/selectors","DS/SMAPoweredByHandler/abaqus/rules","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAPoweredByState/ad-state-domain-job-types/selectors","DS/SMAPoweredByState/ad-state-domain-connector-definitions/selectors","DS/SMAPoweredByState/ad-state-domain-managed-data/selectors","DS/SMAPoweredByState/ad-state-domain-jobs/actions"],function(g,f,n,e,q,d,x,b,j,a,m,u,t,p,y,k,s){var w={};var i=JSON.parse(a);var c=window.Promise||f;function v(A,z){return A.name===z.name}function l(B,D,z){if(z){for(var C=0;C<B.length;C++){var E=t.jobArguments(D,z).filter(v.bind(null,B[C]));if(E.length===1){var A=E[0];if(A.value){B[C].value=A.value}if(A.optionType==="Standalone"){B[C].active=A.active}B[C].displayed=true}}}}function r(D,B){var A,z;for(var C=0;C<D.Choices.length;C++){A=y.connectorOption(B,D.Choices[C]);if(typeof D.optionType==="string"){z=D.optionType}else{z=D.optionType[C]}if(A){if(((z==="Option-Value")&&A.value)||((z==="Standalone")&&A.active)){D.value=D.Choices[C];D.displayed=true}if(C!==0){B.options.splice(B.options.indexOf(A),1)}}}}function o(A,z){var B=null;if(A.name==="job"){B=-1}else{if(z.name==="job"){B=1}else{B=A.name<z.name?-1:1}}return B}function h(z,A){var B;B=y.connectorOption(A,z.name);if(!B&&z.Choices){B=y.connectorOption(A,z.value||z.defaultValues);if(B.optionType==="Standalone"){B.active=true}}else{if(!B){B=z}else{if(z.value){B.value=z.value.toString()}else{if(z.optionType==="Standalone"){B.active=z.active}else{if(z.defaultValues){B.value=z.defaultValues}else{if(z.Choices&&(Array.isArray(z.Choices))&&z.Choices.length>0){B.value=z.Choices[0]}}}}}}return B}w.init=function(z){this._parent(z);this.setEnvironmentVariablesState=e.setEnvironmentVariablesState.bind(e);this.setExecutionOptionsPLM=e.setExecutionOptionsPLM.bind(e);this.setExecutionOptionsState=e.setExecutionOptionsState.bind(e);this.setEnvironmentVariablesPLM=e.setEnvironmentVariablesPLM.bind(e);this.setResultsOptionsState=e.setResultsOptionsState.bind(e);if(z){this.boundActionsJob=this.stateRedux.getBoundActions(s,this.store.dispatch)}};w.createJobFromPLMActivity=function(C){var B=this._parent(C);this.setResultsOptionsState(C,B);if(B.configuration.arguments){var A,z=null,D;for(A=0;A<B.configuration.arguments.length;A++){if(B.configuration.arguments[A].name==="input"){z=B.configuration.arguments[A].value;break}}if(z){for(A=0;A<B.inputs.length;A++){D=k.managedDataWithID(this.store.getState(),B.inputs[A]);if(D&&(D.name===z)){B.mainInputFile=B.inputs[A];break}}}}return B};w.boundActionsJob=null;w.getArgs=function(z){var C,A,B,D=t.getApplication(this.store.getState(),z);return new c(function(F,E){this.stateRedux.waitFor({store:this.store,select:y.connectorDefinitionsPersistenceOperation,isResolved:function(G){return((G===null)&&(y.connectorDefinitionForApp(this.store.getState(),D.appName,D.appVersion)!==null))}.bind(this)}).then(function(){A=g.clone(y.connectorDefinitionForApp(this.store.getState(),D.appName,D.appVersion));l(A.options,this.store.getState(),z);i=JSON.parse(a);for(var G=0;G<i.length;G++){C=i[G];B=y.connectorOption(A,C.name);if(B!==null){C=g.merge(C,B)}else{if(C.Choices){B=y.connectorOption(A,C.Choices[0]);C=g.merge(C,B);r(C,A)}else{}}if(B){A.options[A.options.indexOf(B)]=C}}A.options.sort(o);this.setArgs(A.options,z);F(A.options)}.bind(this),E)}.bind(this))};w.setArgs=function(G,C){var E,I,F,z,B,A=t.getApplication(this.store.getState(),C);if(A){E=g.clone(y.connectorDefinitionForApp(this.store.getState(),A.appName,A.appVersion));z=[];B=false;for(var D=0;D<G.length;D++){I=G[D];if(I.displayed){F=h(I,E);z.push(F);if(F.optionType==="Option-Value"||F.optionType==="Standalone-Value"){B=B||(t.jobArgumentValue(this.store.getState(),C,I.name)!==F.value)}else{var H=t.jobArguments(this.store.getState(),C).filter(v.bind(null,F));B=B||(H.length!==1)||(H[0].active!==F.active)}}else{if(typeof(I.displayed)!=="undefined"&&!I.displayed){this.boundActionsJob.removeJobArgument(C,I.name)}}}if(B){this.boundActionsJob.setJobArguments(C,z)}return z}else{return false}};w.addJobId=function(z){this._parent(z);u.setStore(this.store);u.startListening(z)};w.unsubscribeAll=function(){this._parent();u.unsubscribeAll()};w.outputJobTypeTitle="Import Simulation Results";w.jobFacets=b;w.wizardFacets=d;w.jobTile=x;w.actions=[j.viewDetails,j.cloneJob,j.divider,j.previewResults,j.abortJob,j.divider,j.deleteJob];w.Selectors=m;w.Rules=u;w.hasPredefinedApp=function(){return true};return n.extend(w)});
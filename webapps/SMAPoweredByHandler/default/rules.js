/*!  Copyright 2017 Dassault Systemes. All rights reserved. */
define(["DS/SMAPoweredByState/ad-state-redux-observer","DS/SMAPoweredByHandler/common/selectors","DS/SMAPoweredByState/ad-state-domain-jobs/actions","DS/SMAPoweredByState/ad-state-domain-jobs/selectors"],function(b,e,d,c){var a={store:null,jobIds:[],stateRedux:new b()};a.startListening=function(f){if(this.jobIds.indexOf(f)===-1){this.jobIds.push(f);var g=this.stateRedux.getBoundActions(d,this.store.dispatch);this.stateRedux.observeStore({store:this.store,select:e.isCloudEnabled,onChange:function(h){if(!h){var i=c.jobExecutionOptions(this.store.getState(),f);if(i&&i.drmMode==="Cloud"){g.setJobExecutionDRMMode(f,"fiper")}}}})}};a.setStore=function(f){this.store=f;this.jobIds=[]};a.unsubscribeAll=function(){this.stateRedux.unsubscribeAll()};return a});
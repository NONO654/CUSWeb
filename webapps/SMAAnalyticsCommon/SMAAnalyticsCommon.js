require(["UWA/Core","UWA/Class/Promise","DS/SMAAnalyticsCommon/SMAAnalyticsCase","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsCaseDialog","DS/SMAAnalyticsCommon/SMAAnalyticsCaseCollection"],function(d,f,a,i,h,c,j){var g=null,b=function(){var k={immersiveFrame:i.getImmersiveFrame(),header:h.get("CREATE_CASE"),okButtonLabel:h.get("CREATE_CASE_BUTTON")};return new f(function(m,l){c.showDialog(k).then(function(o,n){m(o,n)})})},e=function(o){var n=this;if(d.is(o)&&o.length>0){var m=false;if(o[0].objectType==="Analytics Case"){m=true}if(m){var k={};k[o[0].objectId]=[];n.fire("onDataUploadCompleteEvent",i.formatResponse(k,o))}else{if(this.objectId){var l=false;if(d.is(o[0].size)){l=true;i.mask(h.get("UPLOAD_DS"))}else{i.mask(h.get("CONNECT_DS"))}a.connect(o,l).then(function(p){i.unmask();n.fire("onDataUploadCompleteEvent",i.formatResponse(p,o));i.showSuccessNotification("",h.get("CONNECT_DS_SUCCESS"))},function(p){i.unmask();if(p==="NO_MESSAGE"){}else{if(p==="DUPLICATE"){i.showErrorNotification("",h.get("CONNECT_DS_FAIL_DUP"))}else{i.showErrorNotification("",h.get("CONNECT_DS_FAIL"))}}})}else{a.initialize();b().then(function(p){i.mask(h.get("CREATING_CASE"));a.create(p).then(function(q){widget.setValue("collabspaces",widget.getValue("createcollabspaces"));var r=false;if(d.is(o[0].size)){r=true}a.connect(o,r).then(function(s){i.unmask();i.showSuccessNotification("",h.get("CREATE_CASE_SUCCESS"));n.fire("onDataUploadCompleteEvent",i.formatResponse(s,o))},function(s){i.unmask();i.showWarningNotification("",h.get("CONNECT_DS_FAIL"))}.bind(n))},function(q){i.unmask();i.showErrorNotification("",h.get("CREATE_CASE_FAILED"))}.bind(n))}.bind(n),o)}}}};Polymer({is:"ra-input-dropbox",ready:function(){g=this},properties:{fileTypes:{type:String},plmTypes:{type:String},objectId:{type:String,value:""},raTitle:{type:Object},isExportReq:{type:Boolean},hideUpload:{type:Boolean,observer:"_setHideUpload"},showFullScreen:{type:Boolean,observer:"_setFullScreen"},isRA:{type:Boolean,observer:"_setUpload"},flushOnComplete:{type:Boolean,value:false}},onLocalFileClick:function(k){k.stopPropagation();k.cancelBubble=true;this.$.localFileChooser.click()},onLocalFileSelect:function(k){k.stopPropagation();k.cancelBubble=true;var l=i.validateObjects(k,this.plmTypes,this.fileTypes,"upload");e.call(this,l);this.$.localFileChooser.value=null},onInputFileDragOver:function(k){k.stopPropagation();k.cancelBubble=true;k.preventDefault();if(this.showFullScreen){this.DOM(this.$.fullDropZone).addClass("drag-over")}else{if(this.hideUpload){this.DOM(this.$.inputReqDec).addClass("drag-over")}else{this.DOM(this.$.inputDataset).addClass("drag-over")}}},onInputFileDragLeave:function(k){k.stopPropagation();k.cancelBubble=true;k.preventDefault();if(this.showFullScreen){this.DOM(this.$.fullDropZone).removeClass("drag-over")}else{if(this.hideUpload){this.DOM(this.$.inputReqDec).removeClass("drag-over")}else{this.DOM(this.$.inputDataset).removeClass("drag-over")}}},onInputFileDrop:function(k){k.stopPropagation();k.cancelBubble=true;k.preventDefault();var l=i.validateObjects(k,this.plmTypes,this.fileTypes,"drop");e.call(this,l);if(this.showFullScreen){this.DOM(this.$.fullDropZone).removeClass("drag-over")}else{if(this.hideUpload){this.DOM(this.$.inputReqDec).removeClass("drag-over")}else{this.DOM(this.$.inputDataset).removeClass("drag-over")}}},onSearch:function(){if(i.isTransientWidget()){return}this.spSearch=i.getSPSearch(this.onChange,true);this.spSearch.plmTypes=this.plmTypes;this.spSearch.search()},onChange:function(k){k.stopPropagation();k.cancelBubble=true;k.preventDefault();g.spSearch.removeEventListener("change",g.onChange);var l=i.validateObjects(k.detail.getSelectedObjects(),g.plmTypes,g.fileTypes,"search");e.call(g,l)},onSpError:function(){var k=h.get("TRANSIENT_MODE_WARNING");i.showWarningNotification("",k)},_setHideUpload:function(k){if(k){this.DOM(this.$.inputDataset).addClass("input-hidden");this.DOM(this.$.inputReqDec).removeClass("input-hidden")}else{this.DOM(this.$.inputReqDec).addClass("input-hidden");this.DOM(this.$.inputDataset).removeClass("input-hidden")}},_setFullScreen:function(k){if(k){this.DOM(this.$.inputDataset).addClass("input-hidden");this.DOM(this.$.dropZoneFullScreen).removeClass("input-hidden")}else{this.DOM(this.$.inputDataset).removeClass("input-hidden");this.DOM(this.$.dropZoneFullScreen).addClass("input-hidden")}},_setUpload:function(k){if(k){this.DOM(this.$.uploadIcon).removeClass("input-hidden")}},_flushDbxOnComplete:function(k){},behaviors:[window.DS.SMAProcSP.SPBase]})});define("DS/SMAAnalyticsCommon/SMAAnalyticsEmptyView",["UWA/Core","UWA/Class/View","DS/W3DXComponents/Views/EmptyView","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(d,c,a,b){var a=a.extend({onRender:function(){var f=d.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,e=localStorage.getItem("_RAE_RUNYOURAPP_")||false;this._title=this.container.querySelector(".empty-view-title");this._title.textContent=b.get("EMPTY_VIEW_TEXT");if(f==="SIMWREI_AP"||e){this._title.textContent=b.get("EMPTY_VIEW_TEXT_RAE")}this._parent.apply(this,arguments)}});return a});define("DS/SMAAnalyticsCommon/views/SMAAnalyticsThumbnailView",["UWA/Core","DS/W3DXComponents/Views/Item/ThumbnailView","i18n!DS/SMAAnalyticsNLS/assets/nls/SMAAnalyticsWidgetNLSfile","css!DS/SMAAnalyticsCommon/views/SMAAnalyticsThumbnailView"],function(c,b,d){var a=b.extend({name:"",template:function(){return('                    <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                    <div class="toggle toggle-primary">                        <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                        <label class="control-label" for="checkbox-{{cid}}"></label>                    </div>                    </div>                    <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                        <div class="'+this.getClassNames("-header")+'">                            {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                        {{#if running}}<div class="'+this.getClassNames("-ra-servant-status")+'"></div>{{/if}}                        </div>                        <div class="'+this.getClassNames("-body")+'">                            {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false" title="{{iconTitle}}"/>{{/if}}                                <div class="'+this.getClassNames("-title")+'" title="{{{title}}}">{{{title}}}</div>                            <div class="'+this.getClassNames("-subtitle")+' {{status}}">                            {{#if statusIcon}}<span class="fonticon fonticon-{{statusIcon}}"></span>{{/if}}                        '+d.RA_MODIFIED+': {{{subtitle}}}</div>                            <div class="'+this.getClassNames("-content")+'">'+d.OWNER+": {{{content}}}<br>"+d.REVISION+': {{{revision}}}</div>                        <progress max="100" value="10" class="'+this.getClassNames("-progress")+'"></progress>                        </div>                        <div class="'+this.getClassNames("-actions")+'">                            <div class="actions-inline-container">                                <div class="action-container single-action hidden">                                    <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                </div>                                <div class="action-container actions-inline-dotted hidden">                                    <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                </div>                            </div>                        </div>                    </div>                ')}});return a});define("DS/SMAAnalyticsCommon/SMAAnalyticsSimObjReader",["DS/SPYLoader/SPYLoader","DS/SPY/SimulationPlayerModel","DS/SPYAPI/SensorsAccess","DS/Logger/Logger","module",],function(g,c,h,d,f){var b,e=d.getLogger(f);var a=UWA.Class.extend({init:function(j,i,l,k){b=this;b.context=l;b.serverUrl=j;b.tenantId=i;b.physicalId="";b.simObjNamesMap=k},loadSimulationObject:function(i){b.physicalId=i;var j={provider:"EV6",physicalid:i,serverurl:b.serverUrl,tenant:b.tenantId,requiredAuth:"passport"},k=new c({context:b.context});g.load(j,"DS/SPY/CATSimNavDataLWSensorsFactory",k)},getObjectParameters:function(){return new Promise(function(k,j){var i={physicalid:b.physicalId};var l=[];i.analysisCases=l;g.onUnstreamComplete(b.context,function(q){if(q===null||q===undefined){e.error("No data received from Simulation Objects");k("No data received from Simulation Objects")}var o=new h(q);if(!UWA.is(o)){e.error("Failed to parse Sensors from Simulation Objects");k("Failed to parse Sensors from Simulation Objects")}var n=o.getSequenceName();var r=o.getGlobalSensors();var p=1;var m={};m.name=n;m.sensors=r;l.push(m);g.continueLoading();if(g.isLoadingComplete()){k(i)}});g.onQueryError(b.context,function(m){e.error("Error occured while querying for data "+m);g.continueLoading();if(g.isLoadingComplete()){k(i)}});g.onUnstreamError(b.context,function(m){e.error(" RAE sample - error while reading stream");g.continueLoading();if(g.isLoadingComplete()){k(i)}})})},clearLoadedSimObject:function(){g.clean()}});return a});define("DS/SMAAnalyticsCommon/views/SMAAnalyticsContentSet",["UWA/Core","DS/W3DXComponents/ContentSet","i18n!DS/SMAAnalyticsNLS/assets/nls/SMAAnalyticsWidgetNLSfile"],function(g,b,f){var a="ra-content-set";var c="onDataUploadCompleteEvent";var e="onAddToCollectionEvent";var d=b.extend({name:a,template:function(){var h="";if(this.model.id){h="display:none;"}return('				<div class="'+this.getClassNames("-header")+'" style="'+h+'">	                <div class="'+this.getClassNames("-detail")+'"></div>	                <div class="'+this.getClassNames("-actions")+'"></div>	                <div class="'+this.getClassNames("-multiselHeader")+'"></div>	                <div class="'+this.getClassNames("-switcher")+'"></div>                </div>	            <div class="ra-create-input-page-container"></div>                <div class="'+this.getClassNames("-contents")+'" style="height: calc(100% - 150px);">                ')},_skeleton:null,events:{onFacetSelect:"onFacetSelect",onItemViewSelect:"onItemViewSelect"},onFacetSelect:function(h){this._skeleton=h},onItemViewSelect:function(){this._skeleton.activeViews=new Set()},onRender:function(){var n=g.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,l=localStorage.getItem("_RAE_RUNYOURAPP_")||false,k=false;if(n==="SIMWREI_AP"||l){k=true}var o=this.container.getElementsByClassName("ra-create-input-page-container");var j=this.options.contents.viewtype;var m=null;if(k){m=g.createElement("ra-input-dropbox",{"flush-on-complete":"true"})}else{m=g.createElement("ra-create-input-page",{"flush-on-complete":"true"})}m.isExportReq=false;var i=this.model.id;if(i){m.objectId=this.model.id;m.hideUpload=false}var h={title:f.get("ADD_DS"),upload:f.get("UPLOAD"),dragdrop:f.get("DDHERE"),search:f.get("SEARCH")};if(k){m.hideUpload=true;m.plmTypes="Simulation,DesignSight,VPMReference,Test Execution"}else{if(j&&j==="requirements"){h.title=f.get("ADD_REQ");m.plmTypes="Requirement";m.hideUpload=true;m.fileTypes=""}else{if(j&&j==="decisions"){h.title=f.get("ADD_DO");m.plmTypes="Requirement,Decision";m.isExportReq=true;m.hideUpload=true;m.fileTypes=""}else{m.plmTypes="Simulation,Document,Simulation Document - Versioned,Simulation Document - NonVersioned,Simulation Job,VPMReference,Requirement,Decision,Approximation,Test Execution";m.fileTypes=".zrf, .nrf, .xls, .xlsx, .xlsm, .zip, .csv, .tsv"}}}m.raTitle=h;m.addEventListener(c,function(p){this.contentsViews[this.currentViewId].dispatchEvent(e,[p])}.bind(this));o[0].appendChild(m);this._parent.apply(this,arguments)}});return d});define("DS/SMAAnalyticsCommon/views/SMAAnalyticsTileView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView","i18n!DS/SMAAnalyticsNLS/assets/nls/SMAAnalyticsWidgetNLSfile","css!DS/SMAAnalyticsCommon/views/SMAAnalyticsTileView"],function(b,c,d){var a=c.extend({name:"",template:function(){return('                <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                    <div class="toggle toggle-primary">                        <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                        <label class="control-label" for="checkbox-{{cid}}"></label>                    </div>                    </div>                    <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                        <div class="'+this.getClassNames("-header")+'">                            {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                        {{#if running}}<div class="'+this.getClassNames("-ra-servant-status")+'"></div>{{/if}}                        </div>                        <div class="'+this.getClassNames("-body")+'">                            {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false" title="{{iconTitle}}"/>{{/if}}                                <div class="'+this.getClassNames("-title")+'" title="{{{title}}}">{{{title}}}</div>                            <div class="'+this.getClassNames("-subtitle")+' {{status}}">                            {{#if statusIcon}}<span class="fonticon fonticon-{{statusIcon}}"></span>{{/if}}                        '+d.RA_MODIFIED+': {{{subtitle}}}</div>                            <div class="'+this.getClassNames("-content")+'">'+d.OWNER+": {{{content}}}<br>"+d.REVISION+': {{{revision}}}</div>                        <progress max="100" value="10" class="'+this.getClassNames("-progress")+'"></progress>                        </div>                        <div class="'+this.getClassNames("-actions")+'">                            <div class="actions-inline-container">                                <div class="action-container single-action hidden">                                    <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                </div>                                <div class="action-container actions-inline-dotted hidden">                                    <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                </div>                            </div>                        </div>                    </div>                ')}});return a});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsNewCaseDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/LineEditor","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","css!DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsDialog"],function(f,d,c,a,e){var b={showDialog:function(g){return new Promise(function(l,k){var h="",j=false;var i=function(){var q=new f.Element("div",{id:"ra-copy-case"});var o=new f.Element("div",{"class":"ra-copy-dialog-title",text:e.get("TITLE")});var r=new f.Element("div",{"class":"ra-copy-dialog-content"});o.inject(q);var p=new a({placeholder:e.get("ENTER_CASE_TITLE"),requiredFlag:true,value:g.value?g.value:""}).inject(r);p.addEventListener("change",function(){h=p.value;j=true});var n=r.getChildren()[0].getChildren()[0];n.addClassName("ra-copy-dialog-content");r.inject(q);return q};var m=new d({title:g.header,content:i(),minWidth:100,modalFlag:true,immersiveFrame:g.immersiveFrame,usePaddingFlag:true,buttons:{Cancel:new c({onClick:function(p){var n=p.dsModel;var o=n.dialog;o.close();k()}}),Ok:new c({disabled:false,label:g.okButtonLabel,onClick:function(p){var n=p.dsModel,o=n.dialog;var q="";if(j){q=h}else{q=g.value}q=f.is(q)&&q.length>0?q.trim():q;if(f.is(q)&&q.length>0){require(["DS/SMAAnalyticsCommon/SMAAnalyticsUtils"],function(s){var r=s.textSanitize(q,true);if(f.is(r)&&r.length>0){l(r);o.close()}else{s.showWarningNotification("",e.get("INVALID_TXT"))}})}}})}})})}};return b});define("DS/SMAAnalyticsCommon/dialogs/views/SMAAnalyticsApproximationView",["UWA/Core",],function(c,a){var b={};b.render=function(e,d){var f=c.createElement("ra-approximation-view",{approximation:e});return f};return b});define("DS/SMAAnalyticsCommon/SMAAnalyticsCustomTileView",["UWA/Core","DS/Core/PointerEvents","DS/Controls/TooltipModel","DS/UIKIT/DropdownMenu","DS/Utilities/Dom","DS/Controls/Toggle","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","css!DS/SMAAnalyticsCommon/views/SMAAnalyticsCustomTileView"],function(b,e,g,a,d,h,f,i){var c=b.Class.extend({init:function(j){this.buildView();this.properties={numColor:b.is(j.alternativeCount)?j.alternativeCount:20,description:b.is(j.description)?j.description:undefined,picture:b.is(j.picture)?j.picture:"",title:b.is(j.title)?j.title:"",subtitle:b.is(j.subtitle)?j.subtitle:undefined,contextualMenu:b.is(j.contextualMenu)?j.contextualMenu:[],onContextMenuBuildCallback:b.is(j.onContextMenuBuildCallback)?j.onContextMenuBuildCallback:undefined,statusbarIcons:b.is(j.statusbarIcons)?j.statusbarIcons:[],statusbarIconsTooltips:b.is(j.statusbarIconsTooltips)?j.statusbarIconsTooltips:[],onStatusbarIconPointerDown:b.is(j.onStatusbarIconPointerDown)?j.onStatusbarIconPointerDown:undefined,customTooltip:b.is(j.picture)?j.customTooltip:""}},buildView:function(){this.container=new b.Element("div",{"class":"ra-tile-container"});this.subContainer=new b.Element("div",{"class":"ra-tile-main-box"});this.subContainer.setAttribute("is-empty-statusbar-visible","true");this.container.appendChild(this.subContainer);this.topContainer=new b.Element("div",{"class":"ra-top-container"});this.subContainer.appendChild(this.topContainer);this.titleHolder=new b.Element("div",{"class":"ra-header-title"});this.titleHolder.setAttribute("show-holder","false");this.title=b.createElement("span").inject(this.titleHolder);this.dragHolder=new b.Element("i",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-drag-grip"});this.dragHolder.style.display="none";this.topContainer.appendChild(this.titleHolder);this.topContainer.appendChild(this.dragHolder);this.thumbnailContainer=new b.Element("div",{"class":"ra-header-thumbnail-container"});this.thumbnailContainer.draggable=false;this.thumbnailContainer.setAttribute("contextual-menu","false");this.thumbnailContainer.setAttribute("selection-allowed","false");this.thumbnailContainer.setAttribute("is-empty-statusbar-visible","true");this.subContainer.appendChild(this.thumbnailContainer);this.checkboxHolder=new b.Element("div",{"class":"ra-header-checkbox"});this.checkbox=new h({title:"this is a check box"});this.checkboxHolder.appendChild(this.checkbox.getContent());this.checkboxHolder.style.display="none";this.checkbox.getContent().style.display="none";this.thumbnail=new b.Element("div",{"class":"ra-header-thumbnail"});this.image=b.createElement("img");this.image.draggable=false;this.thumbnail.appendChild(this.image);this.contextMenuHolder=b.createElement("div",{id:"contextmenu","class":"ra-header-contextmenu"});this.contextMenuHolder.style.display="none";this.thumbnailContainer.appendChild(this.checkboxHolder);this.thumbnailContainer.appendChild(this.thumbnail);this.thumbnailContainer.appendChild(this.contextMenuHolder);this.subtitleHolder=new b.Element("div",{"class":"ra-header-subtitle"});this.subtitleHolder.setAttribute("hide-subtitle","false");this.subtitle1=new b.Element("span",{"class":"ra-subtitle-rank"});this.subtitle2=new b.Element("span",{"class":"ra-subtitle-score"});this.subtitleHolder.appendChild(this.subtitle1);this.subtitleHolder.appendChild(this.subtitle2);this.subContainer.appendChild(this.subtitleHolder);this.menu=new b.Element("div",{"class":"ra-tile-menu"});this.menu.setAttribute("has-statusbar-content","false");this.menu.setAttribute("is-empty-statusbar-visible","true");this.statusbar=new b.Element("div",{"class":"ra-header-menu"}).inject(this.container);this.statusbar.setAttribute("has-statusbar-content","false");this.statusbar.setAttribute("is-empty-statusbar-visible","false");this.menuBar=new b.Element("div",{"class":"rae-menu-bar"});this.statusbar.appendChild(this.menuBar);this.menu.appendChild(this.statusbar);this.container.appendChild(this.menu)},get:function(){return this.container},apply:function(){this.container.style.display="none";d.setContent(this.title,this.properties.title,false);this.dragHolder.tooltipInfos=this._getTooltip(i.get("REORDER"),i.get("REORDER_HELP"));this.image.src=this.properties.picture;if(this.properties.contextualMenu.length>0){this._setupContextualMenu()}if(b.is(this.properties.subtitle)){if(this.properties.subtitle.rank!=="-"){var j=this._getColor();this.subtitleHolder.style.background=j}d.setContent(this.subtitle1,i.get("RANK")+": <b>"+this.properties.subtitle.rank+"</b>",true);d.setContent(this.subtitle2,i.get("SCORE")+": <b>"+this.properties.subtitle.score+"</b>",true)}else{this.subtitleHolder.style.display="none"}if(this.properties.statusbarIcons.length>0){this._applyMenu()}else{this.subContainer.setAttribute("is-empty-statusbar-visible","false");this.menu.setAttribute("is-empty-statusbar-visible","false");this.thumbnailContainer.setAttribute("is-empty-statusbar-visible","false")}this.container.style.display="";this._setMainTooltip()},update:function(k){if(this.properties.numColor!==k.alternativeCount){this.properties.numColor=k.alternativeCount}if(this.properties.title!==k.title){this.properties.title=k.title}if(this.properties.subtitle.rank!==k.subtitle.rank){this.properties.subtitle.rank=k.subtitle.rank;if(this.properties.subtitle.rank!=="-"){var j=this._getColor();this.subtitleHolder.style.background=j}d.setContent(this.subtitle1,"Rank: <b>"+this.properties.subtitle.rank+"</b>",true)}if(b.is(this.properties.subtitle)){if(this.properties.subtitle.rank!=="-"){var j=this._getColor();this.subtitleHolder.style.background=j}else{this.subtitleHolder.style.background="#f9f9f9"}}if(this.properties.subtitle.score!==k.subtitle.score){this.properties.subtitle.score=k.subtitle.score;d.setContent(this.subtitle2,"Score: <b>"+this.properties.subtitle.score+"</b>",true)}if(this.properties.picture!==k.picture){this.properties.picture=k.picture;this.image.src=this.properties.picture}if(this.properties.statusbarIcons.length<1){this.subContainer.setAttribute("is-empty-statusbar-visible","false");this.menu.setAttribute("is-empty-statusbar-visible","false");this.thumbnailContainer.setAttribute("is-empty-statusbar-visible","false")}if(this.properties.statusbarIcons.length!==k.statusbarIcons.length){this.properties.statusbarIcons=k.statusbarIcons;this.properties.statusbarIconsTooltips=k.statusbarIconsTooltips;this._clearMenu();this._applyMenu()}this._setMainTooltip();this._setupContextualMenu(true,k.onContextMenuBuildCallback)},makeBaseline:function(){this.topContainer.addClassName("baseline")},removeBaseline:function(){this.topContainer.removeClassName("baseline")},_getColor:function(){var n=this.properties.subtitle.rank;var m,k,j;m=180;k=60;j=78+Math.floor(22*(n/this.properties.numColor));return"hsl("+m+","+k+"%,"+j+"%)"},getDragHolder:function(){this.dragHolder.style.display="";this.titleHolder.setAttribute("show-holder","true");return this.dragHolder},_setupContextualMenu:function(n,j){var l=this;this.checkboxHolder.style.display="";this.contextMenuHolder.style.display="";var m=this.properties.onContextMenuBuildCallback;if(n===true){this.contextMenuHolder.removeChild(this.contextMenuHolder.getChildren()[0]);m=j}this.contextMenu=new b.Element("i",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-chevron-down rae-header-context-menu"});this.contextMenu.style.cursor="pointer";this.contextMenuHolder.appendChild(this.contextMenu);var k=new a({target:l.contextMenu,items:l.properties.contextualMenu,events:{onClick:m}})},_applyMenu:function(){var l=this.properties.statusbarIcons;var j=this.properties.statusbarIconsTooltips;var k=0;l.forEach(function(n){var m=new b.Element("i",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+n,});m.setAttribute("icon-name",n);m.addEvent(e.POINTERDOWN,this.properties.onStatusbarIconPointerDown);m.tooltipInfos=this._getTooltip(j[k++]);this.menuBar.appendChild(m)},this)},_clearMenu:function(){while(this.menuBar.firstChild){this.menuBar.removeChild(this.menuBar.firstChild)}},toggleIcon:function(l,k){var j=this.menuBar.getChildren();j.forEach(function(m){if(m.getAttribute("icon-name")===l){m.removeClassName("wux-ui-3ds-"+l);m.addClassName("wux-ui-3ds-"+k);m.setAttribute("icon-name",k)}})},toggleIconColor:function(l,k){var j=this.menuBar.getChildren();j.forEach(function(m){if(m.getAttribute("icon-name")===l){if(k===true){m.addClassName("selected")}else{m.removeClassName("selected")}}})},toggleIconClass:function(m,l,j){var k=this.menuBar.getChildren();k.forEach(function(n){if(n.getAttribute("icon-name")===m){if(b.is(j)&&j===true){n.removeClassName(l)}else{n.addClassName(l)}}})},updateIconTooltip:function(l,k){var j=this.menuBar.getChildren();j.forEach(function(m){if(m.getAttribute("icon-name")===l){m.tooltipInfos=this._getTooltip(k)}},this)},setDraggable:function(j,k){if(b.is(k)&&typeof k==="function"){this.thumbnailContainer.addEventListener("dblclick",k)}this.thumbnailContainer.style.cursor="move";this.thumbnailContainer.draggable=true;f.draggable(this.thumbnailContainer,{data:j})},_setMainTooltip:function(){var j=null;if(b.is(this.properties.subtitle)){j=this._getTooltip(this.properties.title,i.get("RANK")+": <b>"+this.properties.subtitle.rank+"</b><br> "+i.get("SCORE")+": <b>"+this.properties.subtitle.score+"</b>",this.properties.description)}else{j=this._getTooltip(this.properties.title)}this.subtitleHolder.tooltipInfos=this.titleHolder.tooltipInfos=this.thumbnailContainer.tooltipInfos=j},_getTooltip:function(r,m,p){var n=new b.Element("span",{"class":"ra-short-help-title",html:r});var o=null;var q=null;if(b.is(m)){o=new b.Element("div");var l=new b.Element("span",{"class":"ra-short-help-subtitle"});d.setContent(l,m,true);o.appendChild(l);if(b.is(p)){var k=new b.Element("span",{"class":"ra-short-help-subtitle"});var j=new b.Element("span",{"class":"ra-description-tooltip",text:p});d.setContent(k,"<br><b>"+i.get("DESCRIPTION")+":</b><br>",true);o.appendChild(k);o.appendChild(j)}}if(b.is(o)){q=new g({title:n,shortHelp:o,mouseRelativePosition:true,allowUnsafeHTMLTitle:true,allowUnsafeHTMLShortHelp:true})}else{q=new g({shortHelp:n,mouseRelativePosition:true,allowUnsafeHTMLShortHelp:true})}return q}});return c});define("DS/SMAAnalyticsCommon/SMAAnalyticsSearch",["UWA/Core","DS/PlatformAPI/PlatformAPI"],function(e,c){var a;var d=function(o){var k="";var g=function(r){var s="";var t=r.split(/\s+/);for(var q=0;q<t.length;++q){var i=t[q];if(i!=="OR"&&i!=="AND"&&i!=="NOT"){if(i.charAt(0)!=="*"){i="*"+i}if(i.charAt(i.length-1)!=="*"){i=i+"*"}}s=s+i+" "}s.trim();return s};if((o.hasOwnProperty("addFilter")&&o.addFilter!=="")){var f="";if(o.hasOwnProperty("addFilter")&&o.addFilter!==""){var h=g(o.addFilter);if(f!==""){f+=" AND "}f+=h}var n=[{tag:"ds6w:label"}];for(var j=0;j<n.length;++j){var p=n[j].tag;var m=p.substr(1).search(/\//)+1;if(m>0){p=p.slice(m+1)}if(k!==""){k+=" OR "}k+="["+p+"]:("+f+")"}}if(k!==""){k="("+k+")"}var l;if(k!==""){l='flattenedtaxonomies:"types/Analytics Case"';l+=" AND ";l+=k}return l};var b=e.Class.singleton({init:function(){a=this;a.spServiceurl=e.createElement("sp-serviceurl");a.dashboard=e.createElement("sp-dashboard");if(typeof(widget)!=="undefined"&&widget){a.tenant=widget.getValue("x3dPlatformId")}if(!a.tenant){a.tenant="OnPremise"}},getData:function(h){if(!h){h={}}var g={};if(h.filterTags){e.extend(g,h.filterTags)}var j='flattenedtaxonomies:"types/Analytics Case"';if(h.addFilter){j=d(h)}var i="UNDEFINED";try{i=c.getUser().login.toUpperCase()}catch(f){e.log("Error fetching user id")}var k={label:"SIMREII_AP-"+i+"-"+Date.now(),refine:g,with_indexing_date:true,with_nls:false,locale:"en",select_predicate:["ds6w:label","id","ds6w:description","ds6w:identifier","ds6w:modified","ds6w:created","ds6w:type","ds6w:upToDate","ds6w:responsible","ds6w:where/ds6w:context/ds6w:project","ds6w:project","ds6w:who/ds6w:responsible/ds6w:organizationResponsible","ds6w:organizationResponsible","ds6wg:revision"],select_file:["icon","thumbnail_2d"],query:j,order_by:"desc",order_field:"ds6w:modified",nresults:h.nresults?h.nresults:1000,source:["3dspace"],tenant:this.tenant};if(e.is(h)&&e.is(h.next_start)){k.next_start=h.next_start}else{k.start=0}return this._getMaterialData(k,h)},_getMaterialData:function(g,f){this.spServiceurl.getUrl({serviceid:"3DSearch",platformid:this.tenant,onComplete:function(h){var i=document.createElement("sp-webservice");i.sendRequest({handleprefix:false,handlepostfix:false,serviceId:"3DSearch",uri:h+"/"+f.servicename,verb:"POST",data:g,wait:0,success:[200,204],headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json"},onComplete:function(j){var k=JSON.parse(j.response);f.onComplete(k)},onError:function(j){f.onError(j)}})},onError:function(h){e.log("error"+h)}})},_getRecentData:function(){}});return b});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsCustomDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","css!DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsDialog"],function(d,b,a){var c={showDialog:function(e){return new Promise(function(i,h){var g=function(o){var m=o.dsModel;var n=m.dialog;n.close();i();if(e.onConfirm){e.onConfirm()}};var l=new a({onClick:g});if(e.okLabel!==undefined){l.label=e.okLabel}else{l.label="Confirm"}var k=function(o){var m=o.dsModel;var n=m.dialog;n.close();h();if(e.onCancel){e.onCancel()}};var j=new a({onClick:k});if(e.cancelLabel!==undefined){j.label=e.cancelLabel}else{j.label="Cancel"}var f=new b({title:e.header,content:e.content,minWidth:400,minHeight:100,resizableFlag:false,modalFlag:true,immersiveFrame:e.immersiveFrame,usePaddingFlag:true,buttons:{Ok:l,Cancel:j,}})}.bind(this))}};return c});define("DS/SMAAnalyticsCommon/dialogs/views/SMAAnalyticsAttributeView",["UWA/Core","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/DatePicker","DS/Controls/SpinBox","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/Editor","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(e,g,a,f,c,i,l,b,k,j){var h;var d=e.Class.extend({init:function(p){h=this;h._model=null;h._treeDocument=null;h.onChangeEvent=false;h.newComboValue=null;var o=new a({useAsyncPreExpand:true});var n=[];if(p){p.forEach(function(r){var q=new f({label:r.name,grid:r});o.addChild(q)})}h._treeDocument=o;var m=this.getAttributeViewOptions();h._attributeView=new g(m);h._attributeView.getManager().hideColumn(0);this._parent()},getAttributeViewOptions:function(){var m=this;return{height:"300px",width:"800px",enableDragAndDrop:false,isEditable:true,isSortable:true,infiniteScrolling:true,enableKeyboardNavigation:true,defaultCellHeight:41,resize:{columns:true,rows:false},columns:[{text:j.get("TITLE"),dataIndex:"name",isEditable:false,isSortable:true,width:"auto"},{text:j.get("DESCRIPTION"),dataIndex:"description",isEditable:false,isSortable:true,width:"15%"},{text:j.get("VALUE"),dataIndex:"value",isEditable:false,isSortable:false,width:"23%",onCellRequest:function(p){if(!p.isHeader){var q=p.nodeModel;var o=p.manager;if(m.newComboValue){p.nodeModel.options.grid.value=m.newComboValue;m.newComboValue=null}var n=m.formatValueCell(p);p.cellView.getContent().setHTML(n)}}},{text:j.get("TYPE"),dataIndex:"type",isEditable:false,isSortable:true,width:"auto",onCellRequest:function(o){if(!o.isHeader){var n=o.nodeModel.options.grid.type.toUpperCase();o.cellView.getContent().textContent=j.get("ATTR_TYPE_"+n)}}},{text:j.get("ATTR_DEFAULT"),dataIndex:"default",isEditable:false,isSortable:true,isDraggable:false,width:"20%"},{text:j.get("ATTR_MAND"),dataIndex:"mandatory",isEditable:false,isSortable:false,width:"12%"},{text:j.get("ATTR_INP_OUT"),dataIndex:"inputoutput",isEditable:true,isSortable:true,width:"auto"},{text:j.get("ATTR_MIN"),dataIndex:"minimum",isEditable:false,isSortable:true,width:"auto"},{text:j.get("ATTR_MAX"),dataIndex:"maximum",isEditable:false,isSortable:true,width:"auto"}],treeDocument:h._treeDocument}},formatValueCell:function(o){var n=o.nodeModel.options.grid;var r=n.type.toUpperCase(),q=n.choicesList.length>0?n.choicesList:[],p=p,s=n.value,u=n.valuetype,m=this.getLineEditor(n);if(u==="multivalue"){}switch(r){case"INTEGER":if(q.length>0){m=this.getCombobox(o)}else{m=this.getSpinBox(o.nodeModel.options.grid)}break;case"REAL":if(q.length>0){m=this.getCombobox(o)}else{m=this.getSpinBox(o.nodeModel.options.grid)}break;case"TIMESTAMP":m=this.getDatePicker(o.nodeModel.options.grid);break;case"STRING":if(q.length>0){m=this.getCombobox(o)}break;case"MULTILINE":m=this.getEditor(o.nodeModel.options.grid);break;case"BOOLEAN":if(q||q.length===0){n.choicesList=["True","False"]}m=this.getCombobox(o);break;default:break}var t=m.elements.container.getElementsByClassName("wux-ui-state-undefined");if(t.length>0){t[0].addClassName("wux-controls-lineeditor");t[0].removeClassName("wux-ui-state-undefined")}return m},getDatePicker:function(m){return new c({value:new Date(m.value),timePickerFlag:true,timePickerPrecision:"sec"})},getLineEditor:function(m){return new b({value:m.value,requiredFlag:m.mandatory})},getEditor:function(m){return new k({value:m.value,requiredFlag:m.mandatory,newLineMode:"Enter"})},getCombobox:function(p){var r=p.nodeModel.options.grid;var m=[],q=r.value,s=0;for(var o=0;o<r.choicesList.length;o++){if(e.typeOf(q)==="string"){if(q.toUpperCase()===r.choicesList[o].toUpperCase()){s=o}}else{if(q===r.choicesList[o]){s=o}}m[o]={labelItem:r.choicesList[o],valueItem:r.choicesList[o]}}var n=new l({elementsList:m,currentValue:m[s].labelItem,currentLabel:m[s].valueItem,enableSearchFlag:true,autocompleteFlag:true});n.addEventListener("change",function(t){t.preventDefault();t.stopPropagation();this.nodeModel.options.grid.value=t.dsModel.currentValue;this.manager.updateRowView(this.virtualRowID)}.bind(p));return n},getSpinBox:function(r){var q=Number.MAX_VALUE,s=Number.MIN_VALUE,o=r.type,m=1,n=0,p=r.value;if(o==="integer"){if(p){p=parseInt(p)}if(r.minimum){q=parseInt(r.minimum)}if(r.maximum){s=parseInt(r.maximum)}}else{if(p){p=parseFloat(p)}m=0.1;n=10;if(r.minimum){q=parseFloat(r.minimum)}if(r.maximum){s=parseFloat(r.maximum)}}return new i({value:p,minValue:q,maxValue:s,stepValue:m,decimals:n})},getView:function(){return h._attributeView}});return d});define("DS/SMAAnalyticsCommon/SMAAnalyticsDatasetView",["UWA/Core","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView"],function(g,c,f,d,b){var a=this,e=g.Class.singleton({init:function(){a=this;a._view=null;a._toolbar=null;a.alternativeFilter=""},initialize:function(h){if(!g.is(h)&&!g.is(h.data)&&!g.is(h.columns)){return}a._toolbar=null;a.alternativeFilter="";a._data=h.data;a._columns=h.columns;a._toolbarData=g.is(h.toolbar)?h.toolbar:undefined;a._setup()},_setup:function(){a._setupTreeDocument();a.view=new b({identifier:widget.id,treeDocument:a.model,columns:a._columns,rowSelection:"multiple",cellSelection:"none",defaultColumnDef:{width:"auto",editionPolicy:"EditionOnOver",typeRepresentation:"string",allowUnsafeHTMLContent:false},});if(g.is(a._toolbarData)){a._toolbar=a.view.setToolbar(JSON.stringify(a._toolbarData));a._toolbar.addEventListener("liveChange",function(h){a.alternativeFilter=h.dsModel.value})}},_setupTreeDocument:function(){var m=new d();a.model=new c({dataModelSet:m});var n=a._data;a.model.prepareUpdate();for(var l=0,h=n.length;l<h;l++){var k=n[l];var j=f.createTreeNodeDataModel(m,{label:k.name,grid:k});a.model.addChild(j)}a.model.expandAll();a.model.pushUpdate()},clear:function(){a.view=null},update:function(){},getModel:function(){return a.model},getToolbar:function(){return a._toolbar},getView:function(){return a.view}});return e});define("DS/SMAAnalyticsCommon/SMAAnalyticsTagger",["UWA/Core","DS/TagNavigatorProxy/TagNavigatorProxy","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(e,d,c){var a=null;var b=e.Class.singleton({init:function(){a=this},set:function(g){if(!g){g=[]}var f=a.configTags(g);a.proxy.activate();a.proxy.setTags({},f)},initialize:function(g){g=g||{};a._tagChangeCallback=null;a._taggerChangeCallback=null;a._searchChangeCallback=null;a._searchString="";a._specifierTags=Object.keys(c);a._toSpecifiers={};a._toTags={};for(var h=0;h<a._specifierTags.length;++h){a._toSpecifiers[a._specifierTags[h]]=c[a._specifierTags[h]];a._toTags[c[a._specifierTags[h]]]=a._specifierTags[h]}if(a.initializeTagger){return}a.initializeTagger=true;if(!g.proxy){var f={filteringMode:"FilteringOnServer",events:{},freeInput:true};if(widget&&widget.environment.name!=="uwa"){f.widgetId=widget.id}else{f.contextId="default"}this.proxy=d.createProxy(f);this.proxy.addEvent("onFilterChange",a.onFilterChange)}else{this.proxy=g.proxy}this.allFilters={};this.filterKeys=[];this.allFacets=[];if(widget){widget.addEvent("onSearch",a.onSearch);widget.addEvent("onResetSearch",a.onResetSearch)}},initTaggerEvents:function(){var g=window.top.document.getElementById("btn_tag_nav");if(g){var f=new MutationObserver(a.onTaggerToggle);f.observe(g,{attributes:true})}},reset:function(){a.proxy.setTags({});a._tagChangeCallback=null;a._taggerChangeCallback=null;a._searchChangeCallback=null},onFilterChange:function(f){a.allFilters=f.allfilters;a.filterKeys=Object.keys(a.allFilters);if(a._tagChangeCallback){a._tagChangeCallback()}else{a.reset()}},onTagChange:function(f){a._tagChangeCallback=f},hasFilters:function(){return(a.filterKeys.length||a._searchString!=="")},hasTags:function(){return(a.filterKeys.length)},getFilters:function(){return{tags:a.allFilters,search:a._searchString}},onSearch:function(f){a._searchString=f;if(a._searchChangeCallback){a._searchChangeCallback(a._searchString)}},onResetSearch:function(){a._searchString="";if(a._searchChangeCallback){a._searchChangeCallback(a._searchString)}},onSearchChange:function(f){a._searchChangeCallback=f},onTaggerToggle:function(){if(a._taggerChangeCallback){a._taggerChangeCallback(a.isVisible())}},onTaggerChange:function(f){a._taggerChangeCallback=f},isVisible:function(){var f=false;var g=window.top.document.getElementById("btn_tag_nav");if(g){f=g.hasClassName("tagger-icon-active")}return f},configTags:function(k){var f=[];var h,g;for(h=0;h<k.length;++h){var l=k[h];f.push(l)}return f}});return b});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsCaseDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Toggle","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","css!DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsDialog"],function(h,d,c,b,e,a,f){var g={showDialog:function(i){return new Promise(function(q,r){var m="",j="",o=false,l=false,p=false;var n=function(){var x=new h.Element("div",{id:"ra-copy-case"});var z=new h.Element("div",{"class":"ra-copy-dialog-title",text:f.get("TITLE")});var w=new h.Element("div",{"class":"ra-copy-dialog-content"});z.inject(x);var t=new b({placeholder:f.get("ENTER_CASE_TITLE"),requiredFlag:true,value:i.value?i.value:""}).inject(w);t.addEventListener("change",function(){m=t.value;o=true});var u=new h.Element("div",{"class":"ra-copy-dialog-description",text:f.get("DESCRIPTION")}).inject(w);var s=new e({placeholder:f.get("ENTER_CASE_DESCRIPTION"),escapeHTML:false,autoCommitFlag:true,newLineMode:"shiftEnter",value:h.is(i.valueDescription)?i.valueDescription:"",nbRows:4}).inject(w);s.addEventListener("change",function(){j=s.value;l=true});if(h.is(i.showToggle)&&i.showToggle===true){var v=new a({type:"switch",label:f.get("INCLUDE_SELECTED_OBJECTS")});v.inject(w);v.addEventListener("change",function(B){B.preventDefault();B.stopPropagation();p=B.dsModel.checkFlag})}var y=w.getChildren()[0].getChildren()[0];var A=w.getChildren()[2].getChildren()[0];y.addClassName("ra-copy-dialog-content");A.addClassName("ra-copy-dialog-content");w.inject(x);return x};var k=new d({title:i.header,content:n(),minWidth:100,modalFlag:true,immersiveFrame:i.immersiveFrame,usePaddingFlag:true,buttons:{Cancel:new c({onClick:function(u){var s=u.dsModel;var t=s.dialog;t.close();r()}}),Ok:new c({disabled:false,label:i.okButtonLabel,onClick:function(u){var s=u.dsModel,t=s.dialog;var v="";if(o){v=m}else{v=i.value}v=h.is(v)&&v.length>0?v.trim():"";if(h.is(v)&&v.length>0){require(["DS/SMAAnalyticsCommon/SMAAnalyticsUtils"],function(y){var w=y.textSanitize(v,true);if(h.is(w)&&w.length>0){var x=y.textSanitize(j);if(j.length>0&&x.length===0){y.showWarningNotification("",f.get("INVALID_TXT_DESC"))}else{if(!l){x=i.valueDescription}q({title:w,description:x,includeObjects:p});t.close()}}else{y.showWarningNotification("",f.get("INVALID_TXT"))}})}}})}})})}};return g});define("DS/SMAAnalyticsCommon/SMAAnalyticsContainerDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button"],function(e,c,b){var a=null;var d=e.Class.extend({init:function(f){a=this;a.header=f.header;a.content=f.content;a.okLabel=f.okLabel;a.immersiveFrame=f.immersiveFrame},show:function(){return new Promise(function(h,g){var f=this;new c({title:a.header,content:a.content,minWidth:440,modalFlag:false,immersiveFrame:a.immersiveFrame,usePaddingFlag:true,buttons:{Cancel:new b({onClick:function(k){var i=k.dsModel;var j=i.dialog;j.close();g()}}),Ok:new b({disabled:false,label:a.okLabel,onClick:function(k){var i=k.dsModel;var j=i.dialog;j.close();h()}})}})})}});return d});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsConfirmDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","css!DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsDialog"],function(d,b,a){var c={showDialog:function(e){return new Promise(function(i,h){var g=function(l){var m=d.createElement("div",{id:"ra-confirm-dialog",text:l.label});return m};var k=new a({onClick:function(n){var l=n.dsModel;var m=l.dialog;m.close();i()}});if(e.okLabel!==undefined){k.label=e.okLabel}var j=new a({onClick:function(n){var l=n.dsModel;var m=l.dialog;m.close();h()}});if(e.cancelLabel!==undefined){j.label=e.cancelLabel}var f=new b({title:e.header,content:g(e),minWidth:400,resizableFlag:false,modalFlag:true,immersiveFrame:e.immersiveFrame,usePaddingFlag:true,buttons:{Ok:k,Cancel:j,}})}.bind(this))}};return c});define("DS/SMAAnalyticsCommon/SMAAnalyticsWSUtil",["UWA/Core","UWA/Utils","DS/PlatformAPI/PlatformAPI","UWA/Class"],function(h,e,i,a){var j="SecurityContext",k=["collabspaces","collabspace"];function g(){var l=null;if(!l&&window.widget&&window.widget.getValue){k.some(function(m){l=window.widget.getValue(m);return l})}return l}var d=a.singleton({ENO_CSRF_TOKEN:null,THREEDSpaceUrl:null,post:function(m,n,l,q,p,o){return c(this,"POST",m,undefined,n,l,q,p,o)},put:function(m,n,l,p,o){return c(this,"PUT",m,undefined,n,l,p,o)},get:function(m,n,l,p,o){return c(this,"GET",m,n,undefined,l,p,o)},del:function(m,n,l,p,o){return c(this,"DELETE",m,n,undefined,l,p,o)},encodeUri:function(l){return l?encodeURIComponent(l.toString().replace(/\//g,"!")).replace(/!/g,"%21"):l},decodeUri:function(l){return decodeURIComponent(l).replace(/!/g,"/")},decodeUriLocation:function(l){return decodeURIComponent(l.getResponseHeader("Location").replace(/.*\//,"")).replace(/!/g,"/")},getUrl:function(l,m){return f(this,l,m,this.options.baseUrl)}});function b(){var l=window.UWA&&window.UWA.hosts&&window.UWA.hosts.exposition;return l&&["http://uwa.netvibes.com","https://uwa.netvibes.com"].indexOf(l)===-1}function f(m,r,q){var p="",s=window.location,o=window.require||function(){},n=null,l="";r=h.is(r,"object")?h.clone(r,false):{};if(!m.contains("://")){if(b()||h.is(q)){p=UWA.is(q)?q:window.widget&&window.widget.getUrl()||"";if(p.indexOf("/webapps")>-1){p=p.substring(0,p.indexOf("/webapps"))}if(m.contains("create")){n=widget.getValue("createcollabspaces")}else{n=g()}if(!r[j]&&n){r[j]=n}}else{p=s.protocol+"//"+s.host+s.pathname.match(/^\/\w*/).join("")}l=p+m}else{l=m}l=l.split("?")[0].split("#")[0];l=l+(r?"?"+e.toQueryString(r):"");l=l.replace(/\?$/,"");return l}function c(t,l,m,r,p,n,q,s){m=f(m,r,t.THREEDSpaceUrl);var o={pragma:"no-cache","Content-Type":"application/json; charset=utf-8",Accept:"*/*"};return document.createElement("sp-mcsservice").sendRequest({uri:m,verb:l,wait:0,success:[200,204],headers:o,data:p,timeout:1200000,onComplete:function(u){if(typeof n==="function"){try{u.response=JSON.parse(u.response)}catch(v){}n(u)}if(typeof s==="function"){try{s()}catch(v){}}},onError:function(u){if(typeof q==="function"){try{q(u)}catch(v){}}if(typeof s==="function"){try{s()}catch(v){}}}})}return d});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsSaveDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","css!DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsDialog",],function(d,c,b){var a={showDialog:function(e){return new Promise(function(i,h){var g=function(j){var k=d.createElement("div",{id:"ra-confirm-dialog",text:j.label});return k};var f=new c({title:e.header,content:g(e),minWidth:400,minHeight:100,resizableFlag:false,modalFlag:true,immersiveFrame:e.immersiveFrame,usePaddingFlag:true,buttons:{Ok:new b({label:e.okLabel,onClick:function(l){var j=l.dsModel;var k=j.dialog;k.close();i(true)}}),Apply:new b({label:e.applyLabel,onClick:function(l){var j=l.dsModel;var k=j.dialog;k.close();i(false)}}),Cancel:new b({onClick:function(l){var j=l.dsModel;var k=j.dialog;k.close();h()}}),}})}.bind(this))}};return a});define("DS/SMAAnalyticsCommon/dialogs/views/SMAAnalyticsHistoryView",["UWA/Core","DS/Tree/TreeListView","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel"],function(g,c,d,b,f){var e=function(h){return{height:"auto",enableDragAndDrop:false,isSortable:true,infiniteScrolling:true,enableKeyboardNavigation:true,defaultCellHeight:41,resize:{columns:true,rows:false},columns:[{text:d.get("HISTORY_ACTION"),dataIndex:"Action",isEditable:false,isSortable:true,isDraggable:false,width:"15%"},{text:d.get("DESCRIPTION"),dataIndex:"Description",isEditable:false,isSortable:false,width:"auto"},{text:d.get("HISTORY_USER"),dataIndex:"User",isEditable:false,isSortable:true,isDraggable:false},{text:d.get("HISTORY_TIME"),dataIndex:"Time",isEditable:false,isSortable:true,isDraggable:false,width:"20%"},{text:d.get("STATE"),dataIndex:"State",isEditable:false,isSortable:true}],treeDocument:h}};var a={};a.render=function(l){var k=new b({useAsyncPreExpand:true});var j=[];if(l){l.forEach(function(n){var m=new f({label:n.Action,grid:n});k.addChild(m)})}var h=e(k);var i=new c(h);i.getManager().hideColumn(0);return i};return a});define("DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy",["UWA/Core","DS/SMAAnalyticsCommon/SMAAnalyticsWSUtil","UWA/Class/Promise","DS/Logger/Logger","module","DS/ZipJS/zip-fs","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(d,c,g,b,a,h,j){var e={},i=b.getLogger(a),f=function(l){var k="";switch(l.toLowerCase()){case"csv":k="text/csv";break;case"json":k="application/json";break;case"jpg":k="image/jpeg";break;case"png":k="image/png";break;default:k="";break}return k};e.create=function(m,l,k){return new g(function(q,p){var o={title:d.is(m)?m:"",description:d.is(l)?l:"",definition:d.is(k)?k:""},r=function(s){q(s)},n=function(s){p(s)};c.post("/resources/slmservices/advise/create",JSON.stringify(o),r,n)})};e.connect=function(k,m,l){return new g(function(q,p){var o={caseid:k,objectids:m,rae:d.is(l)?l:false},r=function(s){q(s)},n=function(s){p(s)};c.post("/resources/slmservices/advise/connect",JSON.stringify(o),r,n)})};e.disconnect=function(l,m,k){return new g(function(q,p){var o={caseid:l,objectids:m,relationids:d.is(k)?k:""},r=function(s){q(s.response)},n=function(s){p(s)};c.post("/resources/slmservices/advise/disconnect",JSON.stringify(o),r,n)})};e.getAttributeGroups=function(k){return new g(function(o,n){var m={caseid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.get("/resources/slmservices/advise/attributegroups",m,p,l)})};e.connectAttributeGroups=function(k,l){return new g(function(p,o){var n={caseid:k,attrgroupids:l},q=function(r){p(r.response)},m=function(r){o(r)};c.post("/resources/slmservices/advise/connect/attributegroups",JSON.stringify(n),q,m)})};e.disconnectAttributeGroups=function(l,k){return new g(function(p,o){var n={caseid:l,attrgroupid:k},q=function(r){p(r.response)},m=function(r){o(r)};c.post("/resources/slmservices/advise/disconnect/attributegroups",JSON.stringify(n),q,m)})};e.getAttributes=function(l,k){return new g(function(p,o){var n={caseid:l,attributegroupid:k},q=function(r){p(r.response)},m=function(r){o(r)};c.get("/resources/slmservices/advise/attributegroups/attributes",n,q,m)})},e.update=function(k,l,m){return new g(function(q,p){var o={caseid:k,attributename:l,value:m},r=function(s){q(s.response)},n=function(s){p(s)};c.post("/resources/slmservices/advise/attribute",JSON.stringify(o),r,n)})},e.setSimulationAttributes=function(k){return new g(function(n,m){var o=function(p){n(p.response)},l=function(p){m(p)};c.post("/resources/slmservices/advise/attributegroups/attributes",JSON.stringify(k),o,l)})};e.getRequirements=function(k){return new g(function(o,n){var m={caseid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.get("/resources/slmservices/advise/requirements",m,p,l)})};e.getRequirementsParameters=function(k){return new g(function(o,n){if(k.length>0){var q="";k.forEach(function(r){q+=q.length>0?";"+r:r});var m={objectids:q},p=function(r){o(r.response)},l=function(r){n(r)};c.get("/resources/slmservices/advise/requirements/parameters",m,p,l)}else{n("Empty object id array")}})};e.getTestExecutionsForTestCase=function(k){return new g(function(o,n){if(k.length>0){var q="";k.forEach(function(r){q+=q.length>0?";"+r:r});var m={objectids:q},p=function(r){o(r.response)},l=function(r){n(r)};c.get("/resources/slmservices/advise/testcases/testexecutions",m,p,l)}else{n("Empty object id array")}})};e.copy=function(k,l){return new g(function(p,o){var n={caseid:k,title:l,},q=function(r){p(r.response)},m=function(r){o(r)};c.post("/resources/slmservices/advise/copy",JSON.stringify(n),q,m)})};e.revise=function(k){return new g(function(o,n){var m={data:[{physicalid:k}],folderid:null},p=function(q){o(q.response)},l=function(q){n(q)};c.post("/resources/lifecycle/revise/major",JSON.stringify(m),p,l)})};e.deleteCase=function(k){return new g(function(o,n){var m={objectids:k},p=function(q){o(q.response)},l=function(q){n(q)};c.del("/resources/slmservices/advise",JSON.stringify(m),p,l)})};e.getCaseInfo=function(k){return new g(function(o,n){var m={oid:k},p=function(q){o(q)},l=function(q){n(q)};c.get("/resources/slmservices/advise/caseInfo",m,p,l)})};e.getHistory=function(k){return new g(function(o,n){var m={objectid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.get("/resources/slmservices/advise/history",m,p,l)})};e.demote=function(k){return new g(function(o,n){var m={objectid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.post("/resources/slmservices/advise/demote",JSON.stringify(m),p,l)})};e.promote=function(k){return new g(function(o,n){var m={objectid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.post("/resources/slmservices/advise/promote",JSON.stringify(m),p,l)})};e.saveRAECaseData=function(k,m){var l=[];Object.keys(m).forEach(function(p){var s="application/json";if(p.endsWith(".tsv")){s="application/text"}var q=m[p];var o=new Blob([q],{type:s});var n=null;try{n=new File([o],p)}catch(r){n=o;n.name=p;n.lastModifiedDate=new Date()}l.push(e.uploadFileTo3DSpace({oId:k,title:p,file:n}))},this);return new g(function(o,n){g.all(l).then(function(){o()},function(){n()})})};e.uploadFileTo3DSpace=function(l){var k=g.deferred();l.store="STORE";l.action="checkin";l.format="generic";e.getFCSTicket(l).then(function(m){var p=function(q){var r=q.responseText;e.fcsCommit(r).then(function(s){k.resolve(l.oId)},function(s){i.error("FAILED to commit file ."+l.title);k.reject(s)})},n=function(q){k.reject(q)},o=function(q){};e.fcsCheckin(l,m,p,n,o)},function(m){i.error("FAILED to fetch FCS ticket.");k.reject(m)}.bind(this));return k.promise};e.createDocumentObject=function(l,k){return new g(function(p,o){var n={title:d.is(l)?l:"",description:d.is(k)?k:"",},q=function(r){p(r)},m=function(r){o(r)};c.post("/resources/slmservices/advise/document/create",JSON.stringify(n),q,m)})};e.getFCSTicket=function(k){return new g(function(p,o){var l="/resources/slmservices/fcs/ticket",n={oid:k.oId,fname:k.title,fformat:k.format,action:k.action,store:k.store},q=function(s){var t={},v=s.response;var r=v.split("<Ticket>")[1];if(d.is(r)){t.ticket=r.split("</Ticket>")[0]}else{o("Error getting ticket");return}var u=v.split("<FcsUrl>")[1];if(d.is(u)){t.fcsUrl=u.split("</FcsUrl>")[0]}else{o("Error getting FCS URL");return}p(t)},m=function(r){o(r)};c.get(l,n,q,m)})};e.fcsCheckin=function(m,n,k,l,p){var o=new FormData(),q=new XMLHttpRequest();o.append("csrfTokenName","ENO_CSRF_TOKEN");o.append("noOfFiles","1");o.append("__fcs__jobTicket",n.ticket);if(m.file instanceof Blob){o.append("file",m.file,m.file.name)}else{o.append("bfile0",m.file);o.append("fileName0",m.file.name);o.append("format0","generic")}if(p&&q.upload){q.upload.onprogress=p}q.onreadystatechange=function(){if(q.readyState!==4){return}if(q.status===200){k(q)}else{if(l){l(q)}}};q.open("POST",n.fcsUrl,true);q.send(o)};e.fcsCommit=function(k){return new g(function(n,m){var o=function(q){n(q)},l=function(q){m(q)};var p={Accept:"text/plain"};c.put("/resources/slmservices/fcs/commit",k,o,l,undefined,p)})};e.downloadFile=function(o,n,k,m,l){return new g(function(q,p){if(d.is(o)&&d.is(k)){}else{i.error("Invalid input parameters provided for file download");p()}var r={action:"download",title:o,oId:k};e.getFCSTicket(r).then(function(t){var s={ticket:encodeURIComponent(t.ticket),fileExtension:n,url:t.fcsUrl};e.download(s,l).then(function(u){q(u)},function(u){p(u)})},function(s){p(s)})})};e.download=function(k,l){return new g(function(p,o){if(d.is(k.ticket)&&d.is(k.fileExtension)){}else{i.error("Invalid / empty ticket for file download");o()}var m=k.url,n=new XMLHttpRequest(),q="__fcs__jobTicket="+k.ticket+"&__fcs__attachment=false";if(!d.is(m)){m="servlet/fcs/checkout"}n.onload=function(t){if(n.readyState===4){if(n.status===200){var s=new Blob([this.response],{type:"application/"+k.fileExtension}),r=window.URL||window.webkitURL;if(l===true){p(s)}else{p(r.createObjectURL(s))}}else{o()}}};n.open("POST",m,true);n.setRequestHeader("Cache-Control","no-cache");n.setRequestHeader("Content-type","application/x-www-form-urlencoded");n.responseType="arraybuffer";n.send(q)})};e.listFiles=function(k){return new g(function(o,n){var m={caseid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.get("/resources/slmservices/advise/files",m,p,l)})};e.checkCaseForObjectIds=function(k){return new g(function(o,n){var m={objectids:k},p=function(q){o(q.response)},l=function(q){n(q)};c.post("/resources/slmservices/advise/checkCaseForObjectIds",JSON.stringify(m),p,l)})};e.isAuthorized=function(k,l){return new g(function(p,o){if(!d.is(l)){l=""}var n={appNames:k},q=function(r){p(r.response)},m=function(r){o(r)};c.get(l+"/resources/slmservices/license",n,q,m)})};e.getSecurityContexts=function(k){return new g(function(n,m){if(!d.is(k)){k=""}var o=function(p){n(p.response)},l=function(p){m(p)};c.get(k+"/resources/bps/cspaces",null,o,l)})};e.checkoutEssentialsData=function(k){return new g(function(n,m){var o=function(p){n(p.response)},l=function(p){m(p)};c.get("/resources/slmservices/advise/"+k+"/checkoutRAEData",null,o,l)})};e.downloadRAEData=function(k){return new g(function(m,l){e.checkoutEssentialsData(k).then(function(o){var n={ticket:encodeURIComponent(o.exportString),fileExtension:"zip",url:o.actionURL};e.download(n,false).then(function(p){e.importBlobURLToZip(p).then(function(r){window.URL.revokeObjectURL(p);if(d.is(r)){var s=r.root.children,q=[];s.forEach(function(v){var w=v.name.split("."),u=w[0],x=w[1],t={fileName:u,fileExtension:x,zipFileEntry:v};q.push(e.importZipFileEntryToBlob(t))});if(q.length>0){g.all(q).then(function(t){var u={};t.forEach(function(v){u[v.name]=v.blob});m(u)},function(t){i.error("downloadRAEData - zipPromises",t);l(t)})}else{i.error("downloadRAEData - zipPromises NO DATA");l("no data")}}else{i.error("downloadRAEData - extractedData NO DATA");l("no data")}},function(q){i.error("downloadRAEData - importBlobURLToZip",q);l(q)})},function(p){i.error("downloadRAEData - download",p);l(p)})},function(n){i.error("downloadRAEData - checkoutEssentialsData",n);l(n)})})};e.importZipFileEntryToBlob=function(m){var l=m.fileName||"",p=m.fileExtension||"",o=f(p),k=g.deferred();try{m.zipFileEntry.getBlob(o,function(q){k.resolve({name:l,blob:q})})}catch(n){k.reject(n)}return k.promise};e.importBlobURLToZip=function(k){return new g(function(o,n){if(d.is(k)){h.workerScriptsPath="scripts/ThreeDS/Visualization/zip-js/";var m=new h.fs.FS(),l={serverurl:"",filename:k,proxyurl:"none"};m.importHttpContent(l,false,function(){o(m)},function(){i.error("Failure importing to Zip FS");n()})}else{n()}})};e.getAttributeAndPLMDataForObjects=function(k){return new g(function(o,n){if(k.length>0){var q="";k.forEach(function(r){q+=q.length>0?";"+r:r});var m={objectids:q},p=function(r){o(r.response)},l=function(r){n(r)};c.get("/resources/slmservices/advise/getAttributesAndPLMParameters",m,p,l)}else{n("Empty object id array")}})};e.checkout=function(l,m){var k="";m.forEach(function(n){k+=k.length>0?";"+n:n});return new g(function(q,p){var o={fnames:k},r=function(s){q(s.response)},n=function(s){p(s)};c.get("/resources/slmservices/advise/"+l+"/checkout",o,r,n)})};e.getProcessImage=function(k){return new g(function(o,n){var m=[k],p=function(q){o(q.response)},l=function(q){n(q)};c.post("/resources/slmservices/simulations/filter",JSON.stringify(m),p,l)})};e.getObjectInfo=function(k){return new g(function(o,n){if(k.length>0){var q="";k.forEach(function(r){q+=q.length>0?";"+r:r});var m={objectids:q},p=function(r){o(r.response)},l=function(r){n(r)};c.get("/resources/slmservices/advise/attributes",m,p,l)}else{n("Empty object id array")}})};e.getThumbnail=function(k){return new g(function(o,n){var m={physicalid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.get("/resources/lifecycle/revision/family",m,p,l)})};e.getCSRF=function(){return new g(function(m,l){var n=function(o){m(o.response)},k=function(o){l(o)};c.get("/resources/slmservices/token/CSRF",null,n,k)})};e.getCESTAMP=function(k){return new g(function(o,n){var m={objectid:k},p=function(q){o(q.response)},l=function(q){n(q)};c.get("/resources/slmservices/advise/cestamp",m,p,l)})};return e});define("DS/SMAAnalyticsCommon/SMAAnalyticsLoadUtils",["UWA/Core","UWA/Utils","DS/Logger/Logger","module","DS/WebappsUtils/WebappsUtils","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(d,e,b,a,c,i,g){var h=b.getLogger(a);var f={currentCase:null,ThreeDSpaceUrl:null,initialized:false,currentContext:null,currentTenant:null,appName:null,setCurrentTenant:function(j){this.currentTenant=j},getCurrentTenant:function(){return this.currentTenant},setCurrentContext:function(j){this.currentContext=j},getCurrentContext:function(){return this.currentContext},get3DSpaceUrl:function(){return this.ThreeDSpaceUrl!==null?this.ThreeDSpaceUrl:c.getWebappsBaseUrl()},isAuthorized:function(j){var k=this;return new Promise(function(m,l){i.isAuthorized(k.appName,k.ThreeDSpaceUrl).then(function(p){if(j in p&&p[j]==="true"){var o=p.csrf||{};var n={};if(d.is(o.name)&&(d.is(o.value)||d.is(o.CSRFToken))){n.csrf={name:o.name,value:o.CSRFToken||o.value}}m(n)}else{h.error("Unauthorized");l()}},function(n){h.error(n);l()})})},isEncoded:function(j){j=j||"";return j!==decodeURIComponent(j)},getSecurityContexts:function(){var j=this;return new Promise(function(l,k){i.getSecurityContexts(j.ThreeDSpaceUrl).then(function(o){var m=o&&o.cspaces||[];var n=widget.getPreference("createcollabspaces");n.options=m.map(function(q,p){if(q.isDefault||p===0){n.defaultValue=q.name;widget.setValue("collabspaces",q.name);j.setCurrentContext(q.name)}return{value:q.name,label:q.displayName}});widget.addPreference(n);l()},function(m){h.error(m);k()})})},initialize:function(k,j){var l=this;return new Promise(function(n,m){if(l.initialized===false){l.appName=j;l.setCurrentTenant(k);require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/Windows/ImmersiveFrame"],function(q,p,o){q.getServiceUrl({serviceName:"3DSpace",platformId:k,onComplete:function(s){var r=(typeof s==="string")?s:s[0].url;l.ThreeDSpaceUrl=r;l.getSecurityContexts().then(l.isAuthorized.bind(l,l.appName)).then(function(t){l.initialized=true;p.initialize(null,true,d.is(t.csrf)?t.csrf.value:null,l.ThreeDSpaceUrl,k);var u=new o({identifier:"LandingPageImmersiveFrame"}).inject(document.body);p.setImmersiveFrame(u);n(l.ThreeDSpaceUrl)},m)["catch"](function(t){h.error(t);m(t)})},onFailure:function(r){h.error(r);m("Initializing i3DXCompassPlatformServices failure")}})},function(o){h.error(o);m("Initializing i3DXCompassPlatformServices require failure")})}else{l.getSecurityContexts().then(n,n)}})}};return f});define("DS/SMAAnalyticsCommon/SMAAnalyticsFileUtils",["UWA/Core","DS/Logger/Logger","module","DS/ZipJS/zip-fs","UWA/Class/Promise","DS/SMAAnalyticsCommon/SMAAnalyticsWSUtil","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(d,b,a,h,g,c,j){var e={},i=b.getLogger(a),f=function(l){var k="";switch(l.toLowerCase()){case"csv":k="text/csv";break;case"json":k="application/json";break;case"jpg":k="image/jpeg";break;case"png":k="image/png";break;default:k="";break}return k};e.checkout=function(l,m){var k="";m.forEach(function(n){k+=k.length>0?";"+n:n});return new g(function(q,p){var o={fnames:k},r=function(s){q(s.response)},n=function(s){i.error("checkout ",s);p(s)};c.get("/resources/slmservices/advise/"+l+"/checkout",o,r,n)})};e.download=function(k,l){return new g(function(p,o){if(d.is(k.ticket)&&d.is(k.fileExtension)){}else{i.error("Invalid / empty ticket for file download");o()}var m=k.url,n=new XMLHttpRequest(),q="__fcs__jobTicket="+k.ticket+"&__fcs__attachment=false";if(!d.is(m)){m="servlet/fcs/checkout"}n.onload=function(t){if(n.readyState===4){if(n.status===200){var s=new Blob([this.response],{type:"application/"+k.fileExtension}),r=window.URL||window.webkitURL;if(l===true){p(s)}else{p(r.createObjectURL(s))}}else{o()}}};n.open("POST",m,true);n.setRequestHeader("Cache-Control","no-cache");n.setRequestHeader("Content-type","application/x-www-form-urlencoded");n.responseType="arraybuffer";n.send(q)})};e.importBlobURLToZip=function(k){return new g(function(o,n){if(d.is(k)){h.workerScriptsPath="scripts/ThreeDS/Visualization/zip-js/";var m=new h.fs.FS(),l={serverurl:"",filename:k,proxyurl:"none"};m.importHttpContent(l,false,function(){o(m)},function(){i.error("Failure importing to Zip FS");n()})}else{n()}})};e.unzip=function(n){var o=this;var k=function(q,p){return new g(function(s,r){h.createReader(new h.BlobReader(q),function(t){t.getEntries(function(u){s(p(u))})},function(t){i.error(t);r(t)})})},m=function(p,q){return new g(function(t,s){var r=new h.BlobWriter();p.getData(r,function(v){var u=new FileReader();u.onloadend=function(w){t({name:p.filename,content:this.result})};u.readAsDataURL(v)})})};return k(n,function l(p){return g.all(p.map(function(q){return m(q,"Blob")}))})};e.importZipFileEntryToBlob=function(m){var l=m.fileName||"",p=m.fileExtension||"",o=f(p),k=g.deferred();try{m.zipFileEntry.getBlob(o,function(q){k.resolve({name:l,blob:q})})}catch(n){k.reject(n)}return k.promise};e.downloadFiles=function(l,k,m){return new g(function(p,o){var n="";if(k.length>0){k.forEach(function(q){n+=n.length>0?";"+q:q});e.checkout(l,k).then(function(r){var q={ticket:encodeURIComponent(r.exportString),fileExtension:"zip",url:r.actionURL};e.download(q,d.is(m)?m:false).then(function(s){if(d.is(m)&&m===true){e.unzip(s).then(p,o)}else{e.importBlobURLToZip(s).then(function(u){if(!d.is(u)){i.error("downloadRAEData - zipPromises NO DATA");o("NO DATA")}else{var v=u.root.children,t=[];v.forEach(function(y){var z=y.name.split("."),x=z[0],A=z[1],w={fileName:x,fileExtension:A,zipFileEntry:y};t.push(e.importZipFileEntryToBlob(w))});g.all(t).then(function(w){var x={};w.forEach(function(y){x[y.name]=y.blob});p(x)},function(w){i.error("downloadRAEData - zipPromises",w);o(w)})}if(t.length==0){i.error("downloadRAEData - zipPromises NO DATA");o("NO DATA")}})}},o)})}else{i.error("empty file names");o("empty file names")}})};return e});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsApproximationDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/SMAAnalyticsCommon/dialogs/views/SMAAnalyticsApproximationView","i18n!DS/SMAAnalyticsNLS/assets/nls/SMAAnalyticsWidgetNLSfile"],function(f,b,a,c,d){var e={showDialog:function(j,g,k){var h=function(l){var m=f.createElement("div",{id:"caseApproximation"});var n=c.render(l);m.appendChild(n);return m};var i=new b({title:d.RA_CASE_APPROXIMATION+j,content:h(g),minWidth:600,minHeight:400,resizableFlag:true,modalFlag:true,allowMaximizeFlag:false,maximizeButtonFlag:false,immersiveFrame:k,usePaddingFlag:true,buttons:{Ok:new a({label:d.CLOSE,onClick:function(n){var l=n.dsModel;var m=l.dialog;m.close()}})}})}};return e});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsHistoryDialog",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/SMAAnalyticsCommon/dialogs/views/SMAAnalyticsHistoryView","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(f,d,c,b,e){var a={showDialog:function(i,k,j){var g=function(n){var l=f.createElement("div",{id:"caseHistory"});var m=b.render(n);l.appendChild(m.getContent());return l};var h=new d({title:e.get("RA_CASE_HISTORY")+" - "+i,content:g(k),minWidth:600,minHeight:400,resizableFlag:true,modalFlag:true,allowMaximizeFlag:false,maximizeButtonFlag:false,immersiveFrame:j,usePaddingFlag:true,buttons:{Ok:new c({label:e.get("CLOSE"),onClick:function(n){var l=n.dsModel;var m=l.dialog;m.close()}})}})}};return a});define("DS/SMAAnalyticsCommon/SMAAnalyticsUtils",["UWA/Core","UWA/String","DS/UIKIT/Mask","DS/Logger/Logger","module","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","DS/SMAAnalyticsCommon/SMAAnalyticsCase","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsCaseDialog","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy","DS/SMAAnalyticsCommon/SMAAnalyticsWSUtil","DS/WebappsUtils/WebappsUtils","DS/SMAVenMathJS/VenMath"],function(j,s,t,q,c,i,p,h,a,d,l,b,g,m){var r=q.getLogger(c);var e=function(){var u={immersiveFrame:n.getImmersiveFrame(),header:i.get("CREATE_CASE"),okButtonLabel:i.get("CREATE_CASE_BUTTON")};return new Promise(function(w,v){d.showDialog(u).then(function(y,x){w(y,x)})})};var k=function(){return new Promise(function(w,v){var u=widget.data.objectIds;if(u){o(u).then(w,v)}else{w()}})};var o=function(u){return new Promise(function(y,x){var w=[],v;if(u.indexOf("|")!==-1){w=u.split("|")}else{w.push(u)}if(w.length>0){l.checkCaseForObjectIds(w).then(function(z){var A=z.newCase;if(A){p.initialize();p.create(z.newCaseName).then(function(C){var B=C.caseId;p.setCaseId(B);var D="";if(w.length===1){D=w[0]}else{w.forEach(function(E){D+=E+";"})}p.connect(D).then(function(){widget.data.caseID=B;y()},function(E){y()})},function(B){y()})}else{widget.data.caseID=z.caseId;y()}},function(z){y()})}})},f;var n={ANALYTICS_CASE:"Analytics Case",initialize:function(y,w,u,x,v){f=this;f.skeleton=y;f.maskContent=widget.body;f.RAE=j.is(w)?w:false;f.RAELimit=50;f.immersiveFrame=null;f.THREEDSpaceUrl=j.is(x)?x:null;f.currentPlatformId=v;b.ENO_CSRF_TOKEN=j.is(u)?u:null;b.THREEDSpaceUrl=j.is(x)?x:null;f.createSPSearch()},mask:function(u){if(!j.is(f.maskContent)){f.maskContent=widget.body}if(!t.isMasked(f.maskContent)){t.mask(f.maskContent,j.is(u)?u:"")}},unmask:function(){if(t.isMasked(f.maskContent)){t.unmask(f.maskContent)}},setMaskContent:function(u){f.maskContent=u},get3DSpaceUrl:function(){return f.THREEDSpaceUrl},reroute:function(u){if(f.skeleton.getState()==="collapsed"){f.skeleton.setContractedLayout().then(function(){f.skeleton.setRoute(u)})}else{f.skeleton.setRoute(u)}},setSkeleton:function(u){f.skeleton=u},getSkeleton:function(){return f.skeleton},_initNotifManager:function(){this._notificationManager=h;a.setNotificationManager(this._notificationManager);a.setFadeOutPolicy(1);a.setStackingPolicy(0)},isRAE:function(){return f.RAE},getModifiedInterval:function(y){try{if(!isNaN(y)){y=parseInt(y)}var w=new Date(y),v=Date.now(),u=(v-w.getTime())/1000;var z=Math.round(u/86400);if(z==1){return(z.toString()+" "+i.get("DAY_AGO"))}else{if(z>=1){return(z.toString()+" "+i.get("DAYS_AGO"))}else{if((z=Math.round(u/3600))==1){return z.toString()+" "+i.get("HR_AGO")}else{if((z=Math.round(u/3600))>=1){return(z.toString()+" "+i.get("HRS_AGO"))}else{if((z=Math.round(u/60))==1){return(z.toString()+" "+i.get("MIN_AGO"))}else{if((z=Math.round(u/60))>=1){return(z.toString()+" "+i.get("MINS_AGO"))}else{return(z.toString()+" "+i.get("SECS_AGO"))}}}}}}}catch(x){return"1"+i.get("SECS_AGO")}},getFormattedDate:function(u){var v=new Date(u);return v.toDateString()+" "+v.toLocaleTimeString()},cloneAnalyticsCaseModel:function(v,u){return new Promise(function(x,w){require(["DS/SMAAnalyticsCommon/SMAAnalyticsCase"],function(y){y.initialize({caseId:v});y.getInfo(v).then(function(B){try{B.id=v;var z=j.is(u)?u.collection:widget.__caseCollection__;if(!z){z=u.model.collection}x(z.addNewCaseModel(B))}catch(A){w()}},function(){w()})})})},showErrorNotification:function(x,v,u){if(!j.is(this._notificationManager)){this._initNotifManager()}var w={level:"error",sticky:false};w.title=j.is(x,"string")?x:"";w.message=j.is(v,"string")?v:get("RA_ERROR");if(j.is(u,"string")&&u.length>0){w.category=u}this._notificationManager.addNotif(w)},showWarningNotification:function(x,v,u){if(!j.is(this._notificationManager)){this._initNotifManager()}var w={level:"warning",sticky:false};w.title=j.is(x,"string")?x:"";w.message=j.is(v,"string")?v:get("RA_ERROR");if(j.is(u,"string")&&u.length>0){w.category=u}this._notificationManager.addNotif(w)},showInfoNotification:function(x,v,u){if(!j.is(this._notificationManager)){this._initNotifManager()}var w={level:"info",sticky:false};w.title=j.is(x,"string")?x:"";w.message=j.is(v,"string")?v:"";if(j.is(u,"string")&&u.length>0){w.category=u}this._notificationManager.addNotif(w)},showSuccessNotification:function(x,v,u){if(!j.is(this._notificationManager)){this._initNotifManager()}var w={level:"success",sticky:false};w.title=j.is(x,"string")?x:"";w.message=j.is(v,"string")?v:"";if(j.is(u,"string")&&u.length>0){w.category=u}this._notificationManager.addNotif(w)},createSPSearch:function(u){Polymer.Base.importHref([g.getWebappsBaseUrl()+"SMAProcSP/sp-search/sp-search.html"],function(){f.spSearch=j.createElement("sp-search",{id:"RAEspSearch"})})},getSPSearch:function(v,u){if(j.is(f.lastOnChange)){f.spSearch.removeEventListener("change",f.lastOnChange)}f.lastOnChange=v;f.spSearch.multiSelect=true;f.spSearch.addEventListener("change",f.lastOnChange);return f.spSearch},getImmersiveFrame:function(){return f.immersiveFrame},setImmersiveFrame:function(u){f.immersiveFrame=u},isTransientWidget:function(){var u=widget.id,v="preview-";if(u&&(u.substr(0,v.length)===v)){this.showWarningNotification("",i.get("TRANSIENT_MODE_WARNING"));return true}return false},collectionPostProcessing:function(w){if(j.is(widget._RA_FIRST_TIME_LOADING_)&&widget._RA_FIRST_TIME_LOADING_){widget._RA_FIRST_TIME_LOADING_=false}else{return}var y=widget.body;if(t.isMasked(y)){t.unmask(y)}var x={caseid:widget.data.sesscaseid,servanttoken:widget.data.sesstoken,eedjobid:widget.data.sessjobid,eedServer:widget.data.sesseed,eer:widget.data.sessstation};if(j.is(x.caseid)&&j.is(x.servanttoken)&&j.is(x.eedServer)&&j.is(x.eedjobid)){widget._joinexsession_=true;var v={};v[x.caseid]=[];this.createNewCase(w,v);widget._RA_}else{var u=widget.data.caseID||widget.getValue("lastactivecase");if(u){var v={};v[u]=[];this.createNewCase(w,v)}}},showCaseCreateDialog:function(v){var u={immersiveFrame:f.getImmersiveFrame(),label:i.get("TITLE"),header:i.get("CREATE_CASE"),okButtonLabel:i.get("CREATE_CASE_BUTTON"),showToggle:j.is(v)?v:false};return new Promise(function(x,w){d.showDialog(u).then(function(z,y){x(z,y)})})},createNewCase:function(v,x){var w=this;if(j.is(x)){var y=[];for(var u in x){if(x.hasOwnProperty(u)){y.push(w.cloneAnalyticsCaseModel.call(this,u,v))}}Promise.all(y).then(function(z){if(Array.isArray(z)&&j.is(z[0])){if(widget._joinexsession_){widget._joinexsession_===false;var A=this.getSkeleton();if(j.is(A)){A.setRoute("/analyticscases/"+z[0].get("id")+"/?f=3&joinexsession=true")}}else{v.selectItemView(z[0])}}},function(){r.warn("Failed to update the case collection...")}.bind(this))}},textSanitize:function(v,u){var w=/[.'"#$@%*,?\\<>[\]|:]/;v=v.trim();if(j.is(v,"string")&&v.length>0){if(j.is(u)&&w.test(v)){return""}if(!isNaN(parseFloat(v))){return v}else{if(s.escapeHTML(v)===v){return v}return""}}else{if(j.is(v,"number")){return v}}return""},getFileExtension:function(u){var v,w="";v=u.match(/\.([^.]+)$/);if(v!==null&&v.length===2){w=v[0].toLowerCase()}return w},_getDroppedFiles:function(x,v){var z=[];var y=[];var w;if(!j.is(x)){return[]}if(j.is(x.dataTransfer)&&j.is(x.dataTransfer.files)){w=x.dataTransfer.files}else{if(j.is(x.target)&&j.is(x.target.files)){w=x.target.files}}if(w.length>0){for(var u=0;u<w.length;u++){if(v.indexOf(f.getFileExtension(w[u].name))>-1){z.push(w[u])}else{y.push(w[u])}}}return{validObjects:z,invalidObjects:y,}},_getDroppedObjects:function(y,z,C){var v=[],A=[],B=[];var x=y.dataTransfer.getData("text");if(!j.is(x)||(j.is(x)&&x.length===0)){x=y.dataTransfer.getData("text/searchitems")}if(j.is(x,"string")&&x.length>0){try{x=JSON.parse(x);x=x.data}catch(w){x=undefined}}else{if(j.is(x,"object")){x=x.data}else{x=undefined}}var u=undefined;if(j.is(C)){u=f._getDroppedFiles(y,C)}if(j.is(x)&&Array.isArray(x.items)){x.items.forEach(function(D){if(z.indexOf(D.objectType)>-1){v.push(D)}else{if(D.objectType==="Analytics Case"){B.push(D)}else{A.push(D)}}})}return{validObjects:j.is(C)?v.concat(u.validObjects):v,invalidObjects:j.is(C)?A.concat(u.invalidObjects):A,analyticsCaseObjects:B}},_getSearchedObjects:function(v,u){var x=[];var w=[];if(Array.isArray(v)&&v.length>0){v.forEach(function(y){if(u.indexOf(y.objectTypeValue)>-1||u.indexOf(y.objectType)>-1){x.push(y)}else{w.push(y)}})}return{validObjects:x,invalidObjects:w,}},validateObjects:function(A,B,C,v,u){var y=[],z=j.is(u)?u:false;switch(v){case"upload":y=f._getDroppedFiles(A,C);break;case"drop":y=f._getDroppedObjects(A,B,C);break;case"search":y=f._getSearchedObjects(A,B);break}if(j.is(y)&&y.validObjects.length>0){if(j.is(y.analyticsCaseObjects)&&y.analyticsCaseObjects.length>0){y.validObjects=[];if(z===false){f.showErrorNotification("",i.get("INVALID_DS"))}}else{var w=0,x=0;y.validObjects.forEach(function(E){var D="";if(j.is(E.objectTypeValue)){D=E.objectTypeValue}else{D=E.objectType}if(D==="Requirement"){w++}else{if(D==="Test Case"){x++}}});if(w>0&&w===y.validObjects.length){}else{if(x===1&&x===y.validObjects.length){}else{if(w===0&&x===0){}else{y.validObjects=[];f.showErrorNotification("",i.get("INVALID_DS"))}}}}if(y.invalidObjects.length>0){if(z===false){f.showInfoNotification("",i.get("SOME_INVALID_DS"))}}}else{if(j.is(y)&&j.is(y.analyticsCaseObjects)&&y.analyticsCaseObjects.length===1){if(y.invalidObjects.length>0){if(z===false){f.showErrorNotification("",i.get("INVALID_DS"))}}y.validObjects=y.analyticsCaseObjects}else{if(z===false){f.showErrorNotification("",i.get("INVALID_DS"))}}}return y.validObjects},formatResponse:function(v,w){var x=Object.keys(v)[0],u={caseId:x,connectedData:v[x],data:j.is(w)?w:[]};return u},precise:function(w,y,v){var x=j.is(y)?y:widget.getValue("notation"),u=j.is(v)?v:parseInt(widget.getValue("precision"));if(j.is(w)&&w!==""&&!isNaN(w)){w=parseFloat(w);return m.format(parseFloat(w),{notation:x,precision:u})}else{return""}},scientificToDecimal:function(u){if(isNaN(parseFloat(u))){return""}return m.format(parseFloat(u),{notation:"fixed",precision:parseInt(widget.getValue("precision"))})},getCurrentPlatformId:function(){return f.currentPlatformId},setUserSpecificSecCtx:function(x,w){function v(C,F){for(var E=0;E<C.length;E++){var D=F(C[E]);if(D){return C[E];break}}}var B=["ctx::VPLMProjectLeader","ctx::VPLMCreator","ctx::VPLMExperimenter"],u=widget.getPreference("createcollabspaces").options;var y=undefined;widget.setValue("collabspaces",widget.getValue("createcollabspaces"));for(var z=0;z<B.length;z++){var A=B[z]+"."+x+"."+w;y=v(u,function(C){return C.value===A});if(j.is(y)){break}}if(j.is(y)){widget.setValue("collabspaces",y.value)}}};return n});define("DS/SMAAnalyticsCommon/SMAAnalyticsCustomView",["UWA/Core","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Layout/ListView","DS/SMAAnalyticsCommon/SMAAnalyticsUtils"],function(f,j,i,g,h,b){var d="onAddToCollectionEvent";var a=function(){if(!this.hasEvent(d)){this.addEvent(d,function(k){if(f.is(k)&&f.is(k.detail)){h.createNewCase(this,k.detail)}}.bind(this))}if(!this.collection.hasEvent("onSync")){this.listenTo(this.collection,{onSync:function(){h.collectionPostProcessing(this)}.bind(this)})}this._parent.apply(this,arguments)};var e=function(l,k){widget.setValue("lastactivecase",k.model.get("id"))};var c={AnalyticsGridScrollView:j.extend({onRender:a,onItemViewSelect:e}),AnalyticsTableScrollView:i.extend({onRender:a,onItemViewSelect:e}),AnalyticsListView:g.extend({onRender:a,onItemViewSelect:e})};return c});define("DS/SMAAnalyticsCommon/SMAAnalyticsReqUtils",["UWA/Core","UWA/Utils","DS/Logger/Logger","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","module",],function(d,e,b,i,g,f,a){var h=b.getLogger(a);var c={getRowFormulationContents:function(l){var q=l.objective,n=l.constraints;var s=document.createElement("div");s.classList.add("row-formulation-button");if(q||n){s.classList.add("row-has-formulation");s.appendChild(this.getPriorityAsHTML(l));if(q){var k=l.objective.type;var j=l.objective.value;s.appendChild(this.getObjectiveAsHTML(k,j))}if(n){var o=null,r=null;n.forEach(function(u){if(u.conditions){u.conditions.forEach(function(v){if(v.type==="GREATER_THAN"){o=v.boundValue}else{if(v.type==="LESS_THAN"){r=v.boundValue}}})}});var t=document.createElement("span");t.classList.add("ra-constraints-wrapper");var p=this.getConstraintsAsHTML(o,r);t.appendChild(p);s.appendChild(t)}}else{var m=document.createElement("span");if(l.source=="Dataset"){m.setAttribute("style","cursor:default;")}else{m.classList.add("fonticon");m.classList.add("fonticon-pencil");m.setAttribute("title",f.get("EDIT"))}s.appendChild(m)}return s},getPriorityAsHTML:function(k){var j=document.createElement("span");j.classList.add("ra-parameter-priority");var l=k.priority,m=k.priority;j.classList.add("ra-parameter-priority-"+l);if(l===0){l="!";m=f.get("MUST_HAVE_TITLE")}else{m=f.get("PRIORITY")+" "+l}j.textContent=l;j.title=m;return j},getObjectiveAsHTML:function(n,l){var k=document.createElement("span");k.classList.add("ra-objective-wrapper");n=n.toUpperCase();var m=document.createElement("span");m.classList.add("ra-objective-label");m.classList.add("fonticon");if(n==="MAXIMIZE"){m.classList.add("fonticon-up-bold")}else{if(n==="MINIMIZE"){m.classList.add("fonticon-down-bold")}else{if(n==="TARGET"){m.classList.add("fonticon-target")}}}m.title=f.get(n);k.appendChild(m);if(n==="TARGET"&&typeof l!=="undefined"){var j=document.createElement("span");j.textContent="="+g.precise(l);k.appendChild(j)}return k},getConstraintsAsHTML:function(j,k){var l=document.createElement("span");l.classList.add("ra-constraint-label");if(j!==null&&k!==null){l.textContent="["+g.precise(j)+", "+g.precise(k)+"]"}else{if(j!==null){l.textContent="> "+g.precise(j)}else{if(k!==null){l.textContent="< "+g.precise(k)}}}return l}};return c});define("DS/SMAAnalyticsCommon/SMAAnalyticsOpenInApp",["UWA/Core","UWA/Class","DS/Logger/Logger","module","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(e,c,b,d,g,h){var a=null;var f=c.extend({init:function(j){a=this;a.options=j||{};var l="SecurityContext",i=["collabspaces","collabspace"];var k=null;if(!k&&window.widget&&window.widget.getValue){i.some(function(m){k=window.widget.getValue(m);return k})}a.options.context=k},openInApp:function(j,i,n){var l=window.widget.getValue("x3dPlatformId");if(!l){l="OnPremise"}var m={contextId:a.options.context,envId:l,objectId:j,objectType:i,serviceId:"3DDashboard"};var k={protocol:"3DXContent",version:"1.0",source:a.options.sourceApp,data:{items:[m]}};require(["UWA/Utils/InterCom"],function(o){var q="com.ds."+window.widget.id;var p=new o.Socket(q);p.subscribeServer("com.ds.compass",window.parent);p.dispatchEvent("onSetObject",m,q);p.dispatchEvent("onSetX3DContent",k,q);p.addListener("launchApp",(function(r,s){if(r.response==="COMPLETE"){g.showInfoNotification("",h.get("OPEN_NATIVE_COMPLETE"))}if(r.response!=="COMPLETE"){g.showErrorNotification("",h.get("OPEN_NATIVE_ERROR"))}p.dispatchEvent("onResetObject",{},q);p.dispatchEvent("onResetX3DContent",{},q);p.disconnect();delete a.compassEventSocket}));p.dispatchEvent("onLaunchApp",{appId:n},q);g.showInfoNotification("",h.get("OPENING_NATIVE_APP"))})}});return f});define("DS/SMAAnalyticsCommon/SMAAnalyticsFormulationUI",["UWA/Core","DS/Logger/Logger","module","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/Windows/Dialog","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","css!DS/SMAAnalyticsCommon/dialogs/views/SMAAnalyticsFormulationUI"],function(e,d,b,h,a,c,l,k,j){var g=null,i=d.getLogger(b),f=e.Class.extend({init:function(m){g=this;g.header=e.is(m)&&e.is(m.header)?m.header:"";g.changes={parameterId:m.id};g.priority=e.is(m)&&e.is(m.priority)?m.priority:1;g.objective=e.is(m)&&e.is(m.objective)?m.objective:"";g.lowerThreshold=e.is(m)&&e.is(m.lowerThreshold)?m.lowerThreshold:"";g.upperThreshold=e.is(m)&&e.is(m.upperThreshold)?m.upperThreshold:"";g.target=e.is(m)&&e.is(m.target)?m.target:"";g.min=e.is(m)&&e.is(m.min)?m.min:"";g.max=e.is(m)&&e.is(m.max)?m.max:"";g.priorityOptions=[j.get("MUST_HAVE"),"1","2","3","4","5"];g.objectiveOptions=[j.get("NONE"),j.get("MINIMIZE"),j.get("MAXIMIZE"),j.get("TARGET")];g.objectiveOptionsValue=["","MINIMIZE","MAXIMIZE","TARGET"];g._setupFormulationUI()},_setupPriorityUI:function(){var o=new a();for(var n=0;n<g.priorityOptions.length;n++){o.addChild(new h({type:"radio",label:g.priorityOptions[n],value:n,checkFlag:n===g.priority,clickMode:1}))}o.addEventListener("change",function m(q){this.changes.priority=parseInt(q.dsModel.value);var p=this._validate(undefined,"ALL");if(p===true){this.enableOK()}}.bind(g));o.inject(this.priorityContainer)},_setupObjectiveUI:function(){var m=new a();for(var o=0;o<g.objectiveOptions.length;o++){m.addChild(new h({type:"radio",label:g.objectiveOptions[o],value:g.objectiveOptionsValue[o],checkFlag:o===g.objectiveOptionsValue.indexOf(g.objective),minWidth:99,clickMode:1}))}m.addEventListener("change",function n(q){this.changes.objective=q.dsModel.value.toString();if(q.dsModel.value.toString()==="TARGET"){this.targetContainer.style.display="block";this.disableOK();if(e.is(this.targetValue)){this.changes.value=this.targetValue;var p=this._validate(undefined,"TT");if(p===true){this.enableOK()}}}else{this.targetContainer.style.display="none";delete this.changes.value;var p=this._validate(undefined,"ALL");if(p===true){this.enableOK()}}}.bind(g));m.inject(this.objectiveContainer)},_setupTargetUI:function(){var n=e.createElement("label",{"class":"raFormulationLabel",text:j.get("TARGET")}),o=new c({placeholder:j.get("TARGET")+"...",value:g.target,requiredFlag:true,pattern:"[0-9.eE+-]+"}),m=e.createElement("div",{"class":"lowerThresholdUI"});this.targetError=e.createElement("div",{});this.targetError.style.display="none";o.addEventListener("change",function(s){s.preventDefault();s.stopPropagation();this.targetError.style.display="none";var q=this.targetError.getChildren();if(q.length>0){this.targetError.removeChild(q[0])}var r=k.scientificToDecimal(parseFloat(o.value));if(isNaN(parseFloat(r))){this.changes.value="";this.target="";this.disableOK();return}this.changes.objective=e.is(this.changes.objective)?this.changes.objective:this.objective;this.changes.value=r.toString();this.targetValue=r.toString();var p=this._validate(r,"TT");if(p===true){this.enableOK()}}.bind(g));o.inject(m);this.targetContainer.appendChild(n);this.targetContainer.appendChild(m);this.targetContainer.appendChild(this.targetError)},_setupLowerThreshold:function(){var n=e.createElement("div",{"class":"lowerThresholdUI"}),m=new c({placeholder:j.get("LOWER_THRESHOLD")+"...",value:g.lowerThreshold,pattern:"[0-9.eE+-]+"});m.addEventListener("change",function(r){r.preventDefault();r.stopPropagation();this.ltError.style.display="none";var p=this.ltError.getChildren();if(p.length>0){this.ltError.removeChild(p[0])}var q=k.scientificToDecimal(parseFloat(m.value));if(isNaN(parseFloat(q))){this.changes.lowerThreshold="";this.lowerThreshold="";this.enableOK();return}this.changes.lowerThreshold=q.toString();var o=this._validate(q,"LT");if(o===true){this.enableOK()}}.bind(g));m.inject(n);return n},_setupUpperThreshold:function(){var n=e.createElement("div",{"class":"lowerThresholdUI"}),m=new c({placeholder:j.get("UPPER_THRESHOLD")+"...",value:g.upperThreshold,pattern:"[0-9.eE+-]+"});m.addEventListener("change",function(r){r.preventDefault();r.stopPropagation();this.utError.style.display="none";var p=this.utError.getChildren();if(p.length>0){this.utError.removeChild(p[0])}var q=k.scientificToDecimal(parseFloat(m.value));if(isNaN(parseFloat(q))){this.changes.upperThreshold="";this.upperThreshold="";this.enableOK();return}this.changes.upperThreshold=q.toString();var o=this._validate(q,"UT");if(o===true){this.enableOK()}}.bind(g));m.inject(n);return n},_setupThresholdUI:function(){var m=e.createElement("div",{"class":"thresholdUI row"}),q=e.createElement("div",{"class":"col-xs-8 col-sm-6"}),o=e.createElement("div",{"class":"col-xs-8 col-sm-6"}),p=e.createElement("label",{"class":"raFormulationLabel",text:j.get("UPPER_THRESHOLD")}),n=e.createElement("label",{"class":"raFormulationLabel",text:j.get("LOWER_THRESHOLD")});this.ltError=e.createElement("div",{"class":"thresholdError"});this.utError=e.createElement("div",{"class":"thresholdError"});this.ltError.style.display="none";this.utError.style.display="none";q.appendChild(n);q.appendChild(this._setupLowerThreshold());o.appendChild(p);o.appendChild(this._setupUpperThreshold());m.appendChild(q);m.appendChild(o);m.appendChild(this.ltError);m.appendChild(this.utError);this.thresholdContainer.appendChild(m)},_setupError:function(p){var o=e.createElement("div",{"class":"errorDiv"}),n=e.createElement("i",{"class":"errorRAE wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attention"}),m=e.createElement("span",{"class":"errorRAE",text:" "+p});o.appendChild(n);o.appendChild(m);return o},_getTarget:function(){var m=undefined;if(isNaN(parseFloat(g.changes.value))){if(!isNaN(parseFloat(g.target))){m=parseFloat(g.target)}}else{m=parseFloat(g.changes.value)}return m},_getLower:function(){var m=undefined;if(isNaN(parseFloat(g.changes.lowerThreshold))){if(!isNaN(parseFloat(g.lowerThreshold))){m=parseFloat(g.lowerThreshold)}}else{m=parseFloat(g.changes.lowerThreshold)}return m},_getUpper:function(){var m=undefined;if(isNaN(parseFloat(g.changes.upperThreshold))){if(!isNaN(parseFloat(g.upperThreshold))){m=parseFloat(g.upperThreshold)}}else{m=parseFloat(g.changes.upperThreshold)}return m},_validate:function(o,q){var m=null,n=null,p=null;switch(q){case"TT":g.lastChange=q;m=g._validateLT(g._getLower());n=g._validateUT(g._getUpper());p=g._validateTarget(o);break;case"LT":g.lastChange=q;m=g._validateLT(o);n=g._validateUT(g._getUpper());p=g._validateTarget(g._getTarget());break;case"UT":g.lastChange=q;m=g._validateLT(g._getLower());n=g._validateUT(o);p=g._validateTarget(g._getTarget());break;default:m=g._validateLT(g._getLower());n=g._validateUT(g._getUpper());p=g._validateTarget(g._getTarget())}return g._validateAll(m,n,p,q)},_validateAll:function(m,n,q,s){var p=true,r=false;if(s==="ALL"&&e.is(g.lastChange)){s=g.lastChange}if(s==="LT"&&m.valid===true){r=true}if(s==="UT"&&n.valid===true){r=true}if(s==="TT"&&q.valid===true){r=true}this.ltError.style.display="none";var o=this.ltError.getChildren();if(o.length>0){this.ltError.removeChild(o[0])}this.utError.style.display="none";var o=this.utError.getChildren();if(o.length>0){this.utError.removeChild(o[0])}this.targetError.style.display="none";var o=this.targetError.getChildren();if(o.length>0){this.targetError.removeChild(o[0])}if(m.valid!==true){this.disableOK();if(s==="LT"||r){r=false;this.ltError.style.display="block";this.ltError.appendChild(this._setupError(m.message))}p=false}if(n.valid!==true){this.disableOK();if(s==="UT"||r){r=false;this.utError.style.display="block";this.utError.appendChild(this._setupError(n.message))}p=false}if(q.valid!==true){this.disableOK();if(s==="TT"||r){r=false;this.targetError.style.display="block";this.targetError.appendChild(this._setupError(q.message))}p=false}return p},_validateTarget:function(p){var o=g._getUpper(),m={valid:true,message:""},n=g._getLower();p=parseFloat(p);if(e.is(n)&&p<n){m.valid=false;m.message=j.get("TARGET_LOWER_THAN_LOWER");return m}if(e.is(o)&&p>o){m.valid=false;m.message=j.get("TARGET_HIGHER_THAN_UPPER");return m}return m},_validateLT:function(o){var n=g._getUpper(),m={valid:true,message:""},p=g._getTarget();o=parseFloat(o);if(e.is(p)&&o>p){m.valid=false;m.message=j.get("LOWER_HIGHER_THAN_TARGET");return m}if(e.is(n)&&o>n){m.valid=false;m.message=j.get("LOWER_HIGHER_THAN_UPPER");return m}return m},_validateUT:function(o){var n=g._getLower(),m={valid:true,message:""},p=g._getTarget();o=parseFloat(o);if(e.is(p)&&o<p){m.valid=false;m.message=j.get("UPPER_LOWER_THAN_TARGET");return m}if(e.is(n)&&o<n){m.valid=false;m.message=j.get("UPPER_LOWER_THAN_LOWER");return m}return m},_setupRange:function(){var m="";if(g.min===g.max){m=k.precise(g.max)}else{m="["+k.precise(g.min)+" ... "+k.precise(g.max)+"]"}var n=e.createElement("div",{"class":"rangeContainer",text:m});this.rangeContainer.appendChild(n)},_setupFormulationUI:function(){g.formulationContainer=e.createElement("div",{id:"formulationContainer","class":"formulationContainer"});g.rangeContainer=e.createElement("div",{id:"rangeContainer","class":"rangeContainer"});var o=e.createElement("label",{"class":"raFormulationLabel",text:j.get("PRIORITY")}),n=e.createElement("label",{"class":"raFormulationLabel",text:j.get("OBJECTIVE")}),m=e.createElement("label",{"class":"raFormulationLabel",text:j.get("RANGE")});g.priorityContainer=e.createElement("div",{id:"priorityContainer","class":"priorityContainer"}),g.objectiveContainer=e.createElement("div",{id:"objectiveContainer","class":"objectiveContainer"}),g.targetContainer=e.createElement("div",{id:"targetContainer","class":"targetContainer"});if(g.objective!=="TARGET"){g.targetContainer.style.display="none"}g.thresholdContainer=e.createElement("div",{id:"thresholdContainer","class":"thresholdContainer"});g._setupPriorityUI();g._setupObjectiveUI();g._setupTargetUI();g._setupRange();g._setupThresholdUI();g.formulationContainer.appendChild(o);g.formulationContainer.appendChild(g.priorityContainer);g.formulationContainer.appendChild(n);g.formulationContainer.appendChild(g.objectiveContainer);g.formulationContainer.appendChild(g.targetContainer);g.formulationContainer.appendChild(g.thresholdContainer);g.formulationContainer.appendChild(m);g.formulationContainer.appendChild(g.rangeContainer)},disableOK:function(){this.formulationDialog.defaultButton.disabled=true},enableOK:function(){this.formulationDialog.defaultButton.disabled=false},show:function(){return new Promise(function(n,m){g.formulationDialog=new l({title:g.header,content:g.formulationContainer,minWidth:440,modalFlag:false,immersiveFrame:k.getImmersiveFrame(),usePaddingFlag:true,buttons:{Cancel:new h({onClick:function(q){var o=q.dsModel;var p=o.dialog;p.close();m()}}),Ok:new h({disabled:true,label:j.get("APPLY"),onClick:function(q){var o=q.dsModel;var p=o.dialog;p.close();n()}})}})})},getFormulationUI:function(){return g.formulationContainer},getChanges:function(){return g.changes}});return f});define("DS/SMAAnalyticsCommon/SMAAnalyticsCase",["UWA/Core","DS/Logger/Logger","module","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy","DS/SMAAnalyticsCommon/SMAAnalyticsFileUtils","DS/WebappsUtils/WebappsUtils","DS/PlatformAPI/PlatformAPI","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(d,b,f,k,l,g,c,e,j){var h=null;var i=b.getLogger(f);var a=d.Class.singleton({init:function(){h=this;h._caseId=null;h.caseInfo=null;h.cestamp=null;h.RA=false;h.RAE=false;h.attachedFiles=[];h.caseData={};h.thumbnails={};try{h.user=e.getUser().login}catch(m){h.user=""}h.datasetType=["DesignSight","Simulation","Simulation Document - NonVersioned","Simulation Document - Versioned","Test Execution"];h._downloadFileList=["rawData.tsv","basketData.tsv","parameterHierarchy.json","rowDescriptors.json","formulation.json","recommendedData.tsv",]},initialize:function(m){h.caseData={};h.cestamp=null;h.caseInfo=null;h.attachedFiles=[];var o=d.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,n=false;if(d.is(m)){if(d.is(m.caseId)){h._caseId=m.caseId}n=d.is(m.RAE)?m.RAE:false}else{h._caseId=null}if(o==="SIMWREI_AP"||n){h.RAE=true}else{if(o==="SIMREII_AP"){h.RA=true}}},clear:function(){h=this;h.cestamp=null;h._caseId=null;h.caseInfo=null;h.attachedFiles=[];h.caseData={};h.thumbnails={}},_updateCaseData:function(n){if(d.is(n)){var m=n[h._caseId];m.forEach(function(o){if(!d.is(h.caseData[o.type])){h.caseData[o.type]=[]}if(d.is(o.physicalID)){o.physicalId=o.physicalID}else{o.physicalID=o.physicalId}if(!d.is(o.id)&&h.datasetType.indexOf(o.type)!==-1){o.id=d.is(o.plmOID)?o.plmOID:o.physicalID}h.caseData[o.type].push(o)})}},_setupCaseData:function(){var m=[];if(d.is(h.caseInfo.dataSet)){if(Array.isArray(h.caseInfo.dataSet)){m=h.caseInfo.dataSet}else{m.push(h.caseInfo.dataSet)}}if(d.is(h.caseInfo.variantRoot)){m=m.concat(h.caseInfo.variantRoot)}if(d.is(m)&&m.length>0){m.forEach(function(n){if(!d.is(h.caseData[n.typeName])){h.caseData[n.typeName]=[]}if(d.is(n.physicalID)){n.physicalId=n.physicalID}else{n.physicalID=n.physicalId}if(!d.is(n.id)&&h.datasetType.indexOf(n.type)!==-1){n.id=d.is(n.plmOID)?n.plmOID:n.physicalID}h.caseData[n.typeName].push(n)})}},_create:function(n,m){return new Promise(function(p,o){l.create(n,m).then(function(q){i.debug("_create ",q);h._caseId=q.response.caseid;p(h._caseId)},function(q){i.error("_create ",q);o(q)})})},_update:function(m,n){return new Promise(function(p,o){l.update(h._caseId,m,n).then(function(q){i.debug("_update ",q);p(q)},function(q){i.error("_update ",q);o(q)})})},_connect:function(m){return new Promise(function(o,n){var p="";m.forEach(function(q){p+=q+";"});l.connect(h._caseId,p,h.RAE).then(function(q){h._updateCaseData(q.response);h._getThumbnails().then(o(q.response),o(q.response))},function(q){n(q)})})},_disconnect:function(m){return new Promise(function(o,n){l.disconnect(h._caseId,m).then(function(p){h._getCaseInfo().then(function(){o(p)},n)},function(p){n(p)})})},_disconnectAttributeGroup:function(m){return new Promise(function(o,n){l.disconnectAttributeGroups(h._caseId,m).then(function(p){o(p)},function(p){n(p)})})},_copy:function(){return new Promise(function(n,m){l.copy(h._caseId,title).then(function(o){n(o)},function(o){m(o)})})},_revise:function(){return new Promise(function(n,m){l.revise(h._caseId).then(function(o){n(o)},function(o){m(o)})})},_delete:function(){return new Promise(function(n,m){l.deleteCase(h._caseId).then(function(o){h.caseInfo=null;h.caseId=null;n(o)},function(o){m(o)})})},_getCaseInfo:function(){return new Promise(function(n,m){l.getCaseInfo(h._caseId).then(function(o){var p=d.Json.xmlToJson(o.response).CaseInfo||{};if(!d.is(h.caseData)){h.caseData={}}p.description=typeof p.description==="object"?"":p.description;h.caseInfo=p;h._caseId=p.physicalId;h._setupCaseData();n()},function(o){m(o)})})},_getProcessThumbnail:function(m){return new Promise(function(o,n){l.getProcessImage(m).then(function(p){var q=c.getWebappsBaseUrl()+"/SMAAnalyticsEssential/assets/icons/thumb_process_default.png";if(d.is(p)&&p.length>0&&d.is(p[0].image)){q=p[0].image}h.thumbnails[m]=q;o()},function(p){h.thumbnails[m]=c.getWebappsBaseUrl()+"/SMAAnalyticsEssential/assets/icons/thumb_process_default.png";o()})})},_getThumbnail:function(m){return new Promise(function(o,n){l.getThumbnail(m).then(function(p){var q=undefined;p.data.forEach(function(r){if(!d.is(q)&&r.id===m){q=r.thumbnail}});if(q.charAt(0)==="/"){require(["DS/SMAAnalyticsCommon/SMAAnalyticsUtils",],function(r){q=r.get3DSpaceUrl()+q;h.thumbnails[m]=q;o()})}else{h.thumbnails[m]=q;o()}},function(p){h.thumbnails[m]=c.getWebappsBaseUrl()+"/SMAAnalyticsEssential/assets/icons/thumb_default.png";o()})})},_getThumbnails:function(){return new Promise(function(o,n){var p=Object.keys(h.caseData);var m=[];p.forEach(function(q){var r=h.caseData[q];if(q!=="Simulation Document - NonVersioned"&&q!=="Simulation Document - Versioned"){if(q==="Simulation"){r.forEach(function(s){if(!d.is(h.thumbnails[s.physicalId])){m.push(h._getProcessThumbnail(s.physicalId))}})}else{r.forEach(function(s){if(!d.is(h.thumbnails[s.physicalId])){m.push(h._getThumbnail(s.physicalId))}})}}});Promise.all(m).then(o,o)})},_getInfo:function(){return new Promise(function(o,n){var m=[];m.push(h._getCaseInfo());m.push(h._listFiles());m.push(h._getRequirements());m.push(h._getCESTAMP());Promise.all(m).then(function(p){i.debug("SUCCESS ",p);h._getThumbnails().then(o(h.caseInfo),o(h.caseInfo))},function(p){i.error("FAILED ",p);n()})})},_getCESTAMP:function(){return new Promise(function(n,m){l.getCESTAMP(h._caseId).then(function(o){if(d.is(o)){h.cestamp=o}n(o)},function(o){i.error("FAILED _getCESTAMP ",o);m(o)})})},_getRequirements:function(){return new Promise(function(n,m){l.getRequirements(h._caseId).then(function(p){if(d.is(p)&&d.is(p.requirementsList)){if(Array.isArray(p.requirementsList)){var o={};o[h._caseId]=p.requirementsList;h._updateCaseData(o)}}n(p)},function(o){m(o)})})},_handleFiles:function(m){return new Promise(function(p,o){var n=[];m.forEach(function(q){n.push(this._handleFileUpload(q))}.bind(this));Promise.all(n).then(function(q){this._connect(q).then(function(r){p(r)},function(r){o(r)})}.bind(this),o)}.bind(this))},_handleFileUpload:function(m){return new Promise(function(o,n){l.createDocumentObject(m.name).then(function(p){l.uploadFileTo3DSpace({oId:p.response,title:m.name,file:m}).then(function(q){var r=[];r.push(q);o(r)},function(q){n(q)})},n)})},_getAttributeGroups:function(){return new Promise(function(n,m){l.getAttributeGroups(h._caseId).then(n,m)})},_setAttributeGroups:function(m){return new Promise(function(o,n){l.connectAttributeGroups(h._caseId,m).then(o,n)})},_getAttributes:function(m){return new Promise(function(o,n){l.getAttributes(h._caseId,m).then(o,n)})},_getHistory:function(m){return new Promise(function(o,n){l.getHistory(d.is(m)?m:h._caseId).then(o,n)})},_setAttributes:function(m){return new Promise(function(o,n){l.setSimulationAttributes(m).then(o,n)})},_demote:function(){return new Promise(function(n,m){l.demote(h._caseId).then(n,m)})},_promote:function(){return new Promise(function(n,m){l.promote(h._caseId).then(n,m)})},_listFiles:function(){return new Promise(function(n,m){l.listFiles(h._caseId).then(function(o){i.debug("attached files ",o);h.attachedFiles=Object.keys(o);n(o)},m)})},_downloadFile:function(q,p,n,o){var m=d.is(o)?o:false;return new Promise(function(s,r){l.downloadFile(q,p,h._caseId,n,m).then(s,r)})},_checkModified:function(){return new Promise(function(n,m){l.getCESTAMP(h._caseId).then(function(o){if(d.is(o)){if(h.user!==o.userid&&h.cestamp.cestamp!==o.cestamp){n(o)}else{h.cestamp=o;m(new Error("no change"))}}},function(o){i.error("FAILED _getCESTAMP ",o);m(o)})})},getCaseId:function(){return this._caseId},setCaseId:function(m){h._caseId=m},create:function(m){return new Promise(function(o,n){h._create(m.title,m.description).then(function(p){o(p)},function(p){n(p)}.bind(h))})},setTitle:function(m){return new Promise(function(o,n){h._update("Title",m).then(o,n)})},setDescription:function(m){return new Promise(function(o,n){h._update("description",m).then(o,n)})},setDefinition:function(){return new Promise(function(n,m){h._update("Definition",JSON.stringify(h.caseInfo.Definition)).then(n,m)})},disconnect:function(m){return new Promise(function(o,n){h._disconnect(m).then(o,n)})},disconnectAttributeGroup:function(m){return new Promise(function(o,n){h._disconnectAttributeGroup(m).then(o,n)})},copy:function(){return new Promise(function(n,m){h._copy().then(n,m)})},revise:function(){return new Promise(function(n,m){h._revise().then(n,m)})},deleteCase:function(){return new Promise(function(n,m){h._delete().then(n,m)})},isObjectConnected:function(n){var p=false;var o=d.is(n.objectTypeValue)?n.objectTypeValue:n.objectType,m=d.is(h.caseData[o])?h.caseData[o]:[];m.forEach(function(q){if(q.physicalId===n.objectId){p=true}});return p},validateDatasetCountRAE:function(){var n=Object.keys(h.caseData),m=0;n.forEach(function(o){if(o!=="Requirement"&&o!=="TestCase"&&o!=="Decision"){m+=a.caseData[o].length}});return m},sliceDatasets:function(n){var o=[],p=[];n.forEach(function(q){var r=d.is(q.displayType)?q.displayType:q.objectTypeValue;if(r==="Requirement"||r==="TestCase"||r==="Decision"){o.push(q)}else{p.push(q)}});if(p.length+h.validateDatasetCountRAE()>50){var m=k.RAELimit-h.validateDatasetCountRAE();if(m>0){p=p.slice(0,m);k.showWarningNotification("",j.get("LIMITCROSSED_2")+" "+m+" "+j.get("LIMITCROSSED_3"))}else{p=[];k.showWarningNotification("",j.get("LIMITCROSSED"))}}return o.concat(p)},connect:function(n,m){return new Promise(function(u,t){if(d.is(m)&&m){h._handleFiles(n).then(function(w){u(w)},function(w){t(w)})}else{var v=n.length;var s=[];var q=[];n.forEach(function(w){if(!h.isObjectConnected(w)){q.push(w)}});n=q;var p=n.length;var r=false;if(h.RAE===true){if(h.validateDatasetCountRAE()+v>50){n=h.sliceDatasets(n)}}var o=n.length;if(p!==o){r=true}n.forEach(function(w){s.push(w.objectId)});if(s.length>0){h._connect(s).then(function(w){u(w)},function(w){t(w)})}else{if(r===true){t("NO_MESSAGE")}else{t("DUPLICATE")}}}}.bind(h))},getInfo:function(){return new Promise(function(n,m){h._getInfo().then(n,m)})},getRequirements:function(){return new Promise(function(n,m){h._getRequirements().then(n,m)})},downloadFile:function(p,o,m,n){return new Promise(function(r,q){h._downloadFile(p,o,m,n).then(r,q)})},getAttributeGroups:function(){return new Promise(function(n,m){h._getAttributeGroups().then(n,m)})},setAttributeGroups:function(m){return new Promise(function(o,n){h._setAttributeGroups(m).then(o,n)})},getAttributes:function(m){return new Promise(function(o,n){h._getAttributes(m).then(o,n)})},setAttributes:function(m){return new Promise(function(o,n){h._setAttributes(m).then(o,n)})},getHistory:function(m){return new Promise(function(o,n){h._getHistory(d.is(m)?m:null).then(o,n)})},demote:function(){return new Promise(function(n,m){h._demote().then(n,m)})},promote:function(){return new Promise(function(n,m){h._promote().then(n,m)})},listFiles:function(){return new Promise(function(n,m){h._listFiles().then(n,m)})},updateDownselectedRecommendedDesign:function(m,n){return new Promise(function(q,p){var o=h.caseInfo.Definition;if(typeof o==="string"){o=JSON.parse(h.caseInfo.Definition)}if(d.is(o)){o.downselected=m;o.basketpoint=n}else{o={downselected:m,basketpoint:n}}h.caseInfo.Definition=o;h.setDefinition().then(q,p)})},openInRA:function(){if(!d.is(this._caseId)){return}if(this.RA){return}var m="DS/TransientWidget/TransientWidget",p=this._caseId,o="";var n={protocol:"3DXContent",version:"0.1",source:widget.data.appId,data:{items:[{objectId:p,displayName:o,objectType:"Analytics Case"}]}};if(p){require([m],function(q){var r={mode:"panel",height:800,width:700};q.showWidget("SIMREII_AP","",{X3DContentId:JSON.stringify(n)},r)})}},openInRAE:function(){if(!d.is(this._caseId)){return}if(this.RAE){return}var m="DS/TransientWidget/TransientWidget",p=this._caseId,o="";var n={protocol:"3DXContent",version:"0.1",source:widget.data.appId,data:{items:[{objectId:p,displayName:o,objectType:"Analytics Case"}]}};if(p){require([m],function(q){var r={mode:"panel",height:800,width:700};q.showWidget("SIMWREI_AP","",{X3DContentId:JSON.stringify(n)},r)})}},getRAEFiles:function(){var m=[];h.attachedFiles.forEach(function(n){h._downloadFileList.forEach(function(o){if(n===o){m.push(o)}})});return m},getDatasetsObject:function(){var n={},m=Object.keys(h.caseData);m.forEach(function(o){if(o!=="Requirement"&&o!=="Test Case"){n[o]=h.caseData[o]}});return n},getRequirementsObject:function(){var n={},m=Object.keys(h.caseData);m.forEach(function(o){if(o==="Requirement"||o==="Test Case"){n[o]=h.caseData[o]}});return n},checkModified:function(){return h._checkModified()},updateCESTAMP:function(){return h._getCESTAMP()}});return a});define("DS/SMAAnalyticsCommon/SMAAnalyticsTCUtils",["UWA/Core","DS/Core/Core","DS/Tree/TreeNodeModel","DS/Tree/TreeNodeView","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy","DS/SMAAnalyticsCommon/SMAAnalyticsCase","DS/Logger/Logger","module","UWA/Class/Promise","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsCustomDialog","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(a,d,k,g,h,j,l,i,n,p,b,c,f,e){var o;var m=function(s){this.title=s.title||"Test Case";this.setData(s.data);this.onCancel(s.cancelCallback);this.onOk(s.okCallback);this.buildTree();this.buildDialog()};m.prototype.buildDialog=function(){var v=this;var u=a.createElement("div",{id:"ra-teselector-dialog"});this.tree.inject(u);var w=function(){v._cancelCallback()};var t=function(){v._okCallback()};var s={content:u,header:"Test Executions for "+this.title,immersiveFrame:l.getImmersiveFrame(),onCancel:w,onConfirm:t};f.showDialog(s)};m.prototype.buildTree=function(){this.tree=new h({columns:[{text:"",dataIndex:"selection",type:"selection",width:40},],roots:this._treeRoots})};m.prototype.setData=function(s){this._data=s;this._treeRoots=s.map(function(u){var t={label:u.title,data:u};t.children=u.TEs.map(function(w){var v={label:w["attribute[Title]"],grid:{selection:false,},data:w};return v});return t})};m.prototype.onCancel=function(s){this._cancelCallback=s};m.prototype.onOk=function(s){this._okCallback=function(){var u=this.tree.getDocument().getSelectedNodes();var t=u.filter(function(v){return v.options.data.type==="Test Execution"}).map(function(v){return{objectId:v.options.data.physicalid,objectType:"Test Execution"}});s(t)}};var q={},r=p.getLogger(b);q.setupNewTCs=function(s,x){var x=x||function(){};var t=function(y){console.log("Cancelled!");return new c.reject(new Error("TE selection cancelled!"))};var w=function(y){return i.connect(n.caseId,y).then(function(z){var A=new c(function(E,D){var G={};WidgetProxy.datasets.forEach(function(H){G[H]=H.id});var C=z[_self.caseId].filter(function(H){return(G[H.id]?false:true)});var B=C.concat(WidgetProxy.datasets);var F={analyticsDataSetList:B};E(z)});return A},function(z){r.error("Common proxy connect error: "+z)})};var v=s.map(function(y){return y.physicalId});var u=i.getTestExecutionsForTestCase(v);return new c(function(z,y){u.then(function(C){console.log(C);var A=s.map(function(G){var F={id:G.physicalId,title:G.title,TEs:C[G.physicalId]};return F});var B=function(){y("TE selection cancelled!")};var D=function(F){w(F).then(function(G){z(G)},function(G){y(G)})};var E={data:A,cancelCallback:B,okCallback:D};new m(E)},function(A){y(A)})})};return q});define("DS/SMAAnalyticsCommon/SMAAnalyticsRecentView",["UWA/Core","DS/Logger/Logger","module","DS/ApplicationFrame/CommandsManager","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/CollectionView/ResponsiveTilesCollectionView","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy","DS/SMAAnalyticsCommon/SMAAnalyticsCase","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/WebappsUtils/WebappsUtils","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(i,e,d,a,b,j,h,o,c,n,g,m){var k=null;var l=e.getLogger(d);var f=i.Class.singleton({init:function(){k=this;k.recentCases=[];k.numRecent=10;k.thumbnail=g.getWebappsBaseUrl()+"SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png";k.recentPanel=null},initialize:function(p){k.numRecent=i.is(p)&&i.is(p.numRecent)?p.numRecent:10;var q=widget.getValue("rarecentcases");k.recentCases=[];if(i.is(q)&&q.length>0){k.recentCases=q.split("|")}},getRecentView:function(p){return new Promise(function(r,q){k._setupRecentView().then(function(s){r(s)},q)})},getRecent:function(){var p=widget.getValue("rarecentcases");if(i.is(p)&&p.length>0){k.recentCases=p.split("|")}return k.recentCases},_getTreeDocument:function(s){var p=[],q=new b({useAsyncPreExpand:false});var r=[];if(Array.isArray(s)){s.forEach(function(v){var u={label:v.displayName,subLabel:m.get("REVISION")+": <b>"+v.revision+"</b> | "+m.get("OWNER")+": <b>"+v.owner+"</b>",description:m.get("MODIFIED")+": "+n.getModifiedInterval(v.modified),thumbnail:k.thumbnail,customTooltip:k._generateTooltip(v),grid:{objectId:v.objectId,objectType:"Analytics Case",envId:n.getCurrentPlatformId(),serviceId:"3DSpace",displayName:v.displayName,displayType:v.objectType}};if(i.is(v.higherRevisionExists)&&v.higherRevisionExists==="true"){u.grid.lastRevisionObjectId=v.lastRevisionObjectId;u.icons=[{iconName:"flow-line"}];u.contextualMenu=["contextual menu"]}var t=new j(u);p.push(t);r.push(v.objectId)});k._removeDeletedCaseIds(r);q.addChild(p)}return q},_generateTooltip:function(v){var r=new Date(isNaN(v.modified)?v.modified:parseInt(v.modified)),q=": ",w=m.get("TITLE")+q+v.displayName,p=m.get("REVISION")+q+v.revision,u=m.get("MODIFICATION_DATE")+q+r.toLocaleString(widget.lang+"-"+widget.locale),s=m.get("RESPONSIBLE")+q+v.owner,t=i.is(v.higherRevisionExists)&&v.higherRevisionExists==="true"?m.get("HIGHER_REVISION_EXISTS"):"";return w+"<br>"+p+"<br>"+s+"<br>"+u+"<br><b>"+t+"</b>"},_removeDeletedCaseIds:function(r){if(r.length===0||r.length===k.recentCases.length){return}var p=[];for(var q=0;q<k.recentCases.length;q++){if(r.indexOf(k.recentCases[q])===-1){p.push(q)}}p.forEach(function(s){k.recentCases.splice(s,1)})},_setupRecentView:function(){return new Promise(function(q,p){if(k.recentCases.length>0){o.getObjectInfo(k.recentCases).then(function(t){if(i.is(t)&&t.length>0){var s=k._getTreeDocument(t);var u=new h({allowUnsafeHTMLContent:true,useDragAndDrop:true,onDragStartCell:function(A,v){var y=undefined;var z=v.nodeModel;if(z){y=z.getTreeDocument()}if(y&&y.options.shouldAcceptDrag(z)){var x={protocol:"3DXContent",version:"1.1",source:i.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,data:{items:[v.nodeModel.options.grid]}};A.dataTransfer.effectAllowed="uninitialized";try{A.dataTransfer.setData("text/searchitems",JSON.stringify(x))}catch(w){}finally{A.dataTransfer.setData("text",JSON.stringify(x))}}else{A.preventDefault()}}});u.selectionBehavior={unselectAllOnEmptyArea:false,toggle:false,canMultiSelect:false,enableShiftSelection:false,enableFeedbackForActiveCell:false};u.onContextualEvent={callback:function(x){var w=[];if(x&&x.cellInfos){if(x.cellInfos.cellModel){var v=x.cellInfos.cellModel.getTreeDocument();w.push({type:"PushItem",title:m.get("OPEN_LATEST_REVISION"),icon:g.getWebappsBaseUrl()+"SMAAnalyticsCommon/assets/icons/50678_I_iconActionOpen_22.png",action:{callback:function(A){if(v!==undefined){var y=v.getSelectedNodes()[0];var z=a.getCommand("SMAAnalyticsEssSearchCaseHdr");if(i.is(z)){z.execute(y.getAttributeValue("lastRevisionObjectId"))}}}}},{type:"PushItem",title:m.get("MANAGE_REVISIONS"),icon:g.getWebappsBaseUrl()+"SMAAnalyticsCommon/assets/icons/I_Lifecycle22.png",action:{callback:function(B){if(v!==undefined){l.log(v);var z=v.getSelectedNodes()[0];var y=z.getAttributeValue("objectId");var A=a.getCommand("SMAAnalyticsEssLifecycleHdr");if(i.is(A)){A.execute(y)}}}}})}}return w}};u.model=s;var r={buildView:u,loadModel:function(v,w){v.model=w._getTrueRoot().getAllDescendants()}};q(r)}else{p()}},function(r){l.error(r);p()})}})},addToRecent:function(){var p=c.caseInfo.physicalId,q=k.recentCases.indexOf(p);if(q!==-1){k.recentCases.splice(q,1)}else{if(k.recentCases.length===k.numRecent){k.recentCases.splice(-1,1)}}k.recentCases.unshift(p);var r="";k.recentCases.forEach(function(s){r+=s+"|"});widget.setValue("rarecentcases",r.substring(0,r.length-1))}});return f});define("DS/SMAAnalyticsCommon/SMAAnalyticsCaseModel",["UWA/Core","UWA/Class/Model","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/WebappsUtils/WebappsUtils"],function(e,c,a,b){var d=c.extend({setup:function(g,f){this.set("subtitle",a.getModifiedInterval(this.get("modified")));this.set("originated",a.getFormattedDate(this.get("originated")));this.set("modified",a.getFormattedDate(this.get("modified")));this.set("content",this.get("responsible"));this.set("image",b.getWebappsBaseUrl()+"/SMAAnalyticsUI/assets/icons/SMAAnalyticsWidgetIcon.png")}});return d});define("DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsAttributeDialog",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/SMAAnalyticsCommon/dialogs/views/SMAAnalyticsAttributeView","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/SMAAnalyticsCommon/SMAAnalyticsCase","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(e,c,j,g,b,i,a,h){var f;var d=e.Class.extend({init:function(k,m,n){f=this;f._model=k;f._data=m;f._title=n;f._attrView=this._getContent();var l=e.createElement("div",{id:"caseAttribute"});f._attrView.inject(l);f._content=l},showDialog:function(){var m=i.getImmersiveFrame(),k=this._model.id;var l=new j({title:h.get("RA_CASE_ATTR_GROUP")+this._title,content:this._attrView,minWidth:600,minHeight:400,resizableFlag:true,modalFlag:false,allowMaximizeFlag:true,maximizeButtonFlag:true,immersiveFrame:m,usePaddingFlag:true,buttons:{Ok:new g({disabled:false,label:h.get("SAVE_BUTTON"),onClick:function(t){var q=t.dsModel.dialog,p=q.content,n=p.getManager(),u=n.getRoots(),o=[],s=widget.body;c.mask(s,h.get("SAVING_ATTR"));u.forEach(function(v){var w={name:v.options.grid.name,value:v.options.grid.value};o.push(w)});var r={caseid:k,attributes:o};a.setAttributes(r).then(function(v){if(v.status==="success"){i.showSuccessNotification("",h.get("SAVE_ATTR_SUCCESS"));q.close()}else{i.showErrorNotification("",h.get("SAVE_ATTR_FAIL"))}c.unmask(s)},function(v){i.showErrorNotification("",h.get("SAVE_ATTR_FAIL"));c.unmask(s)})}}),Close:new g({label:h.get("CLOSE"),onClick:function(p){var n=p.dsModel;var o=n.dialog;o.close()}})}})},_getContent:function(){var k=new b(this._data.attributes);return k.getView()}});return d});define("DS/SMAAnalyticsCommon/SMAAnalyticsCaseDetail",["UWA/Core","DS/UIKIT/Mask","DS/W3DXComponents/Views/Item/TileView","DS/SMAAnalyticsCommon/SMAAnalyticsCase","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","text!SMAAnalyticsCommon/skeleton/views/SMAAnalyticsDetailView.html","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsHistoryDialog","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsAttributeDialog","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsConfirmDialog","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsApproximationDialog","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy"],function(f,d,g,a,k,e,c,b,m,i,j,l){var h=g.extend({loadingWindowedMode:false,tagName:"div",className:"link-detail",isFirstTimeEntering:true,model:null,domEvents:{"click #dataset-details-dsmin-remove":"disconnect","click #dataset-details-owner-href":"openLifecycleWidget","click #ra-cd-recommended":"downloadRecommendedDesigns","click #dataset-details-recommended-download":"downloadRecommendedDesigns","click #ra-cd-basketpoint":"downloadBasketPointDesigns","click #dataset-details-basketpoint-download":"downloadBasketPointDesigns","click #ra-cd-ds-download":"downloadAllDesigns","click #dataset-details-dsmin-download":"downloadAllDesigns","click #dataset-details-history":"viewCaseHistory","click .case-attribute-group":"viewAttributeGroup","click #dataset-details-add-attributes":"searchAttributes","click #dataset-attributes-dsmin-remove":"disconnectAttributes","click #ra-demote-button":"demoteCaseMaturity","click #ra-promote-button":"promoteCaseMaturity","click .case-approximation":"viewCaseApproximation","change #spSearchAttributes":"onChangeAttributes","change .datasets-details-input":"persistUserInput","change .ra-cd-ds-desc-ta":"persistUserInput"},events:{onFacetSelect:"onFacetSelect"},template:function(){return e},init:function(n){if(n&&n.model){this.model=n.model}this._parent(arguments)},_mask:function(n){var o=widget.body;var p=f.is(n)?n:"";d.mask(o,p)},_unmask:function(){var n=widget.body;d.unmask(n)},onRender:function(){var p=this.container.getElementsByClassName("ra-create-input-page-container");var o=f.createElement("ra-input-dropbox");if(p){o.objectId=this.model.id;var n={title:j.get("DROP_DS"),upload:j.get("UPLOAD"),dragdrop:j.get("DDHERE"),search:j.get("SEARCH")};o.hideUpload=false;if(k.isRAE()){o.hideUpload=true;o.plmTypes="Simulation,DesignSight,VPMReference,Test Execution"}else{o.plmTypes="Simulation,Document,Simulation Document - Versioned,Simulation Document - NonVersioned,Simulation Job,DesignSight,VPMReference,Requirement,Decision,Approximation,Test Execution";o.fileTypes=".xls, .xlsx, .csv, .tsv, .nrf, .zrf, .zip"}o.raTitle=n;o.isExportReq=false;o.style.width="100%";o.addEventListener("onDataUploadCompleteEvent",function(q){widget.setValue("datasetchanged",true);var r=q.detail;var t=r[this.model.id];if(!this.model.get("datasetsList")){this.model.set("datasetsList",[])}var s=this.model.get("datasetsList");t.forEach(function(u){s.push({id:u.id,name:u.name,title:u.title,physicalId:u.physicalId,type:u.type})},this);this.render()}.bind(this));p[0].appendChild(o)}return true},onFacetSelect:function(){a.initialize({caseId:this.model.id});widget.setValue("lastactivecase",this.model.id);widget.setValue("datasetchanged",false);if(this.isFirstTimeEntering&&k.isRAE()){var q=arguments[0];var n=q.getRoute();var o=n.substring(0,n.length-1)+"1";q.setRoute(o);this.isFirstTimeEntering=false}else{this._mask(j.get("LOADING_CASEDETAILS"));var p=this;this.updateCaseDetailsViewData().then(function(){p.render();p._unmask()},function(r){p._unmask()})}},_download:function(q,o){try{if(typeof window.navigator.msSaveOrOpenBlob==="undefined"){var n=document.createElement("a");document.body.appendChild(n);n.setAttribute("style","display: none");n.href=window.URL.createObjectURL(o);n.download=q;n.click()}}catch(p){f.log("Error downloading file: "+q,[p])}},downloadRecommendedDesigns:function(){try{if((parseInt(this.model.get("downselected"))||0)<=0){return}a.downloadFile("recommended.tsv","tsv",document,true).then(function(o){this._download("recommended.tsv",o)}.bind(this))}catch(n){this.model.set("downselected",0)}},downloadBasketPointDesigns:function(){try{if((parseInt(this.model.get("basketPointCount"))||0)<=0){return}a.downloadFile("basket.tsv","tsv",document,true).then(function(o){this._download("basket.tsv",o)}.bind(this))}catch(n){this.model.set("basketPointCount",0)}},downloadAllDesigns:function(){a.downloadFile("dataset.tsv","tsv",document,true).then(function(n){this._download("dataset.tsv",n)}.bind(this))},handleDSDesignsDownload:function(){var o=a.getCaseId();var n=this;return new Promise(function(q,p){a.listFiles().then(function(r){if(typeof r["dataset.tsv"]!=="undefined"){n.model.set("enableDownload",true);if(n.model.get("datasetsCount")>0){n.model._attributes.datasetsList[0].enableDownload=true}}else{delete n.model._attributes.enableDownload;if(n.model.get("datasetsCount")>0){delete n.model._attributes.datasetsList[0].enableDownload}}q()},function(r){console.warn("Error retrieving downselected data.",[r]);q()})})},getAttributeGroups:function(){var n=this;return new Promise(function(p,o){a.getAttributeGroups().then(function(q){if(!f.is(q)){n.model.set("attributeList",[]);p()}if(f.is(q,"string")){q=JSON.parse(q)}if(f.is(q)&&f.is(q.attributeGroups)){n.model.set("attributeList",q.attributeGroups)}p()},function(q){f.log("Failed to get the list of attached attribute groups.");o(q)})})},viewCaseHistory:function(){var n=this;this._mask(j.get("LOADING_HISTORY"));a.getHistory().then(function(o){c.showDialog(n.model.get("title"),o.history,k.getImmersiveFrame());n._unmask()},function(o){n._unmask();k.showErrorNotification("",j.get("HIST_VIEW_FAIL"))})},viewAttributeGroup:function(o){var p=o.target?o.target:o.srcElement,q=this,s=p.parentNode.id||"",t=p.parentNode.title||"",r=widget.body,n=this.model.id;if(s.length===0){f.log("Attribute id is missing from the view element.");return}this._mask(j.get("LOADING_ATTRIBUTES"));a.getAttributes(s).then(function(v){var u=new b(q.model,v,t);u.showDialog();q._unmask()},function(u){q._unmask();k.showErrorNotification("",j.get("ATTR_VIEW_FAIL"))})},viewCaseApproximation:function(n){var o=n.target?n.target:n.srcElement,p=this,r=o.parentNode.id||"",s=o.parentNode.title||"",q=widget.body;if(r.length===0){console.error("Approximation id is missing from the view element.");return}d.mask(q);a.getHistory(r).then(function(t){var w=p.model.get("approximationList"),u="",v={};w.forEach(function(x){if(x.id===r){u=x}});v.data=u;v.history=t.history;v.immersiveFrame=k.getImmersiveFrame();i.showDialog(s,v,k.getImmersiveFrame());d.unmask(q)},function(t){d.unmask(q);k.showErrorNotification("",j.get("HIST_VIEW_FAIL"))})},searchAttributes:function(){if(k.isTransientWidget()){return}var n=document.getElementById("spSearchAttributes");n.search()},onChangeAttributes:function(p){var q=this;if(!this.model.get("attributeList")){this.model.set("attributeList",[])}var o=this.model.get("attributeList");var n=p.detail.getSelectedObjects();var s=[];n.forEach(function(u){var t=false;o.forEach(function(v){if(v.physicalId===u.objectId){t=true}});if(!t){s.push(u.objectId)}});if(s.length===0){k.showWarningNotification("",j.get("ATTR_ADD_DUP"))}else{var r=widget.body;d.mask(r,j.get("ATTR_CONNECTING"));a.setAttributeGroups(s).then(function(t){t=f.is(t,"string")?JSON.parse(t):t;var v=t.error;if(v){k.showErrorNotification("",v)}else{var u=t.success;u.forEach(function(w){o.push({id:w.id,name:w.name,title:w.title,physicalId:w.physicalId,type:w.type})},q);q.render();k.showSuccessNotification("",j.get("ATTR_ADD_SUCCESS"))}d.unmask(r)},function(t){d.unmask(r);k.showErrorNotification("",j.get("ATTR_ADD_FAIL"))})}},demoteCaseMaturity:function(){var o=this,n={immersiveFrame:k.getImmersiveFrame(),label:j.get("RA_CASE_DEMOTE"),header:j.get("ARE_YOU_SURE"),};m.showDialog(n).then(function(){a.demote().then(function(p){if(p.status==="success"){o.updateCaseDetailsViewData()["finally"](function(){o.render()})}else{k.showErrorNotification("",j.get("CASE_DEMOTE_FAILED"))}},function(p){k.showErrorNotification("",j.get("CASE_DEMOTE_FAILED"))}.bind(o))}.bind(o))},promoteCaseMaturity:function(){var o=this,n={immersiveFrame:k.getImmersiveFrame(),label:j.get("RA_CASE_PROMOTE"),header:j.get("ARE_YOU_SURE"),};m.showDialog(n).then(function(){a.promote().then(function(p){if(p.status==="success"){o.updateCaseDetailsViewData()["finally"](function(){})}else{k.showErrorNotification("",j.get("CASE_PROMOTE_FAILED"))}},function(p){k.showErrorNotification("",j.get("CASE_PROMOTE_FAILED"))}.bind(o))}.bind(o))},disconnect:function(n){var q=this,p=n.target?n.target:n.srcElement,q=this,r=p.parentNode.id||"",o={immersiveFrame:k.getImmersiveFrame(),label:j.get("DISCNCT_DATAST_CONFRM"),header:j.get("ARE_YOU_SURE"),};if(r.length===0){f.log("Dataset id is missing from the view element.");return}m.showDialog(o).then(function(){a.disconnect(r).then(function(t){var s=q.model.get("datasetsList")||[];for(var u=0;u<s.length;u++){if(s[u].id===r){s.splice(u,1);break}}q.render();k.showSuccessNotification("",j.get("DS_REM_SUCCESS"))},function(s){k.showErrorNotification("",j.get("DS_REM_FAIL"))})}.bind(this))},disconnectAttributes:function(n){var q=this,p=n.target?n.target:n.srcElement,q=this,s=p.parentNode.id||"",r=widget.body,o={immersiveFrame:k.getImmersiveFrame(),label:j.get("DISCNCT_ATTR_CONFRM"),header:j.get("ARE_YOU_SURE"),};if(s.length===0){f.log("Attribute id is missing from the view element.");return}d.mask(r,j.get("ATTR_DISCONNECTING"));m.showDialog(o).then(function(){a.disconnectAttributeGroup(s).then(function(w){var t=w.error;if(t){k.showErrorNotification("",j.get("ATTR_REM_FAIL"))}else{var v=q.model.get("attributeList")||[];for(var u=0;u<v.length;u++){if(v[u].id===s){v.splice(u,1);break}}k.showSuccessNotification("",j.get("ATTR_REM_SUCCESS"));q.model.dispatchEvent("onChange")}d.unmask(r)},function(t){k.showErrorNotification("",j.get("ATTR_REM_FAIL"));d.unmask(r)})})},persistUserInput:function(o){var p=o.target?o.target:o.srcElement,q=this,r="",n="";if(!f.is(p.value,"string")||p.value.length===0||p.defaultValue===p.value){return""}n=k.textSanitize(p.value,f.is(p.id==="ra-casetitle")?true:undefined);if(n.length==0){p.value=p.defaultValue;k.showWarningNotification("",j.get("INVALID_TXT"));return""}switch(p.id){case"ra-casedescription":r="description";a.setDescription(encodeURIComponent(n)).then(function(s){p.defaultValue=n;q.model.set("description",n)},function(s){p.value=p.defaultValue;k.showErrorNotification("",j.get("ATTR_UPD_FAIL"))});break;case"ra-casetitle":r="Title";a.setTitle(encodeURIComponent(n)).then(function(s){p.defaultValue=n;q.model.set("title",n)},function(s){p.value=p.defaultValue;k.showErrorNotification("",j.get("ATTR_UPD_FAIL"))});break;default:r="";break}if(r===""){p.value=p.defaultValue;return""}},getImageForCase:function(){var n=this;return new Promise(function(p,o){a.downloadFile("recommendeddesignimage.jpg","jpg",document).then(function(q){n.model.set("recommendedImage",q);p()},function(q){o(q)})})},updateCaseDetailsViewData:function(){return new Promise(function(o,n){a.getInfo().then(function(p){try{var A=[],t=p.Definition,r=0,x=0;if(f.is(t,"string")&&t.length>0){t=JSON.parse(t)}if(f.is(t.basketpoint)){r=!isNaN(t.basketpoint)?parseInt(t.basketpoint):0;A.push(this.handleDSDesignsDownload())}if(f.is(t.downselected)){x=!isNaN(t.downselected)?parseInt(t.downselected):0;A.push(this.getImageForCase())}this.model.set({updatedInterval:k.getFormattedDate(p.modified),originated:k.getFormattedDate(p.originated),owner:p.owner,subtitle:k.getModifiedInterval(p.modified),content:p.ownerFullName,author:p.originator,state:p.currentState,basketPointCount:r,downselected:x,description:typeof p.description==="object"?"":p.description,authorFullName:p.originatorFullName,ownerFullName:p.ownerFullName,up_to_date:p.up_to_date,project:p.project,organization:p.organization});var q=[],s=p.Approximation;if(f.is(s)){this.model.set("approximationList",[]);var y=this.model.get("approximationList");if(Array.isArray(s)){q=s}else{q.push(s)}q.forEach(function(B){y.push({id:B.plmOID,name:B.name,title:B.title,type:B.typeName,revision:B.revision,owner:B.owner,modified:B.modified,description:B.description,state:B.currentState,originated:B.originated,author:B.originator,project:B.project})},this)}else{this.model.set("approximationList",[])}var z=[],v=[];if(f.is(p.dataSet)){v=p.dataSet}if(f.is(p.variantRoot)){v=v.concat(p.variantRoot)}if(f.is(v)){if(Array.isArray(v)){z=v}else{z.push(v)}this.model.set("datasetsList",[]);var u=this.model.get("datasetsList");z.forEach(function(B){u.push({id:B.plmOID,name:B.name,title:B.title,physicalId:B.physicalID,type:B.typeName})},this)}A.push(this.getAttributeGroups());if(A.length>0){Promise.all(A).then(function(){o()},function(B){n()})}else{o()}}catch(w){f.log("updateCaseDetailsViewData: Error "+w);n(w)}}.bind(this),function(p){f.log("Error fetching case info.");n(p)}.bind(this))}.bind(this))},openLifecycleWidget:function(){if(k.isTransientWidget()){return}var n="DS/TransientWidget/TransientWidget",r=this.model.get("id"),q=this.model.get("title"),p=f.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId;var o={protocol:"3DXContent",version:"0.1",source:p,data:{items:[{objectId:r,displayName:q}]}};if(r){require([n],function(s){var t={mode:"panel",height:800,width:700};s.showWidget("ENOLCMI_AP",q,{X3DContentId:JSON.stringify(o)},t)})}},});return h});define("DS/SMAAnalyticsCommon/SMAAnalyticsWorker",["UWA/Core","DS/Logger/Logger","module","DS/PlatformAPI/PlatformAPI","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy","DS/SMAAnalyticsCommon/SMAAnalyticsFileUtils","DS/SMAAnalyticsCommon/SMAAnalyticsCase","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/SMAAnalyticsCommon/SMAAnalyticsSimObjReader","DS/WebappsUtils/WebappsUtils","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon"],function(h,b,e,y,U,l,L,c,W,J,r){var D=b.getLogger(e),n=null,N="initializeWorker",F="getKWEData",m="setKWEData",d="setCaseData",P="getSaveData",x="setDatasets",q="setPriority",a="setCurrentUser",S="mergeParameters",w="modifyParameter",B="mergeParameterById",u="mergeParameterWithNew",M="getParameterMergeData",Q="setParameterFiltersByName",g="getAllParametersAsArray",I="mergeRequirementParameterById",V="autoMapRequirements",s="mergeRequirements",v="setConstraint",t="setObjective",k="getAllFilesForRowIdAsArray",R="setCommentOnRow",p="getCommentsForRow",G="toggleRecommendedRowId",f="toggleLikeOnRow",X="getCompareTableData",C="getColumnIdsByScore",j="setFormulationForParam",K="setDataFromServer",o="getCaseModified",A="clearCaseModified",E="getAlternativesCount",T="setCaseLoadComplete",i="getAlternatives",O="hideUnhideAlternatives",z="removeAlternatives",H=h.Class.singleton({init:function(){n=this},initialize:function(){this._caseId=L.getCaseId();this.savedCase=false;this.savedViewState={};this.setupFailed=true;this._clearWorker();var Y=J.getProxifiedWebappsBaseUrl()||J.getWebappsBaseUrl();if(!h.is(Y)){Y="../SMAAnalyticsWorkers/SMAAnalyticsWorkers.js"}else{Y+="SMAAnalyticsWorkers/SMAAnalyticsWorkers.js"}this.worker=new Worker(Y);this.worker.evaluate=this._evaluate.bind(this);this.worker.onmessage=this._onMessage.bind(this);this.worker.onerror=this._onError.bind(this)},isRunning:function(){if(h.is(this.worker)){return true}return false},clear:function(){this._caseId=null;this.savedCase=false;this.savedViewState={};this.setupFailed=true;this._clearWorker()},evaluate:function(aa,Z){var Y=Z instanceof Array?Z:[];return new Promise(function(ac,ab){this.worker.evaluate(aa,Y,function(ae,ad){if(ae){ac(ad)}else{ab(ad)}})}.bind(this))},_clearWorker:function(){if(this.worker instanceof Worker){this.worker.terminate();delete this.worker}this.listeners={}},_evaluate:function(Z,Y,ab){var aa=new Array(36+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,36);this.worker.postMessage({command:Z,args:Y,id:aa});this.listeners[aa]=ab},_onMessage:function(Y){if(this.listeners[Y.data.id]){this.listeners[Y.data.id](true,Y.data.data);delete this.listeners[Y.data.id]}},_onError:function(aa){var Y=aa.message,Z=Y.split(": ");if(this.listeners[Z]){this.listeners[Z](false,aa);delete this.listeners[Z]}},_loadDataToWorker:function(Y,ab,Z,aa){return new Promise(function(ad,ac){if(aa.length>0){this._downloadRAEData(aa).then(function(ae){this.savedCase=true;this._getAttributeAndPLMDataForObjects(ab).then(function(){this._loadSavedData(ae).then(function(){this.savedViewState={};ad()}.bind(this),ac)}.bind(this),function(af){D.error(af);ac(af)})}.bind(this),function(ae){D.error(ae);ac(ae)}.bind(this))}else{this._getAttributeAndPLMDataForObjects(ab).then(function(ae){ad(ae)},function(){ac()})}}.bind(this))},_setCaseLoadComplete:function(){return this.evaluate(T,null)},_startWorker:function(Y,ab,Z,aa){return new Promise(function(ad,ac){return this.evaluate(N,[Y,ab,Z]).then(function(){this._loadDataToWorker(Y,ab,Z,aa).then(function(ae){this.setupFailed=false;this._setCaseLoadComplete().then(function(){ad(ae)},function(){ac()})}.bind(this),ac)}.bind(this),function(ae){ac(ae)})}.bind(this))},_loadSavedData:function(Y){return new Promise(function(ab,aa){var Z=[];this._setBlob("parameterHierarchy",Y).then(function(){this._setBlob("rowDescriptors",Y).then(function(){this._setBlob("formulation",Y).then(function(){for(var ac in Y){Z.push(this._setBlob(ac,Y))}Promise.all(Z).then(ab,aa)}.bind(this),aa)}.bind(this),aa)}.bind(this),aa)}.bind(this))},_setCaseData:function(Y,Z){return this.evaluate(d,[Y,Z])},_setBlob:function(Z,Y){return new Promise(function(ab,aa){if(Y.hasOwnProperty(Z)){this._readBlob(Z,Y[Z]).then(function(ac){this._setCaseData(Z,ac).then(function(){delete Y[Z];ab("File "+Z+" has been set to the worker")},aa)}.bind(this))}else{aa("File "+Z+" is not part of the case")}}.bind(this))},_readBlob:function(Z,Y){return new Promise(function(ae,ad){try{var aa=new FileReader();var ab=function(af){return af.split("NaN").join("null")};aa.addEventListener("loadend",function(){var ag="";if(["basketData","recommendedData","rawData"].indexOf(Z)>=0){ag=ab(this.result)}else{if(Z!=="file_data"){try{ag=JSON.parse(ab(this.result))}catch(af){ad("Error parsing JSON string for"+Z)}}}ae(ag)});aa.readAsText(Y)}catch(ac){ad("Error loading "+Z+"to the worker.")}}.bind(this))},_downloadRAEData:function(Y){return new Promise(function(aa,Z){l.downloadFiles(this._caseId,Y).then(aa,Z)}.bind(this))},_getAttributeAndPLMDataForObjects:function(Y){return new Promise(function(ae,ad){var ac=Object.keys(Y);var Z=[];var ab=[];var aa={};if(ac&&ac.length===0){ad("No data-sets attached to the Case")}ac.forEach(function(af){var ag=Y[af];ag.forEach(function(ah){if(ah.physicalID){if(af==="DesignSight"){ab.push(ah.physicalID)}Z.push(ah.physicalID);aa[ah.physicalID]=ah.title}else{if(ah.physicalId){if(af==="DesignSight"){ab.push(ah.physicalId)}Z.push(ah.physicalId);aa[ah.physicalId]=ah.title}}},this)},this);Promise.all([this._fetchSimObjectParametersForSO(ab,aa),this._fetchAttributeAndPLMDataForObjects(Z)]).then(function(af){this._setDataFromServer(af).then(function(ag){ae(ag)},function(){ad()}.bind(this));D.debug(af)}.bind(this),function(){ae()})}.bind(this))},_fetchAttributeAndPLMDataForObjects:function(Y){return new Promise(function(aa,Z){U.getAttributeAndPLMDataForObjects(Y).then(function(ab){aa(ab)},function(ab){aa(ab)})}.bind(this))},_fetchSimObjectParametersForSO:function(Y,Z){return new Promise(function(ae,ah){if(Y.length===0){ae()}var ac=c.get3DSpaceUrl();var af="SecurityContext",ai=["collabspaces","collabspace"];var ab=null;if(!ab&&window.widget&&window.widget.getValue){ai.some(function(aj){ab=window.widget.getValue(aj);return ab})}var ag=new W(ac,"OnPremise",ab,Z);var aa=[];var ad=[];return Y.reduce(function(ak,aj){return ak.then(function(al){ag.clearLoadedSimObject();ag.loadSimulationObject(aj);return ag.getObjectParameters()}).then(function(al){ag.clearLoadedSimObject();if(al&&typeof al==="object"){aa.push(al)}else{ad.push(al)}},function(al){D.error(al);ah(al)})},Promise.resolve()).then(function(aj){D.debug("Sesonrs for all objects from SPYLoader: "+aa);if(ad&&ad.length>0){var ak=r.get("NO_EXP_CONTENT");ad.forEach(function(al){ak+=al+"<br>"});c.showWarningNotification("",ak)}ae(aa)},function(aj){D.error(aj);ah(aj)})})},_setDataFromServer:function(aa){var Z,Y;if(Object.keys(aa).length>0){Object.keys(aa).forEach(function(ac){var ad=aa[ac];if(h.is(ad)&&ad.attributesData){Z=ad.attributesData}else{if(typeof ad==="object"){Y=ad}}});if(h.is(Y)&&Y.length>0){this._addSODataToAttribData(Z,Y)}}else{Z=aa.attributesData}var ab={ATTRIB_PLM_DATA:Z,savedCase:this.savedCase};return this.evaluate(K,[ab])},_addSODataToAttribData:function(Z,Y){Y.forEach(function(ac){var aa=ac.physicalid;var ab=Z.filter(function(ad){return ad.id===aa})[0];ab.SOParameters=ac.analysisCases})},_getSaveData:function(){return this.evaluate(P,null)},_isSavedCase:function(){return this.savedCase},_checkForChanges:function(Y){return new Promise(function(aa,Z){this.evaluate(o,null).then(function(ab){try{if(typeof ab==="boolean"&&ab){aa(true)}else{if(this.setupFailed===true){Z(false)}else{Z(false)}}}catch(ac){D.error(ac)}}.bind(this),Z)}.bind(this))},_setSaveSuccess:function(){return this.evaluate(A,null)},_saveCase:function(aa,ab,Z){var Y=n._caseId;if(h.is(aa)&&h.is(aa.caseId)){Y=aa.caseId}return new Promise(function(ad,ac){n._getSaveData().then(function(ae){U.saveRAECaseData(Y,ae).then(function(){L.updateDownselectedRecommendedDesign(Z,ab).then(function(){n._setSaveSuccess().then(ad,ac)},function(af){n._setSaveSuccess().then(ad,ac)})},ac)},ac)})},_getCompareData:function(Y){return this.evaluate(X,Y)},_getColumnIdsByScore:function(Y){return this.evaluate(C,[Y])},_getParameterMergeData:function(){return this.evaluate(M,[])},_setCommentOnRow:function(aa,Z,Y){return this.evaluate(R,[aa,Z,Y])},_getCommentsForRow:function(Y){return this.evaluate(p,[Y])},_setDatasets:function(Y){return this.evaluate(x,[Y])},_setPriority:function(Z,Y){return this.evaluate(q,[{parameterID:Z,priorityValue:Y}])},_mergeParameters:function(Z,Y,aa){return this.evaluate(S,[Z,Y,{caseName:aa}])},_modifyParameter:function(Y){return this.evaluate(w,[Y])},_setParameterFilter:function(Y){return this.evaluate(Q,[Y])},_getParametersAll:function(){return this.evaluate(g,[])},_mapRequirementsAuto:function(Y){return this.evaluate(V,[Y])},_mapRequirements:function(Y){return this.evaluate(s,[Y])},_modifyFormulation:function(Y){return this.evaluate(j,[Y])},_setConstraint:function(aa,Z,Y){return this.evaluate(v,[{parameterID:aa,boundValue:Z,type:Y}])},_setObjective:function(Y){return this.evaluate(t,[Y])},_toggleRecommendedRow:function(Y){return this.evaluate(G,[Y])},_toggleLikeRow:function(Y){return this.evaluate(f,[Y])},_getSavedViewState:function(){return this.savedViewState},_updateWorker:function(Y){return new Promise(function(ac,ab){var ad={};var aa=[];var Z={};Y.forEach(function(ae){if(!h.is(ad[ae.type])){ad[ae.type]=[]}if(h.is(ae.physicalID)){ae.physicalId=ae.physicalID}else{ae.physicalID=ae.physicalId}if(!h.is(ae.id)&&(ae.type==="DesignSight"||ae.type==="Simulation")){ae.id=h.is(ae.plmOID)?ae.plmOID:ae.physicalID}if((ae.type==="DesignSight")){aa.push(h.is(ae.plmOID)?ae.plmOID:ae.physicalID);Z[h.is(ae.plmOID)?ae.plmOID:ae.physicalID]=ae.title}ad[ae.type].push(ae)});this._setDatasets(ad).then(function(){var ae=[];Y.forEach(function(af){ae.push(af.physicalId)});this.savedCase=false;this.autoMerged=false;Promise.all([this._fetchSimObjectParametersForSO(aa,Z),this._fetchAttributeAndPLMDataForObjects(ae)]).then(function(af){this._setDataFromServer(af).then(function(ag){ac(ag)},function(){ab()}.bind(this));D.debug(af)}.bind(this),function(){ac()})}.bind(this),function(ae){D.error(ae);ab(ae)})}.bind(this))},_setupIconView:function(Y){return new Promise(function(aa,Z){l.downloadFiles(this._caseId,Y,true).then(function(ab){aa(ab)},Z)}.bind(this))},_getCounts:function(){return new Promise(function(Z,Y){n.evaluate(E).then(function(aa){D.debug(aa);Z(aa)})})},_getAlternatives:function(){return new Promise(function(Z,Y){n.evaluate(i).then(function(aa){D.debug(aa);Z(aa)},function(aa){D.error(aa);Y(aa)})})},_hideUnhideAlternatives:function(Y,Z){return new Promise(function(ab,aa){n.evaluate(O,[Y,Z]).then(function(ac){D.debug(ac);ab(ac)},function(ac){D.error(ac);aa(ac)})})},_removeAlternatives:function(Y){return new Promise(function(aa,Z){n.evaluate(z,[Y]).then(function(ab){D.debug(ab);aa(ab)},function(ab){D.error(ab);Z(ab)})})},saveCase:function(Y){var Z=0;return new Promise(function(ab,aa){n._getCounts().then(function(ac){n._saveCase(Y,ac.numAlternatives,ac.numRecommended).then(ab,aa)},function(ac){n._saveCase(Y,0,0).then(ab,aa)})})},getAlternativeCount:function(){return new Promise(function(Z,Y){n.evaluate(E).then(function(aa){Z(aa.numAlternatives)},function(aa){D.error(aa);Y(0)})})},isSavedCase:function(){return this._isSavedCase()},checkForChanges:function(Y){return this._checkForChanges(Y)},getCompareData:function(Y){return this._getCompareData(Y)},getColumnIdsByScore:function(Y){return this._getColumnIdsByScore(Y)},getParameterMergeData:function(){return this._getParameterMergeData()},startWorker:function(){return new Promise(function(Z,Y){this._startWorker(this._caseId,L.getDatasetsObject(),y.getUser(),L.getRAEFiles()).then(function(aa){Z(aa)},function(){Y()})}.bind(this))},setCommentOnRow:function(aa,Z,Y){return this._setCommentOnRow(aa,Z,Y)},getCommentsForRow:function(Y){return this._getCommentsForRow(Y)},setDatasets:function(Y){return this._setDatasets(Y)},setPriority:function(Z,Y){return this._setPriority(Z,Y)},mergeParameters:function(Z,Y,aa){return this._mergeParameters(Z,Y,aa)},modifyParameter:function(Y){return this._modifyParameter(Y)},setParameterFilter:function(Y){return this._setParameterFilter(Y)},getParametersAll:function(){return this._getParametersAll()},mapRequirementsAuto:function(Y){return this._mapRequirementsAuto(Y)},mapRequirements:function(Y){return this._mapRequirements(Y)},modifyFormulation:function(Y){return this._modifyFormulation(Y)},setConstraint:function(aa,Z,Y){return this._setConstraint(aa,Z,Y)},setObjective:function(Y){return this._setObjective(Y)},toggleRecommendedRow:function(Y){return this._toggleRecommendedRow(Y)},toggleLikeRow:function(Y){return this._toggleLikeRow(Y)},updateWorker:function(Y){return this._updateWorker(Y)},setupIconView:function(){var Y=[];L.attachedFiles.forEach(function(Z){if(Z.indexOf("file_data")===0&&c.getFileExtension(Z).toLowerCase()===".zip"){Y.push(Z)}});return this._setupIconView(Y)},getAlternatives:function(){return this._getAlternatives()},hideAlternatives:function(Y){return this._hideUnhideAlternatives(Y,true)},unhideAlternatives:function(Y){return this._hideUnhideAlternatives(Y,false)},removeAlternatives:function(Y){return this._removeAlternatives(Y)}});return H});define("DS/SMAAnalyticsCommon/SMAAnalyticsSearchUtils",["UWA/Core","DS/SMAAnalyticsCommon/SMAAnalyticsCaseModel"],function(e,b){function d(){return{"ds6w:label":{property:"title"},"ds6w:description":{property:"description"},"ds6w:identifier":{property:"name"},"ds6w:who/ds6w:responsible":{property:"responsible"},"ds6w:responsible":{property:"responsible"},"ds6w:who/ds6w:responsible/ds6w:originator":{property:"originator"},"ds6w:when/ds6w:created":{property:"creationDate",date:false},"ds6w:created":{property:"creationDate",date:false},"ds6w:when/ds6w:modified":{property:"modificationDate",date:false},"ds6w:modified":{property:"modificationDate",date:false},"ds6w:who/ds6w:lastModifiedBy":{property:"lastModifiedBy"},"ds6w:lastModifiedBy":{property:"lastModifiedBy"},"ds6w:how/ds6w:classification":{property:"classification"},"ds6w:classification":{property:"classification"},"ds6w:what/ds6w:policy":{property:"collabPolicy",useDisplayValue:true},"ds6w:policy":{property:"collabPolicy",useDisplayValue:true},"ds6w:where/ds6w:context/ds6w:project":{property:"collabSpace",useDisplayValue:true},"ds6w:project":{property:"collabSpace",useDisplayValue:true},"ds6w:what/ds6w:type":{property:"type",useDisplayValue:true},"ds6w:type":{property:"type",useDisplayValue:true},"ds6w:who/ds6w:responsible/ds6w:organizationResponsible":{property:"organization"},"ds6w:organizationResponsible":{property:"organization"},"ds6wg:revision":{property:"revision"},thumbnail_2d:{property:"thumbnail"},type_icon_url:{property:"icon"},preview_url:{property:"preview"},resourceid:{property:"resourceid"}}}function c(p){var v=d();var w={};w.analyticsCase=[];var q,n;var u=p.facets;if(!u){u=[]}for(q=0;q<u.length;++q){var h=u[q];var r=h.sixw;if(!w.hasOwnProperty(r)){w[r]=[]}var g={};g.id=h.object;g.searchId=h.object;g.count=h.count;if(h.hasOwnProperty("dispValue")){g.title=h.dispValue}else{g.title=h.object}w[r].push(g)}var o=p.results;if(!o){o=[]}for(q=0;q<o.length;++q){var m=o[q];if(!m){continue}var l=m.attributes;var k={};for(n=0;n<l.length;++n){var t=l[n];if(v.hasOwnProperty(t.name)){var f=v[t.name];k[f.property]=t.value;if(f.date){var s=new Date(t.value);k[f.property]=s.toLocaleString()}if(f.useDisplayValue&&t.hasOwnProperty("dispValue")){k[f.property]=t.dispValue}}}if(!k.thumbnail){if(k.preview){k.thumbnail=k.preview}else{k.thumbnail=k.icon}}if(k.type==="Analytics Case"){w.analyticsCase.push(new b({id:k.resourceid,physicalId:k.resourceid,name:k.name,title:k.title,thumbnail:k.thumbnail,type:k.type,policy:k.collabPolicy,project:k.collabSpace,responsible:k.responsible,owner:k.responsible,ownerFullName:k.responsible,author:e.is(k.originator)?k.originator:k.responsible,authorFullName:e.is(k.originator)?k.originator:k.responsible,revision:k.revision,casename:k.name,description:k.description,originated:k.creationDate,modified:k.modificationDate,organization:k.organization}))}}return w}var a={transform:function(f){return c(f)},tagMap:function(){return d()},};return a});define("DS/SMAAnalyticsCommon/SMAAnalyticsCaseCollection",["UWA/Core","UWA/Class/Collection","DS/UIKIT/Mask","DS/SMAAnalyticsCommon/SMAAnalyticsCaseModel","DS/SMAAnalyticsCommon/SMAAnalyticsTagger","DS/SMAAnalyticsCommon/SMAAnalyticsSearch","DS/SMAAnalyticsCommon/SMAAnalyticsSearchUtils","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/SMAAnalyticsCommon/SMAAnalyticsCommonProxy"],function(d,e,c,a,g,b,f,h,i){return e.extend({model:a,_nextStart:null,_numResults:60,_nRetResults:-1,_loadingFirstTime:true,_setUpComplete:false,_search_in_progress:false,_searchTerm:"",pages:0,scrollView:null,setup:function(k,j){widget.__caseCollection__=this;this._parent(k,j)},sync:function(n,m,j){d.log("SMAAnalyticsCaseCollection: sync : Start");var l=this;switch(n){case"read":var k=g.getFilters();l._searchTerm=k.search;l._preProcessing().then(function(){l._getSearchData(k).then(function(o){l._getRecentData(k).then(function(p){if(p.results){o.results=p.results.concat(o.results)}j.onComplete(o);d.log("SMAAnalyticsCaseCollection: sync : Complete")},function(p){d.log("SMAAnalyticsCaseCollection: sync : Recent webservice failed "+p);j.onComplete(o)})},function(o){d.log("SMAAnalyticsCaseCollection: sync : Search webservice failed "+o);l.scrollView.useInfiniteScroll(false);h.showWarningNotification("","Invalid search.");j.onComplete(null)}.bind(l))}.bind(l))}},parse:function(n){var l=widget.body;if(c.isMasked(l)){c.unmask(l)}var m=[];if(!d.is(n)){return m}try{if(this._search_in_progress){this._search_in_progress=false;this.reset();if(this._searchTerm&&this._searchTerm!==""){this._noResultNotification(n.infos.nresults)}}if(n instanceof String){n=JSON.parse(n)}this._nRetResults=n.infos.nresults;this._nextStart=d.is(n.infos.next_start)?n.infos.next_start:null;try{g.onTagChange(this._tagChange.bind(this));g.onSearchChange(this._tagChange.bind(this));g.set(n.facets)}catch(j){}var k=f.transform(n);m=this._models.concat(k.analyticsCase);this.pages++}catch(j){}finally{this.setUpComplete=true;return m}},_getSearchData:function(k){var j=this;return new Promise(function(m,l){b.getData({onComplete:function(n){m(n)},onError:function(n){l(n)},filterTags:k.tags,addFilter:k.search,next_start:j._nextStart,nresults:j._numResults,servicename:"search"})})},_getRecentData:function(j){return new Promise(function(l,k){b.getData({onComplete:function(m){l(m)},onError:function(m){k(m)},servicename:"recent",addFilter:j.search})})},_noResultNotification:function(j){if(j===0){h.showInfoNotification("","Sorry, no matches found.")}},_preProcessing:function(){widget._RA_FIRST_TIME_LOADING_=true;return new Promise(function(k,j){k()})},_tagChange:function(){var j=widget.body;c.mask(j);this._search_in_progress=true;this._nextStart=null;this.setUpComplete=false;this.fetch()},addNewCaseModel:function(m){if(d.is(m)){var j=this.findWhere({id:m.physicalId});if(j){return j}var l=this.toArray();var k=new a();k.set("id",m.physicalId);k.set("title",m.title||"");k.set("content",m.ownerFullName||"");k.set("subtitle",h.getModifiedInterval(m.modified));k.set("owner",m.owner||"");k.set("revision",m.revision);l.unshift(k);this.reset();this.set(l);return k}else{return undefined}},loadNextPage:function(j){var k=this;var l={onComplete:function(m){if(!j){if(m.hasNextPage()){m.scrollView.endLoading();m.scrollView.useInfiniteScroll(true)}else{m.scrollView.useInfiniteScroll(false)}}else{if(m.hasNextPage()){j.onComplete()}else{m.scrollView.useInfiniteScroll(false)}}}};if(this._loadingFirstTime){this._loadingFirstTime=false;setTimeout(function(){j.onComplete()},3000)}else{this._setUpComplete=false;this.fetch(l)}},hasNextPage:function(){if(d.is(this._nRetResults)&&this._nRetResults===0){return false}return true}})});define("DS/SMAAnalyticsCommon/SMAAnalyticsCompare",["UWA/Core","DS/Logger/Logger","module","DS/SMAAnalyticsCommon/SMAAnalyticsWorker"],function(f,b,e,d){var a=null,c=f.Class.singleton({init:function(){a=this;a.workerAPI=null;a.iconData=[]},initialize:function(g){a.workerAPI=d;if(f.is(g)&&f.is(g.workerAPI)){a.workerAPI=g.workerAPI}a.workerAPI.initialize()},_isSavedCase:function(){return a.workerAPI.isSavedCase()},_getCompareData:function(g){return new Promise(function(i,h){a.workerAPI.getCompareData(g).then(i,h)})},_getColumnIdsByScore:function(g){return a.workerAPI.getColumnIdsByScore(g)},_getParameterMergeData:function(g){return new Promise(function(i,h){a.workerAPI.getParameterMergeData().then(i,h)})},_setCommentOnRow:function(i,h,g){return a.workerAPI.setCommentOnRow(i,h,g)},_getCommentsForRow:function(g){return a.workerAPI.getCommentsForRow(g)},_getAllParametersAsArray:function(){return a.workerAPI.getParametersAll()},_mergeParameters:function(h,g,i){return a.workerAPI.mergeParameters(h,g,i)},_toggleRecommendedRow:function(g){return a.workerAPI.toggleRecommendedRow(g)},_toggleLikeRow:function(g){return a.workerAPI.toggleLikeRow(g)},_setParameterFilter:function(g){return a.workerAPI.setParameterFilter(g)},_saveCase:function(g){return new Promise(function(i,h){a.workerAPI.saveCase(g).then(i,h)})},_mapRequirements:function(g){return new Promise(function(i,h){a.workerAPI.mapRequirements(g).then(i,h)})},_modifyFormulation:function(g){return a.workerAPI.modifyFormulation(g)},_modifyParameter:function(g){return a.workerAPI.modifyParameter(g)},_getSavedViewState:function(){return a.workerAPI._getSavedViewState();return a.workerAPI._getSavedViewState()},_setupIconView:function(){return a.workerAPI.setupIconView()},getCompareData:function(g){return new Promise(function(i,h){a.workerAPI.getCompareData(g).then(i,h)})},isSavedCase:function(){return a._isSavedCase()},getColumnIdsByScore:function(g){return a._getColumnIdsByScore(g)},getParameterMergeData:function(){return a._getParameterMergeData()},setCommentOnRow:function(i,h,g){return a._setCommentOnRow(i,h,g)},getCommentsForRow:function(g){return a._getCommentsForRow(g)},toggleRecommendedRow:function(g){return a._toggleRecommendedRow(g)},toggleLikeRow:function(g){return a._toggleLikeRow(g)},getAllParametersAsArray:function(){return a._getAllParametersAsArray()},mergeParameters:function(h,g,i){return a._mergeParameters(h,g,i)},setParameterFilter:function(g){return a._setParameterFilter(g)},saveCase:function(g){return a._saveCase(g)},mapRequirements:function(g){return a._mapRequirements(g)},modifyFormulation:function(g){return a._modifyFormulation(g)},modifyParameter:function(g){return a._modifyParameter(g)},setupWorker:function(){return new Promise(function(h,g){a.workerAPI.startWorker().then(function(i){h(i)},function(){g()})})},updateWorker:function(g){return new Promise(function(i,h){a.workerAPI.updateWorker(g).then(i,h)})},checkForChanges:function(g){return new Promise(function(i,h){if(f.is(a.workerAPI)&&a.workerAPI.isRunning()){a.workerAPI.checkForChanges(g).then(i,h)}else{i(false)}})},setupIconView:function(){return new Promise(function(h,g){if(a.iconData.length===0){a._setupIconView().then(function(i){a.iconData=i;h()},g)}else{h()}})},clear:function(){a.iconData=[];if(f.is(a.workerAPI)){a.workerAPI.clear()}},getAlternativeCount:function(){return new Promise(function(h,g){a.workerAPI.getAlternativeCount().then(h,h)})},getAlternatives:function(){return new Promise(function(h,g){a.workerAPI.getAlternatives().then(h,h)})},hideAlternatives:function(g){return new Promise(function(i,h){a.workerAPI.hideAlternatives(g).then(i,i)})},unhideAlternatives:function(g){return new Promise(function(i,h){a.workerAPI.unhideAlternatives(g).then(i,i)})},removeAlternatives:function(g){return new Promise(function(i,h){a.workerAPI.removeAlternatives(g).then(i,i)})}});return c});define("DS/SMAAnalyticsCommon/utils/SMAAnalyticsSaveUtils",["UWA/Core","DS/Logger/Logger","module","DS/SMAAnalyticsCommon/SMAAnalyticsUtils","DS/SMAAnalyticsCommon/SMAAnalyticsCase","i18n!DS/SMAAnalyticsCommon/assets/nls/SMAAnalyticsCommon","DS/SMAAnalyticsCommon/dialogs/SMAAnalyticsSaveDialog","DS/SMAAnalyticsCommon/SMAAnalyticsCompare"],function(f,c,b,j,a,i,g,e){var h=c.getLogger(b);var d={_openSaveDialog:function(l){var k={immersiveFrame:j.getImmersiveFrame(),label:i.get("CASE_SAVE_MESSAGE"),header:f.is(l)?l:i.get("ARE_YOU_SURE"),okLabel:i.get("SAVE_BUTTON"),applyLabel:i.get("DONT_SAVE")};return new Promise(function(n,m){g.showDialog(k).then(n,m)})},checkForChanges:function(k){return new Promise(function(m,l){e.checkForChanges(k).then(function(n){if(n){this.openSavePrompt(k).then(m,l)}else{m()}}.bind(this),m)}.bind(this))},openSavePrompt:function(k){return new Promise(function(m,l){this._openSaveDialog().then(function(n){if(n){j.mask(i.get("SAVING"));this.saveCase({currentViewState:k}).then(function(){j.showSuccessNotification("",i.get("SAVE_SUCCESS"));j.unmask();m()},function(o){j.unmask();h.error(o);j.showErrorNotification("",i.get("SAVE_ERROR"));l(o)})}else{if(typeof m==="function"){m()}else{h.warn("Resolve function not provided")}}}.bind(this),l)}.bind(this))},saveCase:function(k){return new Promise(function(m,l){try{e.saveCase(k).then(function(){m()},function(o){l(o)})}catch(n){j.unmask();l(n)}})}};return d});
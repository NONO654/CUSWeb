(function(g){var b,f,d,j,s,p,a,o,i,l,n,k,r,q,c,e,m,h={PARSEERROR:"SMAMpaCAEWidgetLauncher.caeProcessCreator.1",PROCESSKINDERROR:"SMAMpaCAEWidgetLauncher.caeProcessCreator.2",TEMPLATEERROR:"SMAMpaCAEWidgetLauncher.caeProcessCreator.3",CREATEPROCESSWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.4",GETTEMPLATEWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.5",GETTEMPLATEOPTIONSWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.6",INSTANTIATETEMPLATEWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.7",VALIDATECAEPROCESSWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.8",MULTIPLEACTIVITIESPROCESS:"SMAMpaCAEWidgetLauncher.caeProcessCreator.9",CONNECTREFRELATIONSHIPWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.10",CONNECTSIMDATARELATIONSHIPWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.11",GETACTIVITYINFOFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.12",GETSTEPINFOWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.13",UPDATESTEPINFOWSFAILED:"SMAMpaCAEWidgetLauncher.caeProcessCreator.14",INCORRECTADAPTOR:"SMAMpaCAEWidgetLauncher.caeProcessCreator.15",NOINTERNALDATA:"SMAMpaCAEWidgetLauncher.caeProcessCreator.16",NOCLOUDINFO:"SMAMpaCAEWidgetLauncher.caeProcessCreator.17"};b=function(v,u){var t;try{t=JSON.parse(u.response)}catch(w){this.fire(this.COMMON_EVENTS.ERROR,{errorCode:h.PARSEERROR,isFatal:true})}v.call(this,t)};n=function(u,w,v,t){this.fire(this.COMMON_EVENTS.ERROR,{errorCode:u,isFatal:w,replaceKey:v,message:t})};e=function(t){this._Options=t;this._CAELauncherUtil.sendRequest({uri:"/resources/e6w/service/SMA_Process",appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"POST",payload:{datarecords:{datagroups:[{updateAction:"CREATE",dataelements:{title:{value:[{value:t.SimulationName}]},"Simulation Kind":{value:[{value:t.SimulationKind}]}}}],name:"SMA_Process"},name:"SMA_Process"},onComplete:b.bind(this,r),onError:n.bind(this,h.CREATEPROCESSWSFAILED,true,null)})};r=function(t){if(t.hasOwnProperty("options")){this._Options=t.options}else{this._Options.processID=t.datarecords.datagroups[0].physicalId}this._CAELauncherUtil.sendRequest({uri:"/resources/slmservices/templates?templateType=type_SimulationActivity&name="+this._Options.TemplateName,appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"GET",payload:{},onComplete:b.bind(this,function(v){var x=false,u=[];for(var w=0;w<v.length;w++){if(v[w].currentState==="Released"){u.push(v[w])}}for(var w=0;w<u.length;w++){if(u[w].revision===this._Options.TemplateRevision){x=true;q.call(this,u[w])}}if(!x){if(u.length>0){q.call(this,u[0])}n.call(this,h.TEMPLATEERROR,true,null)}}),onError:n.bind(this,h.GETTEMPLATEWSFAILED,true,null)})};q=function(t){this._Options.templateId=t.id;this._CAELauncherUtil.sendRequest({uri:"/resources/slmservices/templates/"+this._Options.templateId+"/options",appendSecurityContext:true,responseType:"json",isE6WCall:false,headers:{},verb:"GET",payload:{},onComplete:b.bind(this,c),onError:n.bind(this,h.GETTEMPLATEOPTIONSWSFAILED,true,null)})};c=function(u){var t=u;if(t[2].hasOwnProperty("title")&&t[2].hasOwnProperty("value")){if(t[2].title==="Title"){t[2].value=this._Options.ActivityName}}this._CAELauncherUtil.sendRequest({uri:"/resources/slmservices/templates/"+this._Options.templateId+"/instantiate?pid="+this._Options.processID,appendSecurityContext:true,responseType:"text",isE6WCall:false,headers:{"Content-Type":"json"},verb:"POST",data:JSON.stringify(t),onComplete:this.session.onCloud()?a.bind(this):i.bind(this),onError:n.bind(this,h.INSTANTIATETEMPLATEWSFAILED,true,null)})};a=function(x){var t,w,v,u,A,z,y;if(g.widget){t=g.widget.getValue("tenantId");w=g.widget.getValue("myAppsUrl")}y=x.response;if(t&&w){v={datarecords:{datagroups:[],name:""},name:""};v.name="SMA_Parameter";v.datarecords.name="SMA_Parameter";v.datarecords.datagroups=[{updateAction:"CREATE",objectId:y,dataelements:{type:{value:[{value:"string"}]},name:{value:[{value:"MX_ONLINE_INSTANCE"}]},mode:{value:[{value:"input"}]},valuetype:{value:[{value:"single"}]},Value:{value:[{value:t}]}}},{updateAction:"CREATE",objectId:y,dataelements:{type:{value:[{value:"string"}]},name:{value:[{value:"MyAppsUrl"}]},mode:{value:[{value:"input"}]},valuetype:{value:[{value:"single"}]},Value:{value:[{value:w}]}}}];z=function(){this.fire("appmessage",{level:"error",category:"parameterSetFailMsg",message:"Unable to set required parameters for creating lightweight visualization data."})}.bind(this);u={onComplete:A,onFailure:z};this.session.set3DXParameters(y,v,i.bind(this,x),z)}else{n.call(this,h.NOCLOUDINFO,true,null)}};i=function(t){this._Options.activityID=t.response;this._Options.instantiatedFromTemplate=true;if(this._Options.disconnectedData!==undefined){m.call(this,{})}else{this._Options.onComplete(this._Options.activityID)}};m=function(t){if(t.hasOwnProperty("options")){this._Options=t.options}this._Options.onValidationComplete=o;if(this._Options.onlyValidate){this._Options.onValidationComplete=function(u){if(u.error){n.call(this,h.PROCESSKINDERROR,true,null)}else{this._Options.onComplete(u)}}}this._CAELauncherUtil.sendRequest({uri:"/resources/e6w/service/SMA_ValidateCompanionProcess",appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"POST",payload:{datarecords:{datagroups:[{updateAction:"MODIFY",dataelements:{simulationId:{value:[{value:this._Options.processID}]},adapterId:{value:[{value:this._Options.ExtensionName}]}}}],name:"SMA_ValidateCompanionProcess"},name:"SMA_ValidateCompanionProcess"},onComplete:b.bind(this,this._Options.onValidationComplete),onError:n.bind(this,h.VALIDATECAEPROCESSWSFAILED,true,null)})};o=function(t){if(t.datarecords.datagroups[0].dataelements.hasOwnProperty("flowItemId")){if(this._Options.hasOwnProperty("instantiatedFromTemplate")&&this._Options.instantiatedFromTemplate===true){if(this._Options.activityID===t.datarecords.datagroups[0].dataelements.physicalid.value[0].value){this._Options.flowItemId=t.datarecords.datagroups[0].dataelements.flowItemId.value[0].value;this._CAELauncherUtil.sendRequest({uri:"/resources/e6w/service/SMA_Content?objectId="+this._Options.processID+"&SIMULATIONId="+this._Options.processID,appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"GET",payload:{},onComplete:b.bind(this,p),onError:n.bind(this,h.INSTANTIATETEMPLATEWSFAILED,true,null)})}else{n.call(this,h.MULTIPLEACTIVITIESPROCESS,true,null);return}}else{this._Options.activityID=t.datarecords.datagroups[0].dataelements.physicalid.value[0].value;this._Options.flowItemId=t.datarecords.datagroups[0].dataelements.flowItemId.value[0].value;this._Options.activityID=t.datarecords.datagroups[0].dataelements.physicalid.value[0].value;s.call(this)}}else{if(this._Options.hasOwnProperty("instantiatedFromTemplate")&&this._Options.instantiatedFromTemplate===true){n.call(this,h.INCORRECTADAPTOR,true,null)}else{r.call(this,{options:this._Options})}}};p=function(w){this._Options.processInternalDataPhysicalId=undefined;for(var v in w.datarecords.datagroups){if(w.datarecords.datagroups.hasOwnProperty(v)){var t=w.datarecords.datagroups[v];if(t.busType==="Simulation Category - Internal Data"){this._Options.processInternalDataPhysicalId=t.physicalId;break}}}if(this._Options.processInternalDataPhysicalId===undefined){n.call(this,h.NOINTERNALDATA,true,null)}else{if(this._Options.disconnectedData&&this._Options.disconnectedData.length>0){this._Options.totalRefCount=this._Options.disconnectedData.length;this._Options.refAddSuccess=0;for(var u=0;u<this._Options.disconnectedData.length;u++){this._CAELauncherUtil.sendRequest({uri:"/resources/e6w/service/SMA_Content",appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"POST",payload:{datarecords:{datagroups:[{updateAction:"CONNECT",objectId:this._Options.processID,dataelements:{containerId:{value:[{value:this._Options.processInternalDataPhysicalId}]},contentId:{value:[{value:this._Options.disconnectedData[u].modelID}]}}}],name:"SMA_Content"},name:"SMA_Content"},onComplete:b.bind(this,l),onError:n.bind(this,h.CONNECTREFRELATIONSHIPWSFAILED,true,null)})}}else{this._Options.refAddSuccess=0;this._Options.totalRefCount=1;l.call(this)}}};l=function(){this._Options.refAddSuccess=this._Options.refAddSuccess+1;if(this._Options.refAddSuccess===this._Options.totalRefCount){this._Options.onComplete(this._Options.activityID)}else{console.log("Ref content Added")}};s=function(t){if(this._Options.ClearProductId){}else{this._Options.simDataRelationshipUUID=t.datarecords.datagroups[0].dataelements.simDataRelationshipUUID.value[0].value}this._CAELauncherUtil.sendRequest({uri:"/resources/e6w/service/SMA_Activity?objectId="+this._Options.activityID,appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"GET",payload:{},onComplete:b.bind(this,j),onError:n.bind(this,h.GETACTIVITYINFOFAILED,true,null)})};j=function(t){this._Options.activityCEStamp=t.datarecords.datagroups[0].cestamp;this._CAELauncherUtil.sendRequest({uri:"/resources/e6w/service/SMA_Step?objectId="+this._Options.activityID+"&stepId="+this._Options.flowItemId,appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"GET",payload:{},onComplete:b.bind(this,d),onError:n.bind(this,h.GETSTEPINFOWSFAILED,true,null)})};d=function(v){var u="";if(this._Options.ClearProductId){var t=v.datarecords.datagroups[0].dataelements.StepFlowItem.value[0].value;if(t.contains("referenceId")){u="{&quot;name&quot;:&quot;AbaqusCAELauncher&quot;,&quot;xsi:type&quot;:&quot;wfcmm:functionStepType&quot;,&quot;description&quot;:&quot;null&quot;,&quot;StepConfig&quot;:{&quot;extensionName&quot;:&quot;"+this._Options.ExtensionName+"&quot;,&quot;extensionWrittenVersion&quot;:&quot;*.*.*&quot;,&quot;extensionLoadVersion&quot;:&quot;null&quot;,&quot;Properties&quot;:{}},&quot;id&quot;:&quot;"+this._Options.flowItemId+"&quot;,&quot;ExecutionConfig&quot;:{}}"}else{f.call(this);return}}else{u="{&quot;name&quot;:&quot;AbaqusCAELauncher&quot;,&quot;xsi:type&quot;:&quot;wfcmm:functionStepType&quot;,&quot;description&quot;:&quot;null&quot;,&quot;StepConfig&quot;:{&quot;extensionName&quot;:&quot;"+this._Options.ExtensionName+"&quot;,&quot;extensionWrittenVersion&quot;:&quot;*.*.*&quot;,&quot;extensionLoadVersion&quot;:&quot;null&quot;,&quot;Properties&quot;:{&quot;Property&quot;:{&quot;name&quot;:&quot;ProductID&quot;,&quot;Value&quot;:{&quot;&lt;![CDATA]&gt;&quot;:&quot;&lt;Rule id = \\&quot;999\\&quot; name = \\&quot;vpmrule\\&quot; enabled = \\&quot;true\\&quot; sourceFileName = \\&quot;*\\&quot; exportMethod = \\&quot;exporter\\&quot; exportPath = \\&quot;excludeCategoryFolder\\&quot; exportEmptyFolders = \\&quot;False\\&quot; exportSource = \\&quot;All\\&quot; referenceId =  \\&quot;"+this._Options.simDataRelationshipUUID+"\\&quot; contentRel = \\&quot;referenced\\&quot; impactRel = \\&quot;none\\&quot; exportDocType = \\&quot;VPM\\&quot;/&gt;&quot;}}}},&quot;id&quot;:&quot;"+this._Options.flowItemId+"&quot;,&quot;ExecutionConfig&quot;:{}}"}this._CAELauncherUtil.sendRequest({uri:"/resources/e6w/service/SMA_Step?objectId="+this._Options.activityID+"&stepId="+this._Options.flowItemId,appendSecurityContext:true,responseType:"json",isE6WCall:true,headers:{},verb:"POST",payload:{datarecords:{datagroups:[{updateAction:"MODIFY",objectId:this._Options.activityID,dataelements:{StepId:{value:[{value:this._Options.flowItemId}]},StepFlowItem:{value:[{value:u}]},cestamp:{value:[{value:this._Options.activityCEStamp}]}}}],name:"SMA_Step"},name:"SMA_Step"},onComplete:b.bind(this,f),onError:n.bind(this,h.UPDATESTEPINFOWSFAILED,true,null)})};f=function(){this._Options.onComplete(this._Options.activityID)};k=function(){this._CAELauncherUtil=this.$.caeLauncherUtil};g.DS.SMAMpaCAEWidgetLauncher=g.DS.SMAMpaCAEWidgetLauncher||{};g.DS.SMAMpaCAEWidgetLauncher.CAEProcessCreator=g.Polymer({is:"cae-process-creator",properties:{session:{type:Object,value:{}}},createCaeProcess:e,validateProcess:m,ready:k,behaviors:[g.DS.SMAProcSP.SPBase]});g.DS.SMAMpaCAEWidgetLauncher.CAEProcessCreator.ERRORCODES=h}(this));
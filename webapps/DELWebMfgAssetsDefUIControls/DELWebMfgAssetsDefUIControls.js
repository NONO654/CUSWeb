define("DS/DELWebMfgAssetsDefUIControls/MfgItemDataCollectionFormUI",["UWA/Core","UWA/Controls/Abstract","DS/Controls/Editor","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/Controls/Toggle","DS/Controls/DatePicker","DS/Core/Events","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/AttributeUtil","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/ModelPreferences"],function(d,r,s,v,f,c,z,k,w,A,b,y,x,p){var g=r.extend({init:function(D,C,B){this._buildSkelton(D,C)},_buildSkelton:function q(G,C){var E=this,F,H,B=G.split("/")[1]||"",D=function D(I){B=I.dsModel.value;H=I.currentTarget.innerText;F=E.packageName.concat("/",B);E._controlsContainer.destroy();E._control={};E._control.V_Type=F;E.buildFromConfig(B);C(H)};this.packageName=G.split("/")[0],this._mainContainer=new d.Element("div",{"class":"controlsScrollDiv",styles:{"margin-top":"25px"}});this._control={};E.buildTypesSelectionCtrl(B,D,this._mainContainer);E.buildFromConfig(B);this.elements=this.elements||{};this.elements.container=this._mainContainer},buildFromConfig:function m(C){var D=this,B;if(true===widget.getBool("showDialog")){b.getXMLValues("DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIInsertCmdFormAttribute",function(F){var E;E=D.getFieldsFromFormConfig(C,F);D._controlsContainer=new d.Element("div",{});D._controlsContainer.inject(D._mainContainer);D.buildFields(E,C)})}return m},buildLineEditCtrl:function u(C,B,D){var E=new v({requiredFlag:D,value:B});this._control[C]=E;return E},buildEditerCtrl:function h(C,B,D){var E=new s({requiredFlag:D,value:B});this._control[C]=E;return E},buildToggleCtrl:function l(C,B){var D=new c({type:"switch",label:B});this._control[C]=D;return D},buildDatePicker:function o(B){var C=new z();this._control[B]=C;return C},buildComboBox:function t(F,I,B,D){var C=this,H,G=[],E;for(E=0;E<I.length;E++){G[E]={labelItem:I[E].label,valueItem:I[E].value}}H=new f({elementsList:G,actionOnClickFlag:true,enableSearchFlag:false,value:B});H.elements.container.style.minWidth="170px";this._control[F]=H;if(d.is(D,"function")){H.addEventListener("change",D)}return H},buildTypesSelectionCtrl:function j(J,F,G){var I=this,H,C,B,D,E=[];C=function C(L,K){var M=0;if(L<K){M=-1}else{if(L>K){M=1}}return M};E.push({value:J,label:w.getNLSValue(J,null,"Type")});H=p.getTypeHierarchy(J);if(d.is(H,"array")){H.sort(C);H.forEach(function(K){if(K!==J){E.push({value:K,label:w.getNLSValue(K,null,"Type")})}})}B=new d.Element("div",{"class":"row wux-dialog-inline-container"});new d.Element("h5",{"class":"col-sm-5 col-md-5  col-lg-5 wux-textElement",text:w.getNLSValue("Type"),styles:{"font-weight":"normal"}}).inject(B);D=I.buildComboBox("V_Type",E,"",F);D.inject(B);G=d.is(G)?G:I._controlsContainer;B.inject(G)},getFieldsFromFormConfig:function n(C,B){var D=B.convert("AttributesDescriptionList.Type","name")[C]||{};if(!D.hasOwnProperty("Section")){D.Section={};D.Section.Attribute=[{dicoType:"PLMEntity",name:"V_Name",mandatory:true},{dicoType:"PLMEntity",name:"V_description"}]}return D},buildFields:function e(G,K){var I=this,D=[],C=false,F,H=function H(){var L={};if(C===true){C=false;L.type="html";L.html='<span class="text-warning" >'+w.getNLSValue("InsertCmd.WarningConfiguration")+"</span>";D[D.length]=L}},B=function B(L){var M={};M.type="html";M.html="<h4>"+L;D[D.length]=M},J=function J(L){var P=w.getAttributeInfo(L.dicoType+"."+L.name),N,M,O;if(d.is(P)!==true){C=true;return}N=A.getDefaultValue(P);M=(d.is(P)&&A.hasMagnitude(P))?" ["+w.getNLSForUnit(A.getMagnitude(P))+"]":"";O={name:A.getFullName(P),label:A.getNLS(P),mandatory:L.mandatory};if(A.isReadOnly(P,null,true)){return}if(M!==""){O.label=A.getNLS(P)+M}O=A.createField(O,N,P);I.insertControl(O,K)},E=function E(M){var L;for(L in M){if(M.hasOwnProperty(L)){switch(L.toLowerCase()){case"name":B(M[L]);break;case"attribute":if(Array.isArray(M[L])){M[L].forEach(J)}else{J(M[L])}break;default:break}}}};for(F in G){if(G.hasOwnProperty(F)){switch(F.toLowerCase()){case"section":if(d.is(G[F])){if(Array.isArray(G[F])){G[F].forEach(E)}else{E(G[F])}}break;default:break}}}H();return D},insertControl:function a(F,C){var D=this,E,B=new d.Element("div",{"class":"row wux-dialog-inline-container"});new d.Element("h5",{"class":"col-sm-5 col-md-5  col-lg-5 wux-textElement",text:F.label,styles:{"font-weight":"normal"}}).inject(B);switch(F.type){case"text":E=D.buildLineEditCtrl(F.name,C,F.mandatory);break;case"textarea":E=D.buildEditerCtrl(F.name,F.value,F.mandatory);break;case"checkbox":E=D.buildToggleCtrl(F.name,F.value);break;case"date":E=D.buildDatePicker(F.name);break;case"select":E=D.buildComboBox(F.name,F.options,F.value);break;default:E=D.buildLineEditCtrl(F.name,C,F.mandatory);break}E.inject(B);B.inject(this._controlsContainer)},getValues:function(){var B={},D,E;for(var C in this._control){if(this._control.hasOwnProperty(C)){E=w.getAttributeInfo(C);switch(C){case"V_Type":if(this._control[C].value){B[C]=this.packageName.concat("/",this._control[C].value)}else{B[C]=this._control[C]}break;default:if(d.is(C)){if(A.isDate(E)){D=this._control[C].value}else{D=A.getFieldValue(this._control[C].value,E)}if(d.is(D)){B[C]=D}}break}}}return B},validate:function i(){for(var B in this._control){if(this._control[B].requiredFlag==true&&this._control[B].value==""){x.AlertManager.add({className:"error",message:w.getNLSValue("Error.fillMandatoryField.Title"),});return false}}return true}});return g});define("DS/DELWebMfgAssetsDefUIControls/ReconnectOrRevReconnectScopeDialogWebService",["UWA/Core","UWA/Class","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils"],function(g,a,h,d,b,i){var f=a.singleton({name:"ReconnectOrRevReconnectScopeDialogWebService",reconnectScopeWS:function c(k,p,o,q){var j="POST",n,l,m;if(k==="ReconnectScope"){n=g.Json.encode({selectedHigherProductID:p,selectedMfgItemID:o,reviseMfgItem:false})}else{if(k==="ReviseAndReconnectScope"){n=g.Json.encode({selectedHigherProductID:p,selectedMfgItemID:o,reviseMfgItem:true})}}l=function l(){if(k==="ReconnectScope"){d.AlertManager.add({className:"error",message:h.getNLSValue("Error.ReconnectScopeFailure.Title")})}else{if(k==="ReviseAndReconnectScope"){d.AlertManager.add({className:"error",message:h.getNLSValue("Error.ReviseNReconnectScopeFailure.Title")})}}};m=function m(y){var x=[],u=[],w=[],v=[],r=null;y.revisedObjects.forEach(function(A){var z=A.revisedFrom;if(z===o){r=A.revisedTo}});y.instancesAndReferences.forEach(function(A){var z=A.attributesValue;x.push(z)});y.connections.forEach(function t(A){var z=i.parseConnection(A);w.push(z)});i.addToCollections({stackedReferences:x,stackedInstances:u,stackedConnections:w,deletedObjects:v,onComplete:function s(){if(g.is(q)){q(o,r)}}})};b.webServiceRequest({url:"modeler/ppr/MfgItem/ReconnectScopeLink",method:j,headers:b.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),data:n,context:this,onFailure:l,onTimeout:l,onCancel:l,onComplete:m})},validateMfg:function e(j,o,p){var m=this,k,l,n;l=function l(){if(j==="ReconnectScope"){d.AlertManager.add({className:"error",message:h.getNLSValue("Error.ReconnectScopeFailure.Title")})}else{if(j==="ReviseAndReconnectScope"){d.AlertManager.add({className:"error",message:h.getNLSValue("Error.ReviseNReconnectScopeFailure.Title")})}}};n=function n(q){if((g.is(q.isReadOnly)&&q.isReadOnly)||(g.is(q.isLatestRevision)&&!(q.isLatestRevision))){d.AlertManager.add({className:"error",message:m.errMsg})}else{p()}};if(j==="ReconnectScope"){k="modeler/ppr/isReadOnly";this.errMsg=h.getNLSValue("Error.MfgNotInReadWrite.Title")}else{if(j==="ReviseAndReconnectScope"){k="modeler/ppr/isLatestRevision";this.errMsg=h.getNLSValue("Error.MfgNotLatestRevision.Title")}}b.webServiceRequest({url:k,method:"GET",data:{pid:o},onFailure:l,onTimeout:l,onCancel:l,onComplete:n})}});return f});define("DS/DELWebMfgAssetsDefUIControls/DocumentDisplayComponent",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/Controls/Editor","DS/Tree/TreeListView","DS/Tree/TreeNodeModel","DS/DELWebMfgAssetsDefModelServices/Resources"],function(a,g,h,o,d,b,c){var k=g.extend({init:function p(q){this.context=q.context;this.documents=q.documents;this.callbacks=q.callbacks;this._buildSkelton()},_buildSkelton:function(){this._buildDataGrid(this.documents);this._addDocData(this.documents)},updateDocNode:function j(r,q){this._addFileData(r,q.relateddata.files)},removeDocNode:function m(q){q.remove()},updateFileNode:function n(r,q){r.prepareUpdate();r.setLabel(q.dataelements.title);r.setAttribute("documentID",q.id);r.setAttribute("file_desc",q.dataelements.comments);r.setAttribute("creationDate",q.dataelements.created);r.pushUpdate()},removeFileNode:function l(q){q.remove()},_addDocData:function f(u){var s,q;for(s=0;s<u.length;s++){var r=u[s],t=r.get("relateddata").files;q=new b({label:r.get("dataelements").title,grid:{documentID:r.get("id"),commands:["Download","Update","Delete","Explore"],file_desc:r.get("dataelements").description,policy:c.getNLSValue(r.get("dataelements").policy),creationDate:r.get("dataelements").originated}});this._addFileData(q,t);this.documents_grid.addRoot(q)}},_addFileData:function e(q,s){var r;s.forEach(function(t){r=new b({label:t.dataelements.title,grid:{documentID:t.id,commands:["DownloadFile","ModifyFile","RemoveFile","ViewFile"],file_desc:t.dataelements.comments,creationDate:t.dataelements.created}});q.addChild(r)})},_buildDataGrid:function i(){var r=this,s;s={columns:[{dataIndex:"documentId",width:0,isHidden:true},{text:c.getNLSValue("DocumentMgmtUI.FileName"),dataIndex:"tree",width:"20%",},{text:c.getNLSValue("DocumentMgmtUI.Commands"),dataIndex:"commands",width:"25%",isColumnMovable:false},{text:c.getNLSValue("DocumentMgmtUI.Description"),dataIndex:"file_desc",width:"20%",isColumnMovable:false},{text:c.getNLSValue("DocumentMgmtUI.DocPolicy"),dataIndex:"policy",width:"15%",isColumnMovable:false},{text:c.getNLSValue("DocumentMgmtUI.FileDate"),dataIndex:"creationDate",width:"20%",isColumnMovable:false}]};s.showVerticalLines=true;s.isSortable=false;s.isDraggable=false;s.isEditable=false;s.apiVersion=2;s.height="350";s.defaultCellHeight=40;s.selection={nodes:false,cells:false,canMultiSelect:false,columnHeaders:false,rowHeaders:false};s.resize={columns:true,rows:false};s.isEditable={switchToWriteView:{event:"dbclick",callback:function(u){return}},switchToReadView:{callback:function t(u){this.switchToReadView()},view:function q(A){var B,y,z,w,x,u=A.cellView.getContent(),v=A.cellModel.getCellContent();switch(A.dataIndex){case"commands":B=a.createElement("div",{"class":"commandsDiv"});x=function(C,D){y=new h({icon:C,className:"link",events:{onClick:D}});y.nodeModel=A.nodeModel;y.inject(B)};v.forEach(function(C){switch(C){case"Download":x("fonticon-download",function(){r.callbacks.Download.call(r,y.nodeModel)});break;case"Update":x("fonticon-plus-squared",function(){r.callbacks.Update.call(r,r.context,null,y.nodeModel)});break;case"Delete":x("fonticon-cancel",function(){r.callbacks.Delete.call(r,y.nodeModel)});break;case"ViewFile":x("fonticon-eye",function(){r.callbacks.ViewFile.call(r,y.nodeModel)});break;case"DownloadFile":x("fonticon-download",function(){r.callbacks.DownloadFile.call(r,y.nodeModel)});break;case"ModifyFile":x("fonticon-upload",function(){r.callbacks.ModifyFile.call(r,r.context,null,y.nodeModel)});break;case"RemoveFile":x("fonticon-cancel",function(){r.callbacks.RemoveFile.call(r,y.nodeModel)});break;case"Explore":x("fonticon-compass",function(){r.callbacks.Explore.call(r,y.nodeModel)});break;default:break}});setTimeout(function(){u.setAttribute("title","")},0);return B;case"file_desc":z=new o();z.value=v;z.disabled=true;return z;case"creationDate":if(v!==""){w=new Date(v);u.setAttribute("title",w.toLocaleString());setTimeout(function(){u.setAttribute("title",w.toLocaleString())},0);return w.toLocaleString()}default:return v}}}};this.documents_grid=new d(s);this.elements=this.elements||{};this.elements.container=this.documents_grid},});return k});define("DS/DELWebMfgAssetsDefUIControls/ConfirmationDialog",["UWA/Core","UWA/Controls/Abstract","DS/Controls/Button","DS/Controls/Toggle","DS/Windows/Dialog","DS/Controls/TooltipModel",],function(g,f,b,e,a,c){var d=function d(k){var j,o=(g.is(k)&&g.is(k.check,"string"))?true:false,m=f.extend({defaultOptions:{className:"confirmation-objectslist",appendObjects:false,showColumnHeaders:false},objectsTableBody:null,objectsTableHead:null,objectsTableFoot:null,init:function n(p){this._parent(p);this.buildSkeleton()},buildSkeleton:function(){var p=g.createElement("table",{"class":"table table-bordered table-condensed table-hover",id:"tableNames"});this.elements.container=p;this.objectsTableHead=g.createElement("thead");this.objectsTableFoot=g.createElement("tfoot");this.objectsTableBody=g.createElement("tbody",{id:"tableBody"});this.objectsTableHead.inject(p);this.objectsTableBody.inject(p);this.objectsTableFoot.inject(p)},setData:function i(s){var q=this,u,r,p=[],t=[],v=(g.is(s)&&g.is(s.attributes,"array"))?s.attributes:[],w=(g.is(s)&&g.is(s.models,"array"))?s.models:[];if(q.options.appendObjects===false){q.empty()}if(q.options.showColumnHeaders&&q.objectsTableBody!==null){if(v.length>0){v.forEach(function(x){p.push({tag:"th",text:x})});u=g.createElement("tr",{html:p});q.objectsTableHead.appendChild(u)}}if(q.objectsTableBody!==null){if(w.length>0){w.forEach(function(x){t=[];v.forEach(function(y){r=x.get(y);t.push({tag:"td",text:g.is(r)?r:""})});if(t.length>0){u=g.createElement("tr",{html:t});q.objectsTableBody.appendChild(u)}})}}},empty:function l(){if(this.objectsTableBody!==null){while(this.objectsTableBody.firstChild){this.objectsTableBody.removeChild(this.objectsTableBody.firstChild)}}}});j=function j(y,B,z,r,A,w){var v,s,q,u,p,x,t=g.createElement("div",{"class":"confirmation-dialog-content-container"});if(g.is(B,"string")){B=g.createElement("span",{"class":"confirmation-dialog-message",text:B});B.inject(t)}if(g.is(A)){A.inject(t)}if(o){s=new e({type:"checkbox",checkFlag:false,label:k.check});s.inject(t)}k=k||{};q={disabled:false,emphasize:"primary",onClick:function(){v.close();z.apply(null,[true,r,g.is(s)?s.checkFlag:null])}};if(g.is(k.okBtnOptions)){if(g.is(k.okBtnOptions.label)){q.label=k.okBtnOptions.label}if(g.is(k.okBtnOptions.tooltipInfos)){q.tooltipInfos=new c({shortHelp:k.okBtnOptions.tooltipInfos})}}u=new b(q);p={onClick:function(){v.close();z.apply(null,[false,r])}};if(g.is(k.cancelBtnOptions)){if(g.is(k.cancelBtnOptions.label)){p.label=k.cancelBtnOptions.label}if(g.is(k.cancelBtnOptions.tooltipInfos)){p.tooltipInfos=new c({shortHelp:k.cancelBtnOptions.tooltipInfos})}}x=new b(p);v=new a({title:y,immersiveFrame:w,content:t,minHeight:100,minWidth:400,modalFlag:true,resizableFlag:true,buttons:{Cancel:x,Ok:u,}});v.close=function(){this.destroy();B=null;y=null;v=null}};return{show:function h(s,y,q,v,r){var t,p,w,x,u;if(g.is(q)){if(g.is(q.models)){p=q.models;if(p.length>0){u=new m(k);u.setData(q);w=g.createElement("div",{"class":"confirmation-objectList"});x=u.getContent();x.inject(w)}}}j(s,y,v,p,w,r)}}};return d});define("DS/DELWebMfgAssetsDefUIControls/MfgItemSelectionFormUI",["UWA/Core","UWA/Controls/Abstract","DS/DELWebMfgAssetsDefModelServices/Resources"],function(b,e,c){var d=e.extend({init:function k(l){l=l||{};this.onSelection=b.is(l.onSelection,"function")?l.onSelection:undefined;if(b.is(l.bodyXSO)){this._bodyXSO=l.bodyXSO}if(b.is(l.mbomXSO)){this._mbomXSO=l.mbomXSO}if(b.is(l.multiSelectBodyNodes)){this.multiSelectBodyNodes=l.multiSelectBodyNodes}this._buildSkeleton()},_buildSkeleton:function i(){var o,m,n,l=this;l._mainContainer=new b.Element("div",{});l.elements=l.elements||{};l.elements.container=l._mainContainer;l.MfgItemDiv=this.createSection("Dialog.AssignProductMfgItem.Title",l._mainContainer);o="Info.SelectManufacturingItem.Title";l.MfgItemDiv.setHTML(c.getNLSValue(o));l.ProductItemDiv=this.createSection("Dialog.AssignProductItem.Title",l._mainContainer);o="Info.SelectProductsOrParts.Title";l.ProductItemDiv.setHTML(c.getNLSValue(o));l.prodtnrDiv=new b.Element("div",{"class":"scrollDiv"});l.prodtnrDiv.inject(l._mainContainer);if(0<l._bodyXSO.get().length){l.bodyNodes=l._bodyXSO.get();l.ProductItemDiv.empty();l.prodtnrDiv.empty();for(m=0;m<l.bodyNodes.length;m++){l.updateMultiNode(l.bodyNodes[m],l.prodtnrDiv)}}else{l.bodyToken=l._bodyXSO.onChange(function(p){l._mbomXSO.unsubscribe(l._mbomToken);l.ProductItemDiv.empty();l.prodtnrDiv.empty();if(!l.multiSelectBodyNodes){l._bodyXSO.unsubscribe(l.bodyToken);l.bodyToken=undefined;l.bodyNodes=p;l.updateLabel(l.ProductItemDiv,l.bodyNodes[0])}else{n=l._bodyXSO.get();l.bodyNodes=[];l.ProductItemDiv.empty();l.prodtnrDiv.empty();if(n.length===0){o="Info.SelectProductsOrParts.Title";l.ProductItemDiv.setHTML(c.getNLSValue(o));l.bodyNodes=undefined}else{n.forEach(function(q){l.updateMultiNode(q,l.prodtnrDiv);l.bodyNodes.push(q)})}}l.checkSelection()})}if(0<l._mbomXSO.get().length){l.mbomNodes=l._mbomXSO.get()[0];l.updateLabel(l.MfgItemDiv,l.mbomNodes)}else{l._mbomToken=l._mbomXSO.onPostAdd(function(p){l._mbomXSO.unsubscribe(l._mbomToken);l._mbomToken=undefined;l.mbomNodes=p[0];l.updateLabel(l.MfgItemDiv,l.mbomNodes);l.checkSelection()})}l.checkSelection()},checkSelection:function j(){var l=this;if(b.is(l.onSelection)){l.onSelection(l.bodyNodes,l.mbomNodes)}},createSection:function h(m,o){var n,l;n=new b.Element("div",{"class":"root-item",html:"<h5>"+c.getNLSValue(m)+"</h5>"});n.inject(o);l=new b.Element("div",{"class":"TNRInfo"}).inject(o);return l},updateLabel:function g(m,l){if(b.is(l)){m.empty();c.getIconFromKey(l.getReferenceType()).inject(m);new b.Element("div",{"class":"MfgSubLabelDiv",html:l.getLabel()}).inject(m);new b.Element("div",{"class":"MfgSubRevisionDiv",html:l.options.grid["revision.reference"]}).inject(m)}},updateMultiNode:function f(m,n){var l=this.createSection("",n);if(b.is(m)){c.getIconFromKey(m.getReferenceType()).inject(l);new b.Element("div",{"class":"MfgSubLabelDiv",html:m.getLabel()}).inject(l);new b.Element("div",{"class":"MfgSubRevisionDiv",html:m.options.grid["revision.reference"]}).inject(l)}},cleanup:function a(){if(b.is(this._mbomToken)){this._mbomXSO.unsubscribe(this._mbomToken);this._mbomToken=undefined}if(b.is(this.bodyToken)){this._bodyXSO.unsubscribe(this.bodyToken);this.bodyToken=undefined}}});return d});define("DS/DELWebMfgAssetsDefUIControls/ManageInconsistentLinksUI",["UWA/Core","UWA/Controls/Abstract","DS/Core/Events","DS/Logger/Logger","DS/Controls/Button","DS/Controls/ComboBox","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/MILUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/BIUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/Windows/Dialog"],function(e,q,n,w,m,j,v,k,u,l,d,c,x,h){var a=q.singleton({name:"ManageInconsistentLinksUI",_context:null,_milCmd:null,_logger:null,init:function r(z){this._context=z.context;this.mbomArray=[];this.ebomArray=[];this.MILStatus={Reroute_ScopeLink:{label:u.getNLSValue("MIL.Reroute.ScopeLink"),value:1,tooltip:u.getNLSValue("MIL.ToolTip.RerouteScope"),getLabel:function A(){return this.tooltip}},Reroute_ImplementAndScopeLink:{label:u.getNLSValue("MIL.Reroute.ImplementAndScopeLink"),value:2,tooltip:u.getNLSValue("MIL.ToolTip.Reroute"),getLabel:function A(){return this.tooltip}},Reroute_ImplementLink:{label:u.getNLSValue("MIL.Reroute.ImplementLink"),value:3,tooltip:u.getNLSValue("MIL.ToolTip.RerouteImplement"),getLabel:function A(){return this.tooltip}},Reroute_DeleteAndCreate:{label:u.getNLSValue("MIL.Reroute.DelAndCreate"),value:4,getLabel:function A(){return this.label}},Reroute_ImplementAndReplaceRef:{label:u.getNLSValue("MIL.Reroute.ImplementAndReplaceRef"),value:5,tooltip:u.getNLSValue("MIL.ToolTip.ReplaceAndReconnect"),getLabel:function A(){return this.tooltip}},Delete:{label:u.getNLSValue("MIL.Delete"),value:6,tooltip:u.getNLSValue("MIL.ToolTip.Delete"),getLabel:function A(){return this.tooltip}},Ignore:{label:u.getNLSValue("MIL.Ignore"),value:7,getLabel:function A(){return this.label}},Ambiguous:{label:u.getNLSValue("MIL.Ambiguous"),value:8,getLabel:function A(){return this.label}},Revise_And_Reconnect:{label:u.getNLSValue("MIL.Revise.Reconnect"),value:9,tooltip:u.getNLSValue("MIL.ToolTip.ReviseAndReconnect"),getLabel:function A(){return this.tooltip}},};if(w){this._logger=w.getLogger(a)}this.buildSkeleton()},buildSkeleton:function b(){var C=this,B,A,D,z={treelistviewOptions:{className:""},preferences:{Columns:{Column:[{dataIndex:"MIL_suggestion",display:true,minWidth:"100",displayType:"MIL"},{dataIndex:"MIL_rerouting",display:true,minWidth:"100",displayType:"MIL"},{dataIndex:"MIL_previous",display:true,minWidth:"100",displayType:"MIL"},{dataIndex:"MIL_manufactured",display:true,minWidth:"100",displayType:"MIL"}]},Label:{dataIndex:""}},};this.treeListView=v.createTreelistview(z);this.xso=this.treeListView.getDocument().getXSO();this.xso.onChange(function(){C.buttonContainer.children[0].dsModel.disabled=C.xso.isEmpty()});l.init({treeListView:this.treeListView});this.treeListView.getManager().hideColumn("tree");this.treeListView.getManager().hideColumn("selection");this.dialogContainer=new e.Element("div",{"class":"mil-panel-container"});this.treeContainer=new e.Element("div",{"class":"mil-tree-container"}).inject(this.dialogContainer);this.buttonContainer=new e.Element("div",{"class":"mil-button-container"}).inject(this.dialogContainer);D=new e.Element("div",{"class":"scope-selection-container",text:u.getNLSValue("MIL.CreateScopeForChildren")}).inject(this.dialogContainer);this.scopeSelectionCombo=new j({domId:"scopeSelectionCombo",enableSearchFlag:false,elementsList:[{labelItem:u.getNLSValue("MIL.ScopeCreation.AllScope"),valueItem:"AllLevel"},]}).inject(D);B=new m({type:"standard",label:u.getNLSValue("MIL.PanelApplyButton")}).inject(this.buttonContainer);A=new m({type:"standard",label:u.getNLSValue("MIL.PanelCloseButton")}).inject(this.buttonContainer);B.elements.container.style.marginRight="5px";B.addEventListener("click",this.onApplyButtonClick.bind(this));this.treeListView.getContent().inject(this.treeContainer);this.buttonContainer.children[0].dsModel.disabled=true;this._milDialog=new h({title:u.getNLSValue("ManageInconsistentLinksUI.PanelTitle"),position:{my:"center",at:"center"},immersiveFrame:v.getMGAElement("FrameWindow").getImmersiveFrame(),resizableFlag:true,visibleFlag:false,snappableFlag:false,height:315,width:800});this._milDialog.close=function(){if(!c.getCurrentBICmdState()){c.resetBIModelCollection()}if(e.is(a._milCmd)){a._milCmd.toggleState()}else{a.toggle()}};A.addEventListener("click",this._milDialog.close)},searchForAmbiguous:function o(A){var z;for(z=0;z<A.length;z++){if(A[z].valueItem===this.MILStatus.Ambiguous.value){return true}}return false},onApplyButtonClick:function g(){var J=this,H=this.treeListView.getDocument(),L,A=[],E=this.scopeSelectionCombo.value,B,N,F=[],M,D={},G=[],I={},z=[],K;var C=function C(){v.AlertManager.add({className:"error",message:u.getNLSValue("MIL.Reroute.Error")})};K=function K(){var P=[],R,O,Q;R=J._context.getMBOMTreeListView();P.returnFirstOne=true;A.forEach(function(S){O=R.getDocument().getNodeModel(S,P);if(e.is(O)){Q=k.references.get(S);if(e.is(Q)){x.buildConnectionModelInfo(Q)}P.updateLoadedChild=true;R.utils.fillReferenceTreeNode(O,P)}});if(c.getCurrentBICmdState()){c.computeBIStatus()}};H.getSelectedNodes().forEach(function(O){B=O.options.grid.cellInfo;if(J.searchForAmbiguous(B.suggestionToPerformEntries)){if(B.hasOwnProperty("candidateOccPath")){B.inconsistentObject.candidatePaths.length=0;B.inconsistentObject.candidatePaths[0]=B.candidateOccPath.toString()}}N=B.mbomId;switch(B.action){case J.MILStatus.Reroute_ImplementAndReplaceRef.value:case J.MILStatus.Reroute_ImplementLink.value:case J.MILStatus.Reroute_ImplementAndScopeLink.value:case J.MILStatus.Revise_And_Reconnect.value:M=B.inconsistentObject.aggregatedByPath;L=M.split(",")[0];if(A.indexOf(L)===-1){A.push(L)}B.inconsistentObject.rootMfgItemPID=L;D[N]=B.inconsistentObject;F.push(N);z.push(O);break;case J.MILStatus.Reroute_ScopeLink.value:D[N]=B.inconsistentObject;A.push(N);F.push(N);z.push(O);break;case J.MILStatus.Delete.value:I[N]=O;G.push(N);break;default:break}});if(F.length>0){l.rerouteLinkBulk(F,D,E,z,C,K)}if(G.length>0){l.deleteInstanceBulk(G,I,C)}if(!c.getCurrentBICmdState()){c.resetBIModelCollection()}},toggle:function p(z){this._milCmd=z;if(this._milDialog.visibleFlag){this._milDialog.modalFlag=false;this._milDialog.hide()}else{this._milDialog.modalFlag=true;this.showMILUI()}},showMILUI:function y(){var E=this,G=this._context.getMBOMTreeListView(),C=E._context.getBodyTreeListView(),z=G.getDocument().getRoots(),A=C.getDocument().getRoots(),D=G.getDocument().getAllDescendants(),F=C.getDocument().getAllDescendants(),H={};E.clearMILContents();if(Array.isArray(z)){z.forEach(function(I){E.mbomArray.push(I.getReferencePID())})}if(Array.isArray(A)){A.forEach(function(I){E.ebomArray.push(I.getReferencePID())})}if(E.mbomArray.length>0&&E.ebomArray.length>0){H.rootEBOM=E.ebomArray;H.rootMBOM=E.mbomArray;H.loadedProcNodes=D;H.loadedProdNodes=F;l.getBrokenMfgItemStatus(H,function B(I){E.checkAndDisplayInconsistentLinks(I);E._milDialog.show();E._milDialog.content=E.dialogContainer})}else{E._milDialog.show();E._milDialog.content=E.dialogContainer}},displayInconsistentLinks:function s(E){var H=this,Q,C,U,J,B,I,L,G,R,M,Y,N,V,A,X,aa,P,ac,W,ab,T,D,S=[],F=[],Z,z,O=[],K=[];E.forEach(function(ad){J=ad._attributes;U=J.id;I=J.hasOwnProperty("candidatePaths");L=J.hasOwnProperty("pointedPaths");D=J.hasOwnProperty("candidateScopedMfgItem");B=k.isReference(U);S=[];F=[];if(true===B){if(-1===H.mbomArray.indexOf(U)){return}G=k.getReferenceFromCollection(U);z=u.getIconURLFromKey(G.get("type"));M=H.getDisplayName(G,null);if(true===L&&J.pointedPaths.length>0){O=J.pointedPaths.split(",");P=O[O.length-1];N=k.getReferenceFromCollection(P);if(e.is(N)){V=H.getDisplayName(N,null);Z=u.getIconURLFromKey(N.get("type"))}else{V=P}}if(true===I&&J.candidatePaths.length>0){J.candidatePaths.forEach(function(ae){K=ae.split(",");ac=K[K.length-1];X=k.getReferenceFromCollection(ac);if(e.is(X)){aa=H.getDisplayName(X,null)}else{aa=ac}S.push({labelItem:aa,valueItem:ae.toString()})})}}else{R=k.getInstanceFromCollection(U);G=k.getReferenceFromCollection(R.get("isInstanceOf"));z=u.getIconURLFromKey(G.get("type"));M=H.getDisplayName(G,R);if(true===L&&J.pointedPaths.length>0){O=J.pointedPaths.split(",");P=O[O.length-1];Y=k.getInstanceFromCollection(P);if(e.is(Y)){N=k.references.get(Y.get("isInstanceOf"));V=H.getDisplayName(N,Y);Z=u.getIconURLFromKey(N.get("type"))}else{if(e.is(J.isInstanceOf)){N=k.getReferenceFromCollection(J.isInstanceOf);V=N.get("V_Name")+" "+N.get("revision");Z=u.getIconURLFromKey(N.get("type"))}else{V=P}}}if(true===I&&J.candidatePaths.length>0){J.candidatePaths.forEach(function(ae){K=ae.split(",");ac=K[K.length-1];A=k.getInstanceFromCollection(ac);if(e.is(A)){X=k.getReferenceFromCollection(A.get("isInstanceOf"));aa=H.getDisplayName(X,A)}else{aa=ac}S.push({labelItem:aa,valueItem:ae.toString()})});K=J.candidatePaths[0].split(",");ac=K[K.length-1];W=K;A=k.getInstanceFromCollection(ac);if(e.is(A)){X=k.getReferenceFromCollection(A.get("isInstanceOf"));aa=H.getDisplayName(X,A)}else{aa=ac}}}T=J.status;if(I){switch(T){case"ImplCandidatePrdOccWithScopeToOldRev":case"ImplCandPrdOccToOtherRev":if(D===true){ab=H.MILStatus.Reroute_ImplementAndReplaceRef}else{ab=H.MILStatus.Revise_And_Reconnect}break;case"ImplCandidatePrdOccButNotCorrespondingScope":if(D===true){ab=H.MILStatus.Reroute_ImplementAndReplaceRef}else{ab=H.MILStatus.Reroute_ImplementAndScopeLink}break;case"ImplCandPrdOccToDiffPrd":if(D===true){ab=H.MILStatus.Reroute_ImplementAndReplaceRef}else{ab=H.MILStatus.Reroute_ImplementLink}break;case"ImplCandidatePrdOccWithGoodScope":case"ImplCandPrdOccToSamePrd":ab=H.MILStatus.Reroute_ImplementLink;break;case"ImplNoProductOccurence":ab=H.MILStatus.Delete;break;case"ScopeToOldRev":ab=H.MILStatus.Reroute_ScopeLink;break;case"ScopeToNew":ab=H.MILStatus.Reroute_ScopeLink;break;default:break}}else{ab=H.MILStatus.Delete}if(e.is(ab)){F.push({labelItem:ab.label,valueItem:ab.value});if(I&&J.candidatePaths.length>1){ab=H.MILStatus.Ambiguous;F.push({labelItem:ab.label,valueItem:ab.value});S.unshift({labelItem:u.getNLSValue("MIL.SelectCandidate"),valueItem:u.getNLSValue("MIL.SelectCandidate")});aa=u.getNLSValue("MIL.SelectCandidate")}F.push({labelItem:H.MILStatus.Ignore.label,valueItem:H.MILStatus.Ignore.value});C={grid:{MIL_suggestion:ab,MIL_rerouting:I?aa:u.getNLSValue("MIL.RerouteNone"),MIL_previous:L?V:u.getNLSValue("MIL.PrevisionUnknown"),MIL_manufactured:M}};Q=new H.treeListView.utils._TreeNodeModel(C);Q.setAttribute("cellInfo",{mbomId:U,candidateId:ac,candidateOccPath:W,action:ab.value,candidateEntries:S,suggestionToPerformEntries:F,PreviousProdIconUrl:Z,MfgItemIconUrl:z,inconsistentObject:J});H.treeListView.getDocument().addRoot(Q)}})},checkAndDisplayInconsistentLinks:function t(z){var E=this,D,G,F,C,A,B=[],H=[];z.forEach(function(I){D=I._attributes;G=D.hasOwnProperty("pointedPaths");if(true===G){B=D.pointedPaths.split(",");A=B[B.length-1];F=k.getInstanceFromCollection(A);if(e.is(F)){C=k.getReferenceFromCollection(F.get("isInstanceOf"));if(!e.is(C)){H.push(F.get("isInstanceOf"))}}}});if(H.length>0){d.fetchOnIndex(H,{onComplete:function(I){if(I.length>1){I.forEach(function(J){k.references.add(J.attributes)})}else{k.references.add(I.attributes)}E.displayInconsistentLinks(z)}})}else{E.displayInconsistentLinks(z)}},getDisplayName:function i(z,A){return z.get("V_Name")+" "+z.get("revision")+"("+(A?A.get("PLM_ExternalID"):z.get("PLM_ExternalID"))+")"},clearMILContents:function f(){var z=this;if(!e.is(z.treeListView)){return}z.treeListView.getDocument().removeRoots();z.mbomArray.splice(0,z.mbomArray.length);z.ebomArray.splice(0,z.ebomArray.length)}});return a});define("DS/DELWebMfgAssetsDefUIControls/Preferences",["UWA/Core","UWA/Controls/Abstract","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil","DS/DELWebMfgAssetsDefUIServices/SecurityContext","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/CustoParametersSet","DS/DELWebMfgAssetsDefModelServices/ModelUtils"],function(e,l,r,h,o,q,d,c){var b=l.singleton({name:"Preferences",_logger:null,_rootsPrefName:"storedRoots",init:function m(v){this._parent(v);if(e.is(r)){this._logger=r.getLogger(b)}},_addOrgs:function f(){widget.addPreference({name:"organization",type:"list",label:q.getNLSValue("Preferences.Org"),options:o.getOrganization(),onchange:"OrganizationUpdated"})},_addCollabSpaces:function i(x){var w=o.getCollabSpace(x),v=(e.is(w,"array")&&(w.length>0))?w[0].value:null;widget.addPreference({name:"collaborativeSpace",type:"list",label:q.getNLSValue("Preferences.CollabSpace"),options:w,defaultValue:v,onchange:"CollabSpaceUpdated"});if(e.is(b._logger)){b._logger.log("Preferences::updateCollabSpace, (newCollabSpaceArray, defaultCollabSpace): "+e.Json.encode(w)+", "+e.Json.encode(v))}},_addRoles:function j(y,v){var x=o.getRole(y,v),w=(e.is(x,"array")&&(x.length>0))?x[0].value:null;widget.addPreference({name:"role",type:"list",label:q.getNLSValue("Preferences.Role"),options:x,defaultValue:w,onchange:"RoleUpdated"});if(e.is(b._logger)){b._logger.log("Preferences::updateRole, (newRoleArray, defaultRole): "+e.Json.encode(x)+", "+e.Json.encode(w))}},addRootToPreferences:function u(z,w){var y,x="Default",v=b.getRootsPrefName();y=e.Json.decode(widget.getValue(v));if(y.hasOwnProperty(x)){if(y[x].hasOwnProperty(w)){if(y[x][w].indexOf(z)===-1){y[x][w].push(z)}}else{y[x][w]=[z]}}else{y={};y[x]={};y[x][w]=[z]}widget.setValue(v,e.Json.encode(y))},createRootsStore:function k(w){var y,x="Default",v=b.getRootsPrefName();y=e.Json.decode(widget.getValue(v));if(y.hasOwnProperty(x)){y[w]=y[x]}widget.setValue(v,e.Json.encode(y))},getRootsPrefName:function n(){return this._rootsPrefName},_updateCollabSpace:function a(){var w=[],v,x=widget.getValue("organization");if(e.is(b._logger)){b._logger.log("Preferences::updateCollabSpace, (newOrga): "+x)}b._addCollabSpaces(x);w=o.getCollabSpace(x);v=e.is(w,"array")?((w.length>0)?w[0].value:null):null;b._addRoles(x,v);widget.dispatchEvent("onEdit")},_updateRole:function g(){var w=widget.getValue("organization"),v=widget.getValue("collaborativeSpace");if(e.is(b._logger)){b._logger.log("Preferences::updateRole, (newOrga, newCollabSpace): "+w+", "+v)}b._addRoles(w,v);widget.dispatchEvent("onEdit")},buildView:function t(){var v=[{name:"showDialog",type:"boolean",label:q.getNLSValue("Preferences.ShowDialog"),defaultValue:"true"},{name:"navigateOnIndexedDB",type:h.isNavigateOnIndexedDBPrefDisplayed()?"boolean":"hidden",label:q.getNLSValue("Preferences.NavOnIndexedDB"),defaultValue:"false"},{name:"fetchAllLevel",type:"boolean",label:q.getNLSValue("Preferences.fetchAllLevel"),defaultValue:"false"},{name:"linksUISwipeableMenu",type:h.isSwipeableMenuPrefDisplayed()?"boolean":"hidden",label:q.getNLSValue("Preferences.linksUISwipeableMenu"),defaultValue:"false",},{name:"showOrg",type:"boolean",label:q.getNLSValue("Preferences.showOrg"),defaultValue:"false"},{name:"showCollaborativeSpace",type:"boolean",label:q.getNLSValue("Preferences.showCollaborativeSpace"),defaultValue:"false"},{name:"showRole",type:"boolean",label:q.getNLSValue("Preferences.showRole"),defaultValue:"false"},{name:"oneDelmiaAggregationMode",type:"boolean",label:q.getNLSValue("Preferences.oneDelmiaAggregationRules"),defaultValue:"true"},{name:"navigateOn",type:"list",options:[{value:"index",label:q.getNLSValue("Preferences.navigateOn.index")},{value:"indexOndemand",label:q.getNLSValue("Preferences.navigateOn.indexOndemand")},{value:"database",label:q.getNLSValue("Preferences.navigateOn.database")}],label:q.getNLSValue("Preferences.navigateOn"),defaultValue:"index"},{name:"separator",type:"text",label:q.getNLSValue("Preferences.Separator"),defaultValue:"|"},{name:"organization",type:"list",label:q.getNLSValue("Preferences.Org"),options:[],defaultValue:"",onchange:"OrganizationUpdated"},{name:"collaborativeSpace",type:"list",label:q.getNLSValue("Preferences.CollabSpace"),options:[],defaultValue:"",onchange:"CollabSpaceUpdated"},{name:"role",type:"list",label:q.getNLSValue("Preferences.Role"),options:[],defaultValue:"",onchange:"RoleUpdated"},{name:"custoParametersSet",type:"list",label:q.getNLSValue("Preferences.CustoParametersSet"),options:[],defaultValue:"",},{name:"timeout",type:"text",label:q.getNLSValue("Preferences.ServerTimeout"),defaultValue:((h.getDefaultTimeout()===false)||(h.getDefaultTimeout()===""))?"600":h.getDefaultTimeout(),onchange:"TimeoutUpdated"},{name:b.getRootsPrefName(),type:"hidden",defaultValue:"{}"},{name:"systemsViewColumns",type:"hidden",defaultValue:[]},{name:"consumedItemsColumns",type:"hidden",defaultValue:[]},{name:"capableResourcesColumns",type:"hidden",defaultValue:[]},{name:"showRequirementsInRelationPanel",type:"hidden",defaultValue:"false"},{name:"BlocksViewBottom",type:"hidden",defaultValue:"true"},{name:"BlocksViewLeft",type:"hidden",defaultValue:"true"},{name:"BlocksViewRight",type:"hidden",defaultValue:"true"},{name:"MFNViewProducts",type:"hidden",defaultValue:"true"},{name:"MFNViewMBOM",type:"hidden",defaultValue:"true"},{name:"MFNViewAuxiliary",type:"hidden",defaultValue:"true"},{name:"MGAViewAuxiliary",type:"hidden",defaultValue:"true"}];widget.setPreferences(v);widget.addEvent("OrganizationUpdated",b._updateCollabSpace);widget.addEvent("CollabSpaceUpdated",b._updateRole);if(e.is(b._logger)){b._logger.log("Preferences::buildView: Preferences has been built.")}},populateSecurityContext:function s(){var w,x,v=c.getSecurityContext();v=v.slice(5);w=v.split(".")[1];x=v.split(".")[2];this._addOrgs(w);this._addCollabSpaces(w);this._addRoles(w,x)},populateCustomParameters:function p(){widget.addPreference({name:"custoParametersSet",type:"list",label:q.getNLSValue("Preferences.CustoParametersSet"),options:d.getNames(),defaultValue:widget.getValue("custoParametersSet")})}});return b});define("DS/DELWebMfgAssetsDefUIControls/NewUI",["UWA/Core","DS/UIKIT/Form","DS/UIKIT/Modal","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/AttributeUtil","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefUIServices/UIUtils"],function(e,g,h,f,j,b,a){var l={getFieldsFromFormConfig:function d(m){var n=b.InsertCmdFormAttribute.convert("AttributesDescriptionList.Type","name")[m]||{};if(!n.hasOwnProperty("Section")){n.Section={};n.Section.Attribute=[{dicoType:"PLMEntity",name:"V_Name",mandatory:true},{dicoType:"PLMEntity",name:"V_description"}]}return n},buildFields:function c(s){var m=[],o=false,q,t=function t(){var u={};if(o===true){o=false;u.type="html";u.html='<span class="text-warning" >'+f.getNLSValue("InsertCmd.WarningConfiguration")+"</span>";m[m.length]=u}},r=function r(u){var v={};v.type="html";v.html="<h4>"+u;m[m.length]=v},n=function n(v){var z=f.getAttributeInfo(v.dicoType+"."+v.name),x,u,w,y;if(e.is(z)!==true){o=true;return}x=j.getDefaultValue(z);w=(e.is(z)&&j.hasMagnitude(z))?" ["+f.getNLSForUnit(j.getMagnitude(z),z.ManipulationUnit)+"]":"";y={name:j.getFullName(z),required:v.mandatory,label:j.getFullName(z),attributeInfo:z};if(j.isReadOnly(z,null,true)){return}if(w!==""){y.label=j.getNLS(z)+w;if(v.mandatory){y.label+="*"}}else{if(v.mandatory){y.label=j.getNLS(z)+"*"}}if(j.isDate(z)){y.displayType=(v.displayType==="DateTime")?"datetime":"date"}y=j.createField(y,x,z);m.push(e.clone(y))},p=function p(v){var u;for(u in v){if(v.hasOwnProperty(u)){switch(u.toLowerCase()){case"name":r(v[u]);break;case"attribute":if(Array.isArray(v[u])){v[u].forEach(n)}else{n(v[u])}break;default:break}}}};for(q in s){if(s.hasOwnProperty(q)){switch(q.toLowerCase()){case"section":if(e.is(s[q])){if(Array.isArray(s[q])){s[q].forEach(p)}else{p(s[q])}}break;default:break}}}t();return m},showDialog:function i(o,A,y,s,z){var C=this,w,m,n=f.getNLSValue("InsertCmd.Create"),B=f.getNLSValue("InsertCmd.OK"),q=f.getNLSValue("InsertCmd.CANCEL"),v,x;var u=l.getFieldsFromFormConfig(A);var r=l.buildFields(u);var p={name:"V_Type",label:f.getNLSValue("type"),type:"list",options:y,events:{onChange:function t(){var D=this.getValue("V_Type")[0];w.destroy();l.showDialog(o,D,y,s,z)}}};r.splice(0,0,p);l._setSelection(p,A);m=new g({className:"MGA-DELWebMfgAssetsDefUICommands-InsertCmd-Form horizontal",grid:"4 8",fields:r,buttons:[{type:"submit",value:B},{value:q,action:function(){w.destroy()}}],events:{onSubmit:function(){v()}}});v=function v(){var F={PLM_ExternalID:C.PLM_ExternalID},G,E,D;for(D=0;D<r.length;D++){switch(r[D].name){case"V_Type":F.V_Type=o.concat("/",m.getValue("V_Type"));F.type=m.getValue("V_Type");break;default:if(e.is(r[D].name)){if(j.isDate(r[D].attributeInfo)&&!j.isMultiValuated(r[D].attributeInfo)){E=m.getDateInput(j.getFullName(r[D].attributeInfo)).getDate();G=j.getFieldValue(E,r[D].attributeInfo)}else{G=j.getFieldValue(m.getValue(j.getFullName(r[D].attributeInfo)),r[D].attributeInfo)}if(e.is(G)){F[r[D].name]=G}}break}}s.call(z,F);w.destroy()};if(m.getField("PLMEntity.V_Name")){if(j.getDefaultValue(f.getAttributeInfo("PLMEntity.V_Name"))===""){m.setValue("PLMEntity.V_Name",A)}}w=new h({className:"MGA-DELWebMfgAssetsDefUICommands-InsertCmd-Dialog",header:n+f.getNLSValue(A,null,"Type"),closable:true,body:m});x=w.getContent();x.setAttribute("tabIndex","0");x.addEventListener("keydown",function(D){if(D.keyCode===13){if(D.target.type==="button"){D.target.triggerEvent("click")}else{if(m.validate()){v()}}}else{if(D.keyCode===27){w.destroy()}}});w.inject(widget.body);w.getBody().setStyle("max-height",a.getPopUpMaxHeight()-200);w.show();x.focus()},_setSelection:function k(o,n){var m,p=function(q){if(q.value===n){q.selected=true}else{q.selected=false}};if(e.is(o.options)){if(Array.isArray(o.options)){for(m=0;m<o.options.length;++m){p(o.options[m])}}else{p(o.options)}}},};return l});define("DS/DELWebMfgAssetsDefUIControls/WUXForm",["UWA/Core","UWA/Element","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Toggle","DS/Controls/DatePicker","css!DS/DELWebMfgAssetsDefUIControls/DELWebMfgAssetsDefUIControls.css"],function(h,d,a,e,f,c,g){var b=function(){var s=null,k={},q=function q(v){var w=new e(v);w.fieldType=v.fieldType;k[v.name]=w;return w},u=function u(v){var w=new f(v);w.fieldType=v.fieldType;k[v.name]=w;return w},l=function l(v){var w=new c(v);w.fieldType=v.fieldType;k[v.name]=w;return w},o=function o(v){var w=(h.is(v))?new g(v):new g();w.fieldType=v.fieldType;k[v.name]=w;return w},m=function m(v){var w;w=new a(h.merge(v,{actionOnClickFlag:false,enableSearchFlag:false}));w.fieldType=v.fieldType;k[v.name]=w;if(h.is(v.onChange,"function")){w.addEventListener("change",v.onChange)}return w},j=function j(w){var x,v=h.is(w.className)?w.className:"field-container";x=new d("div",{"class":v});new d("div",{"class":"fieldTitle-container",text:w.title}).inject(x);switch(w.fieldType.toLowerCase()){case"editor":u(w).inject(x);break;case"lineeditor":q(w).inject(x);break;case"combobox":m(w).inject(x);break;case"toggle":l(w).inject(x);break;case"datepicker":o(w).inject(x);break;default:break}return x},r=function r(w,v){var x=new d("div",{"class":"section-container",});new d("h5",{"class":"sectionTitle-container",text:w}).inject(x);v.forEach(function(y){j(y).inject(x)});return x},i=function i(x,v){var w;x.sections=x.sections||{};for(w in x.sections){if(x.sections.hasOwnProperty(w)){r(w,x.sections[w]||[]).inject(v)}}};return{createUI:function p(v){v=v||{};this.destroy();s=new d("div",{"class":"custom-wuxForm-container"});i(v,s);if(h.is(v.renderTo)){s.inject(v.renderTo)}},destroy:function t(){if(h.is(s)){s.destroy()}k={}},getValues:function n(){var w,v={};k;for(w in k){if(h.is(k[w])){switch(k[w].fieldType.toLowerCase()){case"editor":case"lineeditor":case"combobox":v[w]=k[w].value;break;case"toggle":v[w]=k[w].checkFlag;break;default:break}}}return v}}};return b});define("DS/DELWebMfgAssetsDefUIControls/UIControlFactoryCustomization",["UWA/Core","UWA/Class","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/UIKIT/Form","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Input/Text","DS/UIKIT/Input/Select"],function(e,b,h,k,m,j,g,l,c,f,d,a){var i=b.singleton({init:function(){},_UIJsonRef:{common:{WEBUX:{functions:{},}},Button:{use:"WEBUX",WEBUX:{module:"DS/Controls/Button",attributeMaping:{value:"label",},classMaping:{"default":"btn-default",primary:"btn-primary",info:"btn-info",success:"btn-success",warning:"btn-warning",error:"btn-error",large:"btn-lg",small:"btn-sm",xsmall:"btn-xs",link:"btn-link",},postProcessing:function(o,n){if(e.is(o)){o.elements.button.addClassName("btn");if(e.is(n.className)){o.elements.button.addClassName(n.className)}if(e.is(n.id)){o.setId(n.id)}if(e.is(n.disabled)){o.setDisabled(n.disabled)}}},functions:{setIcon:function(n){this.icon=n},removeIcon:function(){this.icon=undefined},disable:function(){this.setDisabled()},enable:function(){this.setDisabled(false)},setDisabled:function(n){if(n===undefined){n=true}this.disabled=n},getId:function(){if(this.elements.button.id){return this.elements.button.id}return undefined},setId:function(n){this.elements.button.id=n},setValue:function(n){this.label=n},getValue:function(n){return this.label},isActive:function(){return this.checkFlag},isDisabled:function(){return this.disabled}},events:{onClick:function(o,n){o.elements.button.addEvents({click:n})}}},UIKIT:{module:"DS/UIKIT/Input/Button",}},ButtonGroup:{use:"WEBUX",WEBUX:{module:"DS/Controls/ButtonGroup",postProcessing:function(p,o){if(e.is(o.buttons)){var n,q=o.buttons;p.buttons=[];for(n=0;n<q.length;n++){p.addChild(q[n],n);p.buttons.push(q[n])}}if(e.is(o.className)){p.addClassName(o.className)}if(e.is(o.disabled)){p.setDisabled(o.disabled)}},functions:{getActive:function(){var o=this.buttons,p=[];if(o.length>0){var n;for(n=0;n<o.length;n++){if(o[n].isActive()){p.push(o[n])}}}return p},getButtonbyId:function(p){var o=this.buttons;if(o.length>0){var n;for(n=0;n<o.length;n++){if(o[n].getId()===p){return o[n]}}}},isActive:function(p){var o=this.buttons;if(o.length>0){var n;for(n=0;n<o.length;n++){if(o[n].getId()===p){return o[n].isActive()}}}},addClassName:function(n){this.elements.container.addClassName(n)},removeClassName:function(n){this.elements.container.removeClassName(n)},setDisabled:function(o){if(o===undefined){o=true}this.disabled=o;var p=this.buttons;if(p.length>0){var n;for(n=0;n<p.length;n++){p[n].setDisabled(o)}}},isDisabled:function(){return this.disabled},},events:{onClick:function(q,n){var p=q.elements.container.children;if(p.length>0){var o;for(o=0;o<p.length;o++){p[o].addEvents({click:n})}}}}},UIKIT:{module:"DS/UIKIT/Input/ButtonGroup"}},Select:{use:"WEBUX",WEBUX:{module:"DS/Controls/ComboBox",attributeMaping:{options:"elementsList",},preProcessing:function(o){var n=[],p;if(e.is(o.options)){for(p in o.options){var q=o.options[p];if(e.is(q.label)){n.push(q.label)}else{n.push(q.value)}}o.options=n;o.nbDisplayedElements=5;o.selectedIndex=-1;o.enableSearchFlag=true;o.actionOnClickFlag=false}return o},postProcessing:function(o,n){if(e.is(n.className)){o.elements.container.addClassName(n.className)}},functions:{},events:{}},UIKIT:{module:"DS/UIKIT/Input/Select",}},Form:{use:"WEBUX",WEBUX:{module:"DS/UIKIT/Form"},UIKIT:{module:"DS/UIKIT/Form",}},Modal:{use:"WEBUX",WEBUX:{module:"DS/UIKIT/Modal"},UIKIT:{module:"DS/UIKIT/Modal"}},Text:{use:"WEBUX",attributeMaping:{value:"text",},WEBUX:{module:"DS/Controls/LineEditor",postProcessing:function(o,n){if(e.is(n.className)){o.elements.container.addClassName(n.className)}if(e.is(n.id)){o.setId(n.id)}if(e.is(n.disabled)){o.setDisabled(n.disabled)}},functions:{getValue:function(){return this.value},setValue:function(n){this.value=n},disable:function(){this.enableFlag=false},enable:function(){this.enableFlag=true},setDisabled:function(n){if(n===undefined){n=true}this.enableFlag=!n},isDisabled:function(){return !this.enableFlag},getId:function(){if(this.elements.container.id){return this.elements.container.id}return undefined},setId:function(n){this.elements.container.id=n},},events:{onChange:function(o,n){o.elements.container.addEvents({change:n})}}},UIKIT:{module:"DS/UIKIT/Input/Text",}}},getElementJSON:function(n){var o,p;if(e.is(this._UIJsonRef[n])){p=this._UIJsonRef.common[this._UIJsonRef[n].use];o=this._UIJsonRef[n][this._UIJsonRef[n].use];if(e.is(o)&&e.is(p)){if(e.is(o.functions)&&e.is(p.functions)){o.functions=e.merge(o.functions,p.functions)}else{if(!e.is(o.functions)){o.functions=p.functions}}}return o}}});return i});define("DS/DELWebMfgAssetsDefUIControls/VariableAutoHideAlert",["UWA/Core","DS/UIKIT/Alert"],function(d,b){var c=b.extend({defaultOptions:{closable:true,visible:true,closeOnClick:true,autoHide:false,hideDelay:2000,hideDelaySuccess:3000,hideDelayError:6000,className:"",messageClassName:"alert-primary",animate:true,icon:true,maximumVisibleMessages:5},onShowMessage:function a(e){var g=this,f,h=e.className.split(" ")[1].substring(6);switch(h){case"success":f=this.options.hideDelaySuccess;break;case"error":f=this.options.hideDelayError;break;default:f=this.options.hideDelay}setTimeout(function(){g.remove(e)},f)}});return c});define("DS/DELWebMfgAssetsDefUIControls/CreateOrUpdateMfgItemDialogWebService",["UWA/Core","UWA/Class","UWA/Class/Options","DS/Core/Events","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIServices/UXComponentUtil","DS/DELWebMfgAssetsDefConnectionModel/ConnectionModel","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/ExternalEventsUtils","DS/DELWebMfgAssetsDefModelServices/BIUtils"],function(g,a,k,e,h,d,n,l,c,j,i,f,m){var b=a.singleton({name:"CreateOrUpdateMfgItemDialogWebService",webServiceCall:function o(r,s,v,z,y){var t,x,p,q,u;if(r==="CreateMfgItem"){t="POST";x=g.Json.encode({rootProductID:s,rootMfgItemID:v,scopeCreation:z.scopeCreation,prefix:z.prefix,})}else{if(r==="UpdateMfgItem"){t="PUT";x=g.Json.encode({mbomUpdateMode:"mbomPull",rootProductID:s,rootMfgItemID:v,backgroundJobflag:z.backgroundJobFlag,scopeCreation:z.scopeCreation,prefix:z.prefix,updateIntermediateScopedAssemblies:z.updateIntermediateScopedAssemblies,})}}p=function p(){if(r==="CreateMfgItem"){d.AlertManager.add({className:"error",message:h.getNLSValue("Error.CreateFailed.Title")})}else{if(r==="UpdateMfgItem"){d.AlertManager.add({className:"error",message:h.getNLSValue("Error.UpdateFailed.Title")})}}};u=function u(){if(r==="CreateMfgItem"){d.AlertManager.add({className:"info",message:h.getNLSValue("Info.CreateTimedOut.Title")})}else{if(r==="UpdateMfgItem"){d.AlertManager.add({className:"info",message:h.getNLSValue("Info.UpdateTimedOut.Title")})}}};q=function q(G){var B=[],E=[],I=[],D=[],H,A,J,F=null;G=G||{};G=g.merge(G,{deletedObjects:[],instancesAndReferences:[],reusedReferences:[],revisedObjects:[],connections:[]});H=function H(){return new Promise(function K(N,L){if(g.is(G.revisedObjects)){G.revisedObjects.forEach(function(P){var O=P.revisedFrom;if(O===v){F=P.revisedTo}})}G.instancesAndReferences.forEach(function(P){var O=P.attributesValue;if(O.hasOwnProperty("isInstanceOf")){O.queriedForConnections=true;E.push(O)}else{if(!(O.PID===F)){O.queriedForChildren=true;O.queriedForConnections=true;O.queriedForDocuments=true}D.push(O.PID);B.push(O)}});G.connections.forEach(function M(P){var O=j.parseConnection(P,{silentMode:true});I.push(O)});if((B.length===0)&&(E.length===0)&&(I.length===0)&&(F===null)&&(G.deletedObjects.length===0)){d.AlertManager.add({className:"info",message:h.getNLSValue("Info.NoUpdate.Title")});L()}else{N()}})};A=function A(){return new Promise(function K(O,N){var L=[],M=function M(){d.AlertManager.add({className:"info",message:h.getNLSValue("Error.CreateMfgSuccess.UIUpdateFailed.Title")});N()};L=G.reusedReferences.filter(function(R){var P=g.is(j.getReferenceFromCollection(R)),Q=(D.indexOf(R)!==-1);return !(P||Q)});if(L.length!==0){j.getDescendantsFromServer(L,O,{silentMode:true,expandLevel:0,onFailure:M,onCancel:M,onTimeout:M})}else{O()}})};J=function J(){j.addToCollections({stackedReferences:B,stackedInstances:E,stackedConnections:I,deletedObjects:G.deletedObjects,onComplete:function K(){if(g.is(y)){y(v,F)}}});if(m.getCurrentBICmdState()){m.computeBIStatus()}f.emitCreateInstanceEvent(G.instancesAndReferences);f.emitCreateConnectionEvent(G.connections)};H().then(function C(){A().then(J)})};c.webServiceRequest({url:"modeler/ppr/MfgItem",method:t,headers:c.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),data:x,context:this,onFailure:p,onTimeout:u,onCancel:p,onComplete:q,timeOutExtensionPromise:function w(){var C=j.getReferenceFromCollection(s),B=j.getReferenceFromCollection(v);return new Promise(function A(E,D){n.buildExtendTimeoutDialog(E,D,[C,B],{message:h.getNLSValue("TimeoutExtension."+r+".Title")})})}})}});return b});define("DS/DELWebMfgAssetsDefUIControls/EditAttributeUI",["UWA/Core","UWA/Promise","DS/UIKIT/Form","DS/UIKIT/Modal","DS/UIKIT/Spinner","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/AttributeUtil","DS/DELWebMfgAssetsDefModelServices/ModelUtils"],function(f,k,h,j,e,g,m,a){var b={editAttribute:function i(n,w){var s,v=this,t=w.infos,u=t.objectToBeModified,r=(f.is(t.attributeInfo)&&m.hasMagnitude(t.attributeInfo))?" ["+g.getNLSForUnit(m.getMagnitude(t.attributeInfo),t.attributeInfo.ManipulationUnit)+"]":"",o=r===""?t.attributeNLSTitle:t.attributeNLSTitle+r,p=g.getNLSValue("EditAttributeUI.Header",{attributeName:o}),q=[];w.selectedNodes.forEach(function(x){q.push(new k(function(C,B){var z,y=u,A=function(){n.add({className:"error",message:g.getNLSValue("EditAttributeUI.retrieveDataFailure")});B()};z=m.getNodeAndColumnInfos(x,w.column);y=z.objectToBeModified;y.fetch({proxy:"passport",type:"json",headers:a.getHeaders(),onComplete:function(){if(m.doesAttributeExist(y,t.dataIndex)){C(x)}else{B()}},onFailure:A,onTimeout:A})}))});k.allSettled(q).then(function(y){var x=[];y.forEach(function(z){if(f.is(z.value)){x.push(z.value)}else{n.add({className:"error",message:g.getNLSValue("TableView.AvailabilityFailure",{key:t.attributeNLSTitle})})}});w.selectedNodes=x;if(w.selectedNodes.length>0){s=new j({header:p,body:new e({visible:true}),closable:true});v.buildEditAttributeUI(s,n,u,w);s.inject(widget.body);s.show()}})},buildEditAttributeUI:function d(q,o,r,w){var u,t,n,s=w.infos,v=g.getNLSValue("EditAttributeUI.OK"),p=g.getNLSValue("EditAttributeUI.CANCEL");u=r.get(s.dataIndex);t={name:m.getFullName(s.attributeInfo),attributeInfo:s.attributeInfo};t=m.createField(t,u,s.attributeInfo);if(m.isBoolean(s.attributeInfo)){t.label=s.attributeNLSTitle}n=new h({className:"MGA-DELWebMfgAssetsDefUICommands-EditAttribute-Form",fields:[t],buttons:[{type:"submit",value:v},{value:p,action:function(){q.destroy()}}],events:{onSubmit:function(){var y,x;if(m.isDate(t.attributeInfo)&&!m.isMultiValuated(t.attributeInfo)){y=n.getDateInput(m.getFullName(t.attributeInfo)).getDate().toISOString()}else{y=n.getValue(m.getFullName(t.attributeInfo))}x=m.getFieldValue(y,t.attributeInfo);if(f.is(x)){m.saveValue(o,r,w.selectedNodes,s.dataIndex,x,s.attributeNLSTitle,s.attributeName,s.instOrRef,s.attributeInfo,s.attributeDef)}q.destroy()}}});q.setBody(n)},editAttributes:function l(r,t,o){var p,n=this,s=g.getNLSValue("EditAttributeUI.HeaderMulti"),q=function(){r.add({className:"error",message:g.getNLSValue("EditAttributeUI.retrieveDataFailure")});p.destroy()};p=new j({header:s,body:new e({visible:true}),closable:true});t.fetch({proxy:"passport",type:"json",headers:a.getHeaders(),onComplete:function(){n.buildEditAttributesUI(p,r,t,o)},onFailure:q,onTimeout:q});p.inject(widget.body);p.show()},buildEditAttributesUI:function c(u,o,w,q){var n,x,s=[],y,t,p,v,z=g.getNLSValue("EditAttributeUI.OK"),r=g.getNLSValue("EditAttributeUI.CANCEL");for(p=0;p<q.length;p++){v=q[p];if(!m.doesAttributeExist(w,v.dataIndex)){o.add({className:"error",message:g.getNLSValue("TableView.AvailabilityFailure",{key:v.attributeNLSTitle})});continue}y=w.get(v.dataIndex);if(y===null){y=""}x={name:m.getFullName(v.attributeInfo),label:f.i18n(m.getFullName(v.attributeInfo)),disabled:v.readOnly,attributeInfo:v.attributeInfo};if(m.isReadOnly(v.attributeInfo)){x.disabled=true}t=(f.is(v.attributeInfo)&&m.hasMagnitude(v.attributeInfo))?" ["+g.getNLSForUnit(m.getMagnitude(v.attributeInfo))+"]":"";if(t!==""){x.label=m.getNLS(v.attributeInfo)+t}x=m.createField(x,y,v.attributeInfo);s.push(f.clone(x))}n=new h({className:"MGA-DELWebMfgAssetsDefUICommands-EditAttributes-Form",fields:s,buttons:[{type:"submit",value:z},{value:r,action:function(){u.destroy()}}],events:{onSubmit:function(){var D={},A=[],C,B,E;for(p=0;p<s.length;p++){C=n.getValue(m.getFullName(s[p].attributeInfo));E=m.getFieldValue(C,s[p].attributeInfo);B=(s[p].value!==C)&&!s[p].disabled;if(f.is(E)&&B){D.newValue=E;D.dataIndex=q[p].dataIndex;D.attributeNLSTitle=q[p].attributeNLSTitle;D.attributeName=q[p].attributeName;D.instOrRef=q[p].instOrRef;D.attributeInfo=q[p].attributeInfo;D.attributeDef=q[p].attributeDef;A.push(f.clone(D))}}if(A.length>0){m.saveValues(o,w,A)}u.destroy()}}});u.setBody(n)}};return b});define("DS/DELWebMfgAssetsDefUIControls/BlocLayout",["UWA/Core","UWA/Controls/Abstract","DS/Logger/Logger"],function(g,s,C){var h=s.extend({_logger:null,defaultOptions:{className:"blocLayout",minSize:"5px"},init:function u(H){this._parent(H);this._rowMap={};this._columnMap={};this._rowColumnMap={};this._rowIds=[];this._fixedColumnIds=[];this._fixedRowIds=[];H=this.options;if(C){this._logger=C.getLogger(h)}if(!H.rows){H.rows=[{columns:2},{columns:1}]}H.minSize=H.minSize.indexOf("px")!==-1?parseInt(H.minSize.replace("px","")):5;this._buildSkeleton(H.rows)},_buildSkeleton:function v(I){var Q=this,M,K,L,J,H,P=-1,N=-1,O=function O(R){if(Q.hasOwnProperty("_resizingInfo")){if(R.type==="touchend"){Q.getContent().removeEvent("touchmove");R.preventDefault()}else{Q.getContent().removeEvent("mousemove")}delete Q._resizingInfo;g.Event.dispatchEvent(Q.getContent(),"onBlocLayoutResizeEnd");Q._resizeBottomBloc()}};this.elements.container=g.createElement("div",{"class":"bl-container"});I.forEach(function(R,S){P++;K=g.createElement("div",{"class":"bl-row"}).inject(Q.getContent());L=g.createElement("div",{"class":"bl-row-content no-drag-row"}).inject(K);Q._rowMap[P]=K;Q._rowIds.push(P);if(S>0){Q._createHandle(P,null,"bl-drag-row").inject(K,"top");L.removeClassName("no-drag-row")}if(R.hasOwnProperty("columns")){for(M=0;M<R.columns;M++){N++;J=g.createElement("div",{"class":"bl-column"}).inject(L);H=g.createElement("div",{"class":"bl-column-content no-drag-column"}).inject(J);Q._columnMap[N]=J;if(!Q._rowColumnMap[P]){Q._rowColumnMap[P]=[N]}else{Q._rowColumnMap[P].push(N)}if(M<R.columns-1){Q._createHandle(P,N,"bl-drag-column").inject(J,"top");H.removeClassName("no-drag-column")}}}});this._initSize();this.getContent().addEvent("touchend",O);this.getContent().addEvent("mouseup",O);this.onContainerResized(function(){var R=this,S=this.getContent().getSize();this.setRowsHeight(this._rowIds,S.height,{minSize:0});this._rowIds.forEach(function(U){var T=R._getColumnIdsInRow(U);R.setColumnsWidthById(T,S.width,{minSize:0})});R._resizeBottomBloc()})},_resizeBottomBloc:function k(){if(g.is(this._columnMap[2])&&this._columnMap[2].clientHeight){widget.dispatchEvent("resizeBottomDock",{height:this._columnMap[2].clientHeight})}},_createHandle:function F(M,J,K){var I=this,H=g.createElement("div",{"class":K}),L=function L(N){I._resizingInfo={rowId:M,columnId:J};if(N.type==="touchstart"){I.getContent().addEvent("touchmove",I._onMouseMove.bind(I));N.preventDefault()}else{I.getContent().addEvent("mousemove",I._onMouseMove.bind(I))}};H.addEvent("touchstart",L);H.addEvent("mousedown",L);return H},_onMouseMove:function D(M){var O=this._resizingInfo,L,H,I,K,J,N;if(O){try{if(g.is(O.columnId)){J=this._getRowElem(O.rowId);H=this._getColumnIdsInRow(O.rowId).filter(function(P){return P<=O.columnId});if(M.type==="touchmove"){N=M.touches[0];L=N.pageX-J.getOffsets().x}else{L=M.clientX-J.getOffsets().x}this.setColumnsWidthById(H,L,{minSize:this.options.minSize})}else{K=this._getRowIds().filter(function(P){return P<O.rowId});if(M.type==="touchmove"){N=M.touches[0];I=N.pageY-this.getContent().getOffsets().y}else{I=M.clientY-this.getContent().getOffsets().y}this.setRowsHeight(K,I,{minSize:this.options.minSize})}}catch(M){delete this._resizingInfo}}},_initSize:function w(){var I=this,H=this._getRowIds();this._setEqualRowsHeight();H.forEach(function(J){I._setEqualColumnsWidthInRow(J)})},_setEqualRowsHeight:function r(){var I=this,H=this._getRowIds();H.forEach(function(K){var J=100/H.length;I._getRowElem(K).setStyle("height",I._toPercent(J))})},_setEqualColumnsWidthInRow:function b(J){var I=this,H=this._getColumnIdsInRow(J);H.forEach(function(L){var K=100/H.length;I._getColumnElem(L).setStyle("width",I._toPercent(K))})},_getRowIds:function m(){return this._rowIds},_getRowIdFromColumnId:function i(I){var H,J;for(J in this._rowColumnMap){if(this._rowColumnMap[J].indexOf(I)!==-1){H=parseInt(J);break}}return H},_getColumnId:function y(J,H){var I;if(this._rowColumnMap.hasOwnProperty(J)){I=this._rowColumnMap[J][H]}return I},_getColumnIdsInRow:function x(H){return this._rowColumnMap[H]},_getFixedColumnIds:function e(){return this._fixedColumnIds},_getFixedRowIds:function q(){return this._fixedRowIds},_getRowElem:function A(H){return this._rowMap[H]},_getColumnElem:function p(H){return this._columnMap[H]},_toPx:function G(I){var H;if(!isNaN(I)){H=Math.floor(I).toString()+"px"}return H},_toPercent:function d(I){var H;if(!isNaN(I)){H=Math.floor(I).toString()+"%"}return H},_setElemsSize:function t(ae,T,ac,Y,L){var S=this,R,X,K=[],J,O,W=[],I,ab,ad,U,H=0,Q,M,P,N;var V=(function(){var ag={},af=function(ak,al){var ai=0,aj=!isNaN(al)?al:1;ak.forEach(function(am){if(ag.hasOwnProperty(am)){ai=ai+ag[am]*aj}});return ai},ah=function(){var al=ac.length,ai=af(ac),aj=Math.floor(ai/al),ak;for(ak in ag){ag[ak]=aj}};ac.forEach(function(ai){ag[ai]=S.getSize(ai)});return{get:af,setEqualSize:ah}})();var aa=(function(){var af={},ai=function(ak,aj){af[ak]=aj},ag=function(ak){var aj=0;ak.forEach(function(al){if(af.hasOwnProperty(al)){aj=aj+af[al]}});return aj},ah=function(){var al,aj,ak=0;for(al in af){if(Math.max(ak,af[al])===af[al]){aj=al;ak=af[al]}}return{id:aj,value:ak}};return{set:ai,get:ag,getMax:ah}})();try{if(L){if(L.hasOwnProperty("fixedIds")){K=L.fixedIds}if(L.hasOwnProperty("minSize")){H=L.minSize}}if(T<0){throw"Input error: size"}if(Y<=0){throw"Input error: container size"}O=ae.filter(function(af){if(K.indexOf(af)!==-1){return true}W.push(af)});if(O.length>0){R=T-V.get(O);X=W}else{R=T;X=ae}if(X.length<1){throw"No element available for resize"}if(R<X.length*H){throw"Cannot set size inferior to minSize"}J=ac.filter(function(af){return -1===X.indexOf(af)&&-1===K.indexOf(af)});ad=V.get(K);U=V.get(J);ab=V.get(X);if(R+ad+J.length*H>Y){throw"Cannot set size superior to container size"}if(ab===0){V.setEqualSize();ab=V.get(X);U=V.get(J)}Q=ab!==0?R/ab:0;M=U!==0?(Y-ad-R)/U:0;I=X.concat(J);I.forEach(function(ai,af){var ah=af<X.length?Q:M,ag=Math.round(V.get([ai],ah));ag=ag>H?ag:H;aa.set(ai,ag)});P=aa.get(ac)+ad-Y+1;if(P>0){N=aa.getMax();if(N.value-P<H){throw"Cannot set size inferior to minSize"}aa.set(N.id,N.value-P)}}catch(Z){S._logger.warn(Z);return}I.forEach(function(af){S.setSize(af,aa.get([af]))})},maximizeRow:function a(I){var H=this.getContent().getSize().height;this.setRowsHeight([I],H)},maximizeColumnInRow:function B(J,I){var H=this._getRowElem(J).getSize().width;this.setColumnsWidth(J,[I],H)},unmaximizeRows:function l(){this._setEqualRowsHeight()},unmaximizeColumnsInRow:function c(H){this._setEqualColumnsWidthInRow(H)},setColumnContent:function o(L,I,K){var J,H;if(K){J=this._getColumnId(L,I);H=this._getColumnElem(J).getElement(".bl-column-content");H.setContent(K)}},setColumnsWidth:function j(O,N,L,J){var H=this,K=[],M=this._getFixedColumnIds();try{N.forEach(function(P){var Q=H._getColumnId(O,P);if(!isNaN(Q)){K.push(Q)}else{throw"Column number: "+P.toString()+" does not exist"}})}catch(I){this._logger.warn(I);return}this.setColumnsWidthById(K,L,g.extend(J,{fixedIds:M}))},setColumnsWidthById:function n(N,J,P){var Q=this,M=this._getFixedColumnIds(),H,K,L,I;try{if(N.length<1){throw"Input array of ids is empty"}L=this._getRowIdFromColumnId(N[0]);if(isNaN(L)){throw"Invalid column id"}}catch(O){this._logger.warn(O);return}H=this._getRowElem(L).getSize().width;K=this._getColumnIdsInRow(L);I={_logger:Q._logger,getSize:function(R){return Q._getColumnElem(R).getSize().width},setSize:function(S,R){Q._getColumnElem(S).setStyle("width",Q._toPx(R))}};this._setElemsSize.call(I,N,J,K,H,g.extend(P,{fixedIds:M}))},setRowsHeight:function E(O,N,L){var H=this,J=this._getFixedRowIds(),M,K;try{if(O.length<1){throw"Input array of ids is empty"}}catch(I){this._logger.warn(I);return}M=this.getContent().getSize().height;K={_logger:H._logger,getSize:function(P){return H._getRowElem(P).getSize().height},setSize:function(Q,P){H._getRowElem(Q).setStyle("height",H._toPx(P))}};this._setElemsSize.call(K,O,N,this._getRowIds(),M,g.extend(L,{fixedIds:J}))},addFixedColumns:function f(J){var H=this,K,I;J.forEach(function(L){var M=H._getColumnId(L.row,L.column);if(!isNaN(M)){H._fixedColumnIds.push(M);K=H._getColumnIdsInRow(L.row);if(Math.max.apply(null,K)===M&&K.length>1){I=H._getColumnElem(M-1).getElement(".bl-drag-column")}else{I=H._getColumnElem(M).getElement(".bl-drag-column")}if(I){I.destroy()}}else{H._logger.warn("{"+L.row.toString()+", "+L.column.toString()+"}: Invalid column")}})},removeFixedColumns:function z(I){var H=this,L,J,K;I.forEach(function(M){var N=H._getColumnId(M.row,M.column);if(!isNaN(N)){J=H._fixedColumnIds.indexOf(N);if(-1!==J){H._fixedColumnIds.splice(J,1);L=H._getColumnIdsInRow(M.row);if(Math.max.apply(null,L)===N&&L.length>1){K=N-1}else{K=N}H._createHandle(M.row,K,"bl-drag-column").inject(H._getColumnElem(K),"top")}else{H._logger.warn("{"+M.row.toString()+", "+M.column.toString()+"}: Column was not fixed")}}else{H._logger.warn("{"+M.row.toString()+", "+M.column.toString()+"}: Invalid column")}})},onContainerResized:function(I){var H=this;this.getContent().addEvent("resize",function(){I.call(H)})}});return h});define("DS/DELWebMfgAssetsDefUIControls/UnitsEditor",["UWA/Core","DS/Controls/LineEditor","css!DS/DELWebMfgAssetsDefUIControls/assets/css/UnitsEditor.css"],function(g,c){var b=c.inherit({name:"UnitsEditor",buildView:function e(){this.elements.container.addClassName("wux-controls-lineeditor custom-controls-unitseditor");this._myInputGroup=new g.Element("div",{"class":"input-group  unitseditor-input-group"});this._myUnit=new g.Element("span",{"class":"input-group-addon unitseditor-group-addon"});this._myInput=new g.Element("input",{type:"text",tabindex:0,autocomplete:"off"});this._myInput.inject(this._myInputGroup);this._myUnit.inject(this._myInputGroup);this._myInputGroup.inject(this.elements.container);this._myInput.addClassName("wux-ui-state-"+this.options.type);this._validFlag=true;if(this.displayClearFieldButtonFlag){this._layoutClearFieldButton()}},setUnit:function a(h){this._myUnit.setContent(h)},getUnit:function f(){return this._myUnit.getText()},setInputName:function d(h){this._myInput.name=h}});return b});define("DS/DELWebMfgAssetsDefUIControls/LogPanel",["UWA/Core","DS/Core/Events","UWA/Controls/Abstract","DS/Windows/Panel","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/LoggerUtils","DS/DELWebMfgAssetsDefModelServices/Resources"],function(d,k,g,b,c,a,e){var i=g.singleton({name:"LogPanel",defaultOptions:{className:"MGA-LogPanel",},_state:false,_logPanel:null,_actionNLS:{started:e.getNLSValue("LogPanel.Started"),completed:e.getNLSValue("LogPanel.Completed"),failed:e.getNLSValue("LogPanel.Failed"),timedout:e.getNLSValue("LogPanel.TimedOut")},_sizeAtLastUpdate:-1,_update:function h(){var m,r,p,n,l,o,q;if(this._state){p=a.getSize();if(p!==this._sizeAtLastUpdate){this._sizeAtLastUpdate=p;n=Math.min(p,1000);r="";for(m=p-1;m>=p-n;m--){o=a.getModel(m);q=o.get("action");l=e.getNLSValue("LogPanel.LineFormat",{index:o.get("index"),name:o.get("name"),action:this._actionNLS[q],time:o.get("time")});if(o.get("isRunning")){l="<b>"+l+"</b>"}r+="<div>"+l+"</div>"}this._logPanel.content=new d.Element("div",{html:r,"class":"MGA-DELWebMfgAssetsDefUIControls-LogPanel"})}}},init:function j(l){var m=this,n=c.getMGAElement("FrameWindow").getImmersiveFrame();this._parent(l);this._logPanel=new b({title:e.getNLSValue("LogPanel.Header"),position:{at:"top-right"},immersiveFrame:n,resizableFlag:true});a.setAddCallback(function(){m._update()});this._logPanel.close=function(){k.publish({event:"MFNMGA.LogPanelCloseEvent"})}},toggle:function f(){this._state=!this._state;if(this._state){this._logPanel.show();this._update()}else{this._logPanel.hide()}}});return i});define("DS/DELWebMfgAssetsDefUIControls/CreateMfgItemDialogUI",["UWA/Core","UWA/Class","DS/Windows/Dialog","DS/Controls/ComboBox","DS/Controls/Button","UWA/Class/Options","DS/DELWebMfgAssetsDefUIControls/WUXForm","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIControls/CreateOrUpdateMfgItemDialogWebService"],function(f,a,l,m,j,i,d,g,c,b){var h=a.singleton({name:"CreateMfgItemDialog",buildSkeleton:function e(r,p){var o,q,n;o=new f.Element("div",{"class":"container createMfgItem-dialog-container"});this.ProductItemDiv=c.createTitleSectionInDialog("Dialog.ProductItem.Title",o);this.MfgItemDiv=c.createTitleSectionInDialog("Dialog.MfgItem.Title",o);if(p==="BODY"){c.addSelectedNode(this.ProductItemDiv,r);q="Info.SelectAssembly.Title";this.MfgItemDiv.setHTML(g.getNLSValue(q))}else{c.addSelectedNode(this.MfgItemDiv,r);if(r.isScoped()){n=r.getScopedNode();c.addSelectedNode(this.ProductItemDiv,Array.isArray(n)?n[0]:n)}else{q="Info.SelectProductOrPart.Title";this.ProductItemDiv.setHTML(g.getNLSValue(q))}}if(f.is(q)){c.AlertManager.add({className:"info",message:g.getNLSValue(q)})}this.dialogContent=o},createDialog:function k(p,y,z,x){var A=this,r,w,v,o,u,q,t,s,n;if(0===z.get().length){o=y.get();if(o.length<=0){return}o=o[0];q=o.getReferencePID();this.buildSkeleton(o,"BODY");A.XSO=z;A.divForUpdate=A.MfgItemDiv}else{v=z.get();if(v.length<=0){return}v=v[0];u=v.getReferencePID();this.buildSkeleton(v,"MBOM");if(v.isScoped()){t=v.getScopedNode();t=Array.isArray(t)?t[0]:t;s=false;q=t.getReferencePID()}else{A.XSO=y;A.divForUpdate=A.ProductItemDiv}}if(A.XSO){n=A.XSO.onPostAdd(function(B){A.XSO.unsubscribe(n);if(f.is(v)){o=B[0];q=o.getReferencePID()}else{v=B[0];u=v.getReferencePID()}c.addSelectedNode(A.divForUpdate,B[0]);A.dialog.buttons.Ok.disabled=false})}r=new d();w={};w[g.getNLSValue("MfgItemDialog.Options")]=[{fieldType:"combobox",name:"scopeCreation",title:g.getNLSValue("MfgItemDialog.CreateScopeForChildren"),domId:"scopeSelectionCombo",enableSearchFlag:false,elementsList:[{labelItem:g.getNLSValue("MfgItemDialog.ScopeCreation.AllScope"),valueItem:"AllLevel"},{labelItem:g.getNLSValue("MfgItemDialog.ScopeCreation.LeafScope"),valueItem:"Leaf"},]},{fieldType:"lineeditor",name:"prefix",title:g.getNLSValue("MfgItemDialog.PrefixForMfgItems"),domId:"prefixLineEditor",placeholder:g.getNLSValue("MfgItemDialog.PrefixForMfgItemsPlaceHolder")}];r.createUI({renderTo:this.dialogContent,sections:w});this.dialog=new l({content:this.dialogContent,immersiveFrame:c.getMGAElement("FrameWindow").getImmersiveFrame(),buttons:{Cancel:new j({onClick:function(){this.dsModel.dialog.destroy();if(A.XSO){A.XSO.unsubscribe(n)}}}),Ok:new j({disabled:f.is(s)?s:true,emphasize:"primary",onClick:function(){var B=r.getValues();b.webServiceCall(p,q,u,B,function(C){x(C)});this.dsModel.dialog.destroy()}}),}});if(p==="CreateMfgItem"){this.dialog.title=g.getNLSValue("Dialog.CreateMfgItem.Title")}else{if(p==="UpdateMfgItem"){this.dialog.title=g.getNLSValue("Dialog.UpdateMfgItem.Title")}}},});return h});define("DS/DELWebMfgAssetsDefUIControls/LinksUI",["UWA/Core","UWA/Controls/Abstract","DS/Core/Events","DS/Logger/Logger","DS/Windows/Panel","DS/UIKIT/Tooltip","DS/UIBehaviors/SwipeableMenu","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIControls/EditAttributeUI","DS/DELWebMfgAssetsDefUIServices/AttributeUtil","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/PlatformAPI/PlatformAPI","DS/Controls/Button","DS/UIBehaviors/ContextualMenuManager","DS/ApplicationFrame/CommandsManager","DS/DELWebMfgAssetsDefModelServices/Selection","DS/DELWebMfgAssetsDefModelServices/ImplementLinkUtil","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil","DS/DELWebMfgAssetsDefUIServices/RelationsColumnManager","DS/DELWebMfgAssetsDefModelServices/ModelPreferences"],function(c,K,I,a,r,v,f,J,E,u,j,k,q,x,o,C,z,A,y,h,i,n,m){var l=K.singleton({name:"LinksUI",_logger:null,_context:null,_relationDisplayAttributeConfigXML:"DELWebMfgAssetsDefUI/DELWebMfgAssetsDefRelationsDialogDisplayAttributeConfig",_widgetTrigram:"",defaultOptions:{className:i.isLinksUIMultiSelection()?"Links MGA-linksUIContainer disableContentselection LinksUI-multiSelect":"Links MGA-linksUIContainer disableContentselection",},init:function F(N){this._parent(N);if(a){this._logger=a.getLogger(l)}this._PPRTYPE=[];this._currentModel=null;this._relationsCmd=null;this._widgetTrigram=E.getWidgetTrigram();this._LinkOpt=u.getIconDataFromKey("Link");this._LinkInverseOpt=u.getIconDataFromKey("LinkInverse");if(c.is(N)){if(N.relationDisplayAttributeConfigXML){this._relationDisplayAttributeConfigXML=N.relationDisplayAttributeConfigXML}}this._context=this.getOption("context");this.buildSkeleton();this._subscribeEvents()},buildSkeleton:function(){var N=x.getMGAElement("UIContainer").getSize();this._relationPanel=new r({position:{my:"center",at:"center"},immersiveFrame:x.getMGAElement("FrameWindow").getImmersiveFrame(),resizableFlag:true,visibleFlag:false,snappableFlag:false});this._relationPanel.close=function(){if(c.is(l._relationsCmd)){l._relationsCmd.toggleState()}else{l.toggle()}};this.elements.container=new c.Element("div",{"class":this.options.className});this.elements.menuDiv=new c.Element("div",{"class":"LinksUI-menuDiv",styles:{"max-height":(N.height)*0.5,overflow:"auto"}});if(x._linkViewToolBar){x._linkViewToolBar.inject(this.elements.container)}this.elements.menuDiv.inject(this.elements.container)},getSelectedNodeAbsolutePath:function M(T){var R=x.getMGAElement("TableUI"),Q=x.getMGAElement("LeftUI"),S=x.getMGAElement("RightUI"),O=x.getMGAElement("TreeUI"),N,P=null;if(c.is(R)){N=R.getDocument().getSelectedNodes()}if(c.is(Q)){N=N.concat(Q.getDocument().getSelectedNodes())}if(c.is(S)){N=N.concat(S.getDocument().getSelectedNodes())}if(c.is(O)){N=N.concat(O.getDocument().getSelectedNodes())}N.forEach(function(U){if(U.getInstancePID()===T){P=U.getAbsolutePath()}});return P},_subscribeEvents:function e(){var N=this;E.getXMLValues(l._relationDisplayAttributeConfigXML,function O(Q){var T=Q.convert("DisplayAttributeDescriptionList.Type","name")||{},S=x.getMGAElement("LinkViewTypeFilter");if(c.is(S)){S.addEvent("onChange",function R(){var U;if(c.is(N._currentModel)){U=this.getSelectedItems();l._createLinksMenu(N._currentModel.iReference,N._currentModel.iInstance,N._currentModel.iLabel,U,T)}})}});o.subscribe("DS."+N._widgetTrigram+".Selection.SelectionModified",function P(S){var Q=null,R=null;if(c.is(S)){if(c.is(S.widgetId)&&c.is(widget.id)&&(S.widgetId===widget.id)&&N._relationPanel.visibleFlag){if(c.is(S.modifiedObjectPID,"string")){if(c.is(S.modifiedObjectSelectionState,"boolean")&&S.modifiedObjectSelectionState){Q=J.getReferenceFromCollection(S.modifiedObjectPID);R=c.is(S.modifiedObjectInstPID)?J.instances.get(S.modifiedObjectInstPID):null;N._updateOnSelection(Q,R)}}}}})},toggle:function s(S){var R,Q=null,P=null,N=null,O=null;this._relationsCmd=S;if(this._relationPanel.visibleFlag){R=x.getMGAElement("LinkViewTypeFilter");R.unselectItem("PARENT",false);this._relationPanel.hide()}else{O={};if(c.is(S._context.VIEWS)){N=Object.keys(S._context.VIEWS);if(N.indexOf(S._context.getCurrentView())!==-1){O.views=S._context.getCurrentView()}}P=this._extractFirstElt(J.getSelectedRefs(O));Q=this._extractFirstElt(J.getSelectedInsts());if(!c.is(P)&&c.is(O.views)){P=this._extractFirstElt(J.getSelectedRefs())}l._updateOnSelection(P,Q)}},_updateOnSelection:function d(Q,P){var N="V_Name",O=x.getMGAElement("TableUI");if(O._labelIsOnRef===true){N=O._label}if(c.is(Q)){if(null!==Q){l._logger.log("LinksUI._updateOnSelection (ref): "+Q.get("V_Name"));if(c.is(P)&&(null!==P)){l._logger.log("LinksUI._updateOnSelection (inst): "+P.id)}l.showModal(Q,P,N)}}},_extractFirstElt:function H(N){var O=null;if(c.is(N,"array")){if(N.length>=1){O=N[0]}}return O},updateUI:function G(N){var O;if(this._relationPanel.visibleFlag&&c.is(this._currentModel)){O=this._currentModel.iReference.id;if(O===N.get("from")||O===N.get("to")){l.showModal(this._currentModel.iReference,this._currentModel.iInstance,this._currentModel.iLabel)}}},showModal:function L(Q,P,O){var N=this,R=Q.get(O);if(x._linkViewTypeFilter){x._linkViewTypeFilter.enable()}this._currentModel={iReference:Q,iInstance:P,iLabel:O};this._PPRTYPE.PRODUCT=u.getNLSValue("PPRTYPE.PRODUCT");this._PPRTYPE.PROCESS=u.getNLSValue("PPRTYPE.PROCESS");this._PPRTYPE.SYSTEM=u.getNLSValue("PPRTYPE.SYSTEM");this._PPRTYPE.RESOURCE=u.getNLSValue("PPRTYPE.RESOURCE");this._PPRTYPE.PART=u.getNLSValue("PPRTYPE.PART");this._PPRTYPE.PARENT=u.getNLSValue("PPRTYPE.PARENT");this._PPRTYPE.REQUIREMENT=u.getNLSValue("PPRTYPE.REQUIREMENT");E.getXMLValues(l._relationDisplayAttributeConfigXML,function(S){var U=S.convert("DisplayAttributeDescriptionList.Type","name")||{},T=x.getMGAElement("LinkViewTypeFilter");if(c.is(T)){l._createLinksMenu(Q,P,O,T.getSelectedItems(),U)}else{N._logger.warn("Could not get MGA Element LinkViewTypeFilter");l._createLinksMenu(Q,P,O,["PROCESS","RESOURCE","PART","PRODUCT","SYSTEM"],U)}l._relationPanel.show();l._relationPanel.title=u.getNLSValue("LinksUI.PanelTitle")+R;l._relationPanel.content=l.getContent()})},_createLinksMenu:function b(S,T,V,U,W){var aa=this,aj=false,ac=false,ag=false,Y=[],O=[],ab={},R,ae=null,af,X=i.isLinksUIMultiSelection(),Q=function Q(aD,ak){var aG,aK,au=null,at=null,ay=null,aq,aT,aI=[],aM,aC,an,aN,aJ,ax,am,aH,az,aS,al,aQ,aB,ar,aL,aA,ap,aw,av,ao,aF,aE,aR;var aP=function aP(a2,aU,aY){var aW,aX,a0,aV,aZ,a1;if(!c.is(aY)){aY=false}if(a2.get("PPRTYPE")==="REQUIREMENT"){a0="Requirement"}else{a0=a2.get("type")}if(c.is(W[a0])){if(aY&&c.is(aU)){aZ=c.is(ab[aU.type+"from"])?"from":(c.is(ab[aU.type+"to"])?"to":null);if(aZ!==null){a1=aU.type+aZ;aW=ab[a1].split(",")}else{aW=W[a0].display_attribute.split(",")}}else{aW=W[a0].display_attribute.split(",")}aX=W[a0].separator||" ";aV="";for(aS=0;aS<aW.length;aS++){if(aS!==0){aV+=aX}aV+=a2.get(aW[aS])}}else{aV=a2.get(V)}if(!c.is(aV)||aV===""||aV==="null"||aV==="undefined"){aV=u.getNLSValue("LinksUI.NoLabel")}return aV};if(c.is(S)){aG=S.id;aT=S.get(V)}if(c.is(T)){aK=T.id;if(E.getWidgetTrigram()!=="MFN"){au=aa.getSelectedNodeAbsolutePath(aK);at=h.getOccPathForUpperScope(au)}}aa.elements.menuDiv.empty();aI.PRODUCT=[];aI.PROCESS=[];aI.SYSTEM=[];aI.RESOURCE=[];aI.PART=[];aI.PARENT=[];aI.REQUIREMENT=[];for(aM=0;aM<aD.length;aM++){aC=aD[aM]._attributes;aE=(c.is(aC.isCustomConnection)&&aC.isCustomConnection===true)?true:false;an=aC.type;aJ=aC.to;if(Array.isArray(aC.to)&&Array.isArray(aC.from)){if(an==="ProcessImplementLinkOcc"){if(Array.isArray(aC.from)&&Array.isArray(aC.to)){if(!J.arrayCompare(at,aC.from)){if(!J.arrayCompare(at,aC.to)){continue}}}}else{if(an==="DELLmiTimeConstraintCnx"){aq=au.length-aC.from.length;ay=au.slice(aq,au.length);if(!J.arrayCompare(ay,aC.from)){if(!J.arrayCompare(ay,aC.to)){continue}}}}}if(Array.isArray(aC.to)){if(an==="DELLmiTimeConstraintCnx"){aF=J.arrayCompare(ay,aC.to)}else{aF=(aK===aC.to[aC.to.length-1])?true:false}}if(aG===aC.to||aK===aC.to||aF){aJ=aC.from;if(!aE){an+="_inverse"}aB=c.createElement("img",{src:l._LinkInverseOpt.url,"class":l._LinkInverseOpt.className})}else{aB=c.createElement("img",{src:l._LinkOpt.url,"class":l._LinkOpt.className})}if(an==="DELAsmProcessCanUseCnx"){ax=S.get("PPRTYPE");if(ax==="PROCESS"){an+="_process"}}if(aE){am=J.customObjs.get(aJ)}else{if(J.isReference(aJ)){am=J.references.get(aJ)}else{if(c.is(aJ,"array")){aH=J.instances.get(aJ[aJ.length-1])}else{aH=J.instances.get(aJ)}if(!aH){aa._logger.error("No linked instance !!!")}else{am=J.references.get(aH.get("isInstanceOf")||aH.get("to"))}}}if(c.is(am)){az=aP(am,aC,aE);al=am.get("PPRTYPE");if(al==="OPERATION"){al="SYSTEM"}if(an==="DELAsmProcessCanUseCnx_inverse"&&al==="PROCESS"){an+="_process"}aN=u.getIconDataFromKey(an);aQ=c.createElement("img",{src:aN.url,"class":aN.className});if(aE&&(aN.url.indexOf("I_DELQuestionMark")!==-1)){aQ=u.getIconFromKey("Requirement")}aI[al].push({label:az,icon:aQ,iconDirection:aB,pid:aC.PID,linkedReferencePID:am.id,type:an})}else{aa._logger.error("No linked reference !!!")}}if(c.is(ak,"array")){ak.forEach(function aO(aV){var aU=J.instances.where({isAggregatedBy:aV.id,isInstanceOf:aG});am=J.references.get(aV.id);an=am._attributes.type;az=aP(am);aB=u.getIconFromKey("Link");aQ=u.getIconFromKey(an);aI.PARENT.push({label:az,icon:aQ,iconDirection:aB,pid:aU,linkedReferencePID:am.id,type:an})})}for(ar in aI){if(aI.hasOwnProperty(ar)){aL=aI[ar];if(aL.length===0||U.indexOf(ar)===-1){continue}aA=new c.Element("div",{"class":"pprTypeDiv"}).inject(aa.elements.menuDiv);new c.Element("div",{"class":"pprTypeTitleDiv",text:aa._PPRTYPE[ar]}).inject(aA);for(aM=0;aM<aI[ar].length;aM++){ap=aI[ar][aM];if(X){aw=c.createElement("div",{"class":"connectionDiv fromToView"});ap.icon.inject(aw);c.createElement("div",{"class":"connectionLabel",html:aT,styles:{display:"inline-block"}}).inject(aw);ap.iconDirection.inject(aw)}else{aw=c.createElement("div",{"class":"connectionDiv"});ap.iconDirection.inject(aw);ap.icon.inject(aw)}new v({position:"bottom",target:aw,body:u.getNLSValue(ap.type)});c.createElement("div",{"class":"connectionLabel",html:ap.label,styles:{display:"inline-block"}}).inject(aw);aE=(ar==="REQUIREMENT")?true:false;if(c.is(widget.getValue("linksUISwipeableMenu"))&&widget.getValue("linksUISwipeableMenu")==="true"){aw.setData("pid",ap.pid);aw.setData("linkedReferencePID",ap.linkedReferencePID);aR=function aR(aZ,a3){var aV=[],aY,a5,aW,a1,aX,a7,a2,a0;var aU=function aU(ba,a8,a9){var bb=u.getIconFromKey(ba).getContent();new v({position:a8,target:bb,body:u.getNLSValue(a9)});return bb};var a4=function(a9,a8){this.label=a9.setStyles({height:"32",width:"32","margin-top":"9"});this.callback=a8;this.styles={backgroundColor:"LightGray"}};aX=aU("GeneralDelete","left","LinksUI.DeleteLink");a7=aU("EditAttribute","top","LinksUI.EditAttribute");a2=aU("showAuxiliaryView","top","LinksUI.ShowInAuxiliaryView");a0=aU("ExploreInWebApp","right","Cmd.ExploreInWebApp.Title");aY=new a4(aX,function a6(){var a9=this,a8=this.parentElement.getChildren()[0].getChildren()[0].getData("pid");l._generalDeleteCallback(a8,a9.parentElement,a3)});a5=new a4(a7,function a6(){var a8=this.parentElement.getChildren()[0].getChildren()[0].getData("pid");l._editAttrCallback(a8)});aW=new a4(a2,function a6(){var a8=this.parentElement.getChildren()[0].getChildren()[0].getData("linkedReferencePID");l._showInAuxViewCallback(a8)});a1=new a4(a0,function a6(){var a8=this.parentElement.getChildren()[0].getChildren()[0].getData("linkedReferencePID");l._exploreInWebAppCallback(a8)});aV.push(aY);if(c.is(J.connections.get(aZ))){aV.push(a5)}else{if(c.is(J.customConnections.get(aZ))){aV.push(a5)}}if(!a3){aV.push(aW)}aV.push(a1);return aV};av=new f({target:aw,menu:aR(ap.pid,aE)});av.inject(aA)}else{ao=new C({label:"",icon:"bars",iconSize:"2x",displayStyle:"lite",onClick:aa._onShowOptions}).inject(aw);ao.getContent().setStyles({"float":"right"});ao.getContent().setData("pid",ap.pid);ao.getContent().setData("linkedReferencePID",ap.linkedReferencePID);ao.getContent().setData("isCustom",aE);ao.getContent().setData("pprType",ar);aw.inject(aA)}}}}I.publish({event:"DELWebMfgAssetsDefUI/relationPanelConnexions"})},ai=function ad(){if(aj&&ac&&ag){Q(Y,O)}},P=function P(ak){ac=true;O=ak;ai()},ah=function ah(ak){if(c.is(Y,"array")){if(aj===true){ak.forEach(function(al){Y.push(al)});ag=true;ai()}else{ae=ak}}},N=function N(ak){aj=true;Y=ak;if(c.is(ae)){ae.forEach(function(al){Y.push(al)});ag=true;ae=null}ai()};if(c.is(S)&&U.indexOf("PARENT")!==-1){J.getWhereUsedReferences(S,P)}else{ac=true}if(c.is(S)&&(U.indexOf("REQUIREMENT")!==-1)){R=function(am,an,al,ak){this.relation=am;this.direction=an;this.displayAttributes=al;this.connectionAttributes=[];if(ak!==null){if(c.is(ak,"array")){ak.forEach(function(ao){this.connectionAttributes.push(ao.name)})}else{this.connectionAttributes.push(ak.name)}}};if(c.is(W.Requirement)&&(c.is(W.Requirement.Relation,"array")||c.is(W.Requirement.Relation,"object"))){E.getXMLValues("DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIEditLinkAttributes",function Z(ak){var am;var al=[];am=Array.isArray(W.Requirement.Relation)?W.Requirement.Relation:[W.Requirement.Relation];am.forEach(function(ap){var ar=ak.Config[ap.name],aq=null,an,ao;if(c.is(ar,"array")||c.is(ar,"object")){aq=ar.Attribute}an=c.is(ap.display_attribute)?ap.display_attribute:W.Requirement.display_attribute;ao=ap.name+ap.direction;ab[ao]=an;al.push(new R(ap.name,ap.direction,an,aq))});J.getCustomReferences(S,ah,al,ab)})}else{x.AlertManager.add({className:"warning",message:'Missing configuration for "Requirements"'});ag=true}}else{ag=true}if(m.getNavigateOn()==="index"||m.getNavigateOn()==="database"){J.getConnectionsByModel(S,T,null,false,N)}else{if(m.getNavigateOn()==="indexOndemand"){af=function af(am){var ak=[];am.forEach(function al(ao){J.getInstanceFromCollection(ao.getInstancePID()).getDisplayModelAttr("connectionModelInfo").forEach(function an(ap){ak.push(J.getConnectionFromCollection(ap.connectionID))});J.getReferenceFromCollection(ao.getReferencePID()).getDisplayModelAttr("connectionModelInfo").forEach(function an(ap){ak.push(J.getConnectionFromCollection(ap.connectionID))})});N(ak)};aa._context.getMBOMTreeListView().utils.loadRelations(af)}}},_onShowOptions:function g(Z){var N=[],S=this.getParent(),X=this.getData("pid"),T=this.getData("linkedReferencePID"),ab=this.getData("isCustom"),P=this.getData("pprType"),aa,O=i.isLinksUIMultiSelection(),W=Z.currentTarget.getOffsets().x,V=Z.currentTarget.getOffsets().y+25,Y,R,ac,Q,U;Y={icon:"url("+u.getIconURLFromKey("GeneralDelete")+")",label:u.getNLSValue("LinksUI.DeleteLink"),sensitivity:"enabled",callback:function(){l._generalDeleteCallback(X,S,ab)}};R={icon:"url("+u.getIconURLFromKey("EditAttribute")+")",label:u.getNLSValue("LinksUI.EditAttribute"),sensitivity:"enabled",callback:function(){l._editAttrCallback(X)}};ac={icon:"url("+u.getIconURLFromKey("showAuxiliaryView")+")",label:u.getNLSValue("LinksUI.ShowInAuxiliaryView"),sensitivity:"enabled",callback:function(){l._showInAuxViewCallback(T)}};Q={icon:"url("+u.getIconURLFromKey("ExploreInWebApp")+")",label:u.getNLSValue("ExploreInWebApp",null,"Cmd","Title"),sensitivity:"enabled",callback:function(){l._exploreInWebAppCallback(T)}};U={icon:"url("+u.getIconURLFromKey("ReplaceCapableResource")+")",label:u.getNLSValue("LinksUI.ReplaceCapableResource"),sensitivity:"enabled",callback:function(){l._replaceResourceCallback(X)}};N.push(Y);if(c.is(J.connections.get(X))){N.push(R)}else{if(c.is(J.customConnections.get(X))){N.push(R)}}if(!ab){N.push(ac)}N.push(Q);aa=(O&&(P==="RESOURCE"))?true:false;if(aa){N.push(U)}z.show({nodes:N},[W,V])},_generalDeleteCallback:function p(Q,O,S){var N,R,P,U,V,W;if(S){P=J.customConnections.get(Q);if(c.is(P)){P.destroy({proxy:"passport",headers:E.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),wait:true,onFailure:function(){x.AlertManager.add({className:"error",message:u.getNLSValue("LinksUI.DeleteFailure")})},onComplete:function(){x.AlertManager.add({className:"success",message:u.getNLSValue("LinksUI.DeleteSuccess")});O.destroy()},logMessage:u.getNLSValue("LinksUI.LogMessage")})}return}N=J.connections.get(Q);if(c.is(N)){N.destroy({proxy:"passport",headers:E.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),wait:true,onFailure:function(){x.AlertManager.add({className:"error",message:u.getNLSValue("LinksUI.DeleteFailure")})},onComplete:function(){x.AlertManager.add({className:"success",message:u.getNLSValue("LinksUI.DeleteSuccess")});O.destroy()},logMessage:u.getNLSValue("LinksUI.LogMessage"),reason:"fromConnectionRemoval"})}R=c.is(Q)?(c.is(Q,"array")?Q:(c.is(J.instances.get(Q))?[J.instances.get(Q)]:null)):null;if(c.is(R)){R.forEach(function T(X){var Z=J.instances.get(X.PID);U=X.PLM_ExternalID;V=u.getNLSValue("DeleteCmd.AreYouSure");W=u.getNLSValue("DeleteCmd.DeleteInstanceConfirmation",{instanceLabel:U});x.ModalManager.confirm(W,V,function Y(aa){if(aa){Z.destroy({proxy:"passport",headers:E.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),wait:true,onFailure:function ab(){x.AlertManager.add({className:"error",message:u.getNLSValue("LinksUI.DeleteFailure")})},onComplete:function ac(ah){var ad=J.getReferenceModelFromInstance(ah),af=ad.get("V_Name"),ae=u.getNLSValue("DeleteCmd.AddAsNewRoot",{referenceLabel:af});x.AlertManager.add({className:"success",message:u.getNLSValue("LinksUI.DeleteSuccess")});O.destroy();if(c.is(ad.get("displayModel").get("asRootInAuxiliaryView"))){if(!ad.get("displayModel").get("asRootInAuxiliaryView")&&!ad.get("displayModel").get("asRootInTableView")){x.ModalManager.confirm(ae,V,function ag(ai){if(ai){ad.setDisplayModel({asRootInAuxiliaryView:true});widget.dispatchEvent("onShowAuxView",[{PPRType:ad.get("PPRTYPE")}])}})}}},logMessage:u.getNLSValue("LinksUI.LogMessage")})}})})}},_editAttrCallback:function t(N){E.getXMLValues("DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIEditLinkAttributes",function O(Q){var T,P=null,R,S;T=J.connections.get(N);if(!c.is(T)){T=J.customConnections.get(N)}if(c.is(T)){P=Q.Config[T.get("type")];if(c.is(P,"object")){R=P.Attribute;S=k.getObjectAndAttributeInfos(R);j.editAttributes(x.AlertManager,T,S)}else{x.AlertManager.add({className:"warning",message:u.getNLSValue("LinksUI.NoAttributes")})}}else{l._logger.warn("No connection to be modified found (pid): "+N)}})},_showInAuxViewCallback:function w(N){var O=J.references.get(N);if(c.is(O)){I.publish({event:"DELWebMfgAssetsDefUI/asRootInView",data:{rootPLMID:O.id}})}},_exploreInWebAppCallback:function B(N){var P,O;P=A.getCommand("ExploreInWebApp",y.getActionBarContext());if(c.is(P)){O=J.references.get(N);if(!c.is(O)){O=J.customObjs.get(N)}P.setSelectedReference(O);P.beginExecute();P.execute();P.endExecute()}},_replaceResourceCallback:function D(N){var P,O;P=A.getCommand("ReplaceCapableResourceCmd",y.getActionBarContext());if(c.is(P)){O=J.connections.get(N);P.setLinkedReference(O);P.beginExecute();P.execute();P.endExecute()}}});return l});define("DS/DELWebMfgAssetsDefUIControls/AssignProductMfgItemDialogUI",["UWA/Core","UWA/Class","DS/Windows/Dialog","DS/Controls/Button","DS/DELWebMfgAssetsDefUIControls/MfgItemDataCollectionFormUI","DS/DELWebMfgAssetsDefUIControls/MfgItemSelectionFormUI","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils"],function(h,a,n,l,g,j,i,d,c){var f=a.singleton({name:"AssignProductMfgItemDialog",mbomNodes:null,bodyNodes:null,init:function m(){},showDialog:function k(q,o){var p=this,r;this.dialog=new n({title:i.getNLSValue("Dialog.AssignProduct.Title")+" "+i.getNLSValue(q.split("/")[1]||"",null,"Type"),content:o,immersiveFrame:d.getMGAElement("FrameWindow").getImmersiveFrame(),buttons:{Cancel:new l({onClick:function(){p.dialog.close()}}),Ok:new l({disabled:h.is(r)?r:true,emphasize:"primary",onClick:function(){var s;if(h.is(p.onComplete)){if(h.is(p.dcForm)){if(!p.dcForm.validate()){return}s=p.dcForm.getValues()}p.onComplete(p.mbomNodes,p.bodyNodes,s);p.dialog.close()}}}),}});this.dialog.close=function(){p.cleanup()}},cleanup:function b(){this.mbomNodes=null;this.bodyNodes=null;if(h.is(this.selectionUI)){this.selectionUI.cleanup();this.selectionUI.destroy();this.selectionUI=null}if(h.is(this.dcForm)){this.dcForm.destroy();this.dcForm=null}if(h.is(this.dialog)){this.dialog.destroy();this.dialog=null}},createAssignProductUI:function e(s,u,v,r){var w=this,o,q,p;if(!h.is(this.dialog)){w.onComplete=r;o=new h.Element("div",{"class":"Assign-Product-Container"});q=new h.Element("div",{}).inject(o);p=new h.Element("div",{}).inject(o);f.showDialog(s,o);w.selectionUI=new j({bodyXSO:u,mbomXSO:v,multiSelectBodyNodes:true,onSelection:function t(y,x){w.mbomNodes=x;w.bodyNodes=y;if(h.is(x)){if(!x.getTreeDocument().areRelationsLoaded([x])){d.AlertManager.add({className:"error",message:i.getNLSValue("Error.RelationsNotLoaded.Title")});w.cleanup();return}}if(h.is(w.bodyNodes)&&h.is(w.mbomNodes)){w.dialog.buttons.Ok.disabled=false;if(!c.isAKindOf(x.getReferenceType(),"Provide")){if(!h.is(w.dcForm)){w.dcForm=new g(s,function(z){w.dialog.title=i.getNLSValue("Dialog.AssignProduct.Title")+" "+z});w.dcForm.inject(p)}}}else{w.dialog.buttons.Ok.disabled=true}}});w.selectionUI.inject(q)}}});return f});define("DS/DELWebMfgAssetsDefUIControls/DocumentMgmtUI",["UWA/Core","UWA/Class","DS/Core/Events","UWA/Controls/Abstract","DS/DELWebMfgAssetsDefModelServices/Resources","DS/Spreadsheet/DataGrid","DS/UIKIT/Input/Button","DS/UIKIT/Modal","DS/UIKIT/Form","DS/DELWebMfgAssetsDefModelServices/DocumentUtility","DS/DELWebMfgAssetsDefDocumentModel/DocumentModelUtility","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Spinner","DS/DELWebMfgAssetsDefUIControls/DocumentDisplayComponent","DS/DELWebMfgAssetsDefModelServices/LoggerUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/ModelPreferences"],function(e,b,L,N,s,o,B,f,q,H,w,v,c,p,y,a,C,n){var i=N.extend({init:function G(O){this._parent(O)},_createDocumentDlg:function h(Q){var P=this,O;this.documentDlg=new f({className:"MGA-DELWebMfgAssetsDefUICommands-DocumentMgmtUI-Dialog",closable:true,header:Q,body:new p({visible:true})});O=function O(){P.documentDlg.destroy();P.documentDlg=null};this.documentDlg.getHeader().children[0].addEvent("click",O);this.documentDlg.show()},_updateDocumentDlg:function I(O,R){var P=this,Q;this.documentDlg.setBody(O);this.documentDlg.setFooter(R);Q=this.documentDlg.getContent();Q.setAttribute("tabIndex","0");Q.addEventListener("keydown",function(S){if(S.keyCode===13){if(S.target.type==="button"){S.target.triggerEvent("click")}else{if(!e.is(S.target.type)){R.getElementsByClassName("ok")[0].click()}}}else{if(S.keyCode===27){P.documentDlg.destroy()}}});return this.documentDlg},_selectFile:function u(O,Q,R){var P=v.createElement("input",{attributes:{type:"file",accept:"*.*"},styles:{display:"none"},events:{change:R,}});P.multiple=Q;P.inject(O);P.click()},_uploadDocument:function M(Q,O,P){var U=O.title,V=s.getNLSValue("DocumentMgmtUI.AttachLogMessage",{title:U}),S=a.getNextIndex(),R=P[0];L.publish({event:"DELMGAMFN/webService/Start"});a.logStarted(S,V);H.attachFile(O,R,{onComplete:function T(ab){var Z,X,Y=ab.data[0];var W={onComplete:function aa(){w.addDocumentToCollection(Y);w.addDocumentConnectionToCollection(Q+"|"+Y.id,Y.id,Q);X=H.collectionUtils.documents.where({id:Y.id})[0];for(Z=1;Z<P.length;Z++){O.id=Y.id;R=P[Z];H.attachFile(O,R,{onComplete:function(ac){X.addFile(ac.data[0].relateddata.files[0])},onFailure:function(ac){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.UpdateDocFailed",{document:X.get("dataelements").title,message:e.Json.encode(ac)})})},onTimeout:function(ac){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.UpdateDocFailed",{document:X.get("dataelements").title,message:e.Json.encode(ac)})})}})}a.logCompleted(S,V);H._uiUtils.AlertManager.add({className:"success",message:s.getNLSValue("DocumentMgmtUI.UploadDocSucceeded",{document:Y.dataelements.title})});L.publish({event:"DELMGAMFN/webService/End"})},onFailure:function(ac){H.deleteDocument(Y.id);a.logFailed(S,V);H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.UploadFailed",{message:e.Json.encode(ac.message)})});L.publish({event:"DELMGAMFN/webService/End"})},onTimeout:function(ac){H.deleteDocument(Y.id);a.logFailed(S,V);H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.UploadFailed",{message:e.Json.encode(ac.message)})});L.publish({event:"DELMGAMFN/webService/End"})}};H.linkWithDocumentID(Q,Y.id,W)}})},_createUploadFileDlg:function j(T,O,af){var ab=T,ag,ah=true,Q,Z,ak,Y,ai,X=e.createElement("div"),P,aa,S,aj,ad,ae,ac,W,R,al,U;if(e.is(af)){ag=this;aj=ab._getDocID(af);ad=ab._getFileID(af);ae=H.collectionUtils.documents.where({id:aj})[0];ac=ae.get("dataelements").title;W=ae.get("dataelements").description;R=ae.get("dataelements").policy}if(e.is(ad)){Y=s.getNLSValue("DocumentMgmtUI.ModifyFileHeader");ah=false}else{if(e.is(aj)){Y=s.getNLSValue("DocumentMgmtUI.UpdateDocsHeader",{document:ac})}else{Y=s.getNLSValue("DocumentMgmtUI.AttachDocsHeader")}}T._createDocumentDlg(Y);Z=function Z(ap){var an,ao,aq,am=[];for(an=0;an<ap.length;an++){ao=ap[an];aq={type:"text",name:ao.name,multiline:"true",label:ao.name,placeholder:s.getNLSValue("DocumentMgmtUI.FileDescPlaceholder",{file:ao.name}),};am.push(aq)}ab._fileCommenstForm=new q({className:"horizontal",grid:"4 8",fields:am});ab._fileCommenstForm.inject(ak.getBody())};P={type:"text",name:"DocumentTitle",required:true,label:s.getNLSValue("DocumentMgmtUI.DocumentTitle"),placeholder:s.getNLSValue("DocumentMgmtUI.DocTitlePlaceholder")};aa={type:"text",name:"DocDescription",multiline:"true",label:s.getNLSValue("DocumentMgmtUI.DocDescription"),placeholder:e.is(af)?"":s.getNLSValue("DocumentMgmtUI.DocDescPlaceholder")};al=[];if(e.is(n.DocPolicyNames)){n.DocPolicyNames.forEach(function(am){al.push({value:am,label:s.getNLSValue(am)})})}S={type:"select",name:"DocPolicy",required:true,label:s.getNLSValue("DocumentMgmtUI.DocPolicy"),placeholder:s.getNLSValue("DocumentMgmtUI.DocPolicyPlaceholder"),options:al};if(e.is(ae)){P.disabled=true;P.value=ac;aa.disabled=true;aa.value=W}ai=new q({className:"horizontal",grid:"4 8",fields:[P,aa,S],buttons:[{name:"chooseFiles",value:ah?s.getNLSValue("DocumentMgmtUI.ChooseFiles"):s.getNLSValue("DocumentMgmtUI.ChooseFile"),action:function V(){ab._selectFile(ak.getContent(),ah,function(){ai.getButtonInput("chooseFiles").disable();ai.getButtonInput("resetSelection").enable();Q=this.files;Z(Q)})}},{name:"resetSelection",disabled:true,value:s.getNLSValue("DocumentMgmtUI.ResetSelection"),action:function V(){ai.getButtonInput("resetSelection").disable();ai.getButtonInput("chooseFiles").enable();Q=null;ab._fileCommenstForm.destroy()}}]});if(e.is(ae)){U=ai.getListInput("DocPolicy");U.select(R);U.setDisabled(true)}new B({className:"ok primary",value:e.is(aj)?s.getNLSValue("DocumentMgmtUI.Update"):s.getNLSValue("DocumentMgmtUI.Attach"),events:{onClick:function(){var am,ap=[],ao,an;if(ai.validate()){if(e.is(Q)){ao=ab._fileCommenstForm.getValues();am={title:ai.getValue("DocumentTitle"),description:ai.getValue("DocDescription"),policy:ai.getValue("DocPolicy")};for(an=0;an<Q.length;an++){ap.push({file:Q[an],comments:ao[Q[an].name]})}if(e.is(ad)){ab._modifyFile.call(ag,af,ap)}else{if(e.is(aj)){ab._updateDocument.call(ag,af,ap)}else{ab._uploadDocument(O,am,ap)}}ak.destroy()}else{H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.FilesRequired")})}}else{H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DocTitleRequired")})}}}}).inject(X);new B({className:"cancel",value:s.getNLSValue("DocumentMgmtUI.Cancel"),events:{onClick:function(){ak.destroy()}}}).inject(X);ak=T._updateDocumentDlg(ai,X);ak.inject(widget.body);ak.getContent().focus()},attachDocument:function m(O){this._createUploadFileDlg(this,O)},manageDocuments:function E(R){var Y=this,S,W,U,T,P,Q,O,V=[];this.irpcID=R;H.getDocumentID(R,{onComplete:function X(Z){if(Z.length>0){Y._createDocumentDlg(s.getNLSValue("DocumentMgmtUI.ManageDocs"));Y.documentDlg.inject(widget.body);Q=H.collectionUtils.documentsConnection.where({irpcID:R});O=H.collectionUtils.documentsConnection.without(Q);H.getDocumentInfo(Z,{onComplete:function(aa){for(U=0;U<aa.data.length;U++){V.push(H.collectionUtils.documents.add(aa.data[U],{merge:true}));P=aa.data[U].id;T=R+"|"+P;O=O.concat(H.collectionUtils.documentsConnection.where({ID:T}))}H.collectionUtils.documentsConnection.set(O,{merge:true});Y.documentsDisplayComp=new y({context:Y,documents:V,callbacks:{Download:Y._downloadDocument,Update:Y._createUploadFileDlg,Delete:Y._deleteDocument,ViewFile:Y._viewFile,DownloadFile:Y._downloadFile,ModifyFile:Y._createUploadFileDlg,RemoveFile:Y._removeFile,Explore:Y._exploreDocument}});W=e.createElement("div");new B({className:"ok btn btn-default",value:s.getNLSValue("DocumentMgmtUI.OK"),events:{onClick:function(){S.destroy()}}}).inject(W);S=Y._updateDocumentDlg(Y.documentsDisplayComp,W);S.getContent().focus()}})}}})},_getDocID:function t(P){var O;if(e.is(P.getParent().options.grid.documentID)){O=P.getParent().options.grid.documentID}else{O=P.options.grid.documentID}return O},_getFileID:function k(P){var O;if(e.is(P.getParent().options.grid.documentID)){O=P.options.grid.documentID}return O},_downloadDocument:function z(T){var S={},P=this.context,R=P._getDocID(T),O=H.collectionUtils.documents.where({id:R})[0],Q,V=s.getNLSValue("DocumentMgmtUI.DownloadDocLogMessage",{title:O.get("dataelements").title});L.publish({event:"DELMGAMFN/webService/Start"});S={onComplete:function U(Z){var W,Y;for(W=0;W<Z.length;W++){Q=a.getNextIndex();a.logStarted(Q,V);Y=e.createElement("iframe");Y.style.display="none";Y.src=Z[W].downloadUrl+"&attachment=true";widget.body.grab(Y);H._uiUtils.AlertManager.add({className:"success",message:s.getNLSValue("DocumentMgmtUI.DownloadDocSucceeded",{document:O.get("dataelements").title})});a.logCompleted(Q,V);setTimeout(function X(){Y.parentNode.removeChild(Y)},200)}L.publish({event:"DELMGAMFN/webService/End"})},onFailure:function(W){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DownloadDocFailed",{document:O.get("dataelements").title,message:e.Json.encode(W)})});a.logFailed(Q,V);L.publish({event:"DELMGAMFN/webService/End"})},onTimeout:function(W){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DownloadDocFailed",{document:O.get("dataelements").title,message:e.Json.encode(W)})});a.logFailed(Q,V);L.publish({event:"DELMGAMFN/webService/End"})}};H.downloadDocuments([R],S)},_exploreDocument:function d(Q){var O=this.context,P=O._getDocID(Q),R=C.get3DSpaceUrl()+"common/emxNavigator.jsp?appName=ENOBUPS_AP&objectId="+P;window.open(R)},_updateDocument:function K(R,Z){var V,P,U,ab=this.context,T=this,W=ab._getDocID(R),aa=H.collectionUtils.documents.where({id:W})[0],X,S=s.getNLSValue("DocumentMgmtUI.UpdateDocLogMessage",{title:aa.get("dataelements").title});L.publish({event:"DELMGAMFN/webService/Start"});if(e.is(Z)){P={id:W};for(V=0;V<Z.length;V++){X=a.getNextIndex();a.logStarted(X,S);U=Z[V];H.attachFile(P,U,{onComplete:function Q(ad){var ac=ad.data[0].relateddata.files[0];T.updateDocNode(R,ad.data[0]);aa.addFile(ac);H._uiUtils.AlertManager.add({className:"success",message:s.getNLSValue("DocumentMgmtUI.UpdateDocSucceeded",{file:ac.dataelements.title,document:aa.get("dataelements").title})});a.logCompleted(X,S);L.publish({event:"DELMGAMFN/webService/End"})},onFailure:function O(ac){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.UpdateDocFailed",{document:aa.get("dataelements").title,message:e.Json.encode(ac)})});a.logFailed(X,S);L.publish({event:"DELMGAMFN/webService/End"})},onTimeout:function Y(ac){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.UpdateDocFailed",{document:aa.get("dataelements").title,message:e.Json.encode(ac)})});a.logFailed(X,S);L.publish({event:"DELMGAMFN/webService/End"})}})}}},_deleteDocument:function F(Q){var Z=this.context,T=this,U=Z._getDocID(Q),R=Z.irpcID,Y=H.collectionUtils.documents.where({id:U}),X=Y[0].get("dataelements").title,S=s.getNLSValue("DocumentMgmtUI.PurgeDocLogMessage",{title:X}),V=a.getNextIndex();L.publish({event:"DELMGAMFN/webService/Start"});a.logStarted(V,S);H.deleteLink(R,U,{onComplete:function P(){T.removeDocNode(Q);w.removeDocumentConnectionFromCollection(R+"|"+U);H._uiUtils.AlertManager.add({className:"success",message:s.getNLSValue("DocumentMgmtUI.DeleteDocLinkSucceeded",{document:X})});a.logCompleted(V,S);if(!w.isConnectionsExistsForDoc(U)){w.removeDocumentFromCollection(U)}L.publish({event:"DELMGAMFN/webService/End"})},onFailure:function O(aa){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DeleteDocLinkFailed",{document:X,message:e.Json.encode(aa)})});a.logFailed(V,S);L.publish({event:"DELMGAMFN/webService/End"})},onTimeout:function W(aa){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DeleteDocLinkFailed",{document:X,message:e.Json.encode(aa)})});a.logFailed(V,S);L.publish({event:"DELMGAMFN/webService/End"})}})},_viewFile:function A(Q){var W={},X=this.context,S=X._getDocID(Q),T=X._getFileID(Q),U,R=s.getNLSValue("DocumentMgmtUI.ViewFile",{title:Q.options.label});L.publish({event:"DELMGAMFN/webService/Start"});W={onComplete:function P(Y){U=a.getNextIndex();a.logStarted(U,R);window.open(Y,"ViewFile","fullscreen=no");a.logCompleted(U,R);L.publish({event:"DELMGAMFN/webService/End"})},onFailure:function O(){a.logFailed(U,R);L.publish({event:"DELMGAMFN/webService/End"})},onTimeout:function V(){a.logFailed(U,R);L.publish({event:"DELMGAMFN/webService/End"})}};H.downloadFiles(S,T,W)},_downloadFile:function g(P){var V={},W=this.context,S=W._getDocID(P),T=W._getFileID(P),Q=P.options.label,U,R=s.getNLSValue("DocumentMgmtUI.DownloadFile",{title:Q});L.publish({event:"DELMGAMFN/webService/Start"});V={onComplete:function O(X){var Z;U=a.getNextIndex();a.logStarted(U,R);Z=e.createElement("iframe");Z.style.display="none";Z.src=X+"&attachment=true";widget.body.grab(Z);setTimeout(function Y(){Z.parentNode.removeChild(Z)},200);H._uiUtils.AlertManager.add({className:"success",message:s.getNLSValue("DocumentMgmtUI.DownloadFileSucceeded",{file:Q})});L.publish({event:"DELMGAMFN/webService/End"});a.logCompleted(U,R)},onFailure:function(X){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DownloadFileFailed",{file:Q,message:e.Json.encode(X)})});L.publish({event:"DELMGAMFN/webService/End"});a.logFailed(U,R)},onTimeout:function(X){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DownloadFileFailed",{file:Q,message:e.Json.encode(X)})});L.publish({event:"DELMGAMFN/webService/End"});a.logFailed(U,R)}};H.downloadFiles(S,T,V)},_modifyFile:function l(R,aa){var P,V=aa[0],ac=this.context,U=this,X=ac._getDocID(R),ab=H.collectionUtils.documents.where({id:X})[0],S=R.options.label,W=ac._getFileID(R),Y=a.getNextIndex(),T=s.getNLSValue("DocumentMgmtUI.ModifyFile",{title:S});L.publish({event:"DELMGAMFN/webService/Start"});a.logStarted(Y,T);P={id:X};V.id=W;H.modifyFile(P,V,{onComplete:function Q(ad){ab.modifyFile(W,ad.data[0].relateddata.files[0]);U.updateFileNode(R,ad.data[0].relateddata.files[0]);H._uiUtils.AlertManager.add({className:"success",message:s.getNLSValue("DocumentMgmtUI.ModifyFileSucceeded",{file:S})});a.logCompleted(Y,T);L.publish({event:"DELMGAMFN/webService/End"})},onFailure:function O(ad){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.ModifyFileFailed",{file:S,message:e.Json.encode(ad)})});L.publish({event:"DELMGAMFN/webService/End"});a.logFailed(Y,T)},onTimeout:function Z(ad){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.ModifyFileFailed",{file:S,message:e.Json.encode(ad)})});L.publish({event:"DELMGAMFN/webService/End"});a.logFailed(Y,T)}})},_removeFile:function r(Q){var Z=this.context,T=this,U=Z._getDocID(Q),Y=H.collectionUtils.documents.where({id:U})[0],V=Z._getFileID(Q),R=Q.options.label,W=a.getNextIndex(),S=s.getNLSValue("DocumentMgmtUI.DeleteFile",{title:Q.options.label});L.publish({event:"DELMGAMFN/webService/Start"});a.logStarted(W,S);H.removeFile(U,V,{onComplete:function P(){T.removeFileNode(Q);Y.removeFile(V);H._uiUtils.AlertManager.add({className:"success",message:s.getNLSValue("DocumentMgmtUI.DeleteFileSucceeded",{file:R})});L.publish({event:"DELMGAMFN/webService/End"});a.logCompleted(W,S)},onFailure:function O(aa){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DeleteFileFailed",{file:R,message:e.Json.encode(aa)})});L.publish({event:"DELMGAMFN/webService/End"});a.logFailed(W,S)},onTimeout:function X(aa){H._uiUtils.AlertManager.add({className:"error",message:s.getNLSValue("DocumentMgmtUI.DeleteFileFailed",{file:R,message:e.Json.encode(aa)})});L.publish({event:"DELMGAMFN/webService/End"});a.logFailed(W,S)}})}});var x=b.singleton({name:"DocumentMgmtUI",init:function G(O){this._parent(O)},attachDocument:function m(O){if(x._validate("AttachDocument")){x._docMngDialog.attachDocument(O)}},manageDocuments:function J(O){if(x._validate("ManageDocuments")){x._docMngDialog.manageDocuments(O)}},_validate:function D(P){var O=true;if(e.is(x._docMngDialog)&&e.is(x._docMngDialog.documentDlg)&&x._docMngDialog.documentDlg.isVisible===true){if(x._currentAction===P&&P!=="AttachDocument"){O=false}else{x._docMngDialog.documentDlg.destroy();x._docMngDialog.documentDlg=null}}else{x._docMngDialog=new i();x._currentAction=P}return O}});return x});define("DS/DELWebMfgAssetsDefUIControls/UIControlFactory",["UWA/Drivers/Alone","UWA/Core","UWA/Class","DS/Core/Core","DS/DELWebMfgAssetsDefUIControls/UIControlFactoryCustomization"],function(b,f,a,d,c){var e=a.singleton({init:function(){},_transformClassName:function(k,j){var i,g,h="";if(!UWA.is(k)||!UWA.is(j)){return k}k=k.split(" ");for(i=0;i<k.length;i++){g=k[i];g=UWA.is(j[g])?j[g]:g;h=h+g+" "}return h.trim()},_transformOptions:function(g,h){var i,j,k={};if(UWA.is(h)){if(UWA.is(h.className)){h.className=e._transformClassName(h.className,g.classMaping)}if(UWA.is(g.typeMapping)&&UWA.is(g.typeMapping[h.type])){h.type=g.typeMapping[h.type]}if(UWA.is(g.attributeMaping)){for(i in h){j=g.attributeMaping[i];if(UWA.is(j)){k[j]=h[i]}else{k[i]=h[i]}}}else{k=h}return k}return h},transformOptions:function(g){return e._transformOptions(this.controlInfo,g)},_CreateObject:function(i,o){var k,g,n={},j,l,m;k=c.getElementJSON(i);if(!UWA.is(k)){return}g=require(k.module);if(!UWA.is(g)){return}if(UWA.is(k.preProcessing)){o=k.preProcessing(o)}n=this._transformOptions(k,o);l=new g(n);if(UWA.is(k.functions)){for(m in k.functions){if(m==="init"){continue}if(UWA.is(l[m])){alert("Developer Configuration Error - Overriding method "+m)}else{j=k.functions[m];l[m]=j}}}if(UWA.is(k.postProcessing)){k.postProcessing(l,n)}l.controlInfo=k;l.getTransformedOption=this.transformOptions;if(UWA.is(o.events)){if(UWA.is(k.events)){for(m in o.events){if(UWA.is(k.events[m])){var h=k.events[m];h(l,o.events[m])}}}}return l},createButton:function(g){return this._CreateObject("Button",g)},createButtonGroup:function(g){return this._CreateObject("ButtonGroup",g)},createSelect:function(g){return this._CreateObject("Select",g)},createText:function(g){return this._CreateObject("Text",g)},createForm:function(g){return this._CreateObject("Form",g)},createModal:function(g){return this._CreateObject("Modal",g)}});return e});define("DS/DELWebMfgAssetsDefUIControls/EditTVColumnsUI",["UWA/Core","UWA/Controls/Abstract","UWA/Controls/Drag","UWA/Controls/TabView","DS/Controls/Toggle","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/Controls/Button","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefUIServices/TableViewPreferences","DS/DELWebMfgAssetsDefUIServices/UIPreferences","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIControls/Preferences","DS/UIKIT/Input/Button","DS/Tree/TreeListView","DS/Tree/TreeNodeModel","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil"],function(h,s,a,r,e,v,j,n,x,p,z,y,b,l,i,m,c,o){var A=s.extend({_tableViewColumns:null,_leftViewColumns:null,_rightViewColumns:null,_widgetLayoutValues:{},widgetPrefValues:null,btnLV:null,btnLGV:null,btnRV:null,btnRGV:null,btnTV:null,btnGV:null,trigram:null,init:function t(){this._buildSkelton()},setParentDialog:function C(D){this._dialog=D},_buildSkelton:function q(){this._outerDiv=h.createElement("div",{"class":"MGA-DELWebMfgAssetsDefUIControls-EditTVColumnsUI-outerDiv"});this._createTab();this.elements=this.elements||{};this.elements.container=this._tabView},_createTab:function g(){var E=this,D;E.widgetPrefValues=p.getWidgetLayoutValues();E.trigram=c.getWidgetTrigram();if(E.widgetPrefValues){E._widgetLayoutValues.Columns=JSON.parse(JSON.stringify(E.widgetPrefValues))}else{if(E.trigram==="MFN"){E._widgetLayoutValues.Columns={AV:false,LV:true,LGV:false,RV:true,RGV:false}}if(E.trigram==="MGA"){E._widgetLayoutValues.Columns={AV:false,LV:true,RV:true,TV:true,GV:false}}}D=[new h.Controls.TabView.Tab({id:"bottom-block",icon:x.getIconFromKey("BottomBlock").elements.image.src,text:x.getNLSValue("EditUI.BottomBlock.text")}),new h.Controls.TabView.Tab({id:"left-block",icon:x.getIconFromKey("LeftBlock").elements.image.src,text:x.getNLSValue("EditUI.LeftBlock.text")}),new h.Controls.TabView.Tab({id:"right-block",icon:x.getIconFromKey("RightBlock").elements.image.src,text:x.getNLSValue("EditUI.RightBlock.text")}),new h.Controls.TabView.Tab({id:"widget-layout-block",icon:x.getIconFromKey("WidgetLayoutBlock").elements.image.src,text:x.getNLSValue("EditUI.WidgetLayoutBlock.text")})];if(o.useRootStorage()){D.push(new h.Controls.TabView.Tab({id:"store-view-block",icon:x.getIconFromKey("EditTVColumns").elements.image.src,text:x.getNLSValue("EditUI.StoreRootsBlock.text")}))}this._tabView=new r({className:"all-view-container text-center",tabs:D,events:{onSelectTab:function(G,L,F){var N=E._outerDiv.children,K,I,H,J,M;if(h.is(F)){K=L.getId();if(K==="bottom-block"){I=E._tableViewColumns;if(!h.is(I)){I=h.clone(p.getTableViewColumns())}E._tableViewColumns=E.getColumnOrder(I)}else{if(K==="left-block"){I=E._leftViewColumns;if(!h.is(I)){I=h.clone(p.getLeftViewColumns())}E._leftViewColumns=E.getColumnOrder(I)}else{if(K==="right-block"){I=E._rightViewColumns;if(!h.is(I)){I=h.clone(p.getRightViewColumns())}E._rightViewColumns=E.getColumnOrder(I)}else{if(K==="widget-layout-block"){I=E._widgetLayoutValues;E._widgetLayoutValues=E.getWidgetLayout(I)}}}}}if(N.length>0){J=E.preferencesGrid.getManager();if(J.getScroller()){J.scrollToRow(0,"top")}J.getDocument()._getTrueRoot().removeChildren()}switch(G.options.id){case"bottom-block":H=E._tableViewColumns&&E._tableViewColumns.Columns;if(!h.is(H)){H=p.getTableViewColumns()}G.setContent(E._fillView(H));break;case"left-block":H=E._leftViewColumns&&E._leftViewColumns.Columns;if(!h.is(H)){H=p.getLeftViewColumns()}G.setContent(E._fillView(H));break;case"right-block":H=E._rightViewColumns&&E._rightViewColumns.Columns;if(!h.is(H)){H=p.getRightViewColumns()}G.setContent(E._fillView(H));break;case"widget-layout-block":H=E._widgetLayoutValues.Columns;if(E.trigram==="MFN"){G.setContent(E._fillLayoutMFN(H))}else{if(E.trigram==="MGA"){G.setContent(E._fillLayoutMGA(H))}}break;case"store-view-block":if(E.trigram==="MFN"){M=["MBOM","BODY","AUX"]}else{if(E.trigram==="MGA"){M=["TABLE","AUX"]}}G.setContent(E._fillRootsView(M));break;default:break}}}})},getWidgetLayout:function d(){var D=false;if(this.widgetPrefValues!==this._widgetLayoutValues.Columns){D=true}return{isChanged:D,Columns:this._widgetLayoutValues.Columns}},getColumnOrder:function k(G,E){var H=0,J=false,D,L=[],F,K,I={};J=G.hasOwnProperty("isChanged")?G.isChanged:J;G=G.hasOwnProperty("Columns")?G.Columns:G;if(!h.is(E)){E=this.preferencesGrid.getManager()}for(H=0;H<G.length;++H){K=G[H].dataIndex;I[K]=G[H]}for(H=0;H<E.getNumberOfRows();H++){D=E.getRowModel(H);K=D.dataIndex;F=I[K];if(D.dataIndex!==G[H].dataIndex){J=true}if(h.typeOf(D.colVisibility)==="string"){D.colVisibility=h.Json.decode(D.colVisibility)}if(D.colVisibility.display!==I[K].display){F.display=D.colVisibility.display;J=true}if(D.width!==I[K].width){F.width=D.width;J=true}if(D.minWidth!==I[K].minWidth){F.minWidth=D.minWidth;J=true}L.push(F)}return{isChanged:J,Columns:L}},_fillLayoutMFN:function f(F){var J=this,K=function K(){var L=this.options.id;this.toggleActive();if(L==="LGV"){if(J._widgetLayoutValues.Columns.LGV){this.getOption("parent").className="div1 border-unselected"}else{if(J._widgetLayoutValues.Columns.LV){J.btnLV.toggleActive();this.getOption("parent").className="div1 border-selected"}else{this.getOption("parent").className="div1 border-selected"}}J._widgetLayoutValues.Columns.LV=J.btnLV.isActive();J._widgetLayoutValues.Columns.LGV=J.btnLGV.isActive()}else{if(L==="LV"){if(J._widgetLayoutValues.Columns.LV){this.getOption("parent").className="div1 border-unselected"}else{if(J._widgetLayoutValues.Columns.LGV){J.btnLGV.toggleActive();this.getOption("parent").className="div1 border-selected"}else{this.getOption("parent").className="div1 border-selected"}}J._widgetLayoutValues.Columns.LV=J.btnLV.isActive();J._widgetLayoutValues.Columns.LGV=J.btnLGV.isActive()}else{if(L==="RGV"){if(J._widgetLayoutValues.Columns.RGV){this.getOption("parent").className="div2 border-unselected"}else{if(J._widgetLayoutValues.Columns.RV){J.btnRV.toggleActive();this.getOption("parent").className="div2 border-selected"}else{this.getOption("parent").className="div2 border-selected"}}J._widgetLayoutValues.Columns.RV=J.btnRV.isActive();J._widgetLayoutValues.Columns.RGV=J.btnRGV.isActive()}else{if(L==="RV"){if(J._widgetLayoutValues.Columns.RV){this.getOption("parent").className="div2 border-unselected"}else{if(J._widgetLayoutValues.Columns.RGV){J.btnRGV.toggleActive();this.getOption("parent").className="div2 border-selected"}else{this.getOption("parent").className="div2 border-selected"}}J._widgetLayoutValues.Columns.RV=J.btnRV.isActive();J._widgetLayoutValues.Columns.RGV=J.btnRGV.isActive()}else{if(L==="AV"&&this.isActive()){this.getOption("parent").className="div0 border-selected";J._widgetLayoutValues.Columns.AV=true}else{if(L==="AV"&&!this.isActive()){this.getOption("parent").className="div0 border-unselected";J._widgetLayoutValues.Columns.AV=false}}}}}}},E=function E(L){return h.createElement("div",L)},D=E(),I=E({id:"div0","class":(F.AV)?"div0 border-selected":"div0 border-unselected"}).inject(D),H=E({id:"div1","class":(F.LV||F.LGV)?"div1 border-selected":"div1 border-unselected"}).inject(D),G=E({id:"div2","class":"div2 border-selected"}).inject(D);D.addClassName("widget-layout-block-MFN");new l({id:"AV",className:F.AV?"default active":"default",parent:I,value:"Auxillary View",events:{onClick:K}}).inject(I);this.btnLV=new l({id:"LV",className:F.LV?"default active":"default",parent:H,value:"Left View",events:{onClick:K}}).inject(H);this.btnLGV=new l({id:"LGV",className:F.LGV?"default active":"default",parent:H,value:"Left Graph View",events:{onClick:K}}).inject(H);this.btnRV=new l({id:"RV",className:F.RV?"default active":"default",parent:G,value:"Right View",events:{onClick:K}}).inject(G);this.btnRGV=new l({id:"RGV",className:F.RGV?"default active":"default",parent:G,value:"Right Graph View",events:{onClick:K}}).inject(G);this._outerDiv.setContent(D);return this._outerDiv},_fillLayoutMGA:function u(E){var M=this,S,O=function O(){this.toggleActive();S=this.options.id;if(this.isActive()){this.getOption("parent").className="border-selected";M._widgetLayoutValues.Columns[S]=true;if(S==="GV"&&M.btnTV.isActive()){M.btnTV.toggleActive();M._widgetLayoutValues.Columns.TV=false}if(S==="TV"&&M.btnGV.isActive()){M.btnGV.toggleActive();M._widgetLayoutValues.Columns.GV=false}}else{this.getOption("parent").className="border-unselected";M._widgetLayoutValues.Columns[S]=false}},F=function F(V,U){return h.createElement(V,U)},L=F("div"),D=F("table",{id:"table1","class":"border-unselected"}).inject(L),K=F("table",{id:"table2"}).inject(L),T=F("table",{id:"table3","class":"border-unselected"}).inject(L),N=F("td",{rowspan:"3"}).inject(D),R=F("tr").inject(K),J=F("td",{"class":"border-unselected"}).inject(R),I=F("td",{"class":"border-unselected"}).inject(R),Q=F("tr").inject(T),H=F("td",{colspan:"2"}).inject(Q),P=F("tr").inject(T),G=F("td",{colspan:"2"}).inject(P);L.addClassName("widget-layout-block");new l({id:"AV",className:E.AV?"default active":"default",parent:D,value:"Auxillary View",events:{onClick:O}}).inject(N),new l({id:"LV",className:E.LV?"default active":"default",parent:J,value:"Left View",events:{onClick:O}}).inject(J),new l({id:"RV",className:E.RV?"default active":"default",parent:I,value:"Right View",events:{onClick:O}}).inject(I);this.btnTV=new l({id:"TV",className:E.TV?"default active":"default",parent:T,value:"Table View",events:{onClick:O}}).inject(H);this.btnGV=new l({id:"GV",className:E.GV?"default active":"default",parent:T,value:"Graph View",events:{onClick:O}}).inject(G);if(E.AV){D.className="border-selected"}if(E.LV){J.className="border-selected"}if(E.RV){I.className="border-selected"}if(E.TV||E.GV){T.className="border-selected"}this._outerDiv.setContent(L);return this._outerDiv},_fillRootsView:function w(E){var J=this,S=function S(V){return h.createElement("div",V)},Q,P,K,M,I,O=function O(){var V=Q.value;if(V!==""){b.createRootsStore(V);J._fillRootsView(E)}},T=function T(){var W=P.value,V=b.getRootsPrefName(),X,Y=y.getWidget();if(W!==""){E.forEach(function(aa){var Z;X=h.Json.decode(widget.getValue(V));if(X[W].hasOwnProperty(aa)&&X[W][aa].length>0){switch(aa){case"MBOM":Z=Y.getMBOMView();break;case"BODY":Z=Y.getBodyView();break;case"TABLE":Z=Y._bottomBloc;break;case"AUX":Z=Y._auxiliaryView;break;default:break}Z._loadStoredRoots(X[W][aa])}});J._dialog.destroy();J._dialog=null}},N=function N(){var V=b.getRootsPrefName(),X=h.Json.decode(widget.getValue(V)),W=[];Object.keys(X).forEach(function(Y){if(Y!=="Default"){W.push({labelItem:Y,valueItem:Y})}});return W},G=N(),U=function U(){var W=P.value,V=b.getRootsPrefName(),X=h.Json.decode(widget.getValue(V));if(X.hasOwnProperty(W)){M.show();I.show()}else{M.hide();I.hide()}},R=function R(){var V=Q._myInput.value;if(V!==""){K.show()}else{K.hide()}},H=function H(){var W=P.value,V=b.getRootsPrefName(),X;if(W!==""){X=h.Json.decode(widget.getValue(V));delete X[W]}},L=S({"class":"widget-layout-block"}),F,D;F=S({"class":"store-view-div"});Q=new v({placeholder:x.getNLSValue("Store_name.Title")}).inject(F);Q.getContent().addClassName("store-view-control");Q.addEventListener("uncommittedChange",R);K=new n({label:x.getNLSValue("Save_views.Title"),onClick:O}).inject(F);K.getContent().addClassName("store-view-btn");K.hide();F.inject(L);if(G.length>0){D=S({"class":"store-view-div"});P=new j({elementsList:G,placeholder:x.getNLSValue("Store_select.Placeholder"),currentValue:"Default",enableSearchFlag:true,reachablePlaceholderFlag:true}).inject(D);P.getContent().addClassName("store-view-control");P.addEventListener("change",U);M=new n({label:x.getNLSValue("Load_store.Title"),onClick:T}).inject(D);M.getContent().addClassName("store-view-btn");I=new n({label:x.getNLSValue("Remove_store.Title"),onClick:H}).inject(D);I.getContent().addClassName("store-view-btn");M.hide();I.hide();D.inject(L)}this._outerDiv.setContent(L);return this._outerDiv},_fillView:function B(H){var G,E,F,J;if(!this.preferencesGrid){F={columns:[{dataIndex:"dataIndex",width:0,isHidden:true},{text:x.getNLSValue("Header_Name.Title"),dataIndex:"colName",width:"auto",isColumnMovable:false},{text:x.getNLSValue("Is_Visible.Title"),dataIndex:"colVisibility",width:"20%",isColumnMovable:false},{text:x.getNLSValue("Column_Width.Title"),dataIndex:"width",width:"20%",isColumnMovable:false},{text:x.getNLSValue("Column_MinWidth.Title"),dataIndex:"minWidth",width:"20%",isColumnMovable:false}]};F.showVerticalLines=true;F.isSortable=false;F.isDraggable=true;F.isEditable=true;F.apiVersion=2;F.defaultCellHeight=40;F.selection={cells:false,canMultiSelect:false,columnHeaders:false};F.resize={columns:true,rows:true};F.isEditable={switchToWriteView:{event:"dbclick",callback:function(){return}},switchToReadView:{callback:function I(){this.switchToReadView()},view:function D(O){var N,M,L,K;switch(O.dataIndex){case"colName":O.cellView.getContent().setStyles({textAlign:"center"});return O.cellModel.getCellContent();case"colVisibility":N=new e({type:"switch",label:""});N.elements.container.addClassName("view-preferences-toggle");N.addEventListener("buttonclick",function(Q){var P=Q.dsModel.value;if(h.typeOf(P)==="string"){P=h.Json.decode(P)}P.display=Q.dsModel._properties.checkFlag.value;O.nodeModel.updateOptions({grid:{colVisibility:{display:P.display}}})});M=O.cellModel.getCellContent();if(h.typeOf(M)==="string"){M=h.Json.decode(M)}if(M.display===true){N.checkFlag=true}if(M.mandatory==="true"){N.disabled=true}N.value=M;return N;case"width":L=new v({value:O.cellModel.getCellContent()});L.addEventListener("change",function(P){P.stopPropagation();O.cellModel.setCellContent(P.dsModel.value)});L.elements.container.addClassName("view-preferences-linecontrol");return L;case"minWidth":K=new v({value:O.cellModel.getCellContent()});K.addEventListener("change",function(P){P.stopPropagation();O.cellModel.setCellContent(P.dsModel.value)});K.elements.container.addClassName("view-preferences-linecontrol");return K;default:return O.cellModel.getCellContent()}}}};F.onDropCellDefault=function(Q,L){var P,O,K,N,M,R;Q.preventDefault();P=this.unserializeDragAndDropEvent(Q);if(P){O=P.data["dswebux/x-tree.treenodemodel+number"];K=P.data["dswebux/x-tree.treenodemodel+json"];if(L.nodeModel._getID()===O){return}if(K){K.forEach(function(S){N=new m(S);if(L.cellView){M=L.nodeModel;R=L.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:M,draggedTreeNodeModel:N,dropPosition:L.dropPosition});if(R){L.manager.getDocument().prepareUpdate();L.manager.getDocument().getXSO().get().forEach(function(T){T.remove()});L.manager.getDocument().pushUpdate();if(L.virtualRowID!==-1){switch(L.dropPosition){case"top":M.getParent().insertBefore(N,M);break;default:case"middle":M.getParent().addChild(N,L.virtualRowID);break;case"bottom":M.getParent().addChild(N,M.getParent().getChildren().indexOf(M)+1);break}return false}return true}return false}})}}};this.preferencesGrid=new i(F);this.preferencesGrid.getManager().onColumnHeaderRequest(function(K){if(K.isHeader){if(K.dataIndex==="tree"){K.cellModel.options.value=""}K.cellView.getContent().setText(K.cellView.getCellInfos().cellModel.options.value);K.cellView.getContent().setStyles({textAlign:"center"})}});this.preferencesGrid.getManager().setColumnWidth("tree","5%");this.preferencesGrid.getManager().onCellRequest(function(K){if(K.dataIndex==="tree"){K.cellView.getContent().setText(K.nodeModel.options.label);K.cellView.getContent().setStyles({textAlign:"center",paddingLeft:"0px"})}})}for(G=0;G<H.length;G++){E={colVisibility:{display:h.is(H[G].display)?H[G].display:true,mandatory:h.is(H[G].mandatory)?H[G].mandatory:false},dataIndex:H[G].dataIndex,width:h.is(H[G].width)?H[G].width:"auto",minWidth:h.is(H[G].minWidth)?H[G].minWidth:"100",colName:y.getColumnDisplayValue(H[G])};J=new m({label:G.toString(),grid:E});this.preferencesGrid.addRoot(J)}this._outerDiv.setContent(this.preferencesGrid);return this._outerDiv}});return A});define("DS/DELWebMfgAssetsDefUIControls/ReconnectOrRevReconnectScopeDialogUI",["UWA/Core","UWA/Class","UWA/Class/Options","DS/Controls/Button","DS/Windows/Dialog","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIControls/ReconnectOrRevReconnectScopeDialogWebService"],function(g,a,j,m,o,h,b,c,e){var d=a.singleton({name:"ReconnectOrRevReconnectScopeDialogUI",showReconnectScopeDialog:function f(p,u,t){var r=this,q,s;this.mbomXSO=u;q=this.mbomXSO.get();if(g.is(this.dialog)&&this.dialog.activeFlag){s=this.dialog.commands;if(p===s){return}else{if(p===s){return}}}this.token=this.mbomXSO.onPostAdd(function(v){v=Array.isArray(v)?v[0]:v;if(!v.isScoped()){c.AlertManager.add({className:"error",message:h.getNLSValue("Error.NoProductScopeLink.Title")});return}r._updateReconnectScopeDialog(p,v)});this.buildDialogSkeleton(p,t);if(0===q.length){c.AlertManager.add({className:"info",message:h.getNLSValue("Info.SelectManufactured.Title"),})}else{q=Array.isArray(q)?q[0]:q;this._updateReconnectScopeDialog(p,q)}},buildDialogSkeleton:function k(s,x){var r=this,v,t,w,q=330,u=350,p;v=function v(){var y=r.treeListManager.getActiveNode().getReferencePID();e.reconnectScopeWS(s,y,r.mfgPID,function(A,z){x(A,z,y)});this.dsModel.dialog.destroy()};t=function t(){this.destroy();r.mbomXSO.unsubscribe(r.token)};w=this._prepareDialogContent();if(s==="ReconnectScope"){p=h.getNLSValue("Cmd.ReconnectScopeLink.Title")}else{if(s==="ReviseAndReconnectScope"){p=h.getNLSValue("Cmd.ReviseAndReconnectScopeLink.Title")}}this.dialog=new o({title:p,immersiveFrame:c.getMGAElement("FrameWindow").getImmersiveFrame(),width:q,height:u,content:w,commands:s,buttons:{Ok:new m({emphasize:"primary",disabled:true,onClick:v}),Cancel:new m({onClick:function(){this.dsModel.dialog.close()}})}});this.dialog.commands=s;this.dialog.close=t;this._buildTreeListView()},_prepareDialogContent:function i(){var p=new g.Element("div",{"class":"reconnectScope-dialog-container"});this.mfgItemDiv=c.createTitleSectionInDialog("Dialog.SelectedMfgItem.Title",p);this.mfgItemDiv.setHTML(h.getNLSValue("Info.SelectManufactured.Title"));this.productItemDiv=c.createTitleSectionInDialog("Dialog.ReconnectScopeProduct.Title",p,true);return p},_buildTreeListView:function n(){var p={};p={treelistviewOptions:{className:"",showVerticalLines:true,isSortable:false,enableDragAndDrop:false,defaultCellHeight:30,selection:{cells:false,canMultiSelect:false,}},preferences:{Columns:{Column:[{dataIndex:"V_Name.reference",dicoType:"PLMEntity",displayType:"NonEditable"},{dataIndex:"revision.reference",dicoType:"BusinessType",displayType:"NonEditable",width:"60"}]},}};this.treeListView=c.createTreelistview(p);this.treeListView.options.columns.forEach(function(q){if(q.dataIndex==="tree"){q.label=q.dataIndex}});this.treeListManager=this.treeListView.getManager();this.treeListManager.hideColumn("selection");this.treeListManager.hideColumn("tree");this.treeListManager.onCellRequest(function(v){var u,r=v.nodeModel.getReferenceType(),t=v.cellView.getContent(),s=v.dataIndex,q=v.nodeModel.options.grid[s];if(s==="V_Name.reference"){u=h.getIconURLFromKey(r);t.innerHTML='<img class="update-dialog-revision-icon" src="'+u+'" />'+q}else{t.setContent(q)}});this.treeListView.getContent().inject(this.productItemDiv)},_updateReconnectScopeDialog:function l(r,s){var q=this,t,u,p;if(!s.isScoped()){c.AlertManager.add({className:"error",message:h.getNLSValue("Error.NoProductScopeLink.Title")});return}t=s.getScopes();t=t[0];this.scopedPrdPID=t.to;this.mfgPID=s.getReferencePID();u={pid:this.scopedPrdPID};p=function(){b.webServiceRequest({url:"modeler/ppr/getMajorRevisions",method:"POST",data:g.Json.encode(u),onComplete:function w(x){var G=false,y="V_Name.reference",z="revision.reference",F,B={},C,A={},E,D;for(C=0;C<x.length;C++){F=x[C];D=F.PID;if(!G&&q.scopedPrdPID===D){G=true;continue}if(G){A={};A[y]=F.V_Name;A[z]=F.revision;B={grid:A,referencePID:D,referenceType:F.type};E=new q.treeListView.utils._TreeNodeModel(B);q.treeListView.utils._treeDocument.addRoot(E)}}if(g.is(E)){q.mbomXSO.unsubscribe(q.token);c.addSelectedNode(q.mfgItemDiv,s)}else{c.AlertManager.add({className:"error",message:h.getNLSValue("Error.NoHigherRevisionExists.Title")});return}q.xso=q.treeListView.getDocument().getXSO();q.xso.onChange(function(){q.dialog.buttons.Ok.disabled=q.xso.isEmpty()});c.AlertManager.add({className:"info",message:h.getNLSValue("Info.SelectProductRevision.Title")})},onFailure:function v(z,y,x){console.log("jsonData: "+z+" error:"+y+" options: "+x);c.AlertManager.add({className:"error",message:h.getNLSValue("Error.GetMajorRevisionFailure.Title")})}})};e.validateMfg(r,this.mfgPID,p)},});return d});define("DS/DELWebMfgAssetsDefUIControls/UpdateMfgItemDialogUI",["UWA/Core","UWA/Class","UWA/Class/Options","DS/Controls/Button","DS/Controls/ComboBox","DS/Windows/Dialog","DS/DELWebMfgAssetsDefUIControls/WUXForm","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefUIServices/UIUtils","DS/DELWebMfgAssetsDefUIControls/CreateOrUpdateMfgItemDialogWebService","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil"],function(d,o,n,k,g,f,e,j,q,c,m,r,i,l){var h=o.singleton({name:"UpdateMfgItemDialog",showMBOMUpdateDilaog:function p(z,y){var s=this,t,v,w;t=z.get();t=Array.isArray(t)?t[0]:t;if(!t.isScoped()){r.AlertManager.add({className:"error",message:q.getNLSValue("Error.NoProductScopeExists.Title")});return}v=t.getScopes();v=v[0];this.scopedPrdPID=v.to;this.mfgPID=t.getReferencePID();w={pid:this.scopedPrdPID};c.webServiceRequest({url:"modeler/ppr/getMajorRevisions",method:"POST",data:d.Json.encode(w),onComplete:function x(A){var J=false,B="V_Name.reference",C="revision.reference",K=30,I,L={},E={},F,D={},H,G;L={treelistviewOptions:{className:"",showVerticalLines:true,isSortable:false,enableDragAndDrop:false,defaultCellHeight:K,selection:{cells:false,canMultiSelect:false,}},preferences:{Columns:{Column:[{dataIndex:B,dicoType:"PLMEntity",displayType:"NonEditable"},{dataIndex:C,dicoType:"BusinessType",displayType:"NonEditable",width:"60"}]},}};s.treeListView=r.createTreelistview(L);s.treeListView.options.columns.forEach(function(M){if(M.dataIndex==="tree"){M.label=M.dataIndex}});s.treeListManager=s.treeListView.getManager();s.treeListManager.hideColumn("selection");s.treeListManager.hideColumn("tree");s.treeListManager.onCellRequest(function(R){var Q,N=R.nodeModel.getReferenceType(),P=R.cellView.getContent(),O=R.dataIndex,M=R.nodeModel.options.grid[O];if(O==="V_Name.reference"){Q=q.getIconURLFromKey(N);P.innerHTML='<img class="update-dialog-revision-icon" src="'+Q+'" />'+M}else{P.setContent(M)}});s.xso=s.treeListView.getDocument().getXSO();s.xso.onChange(function(){s.dialog.buttons.Ok.disabled=s.xso.isEmpty()});for(F=0;F<A.length;F++){I=A[F];G=I.PID;if(!J&&s.scopedPrdPID===G){J=true}if(J){D={};D[B]=I.V_Name;D[C]=I.revision;E={grid:D,referencePID:G,referenceType:I.type};H=new s.treeListView.utils._TreeNodeModel(E);s.treeListView.utils._treeDocument.addRoot(H)}}s.buildDialogSkeleton(t,y);s.treeListView.getContent().inject(s.productItemDiv);r.AlertManager.add({className:"info",message:q.getNLSValue("Info.SelectProductRevision.Title")})},onFailure:function u(C,B,A){console.log("jsonData: "+C+" error:"+B+" options: "+A)}})},buildDialogSkeleton:function b(s,w){var u=this,t,v;t=function t(){var x=u.optionsForm.getValues(),y=u.treeListManager.getActiveNode().getReferencePID();x.backgroundJobFlag=false;i.webServiceCall("UpdateMfgItem",y,u.mfgPID,x,function(A,z){w(A,z,y)});this.dsModel.dialog.close()};v=this.prepareDialogContent(s);this.dialog=new f({title:q.getNLSValue("Dialog.UpdateMfgItem.Title"),immersiveFrame:r.getMGAElement("FrameWindow").getImmersiveFrame(),width:330,height:450,content:v,modalFlag:true,resizableFlag:true,buttons:{Ok:new k({emphasize:"primary",disabled:true,onClick:t}),Cancel:new k({onClick:function(){this.dsModel.dialog.close()}})}})},prepareDialogContent:function a(u){var w,v,t,s=new d.Element("div",{"class":"update-dialog-container"});w=r.createTitleSectionInDialog("Dialog.SelectedMfgItem.Title",s);r.addSelectedNode(w,u);this.productItemDiv=r.createTitleSectionInDialog("Dialog.AvailabeProduct.Title",s,true);this.optionsForm=new e();v={};v[q.getNLSValue("MfgItemDialog.Options")]=[{fieldType:"combobox",name:"scopeCreation",title:q.getNLSValue("MfgItemDialog.CreateScopeForChildren"),domId:"scopeSelectionCombo",enableSearchFlag:false,elementsList:[{labelItem:q.getNLSValue("MfgItemDialog.ScopeCreation.AllScope"),valueItem:"AllLevel"},]},{fieldType:"lineeditor",name:"prefix",title:q.getNLSValue("MfgItemDialog.PrefixForMfgItems"),domId:"prefixLineEditor",placeholder:q.getNLSValue("MfgItemDialog.PrefixForMfgItemsPlaceHolder")}];if(l.isUpdateUIUpdateIntermediateScopedAssemblies()){t={fieldType:"toggle",name:"updateIntermediateScopedAssemblies",title:q.getNLSValue("MfgItemDialog.UpdateIntermediateScopedAssemblies"),domId:"updateIntermediateScopedAssembliesEditor",checkFlag:false,className:"field-container-toogle"};v[q.getNLSValue("MfgItemDialog.Options")].push(t)}this.optionsForm.createUI({renderTo:s,sections:v});return s}});return h});
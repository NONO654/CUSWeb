(function(W){var ab=W.Polymer,af=W.DS;var d=null,h=null,ae=null,w=null,Q=null,D=null,u=null,S=null,H=null,q=null,U=null,V=null,G=null,v=null,Z=null,aa=null,x=null,i=null,y=null,Y=null,t=null,L=null,E=null,T=null,N=null,n=null,k=null,c=null,f=null,b=null,A=null,R=null,p=null,ag=null,J=null,M=null,e=null,g=null,a=null,ad=null,K=null,C=null,o=null,ac=null,j=null,F={uploading:"uploading",in3dx:"in3dx",onDisk:"onDisk",bothInSync:"bothInSync",bothOutOfSync:"bothOutOfSync"},I={folder:"folder",vDocument:"Simulation Document - Versioned",nvDocument:"Simulation Document - NonVersioned",simulation:"DesignSight",simulationProjection:"3dxprojection",file:"file",fileversion:"fileversion",part:"PLMCoreReference,PLMCoreRepReference,VPMReference,Physical Product"},X={folder:"folder",file:"file"},s=["ODB","SIM","STT","MDL","SMAFOCUS","SMABULK","023","CID","FIL","ABQ","SEL","RES","PAC","CAE","WAV","3DXML","TIFF","TIF","GIF","JPEG","JPG","PNG","PDF"],l=["SIM","ODB"],B={cloud:"Cloud",fiper:"fiper"},P={designSight:"DesignSight"},z={click:"click",dblclick:"dblclick",dragstart:"dragstart"},r=["id","maininput","versions","diskId","outputVerId","docType"],m=[P.designSight,I.core_reference,I.rep_reference,I.vpm_reference,I.physical_product],O={TAILFILEERROR:"SMAPoweredByViews.ad-job-content-container.TAILFILEERROR",PREVIEWFOLDERMSG:"SMAPoweredByViews.ad-job-content-container.PREVIEWFOLDERMSG",FILENOTSELECTED:"SMAPoweredByViews.ad-job-content-container.FILENOTSELECTED"};ac=function(aj){var ai=aj.currentTarget.parentNode.parentNode.itemData,ah;if(ai.status===F.onDisk){if(ai.type===X.folder){this._inputItemDropDownMenu.disableItem(1);this._inputItemDropDownMenu.disableItem(2)}else{ah=this._JobSelectors.jobDRMMode(this.store.getState(),this.jobId);(ah&&ah===B.cloud)?this._inputItemDropDownMenu.disableItem(1):this._inputItemDropDownMenu.enableItem(1);this._inputItemDropDownMenu.enableItem(2)}this._inputItemDropDownMenu.disableItem(3)}else{if(ai.status!==F.bothOutOfSync||ai.status===F.uploading){this._inputItemDropDownMenu.disableItem(1)}else{this._inputItemDropDownMenu.enableItem(1)}if(ai.type===I.simulationProjection){this._inputItemDropDownMenu.disableItem(2);this._inputItemDropDownMenu.disableItem(3)}else{this._inputItemDropDownMenu.enableItem(2);this._inputItemDropDownMenu.enableItem(3)}}if(s.indexOf(this._ADDataFormatUtils.getFileExtension(ai.title))!==-1||ai.type===I.simulationProjection||ai.type===I.folder){this._inputItemDropDownMenu.disableItem(0)}else{this._inputItemDropDownMenu.enableItem(0)}if(l.indexOf(this._ADDataFormatUtils.getFileExtension(ai.title))!==-1&&(ai.status===F.in3dx||ai.status===F.bothInSync)){this._inputItemDropDownMenu.enableItem(4)}else{this._inputItemDropDownMenu.disableItem(4)}if(ai.type===I.simulation){this._inputItemDropDownMenu.disableItem(2);this._inputItemDropDownMenu.disableItem(3);if(this.isTransientWidget){this._inputItemDropDownMenu.disableItem(0)}}if(ai.type===I.simulationProjection||ai.status===F.uploading){this._inputItemDropDownMenu.enableItem(5)}else{this._inputItemDropDownMenu.disableItem(5)}};h=function(ah){ah.stopPropagation();ah.cancelBubble=true;if(this._selectedInputs&&this._selectedInputs.length===0){this._additionalActionsDDMenu.disableItem(0)}else{this._additionalActionsDDMenu.enableItem(0)}};d=function(ai){var ah=ai.currentTarget.parentElement.parentElement;ai.stopPropagation();ai.cancelBubble=true;this._currentSelection=ai.currentTarget.value;this._currentSelectedNode=ai.currentTarget;if(!ah.classList.contains("tr-active")){x.call(this,ah)}ai.currentTarget.getOffsets=function(){var aj=ai.currentTarget.getBoundingClientRect();return{x:aj.left+W.pageXOffset,y:aj.top+W.pageYOffset}};this._inputItemDropDownMenu.options.target=ai.currentTarget;ac.call(this,ai);this._inputItemDropDownMenu.updatePosition();this._inputItemDropDownMenu.show()};k=function(aj,ah){var ai=this.content.filter(function(ak){if(ah===F.bothOutOfSync){return ak.diskId===aj}else{if(ah===F.bothInSync){return ak.id===aj||ak.outputVerId===aj}else{return ak.id===aj}}})[0];if(ai.type===I.simulation){if(!this.isTransientWidget){this.fire("previewresult",{content:aj,displayName:ai.title,compassObject:this._DataUtils.format3DPlayData({id:aj,title:ai.title})})}}else{this.fire("viewfile",{file:aj,status:ah})}};i=function(ah){if(ah.status===F.bothInSync){return ah.outputVerId?ah.outputVerId:ah.id}else{if(ah.status===F.bothOutOfSync){return ah.diskId}else{return ah.id}}};t=function(ai){ai.stopPropagation();ai.cancelBubble=true;var ah=ai.currentTarget,aj=i.call(this,ah.itemData);if(s.indexOf(this._ADDataFormatUtils.getFileExtension(ah.itemData.title))===-1&&ah.itemData.type!==I.folder){k.call(this,aj,ah.itemData.status)}else{if(ah.itemData.type===I.folder){this.fire("addtailalert",{code:O.PREVIEWFOLDERMSG})}else{this.fire("addtailalert",{code:O.TAILFILEERROR})}}};Y=function(){var ah=this._currentSelectedNode.parentNode.parentNode,ai=i.call(this,ah.itemData);k.call(this,ai,ah.itemData.status)};L=function(ai){var ah=[];ah.push(this._currentSelectedNode.parentNode.parentNode.id);this.fire("downloadcontent",{inputs:ah,zip:ai})};T=function(){var ah=[];ah.push({inputID:this._currentSelectedNode.parentNode.parentNode.id,title:this._currentSelectedNode.parentNode.parentNode.itemData.title,status:this._currentSelectedNode.parentNode.parentNode.itemData.status});this.fire("generateresult",{inputs:ah})};N=function(){this.fire("monitorjob",{compassObject:this._DataUtils.format3DPlayData({id:this._currentSelectedNode.parentNode.parentNode.id})})};n=function(){var ah=[],aj=this._currentSelectedNode.parentNode.parentNode,ai=document.createElement("span");ai.className+=" status content-status content-status-uploading";ai.textContent=this._NLS.get("Saving");new this._toolTip({body:this._NLS.get("Saving"),target:ai,position:"bottom"});aj.getElementsByClassName("status")[0].textContent="";aj.getElementsByClassName("status")[0].appendChild(ai);ah.push(aj.itemData.status===F.bothOutOfSync?aj.itemData.diskId:aj.itemData.id);this.fire("uploadcontent",{inputs:ah})};E=function(){var ai=this.$.tableContainer.querySelectorAll("input:checked");var ah=[];for(var aj=0;aj<ai.length;aj++){ah.push(ai[aj].getAttribute("objectid"))}if(ah.length===0){this.fire("addalert",{code:O.FILENOTSELECTED,category:"filedownload",level:this._AlertSelectors.Level.WARNING});return}if(ah.length===1){this.fire("downloadcontent",{inputs:ah,zip:true})}else{this.fire("downloaddocuments",{inputs:ah})}};c=function(ah){this.selectedBatchIteration=ah.detail;if(this.selectedBatchIteration!==-1){this._ADMonitorUtils.startExecDirMonitor(this.jobId,this.selectedBatchIteration)}g.call(this)};f=function(ah,ai){this._inputItemDropDownMenu=new ah({items:[{text:ai.Open,fonticon:"eye",handler:Y.bind(this)},{text:ai.Upload,fonticon:"upload",handler:n.bind(this)},{text:ai.Download,fonticon:"download",handler:L.bind(this,false)},{text:ai.DownloadZip,fonticon:"archive",handler:L.bind(this,true)},{text:ai.Generate,fonticon:"import",handler:T.bind(this)},{text:ai.Monitor,fonticon:"computer-connected",handler:N.bind(this)}]})};A=function(){if(this._inputItemDropDownMenu){this._inputItemDropDownMenu.hide()}};b=function(ah){ah.stopPropagation();ah.cancelBubble=true;A.call(this)};ag=function(ah){switch(ah){case"title":case"modified":case"purpose":return"text";case"size":case"status":return"custom";default:return"text"}};ae=function(ai,ah,al,aj){var ak;aj.stopPropagation();aj.cancelBubble=true;R.call(this);ak=ag(aj.currentTarget.className);this._ADDataFormatUtils.sortTable.call(this,ai,ah,al,aj.currentTarget,ak)};J=function(ah){return ah.key==="type"||ah.key==="actions"};p=function(){return[{name:"",key:"selected"},{name:this._NLS.Type,key:"type"},{name:this._NLS.Name,key:"title"},{name:this._NLS.Modified,key:"modified"},{name:this._NLS.Filetype,key:"filetype"},{name:this._NLS.Size,key:"size"},{name:this._NLS.Version,key:"version"},{name:this._NLS.Status,key:"status"},{name:this._NLS.Mode,key:"purpose"},{name:"",key:"actions"}]};M=function(){var aj=p.call(this);for(var ai=0;ai<aj.length;ai++){var al=document.createElement("th");al.className=aj[ai].key;al.textContent=aj[ai].name;var ak=document.createElement("span");ak.className="sort-indicator fonticon fonticon-open-down hidden";var ah=document.createElement("span");ah.className="sort-indicator fonticon fonticon-open-up hidden";al.appendChild(ak);al.appendChild(ah);this.$.tableHeaderRow.appendChild(al);if(!J(aj[ai])){al.addEventListener(z.click,ae.bind(this,true,aj[ai].key,this.$.tableBody))}}};j=function(){this._selectedInputs=[];var ah=this;this.isReady=new Promise(function(ai){require(["DS/UIKIT/DropdownMenu","DS/UIKIT/Spinner","DS/UIKIT/Tooltip","DS/UIKIT/Input/Toggle","DS/UIKIT/Mask","UWA/Core","DS/SMAPoweredByViews/Utils/ADDataFormatUtils","DS/SMAPoweredByState/ad-state-app-alerts/selectors","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","WebappsUtils/WebappsUtils","i18n!DS/SMAPoweredByViews/assets/nls/ADJobContent","DS/SMAPoweredByViews/Utils/ADDataFormatUtils","DS/SMAPoweredByViews/Utils/ADMonitorUtils","DS/SMAPoweredByViews/ad-batch-iteration-chooser/ad-batch-iteration-chooser"],function(aj,am,aq,at,an,ao,av,aw,ap,al,au,ak,ar){f.call(ah,aj,au);ah._toolTip=aq;ah._toggle=at;ah._UWA=ao;ah._ADDataFormatUtils=av;ah._AlertSelectors=aw;ah._JobSelectors=ap;ah._WebappsUtils=al;ah._DataUtils=ak;ah._Mask=an;ah._Spinner=am;ah._NLS=au;ah._ADMonitorUtils=ar;document.addEventListener(z.click,b.bind(ah));M.call(this);ai()}.bind(ah))})};R=function(){var ah=document.querySelectorAll(".sort-indicator");[].forEach.call(ah,function(ai){this.DOM(ai).addClass("hidden")}.bind(this))};G=function(ah){switch(ah){case I.folder:return"images/Folder32.png";case I.vDocument:return"images/File32.png";case I.document:return"images/NonVersionnedDocument32.png";case I.simulation:case I.simulationProjection:return"images/Simulation32.png";case I.file:return"images/File32.png";case I.fileversion:return"images/File32.png";case I.part:return"images/Part32.png";default:return"images/File32.png"}};v=function(ah){switch(ah){case I.file:case I.fileversion:return"File";case I.simulation:return"Simulation";case I.part:return"Part";case I.folder:return"Folder";case I.rdocument:return"Document";default:return null}};u=function(ah,al,aj){var ai,ak;ah===F.bothOutOfSync?ak="content-status-3dx-outofsync":ak="content-status-3dx";ai=document.createElement("span");ai.className+=" "+aj+" content-status "+ak+" fonticon fonticon-check";new this._toolTip({body:this._NLS[ah],target:ai,position:"bottom"});al.appendChild(ai);ai=document.createElement("span");ai.className+=" "+aj+" content-status fonticon fonticon-drive";new this._toolTip({body:this._NLS[ah],target:ai,position:"bottom"});al.appendChild(ai)};H=function(aj,ai){var ak=document.createElement("td"),ah;ak.className="id td-centered";aj.appendChild(ak);ah=new this._toggle({type:"checkbox",label:"",className:"primary inputs-toggle inputs-checkbox"}).inject(ak);ah.elements.input.setAttribute("objectId",aj.id);if((m.indexOf(ai.type)!==-1||ai.status!==F.in3dx)&&ai.status!==F.bothInSync){ah.disable()}};S=function(am,ak,aj){var an,ai,ah=document.createElement("img"),al;this.DOM(ah).addClass("icon-image");an=document.createElement("td");an.className+=" "+aj+" td-centered";am.appendChild(an);if(aj==="status"){if(ak[aj]===F.uploading){ai=document.createElement("span");ai.className+=aj+" content-status content-status-uploading";ai.textContent=this._NLS.get("Saving");new this._toolTip({body:this._NLS.get("Saving"),target:ai,position:"bottom"});an.appendChild(ai)}else{if(ak[aj]===F.in3dx){ai=document.createElement("span");ai.className+=aj+" content-status content-status-3dx fonticon fonticon-check";new this._toolTip({body:this._NLS.in3DX,target:ai,position:"bottom"});an.actualValue=2;an.appendChild(ai)}else{if(ak[aj]===F.onDisk){ai=document.createElement("span");ai.className+=aj+" content-status fonticon fonticon fonticon-drive";new this._toolTip({body:this._NLS.onDisk,target:ai,position:"bottom"});an.actualValue=3;an.appendChild(ai)}else{if(ak[aj]===F.bothInSync){u.call(this,F.bothInSync,an,aj);an.actualValue=1}else{if(ak[aj]===F.bothOutOfSync){u.call(this,F.bothOutOfSync,an,aj);an.actualValue=4}}}}}}else{if(aj==="size"){an.textContent=isNaN(ak[aj])?ak[aj]:this._ADDataFormatUtils.formatFileSize(ak[aj]);an.actualValue=isNaN(ak[aj])?0:ak[aj]}else{if(aj==="type"){ah.src=this._WebappsUtils.getWebappsAssetUrl("SMAPoweredByViews",G(ak.type));ai=document.createElement("span");ai.appendChild(ah);new this._toolTip({body:v(ak.type),target:ai,position:"bottom"});an.appendChild(ai)}else{if(aj==="version"){ai=document.createElement("span");an.textContent=ak[aj];if(ak[aj]&&ak[aj].indexOf("/")!==-1){al=this._NLS.InputVersion+ak[aj].split("/")[0]+"/"+this._NLS.OutputVersion+ak[aj].split("/")[1];new this._toolTip({body:al,target:ai,position:"bottom"})}an.appendChild(ai)}else{an.textContent=ak[aj]}}}}};q=function(aj,ai,ah){var ak=document.createElement("td");ak.textContent=ai[ah][0].version;aj.appendChild(ak)};U=function(aj,ai){var ak=document.createElement("td"),ah=document.createElement("span");ak.className="td-centered";aj.appendChild(ak);ah.setAttribute("id","actionId_"+ai.id);ah.className="action-item fonticon fonticon-open-down";ah.setAttribute("value",ai.title);ak.appendChild(ah);ah.addEventListener(z.click,d.bind(this))};y=function(ai,ah){ai.addEventListener(z.dragstart,function(aj){aj.stopPropagation();aj.cancelBubble=true;var ak=null;if(ah.type===I.simulation){ak=this._ADDataFormatUtils.format3DPlayData(aj.currentTarget.itemData)}else{if(ah.type===I.fileversion||ah.type===I.file){ak=this._ADDataFormatUtils.format3DPlayData({id:ah.outputVerId?ah.outputVerId:ah.id,title:ah.title},ah.docType)}}aj.dataTransfer.setData("text",JSON.stringify(ak))}.bind(this),false)};V=function(){var ah=document.querySelectorAll(".tooltip");[].forEach.call(ah,function(ai){ai.destroy()})};a=function(aj){var ah=false;for(var ai=0;ai<this.$.tableBody.children.length;ai++){if(aj.title===this.$.tableBody.children[ai].itemData.title){ah=true;break}}return ah};ad=function(ai,ah){var aj=function(al){var ak=null;Object.keys(al).forEach(function(am){ak+=al[am]});return ak};return aj(ai)===aj(ah)};Z=function(ah){[].forEach.call(this.$.tableBody.children,function(ai){if(ai.itemData.id!==ah.id){this.DOM(ai).removeClass("tr-active")}}.bind(this))};x=function(ah){if(!ah.classList.contains("tr-active")){this.DOM(ah).addClass("tr-active");Z.call(this,ah);if(ah.itemData.type===I.simulation){this._ADDataFormatUtils.setCompassContext(ah.id)}else{this._ADDataFormatUtils.setCompassContext(null)}}else{this.DOM(ah).removeClass("tr-active");this._ADDataFormatUtils.setCompassContext(null)}};aa=function(ai){var ah=ai.currentTarget;x.call(this,ah)};C=function(aj,ai){var ah={};aj.textContent="";ah={id:ai.id,status:ai.status,title:ai.title,type:ai.type};if(ai.diskId){ah.diskId=ai.diskId}if(ai.outputVerId){ah.outputVerId=ai.outputVerId}aj.itemData=ah;aj.id=ai.id;Object.keys(ai).forEach(function(ak){if(ak==="id"){H.call(this,aj,ai,ak)}if(r.indexOf(ak)===-1){S.call(this,aj,ai,ak)}else{if(ak==="version"){q.call(this,aj,ai,ak)}}}.bind(this));U.call(this,aj,ai)};K=function(ai){var ah={};var aj=document.createElement("tr");aj.className="input-row";aj.setAttribute("id",ai.id);this.$.tableBody.appendChild(aj);ah={id:ai.id,diskId:ai.diskId,status:ai.status,title:ai.title,type:ai.type};aj.itemData=ah;aj.addEventListener("dblclick",t.bind(this));if(ai.status!==F.onDisk){aj.draggable=true;y.call(this,aj,ai)}aj.addEventListener(z.click,aa.bind(this));C.call(this,aj,ai)};o=function(aj){var ai=[];ai=aj.map(function(ak){return ak.title});for(var ah=(this.$.tableBody.children.length-1);ah>=0;ah--){if(ai.indexOf(this.$.tableBody.children[ah].itemData.title)===-1){this.$.tableBody.deleteRow(ah)}}};e=function(){var ah=this._JobSelectors.jobInputs(this.store.getState(),this.jobId,this.selectedBatchIteration),ai=this._JobSelectors.jobOutputs(this.store.getState(),this.jobId,this.selectedBatchIteration),ak=this._JobSelectors.jobWorkDataObjects(this.store.getState(),this.jobId,this.selectedBatchIteration);var aj=this.content.filter(function(an){var am=false,al;for(al=0;al<ah.length;al++){if(ah[al]===an.id){am=true;break}}if(!am){for(al=0;al<ai.length;al++){if(ai[al]===an.id){am=true;break}}}if(!am){for(al=0;al<ak.length;al++){if(ak[al].id===an.id){am=true;break}}}return am});return aj};g=function(){var ak=[],aj=this.$.tableBody.children;V.call(this);if(this.content&&this.content.length>0){this.DOM(this.$.errorMessageContent).addClass("hidden");this.DOM(this.$.loadingContent).addClass("hidden");this.DOM(this.$.contentContainer).removeClass("hidden");ak=(this.selectedBatchIteration>=0)?e.call(this):this.content;o.call(this,ak);for(var ai=0;ai<ak.length;ai++){if(a.call(this,ak[ai])){for(var ah=0;ah<aj.length;ah++){if(aj[ah].itemData.title===ak[ai].title){if(!ad.call(this,aj[ah].itemData,ak[ai])){C.call(this,aj[ah],ak[ai])}}}}else{K.call(this,ak[ai])}}this.fire("uipainted",{})}else{this.DOM(this.$.contentContainer).addClass("hidden");if(this.loading&&(!this.loading.contentLoading&&!this.loading.workDirLoading)){this.DOM(this.$.errorMessageContent).removeClass("hidden")}}};w=function(){if(this.isReady){this.isReady.then(function(){g.call(this);this.fire("workdatachanged",{})}.bind(this))}};Q=function(){if(this.loading.contentLoading&&this.content&&this.content.length===0){this.DOM(this.$.errorMessageContent).addClass("hidden");this.DOM(this.$.workDirLoading).addClass("hidden");this.DOM(this.$.lastRefreshed).addClass("hidden");this.DOM(this.$.loadingContent).removeClass("hidden");return}else{this.DOM(this.$.loadingContent).addClass("hidden");if(this.content&&this.content.length===0){this.DOM(this.$.errorMessageContent).removeClass("hidden")}}if(this.loading.workDirLoading.status){if(this.content&&this.content.length>0){this.DOM(this.$.workDirLoading).addClass("workdir-loading-message")}this.DOM(this.$.workDirLoading).removeClass("hidden");this.DOM(this.$.lastRefreshed).addClass("hidden");this.DOM(this.$.loadingContent).addClass("hidden");this.DOM(this.$.errorMessageContent).addClass("hidden")}else{this.DOM(this.$.workDirLoading).addClass("hidden");if(this.loading.workDirLoading.lastrefreshed){this.DOM(this.$.lastRefreshed).removeClass("hidden");this.lastRefreshed=this._ADDataFormatUtils.formatTimestamp(this.loading.workDirLoading.lastrefreshed)}}};D=function(){if(this._JobSelectors.isBatchJob(this.store.getState(),this.jobId)){this.$.batchIterationList.iterations=this._JobSelectors.batchJobIterations(this.store.getState(),this.jobId);this.DOM(this.$.batchIterationRow).removeClass("hidden")}else{this.DOM(this.$.batchIterationRow).addClass("hidden")}};W.DS.SMAPoweredByViews=W.DS.SMAPoweredByViews||{};W.DS.SMAPoweredByViews.ADJobContent=ab({is:"ad-job-content",properties:{store:{type:Object},nlspath:{type:String,value:"DS/SMAPoweredByViews/assets/nls/ADJobContent"},content:{type:Array,value:function(){return[]}},isReady:{type:Promise},sortVal:{type:Object},jobId:{type:String,observer:"jobIdChanged"},selectedBatchIteration:{type:Number,value:-1},isTransientWidget:{type:Boolean,value:false},loading:{type:Object,observer:"loadingChanged"},lastRefreshed:{type:String}},observers:["contentChanged(content.splices)"],contentChanged:function(){return w.apply(this)},ready:function(){return j.apply(this,arguments)},onActionsMenuClick:function(){return d.apply(this,arguments)},sort:function(){return ae.apply(this,arguments)},downloadMutipleFiles:function(ah){return E.apply(this,ah)},onMenuClick:function(){return h.apply(this,arguments)},loadingChanged:function(){this.isReady.then(function(){Q.call(this)}.bind(this))},jobIdChanged:function(){this.isReady.then(function(){D.call(this)}.bind(this))},onBatchIterationSelect:function(ah){return c.call(this,ah)},behaviors:[af.SMAProcSP.SPBase]})}(this));
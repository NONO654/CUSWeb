(function(){var B,t,c,f,l,F,k,J,L,s,d,u,j,m,r,v,z,e,w,D,y,E,i,q={INVALID_DROP_3DX:"SMAPoweredByViews.ad-app-container.INVALID_DROP_3DX",INVALID_DROP_LOCAL:"SMAPoweredByViews.ad-app-container.INVALID_DROP_LOCAL",STUDY_CLOSED:"SMAPoweredByViews.ad-app-container.STUDY_CLOSED"},C=function(){return new Promise(function(N){require(["DS/SMAPoweredByState/ad-state-store","DS/SMAPoweredByState/ad-state-app/actions","DS/SMAPoweredByState/ad-state-app/selectors","DS/SMAPoweredByState/ad-state-app-alerts/actions","DS/SMAPoweredByState/ad-state-domain-connector-definitions/actions","DS/SMAPoweredByState/ad-state-cos/actions","DS/SMAPoweredByState/ad-state-cos/selectors","DS/SMAPoweredByState/ad-state-domain-job-types/actions","DS/SMAPoweredByState/ad-state-domain-jobs/actions","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAPoweredByState/ad-state-domain/actions","DS/SMAPoweredByState/ad-state-domain-study/selectors","DS/SMAPoweredByState/ad-state-domain-study-templates/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/selectors","DS/SMAPoweredByViews/Utils/ADMonitorUtils","DS/SMAPoweredByViews/Utils/ADFileUtils","DS/SMAPoweredByViews/Utils/ADRefreshUtils","DS/SMAPoweredByViews/Utils/ADStudyUtils","DS/SMAPoweredByViews/Skeleton/ADSkeletonElement","DS/SMAPoweredByViews/ad-drop-zone/ADDropZone","DS/SMAProcSP/sp-platform-api/sp-platform-api","DS/TransientWidget/TransientWidget","i18n!DS/SMAPoweredByViews/assets/nls/ADAppContainer","DS/SMAPoweredByViews/ad-landing/ad-landing","css!DS/SMAPoweredByViews/Skeleton/ADSkeletonWidget"],function(P,Z,af,ac,X,O,Y,ah,aj,ak,R,V,U,ae,aa,Q,ab,ag,ai,W,T,ad,S){B=P;t=Z;c=af;f=ac;l=X;F=O;k=Y;L=aj;s=ak;J=ah;d=R;u=V;j=U;m=ae;r=aa;v=Q;z=ab;e=ag;w=ai;D=W;y=T;E=ad;i=S;N()})})},M=function(){this.store=B.getStore()},I=function(){return y.addEventList("DS/SMAPoweredByViews/assets/eventList.json")},G=function(){this.boundActionsApp=this.getBoundActions(t);this.boundActionsAppAlerts=this.getBoundActions(f);this.boundActionsCos=this.getBoundActions(F);this.boundActionsJobTypes=this.getBoundActions(J);this.boundActionsJob=this.getBoundActions(L);this.boundActionsDomain=this.getBoundActions(d);this.boundActionsStudyTemplates=this.getBoundActions(j);this.boundActionsConnectorDef=this.getBoundActions(l)},b=function(){this.boundActionsApp.refreshApp();return this.waitFor({select:c.isAppInitialized,isResolved:function(N){return N}}).then(function(){return this.waitFor({select:c.appPersistenceOperation,isResolved:function(N){return(!N)}})}.bind(this))},A=function(){var O=c.platforms(this.store.getState()),Q=c.whereUsedTenants(this.store.getState()),N,P;if(window.widget&&window.widget.addPreference&&window.widget.setValue){if(O){P=O.map(function(R){return{value:R.id,label:R.displayName}});N={name:"x3dPlatformId",type:"hidden",label:i.WhereAccessedTenantLabel,options:P,defaultValue:c.currentPlatformID(this.store.getState())};window.widget.addPreference(N)}if(Q){P=Q.map(function(R){return{value:R.id,label:R.displayName}});N={name:"whereUsedTenantId",type:(P.length>1)?"list":"hidden",label:i.WhereUsedTenantLabel,options:P,defaultValue:c.currentWhereUsedTenantID(this.store.getState())};window.widget.addPreference(N)}}},n=function(){var N=this.store,O=this.boundActionsCos;O.refreshServers();this.waitFor({select:k.serversPersistenceOperation,isResolved:function(Q){var P=(Q===null),R=(k.allServers(N.getState()).length>0);return P&&R}}).then(function(){var P=k.allServers(N.getState());P.forEach(function(Q){O.refreshStations(Q)})})},o=function(){this.boundActionsStudyTemplates.refreshStudyTemplates();this.boundActionsJobTypes.refreshJobTypes();this.boundActionsConnectorDef.refreshConnectorDefinitions();n.apply(this)},h=function(){this.$.createJob.store=this.store;this.$.landingPage.store=this.store;this.$.alerts.store=this.store;this.$.appHeader.store=this.store;this.$.observers.store=this.store;this.$.deletePrompt.store=this.store;window.addEventListener("beforeunload",function(){if(!r.shouldPreventStopMonitoringOnce){r.stopAllMonitors()}else{r.shouldPreventStopMonitoringOnce=false}})},H=function(){if(!this._skeletonRendered){var P=document.body,O=document.documentElement,N;N=Math.max(P.scrollHeight,P.offsetHeight,O.clientHeight,O.scrollHeight,O.offsetHeight);w.onLoad();w.renderSkeleton(this.$.skeletonHolder,N-81);this._skeletonRendered=true}else{w.refresh()}this.$.skeletonContainer.classList.remove("hidden");this.$.landingPage.classList.add("hidden")},g=function(){this.$.landingPage.classList.remove("hidden");this.$.skeletonContainer.classList.add("hidden")},a=function(N){if(N){H.apply(this)}else{g.apply(this)}},K=function(){e.observeStudy(this,a.bind(this),this.store);y.addListener("refresh",function(O){var N=u.studyObject(this.store.getState());if(N&&O&&O.data&&O.data.authored&&O.data.authored.deleted&&O.data.authored.deleted[0]===N.id){this.boundActionsAppAlerts.addAlert("Close","info",null,q.STUDY_CLOSED);e.closeStudy(this.store)}}.bind(this))};function p(O){var N=u.studyObject(this.store.getState());if(["Simulation","Simulation Process"].indexOf(O.objectType)!==-1){e.closeStudy(this.store);this.boundActionsDomain.openStudy(O.objectId)}else{if((O.objectType==="Simulation Job")&&O.simulationId){e.closeStudy(this.store);this.boundActionsDomain.openStudy(O.simulationId)}else{if(N&&N.id){v.addReferencedContent(B.getStore(),O);w.switchCollection(DS.SMAPoweredByViews.ADAppHeader.CollectionIndex.FILES);this.$.appHeader.switchCollection(DS.SMAPoweredByViews.ADAppHeader.CollectionIndex.FILES)}else{this.boundActionsAppAlerts.addAlert("Drop","error",null,q.INVALID_DROP_3DX)}}}}function x(O){var N=u.studyObject(this.store.getState());if(N&&N.id){v.uploadFiles(B.getStore(),O);w.switchCollection(DS.SMAPoweredByViews.ADAppHeader.CollectionIndex.FILES);this.$.appHeader.switchCollection(DS.SMAPoweredByViews.ADAppHeader.CollectionIndex.FILES)}else{this.boundActionsAppAlerts.addAlert("Drop","error",null,q.INVALID_DROP_LOCAL)}}DS.SMAPoweredByViews=DS.SMAPoweredByViews||{};DS.SMAPoweredByViews.ADAppContainer=window.Polymer({is:"ad-app-container",properties:{},ready:function(){this.isReady=Promise.resolve().then(C.bind(this)).then(M.bind(this)).then(I.bind(this)).then(this.initReduxBehavior.bind(this)).then(G.bind(this)).then(b.bind(this)).then(A.bind(this)).then(K.bind(this)).then(h.bind(this)).then(o.bind(this))},_studyChanged:function(){return a.apply(this,arguments)},switchCollection:function(N){w.switchCollection(N.detail.switchto)},onCreateJob:function(N){N.stopPropagation();N.cancelBubble=true;this.$.createJob.startCreateJob()},onCloneJob:function(N){N.stopPropagation();N.cancelBubble=true;this.$.createJob.startCloneJob(N.detail.jobId)},onGenerateResult:function(N){N.stopPropagation();N.cancelBubble=true;this.$.createJob.startGenerateResult(N.detail.jobId,N.detail.input)},onAbortJob:function(N){N.stopPropagation();N.cancelBubble=true;var O=s.jobWorkDirectory(this.store.getState(),N.detail.jobId);if(O){r.stopExecDirMonitor(O.id);r.stopAllTailMonitors()}this.boundActionsJob.abortJob(N.detail.jobId)},onDeleteJob:function(N){N.stopPropagation();N.cancelBubble=true;var O=s.jobWithID(this.store.getState(),N.detail.jobId);this.$.deletePrompt.type=DS.SMAPoweredByViews.ADDeletePrompt.TYPES.JOBS;this.$.deletePrompt.studyId=u.studyObject(this.store.getState()).id;this.$.deletePrompt.items=[O];this.$.deletePrompt.showDialog()},onDeleteFile:function(O){O.stopPropagation();O.cancelBubble=true;var N=m.managedDataWithID(this.store.getState(),O.detail.fileId);this.$.deletePrompt.type=DS.SMAPoweredByViews.ADDeletePrompt.TYPES.FILES;this.$.deletePrompt.isRemove=false;this.$.deletePrompt.items=[N];this.$.deletePrompt.showDialog()},onDeleteSO:function(N){N.stopPropagation();N.cancelBubble=true;var O=m.managedDataWithID(this.store.getState(),N.detail.soId);this.$.deletePrompt.type=DS.SMAPoweredByViews.ADDeletePrompt.TYPES.SO;this.$.deletePrompt.isRemove=false;this.$.deletePrompt.items=[O];this.$.deletePrompt.showDialog()},onCloseStudy:function(N){N.stopPropagation();N.cancelBubble=true;w.slideBack()},createDropZone:function(N){N.stopPropagation();N.cancelBubble=true;if(!this.$.createJob.isJobCreationOpen()&&!D.isDragWithinApp){D.createDropZone({localFileCallBack:x.bind(this),dashboardContentCallBack:p.bind(this)},N)}else{N.dropEffect="none"}},onMonitorJob:function(N){N.stopPropagation();N.cancelBubble=true;if(E){E.showWidget("SIMJDIS_AP","",{X3DContentId:JSON.stringify(N.detail.compassObject)})}},onDragStart:function(){D.isDragWithinApp=true},onDragEnd:function(){D.isDragWithinApp=false},refreshApp:function(){z.refreshAll({store:this.store,dispatchAlerts:true});D.destroyDropZone()},onViewFile:function(N){N.stopPropagation();N.cancelBubble=true;this.$.tailFileContainer.startTailMonitor(N.detail)},behaviors:[DS.SMAProcSP.SPBase,DS.SMAPoweredByViews.ADReduxBehaviour]})}(this));
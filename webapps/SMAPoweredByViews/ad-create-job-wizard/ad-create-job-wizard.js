require(["UWA/Core","UWA/Class/Promise","DS/SMAPoweredByState/ad-state-redux-observer","DS/WebappsUtils/WebappsUtils","DS/SMAPoweredByState/ad-state-loading-utils","DS/SMAPoweredByState/ad-state-domain-job-types/selectors","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAPoweredByHandler/ADHandlerFactory"],function(g,e,i,f,j,l,o,d){var b=window.Promise||e,m=null,q=null,a=null,n=null,t=null,r=null,k=null,s=null,c=null,h=null,u=null,p=null;m=function(){this.$.adWizard.showDialog()};q=function(){this.$.adWizard.hideDialog();u.call(this)};a=function(){this.$.adWizard.toggleLoading(true)};n=function(){this.$.adWizard.toggleLoading(false)};t=function(v){v.stopPropagation();v.cancelBubble=true;u.call(this);this.fire("cancelcreatejob",{})};u=function(){var v=this.$.adWizard.querySelectorAll(".job-setup-wizard-step");[].forEach.call(v,function(w){if(w.unsubscribeAll){w.unsubscribeAll()}});if(this.handler!==null){this.handler.unsubscribeAll()}this.handler=null;this.jobTypeId=null;this.jobId=null;this.pages=null};r=function(w,z,x){var A=[],v=[];if(this.pages!==w){this.pages=w;for(var y=0;y<w.length;y++){A[y]=f.getWebappsBaseUrl()+w[y].webcomponent.url;v[y]="i18n!"+w[y].nlsPath}k(A).then(s.bind(null,v)).then(c.bind(this,this.$.adWizard,w,z,x,function(B){this._elementList=B}.bind(this),function(){return this.jobId}.bind(this)))}};k=function(v){return new b(function(w){j.loadWebComponents(v,null,w)})};s=function(v){return new b(function(w){window.require(v,function(){w(arguments)})})};c=function(C,v,H,E,y,G,D){var I=[],B=[],x=[],A=null,w={};C.customButtonHandler=h.bind(this);for(var z=0;z<v.length;z++){A=document.createElement(v[z].webcomponent.tagName);w=v[z].custom;A.classList.add("job-setup-wizard-step");I.push(D[z].get(v[z].titleKey));A.handler=H;A.store=E;A.validator=H.Selectors[v[z].validator];for(var F in w){if(w.hasOwnProperty(F)){A[F]=w[F]}}if(A.validator){x.push(A.validator)}B.push(A)}y(B);if(G()){p(G(),E,B,H,x)}C.render(B,I)};p=function(v,w,y,x){x.addJobId(v);y.forEach(function(z){z.jobId=v})};h=function(v){v.stopPropagation();v.cancelBubble=true;u.call(this);this.fire("runjob",{})};window.Polymer({is:"ad-create-job-wizard",properties:{jobTypeId:{type:String,value:null,observer:"jobTypeChanged"},isBatchJob:{type:Boolean,value:true},store:{type:Object,observer:"jobTypeChanged"},jobId:{type:Object,observer:"jobIdChanged",value:null},title:{type:String},handler:{type:Object}},showDialog:function(){return m.apply(this,arguments)},hideDialog:function(){return q.apply(this,arguments)},startLoading:function(){return a.apply(this,arguments)},stopLoading:function(){return n.apply(this,arguments)},jobTypeChanged:function(){if(this.jobTypeId&&this.store){d.getHandler({jobTypeId:this.jobTypeId,store:this.store}).then(function(v){this.handler=v;if(!this.isBatchJob){r.call(this,v.wizardFacets,v,this.store)}else{r.call(this,v.wizardBatchFacets,v,this.store)}}.bind(this))}},jobIdChanged:function(){if(this._elementList&&this._elementList.length>0&&this.handler!==null){p(this.jobId,this._elementList[0].store,this._elementList,this._elementList[0].handler,this._elementList.map(function(v){return v.validator}),this.$.adWizard)}},cancelCreateJob:function(){return t.apply(this,arguments)}})});
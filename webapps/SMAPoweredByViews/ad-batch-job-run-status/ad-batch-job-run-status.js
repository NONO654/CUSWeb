define("DS/SMAPoweredByViews/ad-batch-job-run-status/ad-batch-job-run-status",["DS/SMAProcSP/PolymerLoader","DS/SMAPoweredByViews/ad-redux-behaviour/ReduxBehaviour","DS/SMAPoweredByState/ad-state-store","DS/UIKIT/Spinner","DS/UIKIT/Tooltip","UWA/Core","DS/SMAPoweredByViews/Utils/ADDataFormatUtils","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAProcSP/sp-base/sp-base","DS/SMAPoweredByHandler/ADHandlerFactory","text!DS/SMAPoweredByViews/ad-batch-job-run-status/ad-batch-job-run-status.html","i18n!DS/SMAPoweredByViews/assets/nls/ADBatchJobRunStatus","css!DS/SMAPoweredByViews/ad-batch-job-run-status/ad-batch-job-run-status.css"],function(m,j,r,n,y,f,h,u,E,d,z,e){var x=null,D=null,G=null,w=null,i=null,l=null,H=null,C=null,b=null,o=null,s=null,v=null,F=null,A=null,q=null,B=null,k=null,c=null,t=null;var p=function(K,L,J){var I=document.createElement("span");I.className="content-status";I.textContent=K[J];L.appendChild(I)};var g=function(K,L,J){var I=document.createElement("span");I.className="content-status";I.textContent=K[J];L.appendChild(I)};var a=[{name:e.RUNID,key:"Run Id",dataType:"String",sortable:true},{name:e.INPUTS,key:"input",dataType:"String",sortable:true},{name:e.STARTDATE,key:"startDate",dataType:"String",sortable:true},{name:e.ENDDATE,key:"endDate",dataType:"String",sortable:true},{name:e.Status,key:"status",callback:p,sortable:true},{name:e.PROGRESS,key:"jobProgress",callback:g,sortable:true}];w=function(L){for(var K=0;K<L.length;K++){var I=document.createElement("th");I.className=L[K].key;I.textContent=L[K].name;if(L[K].sortable===true){var M=document.createElement("span");M.className="sort-indicator fonticon fonticon-open-down hidden";var J=document.createElement("span");J.className="sort-indicator fonticon fonticon-open-up hidden";I.appendChild(M);I.appendChild(J);I.addEventListener("click",D.bind(this,true,L[K].key,this.$.tableBody))}this.$.tableHeaderRow.appendChild(I)}};B=function(){var J=[];var I=u.isBatchJob(this.store.getState(),this.jobId);if(I){J=u.batchJobIterations(this.store.getState(),this.jobId)}return J};q=function(){this._selectedInputs=[];this._dropCounter=0;this._loadingSpinner=new n({renderTo:this.$.spinnerContainer,visible:true});w.call(this,a);this.store=r.getStore()};H=function(){var I=document.querySelectorAll(".sort-indicator");[].forEach.call(I,function(J){this.DOM(J).addClass("hidden")}.bind(this))};l=function(I){switch(I){case"title":case"modified":case"purpose":return"text";case"size":case"status":return"custom";default:return"text"}};D=function(J,I,M,K){var L;K.stopPropagation();K.cancelBubble=true;H.call(this);L=l(K.currentTarget.className);h.sortTable.call(this,J,I,M,K.currentTarget,L)};G=function(){this.$.tableBody.textContent="";this._loadingSpinner=new n({renderTo:this.$.spinnerContainer,visible:true})};C=function(){[].forEach.call(document.querySelectorAll(".tooltip"),function(I){I.parentNode.removeChild(I)})};b=function(K){var I=false;for(var J=0;J<this.$.tableBody.children.length;J++){if(K.id===this.$.tableBody.children[J].itemData.id){I=true;break}else{if(K.title===this.$.tableBody.children[J].itemData.title&&K.status==="in3dx"&&this.$.tableBody.children[J].itemData.status==="uploading"){I=true;break}}}return I};o=function(J,I){var K=function(M){var L;Object.keys(M).forEach(function(N){L+=M[N]});return L};return K(J)===K(I)};v=function(I,L,K){L.textContent="";L.itemData=K;var J=this;I.forEach(function(N){if(N.callback){var M=document.createElement("td");M.className=N.key+" td-centered";L.appendChild(M);N.callback.call(J,K,M,N.key,L)}if(N.dataType==="String"){var O=document.createElement("td");O.className=N.key+" td-centered";O.textContent=K[N.key];L.appendChild(O)}})};s=function(I,J){var K=document.createElement("tr");K.className="input-row";this.$.tableBody.appendChild(K);K.itemData=J;v.call(this,I,K,J)};F=function(K){var I=[];I=K.map(function(L){return L.id});for(var J=0;J<this.$.tableBody.children.length;J++){if(I.indexOf(this.$.tableBody.children[J].itemData.id)===-1){this.$.tableBody.deleteRow(J)}}};A=function(I,J){[].forEach.call(this.$.tableBody.children,function(K){if(K.itemData.title===J.title&&K.itemData.id===J.id){if(!o.call(this,K.itemData,J)){v.call(this,I,K,J)}}}.bind(this))};k=function(){this.unsubscribeAll();d.getHandler({jobId:this.jobId,store:r.getStore()}).then(function(I){this.handler=I;this.observeStore({select:B.bind(this),onChange:"_handleIterationStatusChanged"})}.bind(this))};c=function(J){var I=[];J.forEach(function(M,L){var K=u.jobProgress(r.getStore().getState(),this.jobId,L);I.push({"Run Id":L+1,input:this.handler.Selectors.iterationDisplayName(r.getStore().getState(),this.jobId,L),id:L,jobProgress:K.overallProgress+"%",startDate:M.started?h.formatTimestamp(M.started):"--",endDate:M.ended?h.formatTimestamp(M.ended):"--",status:M.status})}.bind(this));return I};i=function(J,L){if(L.length>0){C.call(this);var K=c.call(this,L);for(var I=0;I<K.length;I++){F.call(this,K);if(b.call(this,K[I])){A.call(this,J,K[I])}else{s.call(this,J,K[I])}}}};t=function(I){this._loadingSpinner.show();this.$.tableContainer.classList.add("loading-mask");i.call(this,a,I);this._loadingSpinner.hide();this.$.tableContainer.classList.remove("loading-mask")};m.register(z);return window.Polymer({is:"ad-batch-job-run-status",properties:{store:{type:Object},nlspath:{type:String,value:"DS/SMAPoweredByViews/assets/nls/ADCreateJobInputs"},jobId:{type:Object,observer:"jobIdChanged"}},ready:function(){return q.apply(this,arguments)},onChange:function(){return x.apply(this,arguments)},jobIdChanged:function(){return k.apply(this,arguments)},_handleIterationStatusChanged:function(){return t.apply(this,arguments)},sort:function(){return D.apply(this,arguments)},reset:function(){return G.apply(this,arguments)},behaviors:[j,E]})});
(function(){var h,n,l,k,e,a,p,o,d={DEFAULT:"Delete",JOBS:"DeleteJobs",FILES:"DeleteFiles",SO:"SimulationObject"},b=function(){return new Promise(function(q){require(["DS/SMAPoweredByState/ad-state-defs","DS/SMAPoweredByState/ad-state-domain-jobs/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/selectors","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAPoweredByState/ad-state-app-alerts/actions","DS/SMAPoweredByViews/Utils/ADDataFormatUtils","i18n!DS/SMAPoweredByViews/assets/nls/ADDeletePrompt"],function(u,w,t,s,y,r,v,x){h=u;n=w;l=t;k=s;e=y;a=r;p=v;o=x;q()})})},f=function(q,r){q.classList[r]("show");q.classList[r]("in")},g=function(q){q.classList.toggle("hidden");q.classList.toggle("show");q.classList.toggle("in")},m=function(q,r){switch(q){case d.JOBS:r.defaultHeader.classList.add("hidden");r.deleteJobsHeader.classList.remove("hidden");r.deleteJobsMessage.classList.remove("hidden");r.deleteFilesHeader.classList.add("hidden");r.deleteFilesMessage.classList.add("hidden");r.deleteSOHeader.classList.add("hidden");r.deleteSOMessage.classList.add("hidden");break;case d.FILES:r.defaultHeader.classList.add("hidden");r.deleteJobsHeader.classList.add("hidden");r.deleteJobsMessage.classList.add("hidden");r.deleteFilesHeader.classList.remove("hidden");r.deleteFilesMessage.classList.remove("hidden");r.deleteSOHeader.classList.add("hidden");r.deleteSOMessage.classList.add("hidden");break;case d.SO:r.defaultHeader.classList.add("hidden");r.deleteJobsHeader.classList.add("hidden");r.deleteJobsMessage.classList.add("hidden");r.deleteFilesHeader.classList.add("hidden");r.deleteFilesMessage.classList.add("hidden");r.deleteSOHeader.classList.remove("hidden");r.deleteSOMessage.classList.remove("hidden");break;default:r.defaultHeader.classList.remove("hidden");r.deleteJobsHeader.classList.add("hidden");r.deleteJobsMessage.classList.add("hidden");r.deleteFilesHeader.classList.add("hidden");r.deleteFilesMessage.classList.add("hidden");r.deleteSOHeader.classList.add("hidden");r.deleteSOMessage.classList.add("hidden");break}},j=function(v,r,w,s,A,u){var q=document.createElement("li"),y=document.createElement("span"),t=document.createElement("span"),x=document.createElement("span"),z=document.createElement("span");q.id="listItem_"+r;y.textContent=w;t.textContent=s;x.textContent=p.formatTimestamp(A);z.textContent=u!==null?(u?o.Removed:o.Deleted):"";q.classList.add("item-info");y.classList.add("item-title");z.classList.add("item-mode");q.classList.add("ad-delete-prompt");y.classList.add("ad-delete-prompt");t.classList.add("ad-delete-prompt");x.classList.add("ad-delete-prompt");z.classList.add("ad-delete-prompt");q.appendChild(y);q.appendChild(t);q.appendChild(x);q.appendChild(z);v.appendChild(q)},i=function(q){var r=k.managedDataChildren(this.store.getState(),q),s=[];s=r.map(function(t){return t.id});return s},c=function(t,w,r,x,s){var v=null,q=r.map(function(y){return y.id});var u=this;switch(t){case d.JOBS:q.forEach(function(y){var B="NOTSTARTED";var C=function(D){var E=e.jobPersistenceOperation(D,y);return E};var A=function(E){var D=null;var F=e.jobPersistenceOperation(E,y);if(B===h.PersistenceOperation.DELETING&&F===null){D=e.jobPersistenceError(E,y)}return D};var z=function(D){if(B===h.PersistenceOperation.DELETING&&D===null){return true}B=D;return false};u.waitFor({select:C,isResolved:z,checkError:A,timeout:10000})["catch"](function(D){s(a.addAlert("deletejobs","error",null,D.code))})});v=n.deleteJobs(x,q);break;case d.FILES:case d.SO:q.forEach(function(A){var B="NOTSTARTED",D=i.call(u,A);var C=function(F){var E=k.managedDataPersistenceOperation(F,A);return E};var y=function(G){var E=null;var F=k.managedDataPersistenceOperation(G,A);if(B===h.PersistenceOperation.DELETING&&F===null){E=k.managedDataPersistenceError(G)}return E};var z=function(E){if(B===h.PersistenceOperation.DELETING&&E===null){if(u.deleteCB&&D){u.deleteCB(D)}return true}B=E;return false};u.waitFor({select:C,isResolved:z,checkError:y,timeout:10000})});v=w?l.removeManagedData(q):l.deleteManagedData(q);break;default:break}if(v){s(v)}};DS.SMAPoweredByViews=DS.SMAPoweredByViews||{};DS.SMAPoweredByViews.ADDeletePrompt=window.Polymer({is:"ad-delete-prompt",properties:{type:{type:String,observer:"_bindType"},items:{type:Array,observer:"_bindItems"},isRemove:{type:Boolean,value:false},studyId:{type:String},deleteCB:{type:Object}},_bindType:function(q){m(q,this.$)},_bindItems:function(s){var t=this.$.itemList,r=this.store,q=this.type===d.JOBS;t.textContent="";s.forEach(function(v){var x=q?v.title:v.name,u=q?v.ended:v.modified,w=q?null:k.isFileParentReferenced(r.getState(),v.id);j(t,v.id,x,v.owner,u,w)})},ready:function(){this.isReady=Promise.resolve().then(this.initReduxBehavior.bind(this)).then(b.bind(this))},showDialog:function(){f(this.$.modal,"add");g(this.$.modalOverlay)},hideDialog:function(){f(this.$.modal,"remove");g(this.$.modalOverlay)},onClose:function(){this.hideDialog()},onOk:function(){c.call(this,this.type,this.isRemove,this.items,this.studyId,this.store.dispatch);this.hideDialog()},behaviors:[DS.SMAProcSP.SPBase,DS.SMAPoweredByViews.ADReduxBehaviour]});DS.SMAPoweredByViews.ADDeletePrompt.TYPES=d}(this));
(function(){var n,b,i,l,a,q,f,r,d,k,g,e=function(){return new Promise(function(s){require(["DS/SMAPoweredByState/ad-state-app/selectors","DS/SMAPoweredByState/ad-state-cos/actions","DS/SMAPoweredByState/ad-state-cos/selectors","DS/SMAPoweredByState/ad-state-app-alerts/actions","DS/SMAPoweredByState/ad-state-domain-jobs/actions","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAPoweredByState/ad-state-domain/actions","DS/SMAPoweredByState/ad-state-app-credentials/selectors","DS/SMAPoweredByState/ad-state-domain-study/selectors"],function(v,t,y,u,A,z,x,B,w){n=v;b=t;l=y;a=u;q=A;r=z;d=x;k=B;g=w;s()})})},m=function(){this.$.pres.cloudStations=this.handler.Selectors.getCloudStations(this.store.getState(),this.jobId);this.$.pres.batchConfiguration=r.batchJobConfiguration(this.store.getState(),this.jobId)},j=function(){i=this.getBoundActions(b);f=this.getBoundActions(q)},p=function(s){return r.jobExecutionOptions(s,this.jobId)},c=function(u){var v=null,t=p.apply(this,[u]);if(t&&t.station&&u.domain.workData.objects&&u.domain.workData.objects.length>0){var s=u.domain.workData.objects;v=s.filter(function(w){return w.station===t.station})}return v},o=function(s){return r.jobCredentialsID(s,this.jobId)},h=function(){this.unsubscribeAll();this.observeStore({select:this.handler.Selectors.isCloudEnabled,onChange:"cloudEnabledChanged"});this.observeStore({select:p.bind(this),onChange:"executionOptionsChanged"});this.observeStore({select:l.serversPersistenceOperation,onChange:"serversPersistenceOperationChanged"});this.observeStore({select:l.stationsPersistenceOperation,onChange:"stationsPersistenceOperationChanged"});this.observeStore({select:c.bind(this),onChange:"workDataStateChanged",arrayCompare:true});this.observeStore({select:o.bind(this),onChange:"credentailsIdChanged"})};DS.SMAPoweredByViews=DS.SMAPoweredByViews||{};DS.SMAPoweredByViews.ADCreateJobComputeContainer=window.Polymer({is:"ad-create-job-compute-container",properties:{jobId:{type:String,observer:"jobIdChanged"},handler:{type:Object,observer:"jobIdChanged"}},ready:function(){this.isReady=Promise.resolve().then(this.initReduxBehavior.bind(this)).then(e.bind(this))},jobIdChanged:function(){this.$.pres.$.customDRM.jobId=this.jobId;this.$.pres.jobId=this.jobId;if(this.jobId&&this.handler){this.isReady.then(function(){j.apply(this);h.apply(this);m.apply(this)}.bind(this)).then(this.$.pres.isReady)}},executionOptionsChanged:function(v){if(v){var w=null,u=null,s=null,t=true;if(this.handler&&this.handler.Selectors&&this.handler.Selectors.getCPULimit&&this.handler.Selectors.getUVMEstimates){w={cpuLimit:this.handler.Selectors.getCPULimit(this.store.getState(),{executionOptions:v}),svmLimit:this.handler.Selectors.getSVMLimit(this.store.getState(),{executionOptions:v}),pvmLimit:this.handler.Selectors.getPVMLimit(this.store.getState(),{executionOptions:v})};u=this.handler.Selectors.getUVMEstimates({executionOptions:v})}if(this.handler&&this.handler.Selectors&&this.handler.Selectors.getCloudStations){s=this.handler.Selectors.getCloudStations(this.store.getState(),this.jobId);t=(s.items.length>1)}this.$.pres.uvm={limits:w,estimates:u};this.$.pres.os=s;this.$.pres.osenabled=t;this.$.pres.executionOptions=v}},credentailsIdChanged:function(t){var s=k.getCredentialsByID(this.store.getState(),t);this.$.pres.populateCredentials(s)},cloudEnabledChanged:function(u){var t=n.currentWhereUsedTenantID(this.store.getState()),s=typeof t!=="undefined"&&t!==null;if(typeof u!=="undefined"){this.$.pres.isTenantIdSet=s;this.$.pres.cloudComputeNotSupported=!u}},serversPersistenceOperationChanged:function(t){var v=this.store.dispatch,x=null,y=[],z=l.allServers(this.store.getState()),s=l.serversPersistenceError(this.store.getState()),w=z.filter(function(A){return A.persistenceError&&A.persistenceError.code}),u=z.filter(function(A){return typeof A.persistenceError==="undefined"});if(s){x="ERROR"}else{if(t==="READING"){x="LOADING"}else{x="READY";y=u}}this.$.pres.cosServers={status:x,items:y};if(s!==null){v(a.addAlert("cosservers","error",null,s.code))}w.forEach(function(A){if(A.persistenceError.code===l.ErrorCodes.SERVER_STATUS_WS_ERROR){v(a.addAlert("cosservers","warning",A.id,A.persistenceError.code))}else{v(a.addAlert("cosservers","error",A.id,A.persistenceError.code))}})},stationsPersistenceOperationChanged:function(s){if(s==="READING"){this.$.pres.stations={status:"LOADING"}}else{var t=this.$.pres.$.cosServersSelect.value,u=this.handler.Selectors.getPremiseStations(this.store.getState(),{id:t},n.spaceURL(this.store.getState()));u.sort(function(w,v){return w.name>v.name});if(l.stationsPersistenceError(this.store.getState())){this.$.pres.stations={status:"ERROR",errorMessage:l.stationsPersistenceError(this.store.getState()).message,items:u}}else{this.$.pres.stations={status:"READY",items:u}}}},workDataStateChanged:function(s){this.$.pres.workData=s?s.slice():null},presExecutionOptionsChanged:function(v){var w,u=v.detail.value,t,s;w=r.jobExecutionOptions(this.store.getState(),this.jobId).drmMode;if(!u.numProcs){u.numProcs=r.jobExecutionOptions(this.store.getState(),this.jobId).numProcs}if(u.drmMode===l.DRMMode.FIPER){u.os=null;if(u.server&&u.station){t=l.serverWithID(this.store.getState(),u.server);if(t){s=l.stationWithName(this.store.getState(),t,u.station);if(s){u.os=s.os}}}}u.credentialsID=r.jobCredentialsID(this.store.getState(),this.jobId);f.setJobExecutionOptions(this.jobId,u);if((w===l.DRMMode.FIPER)&&((u.drmMode!==l.DRMMode.FIPER)&&(u.drmMode!==l.DRMMode.CLOUD))){f.setJobExecutionCustomDRMCores(this.jobId,u.numProcs,l.customDRMCoresProperty(this.store.getState(),u.server,u.drmMode))}},presRefreshCosServers:function(){i.refreshServers()},presRefreshStations:function(){var s=this.$.pres.$.cosServersSelect.value;i.refreshStations({id:s})},presBatchConfigurationChanged:function(t){var s=t.detail.value;f.setBatchJobOptions(this.jobId,s.maxBatchSize,s.isSequential)},onSaveCredentials:function(w){var u=w.detail;var t=r.jobExecutionOptions(this.store.getState(),this.jobId).server;var x=g.studyObject(this.store.getState());var s={};s.serverId=t;s.domainName=u.domainName;s.windowsUser=u.windowsUser;s.linuxUser=u.linuxUser;s.windowsPassword=u.windowsPassword;s.linuxPassword=u.linuxPassword;s.enoviaUser=x.owner;var v=r.jobDRMMode(this.store.getState(),this.jobId);s.drmMode=v;s.jobId=this.jobId;this.store.dispatch(d.saveCredentials(s))},behaviors:[DS.SMAProcSP.SPBase,DS.SMAPoweredByViews.ADReduxBehaviour]})}(this));
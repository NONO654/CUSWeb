/*!  Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/SMAPoweredByViews/Skeleton/Renderers/ADFileRenderer",["DS/W3DXComponents/Skeleton","DS/W3DXComponents/Views/Layout/GridView","DS/W3DXComponents/Views/Layout/NestedScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Layout/TableView","DS/W3DXComponents/Views/Layout/ListView","DS/W3DXComponents/Views/Item/TileView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/ContentSet","DS/TransientWidget/TransientWidget","DS/SMAPoweredByViews/Skeleton/Collection/ADFilesCollection","DS/SMAPoweredByViews/Skeleton/Model/FileModel","DS/SMAPoweredByViews/Skeleton/Views/ADFileHistoryView","DS/SMAPoweredByViews/Skeleton/Views/ADFileUsedInView","DS/SMAPoweredByViews/Skeleton/Views/ADTileView","DS/SMAPoweredByViews/Skeleton/Views/ADThumbnailView","DS/SMAPoweredByViews/Skeleton/Views/ADFilesEmptyView","DS/SMAPoweredByViews/Skeleton/Actions/ADFileContexualActions","DS/SMAPoweredByState/ad-state-store","DS/SMAPoweredByState/ad-state-app-alerts/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/selectors","DS/SMAPoweredByViews/Utils/ADDataFormatUtils","WebappsUtils/WebappsUtils","DS/SMAPoweredByState/ad-state-loading-utils","i18n!DS/SMAPoweredByViews/assets/nls/ADFileRenderer"],function(K,w,z,F,y,B,J,H,L,G,p,h,m,k,l,e,I,n,C,v,s,f,b,D,u,j){var E={};var t=function(M){var N=M.get("type");return N==="DesignSight"||N==="Physics Simulation"},d=function(R,Q,O){var N=Q.model,M=t(N),P=null;if(M){P=b.format3DPlayData(N)}else{if([f.Types.FILE].indexOf(N.get("type"))!==-1){P=b.format3DPlayData(f.managedDataParent(C.getStore().getState(),N.get("id"),false),f.Types.DOCUMENT)}else{P=b.format3DPlayData(N,N.get("type"))}}O.dataTransfer.setData("text",JSON.stringify(P))},r=function(N,P){var O=P.model,M=t(O);if(M){b.setCompassContext(O.id)}else{p.syncModelFromState(C.getStore().getState(),O);b.setCompassContext(null)}},i="grid-scroll",o=w.extend({appendHtml:function(M,O){if(M.isBuffering){M.elBuffer.appendChild(O.container);M._bufferedChildren.push(O)}else{if(M.container.firstChild){var N=0;M.container.insertBefore(O.container,M.container.children[N])}else{M.container.insertBefore(O.container,M.container.getElement(".by-pass-flex"))}}}}),x=z.extend({name:i,nested:o}),g=function(N){N=N.toLowerCase();var M=N.split(/ /);if(M.length===2){if(M[1]==="kb"){return M[0]*1000}else{if(M[1]==="mb"){return M[0]*1000000}else{if(M[1]==="gb"){return M[0]*1000000000}}}}return N},q=x.extend({name:"list",defaultOptions:{layout:{column:1},selectionMode:"oneToOne",itemView:J,scrollPosition:"auto",useInfiniteScroll:true,usePullToRefresh:true,scrollDuration:200}}),a=y.extend({sort:function(P,M,N){var O=P.sortBy(function(Q){if(typeof N==="function"){return N.call(Q)}else{var S=N.split(/[.[\]]/),R=null;S.unshift(Q.toJSON());R=S.reduce(function(T,U){return T[U]});if(N==="size"){R=g(R)}if(!R.toLowerCase){return R}return R&&R.toLowerCase()}});if(M==="descending"){O.reverse()}P.reset(O,{sort:false});this.dispatchEvent("onSort",[M,N])}}),c=F.extend({name:i,nested:a}),A=function(){return{collection:p.getCollection(),view:L,viewOptions:{contents:{selectionMode:"oneToOne",useInfiniteScroll:false,usePullToRefresh:false,headerOnEmpty:false,views:[{id:"tile",view:x,itemView:l,title:j.TileView,"default":window.widget&&window.widget.getValue("currentViewId")==="tile"},{id:"thumbnail",view:x,itemView:e,title:j.ThumbnailView,"default":window.widget&&window.widget.getValue("currentViewId")==="thumbnail"},{id:"table",view:c,itemView:H,title:j.RowView,"default":window.widget&&window.widget.getValue("currentViewId")==="table"},{id:"list",view:q,itemView:l,selectionMode:"oneToOne"}],itemViewOptions:{contextualActions:n.getContexualActions},headers:[{property:"title",sortable:true,label:j.columnTitle},{property:"subtitle",sortable:false,label:j.columnVersion},{property:"modified",sortable:true,label:j.columnModifiedTime},{property:"fileType",sortable:true,label:j.columnType},{property:"size",sortable:true,label:j.columnFileSize},{property:"displayStatusTable",sortable:true,label:j.columnStatus}],emptyView:I,events:{onItemViewDrag:d,onItemViewSelect:r}}},idCardOptions:{attributesMapping:{title:function(){return this.get("title")}},facets:[{text:"History",icon:"clock",handler:K.getRendererHandler(m)}]}}};E.getRenderer=A;return E});
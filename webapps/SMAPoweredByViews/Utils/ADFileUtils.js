define("DS/SMAPoweredByViews/Utils/ADFileUtils",["UWA/Core","DS/SMAPoweredByState/ad-state-domain-managed-data/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/selectors","DS/SMAPoweredByState/ad-state-domain-work-data/selectors","DS/SMAPoweredByState/ad-state-app-alerts/actions","DS/SMAPoweredByState/ad-state-loading-utils","DS/SMAPoweredByState/ad-state-stream-utils","DS/SMAPoweredByViews/Utils/ADMonitorUtils","WebappsUtils/WebappsUtils","UWA/Core","UWA/Utils","i18n!DS/SMAPoweredByViews/assets/nls/ADFileUtils"],function(f,n,m,i,a,d,o,k,b,l,j,q){var e={},h=function(x,r,v,u,s){var t=(Array.isArray(r))?r:[].slice.call(r),y=u?u:5,z=[],w=/[,;'$]/g;t.forEach(function(B){if(B.name.search(w)===-1){var D=v?v:x.getState().domain.study.managedDataRootID,C=m.managedDataFilesWithName(x.getState(),B.name);if(C.length===1){D=C[0].id}else{if(C.length>1){console.warn("More than one matching filename found.")}}var A=m.managedDataWithID(x.getState(),D),E=function(){x.dispatch(n.uploadLocalFile(D,B,y))};if(A&&A.type===m.Types.FILE&&B.name!==A.name&&s){s.message=q.get("PromptMessage",{originalFilename:A.name,newFilename:B.name});s.okCallback=E;s.showDialog()}else{E()}}else{z.push(B.name)}});if(z.length===1){x.dispatch(a.addAlert("fileupload","error",z[0],"SMAPoweredByViews.ADFileUtils.ILLEGAL_FILENAME"))}else{if(z.length>1){x.dispatch(a.addAlert("fileupload","error",z.join(", "),"SMAPoweredByViews.ADFileUtils.ILLEGAL_FILENAMES"))}}},p=function(s,u){var r=j.parseUrl(s);var w=j.parseQuery(r.query);if(u){w.__fcs__attachment=true}delete r.query;var v=j.composeUrl(r);var t=document.createElement("form");t.style.display="none";t.method="POST";t.action=v;Object.keys(w).forEach(function(y){var x=document.createElement("input");x.setAttribute("name",y);x.setAttribute("value",w[y]);t.appendChild(x)});k.shouldPreventStopMonitoringOnce=true;document.body.appendChild(t);t.submit();document.body.removeChild(t)},c=function(t,r){var u=function(v){p(v,true)},s=function(){t.dispatch(a.addAlert("documentdownload","error",null,"SMAPoweredByViews.ADFileUtils.DOCUMENT_DOWNLOAD_FAILED"))};o.getDocumentsTicketURL(t.getState(),r,u,s)},g=function(t,s,x){var w=true,v=t.getState(),u=function(y){p(y,w)},r=function(){t.dispatch(a.addAlert("filedownload","error",null,"SMAPoweredByViews.ADFileUtils.FILE_DOWNLOAD_FAILED"))};if(i.workDataWithID(v,s)){w=false;o.getWorkFileURL(v,s,u,r,null)}else{o.getManagedFileURL(v,s,u,r,null,x)}};e.uploadFiles=function(t,u,s,v,r){h(t,u,s,v,r)};e.addReferencedContent=function(r,s){r.dispatch(n.addReferencedContent(r.getState().domain.study.managedDataRootID,s.objectId,s.displayName,s.objectType))};e.downloadFile=function(s,r,t){g(s,r,(typeof t!=="undefined")?t:false)};e.downloadDocuments=function(s,r){c(s,r)};e.deleteFileVersion=function(r,s){r.dispatch(n.deleteManagedData([s]))};return e});
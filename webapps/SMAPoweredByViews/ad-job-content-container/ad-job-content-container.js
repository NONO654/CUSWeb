(function(B){var H=null,j=null,d=null,v=null,q=null,A=null,a=null,n=null,k=null,e=null,F=null,x=null,C=null,r=null,b=null,G=null,g=null,E=null,m=null,z=null,J=null,c=null,I=null,i=null,s=null,p=null,f=null,D=null,l=null,t=null,u={uploading:"uploading",in3dx:"in3dx",onDisk:"onDisk",bothInSync:"bothInSync",bothOutOfSync:"bothOutOfSync"},o={workdir:"workdir",saved:"saved"},h={folder:"folder"},y={TAILFILEERROR:"SMAPoweredByViews.ad-job-content-container.TAILFILEERROR"},w=["DownloadedFiles.xml","deleteme.sim"];H=function(L){L.stopPropagation();L.cancelBubble=true;if(L.detail.inputs&&L.detail.inputs.length>0){for(var K=0;K<L.detail.inputs.length;K++){this._ADFileUtils.downloadFile(this.store,L.detail.inputs[K],L.detail.zip)}}};j=function(P){P.stopPropagation();P.cancelBubble=true;var Q=this.store.getState();var M=[];if(P.detail.inputs&&P.detail.inputs.length>0){for(var O=0;O<P.detail.inputs.length;O++){var L=this._MDSelectors.managedDataWithID(Q,P.detail.inputs[O]);var K=null;if(this._MDSelectors.Types.FILEVERSION===L.type){K=this._MDSelectors.managedDataParent(Q,L.id,false).id}else{K=L.id}var N=this._MDSelectors.managedDataParent(Q,K,false).id;M.push(N)}}this._ADFileUtils.downloadDocuments(this.store,M)};d=function(K){K.stopPropagation();K.cancelBubble=true;this.fire("generateresult",{jobId:this.jobId,input:K.detail.inputs[0]})};v=function(K){K.stopPropagation();K.cancelBubble=true;if(K.detail.inputs&&K.detail.inputs.length>0){this.boundDomainActions.uploadWorkData(this.store.getState().domain.study.id,this.store.getState().domain.study.managedDataRootID,K.detail.inputs,this.jobId)}};A=function(K){var L=K.detail;K.stopPropagation();K.cancelBubble=true;L.jobId=this.jobId;this.fire("viewfile",L)};a=function(K){K.stopPropagation();K.cancelBubble=true;if(this._TransientWidget){this._TransientWidget.showWidget("SIMWPSR_AP",K.detail.displayName,{X3DContentId:JSON.stringify(K.detail.compassObject)})}};s=function(M){var L="tailFile",O=this._AlertSelectors.Level.ERROR,K=M.code?M.code:y.TAILFILEERROR,N="";M.message?N=M.message:N="";this.boundAlertActions.addAlert(L,O,N,K)};p=function(K){this.boundAlertActions.addAlert(K.category,K.level,K.message,K.code)};n=function(K){K.stopPropagation();K.cancelBubble=true;s.call(this,K.detail)};k=function(K){K.stopPropagation();K.cancelBubble=true;p.call(this,K.detail)};I=function(M,L,N){var K=M.map(function(O){if(L){O.purpose=L}if(typeof(N)!=="undefined"&&N){O.source=o.workdir}else{O.source=o.saved}return O});return K};D=function(K){var M={id:K.id,type:K.type,title:K.title?K.title:K.name,maininput:"false",modified:this._ADDataFormatUtils.formatTimestamp(K.modified).replace(/,/g,""),filetype:this._ADDataFormatUtils.getFileType(K)},L;if(this._MDSelectors.Types.DOCUMENT===K.type||this._MDSelectors.Types.NVDOCUMENT===K.type||K.type==="DesignSight"||K.type===this._MDSelectors.Types.PROJECTION3DX){M.size="--";M.version="--"}M.size=K.size?K.size:"--";if(this._MDSelectors.Types.FILE===K.type&&K.source===o.workdir){M.version="--";M.status=u.onDisk}else{if(this._MDSelectors.Types.FILE===K.type&&K.source===o.saved){M.version="--";M.status=u.in3dx;M.docType=this._MDSelectors.managedDataParent(this.store.getState(),M.id,false).type}else{if(h.folder===K.type){M.version="--";M.status=u.onDisk}else{if(this._MDSelectors.Types.FILEVERSION===K.type){M.version=K.version;if(K.persistenceOperation===this._Defs.PersistenceOperation.CREATING){M.status=u.uploading}else{M.status=u.in3dx;L=this._MDSelectors.managedDataParent(this.store.getState(),M.id,false);if(L){M.docType=this._MDSelectors.managedDataParent(this.store.getState(),L.id,false).type}}}else{if(K.type==="DesignSight"){M.status=u.in3dx}else{if(this._MDSelectors.Types.RDOCUMENT===K.type){M.version="--";if(K.persistenceOperation===this._Defs.PersistenceOperation.CREATING){M.status=u.uploading}else{M.status=u.in3dx}}else{if(K.type===this._MDSelectors.Types.PROJECTION){M.version=K.version;M.status=u.uploading}else{if(K.type===this._MDSelectors.Types.PROJECTION3DX){M.status=u.uploading}}}}}}}}M.purpose=K.purpose;return M};l=function(K){[].forEach.call(this.items,function(L){if((L.title===K.title||L.title===K.name)&&L.source!==K.source){if((L.type===this._MDSelectors.Types.PROJECTION)||(K.type===this._MDSelectors.Types.PROJECTION)||(L.type===this._MDSelectors.Types.PROJECTION3DX)||(K.type===this._MDSelectors.Types.PROJECTION3DX)){L.status=u.uploading}else{if(parseInt(L.size)===parseInt(K.size)&&(L.purpose===this._NLS.ContentPurposeWorkData||K.purpose===this._NLS.ContentPurposeWorkData)){L.status=u.bothInSync;L.size=K.size}else{if(parseInt(L.size)!==parseInt(K.size)&&(L.purpose===this._NLS.ContentPurposeWorkData||K.purpose===this._NLS.ContentPurposeWorkData)){L.status=u.bothOutOfSync;L.size=K.size}else{if(parseInt(L.size)!==parseInt(K.size)&&L.purpose!==K.purpose){L.status=u.in3dx;L.purpose=this._NLS.ContentPurposeBoth;L.size=K.size;L.version=L.version+"/"+K.version;L.outputVerId=K.id}}}}L.diskId=K.id}}.bind(this))};i=function(M){var K,L,N;for(K=0;K<M.length;K++){N=M[K].title?M[K].title:M[K].name;if(K===0){this._loadedContent=[];this.items=[]}if(this._loadedContent.length===0||this.items.length===0||this._loadedContent.indexOf(N)===-1){L=D.call(this,M[K]);if(N&&w.indexOf(N)===-1){this.items.push(L)}this._loadedContent.push(N)}else{l.call(this,M[K])}}return this.items};q=function(){var K;if(this.inputs&&this.outputs&&this.workData){K=this.inputs.concat(this.outputs,this.workData);this.$.adjobContent.content=[];this.$.adjobContent.content=i.call(this,K)}};C=function(){var K=this;return new Promise(function(L){require(["DS/SMAPoweredByState/ad-state-domain/actions","DS/SMAPoweredByState/ad-state-domain-jobs/actions","DS/SMAPoweredByState/ad-state-domain-jobs/selectors","DS/SMAPoweredByState/ad-state-domain-managed-data/actions","DS/SMAPoweredByState/ad-state-domain-managed-data/selectors","DS/SMAPoweredByState/ad-state-defs","DS/SMAPoweredByMonitors/ad-monitor-work-data","DS/SMAPoweredByState/ad-state-domain-work-data/selectors","DS/SMAPoweredByState/ad-state-app-alerts/actions","DS/SMAPoweredByState/ad-state-app-alerts/selectors","UWA/Core","i18n!DS/SMAPoweredByViews/assets/nls/ADJobContent","DS/SMAPoweredByViews/Utils/ADDataFormatUtils","DS/TransientWidget/TransientWidget","DS/SMAPoweredByViews/Utils/ADFileUtils","DS/SMAPoweredByState/ad-state-app/selectors"],function(Q,X,S,M,V,U,aa,T,O,ab,W,Z,Y,N,R,P){K._DomainActions=Q;K._JobActions=X;K._JobSelectors=S;K._MDActions=M;K._MDSelectors=V;K._Defs=U;K._MonitorWorkData=aa;K._MonitorWorkDataSelectors=T;K._tailAttempts=0;K._AlertActions=O;K._AlertSelectors=ab;K._UWACore=W;K._NLS=Z;K._ADDataFormatUtils=Y;K._TransientWidget=N;K._ADFileUtils=R;K._AppSelectors=P;L()})})};e=function(){this.isReady=Promise.resolve().then(this.initReduxBehavior.bind(this)).then(C.bind(this));this._loadedContent=[];this.items=[]};f=function(K,M){var L=function(N){return N.sort(function(P,O){if(P.id===O.id){return 0}else{return P.id<O.id?-1:1}}).reduce(function(P,O){return P+O.id+O.size},"")};if(typeof(K)!=="undefined"){return L(K)===L(M)}else{return false}};F=function(){this.boundDomainActions=this.getBoundActions(this._DomainActions);this.boundMDActions=this.getBoundActions(this._MDActions);this.boundJobActions=this.getBoundActions(this._JobActions);this.boundAlertActions=this.getBoundActions(this._AlertActions)};b=function(){return this._JobSelectors.jobInputObjects(this.store.getState(),this.jobId)};G=function(){return this._JobSelectors.jobOutputObjects(this.store.getState(),this.jobId,true)};g=function(){var K=[],N=null;if(this._JobSelectors.isBatchJob(this.store.getState(),this.jobId)){for(var M=0;M<this._JobSelectors.batchJobIterationCount(this.store.getState(),this.jobId);M++){N=this._JobSelectors.jobWorkDataObjects(this.store.getState(),this.jobId,M);for(var L=0;L<N.length;L++){K.push(N[L])}}}else{K=this._JobSelectors.jobWorkDataObjects(this.store.getState(),this.jobId)}return K};E=function(){var M=this._MonitorWorkDataSelectors.workDirForJob(this.store.getState(),this.jobId),K=this._JobSelectors.jobPersistenceOperation(this.store.getState(),this.jobId),L=null;if(M){L=this._MonitorWorkDataSelectors.workDataPersistenceOperation(this.store.getState(),M.id)}return{jobContentPO:K,workDirPO:L}};m=function(K){this.inputs=I.call(this,K,this._NLS.ContentPurposeInput)};z=function(K){this.outputs=I.call(this,K,this._NLS.ContentPurposeOutput)};J=function(K){this.workData=I.call(this,K,this._NLS.ContentPurposeWorkData,true)};c=function(K){var L=this.$.adjobContent;if(K.jobContentPO===this._Defs.PersistenceOperation.READING&&K.workDirPO===this._Defs.PersistenceOperation.READING){L.loading={contentLoading:true,workDirLoading:{status:false,lastrefreshed:this._lastrefreshed}}}else{if(K.jobContentPO!==this._Defs.PersistenceOperation.READING&&K.workDirPO===this._Defs.PersistenceOperation.READING){if(this.workData.length===0){L.loading={contentLoading:false,workDirLoading:{status:true,lastrefreshed:this._lastrefreshed},workDirRefreshing:false}}else{L.loading={contentLoading:false,workDirLoading:{status:false,lastrefreshed:this._lastrefreshed},workDirRefreshing:true}}}else{if(K.jobContentPO!==this._Defs.PersistenceOperation.READING&&K.workDirPO!==this._Defs.PersistenceOperation.READING){this._lastrefreshed=new Date();L.loading={contentLoading:false,workDirLoading:{status:false,lastrefreshed:this._lastrefreshed}}}}}};t=function(K){if(K===false){this.$.adjobContent.isTransientWidget=false}else{this.$.adjobContent.isTransientWidget=true}};x=function(){this.observeStore({select:b.bind(this),onChange:m.bind(this),compareFunc:f.bind(this)});this.observeStore({select:G.bind(this),onChange:z.bind(this),compareFunc:f.bind(this)});this.observeStore({select:g.bind(this),onChange:J.bind(this),compareFunc:f.bind(this)});this.observeStore({select:E.bind(this),onChange:c.bind(this)});this.observeStore({select:this._AppSelectors.isTransientWidget,onChange:t.bind(this)})};r=function(){if(this.jobId){this.isReady.then(function(){F.apply(this);x.apply(this);this.boundJobActions.refreshJobData(this.jobId,true,true);this.$.adjobContent.store=this.store;this.$.adjobContent.jobId=this.jobId;this.fire("reduxready",{})}.bind(this))}};B.DS.SMAPoweredByViews=B.DS.SMAPoweredByViews||{};B.DS.SMAPoweredByViews.ADJobContentContainer=B.Polymer({is:"ad-job-content-container",properties:{isReady:{type:Promise},content:{type:Array,value:function(){return[]}},inputs:{type:Array,value:function(){return[]},observer:"objectsChanged"},outputs:{type:Array,value:function(){return[]},observer:"objectsChanged"},workData:{type:Array,value:function(){return[]},observer:"objectsChanged"},jobId:{type:String,observer:"jobIdChanged"}},ready:function(){return e.apply(this,arguments)},onDownloadContent:function(){return H.apply(this,arguments)},onDownloadDocuments:function(){return j.apply(this,arguments)},onGenerateResult:function(){return d.apply(this,arguments)},onUploadContent:function(){return v.apply(this,arguments)},onViewFile:function(){return A.apply(this,arguments)},onPreviewResult:function(){return a.apply(this,arguments)},jobIdChanged:function(){return r.apply(this,arguments)},objectsChanged:function(){return q.apply(this,arguments)},onAddTailAlert:function(){return n.apply(this,arguments)},onAddAlert:function(){return k.apply(this,arguments)},behaviors:[DS.SMAProcSP.SPBase,DS.SMAPoweredByViews.ADReduxBehaviour]})}(this));
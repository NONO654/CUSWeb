define("DS/SMAProcWebAuthoringUtils/ParameterUIUtil",["DS/SMAProcWebCMMUtils/SMAJSCMMParameterUtils","DS/SMAProcWebCMMUtils/SMAJSCMMUtils","DS/JSCMM/SMAJSCMMParameter","UWA/Utils","i18n!DS/SMAProcWebCMMUtils/assets/nls/SMAJSCMMDataFlowUtilsNLS"],function(b,g,a,c,f){function h(k,j){var i=[];Object.keys(k).forEach(function(l){var m=k.properties[k[l]];if(m&&m.value>=0&&(!j||j.indexOf(m.name)!==-1)){i.push(m.name)}});return i}function d(k,i){var j=[];if(i===undefined||(i&&i.length===0)){return k}j=k.filter(function(l){return i&&i.indexOf(l)!==-1});return j}var e={getValidModes:function(i){return h(g.Mode.client,i)},getValidTypes:function(i,j){if(i===g.Structure.client.properties[g.Structure.client.Array].name){return h(g.DataType.client,d(["Real","String","Boolean","Integer"],j))}else{if(i===g.Structure.client.properties[g.Structure.client.Scalar].name){return h(g.DataType.client,d(["Real","String","Boolean","Integer","Object","Timestamp"],j))}else{return h(g.DataType.client,j)}}},getValidStructures:function(i){return h(g.Structure.client,d(["Scalar","Array"],i))},getDefaultType:function(i){if(i.indexOf("Real")!==-1){return"Real"}else{return i[0]}},getDefaultMode:function(i){if(i.indexOf("In")!==-1){return"In"}else{return i[0]}},getDefaultStructure:function(j){var i;if(!j){i=this.getValidStructures()}else{i=j}if(i.indexOf("Scalar")!==-1){return"Scalar"}else{return i[0]}},validateParameterName:function(k,i,j){if(i===undefined||i===null||i===""){return{isValid:false,errorMsg:f["Parameter.TitleValidation.Empty"],validValue:b.nextParameterName(k,undefined,true)}}else{if(!b.checkParamNameAllowed(i)){return{isValid:false,errorMsg:f["Parameter.TitleValidation.Alphabets"],validValue:b.getValidatedParamName(i)}}else{if(b.isParameterWithNameExists(k,i)){return{isValid:false,errorMsg:f["Parameter.TitleValidation.Duplicate"],validValue:j||b.nextParameterName(k,undefined,true)}}else{return{isValid:true,validValue:i}}}}},validateChoicesOption:function(o){var n,j=[],m=true,l;if(o===undefined||o===null||o.length===0){return{isValid:m,validValue:[]}}else{n=o;if(n.length>0){for(var k=0;k<n.length;k++){if(j.indexOf(n[k])===-1){if(n[k].trim().length>0){j.push(n[k].trim())}}else{m=false;l="Duplicate choices are not allowed."}}}return{isValid:m,errorMsg:l,validArrayValue:j,validValue:j.join("\n")}}},getNextName:function(j,i){return b.nextParameterName(j,i,true)},getDataTypeChoicesAllowed:function(){return["Real","Integer","String"]},getDataTypeExpressionAllowed:function(){return["Real","Integer","String","Boolean","Timestamp"]},parseValueByType:function(i,j){var k=j;switch(i){case"Real":if(isNaN(j)||j===""){k="0.0"}else{if(j===Infinity){k=j}else{k=parseFloat(j).toString();if(k.search(/\./)<0){k+=".0"}}}break;case"Integer":if(isNaN(j)||j===""){k="0"}else{if(j===Infinity){k=j}else{k=parseInt(j).toString()}}break;default:break}return k},calculateDisplayValue:function(n){var j;if(n._getStructureName()==="Array"){var m=n.getNumberOfValues();var k;j=[];for(var l=0;l<m;l++){k="["+n._valueHelperFunctions.indexToSubscript_RowMajor(n.getDimensions(),l).toString()+"]";j[k]=n.getValue(l)}}else{if(n._getStructureName()==="Scalar"){switch(n.getDataType()){case g.DataType.client.Object:j=(n.getValue()&&(n.getValue().getFieldValue("title")||n.getValue()._data.displayName))||"";break;case g.DataType.client.Timestamp:j=new Date(Number(n.getValue()));j=j.toString().slice(4,24);break;case g.DataType.client.Real:j=e.parseValueByType(g.DataType.client.properties[n.getDataType()].name,n.getValue());break;default:j=n.getValue();break}}}return j},getDefaultValueByType:function(j){var i="";switch(j){case"Boolean":i=true;break;case"String":i="";break;case"Integer":i=0;break;case"Real":i=0;break;case"Timestamp":i=Number(new Date()).toString();break;case"Object":i=null;break;default:i="0.0"}return i},createParameter:function(i,l){var j=i.getPotentialParametersUpdateFlag();i.setPotentialParametersUpdateFlag(true);var k;if(b.isParameterWithNameExists(i,l.name,true)){return{success:false,errorMsg:f["Parameter.TitleValidation.Duplicate"]}}else{k=new a();this._updateParameter(k,l);b.addParameters([k],i)}i.setPotentialParametersUpdateFlag(j);return{success:true,parameter:k}},createParameters:function(q,o,m,l){var p=[],j,n=1,k=0,s,r;s=b.getPrefix(l);r=b.getNextParameterNameIndex(q,l,true)-1;if(m!==undefined&&!isNaN(m)){n=parseInt(m)}for(k=0;k<n;k+=1){j=new a();if(n!==1){o.name=s+(r+1)}this._updateParameter(j,o);p.push(j);r+=1}b.addParameters(p,q);return{success:true,parameters:p}},createDefaultParameter:function(i){var j=this.getDefaultStructure(this.getValidStructures());var k=this.getDefaultType(this.getValidTypes(j));var l=this.createParameter(i,{name:this.getNextName(i),mode:this.getDefaultMode(this.getValidModes()),structure:j,datatype:k,description:"",expression:"",choices:[],value:"0.0"});return l},cloneParameterWithMode:function(l,k,j){var i=b.cloneParameter(l);i.setParent(k);i.setId(c.getUUID());if(typeof j==="number"){i.setMode(j)}b.addParameter(i,k);return i},getContentChooserObjectByPLMObject:function(i){return i?{objectId:i.getPhysicalId(),objectType:i.getObjectType(),objectTitle:i.getName(),displayName:i.getName()}:undefined},isParameterWithNameExists:function(i,j){return b.isParameterWithNameExists(i,j)},modifyParameter:function(l,j,k){var i=b.modifyParameter(l);if(k){this._updateParameterProperty(i,j)}else{this._updateParameter(i,j,true)}return i},modifyParameters:function(k,j){var i=[];if(j.Mode===undefined){j.Mode=this.getDefaultMode(this.getValidModes())}k.forEach(function(m){var l=b.modifyParameter(m);l.setMode(g.Mode.client[j.Mode]);i.push(l)});return i},_updateParameterProperty:function(l,i){switch(i.name){case"Mode":l.setMode(g.Mode.client[i.value]);break;case"Value":var j=g.DataType.client.properties[l.getDataType()].name;var k=i.value;if(i.hasOwnProperty("index")){l.setValue(k,i.index)}else{this._setScalarParameterValue(l,j,i.value)}break;case"Name":l.setName(i.value);break;case"Expression":l.setExpression(i.value);break;case"Description":l.setDescription(i.value);break;case"Type":l.setDataType(g.DataType.client[i.value]);break;default:}},_setScalarParameterValue:function(l,j,k){if(j==="Object"){if(k){var i=b.getPLMObjectByContentChooserObject(k);l.setValue(i)}else{l.setValue(null)}}else{if(j==="Timestamp"){if(k){l.setValue(new Date(k))}else{l.setValue(new Date())}}else{if(j==="Boolean"){l.setValue((String(k).toLowerCase()==="true"))}else{if(j==="Real"||j==="Integer"){l.setValue(Number(k))}else{l.setValue(k.toString())}}}}},_updateParameter:function(o,q,l){var p=false;b.setUUIDToParameter(o);o.setName(q.name);o.setMode(g.Mode.client[q.mode]);o.setStructure(g.Structure[q.structure]);o.setDescription(q.description);p=l&&o.getDataType()!==g.DataType.client[q.datatype];o.setDataType(g.DataType.client[q.datatype]);if(q._appDataArray){b.setFormulationData(o,q._appDataArray)}if(q.structure==="Scalar"){o.setExpression(q.expression);o.setLimits(q.choices);o.setLimitType(g.LimitType.Choice);if(q.datatype==="Timestamp"){if(!q.value){o.setValue(new Date())}o.setValue(new Date(Number(q.value)))}else{if(q.datatype==="Object"){if(q.plmObject){o.setValue(b.getPLMObjectByContentChooserObject(q.plmObject))}else{o.setValue(null)}}else{if(q.datatype==="Boolean"){o.setValue((String(q.value).toLowerCase()==="true"))}else{if(q.datatype==="Real"||q.datatype==="Integer"){o.setValue(Number(q.value))}else{if(q.datatype==="String"){if(q.dataSubType===g.DataSubType.client.Multiline){o.setDataSubType(g.DataSubType.client.Multiline)}else{o.setDataSubType(g.DataSubType.client.None)}o.setValue(q.value.toString())}else{o.setValue(q.value.toString())}}}}}}else{if(q.structure==="Array"){var m=[];var k=[];k.push(parseInt(q.arraySize1));k.push(parseInt(q.arraySize2));k.push(parseInt(q.arraySize3));k.push(parseInt(q.arraySize4));for(var j=0;j<q.dimensions;j++){var n=k[j]>=1?k[j]:1;m.push(n)}if(l){o.setSizable(true);o.resize(m,!p);o.setSizable(q.resizableDims)}else{o.setSizable(q.resizableDims);o.setDimensions(m)}if((!l||p)&&!q._valueArray){b.initializeValuesForArrayParam(o)}}else{o.setParameters()}}}};return e});
/*!  COPYRIGHT DASSAULT SYSTEMES 2014   */
var byteArrayReader=function(a){this.buffer=a;this.currentPosition=0;this.readAt=function(b){return this.buffer[b]};this.length=function(){return buffer.length};this.getCurrentPosition=function(){return this.currentPosition};this.setPosition=function(b){this.currentPosition=b};this.read=function(){return this.buffer[this.currentPosition++]};this.readDouble=function(b,e){var c=new DataView(buffer.buffer);var d=c.getFloat64(b,true);return d};this.readUcompressedInt=function(b){if(b){return(this.read()<<24|this.read()<<16|this.read()<<8|this.read())>>>0}else{return(this.read()|this.read()<<8|this.read()<<16|this.read()<<24)>>>0}};this.readInt=function(b){if(b){return this.read()<<24|this.read()<<16|this.read()<<8|this.read()}else{return this.read()|this.read()<<8|this.read()<<16|this.read()<<24}};this.clone=function(){return new byteArrayReader(this.buffer)};this.getDataViews=function(c,b){views=[];views.push({dataView:new DataView(this.buffer.buffer,c,b),buffer:this.buffer,offset:c});return views}};var multiTabDecorations=function(){var b=2048;var e=null;var a=[];var c=0;var d=0;this.addDecoration=function(j){if(!e){e=new Uint8Array(b);a=[e]}var g=c;if((d+j.length)>b){var f=b-d;var h=(d+j.length)-b;this.writeDecoration(j,0,f);d=0;e=new Uint8Array(b);a.push(e);this.writeDecoration(j,f,h)}else{this.writeDecoration(j,0,j.length)}c+=j.length;return g+1};this.writeDecoration=function(h,j,g){for(var f=0;f<g;f++){e[d++]=h[j+f]}};this.getConcatenatedBlocks=function(){if(c==0){return null}var f=new Uint8Array(c);var g=0;for(var l=0;l<a.length;l++){for(var h=0;h<b;h++){f[g++]=a[l][h]}}return f}};define("DS/Formats/CGRFile",["DS/Mesh/Mesh","DS/Mesh/ThreeJS_Base"],function(bg,aq){var g=false;var aN=false;var aY=false;var cb=true;var D=true;var a4=false;var bK=false;var h=false;var aP=true;var b5=210042110;var V=true;var o=new Float32Array(100);var bN=new Int16Array(100);var az=new Uint8Array(100);var aO=4278190080;var f=4128768;var b=61440;var G=3840;var R=255;var bT={UNDEFINED:255,FACE3:80,PLANARFACE3:81,LINE3:82,POLYLINE3:83,MARKER3:84,FIXEDARROW:85,FIXEDPLAN:86,CYLINDER:87,CURVEDPIPE:88,ANNOTEXT3:89,EDGE3:96,ARROW3:119,INTERNALSMOOTHEDGE3:134,ARCELLIPSE3:156,ARCCIRCLE3:157,IMAGEPIXEL3:160,EDGECRV3:162};var p=new Map([["segoeuiz.ttf",{fontName:"Segoe UI",italic:true,bold:true}],["segoeui.ttf",{fontName:"Segoe UI",italic:false,bold:false}],["segoeuib.ttf",{fontName:"Segoe UI ",italic:false,bold:true}],["segoeuii.ttf",{fontName:"Segoe UI ",italic:true,bold:false}],["seguisb.ttf",{fontName:"Segoe UI Semibold",italic:false,bold:false}],["DSISO1.otf",{fontName:"DS ISO 1",italic:false,bold:false}],["DSISO1I.otf",{fontName:"DS ISO 1",italic:true,bold:false}],["DSISO1BI.otf",{fontName:"DS ISO 1",italic:true,bold:true}],["DSISO1B.otf",{fontName:"DS ISO 1",italic:false,bold:true}],["DroidSerif-Bold.ttf",{fontName:"Droid Serif",italic:false,bold:true}],["DroidSerif.ttf",{fontName:"Droid Serif",italic:false,bold:false}],["DroidSerif-Italic.ttf",{fontName:"Droid Serif",italic:true,bold:false}],["3ds Bold Italic.ttf",{fontName:"3ds",italic:true,bold:true}],["3ds Bold.ttf",{fontName:"3ds",italic:false,bold:true}],["3ds Italic.ttf",{fontName:"3ds",italic:true,bold:false}],["3ds Regular.ttf",{fontName:"3ds",italic:false,bold:false}]]);var aH=1;var aZ={NORMAL:0,STATIC:1,EXCLUDE:2,EXCLUDE_STATIC:3,NOZ:4,NOZ_STATIC:5,EXCLUDE_NOZ:6,EXCLUDE_NOZ_STATIC:7,FIXED_SIZE_STATIC:8};var ad={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5,};var ax={LAYER_MAX:4294967295,LAYER_MAX_MINUS_ONE:4294967294,STREAM_NONE:0,STREAM_MATERIAL:1,STREAM_INHERIT_INT:2,STREAM_INHERIT_UINT:4,STREAM_INHERIT_ULONG:8,STREAM_LAYER_INT:16,STREAM_LAYER_UINT:32,STREAM_LAYER_ULONG:64,STREAM_UVTRANSFO:128,STREAM_MAPPING_INFO:256,STREAM_ALL_INT:403,STREAM_ALL_UINT:421,STREAM_ALL_ULONG:457};var al=[1,1,2,3,4,5,6,7,8];var X=function(cp,cq){this.name=cq;this.conversion=false;this.version=0;this.bitBoolean=0;this.bitPacking=0;this.intPacking=0;this.gasPacking=0;this.global_gas=[];var cn=true;this.expandCGR=false;var cu=false;var ct=[];this.isInherit=false;this.textures=new Y();this.materials=new Y();this.fakeMultiRep=new Y();this.reps=[];this.reps[aZ.NORMAL]=new Y();this.reps[aZ.EXCLUDE]=new Y();this.reps[aZ.EXCLUDE_NOZ]=new Y();this.reps[aZ.EXCLUDE_STATIC]=new Y();this.reps[aZ.EXCLUDE_NOZ_STATIC]=new Y();this.reps[aZ.NOZ]=new Y();this.reps[aZ.NOZ_STATIC]=new Y();this.reps[aZ.STATIC]=new Y();this.reps[aZ.FIXED_SIZE_STATIC]=new Y();this.axisSystems=new Y();this.sgRep=[];this.nbRep=0;this.decorations=new multiTabDecorations();this.refPlanes=new Y();this.texts=new Y();this.currentMatrix=[];this.staticMode=[];this.fixedSizeMode=false;this.multiRefNode=new Y();this.buffer=cp;this.numberOfVertices=0;this.cgrContainer=null;this.bitContainer=0;this.bitsRemaining=0;this.nbBitsPerVertex=0;var co=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215,33554431,67108863,134217727,268435455,536870911,1073741823,2147483647];var cs=0;var cr=[0,0,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9];this.isLightScenegraph=function(){return cu};this.createMatrix3=function(cv){var cw=[cv[0],cv[1],0,cv[2],cv[3],0,cv[4],cv[5],1];return cw};this.addReps=function(cE,cy,cz,cD,cv){var cB=0;var cA=0;var cC=cD?1:0;cB=cz?1:0;cA=cy?1:0;var cw=cB<<2|cC<<1|cA;if(cv){cw=8}if(this.expandCGR){cw=0}var cx=this.reps[cw].add(cE);return{renderType:cw,indice:cx}};this.setReps=function(cv){this.reps=cv};this.getAllReps=function(){return this.reps};this.initReps=function(){this.reps=[];this.reps[aZ.NORMAL]=new Y();this.reps[aZ.EXCLUDE]=new Y();this.reps[aZ.EXCLUDE_NOZ]=new Y();this.reps[aZ.EXCLUDE_STATIC]=new Y();this.reps[aZ.EXCLUDE_NOZ_STATIC]=new Y();this.reps[aZ.FIXED_SIZE_STATIC]=new Y();this.reps[aZ.NOZ]=new Y();this.reps[aZ.NOZ_STATIC]=new Y();this.reps[aZ.STATIC]=new Y()};this.getReps=function(cw,cv){return this.reps[cv].get(cw)};this.getBytesRemain=function(){return this.buffer.getBytesRemain()};this.readString=function(cx){var cv=new String();for(var cw=0;cw<cx;cw++){var cy=String.fromCharCode(this.buffer.read());cv+=cy}return cv};this.readStringWithLength=function(cx){var cv=new String();var cx=this.readCompressedInt();for(var cw=0;cw<cx;cw++){var cy=String.fromCharCode(this.buffer.read());cv+=cy}return cv};this.readUnicodeString=function(cy){var cv=new String();for(var cw=0;cw<cy-1;cw++){var cx=this.readUnsignedShort();cv+=String.fromCharCode(cx)}this.readUnsignedShort();return cv};this.setCurrentPosition=function(cv){this.buffer.setPosition(cv)};this.getCurrentPosition=function(){return this.buffer.getCurrentPosition()};this.skip=function(cv){this.buffer.setPosition(this.buffer.getCurrentPosition()+cv)};this.readClassName=function(){var cv=this.readUnsignedChar();return cv};this.getUnstreamer=function(cv){switch(cv){case 97:return new z();break;case 98:return new j();break;case 99:return new bE();break;case 100:return new b4();break;case 101:return new bk();break;case 102:return new P();break;case 103:return new z();break;case 104:return new bh();break;case 112:return new ck();break;case 113:return new bL();break;case 114:return new z();break;case 115:return new z();break;case 116:return new ce();break;case 120:return new bb();break;case 137:return new bP();break;case 145:return new z();break;case 146:return new z();break;case 147:return new bf();break;case 148:return new z();break;case 149:return new ay();break;case 150:return new z();break;case 152:return new cc();break;case 153:return new z();break;case 154:return new ap();break;case 158:return new z();break;case 159:return new z();break;case 161:return new bm();break;case 163:return new bU();break;case 170:return new ac();break;case 171:return new aS();break;case 172:return new bw();break;case 173:return new a2();break;case 174:return new bO();break;case 175:return new C();break;case 176:return new aj();break;case 179:return new z();break;case 181:return new z();break;case 182:return new ah();break;case 183:return new bv();break;case 184:return new z();break;case 185:return new bW();break;case 186:return new v();break;case 188:return new z();break;case 189:return new z();break;case 255:return new z();break;default:this.error="file is corrupted.  unknown className..."+cv;return null;break}};this.readGraphicAttributeSet=function(){return new bn(this.readUncompressedInt(),this.readUncompressedInt())};this.readMatrix=function(){var cC=[];var cA=0;if(this.version>=210021610){var cz=this.readCompressedInt();var cx=this.readUnsignedChar();var cB=[];this.readDoubles(cB,cx);var cv=0;var cw=0;for(cA=0,cv=0;cA<16;cA++){cw=(cz&(3<<2*cA))>>2*cA;switch(cw){case 0:cC[cA]=cB[cv++];break;case 1:case -1:cC[cA]=0;break;case -2:case 2:cC[cA]=1;break;case 3:case -3:cC[cA]=-1;break;default:break}}}else{for(var cA=0;cA<16;++cA){cC.push(this.readFloat())}}var cy=new aq.Matrix4();cy.set(cC[0],cC[4],cC[8],cC[12],cC[1],cC[5],cC[9],cC[13],cC[2],cC[6],cC[10],cC[14],cC[3],cC[7],cC[11],cC[15]);return cy};this.read2DMatrix=function(){var cx=[];var cw=0;for(var cw=0;cw<16;++cw){cx.push(this.readFloat())}var cv=new aq.Matrix4();cv.set(cx[0],cx[4],cx[8],cx[12],cx[1],cx[5],cx[9],cx[13],cx[2],cx[6],cx[10],cx[14],cx[3],cx[7],cx[11],cx[15]);return cv};this.readFloatArray=function(cw,cv,cx){this.buffer.readFloatArray(cw,cv,cx,this.conversion)};this.readFloatArrayBuffer=function(cv,cw){this.buffer.readFloatArrayBuffer(cv,cw,this.conversion)};this.readDouble=function(){var cv=this.buffer.readDouble(this.conversion);return cv};this.readDoubles=function(cv,cx){for(var cw=0;cw<cx;++cw){cv.push(this.readDouble())}};this.getNumberOfVertices=function(){return this.numberOfVertices};this.setNumberOfVertices=function(cw){this.numberOfVertices=cw;if(this.bitPacking){if(cw<500){cs=cr[this.numberOfVertices];return}cs=0;var cv=cw;do{++cs}while(cv>>=1)}};this.setContainer=function(cv){this.cgrContainer=cv};this.getContainer=function(){return this.cgrContainer};this.readBits=function(cw){var cx;if(cw<=this.bitsRemaining){cx=this.bitContainer&co[cw];this.bitContainer>>=cw;this.bitsRemaining-=cw}else{if(cw<=32){cx=0;var cy=cw;cx|=this.bitContainer&co[this.bitsRemaining];cy-=this.bitsRemaining;this.bitContainer=this.readUncompressedInt();cx|=(this.bitContainer&co[cy])<<this.bitsRemaining;this.bitContainer>>=cy;this.bitsRemaining=32-cy}else{var cv=0;var cy=cw;do{while(this.bitsRemaining&&cy){cx|=(this.bitContainer&1)<<cv++;bitContainer>>=1;this.bitsRemaining--;cy--}if(cy){this.bitContainer=this.readUncompressedInt();this.bitsRemaining=32}}while(cy)}}return cx};this.readBit=function(){var cv=0;if(this.bitsRemaining){cv=this.bitContainer&1;this.bitContainer>>=1;this.bitsRemaining--;return cv}else{this.bitContainer=this.readUncompressedInt();cv=this.bitContainer&1;this.bitContainer>>=1;this.bitsRemaining=31;return cv}};this.readBoolean=function(){var cv;if(this.bitBoolean){cv=this.readBit()}else{cv=this.readUnsignedChar()}return cv};this.readPositions=function(cz,cE,cv){var cL=3*cz;var cx=this.readBoolean();if(cx){this.readFloatArray(cL,3*cE,cv)}else{var cH=Math.ceil(cE/4);var cA=this.buffer.getByteView(cH,az);var cK=this.readCompressedInt();if(cK>o.length){o=new Float32Array(cK)}this.readFloatArrayBuffer(cK,o);var cw=0;var cI=0;var cG=0;var cF=0;var cD=0;var cC=0;var cJ=0;for(var cB=0;cB<cE;cB++){if(cI==0){cJ=(cA[cw]&3)}if(cI==1){cJ=(cA[cw]&12)>>2}if(cI==2){cJ=(cA[cw]&48)>>4}if(cI==3){cJ=(cA[cw]&192)>>6;cI=-1;cw++}cI++;var cy=3*cB;if(cJ==0){cv[cL++]=o[cG];cv[cL++]=o[cG+1];cv[cL++]=o[cG+2];cF=o[cG];cD=o[cG+1];cC=o[cG+2];cG+=3}else{if(cJ==2){cv[cL++]=cF;cv[cL++]=cD;cv[cL++]=o[cG];cC=o[cG];cG++}else{if(cJ==3){cv[cL++]=cF;cv[cL++]=o[cG];cv[cL++]=o[cG+1];cD=o[cG];cC=o[cG+1];cG+=2}else{cv[cL++]=cF;cv[cL++]=cD;cv[cL++]=cC}}}}}};this.readOldPositionsArrayBuffer=function(cF,cv,cA){var cx=this.readBoolean();if(cx){for(var cD=0;cD<cF;++cD){cv[cA++]=this.readFloat()}}else{var cI=Math.ceil(cF/12);var cB=new Uint8Array(cI);this.readBytes(cI,cB);var cK=this.readCompressedUInt();var cz=new Float32Array(cK);for(var cD=0;cD<cK;++cD){cz[cD]=this.readFloat()}var cw=0;var cJ=0;var cH=0;var cG=0;var cE=0;var cC=0;for(var cD=0;cD<cF/3;cD++){if(cJ==0){flagvalue=(cB[cw]&3)}if(cJ==1){flagvalue=(cB[cw]&12)>>2}if(cJ==2){flagvalue=(cB[cw]&48)>>4}if(cJ==3){flagvalue=(cB[cw]&192)>>6;cJ=-1;cw++}cJ++;var cy=3*cD;if(flagvalue==0){cv[cA*3+cy]=cz[cH];cv[cA*3+cy+1]=cz[cH+1];cv[cA*3+cy+2]=cz[cH+2];cG=cz[cH];cE=cz[cH+1];cC=cz[cH+2];cH+=3}else{if(flagvalue==2){cv[cA*3+cy]=cG;cv[cA*3+cy+1]=cE;cv[cA*3+cy+2]=cz[cH];cC=cz[cH];cH++}else{if(flagvalue==3){cv[cA*3+cy]=cG;cv[cA*3+cy+1]=cz[cH];cv[cA*3+cy+2]=cz[cH+1];cE=cz[cH];cC=cz[cH+1];cH+=2}else{cv[cA*3+cy]=cG;cv[cA*3+cy+1]=cE;cv[cA*3+cy+2]=cC}}}}}};this.readPositionsArrayBuffer=function(cF,cv,cA){var cx=this.readBoolean();if(cx){for(var cD=0;cD<3*cF;++cD){cv[cA*3+cD]=this.readFloat()}}else{var cI=Math.ceil(cF/4);var cB=new Uint8Array(cI);this.readBytes(cI,cB);var cL=this.readCompressedInt();var cz=new Float32Array(cL);for(var cD=0;cD<cL;++cD){cz[cD]=this.readFloat()}var cw=0;var cJ=0;var cH=0;var cG=0;var cE=0;var cC=0;var cK=0;for(var cD=0;cD<cF;cD++){if(cJ==0){cK=(cB[cw]&3)}if(cJ==1){cK=(cB[cw]&12)>>2}if(cJ==2){cK=(cB[cw]&48)>>4}if(cJ==3){cK=(cB[cw]&192)>>6;cJ=-1;cw++}cJ++;var cy=3*cD;if(cK==0){cv[cA*3+cy]=cz[cH];cv[cA*3+cy+1]=cz[cH+1];cv[cA*3+cy+2]=cz[cH+2];cG=cz[cH];cE=cz[cH+1];cC=cz[cH+2];cH+=3}else{if(cK==2){cv[cA*3+cy]=cG;cv[cA*3+cy+1]=cE;cv[cA*3+cy+2]=cz[cH];cC=cz[cH];cH++}else{if(cK==3){cv[cA*3+cy]=cG;cv[cA*3+cy+1]=cz[cH];cv[cA*3+cy+2]=cz[cH+1];cE=cz[cH];cC=cz[cH+1];cH+=2}else{cv[cA*3+cy]=cG;cv[cA*3+cy+1]=cE;cv[cA*3+cy+2]=cC}}}}}};this.readNormalsArrayBuffer=function(cw,cM,cA){if(cw==0){return}var cF=1/32767;if(this.version>1101220){var cG=this.readCompressedInt();if(cG>bN.length){bN=new Int16Array(cG)}this.buffer.readShortArrayBuffer(cG,bN,this.conversion);var cQ=Math.ceil(cw/2);if(cQ>az.length){az=new Uint8Array(cQ)}var cP=this.buffer.getByteView(cQ,az);var cJ=-1;var cI=0;var cE=0;var cD=0;var cx=3*cw;var cN=cA*3;var cz;for(var cH=0;cH<cx;cH++){if(cH%2){cz=(cP[cJ]&240)>>4}else{cz=(cP[++cJ]&15)}switch(cz){case 0:cE=cM[cN+1]=bN[cI++]*cF;cD=cM[cN+2]=bN[cI++]*cF;cM[cN]=Math.sqrt(1-(cE*cE+cD*cD));break;case 1:cE=cM[cN+1]=bN[cI++]*cF;cD=cM[cN+2]=bN[cI++]*cF;cM[cN]=-Math.sqrt(1-(cE*cE+cD*cD));break;case 2:cE=cM[cN]=bN[cI++]*cF;cD=cM[cN+2]=bN[cI++]*cF;cM[cN+1]=Math.sqrt(1-(cE*cE+cD*cD));break;case 3:cE=cM[cN]=bN[cI++]*cF;cD=cM[cN+2]=bN[cI++]*cF;cM[cN+1]=-Math.sqrt(1-(cE*cE+cD*cD));break;case 4:cE=cM[cN]=bN[cI++]*cF;cD=cM[cN+1]=bN[cI++]*cF;cM[cN+2]=Math.sqrt(1-(cE*cE+cD*cD));break;case 5:cE=cM[cN]=bN[cI++]*cF;cD=cM[cN+1]=bN[cI++]*cF;cM[cN+2]=-Math.sqrt(1-(cE*cE+cD*cD));break;case 6:cM[cN]=1;cM[cN+1]=0;cM[cN+2]=0;break;case 7:cM[cN]=-1;cM[cN+1]=0;cM[cN+2]=0;break;case 8:cM[cN]=0;cM[cN+1]=1;cM[cN+2]=0;break;case 9:cM[cN]=0;cM[cN+1]=-1;cM[cN+2]=0;break;case 10:cM[cN]=0;cM[cN+1]=0;cM[cN+2]=1;break;case 11:cM[cN]=0;cM[cN+1]=0;cM[cN+2]=-1;break}cN=cN+3}}else{var cC=[];var cF=1/32767;var cL=cw/3;this.readShortArray(2*cL,cC);var cQ=Math.ceil(cL/8);var cP=new Uint8Array(cQ);cP=this.buffer.getByteView(cQ,az);var cv=0,cJ=-1;var cE,cy;var cB;for(var cK=0,cI=0,cH=0;cK<cw;cK+=3,cI+=2,cH++){cM[cK]=cC[cI]*cF;cM[cK+1]=cC[cI+1]*cF;cB=1-(cM[cK]*cM[cK]+cM[cK+1]*cM[cK+1]);cv=cH%8;if(cv==0){cJ++}if(cB<=0){cy=0}else{if(cB<=0.03){cE=0.05}else{cE=0.25+cB*(0.25+1/(1+cB))}var cO;while(1){cy=0.5*(cE+cB/cE);cO=cE-cy;if(cO<cF&&cO>-cF){cE=cy;break}cE=cy}}cM[cK+2]=cP[cJ]&(1<<cv)?-cy:cy}}};this.readNormals=function(cA,cB,cv){var cK=3*cA;if(cB==0){return}var cH=1/32767;if(this.version>1101220){var cD=this.readCompressedInt();if(cD>bN.length){bN=new Int16Array(cD)}this.buffer.readShortArrayBuffer(cD,bN,this.conversion);var cF=Math.ceil(cB/2);if(cF>az.length){az=new Uint8Array(cF)}var cC=this.buffer.getByteView(cF,az);var cz=-1;var cy=0;var cJ=0;var cI=0;var cE=3*cB;var cG=cA;var cx;for(var cw=0;cw<cE/3;cw++){if(cw%2){cx=(cC[cz]&240)>>4}else{cx=(cC[++cz]&15)}switch(cx){case 0:cJ=bN[cy++]*cH;cI=bN[cy++]*cH;cv[cK++]=Math.sqrt(1-(cJ*cJ+cI*cI));cv[cK++]=cJ;cv[cK++]=cI;break;case 1:cJ=bN[cy++]*cH;cI=bN[cy++]*cH;cv[cK++]=-Math.sqrt(1-(cJ*cJ+cI*cI));cv[cK++]=cJ;cv[cK++]=cI;break;case 2:cJ=bN[cy++]*cH;cI=bN[cy++]*cH;cv[cK++]=cJ;cv[cK++]=Math.sqrt(1-(cJ*cJ+cI*cI));cv[cK++]=cI;break;case 3:cJ=bN[cy++]*cH;cI=bN[cy++]*cH;cv[cK++]=cJ;cv[cK++]=-Math.sqrt(1-(cJ*cJ+cI*cI));cv[cK++]=cI;break;case 4:cJ=bN[cy++]*cH;cI=bN[cy++]*cH;cv[cK++]=cJ;cv[cK++]=cI;cv[cK++]=Math.sqrt(1-(cJ*cJ+cI*cI));break;case 5:cJ=bN[cy++]*cH;cI=bN[cy++]*cH;cv[cK++]=cJ;cv[cK++]=cI;cv[cK++]=-Math.sqrt(1-(cJ*cJ+cI*cI));break;case 6:cv[cK++]=1;cv[cK++]=0;cv[cK++]=0;break;case 7:cv[cK++]=-1;cv[cK++]=0;cv[cK++]=0;break;case 8:cv[cK++]=0;cv[cK++]=1;cv[cK++]=0;break;case 9:cv[cK++]=0;cv[cK++]=-1;cv[cK++]=0;break;case 10:cv[cK++]=0;cv[cK++]=0;cv[cK++]=1;break;case 11:cv[cK++]=0;cv[cK++]=0;cv[cK++]=-1;break}cG=cG+3}}};this.readTextures=function(cB,cz,cC,cw){var cA=cC*cz;if(cC==3){this.readFloatArray(3*cB,cA,cw);return}var cy=0;var cx=0;var cv=new Float32Array(cA);this.readFloatArray(0,cA,cv);if(cC==1){for(cy=0;cy<cA;cy++){cw[3*cB+cx++]=cv[cy];cw[3*cB+cx++]=0;cw[3*cB+cx++]=0}}else{if(cC==2){for(cy=0;cy<cA;cy+=2){cw[3*cB+cx++]=cv[cy];cw[3*cB+cx++]=cv[cy+1];cw[3*cB+cx++]=0}}}};this.unpackcArray=function(cw,cy,cx){if(this.bitPacking){for(var cv=0;cv<cw;++cv){cy[cv+cx]=this.readBits(cs)}return}else{if(this.version>=1100600){if(this.numberOfVertices<256){this.buffer.readBytes(cx,cw,cy);return}}}if(this.numberOfVertices<65536){this.buffer.readUnsignedShortArray(cx,cw,cy,false)}else{if(this.numberOfVertices<16777216){this.buffer.unpackc24(cx,cw,cy)}else{for(var cv=0;cv<cw;++cv){cy[cv+cx]=this.readCompressedInt()}}}};this.unpackc=function(){if(this.bitPacking){return this.readBits(cs)}if(this.version>=1100600){if(this.numberOfVertices<256){return this.readUnsignedChar()}}if(this.numberOfVertices<65536){return(this.readUnsignedChar()<<8&65280)|(this.readUnsignedChar()&255)}else{if(this.numberOfVertices<16777216){return(this.readUnsignedChar()<<16&16711680)|(this.readUnsignedChar()<<8&65280)|(this.readUnsignedChar()&255)}else{return this.readCompressedInt()}}};this.getFixMode=function(){return this.fixedSizeMode};this.setFixMode=function(cv){this.fixedSizeMode=cv};this.getStaticMode=function(){if(this.staticMode.length){var cv=this.staticMode[this.staticMode.length-1];if(cv){return cv}}return null};this.pushStaticMode=function(cv){this.staticMode.push(cv)};this.popStaticMode=function(){this.staticMode.pop()};this.getGAS=function(){if(this.global_gas.length){return this.global_gas[this.global_gas.length-1].inherited}};this.pushGAS=function(cz,cy){var cA,cB=0;if(this.global_gas.length){var cv=this.global_gas[this.global_gas.length-1];cB=cv.inh_mode;cA=cv.inherited;if(cB&4){cz.setColor(cA.getColor());var cw=cA.getRGBAColor();cz.setRGBAColorRGBChannel(cw[0],cw[1],cw[2])}if(cB&4096){var cw=cA.getRGBAColor();cz.setRGBAColorAlphaChannel(cw[3])}if(cB&16){cz.setLineThickness(cA.getLineThickness())}if(cB&64){cz.setLinetype(cA.getLinetype())}if(
/*!(current_mode)*/
1){var cx=cA.isHidden();if(cx){cz.setShowMode(cx)}}}this.global_gas.push({inh_mode:(cB|cy),inherited:cz});return cz};this.popGAS=function(){return this.global_gas.pop()};this.popMatId=function(){if(ct.length>0){var cv=ct.pop();if(cv.inherit){this.isInherit=false}return cv}else{return{file:"",id:-1}}};this.pushMatId=function(cA,cz,cy){var cv=ax.LAYER_MAX;if(ct.length){var cx=ct[ct.length-1];cv=cx.layer}if(cy!==cv){if((cy<cv)&&(cz!==0)){var cw=true;if(this.isInherit==true){cw=false}this.isInherit=true;ct.push({file:cA.file,id:cA.id,inherit:cw,layer:cy})}else{var cx=ct[ct.length-1];if(cx){ct.push({file:cx.file,id:cx.id,inherit:false,layer:cx.layer})}}}else{if((cz==2)||(cz==1&&!this.isInherit)){var cw=true;if(this.isInherit==true){cw=false}this.isInherit=true;ct.push({file:cA.file,id:cA.id,inherit:cw,layer:cy})}else{if(!this.isInherit&&cz==0){ct.push({file:"",id:-1,inherit:false,layer:cy})}else{var cx=ct[ct.length-1];ct.push({file:cx.file,id:cx.id,inherit:false,layer:cx.layer})}}}};this.check=function(){if(ct.length!=0){console.warn("material stack length = "+ct.length)}if(this.global_gas.length!=0){console.warn("GAS stack length = "+this.global_gas.length)}if(this.currentMatrix.length!=0){console.warn("currentMatrix stack length = "+this.currentMatrix.length)}};this.pushMatrix=function(cw){var cv=this.currentMatrix[this.currentMatrix.length-1];var cx;if(cv==null){cx=cw}else{cx=new aq.Matrix4();cx.multiplyMatrices(cv,cw)}this.currentMatrix.push(cx);return cx};this.popMatrix=function(){return this.currentMatrix.pop()};this.getLightDataStreaming=function(){return cn};this.setLightDataStreaming=function(cv){cn=cv};this.copyStreamerInheritance=function(cv){cv.setLightDataStreaming(this.getLightDataStreaming());cv.conversion=this.conversion;cv.version=this.version;cv.global_gas=this.global_gas;cv.textures=this.textures;cv.materials=this.materials;cv.decorations=this.decorations;cv.sgRep=this.sgRep;cv.nbRep=this.nbRep};this.getCurrentMatrix=function(){if(this.currentMatrix.length!=0){return this.currentMatrix[this.currentMatrix.length-1]}return null};this.getCurrentMatId=function(){var cv=ct[ct.length-1];if(cv){return{file:cv.file,id:cv.id}}return null}};X.prototype.readFloat=function(){return this.buffer.readFloat(this.conversion)};X.prototype.readUnsignedChar=function(){return this.buffer.read()};X.prototype.readBytes=function(cn,cp){for(var co=0;co<cn;co++){cp[co]=this.buffer.read()}};X.prototype.readShortArray=function(cn,co){this.buffer.readShortArray(0,cn,co,this.conversion)};X.prototype.readUnsignedShort=function(){if(this.conversion){return this.buffer.read()<<8|this.buffer.read()}else{return this.buffer.read()|this.buffer.read()<<8}};X.prototype.readShort=function(){var co=this.buffer.read();var cn=this.buffer.read();if(this.conversion){var cp=(co&127)<<8|cn;cp=cp-((co&128)<<8);return cp}else{var cp=(cn&127)<<8|co;cp=cp-((cn&128)<<8);return cp}};X.prototype.readUncompressedULong=function(){return this.buffer.readUncompressedULong(this.conversion)};X.prototype.readUncompressedUInt=function(){return this.buffer.readUncompressedInt(this.conversion)};X.prototype.readUncompressedInt=function(){return this.buffer.readInt(this.conversion)};X.prototype.readUncompressedIntArray=function(co,cp){for(var cn=0;cn<co;cn++){cp[cn]=this.readUncompressedInt()}};X.prototype.readCompressedUInt=function(){if(this.intPacking){return this.readCompressedInt()}if(this.version>=1101410){var cn=this.readUnsignedChar();if(cn==255){return this.buffer.readInt(this.conversion)}else{return cn}}else{return this.buffer.readInt(this.conversion)}};X.prototype.readCompressedInt=function(){if(this.version>=1100600){var cn=this.buffer.read();if(cn<255){return cn}return this.buffer.readInt(this.conversion)}else{return this.buffer.readInt(this.conversion)}};var bn=function(co,cn){this.set=co||0;this.rgba=cn||0};bn.prototype={constructor:bn,setColor:function(cn){this.set&=(~(255<<24));this.set|=(cn&255)<<24},setRGBAColorRGBChannel:function(cp,co,cn){this.rgba&=(~(16777215<<8));this.rgba|=((cp<<16|co<<8|cn)&16777215)<<8},setRGBAColorAlphaChannel:function(cn){this.rgba&=(~(255));this.rgba|=(cn&255)},setLinetype:function(cn){this.set&=(~(63<<18));this.set|=(cn&63)<<18},setType:function(cn){this.set&=(~(3<<4));this.set|=(cn&3)<<4},setShowMode:function(cn){this.set&=(~(1<<3));this.set|=(cn&1)<<3},setLineThickness:function(cn){this.set&=(~(63<<12));this.set|=(cn&63)<<12},getColor:function(){return((this.set>>24)&255)},getRGBAColor:function(){var cn=[];cn[0]=((this.rgba>>24)&255);cn[1]=((this.rgba>>16)&255);cn[2]=((this.rgba>>8)&255);cn[3]=(this.rgba&255);return cn},getDisplayedColor:function(){if(this.getColor()==255){return this.getRGBAColor()}else{var cn=[];switch(this.getColor()){case 254:case 253:cn[0]=0;cn[1]=0;cn[2]=0;cn[3]=255;break;case 252:cn[0]=62;cn[1]=102;cn[2]=85;cn[3]=255;break;case 251:case 250:cn[0]=255;cn[1]=128;cn[2]=0;cn[3]=255;break;case 249:cn[0]=0;cn[1]=0;cn[2]=0;cn[3]=255;break;case 248:cn[0]=255;cn[1]=255;cn[2]=255;cn[3]=255;break;case 247:cn[0]=255;cn[1]=0;cn[2]=0;cn[3]=255;break;case 246:cn[0]=0;cn[1]=255;cn[2]=0;cn[3]=255;break;case 245:cn[0]=0;cn[1]=0;cn[2]=255;cn[3]=255;break;case 244:cn[0]=255;cn[1]=255;cn[2]=0;cn[3]=255;break;case 243:cn[0]=255;cn[1]=0;cn[2]=255;cn[3]=255;break;case 242:cn[0]=0;cn[1]=255;cn[2]=255;cn[3]=255;break;case 241:cn[0]=0;cn[1]=255;cn[2]=0;cn[3]=255;break;case 240:cn[0]=255;cn[1]=0;cn[2]=0;cn[3]=255;break;case 239:cn[0]=255;cn[1]=0;cn[2]=0;cn[3]=255;break;default:cn[0]=0;cn[1]=0;cn[2]=0;cn[3]=255;break}return cn}},getLinetype:function(){return((this.set>>18)&63)},getLineThickness:function(){var cn=((this.set>>12)&63);if(cn>al.length){cn=1}else{cn=al[cn]}return cn},getType:function(){return((this.set>>4)&3)},isNoZ:function(){return(this.getType()==0)},isSolid:function(){if(this.getType()==3){return 1}return 0},isHidden:function(){return((this.set>>3)&1)},isTransparent:function(){return((this.set>>7)&1)},clone:function(){return new bn(this.set,this.rgba)}};var a=function(ct){var cu=ct.readUncompressedInt(false);var cr=4294967295&ct.readUncompressedInt(false);cr|=(4294967295&ct.readUncompressedInt(false))<<32;var co=4294967295&ct.readUncompressedInt(false);co|=(4294967295&ct.readUncompressedInt(false))<<32;if(!cd){return}var cB=4294967295&ct.readUncompressedInt(false);cB|=(4294967295&ct.readUncompressedInt(false))<<32;var cq=4294967295&ct.readUncompressedInt(false);cq|=(4294967295&ct.readUncompressedInt(false))<<32;var cA=ct.readUncompressedInt(false);var cv=ct.readUncompressedInt(false);var cz=ct.readUncompressedInt(false);var cy=ct.readUncompressedInt(false);var cx=ct.readUncompressedInt(false);var cs=new Uint8Array(8);var cw=ct.readBytes(8,cs);var cn=ct.readUncompressedInt(false);var cp=ct.readUncompressedInt(false)};var bA=function(cn){this.offset=cn.readUncompressedInt(false);this.length=cn.readUncompressedInt(false);var cp=cn.readUncompressedInt(false);this.beginPos=cn.readUncompressedInt(false);var co=cn.readUncompressedInt(false)};var s=function(ct,cq){var cs=ct.readUncompressedInt(false);this.id=ct.readUncompressedInt(false);var cu=ct.readUnsignedShort(false);var cp=new a(ct);var co=ct.readUncompressedInt(false);this.blocs=[];var cw=[];var cv;var cr;if(co>0){for(var cn=0;cn<co;++cn){this.blocs.push(new bA(ct))}}if(cq>0){cv=ct.readUncompressedInt(false);cr=ct.readUncompressedInt(false);for(var cn=0;cn<cq;++cn){cw.push(new aW(ct))}}this.getRootTocEntry=function(){for(var cx=0;cx<cw.length;++cx){var cy=cw[cx].fatherId;if(cw[cx].fatherId==0){return cw[cx]}}};this.getChildEntryByFatherId=function(cz,cx){for(var cy=0;cy<cw.length;++cy){if(cw[cy].fatherId==cz){if(cw[cy].name==cx){return cw[cy]}}}};this.getChildEntry=function(cy,cx){return this.getChildEntryByFatherId(cy.getId(),cx)}};var bS={TEXTURE_SIMPLE:0,TEXTURE_SIMPLE_WITH_MIPMAP:1,TEXTURE_VOLUME:2,TEXTURE_VOLUME_WITH_MIPMAP:3,TEXTURE_CUBIC_ENV_MAP:4,TEXTURE_CUBIC_ENV_MAP_WITH_MIPMAP:5};var at={Version0:-1159921408,Version0Converted:-86375937,Version1:122298,Version1Converted:-16655622,Version2:-86376192,Version2Converted:121594,Version3:-86376177,Version3Converted:251779834};var cm={L:0,LA:1,RGB:2,RGBA:3,BILEVEL:4,BADFORMAT:5,RGB_S3TC_DXT1:6,RGBA_S3TC_DXT1:7,RGBA_S3TC_DXT3:8,RGBA_S3TC_DXT5:9,RGB_f:10,RGBA_f:11,BGR:12,BGRA:13};var ba={Stream_DEFAULT:0,Stream_BADCOMPRESSED:1,Stream_CCITTG3:2,Stream_UNCOMPRESSED:3,Stream_PNG:4,Stream_JPEG:5};var bJ=function(){this.unstream=function(cu,co){var cs;var cv;var cp;var cB;var cA;var cC=false;var cD=1;var cx=1;var cr=cu.conversion;var cn=0;cn=cu.readCompressedInt();if(cr){if((cn==at.Version0)||(cn==at.Version1)){cp=cu.readCompressedInt()}else{if((cn==at.Version0Converted)||(cn==at.Version1Converted)){cp=cu.readCompressedInt()}else{if(cn==at.Version2){}else{if(cn==at.Version2Converted){}else{if(cn==at.Version3){}else{if(cn==at.Version3Converted){}else{cp=cn}}}}}}}else{if((cn==at.Version0)||(cn==at.Version1)){cp=cu.readCompressedInt()}else{if((cn==at.Version0Converted)||(cn==at.Version1Converted)){cp=cu.readCompressedInt()}else{if(cn==at.Version2){}else{if(cn==at.Version2Converted){}else{if(cn==at.Version3){}else{if(cn==at.Version3Converted){}else{cp=cn}}}}}}}if((cn!=at.Version2)&&(cn!=at.Version2Converted)&&(cn!=at.Version3)&&(cn!=at.Version3Converted)){cB=cu.readCompressedInt();var cw;cw=cu.readCompressedInt();cA=cu.readCompressedInt();var cz=cu.readCompressedInt();cD=cu.readFloat();cx=cu.readFloat();if(cA==0){return null}cv=new Uint8Array(cw);cu.readBytes(cw,cv)}else{var cq;cq=cu.readCompressedInt();switch(cq){case ba.Stream_BADCOMPRESSED:cp=cu.readCompressedInt();cB=cu.readCompressedInt();var cw;cw=cu.readCompressedInt();cA=cu.readCompressedInt();cz=cu.readCompressedInt();cD=cu.readFloat();cx=cu.readFloat();return -1;case ba.Stream_CCITTG3:cp=cu.readCompressedInt();cB=cu.readCompressedInt();var cw;cw=cu.readCompressedInt();cA=cu.readCompressedInt();cz=cu.readCompressedInt();cD=cu.readFloat();cx=cu.readFloat();if(cA==0){console.log(" BILEVEL texture format is not supported ");return null}else{return null}break;case ba.Stream_UNCOMPRESSED:cp=cu.readCompressedInt();cB=cu.readCompressedInt();var cw;cw=cu.readCompressedInt();cA=cu.readCompressedInt();cz=cu.readCompressedInt();cD=cu.readFloat();cx=cu.readFloat();if((cn==at.Version3)||(cn==at.Version3Converted)){if(cA==cm.RGB_S3TC_DXT1||cA==cm.RGBA_S3TC_DXT1||cA==cm.RGBA_S3TC_DXT3||cA==cm.RGBA_S3TC_DXT5){var ct=cu.readCompressedInt()}}cv=new Uint8Array(cw);cu.readBytes(cw,cv);break;case ba.Stream_PNG:cC=true;cp=cu.readCompressedInt();cB=cu.readCompressedInt();var cy=cu.readCompressedInt();cA=cu.readCompressedInt();cz=cu.readCompressedInt();cD=cu.readFloat();cx=cu.readFloat();var cv=new Uint8Array(cy);if(cy){cu.readBytes(cy,cv)}else{return null}break;case ba.Stream_JPEG:break;default:break}}return{img:cv,width:cp,height:cB,format:cA,url:co,xPixelSize:cD,yPixelSize:cx,compression:cC}}};var k=function(){this.unstream=function(cs,cp){var cn=new bJ();var cr=cn.unstream(cs,cp);if(cr===null){return null}var co=cs.readStringWithLength();var cq=co.split("\\");var cp=cq[cq.length-1];cr.url=cp;return cr}};var bZ=function(){this.unstream=function(cs,co){var cn=1;var cx={mipmaps:[],width:0,height:0,format:null,mipmapCount:1,url:co};var cu=cs.readCompressedInt();if(cu==0){var cp=cs.readCompressedInt();cx.mipmapCount=cs.readCompressedUInt();cx.width=cs.readCompressedUInt();cx.height=cs.readCompressedUInt();cx.format=cs.readCompressedInt();cx.streamCmpFormat=cp;if(0==cx.mipmapCount){cn=0}var cq=cx.width;var cv=cx.height;for(var ct=1;ct<=cx.mipmapCount;ct++){var cw=new bJ();var cr=cw.unstream(cs,co);if(cx.format==3){return cr}cx.mipmaps.push({data:cr.img,width:cr.width,height:cr.height});cv/=2;if(cv<1){cv=1}cq/=2;if(cq<1){cq=1}}}else{cn=0}return cx}};var u=function(){this.unstream=function(cM){var cz=new bg.Material;var cx=cM.readCompressedInt();var cw=cM.readFloat();var cH=cM.readFloat();var cN=cM.readFloat();cz.colorAmbient[0]=cw;cz.colorAmbient[1]=cH;cz.colorAmbient[2]=cN;var cv=cM.readFloat();var cE=cM.readFloat();var cL=cM.readFloat();cz.colorDiffuse[0]=cv;cz.colorDiffuse[1]=cE;cz.colorDiffuse[2]=cL;var cp=cM.readFloat();var ct=cM.readFloat();var cC=cM.readFloat();cz.colorSpecular[0]=cp;cz.colorSpecular[1]=ct;cz.colorSpecular[2]=cC;cz.shininess=cM.readFloat();cz.shininess*=255;cz.ambientCoef=cM.readFloat();cz.diffuseCoef=cM.readFloat();cz.specularCoef=cM.readFloat();cz.transparent=cM.readFloat();cz.reflectivityCoef=cM.readFloat();var cK=((cM.version<2100190)&&(cM.version>=2100000))||(cM.version<1102110);var cJ=cM.readUnsignedChar();if(cJ){if(cK){var cr=cM.readUnsignedChar();if(cr){var cq=0;cq=cM.readCompressedInt();if(cM.textures.isValidMultiRefIndex(cq)){var cu=cM.textures.getIndex(cq);cz.textureId=cu}else{var cF=new k();var cB=cF.unstream(cM);var cI=cM.textures.add(cB);cM.textures.addMultiRefIndex(cq,cI);cz.textureId=cI}}else{var cF=new k();var cB=cF.unstream(cM);var cI=cM.textures.add(cB);cz.textureId=cI}}else{var cD=cM.getContainer();var co;if(cD){co=cD.getResourceCGRContainer()}if(co){var cI=co.getResource(cM);cz.textureId=cI}}}cz.textureImageNumberComposante=cM.readCompressedInt();cz.textureBlending=cM.readCompressedInt();cz.magFilter=cM.readCompressedInt();cz.minFilter=cM.readCompressedInt();var cA=cM.readCompressedInt();switch(cA){case 0:cz.mappingFunction="USER_MAPPING";break;case 3:cz.mappingFunction="SPHERICAL_ENV_MAP";break}cz.textureWrapS=cM.readCompressedInt();cz.textureWrapT=cM.readCompressedInt();cz.addedComposantInTexEnv=cM.readCompressedInt();cM.skip(76);if(!cK){var cy=cM.readUnsignedChar();if(cy){cz.textureId=-1;var cG=cM.readCompressedInt();var cs=cG==7?true:false;var cn=new av();cn.unstream(cM);if(cn){cz.shaderMaterial={name:cn.name,param:cn.parameters,PDSFX:cs}}}}return cz}};var aD=function(){this.skip=function(cn){this.unstream(cn,true)};this.unstreamTexture=function(cq){var cs=1;var co=0;var cn=0;if(cq.version>=210041930){cn=cq.readCompressedInt();if(cq.textures.isValidMultiRefIndex(cn)){co=cq.textures.getIndex(cn);cs=0}}if(cs){var cp=new bJ();var cr=cp.unstream(cq);if(cr!=null){co=cq.textures.add(cr)}if(cr&&cq.version>=210041930){cq.textures.addMultiRefIndex(cn,co)}}return co};this.unstream=function(cG,co){var cB=-1;var cz={};if(!co){var cn=new u();cz=cn.unstream(cG)}var cA=cG.readStringWithLength();var cy={tab:[]};cz.physicalMaterial=JSON.parse(cA);var cv=cG.readCompressedUInt();var cw=cG.readCompressedUInt();var cr=cz.physicalMaterial.Version;var cq=0;if(cz.physicalMaterial&&cz.physicalMaterial.PhysicalMaterial&&cz.physicalMaterial.PhysicalMaterial.MappingOperator&&cz.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation){var cE=cz.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation;cz.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation=[cE[0],cE[1],cE[2],cE[4],cE[5],cE[6],cE[8],cE[9],cE[10]]}if(cr&&cr>=3){cq=cG.readCompressedUInt()}var cu=cG.readBoolean();var ct=false;if(cr&&cr>=0.2){ct=cG.readBoolean()}for(var cD=0;cD<cv;cD++){var cs=false;cB=-1;var cI=cG.readStringWithLength();if(cr>0){cs=cG.readBoolean()}if(cs){cB=this.unstreamTexture(cG)}else{cB=bq(cG)}if(cB>=0){var cF=cz.physicalMaterial.PhysicalMaterial.FloatParameter;var cC=cF[cI];cC.Texture=cB}}for(cD=cv;cD<(cw+cv);cD++){var cs=false;cB=-1;var cI=cG.readStringWithLength();if(cr>0){cs=cG.readBoolean()}if(cs){cB=this.unstreamTexture(cG)}else{cB=bq(cG)}if(cB>=0){var cH=cz.physicalMaterial.PhysicalMaterial.Float3Parameter;var cC=cH[cI];cC.Texture=cB}}cB=-1;var cx=null;if(cz.physicalMaterial.PhysicalMaterial&&cz.physicalMaterial.PhysicalMaterial.MapParameter){cx=cz.physicalMaterial.PhysicalMaterial.MapParameter.normalMap}if(cu){cB=bq(cG);if(cB>=0){if(cx){cx.Texture=cB}else{cz.physicalMaterial.PhysicalMaterial.NormalMap.Texture=cB}}}if(ct){bq(cG)}for(cD=0;cD<cq;cD++){var cs=false;cB=-1;var cI=cG.readStringWithLength();var cp=cz.physicalMaterial.PhysicalMaterial.MapParameter[cI];if(cr>0){cs=cG.readBoolean()}if(cs){cB=this.unstreamTexture(cG)}else{cB=bq(cG)}if(cB>=0){if(cp){cp.Texture=cB}}}return cz}};var aL=function(){this.unstream=function(cD){var cx={};var cA;var cp=0;cp=cD.readCompressedInt();if(cD.materials.isValidMultiRefIndexWithName(cp,cD.name)){cA=cD.materials.getIndexWithName(cp,cD.name);cx=cD.materials[cA]}else{var co=cD.readStringWithLength();var cE=JSON.parse(co);if(cE.images&&cE.textures){var cB=cD.getContainer();var cn;if(cB){cn=cB.getResourceCGRContainer()}var cu=[];if(cn){for(var cC=0;cC<cE.images.length;cC++){var cI=cn.getImage(cD,cE.images[cC].byteOffset,cE.images[cC].byteOffset+cE.images[cC].byteLength);cu.push(cI)}}var cz=[];if(cE.images&&cE.images.length){for(var cC=0;cC<cE.images.length;cC++){cz.push(false)}}var cw=[];for(var cC=0;cC<cE.textures.length;cC++){var cH=false;var cq=cE.textures[cC];if(cz[cq.image]){cH=true}cz[cq.image]=true;var cI=cu[cq.image];var cG={noTranferable:cH,compression:cI.compression,format:cI.format,height:cI.height,width:cI.width,img:cI.img,wrap:[1,1],filter:[1,1]};if(cq.uWrap&&cq.uWrap!="REPEAT"){cG.wrap[0]=0}if(cq.vWrap&&cq.vWrap!="REPEAT"){cG.wrap[1]=0}if(cq.magFilter){cG.filter[1]=ad[cq.magFilter]}if(cq.minFilter){cG.filter[0]=ad[cq.minFilter]}var cr=cD.textures.add(cG);cw.push(cr)}}var cs=cE.materials[0];var ct=cx;if(cs.type=="Visu.Basic"){cx.colorDiffuse=cs.DiffuseColor;cx.diffuseCoef=cs.DiffuseCoeff;cx.colorAmbient=cs.AmbientColor;cx.ambientCoef=cs.AmbientCoeff;cx.colorSpecular=cs.SpecularColor;cx.specularCoef=cs.SpecularCoeff;cx.reflectivityCoef=cs.ReflectionCoeff;cx.textureId=cs.Texture?cw[cs.Texture.texture]:undefined;if(cx.textureId!=undefined){var cy=cD.textures.get(cx.textureId);cx.minFilter=cy.filter[0];cx.magFilter=cy.filter[1];cx.textureWrapS=cy.wrap[0];cx.textureWrapT=cy.wrap[1]}cx.shininess=cs.ShininessCoeff*255;cx.transparency=cs.TransparencyCoeff;cx.alphaTest=0.5*cs.IsAlphaTestEnabled}else{if(cs.type=="Visu.SpecularGlossiness"||cs.type=="Visu.SpecularGlossiness@17x"||cs.type=="Visu.EVisuPBR"){for(var cF in cs){var cv=cs[cF];if(cv.texture){cv.texture=cw[cv.texture]}}cx.physicalMaterial={};cx=cx.physicalMaterial;cx.PhysicalMaterial=cs;cx.PhysicalMaterial.isVisDescription=true}}var cA=cD.materials.add(ct);cD.materials.addMultiRefIndexWithName(cp,cA,cD.name)}return ct}};var bq=function(cq){var cn=-1;var cr=cq.getContainer();var cp;if(cr){cp=cr.getResourceCGRContainer()}var co="";if(cp){cn=cp.getResource(cq)}return cn};var av=function(){this.parameters={};this.name="";this.unstream=function(cp){this.parametersUnstream(cp);var cq=cp.getContainer();var cn;if(cq){cn=cq.getResourceCGRContainer()}if(cn){var co=cn.getResourceShader(cp)}if(co===null){return null}if(co){this.name=co.name}};this.parametersUnstream=function(cy){var cs=cy.readCompressedInt();var cx=[];for(var cu=0;cu<cs;++cu){cx[cu]=cy.readStringWithLength()}var cq=cy.readCompressedInt();for(var cu=0;cu<cq;++cu){var cz=cy.readCompressedInt();switch(cz){case 0:var cr=cy.readCompressedInt();break;case 1:var cr=cy.readCompressedInt();var cA=cy.readFloat();var cp=cx[cu];this.parameters[cp]=cA;break;case 2:var cr=cy.readCompressedInt();var ct=[];cy.readFloatArray(0,4,ct);var cp=cx[cu];this.parameters[cp]=ct;break;case 4:var cr=cy.readCompressedInt();var cw=cy.getContainer();var cv;if(cw){cv=cw.getResourceCGRContainer()}var co="";if(cv){var cn=cv.getResource(cy);if(ae[cn]){if(ae[cn].url){co=ae[cn].url}}}var cp=cx[cu];this.parameters[cp]={imgId:cn,url:co};break;case 5:var cr=cy.readCompressedInt();var ct=[];cy.readFloatArray(0,4,ct);var cp=cx[cu];this.parameters[cp]=ct;break;case 6:var cr=cy.readCompressedInt();var ct=[];cy.readFloatArray(0,4,ct);var cp=cx[cu];this.parameters[cp]=ct;break}}}};var x=function(){this.name="";this.unstream=function(cp){var cn=cp.readStringWithLength();var cq=cn.lastIndexOf("\\");if(cq!==-1){cn=cn.substring(cq+1,cn.length)}cq=cn.lastIndexOf(".");if(cq!==-1){cn=cn.substring(0,cq)}var co=cp.readCompressedInt();cp.skip(co);this.name=cn}};var aw=function(){this.unstream=function(cu){var cw=[];for(var cq=0;cq<2;cq++){var ct=cu.readUnsignedChar();if(ct){var cn=cu.readUnsignedChar();var co=0;if(cn){co=cu.readCompressedInt();if(cu.materials.isValidMultiRefIndexWithName(co,cu.name)){cw[cq]=cu.materials.getIndexWithName(co,cu.name)}else{var cp=null;var cv=cu.readCompressedInt();if(cv===1){cp=new aw()}else{cp=new u()}var cs=cp.unstream(cu);if(cv===1){cr=cs}else{var cr=cu.materials.add(cs)}cu.materials.addMultiRefIndexWithName(co,cr,cu.name);cw[cq]=cr}}else{var cp=null;var cv=cu.readCompressedInt();if(cv===1){cp=new aw()}else{cp=new u()}var cs=cp.unstream(cu);var cr;if(cv===1){cr=cs}else{cr=cu.materials.add(cs)}cw[cq]=cr}}}return cw[0]}};var l=function(){this.posBuffer=[];this.normalBuffer=[];this.textureBuffer=[];this.uvsBuffer=[];this.binormalsBuffer=[];this.tangentsBuffer=[];this.numberOfVertices=0};l.prototype.getNumberOfVertices=function(){return this.numberOfVertices};l.prototype.unstream=function(cu){var cy,cx,ct,cw,cn,co;this.numberOfVertices=cu.readCompressedInt();cy=cu.readCompressedInt();this.hasTextures=cu.readUnsignedChar();this.hasUVs=cu.readUnsignedChar();this.hasTangentsBinormals=cu.readUnsignedChar();var ct=0;if(this.hasTextures){ct=cu.readUnsignedChar();cu.readTextures(0,this.numberOfVertices,ct,this.textureBuffer)}if(this.numberOfVertices){cu.readPositions(0,this.numberOfVertices,this.posBuffer,0)}if(cy){cu.readNormals(0,cy,this.normalBuffer,0)}if(this.hasUVs&&this.numberOfVertices){this.uvsBuffer=new Float32Array(this.numberOfVertices*2);cu.readFloatArray(0,this.numberOfVertices*2,this.uvsBuffer)}if(this.hasTangentsBinormals){cu.readFloatArray(0,this.numberOfVertices*3,this.tangentsBuffer);cu.readFloatArray(0,this.numberOfVertices*3,this.binormalsBuffer)}if(cu.version>=210041920){var cv=cu.readUnsignedChar();if(cv){var cs=cu.readCompressedInt();if(cs>0){for(var cq=0;cq<cs;++cq){var cp=cu.readUnsignedChar();var cr=cu.readStringWithLength();cu.skip(4*cp*this.numberOfVertices)}}}}};l.prototype.allocateBuffers=function(){this.posBuffer=new Array(this.numberOfVertices*3);if(this.totalNumberOfNormals){this.normalBuffer=new Array(this.totalNumberOfNormals*3)}if(this.hasTextures){this.textureBuffer=new Array(this.numberOfVertices*3)}if(this.hasUVs){this.uvsBuffer=new Array(this.numberOfVertices*2)}if(this.hasTangentsBinormals){this.tangentsBuffer=new Array(this.numberOfVertices*3);this.binormalsBuffer=new Array(this.numberOfVertices*3)}};var a0=function(){l.call(this);this.totalNumberOfNormals=0;this.nbTexCoords=0;this.hasTextures=false;this.hasUVs=false;this.hasTangentsBinormals=false};a0.prototype=new l;a0.prototype.constructor=a0;a0.prototype.partUnStreamHeader=function(cp){this.numberOfVertices=cp.readCompressedInt();this.totalNumberOfNormals=cp.readCompressedInt();var cr=cp.readUnsignedChar();this.hasTextures=cr&1;this.hasUVs=cr&2;this.hasTangentsBinormals=cr&4;this.hasExtraTextures=cr&16;if(this.hasTextures){this.nbTexCoords=cp.readUnsignedChar()}if(this.hasExtraTextures){this.nbExtraTextureSet=cp.readCompressedInt();this.extraTextureSet=[];for(var co=0;co<this.nbExtraTextureSet;++co){var cq=cp.readUnsignedChar();var cn=cp.readStringWithLength();this.extraTextureSet.push({dimension:cq,identifier:cn})}}this.allocateBuffers()};a0.prototype.partUnStream=function(cr,cp,cn,cq,cs){if(cq){cr.readPositions(cp,cq,this.posBuffer)}if(this.totalNumberOfNormals){cr.readNormals(cn,cs,this.normalBuffer)}if(this.hasTextures){cr.readTextures(cp,cq,this.nbTexCoords,this.textureBuffer)}if(this.hasUVs&&this.numberOfVertices){cr.readFloatArray(2*cp,2*cq,this.uvsBuffer)}if(this.hasTangentsBinormals){cr.readFloatArray(3*cp,3*cq,this.tangentsBuffer);cr.readFloatArray(3*cp,3*cq,this.binormalsBuffer)}if((this.nbExtraTextureSet>0)&&cr.version>=210041920){for(var co=0;co<this.nbExtraTextureSet;++co){var ct=this.extraTextureSet[co].dimension;cr.skip(4*ct*cq)}}};var cf=function(){this.geomType=0;this.nbPrimitives=0;this.primitives=[];this.attribute=null;this.material={file:"",id:-1}};cf.prototype.unstreamPrimSet=function(cq){this.geomType=b7[cq.readCompressedInt()];this.nbPrimitives=cq.readCompressedInt();this.primitives=new Array(this.nbPrimitives);for(var cp=0;cp<this.nbPrimitives;++cp){var co=cq.readUnsignedChar();var cn=null;switch(co){case 1:cn=new Z();break;case 2:cn=new K();break;case 3:cn=new bd();break;case 4:console.log("primitive type not handled..");break;case 5:cn=new bR();break;case 6:cn=new au();break;default:console.log("primitive type not handled..");break}if(cn){cn.unstream(cq);this.primitives[cp]=cn}}};var n=function(){cf.call(this)};n.prototype=Object.create(cf.prototype);n.prototype.constructor=n;n.prototype.unstream=function(cu){this.unstreamPrimSet(cu);for(var cp=0;cp<this.primitives.length;++cp){var cs=cu.readGraphicAttributeSet();var cq=cu.pushGAS(cs,0);var cn=cq.getDisplayedColor();var cv=cq.getType();var ct=cq.isSolid();var co=cq.isNoZ();var cw=1;var cr=bg.LinePatternEnum.SOLID;if(this.geomType=="WIRE_EDGE"){cw=cq.getLineThickness();cr=cq.getLinetype()}if(co){this.noZ=true}var cs={fill:new bg.FillAttributes(new bg.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),ct),line:new bg.LineAttributes(new bg.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),cw,cr),point:new bg.PointAttributes()};if(this.primitives[cp].symbol){cs.point=new bg.PointAttributes(new bg.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),cq.getLineThickness(),this.primitives[cp].symbol)}this.primitives[cp].gas=cs;cu.popGAS()}};var aE=function(){cf.call(this)};aE.prototype=Object.create(cf.prototype);aE.prototype.constructor=aE;aE.prototype.unstream=function(cv){this.unstreamPrimSet(cv);var ct=cv.readGraphicAttributeSet();var cr=cv.pushGAS(ct,0);var cn=cr.getDisplayedColor();var cw=cr.getType();var cu=cr.isSolid();var co=cr.isNoZ();var cx=1;var cs=bg.LinePatternEnum.SOLID;if(co){this.noZ=true}if(this.geomType=="WIRE_EDGE"){cx=cr.getLineThickness();cs=cr.getLinetype()}var ct={fill:new bg.FillAttributes(new bg.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),cu),line:new bg.LineAttributes(new bg.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),1,bg.LinePatternEnum.SOLID),point:new bg.PointAttributes()};for(var cp=0;cp<this.primitives.length;++cp){if(this.primitives[cp].symbol){var cq={fill:ct.fill,line:ct.line,point:new bg.PointAttributes(new bg.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),cr.getLineThickness(),this.primitives[cp].symbol)};this.primitives[cp].gas=cq;continue}this.primitives[cp].gas=ct}cv.popGAS()};var aK=function(){cf.call(this)};aK.prototype=Object.create(cf.prototype);aK.prototype.constructor=aK;aK.prototype.unstream=function(cF){n.prototype.unstream.call(this,cF);var cn=0;var cp=[];var cG=this.primitives.length;for(var cD=0;cD<cG;cD++){cp[cD]=[]}if(cF.version>=210041800){cn=cF.readCompressedUInt()}if(cn>0){var cw=cF.readUnsignedChar();if(cw){for(var cD=0;cD<cn;cD++){var cA=cF.readUnsignedChar();if(cA){var cq={material:null,inheritanceMaterial:null,layer:null};var cs=cF.readStringWithLength();var cE=cF.readCompressedUInt();for(var cC=0;cC<cE;cC++){var cu=cF.readCompressedUInt();cp[cu].push(cq)}var cy=cF.readCompressedUInt();if(cy>0){for(var cC=0;cC<cy;cC++){var cx=this.materialApplicationUnstream(cF,ax.STREAM_ALL_UINT);if(cC==(cy-1)){cx.material.primWithMaterials=true;cq.material=cx.material;cq.inheritanceMaterial=cx.inheritanceMaterial;cq.layer=cx.layer}}}}}for(var cD=0;cD<cG;cD++){var cB=this.primitives[cD];var cv=cp[cD];for(var cC=0;cC<cv.length;cC++){cF.pushMatId(cv[cC].material,cv[cC].inheritanceMaterial,cv[cC].layer)}cB.material=cF.getCurrentMatId();if(cB.material){cB.material.primWithMaterials=true}for(var cC=0;cC<cv.length;cC++){cF.popMatId()}}var cr=(cF.version==210041800)?ax.STREAM_ALL_UINT:ax.STREAM_ALL_ULONG;var ct=cF.readCompressedUInt();for(var cD=0;cD<ct;++cD){var cu=cF.readUncompressedInt();var cy=cF.readCompressedUInt();if(cy>0){for(var cC=0;cC<cy;++cC){var cx=this.materialApplicationUnstream(cF,ax.streamSettings);if(cy==0){cF.pushMatId(cx.material,cx.inheritanceMaterial,cx.layer);cz=cF.getCurrentMatId();cF.popMatId()}}}}}}else{cG=this.primitives.length;for(var cD=0;cD<cG;cD++){var co=cF.readUnsignedChar();if(co){var cx=this.materialApplicationUnstream(cF,ax.STREAM_MATERIAL);var cz=cx.material;cz.primWithMaterials=true;this.primitives[cD].material=cz}}}};aK.prototype.unstreamMaterial=function(cw){var cv={file:"",id:-1};var cx=0;var co=cw.readUnsignedChar();var cp=0;var cu=null;var cs=null;if(co){cp=cw.readCompressedInt();if(cw.materials.isValidMultiRefIndexWithName(cp,cw.name)){cv={file:"",id:cw.materials.getIndexWithName(cp,cw.name)};return cv}}if(cw.version>=210021320){var cy=cw.readCompressedInt();if(cy===1){cs=new aw()}else{if(cy===4){cs=new aD()}else{if(cy===9&&cw.version>=210042100){cs=new aL()}else{cs=new u()}}}}else{cs=new u()}cu=cs.unstream(cw);var cn=cw.getCurrentPosition();var cq=cw.getBytesRemain();if(cq>32){cq=32}var cr=cw.readString(cq);cw.setCurrentPosition(cn);if(cr.indexOf('{\n"Version" : ')!==-1){fakeUnstreamer=new aD();fakeUnstreamer.skip(cw)}if(cy===1){var ct=cu}else{var ct=cw.materials.add(cu)}cv={file:"",id:ct};if(co){cw.materials.addMultiRefIndexWithName(cp,ct,cw.name)}return cv};aK.prototype.materialApplicationUnstream=function(cr,co){var cn={material:null,inheritanceMaterial:1,layer:0};if(co&ax.STREAM_MATERIAL){cn.material=this.unstreamMaterial(cr)}if(cr.version>=1100500){if(co&ax.STREAM_INHERIT_INT){cn.inheritanceMaterial=cr.readCompressedInt()}else{if(co&ax.STREAM_INHERIT_UINT){cn.inheritanceMaterial=cr.readCompressedInt()}else{if(co&ax.STREAM_INHERIT_ULONG){cn.inheritanceMaterial=cr.readUncompressedInt()}}}}else{if(co&(ax.STREAM_INHERIT_INT|ax.STREAM_INHERIT_UINT|ax.STREAM_INHERIT_ULONG)){cn.inheritanceMaterial=1}}if(co&ax.STREAM_LAYER_INT){cn.layer=cr.readUncompressedInt()}else{if(co&ax.STREAM_LAYER_UINT){cn.layer=cr.readCompressedInt()}else{if(co&ax.STREAM_LAYER_ULONG){cn.layer=cr.readUncompressedUInt()}}}if(co&ax.STREAM_UVTRANSFO){var ct=false;if(cr.version>=210041900){var ct=cr.readBoolean();if(ct){cr.readFloat();cr.readFloat();cr.readFloat();cr.readFloat()}}}if(co&ax.STREAM_MAPPING_INFO){if(cr.version>=210042100){var cu=cr.readBoolean();if(!cu){var cp=cr.readStringWithLength();cp=JSON.parse(cp);cp=cp.mappings[cp.uvSlots.Default];cn.mapping={type:0,ObjectTransformation:null,UvTransformation:null};if(cp.uvTransform){cn.mapping.UvTransformation=cr.createMatrix3(cp.uvTransform)}if(cp.operator){var cq=cp.operator.type;if(cq=="PLANAR"){cn.mapping.type=1}else{if(cq=="SPHERICAL"){cn.mapping.type=2}else{if(cq=="SPHERICAL_NORMALIZED"){cn.mapping.type=3}else{if(cq=="CUBIC"){cn.mapping.type=4}else{if(cq=="CYLINDRICAL"||cq=="FINITE_CYLINDRICAL"){cn.mapping.type=5}else{if(cq=="INFINITE_CYLINDRICAL"){cn.mapping.type=6}else{if(cq=="INFINITE_CYLINDRICAL_NORMALIZED"){cn.mapping.type=7}}}}}}}if(cp.operator.transform){var cs=cp.operator.transform;cn.mapping.ObjectTransformation=cs}}}}}return cn};var b4=function(){};b4.prototype.skip=function(co,cp){var cn=co.readCompressedInt();if(cn<0){cn=-cn-2}co.skip(cn-4)};b4.prototype.unstream=function(cz,cp){var cu=new e();var cC=cz.readCompressedInt();if(cC<0){cC=-cC-2}var cq=cz.getCurrentPosition()+cC-4;cu.rep.unstream(cz);cz.setNumberOfVertices(16777216);var ct=cz.readCompressedInt();if(ct<=0){cz.popMatId();cz.popGAS();return null}var co;var cr;for(var cB=0;cB<ct;cB++){co=cz.readUnsignedChar();cr=null;switch(co){case bT.FACE3:cr=new a5();break;case bT.PLANARFACE3:cr=new a5();break;case bT.LINE3:cr=new L();break;case bT.POLYLINE3:cr=new L();break;case bT.MARKER3:cr=new cj();break;case bT.FIXEDARROW:cr=new M();break;case bT.FIXEDPLAN:cr=new aB();break;case bT.CYLINDER:cr=new bt();break;case bT.CURVEDPIPE:cr=new a7();break;case bT.ANNOTEXT3:cr=new J();break;case bT.ARROW3:cr=new S();break;case bT.ARCELLIPSE3:cr=new F();break;case bT.ARCCIRCLE3:cr=new c();break;case bT.IMAGEPIXEL3:cr=new aT();break;case bT.UNDEFINED:break;default:return}if(cr!==null){cr.unstream(cz);var cA=cz.readGraphicAttributeSet();var cv=cz.pushGAS(cA,0);var cn=cv.getDisplayedColor();var cy=cu.rep.repGAS.getType();var cw=0;if(cy===3){cw=1}var cs=new bg.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255);var cx={fill:new bg.FillAttributes(cs,cw),line:new bg.LineAttributes(cs,cv.getLineThickness(),cv.getLinetype()),point:new bg.PointAttributes()};if(cr.primitive&&cr.primitive.symbol){cx.point.symbol=cr.primitive.symbol;cx.point.color=cs}cu.addGP(cr,cx,cz,cp);cz.popGAS()}else{cz.readGraphicAttributeSet()}}cu.checkGP(cz,cp);cu.addMesh(cz);if(cu.imageRep.length){cu.imageRep.push(cu.rep);return cu.imageRep}return cu.rep};var bL=function(){};bL.prototype.unstream=function(cD){var cr=new b8();var cv=cD.readCompressedInt();if(cv<0){cv=-cv-2}cr.rep.unstream(cD);var cE=cD.readCompressedInt();var cq=new bg.PrimitiveGroup();cq.fillAttr=new bg.FillAttributes();cq.lineAttr=new bg.LineAttributes();cq.pointAttr=new bg.PointAttributes();var cx=[0];var cz;for(var cB=0;cB<cE;++cB){var cu=null;var cw=cD.readUnsignedChar();cz=null;switch(cw){case 121:cz=new bo();break;case 128:cz=new bH();break;case 129:cz=new b6();break;case 130:cz=new b0();break;case 131:cz=new bD();break;case 132:cz=new aQ();break;case 135:cz=new bI();break;case 136:cz=new a3();break;case 164:cz=new r();break;case 165:cz=new bX();break;case 166:cz=new y();break;case 167:cz=new bl();break;case 168:cz=new a1();break;case 169:cz=new ar();break;case 105:cz=new O();break;default:break}if(cz){var ct=cz.unstream(cD);var cp=cD.readGraphicAttributeSet();var cs=cD.pushGAS(cp,0);var co=cs.getDisplayedColor();var cn=cr.rep.repGAS.getType();var cC=0;if(cn===3){cC=1}var cA=new bg.Color(co[0]/255,co[1]/255,co[2]/255,co[3]/255);var cy={fill:new bg.FillAttributes(cA,cC,true),line:new bg.LineAttributes(cA,cs.getLineThickness(),cs.getLinetype()),point:new bg.PointAttributes()};if(cz.primitive&&cz.primitive.symbol){cy.point.symbol=cz.primitive.symbol;cy.point.color=cA}if(aY&&cz instanceof O){cz.text.color=cA;cD.texts.add(cz.text)}if(ct){cr.addGP(cz,cy,cD)}cD.popGAS()}}cr.addMesh(cD);if(cr.imageRep.length){cr.imageRep.push(cr.rep);return cr.imageRep}return cr.rep};var H=function(){};H.prototype.unstreamRep=function(cR,cO){if(!cO){cO=new Q()}var cJ=cR.readCompressedInt();var cq=null;var cP=false;cO.rep.unstream(cR);if(cR.version>=2100000){var cK=0;var cs=cR.readUnsignedChar();if(cs){cO.vertexBuffer=new a0();cO.vertexBuffer.partUnStreamHeader(cR);cK=cO.vertexBuffer.getNumberOfVertices()}var cH=0;cO.nbLODFaces=cR.readUnsignedChar();var cD=0;if(cO.nbLODFaces){var cD=new Float32Array(cO.nbLODFaces+1);cR.readFloatArray(0,cO.nbLODFaces+1,cD)}else{if(cR.version>210041930){cD=cR.readDouble()}else{cD=cR.readFloat()}}if(aN){cO.rep.node.sag=cD}if(cR.version>=210021620){var cQ=cR.readDouble()}cR.setNumberOfVertices(cK);var co=0;cO.posInNextStreamer=cR.readCompressedInt();var cp=0;var cB=0;var cM=0;var cn=[];var cz=0;var cr=0;while(co<=w.LSG){if(cO.nbLODFaces==0&&(co==w.LOD1||co==w.LOD2||co==w.LOD3||co==w.FACES)){co++;continue}if(cO.nbLODFaces==0&&co==w.LOD0){var cF=cR.getContainer();if(!cF){cR.error=" container not found";return false}var cv=cF.getStreamerByName("LOD0");cR.copyStreamerInheritance(cv);if(cv){cv.setCurrentPosition(cO.posInNextStreamer);cO.posInNextStreamer=cv.readCompressedInt();if(cs){var cA=cv.readCompressedInt();var cC=cv.readCompressedInt();cO.vertexBuffer.partUnStream(cv,cz,cr,cA,cC);cv.setNumberOfVertices(cO.vertexBuffer.getNumberOfVertices())}cO.unStreamFaces(cv);if(cO.sets[0]){if(cO.sets[0].noZ){cP=true}}}}else{if(co==w.LOD0){var cF=cR.getContainer();if(!cF){cR.error=" container not found";return false}var cv=cF.getStreamerByName("LOD0");cR.copyStreamerInheritance(cv);if(cv){cv.setCurrentPosition(cO.posInNextStreamer);cO.posInNextStreamer=cv.readCompressedInt();if(cs){var cA=cv.readCompressedInt();var cC=cv.readCompressedInt();cO.vertexBuffer.partUnStream(cv,cz,cr,cA,cC);cz+=cA;cr+=cC}}}}if(co==w.LOD1){var cF=cR.getContainer();if(!cF){cR.error=" container not found";return false}var cv=cF.getStreamerByName("LOD1");cR.copyStreamerInheritance(cv);if(cv){cv.setCurrentPosition(cO.posInNextStreamer);cO.posInNextStreamer=cv.readCompressedInt();if(cs){var cA=cv.readCompressedInt();var cC=cv.readCompressedInt();cO.vertexBuffer.partUnStream(cv,cz,cr,cA,cC);cz+=cA;cr+=cC}}}if(co==w.LOD2){var cF=cR.getContainer();if(!cF){cR.error=" container not found";return false}var cv=cF.getStreamerByName("LOD2");cR.copyStreamerInheritance(cv);if(cv){cv.setCurrentPosition(cO.posInNextStreamer);cO.posInNextStreamer=cv.readCompressedInt();if(cs){var cA=cv.readCompressedInt();var cC=cv.readCompressedInt();cO.vertexBuffer.partUnStream(cv,cz,cr,cA,cC);cz+=cA;cr+=cC}}}if(co==w.LOD3){var cF=cR.getContainer();if(!cF){cR.error=" container not found";return false}var cv=cF.getStreamerByName("LOD3");cR.copyStreamerInheritance(cv);if(cv){cv.setCurrentPosition(cO.posInNextStreamer);cO.posInNextStreamer=cv.readCompressedInt();if(cs){var cA=cv.readCompressedInt();var cC=cv.readCompressedInt();cO.vertexBuffer.partUnStream(cv,cz,cr,cA,cC);cz+=cA;cr+=cC}}}if(co==w.FACES){var cF=cR.getContainer();if(!cF){cR.error=" container not found";return false}var cv=cF.getStreamerByName("FACES");cR.copyStreamerInheritance(cv);if(cv){cv.setCurrentPosition(cO.posInNextStreamer);cO.posInNextStreamer=cv.readCompressedInt();if(cs){var cA=cv.readCompressedInt();var cC=cv.readCompressedInt();cv.setNumberOfVertices(cz+cA);cO.vertexBuffer.partUnStream(cv,cz,cr,cA,cC);cz+=cA;cr+=cC}else{cv.setNumberOfVertices(0)}cO.unStreamFaces(cv);if(cO.sets[0]){if(cO.sets[0].noZ){cP=true}}}}if(co==w.LSG){var cF=cR.getContainer();if(!cF){cR.error=" container not found";return false}var cy=cF.getStreamerByName("LSG");if(cy){cR.copyStreamerInheritance(cy);cy.setNumberOfVertices(cK);if(cs){cy.setNumberOfVertices(cK)}else{cy.setNumberOfVertices(0)}cy.setCurrentPosition(cO.posInNextStreamer);cO.posInNextStreamer=cy.readCompressedInt();var cx=cO.sets.length;var cw=cy.readUnsignedChar();cO.nbSets=cw+cx;for(var cN=0;cN<cw;++cN){var cu=cy.readUnsignedChar();switch(cu){case 1:cO.sets[cN+cx]=new aE();break;case 2:cO.sets[cN+cx]=new n();break;default:cO.sets[cN+cx]=null;return}if(cO.sets[cN+cx]){cO.sets[cN+cx].unstream(cy);if(cO.sets[cN+cx].noZ){cP=true;var cI=cR.popGAS();cI.inherited.setType(0);cR.pushGAS(cI.inherited,cI.inh_mode)}}}}}co++}if(!cP){var cE=cR.getGAS();var cu=cE.getType();if(cu==0){var cI=cR.popGAS();cI.inherited.setType(2);cR.pushGAS(cI.inherited,cI.inh_mode)}}}else{var cn=[];var cs=cR.readUnsignedChar();if(cs){cO.vertexBuffer=new a0();cO.vertexBuffer.unstream(cR);cR.setNumberOfVertices(cO.vertexBuffer.getNumberOfVertices())}var cD=0;cD=cR.readFloat();cO.nbLODFaces=cR.readUnsignedChar();if(aN){cO.rep.node.sag=cD}for(var cN=0;cN<cO.nbLODFaces;++cN){var cu=cR.readUnsignedChar();var ct=[];var cG;switch(cu){case 1:cG=new Z();break;case 4:cG=new aC();break}if(cG){ct.push(cG.unstream(cR))}cR.readFloat();cR.readUncompressedInt();var cL=cR.readUncompressedInt()}cO.nbSets=cR.readUnsignedChar();for(var cN=0;cN<cO.nbSets;++cN){var cu=cR.readUnsignedChar();switch(cu){case 1:cO.sets[cN]=new aE();break;case 2:cO.sets[cN]=new n();break;default:cO.sets[cN]=null;return}if(cO.sets[cN]){cO.sets[cN].unstream(cR);if(cO.sets[cN].noZ){cP=true;var cI=cR.popGAS();cI.inherited.setType(0);cR.pushGAS(cI.inherited,cI.inh_mode)}}}if(!cP){var cE=cR.getGAS();var cu=cE.getType();if(cu==0){var cI=cR.popGAS();cI.inherited.setType(2);cR.pushGAS(cI.inherited,cI.inh_mode)}}}return cO};var ay=function(){this.repPosInStreamer=0};ay.prototype=Object.create(H.prototype);ay.prototype.constructor=ay;ay.prototype.unstream=function(cq){var cs=new Q();var cn=this.unstreamRep(cq,cs);if(!cs.posInNextStreamer){cs.posInNextStreamer=0}if(cq.version<2100000){cs.posInNextStreamer=cq.readCompressedInt()}if(V&&!h){if(!cn){return false}var cp=cq.getContainer();var co=cp?cp.getStreamerByName("SurfacicReps"):cq;if(cp){co.setCurrentPosition(cs.posInNextStreamer)}cq.copyStreamerInheritance(co);var cr=new a8();if(co){cr.unstreamRep(co,cs)}else{if(co.cgrContainer){return}else{cr.unstream(co,cs)}}}if(!cn){return false}cs.addMesh(cq);return cs.rep};var a8=function(){};a8.prototype.unStreamEdgeIndex=function(cp){var co=cp.readCompressedInt();var cn=cp.readCompressedInt()};a8.prototype.unstreamRep=function(cS,co){if(cS.version<1101410){return}if(!co){return}cS.setLightDataStreaming(false);var cC=cS.readCompressedInt();var cQ=cS.readFloat();var cy=cS.readFloat();if(cS.version>=210041720){var cz=cS.readUnsignedChar();if(cz&128){cS.skip(4)}}var cs=co.getSet("FACE");var ct=co.getSet("EDGE");var cK=cs.length;var cN=ct.length;var cT=co.nbLODFaces;var cR=cS.readCompressedInt();var cJ=[];var cB=new a5();if(cK){for(var cO=0;cO<cK;cO++){var cH=cs[cO];cB.unstream(cS);cH.cgmId=cB.node.cgmId;cH.decoration=cB.decoration;cH.boundingSphere=cB.boundingSphere}}for(var cO=0;cO<cT;cO++){cB.unstream(cS)}var cw=new ai();if(cN&&ct){for(cO=0;cO<cN;cO++){var cv=ct[cO];cw.unstream(cS);cv.cgmId=cw.node.cgmId;cv.decoration=cw.decoration;this.unStreamEdgeIndex(cS)}}for(var cO=0;cO<cR;cO++){var cr=cS.readCompressedInt();var cq=cS.readUncompressedInt();var cn=cS.readUncompressedInt();if(cS.version>=1101710){cS.setLightDataStreaming(true)}if(cr){var cM=new L();for(var cL=0;cL<cr;cL++){cM.skip(cS)}}if(cS.version>=1101710){cS.setLightDataStreaming(false)}}var cp=null;var cx=co.nbSets;var cu=new ai();var cD=new cj();for(var cA=0;cA<cx;++cA){var cF=co.sets[cA];var cP=cF.primitives;for(var cL=0;cL<cP.length;cL++){var cE=cP[cL];if((cF.geomType=="FACE")||(cF.geomType=="EDGE")){continue}var cI=null;var cG=cS.readUnsignedChar();switch(cG){case 80:cI=new a5();break;case 81:cI=new a5();break;case 82:cI=new L();break;case 84:cI=cD;break;case 96:cI=cu;break;case 162:cI=new aR();break;case 134:cI=new bC();break;case 86:cI=new aB();break;case 187:cI=new af();break;default:return}if(cI){cI.unstream(cS);cE.cgmId=cI.node.cgmId;cE.decoration=cI.decoration;cE.boundingSphere=cI.boundingSphere}if((cG==96)||(cG==162)){this.unStreamEdgeIndex(cS)}}}cS.setLightDataStreaming(true)};var bb=function(){};bb.prototype.unstream=function(cL){var cB=new bB();var cz=cL.readCompressedInt();var cI=false;cB.nbIndicesTotal=0;cB.vertexBuffer=new l();var cF=null;var co=null;cB.rep.unstream(cL);var cu=cL.readFloat();if(aN){cB.rep.node.sag=cu}var cH=cL.readFloat();var cq=cL.readFloat();if(cL.version>=210041740){var cr=cL.readUnsignedChar();if(cr&128){cL.skip(8)}}var cx=null;cB.nbElEdge=cL.readCompressedInt();if(cB.nbElEdge){for(var cG=(cB.nbElEdge-1);cG>=0;cG--){cF=new L();cF.primitive.indices=cB.indexBuffer;cF.vertexBuffer=cB.vertexBuffer;cF.unstream(cL);cF.primitive.cgmId=cF.node.cgmId;if(cF.decoration){cF.primitive.decoration=cF.decoration}cB.nbIndicesTotal+=cF.primitive.count;var cy=cL.readGraphicAttributeSet();var cv=cL.pushGAS(cy,0);var cp=cv.getDisplayedColor();cL.popGAS();if(cv.isNoZ()){cI=true;var cA=cL.popGAS();cA.inherited.setType(0);cL.pushGAS(cA.inherited,cA.inh_mode)}var cC={fill:new bg.FillAttributes(new bg.Color(cp[0]/255,cp[1]/255,cp[2]/255,cp[3]/255)),line:new bg.LineAttributes(new bg.Color(cp[0]/255,cp[1]/255,cp[2]/255,cp[3]/255),cv.getLineThickness(),cv.getLinetype()),point:new bg.PointAttributes()};cF.primitive.attr=cC;var cs=cB.edgePrimitivesSets.length;for(var cE=0;cE<cs;cE++){var cK=cB.edgePrimitivesSets[cE];if(bg.isEqualGAS(cK.attr,cF.primitive.attr)){cK.set.push(cF.primitive);cK.nbIndices+=cF.primitive.count;break}}if(cE==cB.edgePrimitivesSets.length){var ct={};ct.attr=cF.primitive.attr;ct.nbIndices=cF.primitive.count;ct.set=[];ct.set.push(cF.primitive);cB.edgePrimitivesSets.push(ct)}}}cB.nbElPoints=cL.readCompressedInt();if(cB.nbElPoints){for(var cG=(cB.nbElPoints-1);cG>=0;cG--){var co=new cj();co.vertexBuffer=cB.vertexBuffer;co.primitive.indices=cB.indexBuffer;co.unstream(cL);co.primitive.cgmId=co.node.cgmId;if(co.decoration){co.primitive.decoration=co.decoration}cB.nbIndicesTotal+=co.primitive.count;var cs=cB.pointPrimimitivesSets.length;for(cE=0;cE<cs;cE++){var cJ=cB.pointPrimimitivesSets[cE];if(cJ.symbol==co.primitive.symbol){cJ.set.push(co.primitive);cJ.nbIndices+=co.primitive.count;break}}if(cE==cB.pointPrimimitivesSets.length){var ct={};ct.symbol=co.primitive.symbol;ct.nbIndices=co.primitive.count;ct.set=[];ct.set.push(co.primitive);cB.pointPrimimitivesSets.push(ct)}}var cy=cL.readGraphicAttributeSet();var cv=cL.pushGAS(cy,0);var cp=cv.getDisplayedColor();cL.popGAS();if(cv.isNoZ()){cI=true;var cA=cL.popGAS();cA.inherited.setType(0);cL.pushGAS(cA.inherited,cA.inh_mode)}var cC={fill:new bg.FillAttributes(new bg.Color(cp[0]/255,cp[1]/255,cp[2]/255,cp[3]/255)),line:new bg.LineAttributes(new bg.Color(cp[0]/255,cp[1]/255,cp[2]/255,cp[3]/255),cv.getLineThickness(),cv.getLinetype()),point:new bg.PointAttributes(new bg.Color(cp[0]/255,cp[1]/255,cp[2]/255,cp[3]/255))};for(var cG=0;cG<cB.pointPrimimitivesSets.length;cG++){var ct=cB.pointPrimimitivesSets[cG];if(ct.symbol!=cC.point.symbol){var cw=cC.point.clone();cw.symbol=ct.symbol;var cD={fill:cC.fill,line:cC.line,point:cw};ct.attr=cD}else{ct.attr=cC}}}if(!cI){var cv=cL.getGAS();var cn=cv.getType();if(cn==0){var cA=cL.popGAS();cA.inherited.setType(2);cL.pushGAS(cA.inherited,cA.inh_mode)}}cB.addMesh(cL);return cB.rep};var bk=function(){};bk.prototype=Object.create(H.prototype);bk.prototype.constructor=bk;bk.prototype.unstream=function(ct){var co=new an();var cq=ct.readCompressedInt();co.rep.unstream(ct);co.vertexBuffer=new l();co.nbLODFaces=ct.readCompressedInt();if(co.nbLODFaces>0){var cs=[];for(var cp=1;cp<=co.nbLODFaces;++cp){cs.push(ct.readFloat())}var cn=new bt();cn.unstream(ct,co.vertexBuffer);co.sets.push(cn);for(var cp=1;cp<=co.nbLODFaces-2;cp++){var cu=new bt();cu.skip(ct)}var cr=new L();cr.skip(ct)}co.addMesh(ct);return co.rep};var ce=function(){};ce.prototype=Object.create(H.prototype);ce.prototype.constructor=ce;ce.prototype.unstream=function(cq){var cr=new aa();var cp=cq.readCompressedInt();cr.rep.unstream(cq);var cu=new aB();cu.unstream(cq);var cs=cq.getGAS();var ct=cs.getDisplayedColor();var co=[ct[0]/255,ct[1]/255,ct[2]/255,ct[3]/255];var cn=cu.primitive;cr.refPlane.push({rep:cr.rep.node,origin:cn.origin,xAxis:cn.direction1,yAxis:cn.direction2,color:co,length:cn.length,mode:cn.mode});cr.addMesh(cq);return null};var bE=function(){};bE.prototype=Object.create(H.prototype);bE.prototype.constructor=bE;bE.prototype.unstream=function(ct){var cr=new am();var cp=ct.readCompressedInt();cr.rep.unstream(ct);cr.vertexBuffer=new l();cr.nbLODFaces=ct.readCompressedInt();if(cr.nbLODFaces>0){var cs=[];for(var co=1;co<=cr.nbLODFaces;++co){cs.push(ct.readFloat())}var cn=new a7();cn.unstream(ct,cr.vertexBuffer);cr.sets.push(cn);for(var co=1;co<=cr.nbLODFaces-2;co++){var cu=new a7();cu.skip(ct)}var cq=new L();cq.skip(ct)}cr.addMesh(ct);return cr.rep};var aS=function(){};aS.prototype=Object.create(H.prototype);aS.prototype.constructor=aS;aS.prototype.unstream=function(cq){var cr=new bF();var co=cq.readCompressedInt();cr.rep.unstream(cq);cr.vertexBuffer=new l();var cp=cq.readUnsignedChar();if(cp>0){var cn=new bo();cn.unstream(cq);cr.gp=cn}cr.addMesh(cq);return cr.rep};var ac=function(){};ac.prototype=Object.create(H.prototype);ac.prototype.constructor=ac;ac.prototype.unstream=function(cp){var cq=new br();var co=cp.readCompressedInt();cq.rep.unstream(cp);cq.vertexBuffer=new l();var cn=new b6();cn.unstream(cp);cq.gp=cn;cq.addMesh(cp);return cq.rep};var bh=function(){};bh.prototype=Object.create(H.prototype);bh.prototype.constructor=bh;bh.prototype.unstream=function(cp){var cq=new cl();var co=cp.readCompressedInt();cq.rep.unstream(cp);cq.vertexBuffer=new l();var cn=new L();cn.unstream(cp);cq.gp=cn;cq.addMesh(cp);return cq.rep};var bm=function(){};bm.prototype=Object.create(H.prototype);bm.prototype.constructor=bm;bm.prototype.getAxisSystemInfo=function(cp){var co=cp.getCurrentPosition();b4.prototype.skip.call(this,cp);var cn;var cr=0;if(cp.version>=210042110){cn=cp.readFloat();cr=cp.readCompressedInt()}else{cn=cp.readCompressedInt()}var cq=cp.readCompressedInt();cp.setCurrentPosition(co);return{isMonoPlane:cq,mode:cr,axisLength:cn}};bm.prototype.unstream=function(cp){var co=cp.readCompressedInt();var cs=this.getAxisSystemInfo(cp);b4.prototype.unstream.call(this,cp,cs);var cn;if(cp.version>=210042110){cn=cp.readFloat();var cr=cp.readCompressedInt()}else{cn=cp.readCompressedInt()}var cq=cp.readCompressedInt();return null};var bw=function(){};bw.prototype=Object.create(H.prototype);bw.prototype.constructor=bw;bw.prototype.unstream=function(cr){var cp=new ab();var co=cr.readCompressedInt();cp.rep.unstream(cr);cp.vertexBuffer=new l();var cq=cr.readUnsignedChar();if(cq>0){var cn=new bH();cn.unstream(cr);cp.gp=cn}cp.addMesh(cr);return cp.rep};var a2=function(){};a2.prototype=Object.create(H.prototype);a2.prototype.constructor=a2;a2.prototype.unstream=function(cq){var cp=new U();var co=cq.readCompressedInt();cp.rep.unstream(cq);cp.vertexBuffer=new l();var cn=new bI();cn.unstream(cq);cp.gp=cn;cp.addMesh(cq);return cp.rep};var aj=function(){};aj.prototype=Object.create(H.prototype);aj.prototype.constructor=aj;aj.prototype.unstream=function(cr){var cs=new bM();var cq=cr.readCompressedInt();cs.rep.unstream(cr);cs.vertexBuffer=new l();cs.unstreamPerforatedPolygon(cr);var cp=cr.readCompressedInt();for(var co=0;co<cp;co++){var cn=new bD();cn.unstream(cr);cs.gp.push(cn)}if(cs.gp.length){cs.addMesh(cr);return cs.rep}cr.popMatId();cr.popGAS();return null};var bO=function(){};bO.prototype=Object.create(H.prototype);bO.prototype.constructor=bO;bO.prototype.unstream=function(cq){var cr=new b2();var cp=cq.readCompressedInt();cr.rep.unstream(cq);cr.vertexBuffer=new l();var co=new bD();var cn=co.unstream(cq);cr.gp=co;if(cn){cr.addMesh(cq);return cr.rep}else{return null}};var C=function(){};C.prototype=Object.create(H.prototype);C.prototype.constructor=C;C.prototype.unstream=function(cq){var cr=new bY();var cp=cq.readCompressedInt();cr.rep.unstream(cq);cr.vertexBuffer=new l();var co=new y();var cn=co.unstream(cq);cr.gp=co;if(cn&&co){if((typeof co.zoomQuality!=="undefined")&&(co.zoomQuality===0)){cq.setFixMode(true)}if(co.point){cq.pushStaticMode(cq.getCurrentMatrix());cq.currentMatrix.push(new aq.Matrix4())}if(co.primitive.material){cq.pushMatId(co.primitive.material,1,0)}cr.gp=co;cr.addMesh(cq);cq.setFixMode(false);if(co.primitive.material){cq.popMatId()}if(co.point){cq.currentMatrix.pop();cq.popStaticMode()}return cr.rep}return null};var a9={LINES:0,LINE_STRIP:1,LINE_LOOP:2};var bs=function(){this.node=new bg.SGPrimitive();this.vertexBuffer=null;this.primitive=null;this.decoration=0};bs.prototype=Object.create(bs.prototype);bs.prototype.constructor=bs;bs.prototype.unstreamPrimitive=function(cq){this.node.cgmId=0;this.decoration=0;if(cq.version>=1100700){this.node.cgmId=cq.readUncompressedInt()}else{if(cq.version>=1100200){this.node.cgmId=cq.readCompressedInt()}}if(cq.version>=1100800){var cn=cq.readUnsignedShort();if(cn>0){if((cn!=1)&&(cn!=65535)){var co=cq.decorations;var cr=[];cr.push(cn);for(var cp=0;cp<cn;cp++){cr.push(cq.readUnsignedChar())}this.decoration=co.addDecoration(cr)}}}};bs.prototype.create2DArcCircleGP=function(cv,cr,co,cw,cs,cu,cn,cx,cy){cr.start=0;if(cn<cu){cn+=Math.PI*2}var ct=cv.posBuffer.length/3;if(cy){cr.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;cr.count+=(cx-2)*3;for(var cq=0;cq<cx;++cq){var cp=cu+(cn-cu)*cq/(cx-1);cv.posBuffer.push(co+cs*Math.cos(cp));cv.posBuffer.push(cw+cs*Math.sin(cp));cv.posBuffer.push(0);cv.normalBuffer.push(0);cv.normalBuffer.push(0);cv.normalBuffer.push(1)}for(var cq=1;cq<cx-1;cq++){cr.indices.push(0);cr.indices.push(cq);cr.indices.push(cq+1)}}else{cr.connectivity=bg.ConnectivityTypeEnum.LINES;cr.count+=2+(cx-2)*2;var cp=cu;cv.posBuffer.push(co+cs*Math.cos(cp));cv.posBuffer.push(cw+cs*Math.sin(cp));cv.posBuffer.push(0);for(var cq=1;cq<cx;++cq){cp=cu+(cn-cu)*cq/(cx-1);cr.indices.push(ct++);cv.posBuffer.push(co+cs*Math.cos(cp));cv.posBuffer.push(cw+cs*Math.sin(cp));cv.posBuffer.push(0);cr.indices.push(ct)}}};bs.prototype.createPolylineGP=function(co,cn,cq,cr){cn.start=0;cn.connectivity=bg.ConnectivityTypeEnum.LINES;switch(cr){case 0:cn.count+=cq;for(var cp=0;cp<cq;++cp){cn.indices.push(co++)}break;case 1:cn.count+=2+(cq-2)*2;for(var cp=1;cp<cq;++cp){cn.indices.push(co++);cn.indices.push(co)}break;case 2:cn.count+=4+(cq-2)*2;var cs=co;for(var cp=0;cp<(cq-1);++cp){cn.indices.push(co++);cn.indices.push(co)}cn.indices.push(co);cn.indices.push(cs);break;default:return null;break}};bs.prototype.createPolygonGP=function(ct,cs,cw,cn,cu,cx){cs.start=0;if(cx){cs.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;var co=0;switch(cu){case 0:case 4:cs.count+=cn;for(var cp=0;cp<cn;++cp){cs.indices.push(cw[ct++])}break;case 1:case 5:cs.count+=(cn-2)*3;var cy=0;for(var cp=0;cp<cn-2;cp++){cs.indices.push(cw[ct]);cs.indices.push(cw[ct+1+cy]);cs.indices.push(cw[ct+2-cy]);ct++;cy=1-cy}ct+=2;break;case 2:case 6:cs.count+=(cn-2)*3;var cr=cw[ct];for(var cp=0;cp<cn-2;cp++){cs.indices.push(cr);cs.indices.push(cw[ct+2]);cs.indices.push(cw[ct+1]);ct++}ct+=2;break;default:return null;break}}else{cs.connectivity=bg.ConnectivityTypeEnum.LINES;cs.count=2+(cn-1)*2;var cv=ct;for(var cq=1;cq<cn;++cq){cs.indices.push(ct++);cs.indices.push(ct)}cs.indices.push(ct);cs.indices.push(cv)}return ct};var bc=function(){bs.call(this);this.boundingBoxCenter=new Float32Array(3);this.boundingBoxDim=new Float32Array(3);this.boundingSphere=null};bc.prototype=Object.create(bs.prototype);bc.prototype.constructor=bc;bc.prototype.unstreamBBox=function(cp){this.unstreamPrimitive(cp);for(var co=0;co<3;co++){this.boundingBoxCenter[co]=cp.readFloat()}for(var co=0;co<3;co++){this.boundingBoxDim[co]=cp.readFloat()}var cq=new Array(3);for(var co=0;co<3;co++){cq[co]=cp.readFloat()}var cn=cp.readFloat();if(g){this.boundingSphere={center:cq,radius:cn}}};var a5=function(){bc.call(this)};a5.prototype=Object.create(bc.prototype);a5.prototype.constructor=a5;a5.prototype.unstream=function(cI){var cr;if(cI.version>=1101410){this.unstreamBBox(cI);if(cI.getLightDataStreaming()){this.primitive=new Z();this.primitive.unstream(cI);var cq=cI.readUnsignedChar();if(cq){this.vertexBuffer=new l();this.vertexBuffer.unstream(cI)}}if(cI.version>=1101430){cr=cI.readUnsignedChar()}else{cr=0}return}this.unstreamBBox(cI);var co,cx;var cJ=cI.readCompressedInt();var cu=cI.readCompressedInt();var cH=cI.readCompressedInt();var cp=cI.readCompressedInt();var cw=cI.readCompressedInt();this.primitive=new Z();if(cI.version>=1100700){co=cI.readUnsignedChar()}var cx=cI.readUnsignedChar();var ct=(cx&1)||(cx&2);var cF=(cx&4)||(cx&8);if(!this.vertexBuffer){this.vertexBuffer=new l()}if(ct){cI.readFloatArray(0,cJ,this.vertexBuffer.posBuffer);var cC=cI.readUnsignedChar();if(cC){cI.readFloatArray(0,cJ,this.vertexBuffer.uvBuffer)}if(cI.version>1100820){multiple_texture=cI.readUnsignedChar()}}if(cF){if(cI.version>1000800){cI.readShortArray(cu,this.vertexBuffer.normalBuffer);var cy=1/32767;for(var cE=0;cE<cu;cE++){this.vertexBuffer.normalBuffer[cE]*=cy}}else{cI.readFloatArray(0,cu,this.vertexBuffer.normalBuffer)}}if(cH){if(cI.version>=1100600){cI.unpackcArray(3*cH,this.primitive.indices,0)}else{if(cI.version>1000500){cI.unpackcArray(3*cH,this.primitive.indices,0)}else{this.primitive.indices=cI.readUncompressedIntArray((3*cH),this.primitive.indices)}}}var cz=[];var cB=this.primitive.indices.length;if(cp){var cG=[];if(cI.version>1000500){cI.unpackcArray(cp,cG,0)}else{cI.readUncompressedIntArray(cp,cG)}for(cE=(cp-1);cE>=0;cE--){var cA=cG[cE];if(cI.version>=1100600){cI.unpackcArray(cA,cz,0)}else{if(cI.version>1000500){cI.unpackcArray(cA,cz,0)}else{cI.readUncompressedIntArray(cA,cz)}}for(var cD=2;cD<cA;++cD){if(cD%2){this.primitive.indices[cB++]=cz[cD];this.primitive.indices[cB++]=cz[cD-1];this.primitive.indices[cB++]=cz[cD-2]}else{this.primitive.indices[cB++]=cz[cD-1];this.primitive.indices[cB++]=cz[cD];this.primitive.indices[cB++]=cz[cD-2]}}}}if(cw){var cs=[];if(cI.version>1000500){cI.unpackcArray(cw,cs,0)}else{cI.readUncompressedIntArray(cw,cs)}for(cE=(cw-1);cE>=0;cE--){var cn=cs[cE];if(cI.version>=1100600){cI.unpackcArray(cn,cz,0)}else{if(cI.version>1000500){cI.unpackcArray(cn,cz,0)}else{cI.readUncompressedIntArray(cn,cz)}}for(var cD=2;cD<cn;++cD){this.primitive.indices[cB++]=cz[0];this.primitive.indices[cB++]=cz[cD-1];this.primitive.indices[cB++]=cz[cD]}}}var cv=cI.readUnsignedChar();if(cv){cI.readFloatArray(0,(cJ*2)/3,this.vertexBuffer.uvBuffer)}if(!cJ&&cu==3){this.planarNormals=this.vertexBuffer.normalBuffer}else{if(cJ&&cu==3){this.planarNormals=this.vertexBuffer.normalBuffer}else{if(cJ||cu){}}}};var A=function(){a5.call(this)};A.prototype=Object.create(a5.prototype);A.prototype.constructor=A;var af=function(){bs.call(this)};af.prototype=Object.create(bs.prototype);af.prototype.constructor=af;af.prototype.unstream=function(co){if(co.version>=210021710){this.unstreamPrimitive(co);var cn=co.readCompressedUInt()}};var ai=function(){bs.call(this);this.fref1=null;this.fref2=null;this.vizEdge=null};ai.prototype=Object.create(bs.prototype);ai.prototype.constructor=ai;ai.prototype.unstream=function(cn){if(cn.version>=1101410){this.unstreamPrimitive(cn);if(cn.getLightDataStreaming()){this.vizEdge=new K();this.vizEdge.unstream(cn);this.vertexBuffer=new l();this.vertexBuffer.posBuffer=vizEdge.linePos}return}};var aR=function(){ai.call(this)};aR.prototype=Object.create(ai.prototype);aR.prototype.constructor=aR;aR.prototype.unstream=function(cn){ai.prototype.unstream.call(this,cn);if(cn.readBoolean()){var co=cn.readCompressedUInt();if(co){cn.skip(3*co*4)}}};var bt=function(){bc.call(this)};bt.prototype=Object.create(bc.prototype);bt.prototype.constructor=bt;bt.prototype.unstream=function(cJ,cH){this.unstreamBBox(cJ);var cI=cJ.readCompressedInt();var cB=cJ.readCompressedInt();var cw=new Float32Array(3);cw[0]=cJ.readFloat();cw[1]=cJ.readFloat();cw[2]=cJ.readFloat();var cx=1/Math.sqrt(cw[0]*cw[0]+cw[1]*cw[1]+cw[2]*cw[2]);var cy=new Float32Array(3);cy[0]=cx*cw[0];cy[1]=cx*cw[1];cy[2]=cx*cw[2];var cq=true;var cA=new Float32Array(12*cI);var cv=new Float32Array(12*cI);var cp=new Uint32Array(12*(cI-1));var cK=0;var cz=0;var cE=0;for(var cC=0;cC<cI;cC++){cA[cK++]=cJ.readFloat();cA[cK++]=cJ.readFloat();cA[cK++]=cJ.readFloat()}var cF=new Float32Array(3);for(var cC=0;cC<3;cC++){cF[cC]=cJ.readFloat()}var cG=new Float32Array(3);for(var cC=0;cC<3;cC++){cG[cC]=cJ.readFloat()}if(cI>2){var co=new aq.Vector3(cA[3]-cA[0],cA[4]-cA[1],cA[5]-cA[2]);var cn=new aq.Vector3(cA[0]+cw[0]-cA[3],cA[1]+cw[1]-cA[4],cA[2]+cw[2]-cA[5]);co.normalize();cn.normalize();co.cross(cn);co.normalize();var ct=new aq.Vector3(cF[0],cF[1],cF[2]);var cD=co.dot(ct);if(cD<0){cq=false}}var cs=(2*Math.PI)/cI;if(cq){for(var cC=0;cC<cI;cC++){var cL=Math.cos(cC*cs);var cr=Math.sin(cC*cs);cv[cz++]=cL*cF[0]+cr*cG[0];cv[cz++]=cL*cF[1]+cr*cG[1];cv[cz++]=cL*cF[2]+cr*cG[2]}}else{for(var cC=cI;cC>0;cC--){var cL=Math.cos(cC*cs);var cr=Math.sin(cC*cs);cv[cz++]=cL*cF[0]+cr*cG[0];cv[cz++]=cL*cF[1]+cr*cG[1];cv[cz++]=cL*cF[2]+cr*cG[2]}}for(var cC=0;cC<cI;cC++){cA[cK++]=cA[cC*3]+cw[0];cA[cK++]=cA[cC*3+1]+cw[1];cA[cK++]=cA[cC*3+2]+cw[2];cv[cz++]=cv[cC*3];cv[cz++]=cv[cC*3+1];cv[cz++]=cv[cC*3+2]}if(cq){for(var cC=0;cC<cI-1;cC++){cp[cE++]=cC;cp[cE++]=cC+1;cp[cE++]=cC+cI;cp[cE++]=cC+cI;cp[cE++]=cC+1;cp[cE++]=cC+1+cI}cp[cE++]=0;cp[cE++]=cI;cp[cE++]=cI-1;cp[cE++]=cI*2-1;cp[cE++]=cI-1;cp[cE++]=cI}else{for(var cC=0;cC<cI-1;cC++){cp[cE++]=cC+cI;cp[cE++]=cC+1+cI;cp[cE++]=cC;cp[cE++]=cC;cp[cE++]=cC+1+cI;cp[cE++]=cC+1}cp[cE++]=cI;cp[cE++]=0;cp[cE++]=cI*2-1;cp[cE++]=cI-1;cp[cE++]=cI*2-1;cp[cE++]=0}var cu=cK/3;for(var cC=0;cC<cI;cC++){cv[cz++]=-cy[0];cv[cz++]=-cy[1];cv[cz++]=-cy[2];cA[cK++]=cA[cC*3];cA[cK++]=cA[cC*3+1];cA[cK++]=cA[cC*3+2]}if(cq){for(var cC=0;cC<cI-2;cC++){cp[cE++]=cu;cp[cE++]=cu+cI-1-cC;cp[cE++]=cu+cI-2-cC}}else{for(var cC=0;cC<cI-2;cC++){cp[cE++]=cu;cp[cE++]=cu+cI-2-cC;cp[cE++]=cu+cI-1-cC}}var cu=cK/3;for(var cC=0;cC<cI;cC++){cv[cz++]=cy[0];cv[cz++]=cy[1];cv[cz++]=cy[2];cA[cK++]=cA[(cC+cI)*3];cA[cK++]=cA[(cC+cI)*3+1];cA[cK++]=cA[(cC+cI)*3+2]}if(cq){for(var cC=0;cC<cI-2;cC++){cp[cE++]=cu;cp[cE++]=cu+cI-2-cC;cp[cE++]=cu+cI-1-cC}}else{for(var cC=0;cC<cI-2;cC++){cp[cE++]=cu;cp[cE++]=cu+cI-1-cC;cp[cE++]=cu+cI-2-cC}}if(cB>0){cJ.skip(3*cB*4)}if(!cH){this.vertexBuffer=new l();this.vertexBuffer.posBuffer=cA;this.vertexBuffer.normalBuffer=cv;this.primitive=new bx();this.primitive.indices=cp}else{cH.posBuffer=cA;cH.normalBuffer=cv;this.indices=cp}};bt.prototype.skip=function(cp){this.unstreamBBox(cp);var cn=cp.readCompressedInt();var co=cp.readCompressedInt();cp.skip(12);cp.skip(12*cn);cp.skip(24);cp.skip(12*co)};var a7=function(){bc.call(this)};a7.prototype=Object.create(bc.prototype);a7.prototype.constructor=a7;a7.prototype.unstream=function(cI,cG){this.unstreamBBox(cI);var cx=cI.readCompressedInt();var cy=new Float32Array(3*cx);for(var cC=0;cC<3*cx;cC++){cy[cC]=cI.readFloat()}var cF=cI.readCompressedInt();var cs=cF*(cx+2);var cz=new Float32Array(3*cs);for(var cC=0;cC<3*(cF*cx);cC++){cz[cC]=cI.readFloat()}var cu=3*(cF*cx);var cJ=3*(cF*(cx+1));for(var cC=0,cA=3*cF-3;cC<3*cF;cC+=3,cA-=3){cz[cu+cC]=cz[cC];cz[cu+cC+1]=cz[cC+1];cz[cu+cC+2]=cz[cC+2];cz[cJ+cC]=cz[cu-3*cF+cA];cz[cJ+cC+1]=cz[cu-3*cF+cA+1];cz[cJ+cC+2]=cz[cu-3*cF+cA+2]}var cw=new Float32Array(3);for(var cC=0;cC<3;cC++){cw[cC]=cI.readFloat()}var cH=new Float32Array(3);for(var cC=0;cC<3;cC++){cH[cC]=cI.readFloat()}var cn=cI.readFloat();var cv=new Float32Array(3*cs);var cr,cq,co;for(var cC=0,cA=cF-1,cD=0;cC<cF*cx;cC++,cA--){cr=(cz[3*cC]-cy[3*cD])*cn;cq=(cz[3*cC+1]-cy[3*cD+1])*cn;co=(cz[3*cC+2]-cy[3*cD+2])*cn;if(cr==0&&cq==0&&co==0){if(cD==0){nnormalBuffer[3*cC]=cw[0];cv[3*cC+1]=cw[1];cv[3*cC+2]=cw[2]}else{cv[3*cC]=cH[0];cv[3*cC+1]=cH[1];cv[3*cC+2]=cH[2]}}else{cv[3*cC]=cr;cv[3*cC+1]=cq;cv[3*cC+2]=co}if(cA==0){cA=cF;cD++}}for(var cC=0;cC<3*cF;cC+=3){cv[cu+cC]=cw[0];cv[cu+cC+1]=cw[1];cv[cu+cC+2]=cw[2];cv[cJ+cC]=cH[0];cv[cJ+cC+1]=cH[1];cv[cJ+cC+2]=cH[2]}var cE=0;var cp=new Uint32Array(6*(cx-1)*(cF)+((cF-2)*6));for(var cC=1;cC<cx;cC++){for(var cA=0;cA<cF-1;cA++){cp[cE++]=cA+1+((cC-1)*cF);cp[cE++]=cA+((cC-1)*cF);cp[cE++]=cA+(cC*cF);cp[cE++]=cA+1+((cC-1)*cF);cp[cE++]=cA+(cC*cF);cp[cE++]=cA+1+(cC*cF)}cp[cE++]=(cC*cF);cp[cE++]=((cC-1)*cF);cp[cE++]=(cC*cF)-1;cp[cE++]=(cC*cF)-1;cp[cE++]=((1+cC)*cF)-1;cp[cE++]=(cC*cF)}var ct=cF*cx;for(var cC=0;cC<cF-2;cC++){cp[cE++]=ct;cp[cE++]=ct+cF-2-cC;cp[cE++]=ct+cF-1-cC}ct=cF*(cx+1);for(var cC=0;cC<cF-2;cC++){cp[cE++]=ct;cp[cE++]=ct+cF-2-cC;cp[cE++]=ct+cF-1-cC}var cB=cI.readCompressedInt();cI.skip(3*cB*4);if(!cG){this.vertexBuffer=new l();this.vertexBuffer.posBuffer=cz;this.vertexBuffer.normalBuffer=cv;this.primitive=new bx();this.primitive.indices=cp}else{cG.posBuffer=cz;cG.normalBuffer=cv;this.indices=cp}};a7.prototype.skip=function(cp){this.unstreamBBox(cp);var cq=cp.readCompressedInt();cp.skip(3*cq*4);var cn=cp.readCompressedInt();cp.skip(3*cn*cq*4);cp.skip(12);cp.skip(12);cp.skip(4);var co=cp.readCompressedInt();cp.skip(3*co*4)};var cj=function(){bs.call(this);this.noRender=true;this.primitive=new bx();this.vertexBuffer=null};cj.prototype=Object.create(bs.prototype);cj.prototype.constructor=cj;cj.prototype.unstream=function(cp){this.unstreamPrimitive(cp);if(cp.getLightDataStreaming()){if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.symbol=cp.readCompressedInt();var cn=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=bg.ConnectivityTypeEnum.POINTS;var cq=cp.readCompressedInt();this.primitive.count=cq;for(var co=0;co<cq;co++){this.vertexBuffer.posBuffer.push(cp.readFloat());this.vertexBuffer.posBuffer.push(cp.readFloat());this.vertexBuffer.posBuffer.push(cp.readFloat());this.primitive.indices.push(cn++)}}};var M=function(){bs.call(this);this.noRender=true};M.prototype=Object.create(bs.prototype);M.prototype.constructor=M;M.prototype.unstream=function(cv){this.unstreamPrimitive(cv);var ct=cv.readFloat();var cr=cv.readFloat();var co=cv.readFloat();var cq=cv.readFloat();var cu=cv.readFloat();var cn=cv.readFloat();var cw=cv.readCompressedInt();var cs=cv.readCompressedInt();if(cv.version<210042210){var cx=cv.readCompressedInt();if(cx>0){var cp=cv.readStringWithLength()}}else{var cx=cv.readUncompressedULong();if(cx>0){cv.skip(cx*2)}}this.primitive={origin:[ct,cr,co],direction:[cq,cu,cn]}};var aB=function(){bs.call(this);this.noRender=true};aB.prototype=Object.create(bs.prototype);aB.prototype.constructor=aB;aB.prototype.unstream=function(cv){this.unstreamPrimitive(cv);if(cv.getLightDataStreaming()){var cr=cv.readFloat();var cq=cv.readFloat();var cn=cv.readFloat();var cy=cv.readFloat();var cu=cv.readFloat();var cp=cv.readFloat();var cx=cv.readFloat();var ct=cv.readFloat();var co=cv.readFloat();var cw=cv.readFloat();var cs=0;if(cv.version>=1100910){cs=cv.readUnsignedChar()}this.primitive={origin:[cr,cq,cn],direction1:[cy,cu,cp],direction2:[cx,ct,co],length:cw,mode:cs}}};var J=function(){bs.call(this);this.noRender=true};J.prototype=Object.create(bs.prototype);J.prototype.constructor=J;J.prototype.unstream=function(cs){this.unstreamPrimitive(cs);var cq=cs.readFloat();var cp=cs.readFloat();var cn=cs.readFloat();var ct=cs.readFloat();var cr=cs.readCompressedInt();var cu=cs.readCompressedInt();var cv=cs.readCompressedInt();if(cv){var co=cs.readString(cv)}};var S=function(){bs.call(this);this.noRender=true};S.prototype=Object.create(bs.prototype);S.prototype.constructor=S;S.prototype.unstream=function(cv){this.unstreamPrimitive(cv);var ct=cv.readFloat();var cr=cv.readFloat();var co=cv.readFloat();var cq=cv.readFloat();var cu=cv.readFloat();var cn=cv.readFloat();var cw=cv.readCompressedInt();var cs=cv.readCompressedInt();var cx=cv.readCompressedInt();if(cx){var cp=cv.readStringWithLength()}this.primitive={origin:[ct,cr,co],direction:[cq,cu,cn]}};var F=function(){bs.call(this);this.noRender=true};F.prototype=Object.create(bs.prototype);F.prototype.constructor=F;F.prototype.unstream=function(cn){this.unstreamPrimitive(cn);cn.skip(47)};var c=function(){bs.call(this);this.noRender=true};c.prototype=Object.create(bs.prototype);c.prototype.constructor=c;c.prototype.unstream=function(cn){this.unstreamPrimitive(cn);cn.readFloat();cn.readFloat();cn.readFloat();cn.readFloat();cn.readCompressedInt();cn.readFloat();cn.readFloat();cn.readFloat();cn.readFloat();cn.readFloat();cn.readFloat();cn.readFloat();cn.readFloat();cn.readFloat()};var aT=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.point=[];this.zoomQuality=0;this.imageGP=true;this.noRender=true};aT.prototype=Object.create(bs.prototype);aT.prototype.constructor=aT;aT.prototype.unstream=function(cA){this.unstreamPrimitive(cA);var cn="";var cq=cA.readUnsignedChar();if(cq){var cs=new bJ();var ct=cs.unstream(cA);this.point.push(cA.readFloat());this.point.push(cA.readFloat());this.point.push(cA.readFloat());var cy=cA.readCompressedInt();var cp=cA.readCompressedInt();var cr=cA.readCompressedInt();if(ct==null){return false}var cv=cA.textures.add(ct);var co=ct.width;var cB=ct.height;if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cx=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.posBuffer.push(co);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.posBuffer.push(co);this.vertexBuffer.posBuffer.push(cB);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.primitive.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;this.primitive.count=6;this.primitive.indices.push(cx);this.primitive.indices.push(cx+1);this.primitive.indices.push(cx+2);this.primitive.indices.push(cx+2);this.primitive.indices.push(cx+3);this.primitive.indices.push(cx+0);this.vertexBuffer.hasTextures=true;this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(0);var cw={textureId:cv,shading:"Basic",primWithMaterials:true,useAsGas:true};var cu=cA.materials.add(cw);var cz={file:"",id:cu};this.primitive.material=cz;return true}return false};var bp={CROSS:1,PLUS:2,OPEN_ARROW:14,UNFILLED_ARROW:15,BLANKED_ARROW:16,FILLED_ARROW:17,UNFILLED_CIRCLE:18,BLANKED_CIRCLE:19,FILLED_CIRCLE:20,CROSSED_CIRCLE:21,BLANKED_SQUARE:22,FILLED_SQUARE:23,BLANKED_TRIANGLE:24,FILLED_TRIANGLE:25,MANIPULATOR_SQUARE:26,MANIPULATOR_DIAMOND:27,MANIPULATOR_CIRCLE:28,MANIPULATOR_TRIANGLE:29,DOUBLE_OPEN_ARROW:30,WAVE:31,DOUBLE_FILLED_ARROW:32};var aQ=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx()};aQ.prototype=Object.create(bs.prototype);aQ.prototype.constructor=aQ;aQ.prototype.lineType=null;aQ.prototype.unstream=function(co){this.unstreamPrimitive(co);var cq=co.readUnsignedChar();var cp=[];co.readFloatArray(0,4,cp);if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cn=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cp[0]);this.vertexBuffer.posBuffer.push(cp[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cp[2]);this.vertexBuffer.posBuffer.push(cp[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cp[2]);this.vertexBuffer.posBuffer.push(cp[3]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cp[0]);this.vertexBuffer.posBuffer.push(cp[3]);this.vertexBuffer.posBuffer.push(0);if(cq){this.primitive.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;this.primitive.count=6;this.primitive.indices.push(cn);this.primitive.indices.push(cn+1);this.primitive.indices.push(cn+2);this.primitive.indices.push(cn+2);this.primitive.indices.push(cn+3);this.primitive.indices.push(cn+0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1)}else{this.primitive.connectivity=bg.ConnectivityTypeEnum.LINES;this.primitive.count=8;this.primitive.indices.push(cn);this.primitive.indices.push(cn+1);this.primitive.indices.push(cn+1);this.primitive.indices.push(cn+2);this.primitive.indices.push(cn+2);this.primitive.indices.push(cn+3);this.primitive.indices.push(cn+3);this.primitive.indices.push(cn+0)}return true};var bI=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.primitives=[]};bI.prototype=Object.create(bs.prototype);bI.prototype.constructor=bI;bI.prototype.lineType=null;bI.prototype.unstream=function(ct){this.unstreamPrimitive(ct);if(ct.version>1101410){var cB=ct.readCompressedInt();var cz=[];ct.readFloatArray(0,2,cz);var cC=ct.readFloat();var cq=ct.readCompressedInt()}var cw=[];ct.readFloatArray(0,2,cw);var co=new aq.Vector2(cw[0],cw[1]);co.normalize();var cp=ct.readFloat();var cy=cC*Math.tan(cp);if(!this.vertexBuffer){this.vertexBuffer=new l()}var cr=this.vertexBuffer.posBuffer.length/3;if(cq!==bp.WAVE){this.vertexBuffer.posBuffer.push(cz[0]-co.x*cC+co.y*cy);this.vertexBuffer.posBuffer.push(cz[1]-co.y*cC-co.x*cy);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]);this.vertexBuffer.posBuffer.push(cz[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-co.x*cC-co.y*cy);this.vertexBuffer.posBuffer.push(cz[1]-co.y*cC+co.x*cy);this.vertexBuffer.posBuffer.push(0)}switch(cq){case bp.OPEN_ARROW:var cx=new bx();this.createPolylineGP(cr,cx,3,1);this.primitive=cx;break;case bp.UNFILLED_ARROW:var cx=new bx();cx.count=0;var cA=[0,1,2];this.createPolygonGP(0,cx,cA,cA.length,0,false);this.primitive=cx;break;case bp.BLANKED_ARROW:case bp.FILLED_ARROW:var cx=new bx();cx.count=0;var cA=[0,1,2];this.createPolygonGP(0,cx,cA,cA.length,0,true);this.primitive=cx;break;case bp.DOUBLE_OPEN_ARROW:var cx=new bx();this.createPolylineGP(cr,cx,3,1);var cr=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cz[0]-cC*co.x-co.x*cC+co.y*cy);this.vertexBuffer.posBuffer.push(cz[1]-cC*co.y-co.y*cC-co.x*cy);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cC*co.x);this.vertexBuffer.posBuffer.push(cz[1]-cC*co.y);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cC*co.x-co.x*cC-co.y*cy);this.vertexBuffer.posBuffer.push(cz[1]-cC*co.y-co.y*cC+co.x*cy);this.vertexBuffer.posBuffer.push(0);this.createPolylineGP(cr,cx,3,1);this.primitive=cx;break;case bp.DOUBLE_FILLED_ARROW:var cx=new bx();cx.count=0;var cA=[0,1,2];this.createPolygonGP(0,cx,cA,cA.length,0,true);var cr=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cz[0]-cC*co.x-co.x*cC+co.y*cy);this.vertexBuffer.posBuffer.push(cz[1]-cC*co.y-co.y*cC-co.x*cy);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cC*co.x);this.vertexBuffer.posBuffer.push(cz[1]-cC*co.y);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cC*co.x-co.x*cC-co.y*cy);this.vertexBuffer.posBuffer.push(cz[1]-cC*co.y-co.y*cC+co.x*cy);this.vertexBuffer.posBuffer.push(0);var cA=[3,5,4];this.createPolygonGP(0,cx,cA,cA.length,0,true);this.primitive=cx;break;case bp.WAVE:var cp=Math.acos(-co.y);cp=Math.asin(co.x)<0?-cp:cp;var cs=cC*0.5;var cv=cz[0]+cs*co.y;var cu=cz[1]-cs*co.x;var cn=new bx();this.create2DArcCircleGP(this.vertexBuffer,cn,cv,cu,cs,cp,cp+Math.PI,17,false);var cv=cz[0]-cs*co.y;var cu=cz[1]+cs*co.x;this.create2DArcCircleGP(this.vertexBuffer,cn,cv,cu,cs,cp+Math.PI,cp,17,false);this.primitive=cn;break;default:var cn=new bx();this.create2DArcCircleGP(this.vertexBuffer,cn,cz[0],cz[1],cC/2,0,2*Math.PI,17,true);this.primitive=cn;break}return true};var a3=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.primitives=[]};a3.prototype=Object.create(bs.prototype);a3.prototype.constructor=a3;a3.prototype.lineType=null;a3.prototype.unstream=function(cH){this.unstreamPrimitive(cH);var cn=cH.readCompressedInt();var cB=[];cH.readFloatArray(0,2,cB);var cy=cH.readFloat();var cC=cH.readCompressedInt();if(!this.vertexBuffer){this.vertexBuffer=new l()}var co=this.vertexBuffer.posBuffer.length/3;switch(cC){case bp.UNFILLED_CIRCLE:var cr=new bx();this.create2DArcCircleGP(this.vertexBuffer,cr,cB[0],cB[1],cy/2,0,2*Math.PI,17,false);this.primitive=cr;break;case bp.BLANKED_CIRCLE:case bp.MANIPULATOR_CIRCLE:var cr=new bx();this.create2DArcCircleGP(this.vertexBuffer,cr,cB[0],cB[1],cy/2,0,2*Math.PI,17,false);this.primitive=cr;break;case bp.FILLED_CIRCLE:var cr=new bx();this.create2DArcCircleGP(this.vertexBuffer,cr,cB[0],cB[1],cy/2,0,2*Math.PI,17,true);this.primitive=cr;break;case bp.CROSSED_CIRCLE:var cr=new bx();this.create2DArcCircleGP(this.vertexBuffer,cr,cB[0],cB[1],cy/2,0,2*Math.PI,17,true);var cw={backgoundColor:true};var cu=cH.materials.add(cw);cr.material={file:"",id:cu};this.primitives.push(cr);var cq=new bx();this.create2DArcCircleGP(this.vertexBuffer,cq,cB[0],cB[1],cy/2,0,2*Math.PI,17,false);var cs=cy/2;var cA=cs*Math.cos(Math.PI/4);var cG=cs*Math.sin(Math.PI/4);var cx=cs*Math.cos(5*Math.PI/4);var cE=cs*Math.sin(5*Math.PI/4);var co=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cB[0]+cA);this.vertexBuffer.posBuffer.push(cB[1]+cG);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]+cx);this.vertexBuffer.posBuffer.push(cB[1]+cE);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]-cA);this.vertexBuffer.posBuffer.push(cB[1]-cE);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]-cx);this.vertexBuffer.posBuffer.push(cB[1]-cG);this.vertexBuffer.posBuffer.push(0);this.createPolylineGP(co,cq,4,0);this.primitives.push(cq);break;case bp.BLANKED_SQUARE:case bp.FILLED_SQUARE:case bp.MANIPULATOR_SQUARE:case bp.MANIPULATOR_DIAMOND:var cs=cy/2;this.vertexBuffer.posBuffer.push(cB[0]-cs);this.vertexBuffer.posBuffer.push(cB[1]-cs);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]-cs);this.vertexBuffer.posBuffer.push(cB[1]+cs);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]+cs);this.vertexBuffer.posBuffer.push(cB[1]+cs);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]+cs);this.vertexBuffer.posBuffer.push(cB[1]-cs);this.vertexBuffer.posBuffer.push(0);var cz=new bx();cz.count=0;var ct=[0,1,2,0,2,3];this.createPolygonGP(0,cz,ct,ct.length,0,true);this.primitive=cz;break;case bp.BLANKED_TRIANGLE:case bp.FILLED_TRIANGLE:case bp.MANIPULATOR_TRIANGLE:var cs=cy/2;this.vertexBuffer.posBuffer.push(cB[0]);this.vertexBuffer.posBuffer.push(cB[1]+cs);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]-cs);this.vertexBuffer.posBuffer.push(cB[1]-cs);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]+cs);this.vertexBuffer.posBuffer.push(cB[1]-cs);this.vertexBuffer.posBuffer.push(0);var cD=new bx();cD.count=0;var ct=[0,1,2];this.createPolygonGP(0,cD,ct,ct.length,0,true);this.primitive=cD;break;case bp.CROSS:case bp.PLUS:var cv=cy*0.5;var cI=1;var cF=0;if(cC==bp.CROSS){cI=Math.PI/4;cF=-cI}cI*=cv;cF*=cv;this.vertexBuffer.posBuffer.push(cB[0]+cI);this.vertexBuffer.posBuffer.push(cB[1]+cF);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]-cI);this.vertexBuffer.posBuffer.push(cB[1]-cF);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]-cF);this.vertexBuffer.posBuffer.push(cB[1]+cI);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cB[0]+cF);this.vertexBuffer.posBuffer.push(cB[1]-cI);this.vertexBuffer.posBuffer.push(0);var cp=new bx();this.createPolylineGP(co,cp,4,0);this.primitive=cp;break;default:var cr=new bx();this.create2DArcCircleGP(this.vertexBuffer,cr,cB[0],cB[1],cy/2,0,2*Math.PI,17,true);this.primitive=cr;break}return true};var y=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.point=[];this.zoomQuality=2;this.imageGP=true};y.prototype=Object.create(bs.prototype);y.prototype.constructor=y;y.prototype.lineType=null;y.prototype.unstream=function(cz){this.unstreamPrimitive(cz);cz.readFloatArray(0,2,this.point);this.point.push(0);var cq=cz.readCompressedInt();var cx=cz.readCompressedInt();var co=cz.readCompressedInt();var ct=cz.readCompressedInt();this.zoomQuality=cz.readCompressedInt();var cp=null;if(cz.readBoolean()){var cr=new bJ();cp=cr.unstream(cz)}if(cp==null){return false}var cu=cz.textures.add(cp);var cn=cp.width*cp.xPixelSize;var cA=cp.height*cp.yPixelSize;if(this.zoomQuality==0){cn=cp.width;cA=cp.height}if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cw=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(this.point[0]);this.vertexBuffer.posBuffer.push(this.point[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(this.point[0]+cn);this.vertexBuffer.posBuffer.push(this.point[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(this.point[0]+cn);this.vertexBuffer.posBuffer.push(this.point[1]+cA);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(this.point[0]);this.vertexBuffer.posBuffer.push(this.point[1]+cA);this.vertexBuffer.posBuffer.push(0);this.primitive.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;this.primitive.count=6;this.primitive.indices.push(cw);this.primitive.indices.push(cw+1);this.primitive.indices.push(cw+2);this.primitive.indices.push(cw+2);this.primitive.indices.push(cw+3);this.primitive.indices.push(cw+0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(0);this.vertexBuffer.textureBuffer.push(1);this.vertexBuffer.textureBuffer.push(0);var cv={textureId:cu,shading:"Basic",primWithMaterials:true,useAsGas:true};var cs=cz.materials.add(cv);var cy={file:"",id:cs};this.primitive.material=cy;return true};var bX=function(){bs.call(this);this.vertexBuffer=null;this.primitives=[];this.primitive=new bx()};bX.prototype=Object.create(bs.prototype);bX.prototype.constructor=bX;bX.prototype.lineType=null;bX.prototype.unstream=function(cu){this.unstreamPrimitive(cu);var cv=[];var cw=[];var cz=[];var cy=[];cu.readFloatArray(0,2,cv);cu.readFloatArray(0,2,cw);var cs=cu.readFloat();var co=cu.readFloat();var cp=cu.readFloat();var cA=cu.readCompressedInt();cu.readFloatArray(0,10,cz);cu.readFloatArray(0,2,cy);var cr=cu.readStringWithLength();if(!this.vertexBuffer){this.vertexBuffer=new l()}var ct=this.vertexBuffer.posBuffer.length/3;for(var cq=0;cq<5;cq++){this.vertexBuffer.posBuffer.push(coords[cq*2]);this.vertexBuffer.posBuffer.push(coords[cq*2+1]);this.vertexBuffer.posBuffer.push(0)}if(cA){var cn=new bx();cn.node.cgmId=this.primitive.node.cgmId;if(this.primitive.decoration){cn.decoration=this.primitive.decoration}cn.start=cn.indices.length;cn.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;cn.count=3;cn.indices.push(2);cn.indices.push(3);cn.indices.push(4);var cx=new bx();cx.node.cgmId=this.primitive.node.cgmId;if(this.primitive.decoration){cx.decoration=this.primitive.decoration}cx.start=cx.indices.length;cx.connectivity=bg.ConnectivityTypeEnum.LINES;cx.count=2;cx.indices.push(0);cx.indices.push(1);this.primitive.push(cn);this.primitive.push(cx)}else{this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=bg.ConnectivityTypeEnum.LINES;this.primitive.count=8;this.primitive.indices.push(0);this.primitive.indices.push(1);this.primitive.indices.push(2);this.primitive.indices.push(3);this.primitive.indices.push(3);this.primitive.indices.push(4);this.primitive.indices.push(4);this.primitive.indices.push(2)}return true};var r=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.text=null};r.prototype=Object.create(bs.prototype);r.prototype.constructor=r;r.prototype.lineType=null;r.prototype.unstream=function(ct){this.unstreamPrimitive(ct);var cv=[];ct.readFloatArray(0,2,cv);var cx=ct.readFloat();var cq=ct.readCompressedInt();var cr=ct.readCompressedInt();var cu=null;var cs=null;if(ct.readBoolean()){cu=ct.readGraphicAttributeSet()}if(ct.readBoolean()){cs=ct.readGraphicAttributeSet()}var cn=ct.readCompressedInt();if(cn>0){var cp="";var cw=[];ct.readShortArray(cn,cw);for(var co=0;co<cn;co++){cp+=String.fromCharCode(cw[co])}}this.text={text:cp,anchor:{x:cv[0],y:cv[1]},height:cx};return false};var bl=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.nodes=[]};bl.prototype=Object.create(bs.prototype);bl.prototype.constructor=bl;bl.prototype.lineType=null;bl.prototype.unstream=function(cR){this.unstreamPrimitive(cR);var cv=cR.readCompressedInt();var cJ=cR.readCompressedInt();var cQ=cR.readCompressedInt();var cE=cR.readCompressedInt();var cL=cR.readCompressedInt();var cr=cR.readFloat();var co=cR.readFloat();var cp=cR.readFloat();var cy=[];if(cv>0&&cJ>0){var cG=[];var cN=[];cR.readFloatArray(0,2*cJ,cG);cR.readFloatArray(0,cv,this.nodes);cR.readFloatArray(0,cJ,cN)}if(cQ>0){var cP=[];cR.readFloatArray(0,2*cQ,cP)}if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cn=this.vertexBuffer.posBuffer.length/3;this.primitive.connectivity=bg.ConnectivityTypeEnum.LINES;if(cE){cR.readFloatArray(0,2*cE,cy);for(var cM=0;cM<cE;cM++){this.primitive.indices.push(cn++);this.vertexBuffer.posBuffer.push(cy[cM*2]);this.vertexBuffer.posBuffer.push(cy[cM*2+1]);this.vertexBuffer.posBuffer.push(0);this.primitive.indices.push(cn)}this.primitive.count=2*cE-2;return true}else{var cC=0.01;var cO=co-cr;if(cO==0){return false}var cs=((Math.PI/Math.acos(1-(cC/cp)))*0.5+0.5);if(cs>100){cs=100}var cF=cs+1;var cu=cO/cs;var cB,cA,cD;cD=cr;var ct=1;var cw=true;for(var cK=0;cK<(cs+1);cK++){var cq,cz,cx,cH;cq=0;cz=0;cx=0;cH=0;var cI=0;for(var cM=0;cM<cJ;cM++){if((Math.abs(cD-co)<=0.00001)&&(cM==(cJ-1))){cH=1}else{cH=this.computeBSplineBase(cM,cL,cD,ct)}cq+=(cH*cG[cI]*cN[cM]);cz+=(cH*cG[cI+1]*cN[cM]);cx+=(cH*cN[cM]);cI+=2}if(cx<=1e-15){cF--}else{cB=cq/cx;cA=cz/cx;this.vertexBuffer.posBuffer.push(cB);this.vertexBuffer.posBuffer.push(cA);this.vertexBuffer.posBuffer.push(0);if(!cw){this.primitive.indices.push(cn++);this.primitive.indices.push(cn)}cw=false}cD=cr+(cK+1)*cu}if(cF>0){this.primitive.count=2*cF-2;return true}return false}};bl.prototype.computeBSplineBase=function(cr,cq,cu,cs){var cv=0;if(cq==1){if((cu>=this.nodes[cr])&&(cu<this.nodes[cr+1])){cv=1}else{cv=0}}else{if((cu<this.nodes[cr])||(cu>=this.nodes[cr+cq])){cv=0}else{var co=this.computeBSplineBase(cr,cq-1,cu,cs);var cw=this.computeBSplineBase(cr+1,cq-1,cu,cs);var ct=0.000001*cs;var cp;if(Math.abs(this.nodes[cr]-this.nodes[cr+cq-1])<=ct){cp=0}else{cp=(cu-this.nodes[cr])/(this.nodes[cr+cq-1]-this.nodes[cr])}var cn;if(Math.abs(this.nodes[cr+1]-this.nodes[cr+cq])<=ct){cn=0}else{cn=(this.nodes[cr+cq]-cu)/(this.nodes[cr+cq]-this.nodes[cr+1])}cv=cp*co+cn*cw}}return cv};var a1=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx()};a1.prototype=Object.create(bs.prototype);a1.prototype.constructor=a1;a1.prototype.lineType=null;a1.prototype.unstream=function(cV){this.unstreamPrimitive(cV);var cR=cV.readCompressedInt();var cL=[];if(cR>0){cV.readFloatArray(0,2*cR,cL);if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cn=this.vertexBuffer.posBuffer.length/3;this.primitive.connectivity=bg.ConnectivityTypeEnum.LINES;if(cR<4){return false}var cF=(cR-1)%3;var cv=cR-cF;var cD=0;var cS,ct,cQ,cs,cO,cq,cM,co;var cE,cC,cP,cN,cr,cp;cS=cL[0],ct=cL[1];var cJ=2;for(var cK=0;cK<(cv-1);cK+=3){cQ=cL[cJ];cs=cL[cJ+1];cO=cL[cJ+2];cq=cL[cJ+3];cM=cL[cJ+4];co=cL[cJ+5];cE=cM-cS+3*cQ-3*cO;cC=co-ct+3*cs-3*cq;cP=3*(cO-2*cQ+cS);cN=3*(cq-2*cs+ct);cr=3*(cQ-cS);cp=3*(cs-ct);var cu=Math.sqrt((cS-cM)*(cS-cM)+(ct-co)*(ct-co))/2;cD=0.01;var cw=0;if((cu>0)&&(cD>=0)&&(cD<=(2*cu))){var cU=Math.acos(1-(cD/cu));if(cU>0){cw=Math.floor((Math.PI/cU)*0.5+0.5)}}if(cw<=0){cw=1}if(cw>100){cw=100}var cH=cw+1;var cT=1;var cz=cT/cw;var cB,cA,cG;cB=cS;cA=ct;this.vertexBuffer.posBuffer.push(cB);this.vertexBuffer.posBuffer.push(cA);this.vertexBuffer.posBuffer.push(0);cG=cz;for(var cI=0;cI<cw;cI++){cB=cE*Math.pow(cG,3)+cP*Math.pow(cG,2)+cr*cG+cS;cA=cC*Math.pow(cG,3)+cN*Math.pow(cG,2)+cp*cG+ct;this.vertexBuffer.posBuffer.push(cB);this.vertexBuffer.posBuffer.push(cA);this.vertexBuffer.posBuffer.push(0);this.primitive.indices.push(cn++);this.primitive.indices.push(cn);cG+=cz}this.primitive.count=2*cH-2;cS=cM;ct=co;cJ+=6}if(cF>0){for(var cK=0;cK<cF+1;cK++){this.vertexBuffer.posBuffer.push(cL[2*(cv-1+cK)]);this.vertexBuffer.posBuffer.push(cL[2*(cv-1+cK)+1]);this.primitive.indices.push(cn++);this.primitive.indices.push(cn)}}this.primitive.count+=2*(cF+1);return true}return false};var ar=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.primitives=[]};ar.prototype=Object.create(bs.prototype);ar.prototype.constructor=ar;ar.prototype.lineType=null;ar.prototype.unstream=function(cG){this.unstreamPrimitive(cG);var cD=cG.readCompressedInt();var cF=[];var cu=0;cG.readUncompressedIntArray(cD,cF);for(var cC=0;cC<cD;++cC){cu+=cF[cC]}var ct=0;if(cG.version<1101840||(cG.version>=2100000&&cG.version<2100130)){ct=cu}else{ct=cG.readCompressedInt()}var cA=[];cG.readFloatArray(0,2*ct,cA);if(!this.vertexBuffer){this.vertexBuffer=new l()}var cn=this.vertexBuffer.posBuffer.length/3;for(var cC=0;cC<ct;cC++){this.vertexBuffer.posBuffer.push(cA[cC*2]);this.vertexBuffer.posBuffer.push(cA[cC*2+1]);this.vertexBuffer.posBuffer.push(0)}var cy=cG.readCompressedInt();if(cy){var cx=new bx();cx.cgmId=this.primitive.cgmId;cx.start=cx.indices.length;cx.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;var cv=cG.readCompressedInt();var cB=[];var cp=[];var cE=0;var cw=[];cG.readUncompressedIntArray(cv,cB);cG.readUncompressedIntArray(cv,cp);for(var cC=0;cC<cv;++cC){cE+=cB[cC]}cG.readUncompressedIntArray(cE,cw);cx.count=0;var cq=0;for(var cC=0;cC<cv;++cC){switch(cp[cC]){case 0:case 4:cx.count+=cB[cC];for(var cz=0;cz<cB[cC];++cz){cx.indices.push(cw[cq++]-1)}break;case 1:case 5:cx.count+=(cB[cC]-2)*3;var cs=0;for(var cz=0;cz<cB[cC]-2;cz++){cx.indices.push(cw[cq]-1);cx.indices.push(cw[cq+1+cs]-1);cx.indices.push(cw[cq+2-cs]-1);cq++;cs=1-cs}cq+=2;break;case 2:case 6:cx.count+=(cB[cC]-2)*3;var cr=cw[cq]-1;for(var cz=0;cz<cB[cC]-2;cz++){cx.indices.push(cw[cr]-1);cx.indices.push(cw[cq+2]-1);cx.indices.push(cw[cq+1]-1);cq++}cq+=2;break;default:return null;break}}this.primitives.push(cx);return true}else{var co=new bx();co.cgmId=this.primitive.cgmId;co.start=co.indices.length;co.connectivity=bg.ConnectivityTypeEnum.LINES;co.count=2*ct-2;var cr=cn;for(var cC=1;cC<ct;cC++){co.indices.push(cn++);co.indices.push(cn)}co.indices.push(cn);co.indices.push(cr);this.primitives.push(co);return true}};var O=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.text=null;this.noRender=true};O.prototype=Object.create(bs.prototype);O.prototype.constructor=O;O.prototype.lineType=null;O.prototype.unstream=function(cG){var cP=cG.readCompressedInt();var cq=[];cG.readBytes(cP,cq);var c0={};var cD="";var cp=false;var cE=false;for(var cY=0;cY<cq.length;cY++){cD+=String.fromCharCode(cq[cY])}var cC=cD.substring(cD.length-5,cD.length);var cF=true;if(cC===".font"||cC===".FONT"){cF=false}var cI=cG.readCompressedInt();var ct="";for(var cY=0;cY<cI;cY++){ct+=String.fromCharCode(cG.readUnsignedShort())}cG.readUnsignedShort();var cA=cG.readFloat();var cn=cG.readFloat();var co=cG.readFloat();var cs=cG.readFloat();var cX=cG.readShort();var cK=[];cG.readFloatArray(0,4,cK);var cO=cG.readFloat();var cT=cG.readShort();var cL=cG.readShort();var cN=[];cG.readFloatArray(0,2,cN);var cS=cG.readFloat();var cV=cG.readFloat();var cv=cG.readFloat();var cu=cG.readFloat();var cJ=cG.readFloat();var cr=cG.readShort();var cw=false;var cM=-1;if(cG.version>=2100020||(cG.version>=1101600&&cG.version<2100000)){var cw=cG.readCompressedInt()}if(cG.version>=2100070||(cG.version>=1101730&&cG.version<2100000)){var cM=cG.readCompressedInt()}var c1=cG.readCompressedInt();var cR=cG.readCompressedInt();var cZ=cG.readFloat();var cB=cG.readFloat();var cy=cG.readFloat();var cU=cG.readFloat();var cz=[cZ,cB,cy,cU];if(cG.version>=1101330){var cQ=cG.readFloat()}var cW=[];cG.readFloatArray(0,22,cW);if(cF){cG.readFloat();cG.readFloat();cG.readFloat();cG.readFloat();cG.readFloat();cG.readFloat();cG.readFloat()}if(aY){var cx=cG.getStaticMode();var cH=cG.getCurrentMatrix();this.text={text:ct,attachedPoint:cx,bbox:cz,horJustif:cX,verJustification:cr,matrix:cH,fontName:cD,color:null,stroke:false,path:cT,bold:cp,italic:cE}}};var cg=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx()};cg.prototype=Object.create(bs.prototype);cg.prototype.constructor=cg;cg.prototype.lineType=null;cg.prototype.unstream=function(cq){var co=bD.prototype.unstream.call(this,cq);var cn=cq.readCompressedInt();if(cn>0){var cp=[];cq.readUncompressedIntArray(cn,cp)}return co};var bD=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx()};bD.prototype=Object.create(bs.prototype);bD.prototype.constructor=bD;bD.prototype.lineType=null;bD.prototype.unstream=function(cI){this.unstreamPrimitive(cI);var cA=cI.readUnsignedChar();if((cI.version>=1101900&&cI.version<2100000)||(cI.version>=2100170)){var cE=cI.readCompressedInt();if(cE==0){cI.readCompressedInt();cI.readCompressedInt();return false}var cB=[];var cH=cI.readCompressedInt();if(cH>0){var ct=[];cI.readFloatArray(0,cH*2,cB)}var cu=cI.readCompressedInt();var cx=0;var cF=[];if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var co=this.vertexBuffer.posBuffer.length/3;for(var cD=0;cD<cE;++cD){this.vertexBuffer.posBuffer.push(cB[cD*2]);this.vertexBuffer.posBuffer.push(cB[cD*2+1]);this.vertexBuffer.posBuffer.push(0)}if(cu>0){for(var cD=0;cD<cE;++cD){this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1)}var cq=[];var cC=[];for(var cD=0;cD<cu;++cD){cq[cD]=cI.readUncompressedInt()}for(var cD=0;cD<cu;++cD){cC[cD]=cI.readUncompressedInt()}var cG=0;for(var cD=0;cD<cu;cD++){cG+=cC[cD]}var cv=[];for(var cD=0;cD<cG;++cD){cv[cD]=cI.readUncompressedInt()-1}this.primitive.count=0;var cr=co;for(var cD=0;cD<cu;++cD){cr=this.createPolygonGP(cr,this.primitive,cv,cC[cD],cq[cD],true)}}else{this.createPolygonGP(co,this.primitive,undefined,cH,undefined,false)}if(cA==4||cA==3){return false}return true}else{if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;this.primitive.start=this.primitive.indices.length;var co=this.vertexBuffer.posBuffer.length/3;var cH=cI.readCompressedInt();if(cH>0){var ct=[];cI.readFloatArray(0,2*cH,ct)}if(cA==1){var cu=cI.readCompressedInt();if(cu>0){var cx=0;var cF=[];var cq=[];var cC=[];for(var cD=0;cD<cu;++cD){cq[cD]=cI.readUncompressedInt()}for(var cD=0;cD<cu;++cD){cC[cD]=cI.readUncompressedInt();if(cq[cD]===0||cq[cD]===4){cx+=cC[cD]/3}if(cq[cD]===1||cq[cD]===5){cx+=cC[cD]-2}if(cq[cD]===2||cq[cD]===6){cx+=cC[cD]-2}}var cp=0;for(var cD=0;cD<cu;cD++){cp+=cC[cD]}var cw=[];for(var cD=0;cD<cp;++cD){cw[cD]=cI.readUncompressedInt()}var cs=0;for(var cD=0;cD<cu;++cD){if(cq[cD]===0||cq[cD]===4){var cp=cC[cD];for(var cz=0;cz<cp;++cz){this.primitive.indices.push(cw[cs++]-1+co)}}if(cq[cD]===1||cq[cD]===5){var cy=cC[cD];for(var cz=2;cz<cy;++cz){if(cz%2){this.primitive.indices.push(cw[cs+cz]-1+co);this.primitive.indices.push(cw[cs+cz-1]-1+co);this.primitive.indices.push(cw[cs+cz-2]-1+co)}else{this.primitive.indices.push(cw[cs+cz-1]-1+co);this.primitive.indices.push(cw[cs+cz]-1+co);this.primitive.indices.push(cw[cs+cz-2]-1+co)}}cs+=cy}if(cq[cD]===2||cq[cD]===6){var cn=cC[cD];for(var cz=2;cz<cn;++cz){this.primitive.indices.push(cw[cs]-1+co);this.primitive.indices.push(cw[cs+cz-1]-1+co);this.primitive.indices.push(cw[cs+cz]-1+co)}cs+=cn}}this.primitive.count=this.primitive.indices.length}for(var cD=0;cD<cH;++cD){this.vertexBuffer.posBuffer.push(ct[2*cD]);this.vertexBuffer.posBuffer.push(ct[2*cD+1]);this.vertexBuffer.posBuffer.push(0)}}if((cA==4)||(cA==3)){return false}return true}};var bo=function(){bs.call(this);this.primitive=new bx()};bo.prototype=Object.create(bs.prototype);bo.prototype.constructor=bo;bo.prototype.lineType=null;bo.prototype.unstream=function(ct){this.unstreamPrimitive(ct);var co=ct.readDouble();var cs=ct.readDouble();var cp=ct.readDouble();var cq=ct.readDouble();var cn=ct.readDouble();var cx=ct.readUnsignedChar();var cu=ct.readCompressedInt();var cw=ct.readDouble();var cr=ct.readDouble();var cv=17;if(!this.vertexBuffer){this.vertexBuffer=new l()}this.create2DArcCircleGP(this.vertexBuffer,this.primitive,co,cs,cp,cq,cn,cv,cx);return true};var b6=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx()};b6.prototype=Object.create(bs.prototype);b6.prototype.constructor=b6;b6.prototype.lineType=null;b6.prototype.unstream=function(cu){this.unstreamPrimitive(cu);this.primitive.connectivity=bg.ConnectivityTypeEnum.LINES;if(!this.vertexBuffer){this.vertexBuffer=new l()}var cs=this.vertexBuffer.posBuffer.length/3;var cn=cu.readCompressedInt();var cr=cu.readUnsignedChar();var cv=false;if(cr==0&&cn&1){cn--;cv=true}for(var cq=0;cq<cn;++cq){this.vertexBuffer.posBuffer.push(cu.readFloat());this.vertexBuffer.posBuffer.push(cu.readFloat());this.vertexBuffer.posBuffer.push(0)}if(cv){cu.readFloat();cu.readFloat()}this.createPolylineGP(cs,this.primitive,cn,cr);if((cu.version>=1101850&&cu.version<2100000)||cu.version>=2100170){var cp=cu.readUnsignedChar()}else{if(cn==2){var co=this.vertexBuffer.posBuffer.length-6;var ct=(this.vertexBuffer.posBuffer[co]-this.vertexBuffer.posBuffer[co+3])*(this.vertexBuffer.posBuffer[co]-this.vertexBuffer.posBuffer[co+3]);ct+=(this.vertexBuffer.posBuffer[co+1]-this.vertexBuffer.posBuffer[co+4])*(this.vertexBuffer.posBuffer[co+1]-this.vertexBuffer.posBuffer[co+4]);if(ct>=1000000000000){}}}return true};var b0=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx()};b0.prototype=Object.create(bs.prototype);b0.prototype.constructor=b0;b0.prototype.lineType=null;b0.prototype.unstream=function(cp){this.unstreamPrimitive(cp);if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.symbol=cp.readCompressedInt();var cn=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=bg.ConnectivityTypeEnum.POINTS;var cq=cp.readCompressedInt();this.primitive.count=cq;for(var co=0;co<cq;co++){this.vertexBuffer.posBuffer.push(cp.readFloat());this.vertexBuffer.posBuffer.push(cp.readFloat());this.vertexBuffer.posBuffer.push(0);this.primitive.indices.push(cn++)}return true};var bH=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx()};bH.prototype=Object.create(bs.prototype);bH.prototype.constructor=bH;bH.prototype.lineType=null;bH.prototype.unstream=function(cL){this.unstreamPrimitive(cL);var cA=cL.readDouble();var cx=cL.readDouble();var cJ=cL.readDouble();var cu=cL.readDouble();var cH=cL.readDouble();var cB=cL.readDouble();var ct=cL.readDouble();var cG=cL.readUnsignedChar();var cv=cL.readCompressedInt();var cr=cL.readDouble();var cn=cL.readDouble();var cs=(cJ>cu)?cJ:cu;if(cB<cH){cB+=(2*Math.PI)}if(cH<0){cH+=(2*Math.PI);cB+=(2*Math.PI)}var cp=cB-cH;var cK=17;var cq=cp/(cK-1);var cw=[];cw[0]=cr*cJ;cw[1]=cn*cu;cw[2]=0;var cy=cu/cJ;var cD=Math.cos(cq);var cz=Math.sin(cq);var cI=0;var cF=3;for(cI=1;cI<cK;cI++){cw[cF]=cD*cw[cF-3]-cz*cw[cF-2]/cy;cw[cF+1]=cz*cw[cF-3]*cy+cD*cw[cF-2];cw[cF+2]=0;cF+=3}var cE=new aq.Matrix4();cE.makeRotationZ(ct);cE.setPosition({x:cA,y:cx,z:0});cF=0;var cC=new aq.Vector4();for(cI=0;cI<cK;cI++){cC.set(cw[cF],cw[cF+1],0,1);cC.applyMatrix4(cE);cw[cF]=cC.x;cw[cF+1]=cC.y;cw[cF+2]=0;cF+=3}if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var co=this.vertexBuffer.posBuffer.length/3;if(cG){this.primitive.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;this.primitive.count=(cK-2)*3;this.vertexBuffer.posBuffer=cw;for(var cI=1;cI<cK-1;cI++){this.primitive.indices.push(0);this.primitive.indices.push(cI);this.primitive.indices.push(cI+1)}}else{this.primitive.connectivity=bg.ConnectivityTypeEnum.LINES;this.primitive.count=2+(cK-2)*2;this.vertexBuffer.posBuffer=cw;for(var cI=1;cI<cK;++cI){this.primitive.indices.push(co++);this.primitive.indices.push(co)}}return true};var L=function(){bs.call(this);this.vertexBuffer=null;this.primitive=new bx();this.noRender=true};L.prototype=Object.create(bs.prototype);L.prototype.constructor=L;L.prototype.lineType=null;L.prototype.unstream=function(cv){this.unstreamPrimitive(cv);if(cv.getLightDataStreaming()){this.primitive.connectivity=bg.ConnectivityTypeEnum.LINES;if(!this.vertexBuffer){this.vertexBuffer=new l()}var ct=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length;var co=cv.readCompressedInt();var cr=cv.readCompressedInt();this.primitive.count=co;switch(cr){case 0:this.primitive.count=co;for(var cp=0;cp<co;++cp){this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.primitive.indices.push(ct++)}break;case 1:this.primitive.count=2+(co-2)*2;this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());for(var cp=1;cp<co;++cp){this.primitive.indices.push(ct++);this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.primitive.indices.push(ct)}break;case 2:this.primitive.count=4+(co-2)*2;var cn=ct;this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());for(var cp=1;cp<co;++cp){this.primitive.indices.push(ct++);this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.vertexBuffer.posBuffer.push(cv.readFloat());this.primitive.indices.push(ct)}this.primitive.indices.push(ct);this.primitive.indices.push(cn);break;default:return null;break}if(co==2){var cs=this.vertexBuffer.posBuffer.length-6;var cq=this.vertexBuffer.posBuffer;var cu=(cq[cs]-cq[cs+3])*(cq[cs]-cq[cs+3]);cu+=(cq[cs+1]-cq[cs+4])*(cq[cs+1]-cq[cs+4]);cu+=(cq[cs+2]-cq[cs+5])*(cq[cs+2]-cq[cs+5]);if(cu>=1000000000000){this.primitive.noRender=true}}}};L.prototype.skip=function(cn){this.unstreamPrimitive(cn);if(cn.getLightDataStreaming()){var co=cn.readCompressedInt();var cp=cn.readCompressedInt();if(co>0){cn.skip(3*co*4)}}};var bC=function(){L.call(this)};bC.prototype=Object.create(L.prototype);bC.prototype.constructor=bC;var q={CGR_STREAM_NO_COMPRESSION:0,CGR_STREAM_COMPRESS_POSITION_1:1,CGR_STREAM_COMPRESS_NORMAL_1:2,};var bQ={SGV6_ATTRIBUTE_GAS:1,SGV6_ATTRIBUTE_TEXTURE_MATRIX:2,SGV6_ATTRIBUTE_RENDERING_MODE:4,SGV6_ATTRIBUTE_POINT_TYPE:8,SGV6_ATTRIBUTE_POINT_SIZE:16};var ci=function(){};var ag=0;var t=[];ci.prototype.buildRep=function(da,co,cN){var cX=da.posBuffer;var cE=da.uvsBuffer;var ct=da.binormalsBuffer;var cq=da.tangentsBuffer;var cv=da.normalBuffer;var cF=da.textureBuffer;var cA=cX.length/3;var c4=cv.length/3;for(var c7=0;c7<c4;c7++){t[c7]={normal:[cv[c7*3],cv[c7*3+1],cv[c7*3+2]],newIdx:c7,next:null}}for(var c7=c4;c7<cA;c7++){t[c7]=null}var cG=new bg.Mesh();var cr=c4;var cz=0;var cL=0;var cy=co.length;var cV=0;for(c7=0;c7<cy;c7++){var cH=co[c7];var cL=cH.set.length;for(c5=0;c5<cL;c5++){cV+=cH.set[c5].indices.length}}if(cV==0){return null}var cJ=new Uint32Array(cV);var cW=0;for(c7=0;c7<cy;c7++){var cs=0;var cH=co[c7];var c2=(cH.material==null)?cN.getCurrentMatId():cH.material;switch(cH.connectivity){case bg.ConnectivityTypeEnum.TRIANGLES:cs=new bg.DrawingGroup(bg.convertToMaterial3js(cH.gas,2),c2,4,cW,cH.nbIndices,undefined,undefined,aq.GeomTypeEnum[cH.geomType]);break;case bg.ConnectivityTypeEnum.LINES:cs=new bg.DrawingGroup(bg.convertToMaterial3js(cH.gas,1),c2,1,cW,cH.nbIndices,undefined,undefined,aq.GeomTypeEnum[cH.geomType]);break;case bg.ConnectivityTypeEnum.POINTS:cs=new bg.DrawingGroup(bg.convertToMaterial3js(cH.gas,0),c2,0,cW,cH.nbIndices,undefined,undefined,aq.GeomTypeEnum[cH.geomType]);break;default:break}var cL=cH.set.length;cs.primitives=new Array(cL);for(var c5=0;c5<cL;c5++){var cI=cW;var cx=cH.set[c5];var cP=cx.indices.length;var cM=cx.planarNormals;var cw=cx.planarNormals?cx.planarNormals.length:0;var c8=cx.indices;for(var c3=0;c3<cP;c3++){var c6=false;var dc=c8[c3];var cY=null;var cU=0;if(cw>0||dc>=c4){if(cw>0){cY=cM}var cp=t[dc];while(cp!==null){if(cY==null){c6=true;cU=cp.newIdx;break}else{if((cp.normal[0]==cY[0])&&(cp.normal[1]==cY[1])&&(cp.normal[2]==cY[2])){c6=true;cU=cp.newIdx;break}}cp=cp.next}if(c6){cJ[cW++]=cU}else{t[dc]={normal:cY,newIdx:cr,next:t[dc]};cJ[cW++]=cr++}}else{cJ[cW++]=dc}}var cC=new bg.MeshPrimitive(cx.cgmId,cs,cI,cP);if(cx.decoration){cC.decoration=cx.decoration}if(cx.boundingSphere){cC.boundingSphere=cx.boundingSphere}cs.primitives[c5]=cC}cG.drawingGroups.push(cs)}var cT=new Float32Array(3*cr);var cS=new Float32Array(3*cr);var cD=null;if(da.hasUVs){cD=new Float32Array(3*cr)}var c1=null;if(da.hasTangentsBinormals){c1=new Float32Array(3*cr)}var dh=null;if(da.hasTangentsBinormals){dh=new Float32Array(3*cr)}var cu=null;if(da.hasTextures){cu=new Float32Array(3*cr)}var cB=cv.length;for(var c7=0;c7<cA;++c7){var cp=t[c7];while(cp!==null){var cn=3*c7;var cR=3*cp.newIdx;cT[cR]=cX[cn];cT[cR+1]=cX[cn+1];cT[cR+2]=cX[cn+2];if(cp.normal){cS[cR]=cp.normal[0];cS[cR+1]=cp.normal[1];cS[cR+2]=cp.normal[2]}else{cS[cR]=1;cS[cR+1]=0;cS[cR+2]=0}if(da.hasUVs){cD[cR]=cE[cn];cD[cR+1]=cE[cn+1];cD[cR+2]=cE[cn+2]}if(da.hasTangentsBinormals){c1[cR]=ct[cn];c1[cR+1]=ct[cn+1];c1[cR+2]=ct[cn+2]}if(da.hasTangentsBinormals){dh[cR]=cq[cn];dh[cR+1]=cq[cn+1];dh[cR+2]=cq[cn+2]}if(da.hasTextures){cu[cR]=cF[cn];cu[cR+1]=cF[cn+1];cu[cR+2]=cF[cn+2]}cp=cp.next}}cG.vertexIndexArray=cJ;cG.vertexPositionArray=cT;cG.vertexNormalArray=cS;cG.vertexUvArray=cu;cG.vertexTangentArray=dh;cG.vertexBinormalArray=c1;var dg=new aq.Color();var db=new aq.Color();var cO=this.rep.repGas;var cZ=(cO>>24)&255;var c9=(cO>>16)&255;var de=(cO>>8)&255;var df=(cO&255);dg.setRGB(cZ,c9,de);db.setRGB(cZ,c9,de);cG.gas.fill={color:dg,opacity:df};cG.gas.line={color:db,opacity:df,lineWidth:1};var dd=[0,0,0];var cK=[0,0,0];var cQ=cG.vertexPositionArray.length;if(cQ>=3){dd=[cG.vertexPositionArray[0],cG.vertexPositionArray[1],cG.vertexPositionArray[2]];cK=[cG.vertexPositionArray[0],cG.vertexPositionArray[1],cG.vertexPositionArray[2]];for(var c0=0;c0<cQ;c0+=3){if(cG.vertexPositionArray[c0]<dd[0]){dd[0]=cG.vertexPositionArray[c0]}if(cG.vertexPositionArray[c0+1]<dd[1]){dd[1]=cG.vertexPositionArray[c0+1]}if(cG.vertexPositionArray[c0+2]<dd[2]){dd[2]=cG.vertexPositionArray[c0+2]}if(cG.vertexPositionArray[c0]>cK[0]){cK[0]=cG.vertexPositionArray[c0]}if(cG.vertexPositionArray[c0+1]>cK[1]){cK[1]=cG.vertexPositionArray[c0+1]}if(cG.vertexPositionArray[c0+2]>cK[2]){cK[2]=cG.vertexPositionArray[c0+2]}}}cG.AABB={min:dd,max:cK};return cG};ci.prototype.resolvedInheritance=function(cx,cA){cA.globalMatrix=cx.getCurrentMatrix();if(cA.axis){var cp=cx.axisSystems.add(cA);cA.axisSystems=cp;cx.popMatId();cx.popGAS();return this}if(cA.refPlanes){var cp=cx.refPlanes.add(cA);cA.refPlaneInd=cp;return this}var cn=cx.getFixMode();var cv=cx.getGAS();var cy=cv.getType();var ct=cv.isNoZ();var cq=cv.isHidden();var cw=cv.isSolid();var cr=cx.getStaticMode();var co=cv.getDisplayedColor();var cs=new aq.Color(co[0]/255,co[1]/255,co[2]/255);var cu=(co[3]/255||1);cA.gas.fill={color:cs,opacity:cu,solid:cw};cA.gas.line={color:cs,opacity:cu,lineWidth:cv.getLineThickness(),pattern:bg.LinePatternEnum.SOLID};cA.gas.point={color:cs,opacity:cu,pointsize:1,symbol:1};this.rep.node.solid=cw;if(g&&cA.rep instanceof bg.SGRep){cA.rep.boundingSphere=this.rep.boundingSphere}if(ct){cA.noZ=true}if(cq){cA.noShow=true}if(cr){cA.attachedPoint=cr}var cz=cx.addReps(cA,cr,ct,this.rep.excludeFromBounding,cn);if(cz){this.rep.renderType=cz.renderType;this.rep.repIndice=cz.indice}};ci.prototype.getCompressedRep=function(cn){if(this.rep.node.type){var cp=cn.sgRep;var co=cn.nbRep++;cp.push(this.rep.node.cgmId+1);cp.push(this.rep.node.solid);cp.push(this.rep.node.namingContext);if(aN){cp.push(this.rep.node.sag)}if(g){cp.push(this.rep.boundingSphere.radius);cp.push(this.rep.boundingSphere.center[0]);cp.push(this.rep.boundingSphere.center[1]);cp.push(this.rep.boundingSphere.center[2])}this.rep.node=co;return co}else{return this.rep.node}};ci.prototype.addMesh=function(cn){var co=this.build(cn);if(co==null){cn.popMatId();cn.popGAS();return null}this.resolvedInheritance(cn,co);co.rep=this.getCompressedRep(cn);cn.popMatId();cn.popGAS();return this};var aI=function(){ci.call(this);this.rep=new E()};aI.prototype=Object.create(ci.prototype);aI.prototype.constructor=aI;var bz=function(){ci.call(this);this.rep=new aM()};bz.prototype=Object.create(ci.prototype);bz.prototype.constructor=bz;var d=function(cn){cn=cn||{};this.repInheritanceMode=cn.repInheritanceMode!==undefined?cn.repInheritanceMode:0;this.repGAS=cn.repGAS!==undefined?cn.repGAS:0;this.materialInheritance=cn.materialInheritance!==undefined?cn.materialInheritance:0;this.material=cn.material!==undefined?cn.material:{file:"",id:-1};this.noShow=cn.noShow!==undefined?cn.noShow:false;this.boundingSphere=null;this.renderType=cn.renderType!==undefined?cn.renderType:0};d.prototype.unstream=function(ct){this.namingContext=0;this.repInheritanceMode=ct.readCompressedInt();this.repGAS=ct.readGraphicAttributeSet();ct.pushGAS(this.repGAS,this.repInheritanceMode);this.material={file:"",id:-1};this.materialInheritance=0;var cn=ct.readCompressedInt();var cs=ct.readCompressedInt();var co=ct.readFloat();var cq=ct.readFloat();var cv=ct.readFloat();var cp=ct.readFloat();var cr=(cq-co)*(cq-co)+(cp-cv)*(cp-cv);cr=0.5*Math.sqrt(cr);this.boundingSphere={radius:cr,center:[0.5*(cq+co),0.5*(cp+cv),0]};if(ct.version>=1101303){var cu=ct.readFloat()}};d.prototype.childClone=function(){var cn=new Array();for(var co in this.children){cn[co]=typeof(this.children[co])=="object"?this.children[co].clone():this.children[co]}return cn};var aM=function(cn){cn=cn||{};d.call(this,cn);this.node=cn.node!==undefined?cn.node:new bg.SGRep()};aM.prototype=Object.create(d.prototype);aM.prototype.constructor=aM;aM.prototype.clone=function(){return new aM({renderType:this.renderType,node:this.node,namingContext:this.namingContext,materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var N=function(cn){cn=cn||{};d.call(this,cn);this.node=cn.node!==undefined?cn.node:new bg.SGBag();this.children=cn.children!==undefined?this.childClone(cn.children):[]};N.prototype=Object.create(d.prototype);N.prototype.constructor=N;N.prototype.clone=function(){return new N({children:this.childClone(),node:this.node.clone(),materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var ca=function(cn){cn=cn||{};this.repInheritanceMode=cn.repInheritanceMode!==undefined?cn.repInheritanceMode:0;this.repGAS=cn.repGAS!==undefined?cn.repGAS:0;this.materialInheritance=cn.materialInheritance!==undefined?cn.materialInheritance:0;this.material=cn.material!==undefined?cn.material:{file:"",id:-1};this.layer=cn.layer!==undefined?cn.layer:ax.LAYER_MAX;this.noShow=cn.noShow!==undefined?cn.noShow:false;this.boundingSphere=null};ca.prototype.unstream=function(cx){this.namingContext=0;this.repInheritanceMode=cx.readCompressedUInt();this.repGAS=cx.readGraphicAttributeSet();var cs=cx.pushGAS(this.repGAS,this.repInheritanceMode);if(cs.isHidden()){this.noShow=true}if(cs.getType()==0){this.noZ=true}this.material={file:"",id:-1};this.materialInheritance=0;var cn=cx.readCompressedInt();if(cn==2){this.excludeFromBounding=true}var cu=cx.readCompressedInt();var cr=cx.readFloat();var cC=cx.readFloat();var cz=cx.readFloat();var cy=cx.readFloat();var cw=cx.readFloat();this.boundingSphere={radius:cr,center:[cz,cy,cw]};if(cx.version>1100800){this.node.cgmId=cx.readUncompressedInt();cx.readUnsignedShort();if(cx.version>1101020){this.namingContext=cx.readUnsignedChar();this.node.namingContext=this.namingContext}}var ct=cx.readUnsignedChar();if(ct){var cD=this.materialApplicationUnstream(cx,ax.STREAM_MATERIAL|ax.STREAM_INHERIT_INT);this.material=cD.material;this.materialInheritance=cD.inheritanceMaterial}if(cx.version>=210041800){var co=cx.readUnsignedChar();if(co){var cD=this.materialApplicationUnstream(cx,ax.STREAM_LAYER_ULONG|ax.STREAM_UVTRANSFO|ax.STREAM_MAPPING_INFO);if(cD.mapping){var cB=cx.materials.get([this.material.id]);if(cB){cB.mapping=cD.mapping}}this.layer=cD.layer;var cp=cx.readCompressedUInt();if(cp>0){for(var cq=0;cq<cp;++cq){var cD=this.materialApplicationUnstream(cx,ax.STREAM_ALL_ULONG);if(cD.mapping){var cB=cx.materials.get([cD.material.id]);if(cB){cB.mapping=cD.mapping}}if(cD.layer<this.layer||(cD.layer==this.layer&&cD.inheritanceMaterial>=this.materialInheritance)){this.layer=cD.layer;this.material=cD.material;this.materialInheritance=cD.inheritanceMaterial}}}}}cx.pushMatId(this.material,this.materialInheritance,this.layer);if(cx.version>=210041910){var cA=cx.readUnsignedChar();if(cA){var cv=[];cx.readBytes(6,cv)}}};ca.prototype.materialApplicationUnstream=function(cr,co){var cn={material:null,inheritanceMaterial:1,layer:0};if(co&ax.STREAM_MATERIAL){cn.material=this.unstreamMaterial(cr)}if(cr.version>=1100500){if(co&ax.STREAM_INHERIT_INT){cn.inheritanceMaterial=cr.readCompressedInt()}else{if(co&ax.STREAM_INHERIT_UINT){cn.inheritanceMaterial=cr.readCompressedInt()}else{if(co&ax.STREAM_INHERIT_ULONG){cn.inheritanceMaterial=cr.readUncompressedInt()}}}}else{if(co&(ax.STREAM_INHERIT_INT|ax.STREAM_INHERIT_UINT|ax.STREAM_INHERIT_ULONG)){cn.inheritanceMaterial=1}}if(co&ax.STREAM_LAYER_INT){cn.layer=cr.readUncompressedInt()}else{if(co&ax.STREAM_LAYER_UINT){cn.layer=cr.readUncompressedInt()}else{if(co&ax.STREAM_LAYER_ULONG){cn.layer=cr.readUncompressedUInt()}}}if(co&ax.STREAM_UVTRANSFO){var ct=false;if(cr.version>=210041900){var ct=cr.readBoolean();if(ct){cr.readFloat();cr.readFloat();cr.readFloat();cr.readFloat()}}}if(co&ax.STREAM_MAPPING_INFO){if(cr.version>=210042100){var cu=cr.readBoolean();if(!cu){var cp=cr.readStringWithLength();cp=JSON.parse(cp);cp=cp.mappings[cp.uvSlots.Default];cn.mapping={type:0,ObjectTransformation:null,UvTransformation:null};if(cp.uvTransform){cn.mapping.UvTransformation=cr.createMatrix3(cp.uvTransform)}if(cp.operator){var cq=cp.operator.type;if(cq=="PLANAR"){cn.mapping.type=1}else{if(cq=="SPHERICAL"){cn.mapping.type=2}else{if(cq=="SPHERICAL_NORMALIZED"){cn.mapping.type=3}else{if(cq=="CUBIC"){cn.mapping.type=4}else{if(cq=="CYLINDRICAL"||cq=="FINITE_CYLINDRICAL"){cn.mapping.type=5}else{if(cq=="INFINITE_CYLINDRICAL"){cn.mapping.type=6}else{if(cq=="INFINITE_CYLINDRICAL_NORMALIZED"){cn.mapping.type=7}}}}}}}if(cp.operator.transform){var cs=cp.operator.transform;cn.mapping.ObjectTransformation=cs}}}}}return cn};ca.prototype.unstreamMaterial=function(cw){var cv={file:"",id:-1};var cx=0;var co=cw.readUnsignedChar();var cp=0;var cu=null;var cs=null;if(co){cp=cw.readCompressedInt();if(cw.materials.isValidMultiRefIndexWithName(cp,cw.name)){var ct=cw.materials.getIndexWithName(cp,cw.name);cv={file:"",id:ct};return cv}}if(cw.version>=210021320){var cy=cw.readCompressedInt();if(cy===1){cs=new aw()}else{if(cy===4){cs=new aD()}else{if(cy===9&&cw.version>=210042100){cs=new aL()}else{cs=new u()}}}}else{cs=new u()}cu=cs.unstream(cw);var cn=cw.getCurrentPosition();var cq=cw.getBytesRemain();if(cq>32){cq=32}var cr=cw.readString(cq);cw.setCurrentPosition(cn);if(cr.indexOf('{\n"Version" : ')!==-1){fakeUnstreamer=new aD();fakeUnstreamer.skip(cw)}if(cy===1){var ct=cu}else{var ct=cw.materials.add(cu)}cv={file:"",id:ct};if(co){cw.materials.addMultiRefIndexWithName(cp,ct,cw.name)}return cv};ca.prototype.childClone=function(){var cn=new Array();for(var co in this.children){cn[co]=typeof(this.children[co])=="object"?this.children[co].clone():this.children[co]}return cn};var E=function(cn){cn=cn||{};ca.call(this,cn);this.node=cn.node!==undefined?cn.node:new bg.SGRep();this.namingContext=cn.namingContext!==undefined?cn.namingContext:0;this.repIndice=cn.repIndice!==undefined?cn.repIndice:-1;this.renderType=cn.renderType!==undefined?cn.renderType:0};E.prototype=Object.create(ca.prototype);E.prototype.constructor=E;E.prototype.clone=function(){return new E({renderType:this.renderType,repIndice:this.repIndice,node:this.node,namingContext:this.namingContext,materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var aX=function(cn){cn=cn||{};ca.call(this,cn);this.node=cn.node!==undefined?cn.node:new bg.SGBag();this.children=cn.children!==undefined?cn.children:[]};aX.prototype=Object.create(ca.prototype);aX.prototype.constructor=aX;aX.prototype.clone=function(){return new aX({children:this.childClone(),node:this.node.clone(),materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var e=function(){aI.call(this);this.primitiveSets=[];this.vertexBuffer=null;this.primitiveAxis=[];this.axisSystems=[];this.refPlane=[];this.useTexture=false;this.hasTangentsBinormals=false;this.gpList=[];this.imageRep=[]};e.prototype=Object.create(aI.prototype);e.prototype.constructor=e;e.prototype.checkGP=function(ct,cn){for(var cs=0;cs<this.gpList.length;cs++){this.mergeGP(this.gpList[cs].gp,this.gpList[cs].att)}if(this.primitiveAxis.length){if(cn&&cn.isMonoPlane){var co=this.primitiveAxis[0].gp.primitive;var cq=this.primitiveAxis[0].att.fill.color;var cp=[cq.r,cq.g,cq.b,cq.a];if(this.primitiveAxis[0].gp instanceof aB){var cu=this.getCompressedRep(ct);this.refPlane.push({rep:cu,origin:co.origin,xAxis:co.direction1,yAxis:co.direction2,color:cp,length:co.length,mode:co.mode,zoomable:cn.mode===1});this.primitiveAxis=[]}}for(var cs=0;cs<this.primitiveAxis.length;cs++){if(this.primitiveAxis[cs].gp instanceof cj||this.primitiveAxis[cs].gp instanceof L){this.primitiveAxis[cs].gp.noRender=false;var cr=this.primitiveAxis[cs].gp.vertexBuffer;if(cr){this.useTexture=cr.hasTextures?cr.hasTextures:false;this.hasTangentsBinormals=cr.hasTangentsBinormals?cr.hasTangentsBinormals:false}this.mergeGP(this.primitiveAxis[cs].gp,this.primitiveAxis[cs].att)}}}};e.prototype.addImage=function(cn,cr,cq,cs){var cp=new B();var ct=cq.getCurrentMatrix();cp.rep.repInheritanceMode=cs.repInheritanceMode;cp.rep.repGAS=cs.repGAS;cp.rep.materialInheritance=cs.materialInheritance;cp.rep.repInheritanceMode=cs.repInheritanceMode;cp.rep.noShow=cs.noShow;cp.vertexBuffer=new l();cp.gp=cn;if(cn&&cn.primitive){if((typeof cn.zoomQuality!=="undefined")&&(cn.zoomQuality===0)){cq.setFixMode(true)}if(cn.point){var cu;var co=new aq.Matrix4().setPosition({x:cn.point[0],y:cn.point[1],z:cn.point[2]});if(!ct){cu=co}else{cu=new aq.Matrix4().multiplyMatrices(ct,co)}cq.pushStaticMode(cu);cq.currentMatrix.push(new aq.Matrix4())}if(cn.primitive.material){cq.pushMatId(cn.primitive.material,1,0)}var cv=cp.build(cq);cp.resolvedInheritance(cq,cv);cv.rep=cp.getCompressedRep(cq);cq.popStaticMode();if(cn.point){cq.currentMatrix.pop();cq.popStaticMode()}if(cn.primitive.material){cq.popMatId()}cq.setFixMode(false)}return cp.rep};e.prototype.addGP=function(cp,cu,cs,co){if(cp.noRender){if(cp.imageGP){this.imageRep.push(this.addImage(cp,cu,cs,this.rep));return}this.primitiveAxis.push({gp:cp,att:cu});if(this.rep.namingContext==2&&this.primitiveAxis.length==7&&this.primitiveAxis[0].gp instanceof cj&&this.primitiveAxis[1].gp instanceof M&&this.primitiveAxis[2].gp instanceof M&&this.primitiveAxis[3].gp instanceof M&&this.primitiveAxis[4].gp instanceof aB&&this.primitiveAxis[5].gp instanceof aB&&this.primitiveAxis[6].gp instanceof aB){var cn=this.primitiveAxis[0].att.fill.color;var cq=[cn.r*255,cn.g*255,cn.b*255,cn.a*255];var ct=this.primitiveAxis[0].gp.vertexBuffer.posBuffer;var cx=this.primitiveAxis[0].gp.primitive.indices;var cw=[ct[cx[0]],ct[cx[0]+1],ct[cx[0]+2]];var cv=this.getCompressedRep(cs);this.axisSystems.push({rep:cv,origin:cw,xAxis:this.primitiveAxis[1].gp.primitive.direction,yAxis:this.primitiveAxis[2].gp.primitive.direction,zAxis:this.primitiveAxis[3].gp.primitive.direction,refPlanes:[this.primitiveAxis[4].gp.primitive,this.primitiveAxis[5].gp.primitive,this.primitiveAxis[6].gp.primitive],color:cq,zoomable:false});this.primitiveAxis=[]}if(this.rep.namingContext==2&&this.primitiveAxis.length==7&&this.primitiveAxis[0].gp instanceof cj&&this.primitiveAxis[1].gp instanceof S&&this.primitiveAxis[2].gp instanceof S&&this.primitiveAxis[3].gp instanceof S&&this.primitiveAxis[4].gp instanceof L&&this.primitiveAxis[5].gp instanceof L&&this.primitiveAxis[6].gp instanceof L){var cn=this.primitiveAxis[0].att.fill.color;var cq=[cn.r*255,cn.g*255,cn.b*255,cn.a*255];var ct=this.primitiveAxis[0].gp.vertexBuffer.posBuffer;var cx=this.primitiveAxis[0].gp.primitive.indices;var cw=[ct[cx[0]],ct[cx[0]+1],ct[cx[0]+2]];var cv=this.getCompressedRep(cs);this.axisSystems.push({rep:cv,origin:cw,xAxis:this.primitiveAxis[1].gp.primitive.direction,yAxis:this.primitiveAxis[2].gp.primitive.direction,zAxis:this.primitiveAxis[3].gp.primitive.direction,refPlanes:[this.primitiveAxis[4].gp.vertexBuffer.posBuffer,this.primitiveAxis[5].gp.vertexBuffer.posBuffer,this.primitiveAxis[6].gp.vertexBuffer.posBuffer],color:cq,zoomable:true,length:co.axisLength});this.primitiveAxis=[]}return}var cr=cp.vertexBuffer;if(cr){this.useTexture=cr.hasTextures?cr.hasTextures:false;this.hasTangentsBinormals=cr.hasTangentsBinormals?cr.hasTangentsBinormals:false}this.gpList.push({gp:cp,att:cu})};e.prototype.mergeGP=function(co,cw){var cs=co.primitive;var cx=undefined;if(this.rep.namingContext==2&&co instanceof cj){cx="FREE_POINT"}var cv=this.primitiveSets.length;for(var cp=0;cp<cv;cp++){var cn=this.primitiveSets[cp];if((cn.connectivity==cs.connectivity)&&bg.isEqualGAS(cn.gas,cw)&&((cn.material==null&&cs.material==null)||(cn.material.id==cs.material.id&&cn.material.file==cs.material.file))&&(typeof cx==="undefined"||cn.geomType===cx)){cn.set.push(cs);cn.nbIndices+=cs.indices.length;break}}if(cp==this.primitiveSets.length){var cy={};cy.connectivity=cs.connectivity;cy.gas=cw;cy.material=cs.material;cy.nbIndices=cs.indices.length;cy.more_indices=0;cy.set=[];if(cx){cy.geomType=cx}cy.set.push(cs);this.primitiveSets.push(cy)}if(this.vertexBuffer==null){this.vertexBuffer=new l();this.vertexBuffer.hasTextures=this.useTexture;this.vertexBuffer.hasUVs=false;this.vertexBuffer.hasTangentsBinormals=this.hasTangentsBinormals}var cu=co.vertexBuffer;var ct=cs.indices;var cq=this.vertexBuffer.posBuffer.length/3;for(var cr=0;cr<ct.length;cr++){ct[cr]=ct[cr]+cq}for(var cr=0;cr<cu.posBuffer.length;cr++){this.vertexBuffer.posBuffer.push(cu.posBuffer[cr]);if(cu.normalBuffer.length){this.vertexBuffer.normalBuffer.push(cu.normalBuffer[cr])}else{this.vertexBuffer.normalBuffer.push(0)}if(this.useTexture){if(cu.textureBuffer.length){this.vertexBuffer.textureBuffer.push(cu.textureBuffer[cr])}else{this.vertexBuffer.textureBuffer.push(0)}}if(this.hasTangentsBinormals){if(cu.tangentsBuffer.length){this.vertexBuffer.tangentsBuffer.push(cu.tangentsBuffer[cr])}else{this.vertexBuffer.tangentsBuffer.push(0)}if(cu.binormalsBuffer.length){this.vertexBuffer.binormalsBuffer.push(cu.binormalsBuffer[cr])}else{this.vertexBuffer.binormalsBuffer.push(0)}}}};e.prototype.build=function(cn){if(this.axisSystems.length>0){return{axis:this.axisSystems[0]}}if(this.primitiveSets.length==0){if(this.refPlane&&this.refPlane.length>0){return{refPlanes:this.refPlane}}return null}var co=this.buildRep(this.vertexBuffer,this.primitiveSets,cn);if(this.refPlane.length>0){co.refPlanes=this.refPlane}return co};var Q=function(){aI.call(this);this.vertexBuffer=null;this.nbLODFaces=0;this.lods=[];this.lodsAttributes=[];this.sag=0;this.sags=[];this.nbSets=0;this.sets=[];this.posInNextStreamer=0};Q.prototype=Object.create(aI.prototype);Q.prototype.constructor=Q;Q.prototype.getSet=function(cq){var cn=[];for(var cp=0;cp<this.sets.length;cp++){if(this.sets[cp].geomType==cq){var cr=this.sets[cp].primitives;for(var co=0;co<cr.length;co++){cn.push(cr[co])}}}return cn};Q.prototype.unStreamFaces=function(co){var cp=co.readUnsignedChar();if(cp){if(co.version>=2100180){var cn=co.readUnsignedChar();switch(cn){case 2:this.sets[0]=new n();break;case 3:this.sets[0]=new aK();break;default:this.sets[0]=null;break}}else{this.sets[0]=new n()}if(this.sets[0]){this.sets[0].unstream(co)}}};Q.prototype.build=function(cO){var cI,cH,cE,cB,cP,cF=0,cu=0,ct=0,cD,cz,co,cG=false,cw,cC,cK,cA,cJ,cq,cz=null,cr=0;var cp=this.vertexBuffer!==null?true:false;var cs=this.rep.repGAS.getType();var cL=this.rep.repGAS.isSolid();var cN=[];if(this.nbSets==0){return null}for(cI=0;cI<this.nbSets;cI++){if(this.sets[cI].primitive){cP=1;cJ=[this.sets[cI].primitive]}else{cP=this.sets[cI].primitives.length;cJ=this.sets[cI].primitives}for(cH=0;cH<cP;cH++){cB=cJ[cH];if(!cB){continue}if(cB.posBuffer){if(!this.vertexBuffer){this.vertexBuffer=new l()}var cn=cB.indices;var cv=this.vertexBuffer.posBuffer.length/3;for(var cE=0;cE<cn.length;cE++){cn[cE]=cn[cE]+cv}for(var cE=0;cE<cB.posBuffer.length;cE++){this.vertexBuffer.posBuffer.push(cB.posBuffer[cE]);if(cB.normalBuffer&&cB.normalBuffer.length){this.vertexBuffer.normalBuffer.push(cB.normalBuffer[cE])}else{this.vertexBuffer.normalBuffer.push(0)}}}else{if(!cp){continue}}cr+=cB.indices.length;if(cB.planarNormals&&cB.planarNormals.length>0){cu+=cB.indices.length}var cx=cN.length;for(cE=0;cE<cx;cE++){var cM=cN[cE];if((cM.connectivity==cB.connectivity)&&(cM.geomType==this.sets[cI].geomType)&&bg.isEqualGAS(cM.gas,cB.gas)&&bg.isEqualMaterial(cM.material,cB.material)){cM.set.push(cB);cM.nbIndices+=cB.indices.length;break}}if(cE==cN.length){var cy={};cy.connectivity=cB.connectivity;cy.gas=cB.gas;cy.geomType=this.sets[cI].geomType;cy.material=cB.material;cy.nbIndices=cB.indices.length;cy.more_indices=0;cy.set=[];cy.set.push(cB);cN.push(cy)}}}if(!this.vertexBuffer){return this.buildRep(vertexBuffer,cN,cO)}else{return this.buildRep(this.vertexBuffer,cN,cO)}};var by=function(){Q.call(this)};by.prototype=Object.create(Q.prototype);by.prototype.constructor=by;var cl=function(){aI.call(this);this.gp=[]};cl.prototype=Object.create(aI.prototype);cl.prototype.constructor=cl;cl.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;if(this.gp.primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cu={color:cr,opacity:cn[3]/255,lineWidth:cv.getLineThickness(),pattern:cv.getLinetype()};var ct=new bg.DrawingGroup(cu,cx,1,0,this.gp.primitive.indices.length)}else{var cu={color:cr,opacity:cn[3]/255,solid:cw};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var T=function(){aI.call(this);this.gp=[]};T.prototype=Object.create(aI.prototype);T.prototype.constructor=T;T.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;if(this.gp.primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cu={color:cr,opacity:cn[3]/255,lineWidth:cv.getLineThickness()};var ct=new bg.DrawingGroup(cu,cx,1,0,this.gp.primitive.indices.length)}else{var cu={color:cr,opacity:cn[3]/255,solid:cw};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var aa=function(){aI.call(this);this.refPlane=[]};aa.prototype=Object.create(aI.prototype);aa.prototype.constructor=aa;aa.prototype.build=function(cn){if(this.refPlane){return{refPlanes:this.refPlane}}};var an=function(){aI.call(this);this.vertexBuffer=null;this.sets=[]};an.prototype=Object.create(aI.prototype);an.prototype.constructor=an;an.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var co=cv.getDisplayedColor();var cq=new aq.Color;cq.setRGB(co[0]/255,co[1]/255,co[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var cu={color:cq,opacity:co[3]/255,solid:cw};var cs=new bg.DrawingGroup(cu,cx,4,0,this.sets[0].indices.length);var cp=new bg.MeshPrimitive(this.sets[0].node.cgmId,cs,0,this.sets[0].indices.length);if(this.sets[0].decoration){cp.decoration=this.sets[0].decoration}if(this.sets[0].boundingSphere){cp.boundingSphere=this.sets[0].boundingSphere}cs.primitives.push(cp);cB.drawingGroups.push(cs);cB.vertexIndexArray=this.sets[0].indices;cB.vertexPositionArray=this.vertexBuffer.posBuffer;cB.vertexNormalArray=this.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cn=this.sets[0].boundingBoxCenter;var ct=this.sets[0].boundingBoxDim;var cr=[cn[0]-ct[0],cn[1]-ct[1],cn[2]-ct[2]];var cA=[cn[0]+ct[0],cn[1]+ct[1],cn[2]+ct[2]];cB.AABB={min:cr,max:cA};return cB};var am=function(){aI.call(this);this.sets=[]};am.prototype=Object.create(aI.prototype);am.prototype.constructor=am;am.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var co=cv.getDisplayedColor();var cq=new aq.Color;cq.setRGB(co[0]/255,co[1]/255,co[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var cu={color:cq,opacity:co[3]/255,solid:cw};var cs=new bg.DrawingGroup(cu,cx,4,0,this.sets[0].indices.length);var cp=new bg.MeshPrimitive(this.sets[0].node.cgmId,cs,0,this.sets[0].indices.length);if(this.sets[0].decoration){cp.decoration=this.sets[0].decoration}if(this.sets[0].boundingSphere){cp.boundingSphere=this.sets[0].boundingSphere}cs.primitives.push(cp);cB.drawingGroups.push(cs);cB.vertexIndexArray=this.sets[0].indices;cB.vertexPositionArray=this.vertexBuffer.posBuffer;cB.vertexNormalArray=this.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cn=this.sets[0].boundingBoxCenter;var ct=this.sets[0].boundingBoxDim;var cr=[cn[0]-ct[0],cn[1]-ct[1],cn[2]-ct[2]];var cA=[cn[0]+ct[0],cn[1]+ct[1],cn[2]+ct[2]];cB.AABB={min:cr,max:cA};return cB};var bB=function(){aI.call(this);this.pointPrimimitivesSets=[];this.edgePrimitivesSets=[];this.vertexBuffer=null;this.indexBuffer=[];this.nbElEdge=0;this.nbElPoints=0;this.nbIndicesTotal=0};bB.prototype=Object.create(aI.prototype);bB.prototype.constructor=bB;bB.prototype.build=function(cv){var cu=cv.getCurrentMatId();if(this.pointPrimimitivesSets.length||this.edgePrimitivesSets.length){var cy=new bg.Mesh();var co=this.vertexBuffer.posBuffer.length;cy.vertexPositionArray=new Float32Array(co);for(var cs=0;cs<co;cs++){cy.vertexPositionArray[cs]=this.vertexBuffer.posBuffer[cs]}cy.vertexNormalArray=new Float32Array(co);for(var cs=0;cs<co;cs++){cy.vertexNormalArray[cs]=0}cy.vertexIndexArray=new Uint32Array(this.nbIndicesTotal);var cn=0;if(this.nbElEdge>0){for(var cs=0;cs<this.edgePrimitivesSets.length;cs++){var cx=this.edgePrimitivesSets[cs];var cr=new bg.DrawingGroup(bg.convertToMaterial3js(cx.attr,1),cu,1,cn,cx.nbIndices,undefined,undefined,aq.GeomTypeEnum.WIRE_EDGE);cy.drawingGroups.push(cr);var cw=cx.set;for(var cq=0;cq<cw.length;cq++){var ct=cw[cq];cr.primitives.push(ct);for(var cp=0;cp<ct.count;cp++){cy.vertexIndexArray[cn++]=this.indexBuffer[ct.start+cp]}}}}if(this.nbElPoints){for(var cs=0;cs<this.pointPrimimitivesSets.length;cs++){var cx=this.pointPrimimitivesSets[cs];var cr=new bg.DrawingGroup(bg.convertToMaterial3js(cx.attr,0),cu,0,cn,cx.nbIndices,undefined,undefined,aq.GeomTypeEnum.BOUNDARY_POINT);cy.drawingGroups.push(cr);var cw=cx.set;for(var cq=0;cq<cw.length;cq++){var ct=cw[cq];ct.attr=cx.attr;cr.primitives.push(ct);for(var cp=0;cp<ct.count;cp++){cy.vertexIndexArray[cn++]=this.indexBuffer[ct.start+cp]}}}}return cy}return null};var z=function(){};z.prototype.unstream=function(co){var cn=co.readCompressedInt();if(cn<0){cn=-cn-2}co.skip(cn-4)};var w={LOD0:0,LOD1:1,LOD2:2,LOD3:3,FACES:4,LSG:5};var b7=["BOUNDARY_EDGE","SHARP_EDGE","SMOOTH_EDGE","BOUNDARY_POINT","SHARP_POINT","SMOOTH_POINT","SURFACIC_POINT","FREE_POINT","WIRE_EDGE","INFINITE_FACE","FACE","EDGE","UNKNOWN"];var bx=function(){this.indices=[];this.cgmId=-1;this.count=0;this.start=0;this.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;this.gas=null;this.decoration=0;this.boundingSphere=null};var Z=function(){bx.call(this);this.planarNormals=null};Z.prototype=Object.create(bx.prototype);Z.prototype.constructor=Z;var bj=[];var a6=[];var m=[];Z.prototype.unstream=function(cL){var cF=cL.readUnsignedChar();var cH=cF&1;var cI=cF&2;var cz=cF&4;var cD=cF&8;var cJ=cL.isLightScenegraph();if(cJ){}else{}var cv=0;if(cH){cv=cL.readCompressedInt()}var cK=3*cv;var cw=0;if(cI){cw=cL.readCompressedInt()}var cp=0;if(cz){cp=cL.readCompressedInt()}var cq=cL.readCompressedInt();var ct=0;var cs=0;if(cD){this.planarNormals=new Array(3);cL.readFloatArray(0,3,this.planarNormals)}var cx=cv;var co=cL.version>=2100170||(cL.version>=1101910&&cL.version<2100000);var cu=0;var cG=0;if(co){for(var cE=0;cE<cw;++cE){var cy=cL.readCompressedInt();bj[cE]=cy;cG+=cy;cx+=cy-2}for(var cE=0;cE<cp;++cE){var cn=cL.readCompressedInt();a6[cE]=cn;cu+=cn;cx+=cn-2}}else{for(var cE=0;cE<cw;++cE){var cy=cL.unpackc();bj[cE]=cy;cG+=cy;cx+=cy-2}for(var cE=0;cE<cp;++cE){var cn=cL.unpackc();a6[cE]=cn;cu+=cn;cx+=cn-2}}if(cx<=0){return}this.indices=new Array(3*cx);var cA=3*cv;cL.unpackcArray(cA,this.indices,0);cL.unpackcArray(cG+cu,m,0);var cB=0;for(var cE=0;cE<cw;++cE){var cy=bj[cE];cB+=2;for(var cC=2;cC<cy;++cC){if(cC%2){this.indices[cA++]=m[cB];this.indices[cA++]=m[cB-1];this.indices[cA++]=m[cB-2]}else{this.indices[cA++]=m[cB-1];this.indices[cA++]=m[cB];this.indices[cA++]=m[cB-2]}cB++}}for(var cE=0;cE<cp;++cE){var cr=cB;var cn=a6[cE];cB+=2;for(var cC=2;cC<cn;++cC){this.indices[cA++]=m[cr];this.indices[cA++]=m[cB-1];this.indices[cA++]=m[cB];cB++}}};var aC=function(){};aC.prototype.unstream=function(cr){var cp=cr.getNumberOfVertices();var cn=cr.unpackc();cr.setNumberOfVertices(cn);var cq=new Z();var co=cq.unstream(cr);cr.setNumberOfVertices(cp);return co};var K=function(){bx.call(this);this.connectivity=bg.ConnectivityTypeEnum.LINES};K.prototype=Object.create(bx.prototype);K.prototype.constructor=K;var bi=[];K.prototype.unstream=function(cr){var cq=cr.readCompressedInt();if(cq>0){cr.unpackcArray(cq,bi,0);var cs=1;if(cq>1){this.indices=new Array(2*(cq-1));var cn=0;this.indices[0]=bi[0];for(var cp=2;cp<cq;++cp){var co=bi[cp-1];this.indices[cs++]=co;this.indices[cs++]=co}this.indices[cs++]=bi[cq-1]}else{this.indices=[]}}if(cr.version>=210021300){cr.readBoolean()}};var bd=function(){bx.call(this);this.connectivity=bg.ConnectivityTypeEnum.LINES;this.posBuffer=[]};bd.prototype=Object.create(bx.prototype);bd.prototype.constructor=bd;bd.prototype.unstream=function(cq){var cp=cq.readCompressedInt();var cn=cq.readCompressedInt();var cr=0;if(cp){switch(cn){case 0:for(var co=0;co<cp;++co){this.indices.push(cr++);this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat())}break;case 1:this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat());for(var co=1;co<cp;++co){this.indices.push(cr++);this.indices.push(cr);this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat())}break;case 2:for(var co=0;co<cp;++co){this.indices.push(cr++);this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat());this.posBuffer.push(cq.readFloat())}this.indices.push(0);break}}};var bR=function(){bx.call(this);this.connectivity=bg.ConnectivityTypeEnum.POINTS;this.posBuffer=null;this.symbol=0};bR.prototype=Object.create(bx.prototype);bR.prototype.constructor=bR;bR.prototype.unstream=function(co){this.symbol=co.readCompressedInt();this.start=this.indices.length;this.connectivity=bg.ConnectivityTypeEnum.POINTS;var cp=co.readCompressedInt();this.posBuffer=new Array(3*cp);co.readFloatArray(0,3*cp,this.posBuffer);for(var cn=0;cn<cp;++cn){this.indices.push(cn)}};var au=function(){bx.call(this);this.connectivity=bg.ConnectivityTypeEnum.TRIANGLES;this.posBuffer=[]};au.prototype=Object.create(bx.prototype);au.prototype.constructor=au;au.prototype.unstream=function(cy){var cw=cy.readFloat();var cu=cy.readFloat();var cs=cy.readFloat();var cv=cy.readFloat();var ct=cy.readFloat();var cr=cy.readFloat();var cp=cy.readFloat();var co=cy.readFloat();var cn=cy.readFloat();var cq=cy.readFloat();var cx=cy.readUnsignedChar()};var j=function(cn){ci.call(this);this.rep=new aX(cn)};j.prototype=Object.create(ci.prototype);j.prototype.constructor=j;j.prototype.unstream=function(cx){this.rep.unstream(cx);if(cx.version>=1000800){var cy=cx.readUnsignedChar();if(cy){this.rep.node.matrix=cx.readMatrix()}}cx.pushMatrix(this.rep.node.matrix);var cv=cx.readCompressedInt();for(var cs=0;cs<cv;++cs){var cA=cx.readUnsignedChar();if(cA==aH){var co=-1;var cp=cx.readCompressedInt();if(cx.multiRefNode.isValidIndex(cp)){cz=cx.multiRefNode.get(cp);if(cz){if(!cx.expandCGR&&!this.rep.noShow){var cw=cz.clone();this.addMesh(cw,false,cx);this.rep.children.push(cw);continue}this.rep.children.push(cz)}}else{var cu=cx.readClassName();var cr=cx.getUnstreamer(cu);if(cx.error){return false}var cz=cr.unstream(cx,this.rep.noShow);if(cx.error){return false}cx.multiRefNode.addAt(cz,cp);if(cz){if(cz.length){for(var cq=0;cq<cz.length;cq++){this.rep.children.push(cz[cq])}}else{this.rep.children.push(cz)}}}}else{var cu=cx.readClassName();var cr=cx.getUnstreamer(cu);if(cx.error){return false}var cn=cr.unstream(cx,this.rep.noShow);if(cx.error){return false}if(cn){if(cn.length){for(var cq=0;cq<cn.length;cq++){this.rep.children.push(cn[cq])}}else{this.rep.children.push(cn)}}}}if(cx.version>=210021330){var ct=cx.readUnsignedChar();if(ct){cx.skip(16)}}cx.popMatId();cx.popGAS();cx.popMatrix();return this.rep};j.prototype.getCompressedRep=function(cn){var cp=cn.sgRep;var co=cn.nbRep++;cp.push(this.rep.node.cgmId+1);cp.push(this.rep.node.solid);cp.push(this.rep.node.namingContext);if(aN){cp.push(this.rep.node.sag)}if(g){cp.push(this.rep.boundingSphere.radius);cp.push(this.rep.boundingSphere.center[0]);cp.push(this.rep.boundingSphere.center[1]);cp.push(this.rep.boundingSphere.center[2])}return co};j.prototype.getCompressedRepMulti=function(cp,ct){var cs=cp.sgRep;var cq=cp.nbRep++;var cn=3;if(g){cn+=4}if(aN){cn+=1}var cr=ct*cn;for(var co=0;co<cn;co++){cs.push(cs[cr++])}return cq};j.prototype.addMesh=function(cn,cq,ct){var cx=!cq;if(cn){if(cn.noShow){return}if(cx){ct.pushGAS(cn.repGAS,cn.repInheritanceMode);ct.pushMatrix(cn.node.matrix);ct.pushMatId(cn.material,cn.materialInheritance,cn.layer)}if(cn instanceof E){var cv=null;if(cn.repIndice!==-1){var cw=ct.getReps(cn.repIndice,cn.renderType);if(cw.noZ){var cs=ct.popGAS();cs.inherited.setType(0);ct.pushGAS(cs.inherited,cs.inh_mode)}cv=cw.clone();cv.rep=this.getCompressedRepMulti(ct,cn.node);for(var cp=0;cp<cv.drawingGroups.length;++cp){var cu=cv.drawingGroups;if(!(cu[cp].material&&cu[cp].material.primWithMaterials)){cu[cp].material=ct.getCurrentMatId()}}}if(cn.axisSystems){var cw=ct.axisSystems.get(cn.axisSystems);var co=cw.axis;cv={axis:{origin:[co.origin[0],co.origin[1],co.origin[2]],xAxis:[co.xAxis[0],co.xAxis[1],co.xAxis[2]],yAxis:[co.yAxis[0],co.yAxis[1],co.yAxis[2]],zAxis:[co.zAxis[0],co.zAxis[1],co.zAxis[2]],color:co.color},globalMatrix:ct.getCurrentMatrix()};cv.rep=cn.node}if(cv==null){ct.popMatId();ct.popMatrix();ct.popGAS();return null}this.resolvedInheritance(ct,cv);if(cx){ct.popGAS();ct.popMatrix();ct.popMatId()}return}}var cr=cn.children.length;for(var cp=0;cp<cr;cp++){this.addMesh(cn.children[cp],false,ct)}if(cx){ct.popGAS();ct.popMatrix();ct.popMatId()}};var bW=function(cn){j.call(this);this.rep=new aX(cn)};bW.prototype=Object.create(j.prototype);bW.prototype.constructor=bW;bW.prototype.unstream=function(cs){var co=cs.getAllReps();cs.initReps();j.prototype.unstream.call(this,cs);if(cs.version<210021340){var cn=cs.readFloat()}else{var cq=cs.readFloat();var cu=cs.readFloat()}var cp=cs.readUnsignedChar();if(cp==1){var cv=cs.readFloat();var ct=cs.readFloat();var cr=cs.readFloat()}cs.setReps(co);return this.rep};var v=function(cn){j.call(this);this.rep=new aX(cn)};v.prototype=Object.create(j.prototype);v.prototype.constructor=P;v.prototype.unstream=function(ct){j.prototype.unstream.call(this,ct);var cs=ct.readCompressedInt();if(cs>0){var cp=ct.getAllReps();ct.initReps();for(var co=0;co<cs;co++){var cn=ct.readFloat();var cr=ct.readClassName();var cq=ct.getUnstreamer(cr);var cu=cq.unstream(ct,this.rep.noShow);if(ct.error){return false}if(cu){this.rep.children.push(cu)}}ct.setReps(cp)}return this.rep};var P=function(cn){j.call(this);this.rep=new aX(cn)};P.prototype=Object.create(j.prototype);P.prototype.constructor=P;P.prototype.unstream=function(ct){this.rep.unstream(ct);var cn=ct.getLightDataStreaming();ct.setLightDataStreaming(false);var cs=ct.readCompressedInt();if(cs>0){var cr=ct.readClassName();var cq=ct.getUnstreamer(cr);var cu=cq.unstream(ct,this.rep.noShow);if(ct.error){return false}if(cu){this.rep.children.push(cu)}var cp=ct.readFloat()}if(cs>1){var co=ct.getAllReps();ct.initReps();for(i=1;i<cs;i++){var cr=ct.readClassName();var cq=ct.getUnstreamer(cr);var cu=cq.unstream(ct,this.rep.noShow);if(ct.error){return false}if(cu){this.rep.children.push(cu)}var cp=ct.readFloat()}ct.setReps(co)}ct.popMatId();ct.popGAS();ct.popMatrix();ct.setLightDataStreaming(cn);return this.rep};var bP=function(cn){this.rep=new aX(cn)};bP.prototype=Object.create(j.prototype);bP.prototype.constructor=bP;bP.prototype.readStaticMode=function(cv){var ct=cv.readCompressedInt();for(var cq=0;cq<ct;++cq){var cy=cv.readUnsignedChar();if(cy){var cr=cv.readCompressedInt();if(!cv.fakeMultiRep.isValidIndex(cr)||!cv.multiRefNode.isValidIndex(cr)){cv.fakeMultiRep.addAt(true,cr);var cu=cv.readClassName();if(cu==112){var cp=cv.getUnstreamer(cu);var cz=cp.unstream(cv,true)}else{var cx=new z();cx.unstream(cv)}}}else{var cu=cv.readClassName();if(cu==112){var cp=cv.getUnstreamer(cu);var cz=cp.unstream(cv,true)}else{var cx=new z();cx.unstream(cv)}}}var co=cv.readCompressedInt();var cn=[];cv.readFloatArray(0,3,cn);if(co==1){cv.pushStaticMode(cv.popMatrix());cv.currentMatrix.push(new aq.Matrix4())}if(cv.version>=1101500){var cs=cv.readCompressedInt();var cA=cv.readCompressedInt();var cw=cv.readCompressedInt()}};bP.prototype.unstream=function(cE){this.rep.unstream(cE);if(cE.version>=1000800){var ct=cE.readUnsignedChar();if(ct){this.rep.node.matrix=cE.readMatrix()}}cE.pushMatrix(this.rep.node.matrix);var cv=cE.getCurrentPosition();this.readStaticMode(cE,[]);cE.setCurrentPosition(cv);var cw=cE.readCompressedInt();for(var cB=0;cB<cw;++cB){var cD=cE.readUnsignedChar();if(cD){var cp=-1;var co=cE.readCompressedInt();if(cE.multiRefNode.isValidIndex(co)){cr=cE.multiRefNode.get(co);if(cr){if(!cE.expandCGR){var cC=cr.clone();this.addMesh(cC,false,cE)}this.rep.children.push(cr)}}else{var cq=cE.readClassName();var cu=cE.getUnstreamer(cq);var cr=cu.unstream(cE);cE.multiRefNode.addAt(cr,co);if(cr){this.rep.children.push(cr)}}}else{var cq=cE.readClassName();var cu=cE.getUnstreamer(cq);var cx=cu.unstream(cE);if(cx){this.rep.children.push(cx)}}}cE.popMatId();cE.popGAS();cE.popMatrix();var cn=cE.readCompressedInt();var cs=[];cE.readFloatArray(0,3,cs);if(cn){cE.popStaticMode()}if(cE.version>=1101500){var cy=cE.readCompressedInt();var cA=cE.readCompressedInt();var cz=cE.readCompressedInt()}return this.rep};var ck=function(cn){this.rep=new N(cn)};ck.prototype=Object.create(j.prototype);ck.prototype.constructor=ck;ck.prototype.unstream=function(cv,cz){this.rep.unstream(cv);if(cv.version>=1000800){var cx=cv.readUnsignedChar();if(cx){this.rep.node.matrix=cv.read2DMatrix()}}cv.pushMatrix(this.rep.node.matrix);var ct=cv.readCompressedInt();for(var cr=0;cr<ct;++cr){var cA=cv.readUnsignedChar();if(cA==aH){var co=-1;var cp=cv.readCompressedInt();if(cv.multiRefNode.isValidIndex(cp)){if(cz){continue}cy=cv.multiRefNode.get(cp);if(cy){if(!cv.expandCGR){var cu=cy.clone();this.addMesh(cu,false,cv)}this.rep.children.push(cy)}}else{var cs=cv.readClassName();if(cz){if(cv.fakeMultiRep.isValidIndex(cp)){continue}if(cs==112){var cq=cv.getUnstreamer(cs);cq.unstream(cv,true);cv.fakeMultiRep.addAt(true,cp);continue}var cw=new z();cw.unstream(cv);continue}var cq=cv.getUnstreamer(cs);var cy=cq.unstream(cv);cv.multiRefNode.addAt(cy,cp);if(cy){this.rep.children.push(cy)}}}else{var cs=cv.readClassName();if(cz){if(cs==112){var cq=cv.getUnstreamer(cs);cq.unstream(cv,true);continue}var cw=new z();cw.unstream(cv);continue}var cq=cv.getUnstreamer(cs);var cn=cq.unstream(cv);if(cn){this.rep.children.push(cn)}}}cv.popMatId();cv.popGAS();cv.popMatrix();return this.rep};var bF=function(){bz.call(this);this.gp=[]};bF.prototype=Object.create(bz.prototype);bF.prototype.constructor=bF;bF.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;if(this.gp.primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cu={color:cr,opacity:cn[3]/255,lineWidth:cv.getLineThickness(),pattern:cv.getLinetype()};var ct=new bg.DrawingGroup(cu,cx,1,0,this.gp.primitive.indices.length)}else{var cu={color:cr,opacity:cn[3]/255,solid:cw,basic:true};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var br=function(){bz.call(this);this.gp=[]};br.prototype=Object.create(bz.prototype);br.prototype.constructor=br;br.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;if(this.gp.primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cu={color:cr,opacity:cn[3]/255,lineWidth:cv.getLineThickness(),pattern:cv.getLinetype()};var ct=new bg.DrawingGroup(cu,cx,1,0,this.gp.primitive.indices.length)}else{var cu={color:cr,opacity:cn[3]/255,solid:cw};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var ab=function(){bz.call(this);this.gp=[]};ab.prototype=Object.create(bz.prototype);ab.prototype.constructor=ab;ab.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;if(this.gp.primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cu={color:cr,opacity:cn[3]/255,lineWidth:cv.getLineThickness(),pattern:cv.getLinetype()};var ct=new bg.DrawingGroup(cu,cx,1,0,this.gp.primitive.indices.length)}else{var cu={color:cr,opacity:cn[3]/255,solid:cw,basic:true};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var ch=function(){bz.call(this);this.gp=null;this.mat=false};ch.prototype=Object.create(bz.prototype);ch.prototype.constructor=ch;ch.prototype.unstream=function(ct){var cr=false;if(ct.readBoolean()){var cq=null;if((ct.version>=1101860&&ct.version<2100000)||(ct.version>=2100170)){cq=new cg();cr=cq.unstream(ct)}else{cq=new bD();cr=cq.unstream(ct)}if(cr){this.gp=cq}}if(ct.readBoolean()){var cn=new u();var cs=cn.unstream(ct);var cp=ct.materials.add(cs);var cu={file:"",id:cp};ct.pushMatId(cu,1,0);this.mat=true;if(cs&&typeof cs.textureId!=="undefined"){if(this.gp&&this.gp.primitive&&(this.gp.primitive.count==6)){var co=this.gp.vertexBuffer.textureBuffer;co.push(0);co.push(0);co.push(0);co.push(1);co.push(0);co.push(0);co.push(1);co.push(1);co.push(0);co.push(0);co.push(1);co.push(0)}}}};var bM=function(){bz.call(this);this.gp=[];this.mat=false};bM.prototype=Object.create(bz.prototype);bM.prototype.constructor=bM;bM.prototype.unstreamPerforatedPolygon=function(co){if(co.readBoolean()){var cn=new ch();cn.unstream(co);if(cn.gp){this.gp.push(cn.gp);this.mat=cn.mat}}};bM.prototype.build=function(cz){var cC=new bg.Mesh();var cy=cz.getCurrentMatId();if(this.mat){cz.popMatId()}var cw=cz.getGAS();var cn=cw.getDisplayedColor();var cs=new aq.Color;cs.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cA=this.rep.repGAS.getType();var cx=this.rep.repGAS.isSolid();var cr=false;if(cw.isNoZ()){cr=true}var cu=null;if(this.gp[0].primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cv={color:cs,opacity:cn[3]/255,lineWidth:cw.getLineThickness(),pattern:cw.getLinetype()};var cu=new bg.DrawingGroup(cv,cy,1,0,this.gp[0].primitive.indices.length)}else{var cv={color:cs,opacity:cn[3]/255,solid:cx};if(cr){cv.basic=true}var cu=new bg.DrawingGroup(cv,cy,4,0,this.gp[0].primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp[0].node.cgmId,cu,0,this.gp[0].primitive.indices.length);if(this.gp[0].decoration){cq.decoration=this.gp.decoration}if(this.gp[0].boundingSphere){cq.boundingSphere=this.gp[0].boundingSphere}cu.primitives.push(cq);cC.drawingGroups.push(cu);cC.vertexIndexArray=this.gp[0].primitive.indices;cC.vertexPositionArray=this.gp[0].vertexBuffer.posBuffer;cC.vertexNormalArray=this.gp[0].vertexBuffer.normalBuffer;cC.vertexUvArray=this.gp[0].vertexBuffer.textureBuffer;cC.gas.fill=cv;cC.gas.line=cv;var ct=[0,0,0];var cB=[0,0,0];if(true){var ct=[0,0,0];var cB=[0,0,0];var cp=cC.vertexPositionArray.length;if(cp>=3){ct=[cC.vertexPositionArray[0],cC.vertexPositionArray[1],cC.vertexPositionArray[2]];cB=[cC.vertexPositionArray[0],cC.vertexPositionArray[1],cC.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cC.vertexPositionArray[co]<ct[0]){ct[0]=cC.vertexPositionArray[co]}if(cC.vertexPositionArray[co+1]<ct[1]){ct[1]=cC.vertexPositionArray[co+1]}if(cC.vertexPositionArray[co+2]<ct[2]){ct[2]=cC.vertexPositionArray[co+2]}if(cC.vertexPositionArray[co]>cB[0]){cB[0]=cC.vertexPositionArray[co]}if(cC.vertexPositionArray[co+1]>cB[1]){cB[1]=cC.vertexPositionArray[co+1]}if(cC.vertexPositionArray[co+2]>cB[2]){cB[2]=cC.vertexPositionArray[co+2]}}}ct[2]=-0.01;cB[2]=0.01;cC.AABB={min:ct,max:cB}}return cC};var U=function(){bz.call(this);this.gp=[]};U.prototype=Object.create(bz.prototype);U.prototype.constructor=U;U.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;if(this.gp.primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cu={color:cr,opacity:cn[3]/255,lineWidth:cv.getLineThickness(),pattern:cv.getLinetype()};var ct=new bg.DrawingGroup(cu,cx,1,0,this.gp.primitive.indices.length)}else{var cu={color:cr,opacity:cn[3]/255,solid:cw};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var B=function(){aI.call(this);this.gp=[]};B.prototype=Object.create(aI.prototype);B.prototype.constructor=B;B.prototype.build=function(cy){var cB=new bg.Mesh();var cv=cy.getGAS();var cx=cy.getCurrentMatId();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;var cu={color:cr,opacity:cn[3]/255,symbol:this.gp.symbol};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length);var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.vertexUvArray=this.gp.vertexBuffer.textureBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var bY=function(){bz.call(this);this.gp=[]};bY.prototype=Object.create(bz.prototype);bY.prototype.constructor=bY;bY.prototype.build=function(cy){var cB=new bg.Mesh();var cv=cy.getGAS();var cx=cy.getCurrentMatId();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;var cu={color:cr,opacity:cn[3]/255,symbol:this.gp.symbol};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length);var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.vertexUvArray=this.gp.vertexBuffer.textureBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var b2=function(){bz.call(this);this.gp=[]};b2.prototype=Object.create(bz.prototype);b2.prototype.constructor=b2;b2.prototype.build=function(cy){var cB=new bg.Mesh();var cx=cy.getCurrentMatId();var cv=cy.getGAS();var cn=cv.getDisplayedColor();var cr=new aq.Color;cr.setRGB(cn[0]/255,cn[1]/255,cn[2]/255);var cz=this.rep.repGAS.getType();var cw=this.rep.repGAS.isSolid();var ct=null;if(this.gp.primitive.connectivity==bg.ConnectivityTypeEnum.LINES){var cu={color:cr,opacity:cn[3]/255,lineWidth:cv.getLineThickness(),pattern:cv.getLinetype()};var ct=new bg.DrawingGroup(cu,cx,1,0,this.gp.primitive.indices.length)}else{var cu={color:cr,opacity:cn[3]/255,solid:cw,basic:true};var ct=new bg.DrawingGroup(cu,cx,4,0,this.gp.primitive.indices.length)}var cq=new bg.MeshPrimitive(this.gp.node.cgmId,ct,0,this.gp.primitive.indices.length);if(this.gp.decoration){cq.decoration=this.gp.decoration}if(this.gp.boundingSphere){cq.boundingSphere=this.gp.boundingSphere}ct.primitives.push(cq);cB.drawingGroups.push(ct);cB.vertexIndexArray=this.gp.primitive.indices;cB.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cB.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cB.gas.fill=cu;cB.gas.line=cu;var cs=[0,0,0];var cA=[0,0,0];if(true){var cs=[0,0,0];var cA=[0,0,0];var cp=cB.vertexPositionArray.length;if(cp>=3){cs=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];cA=[cB.vertexPositionArray[0],cB.vertexPositionArray[1],cB.vertexPositionArray[2]];for(var co=0;co<cp;co+=3){if(cB.vertexPositionArray[co]<cs[0]){cs[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]<cs[1]){cs[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]<cs[2]){cs[2]=cB.vertexPositionArray[co+2]}if(cB.vertexPositionArray[co]>cA[0]){cA[0]=cB.vertexPositionArray[co]}if(cB.vertexPositionArray[co+1]>cA[1]){cA[1]=cB.vertexPositionArray[co+1]}if(cB.vertexPositionArray[co+2]>cA[2]){cA[2]=cB.vertexPositionArray[co+2]}}}cs[2]=-0.01;cA[2]=0.01;cB.AABB={min:cs,max:cA}}return cB};var b8=function(){bz.call(this);this.primitiveSets=[];this.vertexBuffer=null;this.imageRep=[]};b8.prototype=Object.create(bz.prototype);b8.prototype.constructor=b8;b8.prototype.addGP=function(co,cx,cw){if(co.imageGP){this.imageRep.push(this.addImage(co,cx,cw,this.rep));return}if(this.vertexBuffer==null){this.vertexBuffer=new l()}var cq=this.vertexBuffer.posBuffer.length/3;var cv=co.vertexBuffer;for(var cr=0;cr<cv.posBuffer.length;cr++){this.vertexBuffer.posBuffer.push(cv.posBuffer[cr]);if(cv.normalBuffer.length){this.vertexBuffer.normalBuffer.push(cv.normalBuffer[cr])}else{this.vertexBuffer.normalBuffer.push(undefined)}}var cz=[];if((co.primitives)&&(co.primitives.length)){cz=co.primitives}else{cz.push(co.primitive)}for(var cr=0;cr<cz.length;cr++){var cs=cz[cr];var cu=this.primitiveSets.length;for(cp=0;cp<cu;cp++){var cn=this.primitiveSets[cp];if((cn.connectivity==cs.connectivity)&&bg.isEqualGAS(cn.gas,cx)&&bg.isEqualMaterial(cn.material,cs.material)){cn.set.push(cs);cn.nbIndices+=cs.indices.length;break}}if(cp==this.primitiveSets.length){var cy={};cy.connectivity=cs.connectivity;cy.gas=cx;cy.material=cs.material;cy.nbIndices=cs.indices.length;cy.more_indices=0;cy.set=[];cy.set.push(cs);this.primitiveSets.push(cy)}var ct=cs.indices;for(var cp=0;cp<ct.length;cp++){ct[cp]=ct[cp]+cq}}};b8.prototype.addImage=function(cn,cr,cq,cs){var cp=new bY();var ct=cq.getCurrentMatrix();cp.rep.repInheritanceMode=cs.repInheritanceMode;cp.rep.repGAS=cs.repGAS;cp.rep.materialInheritance=cs.materialInheritance;cp.rep.repInheritanceMode=cs.repInheritanceMode;cp.rep.noShow=cs.noShow;cp.vertexBuffer=new l();cp.gp=cn;if(cn&&cn.primitive){if((typeof cn.zoomQuality!=="undefined")&&(cn.zoomQuality===0)){cq.setFixMode(true)}if(cn.point){var cu;var co=new aq.Matrix4().setPosition({x:cn.point[0],y:cn.point[1],z:cn.point[2]});if(!ct){cu=co}else{cu=new aq.Matrix4().multiplyMatrices(ct,co)}cq.pushStaticMode(cu);cq.currentMatrix.push(new aq.Matrix4())}if(cn.primitive.material){cq.pushMatId(cn.primitive.material,1,0)}var cv=cp.build(cq);cp.resolvedInheritance(cq,cv);cv.rep=cp.getCompressedRep(cq);cq.popStaticMode();if(cn.point){cq.currentMatrix.pop();cq.popStaticMode()}if(cn.primitive.material){cq.popMatId()}cq.setFixMode(false)}return cp.rep};b8.prototype.build=function(cn){if(this.primitiveSets.length==0){return null}return this.buildRep(this.vertexBuffer,this.primitiveSets,cn)};var bU=function(){j.call(this)};bU.prototype=Object.create(j.prototype);bU.prototype.constructor=bU;bU.prototype.unstream=function(co){var cn=co.readCompressedInt();var cp=j.prototype.unstream.call(this,co);var cq=co.readFloat();return cp};var bf=function(){j.call(this)};bf.prototype=Object.create(j.prototype);bf.prototype.constructor=bf;bf.prototype.unstream=function(cp){var co=cp.readCompressedInt();var cq=j.prototype.unstream.call(this,cp);var cn=cp.readUnsignedChar();return cq};var cc=function(){ck.call(this)};cc.prototype=Object.create(ck.prototype);cc.prototype.constructor=cc;cc.prototype.unstream=function(co){var cn=co.readCompressedInt();var cp=ck.prototype.unstream.call(this,co);var cq=co.readCompressedInt();cn=co.readCompressedInt();cn=Math.abs(cn);if(cn>0){co.readFloat()}return cp};var ap=function(){j.call(this)};ap.prototype=Object.create(j.prototype);ap.prototype.constructor=ap;ap.prototype.unstream=function(cq){var cp=cq.getCurrentPosition();var co=cq.readCompressedInt();var cn=cp+co+1;var cr=j.prototype.unstream.call(this,cq);cq.setCurrentPosition(cn);return cr};var bv=function(){j.call(this)};bv.prototype=Object.create(j.prototype);bv.prototype.constructor=bv;bv.prototype.applyTextureMatrix=function(ct,cp,cu){if(!(cp.node instanceof bg.SGBag)){var cv=ct.getReps(cp.repIndice,cp.renderType);var cq=cv.vertexUvArray;var cn=cq?cq.length/3:0;if(cn>0){var cs=0,cr=0;var co=new aq.Vector4();for(var cs=0;cs<cn;cs++,cr+=3){co.set(cq[cr],cq[cr+1],cq[cr+2],1);co.applyMatrix4(cu);cq[cr]=co.x/co.w;cq[cr+1]=co.y/co.w;cq[cr+2]=co.z/co.w}}}else{for(var cs=0;cs<cp.children.length;cs++){this.applyTextureMatrix(ct,cp.children[cs],cu)}}};bv.prototype.unstream=function(cq,cp){var cr=j.prototype.unstream.call(this,cq,cp);var co=cq.readBoolean();if(co){var cn=b9.prototype.unstream.call(this,cq);if(cn.textureMatrix!==undefined){this.applyTextureMatrix(cq,this.rep,cn.textureMatrix)}}return this.rep};var ah=function(cn){ci.call(this);this.rep=new E(cn)};ah.prototype=Object.create(ci.prototype);ah.prototype.constructor=ah;ah.prototype.convertConnectivity=function(cn){switch(cn){case 0:return bg.ConnectivityTypeEnum.POINTS;case 1:return bg.ConnectivityTypeEnum.LINES;case 2:return bg.ConnectivityTypeEnum.LINE_STRIP;case 3:return bg.ConnectivityTypeEnum.LINE_LOOP;case 4:return bg.ConnectivityTypeEnum.TRIANGLES;case 5:return bg.ConnectivityTypeEnum.TRIANGLE_STRIP;case 6:return bg.ConnectivityTypeEnum.TRIANGLE_FAN;default:return bg.ConnectivityTypeEnum.TRIANGLES}};ah.prototype.getByteSize=function(cn){switch(cn){case bg.DataTypeEnum.CHAR:case bg.DataTypeEnum.UCHAR:return 1;case bg.DataTypeEnum.SHORT:case bg.DataTypeEnum.USHORT:return 2;case bg.DataTypeEnum.INT:case bg.DataTypeEnum.UINT:case bg.DataTypeEnum.FLOAT:return 4;case bg.DataTypeEnum.DOUBLE:return 8;default:return 1}};ah.prototype.addSet=function(cn){};ah.prototype.unstream=function(cN){cN.setNumberOfVertices(16777216);var cs=cN.readCompressedInt();if(cs<=0){return null}var cL=[];var ct=new bg.PrimitiveGroup();ct.fillAttr=new bg.FillAttributes();ct.lineAttr=new bg.LineAttributes();for(var cF=0;cF<cs;cF++){var cC=new bg.Buffer;var cr=0;cC.indexBuffer=cN.readBoolean();cr=cN.readCompressedInt();cC.format=cN.readUnsignedChar();cC.dimension=cN.readUnsignedChar();cC.size=cr*cC.dimension;var cM=cN.readBoolean();ct.addBuffer(cF,cC);switch(cM){case q.CGR_STREAM_COMPRESS_POSITION_1:cC.data=new Float32Array(cC.size);cN.readPositionsArrayBuffer(cr,cC.data,0);break;case q.CGR_STREAM_COMPRESS_NORMAL_1:cC.data=new Float32Array(cC.size);cN.readNormalsArrayBuffer(cr,cC.data,0);break;case q.CGR_STREAM_NO_COMPRESSION:switch(cC.format){case bg.DataTypeEnum.FLOAT:cC.data=new Float32Array(cC.size);cN.readFloatArray(0,cC.size,cC.data);break;case bg.DataTypeEnum.INT:cC.data=new Int32Array(cC.size);cN.readUncompressedIntArray(cC.size,cC.data);break;case bg.DataTypeEnum.UINT:cC.data=new Uint32Array(cC.size);cN.readUncompressedIntArray(cC.size,cC.data);break;default:cC.data=new Uint8Array(cC.size);cN.readBytes(cC.size,cC.data);break}break;default:break}}var cO=cN.readCompressedInt();if(cO<=0){return null}for(var cF=0;cF<cO;cF++){var cx=new bg.Primitive();cx.nbIndices=cN.readCompressedInt();cx.connectivity=this.convertConnectivity(cN.readUnsignedChar());var cI=cN.readCompressedInt();for(var cE=0;cE<cI;cE++){var cB=new bg.VertexComponent();cB.component=cN.readUnsignedChar();cB.cardinality=cN.readUnsignedChar();cB.bufferId=cN.readCompressedInt();cB.offset=cN.readCompressedInt();cB.indices=null;var cC=ct.getBufferFromId(cB.bufferId);if(cC!==null){var cw=this.getByteSize(cC.format);if(cC.oldDimension){cB.offset/=(cw*cC.oldDimension)}else{cB.offset/=(cw*cC.dimension)}cC.component=cB.component;if(cC.component===bg.VertexComponentEnum.TEX_COORD_0||cC.component===bg.VertexComponentEnum.TEX_COORD_1||cC.component===bg.VertexComponentEnum.TEX_COORD_2||cC.component===bg.VertexComponentEnum.TEX_COORD_3){if(cC.dimension<3){var cr=cC.size/cC.dimension;var cJ=new Float32Array(3*cr);for(var cD=0;cD<cr;cD++){cJ[3*cD]=cC.data[cC.dimension*cD];if(cC.dimension>1){cJ[3*cD+1]=cC.data[2*cD+1]}else{cJ[3*cD+1]=0}cJ[3*cD+2]=0}cC.data=cJ;cC.size=3*cr;cC.oldDimension=cC.dimension;cC.dimension=3}}cB.nbValuesPerVertex=cC.dimension;cB.format=cC.format}var cz=cN.readBoolean();if(cz){cB.indices=new bg.IndexArray;cB.indices.bufferId=cN.readCompressedInt();cB.indices.offset=cN.readCompressedInt();cC=ct.getBufferFromId(cB.indices.bufferId);if(cC!==null){var cw=this.getByteSize(cC.format);cB.indices.offset/=cw;cB.indices.format=cC.format}}cx.addVertexComponent(cB)}var cv=cN.readBoolean();var cG=null;if(cv){var cA=b9.prototype.unstream.call(this,cN);if(cA.gas){cG=cA.gas}}cL.push({prim:cx,gas:cG})}this.rep.unstream(cN);var co=false;for(var cF=0;cF<cL.length;cF++){if(cL[cF].gas){var cu=cN.pushGAS(cL[cF].gas,0);var cq=cu.getDisplayedColor();var cK=cu.isTransparent();var cp=cu.isSolid();var cH=cu.getType();if(cu.isNoZ()){co=true}var cA={fill:new bg.FillAttributes(new bg.Color(cq[0]/255,cq[1]/255,cq[2]/255,cq[3]/255)),line:new bg.LineAttributes(new bg.Color(cq[0]/255,cq[1]/255,cq[2]/255,1),cu.getLineThickness(),bg.LinePatternEnum.SOLID),point:new bg.PointAttributes()};if(cH>1&&((cL[cF].prim.connectivity>=3)&&(cL[cF].prim.connectivity<6))){cA.line.forceMaterial=true}if(cH>1&&(cL[cF].prim.connectivity==6)){cA.point.forceMaterial=true}cL[cF].prim.attr=cA;cN.popGAS()}ct.addPrimitive(cL[cF].prim)}if(!co){var cu=cN.getGAS();var cp=cu.getType();if(cp==0){var cy=cN.popGAS();cy.inherited.setType(2);cN.pushGAS(cy.inherited,cy.inh_mode)}}ct.material=cN.getCurrentMatId();var cn=bg.convertToGeometry3js(ct,undefined,undefined);cn.rep=this.rep.node;this.resolvedInheritance(cN,cn);cn.rep=this.getCompressedRep(cN);cN.popMatId();cN.popGAS();return this.rep};var b9=function(){};b9.prototype.constructor=b9;b9.prototype.getNbAttributes=function(cn){var co=0;while(cn){if(cn&1){co++}cn=cn>>1}return co};b9.prototype.getAttributeType=function(cn,co){var cq=1;for(var cp=0;cp<co+1;cp++){while(!(cn&1)){cn=cn>>1;cq=cq<<1}cn=cn>>1;if(cp!==co){cq=cq<<1}}return cq};b9.prototype.unstream=function(cv){var ct={};var cn=cv.readCompressedInt();var cs=cv.getCurrentPosition();var cB=cv.readCompressedInt();var cy=b9.prototype.getNbAttributes(cn);for(var cq=0;cq<cy;cq++){var cw=b9.prototype.getAttributeType(cn,cq);switch(cw){case bQ.SGV6_ATTRIBUTE_GAS:ct.gas=cv.readGraphicAttributeSet();break;case bQ.SGV6_ATTRIBUTE_TEXTURE_MATRIX:var cp=[];if(cv.version>=210021610){var cA=cv.readCompressedUInt();var co=cv.readUnsignedChar();var cz=[];cv.readDoubles(cz,co);var cr=0;for(var cq=0,cr=0;cq<16;cq++){var cu=(cA&(3<<2*cq))>>>2*cq;switch(cu){case 0:cp.push(cz[cr++]);break;case 1:cp.push(0);break;case 2:cp.push(1);break;case 3:cp.push(-1);break;default:break}}}else{cp=new Float32Array(16);cv.readFloatArray(0,16,cp)}var cx=new aq.Matrix4();cx.set(cp[0],cp[4],cp[8],cp[12],cp[1],cp[5],cp[9],cp[13],cp[2],cp[6],cp[10],cp[14],cp[3],cp[7],cp[11],cp[15]);ct.textureMatrix=cx;break;case bQ.SGV6_ATTRIBUTE_RENDERING_MODE:case bQ.SGV6_ATTRIBUTE_POINT_TYPE:case bQ.SGV6_ATTRIBUTE_POINT_SIZE:cv.readCompressedInt();break;default:break}}cv.setCurrentPosition(cs+cB);return ct};var aW=function(cp){this.fatherId=cp.readUncompressedInt(false);var co=new a(cp);var cn=cp.readUncompressedInt(false);this.name=cp.readUnicodeString(cn/2);this.blocReader=new s(cp,0);this.getId=function(){return this.blocReader.id}};var bG=function(co,cq){this.tocEntry=cq;var cp=co;this.name=cq.name;var cn=[];var cr=[];this.header=null;this.getChild=function(cs){};this.getStreamerByName=function(cs){for(var ct=0;ct<cr.length;++ct){if(cr[ct].name==cs){return cr[ct]}}var cu=cp.getStreamer(cq,cs);if(cu!=null){if(this.header!=null){cu.version=this.header.version;cu.conversion=this.header.conversion}cu.setContainer(this);cr.push(cu)}return cu};this.getStreamer=function(){return this.getStreamerByName(this.name)};this.getChildContainer=function(cs){for(var ct=0;ct<cn.length;++ct){if(cn[ct].name==cs){return cn[ct]}}var cu=co.getChildContainer(this.tocEntry,cs);if(cu){cn.push(cu)}return cu};this.unstreamHeaderCGR=function(){this.header=this.getStreamer();var cs=this.header.readUnsignedChar();this.header.conversion=!cs;this.header.version=this.header.readUncompressedInt();if(this.header.version>b5){console.log("warning cgr version not supported "+this.header.version+">"+b5);return{error:"warning cgr version not supported"}}};this.unstreamHeaderUVR=function(cs){this.header=cs;var ct=this.header.readUnsignedChar();this.header.conversion=!ct;this.header.version=this.header.readUncompressedInt();if(this.header.version>b5){console.log("warning ugr version not supported");return{error:"warning ugr version not supported"}}};this.getResourceCGRContainer=function(){var cs=cp.getRootContainer();if(cs){return cs.getChildContainer("Resources")}else{return null}};this.getResource=function(cE){var cC;var cD=null;var cv=null;var cB=cE.readUnsignedChar();var cA=cE.readCompressedInt();if(cE.textures.isValidMultiRefIndex(cA)){cC=cE.textures.getIndex(cA);return cC}var cw=this.getStreamerByName("MainCGRResourceStreamer");cw.setCurrentPosition(cA);cE.copyStreamerInheritance(cw);var cG=null;var cz=cw.readUnsignedChar();if(!cz){if(!cB){var cy=cw.readUnsignedChar();switch(cy){case bS.TEXTURE_SIMPLE:break;case bS.TEXTURE_SIMPLE_WITH_MIPMAP:cG=new bZ();break;case bS.TEXTURE_VOLUME:break;case bS.TEXTURE_VOLUME_WITH_MIPMAP:break;case bS.TEXTURE_CUBIC_ENV_MAP:break;case bS.TEXTURE_CUBIC_ENV_MAP_WITH_MIPMAP:break}var cx=cw.readStringWithLength();var cu=cx.split("\\");var ct=cu[cu.length-1];if(cG!=null){cD=cG.unstream(cw,ct)}}else{var cG=new k();cD=cG.unstream(cw)}}else{var cF=cw.readStringWithLength();var cs=cw.readStringWithLength();console.log(" providerName = "+cF+"resourceUUID = "+cs+"not loaded")}if(cD!=null){cC=cE.textures.add(cD);cE.textures.addMultiRefIndex(cA,cC);return cC}else{return null}};this.getImage=function(cu,cy,cs){var cv=null;var cw=this.getStreamerByName("MainCGRResourceStreamer");cu.copyStreamerInheritance(cw);cw.setCurrentPosition(cy);var cx=cw.readUnsignedChar();if(cx){var ct=new bJ();cv=ct.unstream(cw)}return cv};this.getResourceShader=function(cv){var cs=cv.readUnsignedChar();var cx=0;if(cs){cx=cv.readCompressedInt()}var cw=this.getStreamerByName("MainCGRResourceStreamer");cw.conversion=cv.conversion;cw.setCurrentPosition(cx);cw.version=cv.version;var ct=cw.readUnsignedChar();if(!ct){var cu=new x();cu.unstream(cw)}else{}return cu}};var be={file:"",id:-1};var b1=null;var ae=[];var cd=1;var ao=function(co,cA,cx,cy,ct,cr,cz,cn){var cC=false;this.isV5=true;this.FTA=false;if(co&&!(co instanceof byteArrayReader)){this.expand=co.expand;this.withSceneGraph=co.withSG;a4=this.withSceneGraph;bK=co.computeSSB;aN=co.sag;aY=co.processText;this.uint32Index=co.i32Idx}else{this.expand=cA;this.withSceneGraph=cy;a4=cy;bK=cr;aN=cz;aY=cn;this.uint32Index=ct}g=cx;var cw=null;var cp=co;var cs=null;var cq=null;var cv=null;this.setFileBuffer=function(cD){cp=new byteArrayReader(cD);be={file:"",id:-1};b1=null;ae=[];cd=1;cC=false;this.isV5=true;cw=null;cs=null;cq=null;cv=null};var cB=0;this.addChild=function(cH){var cG=cH.node;if(cH.children){var cD=cH.children.length;for(var cF=0;cF<cD;cF++){cB++;var cE=cH.children[cF].node;cG.children.push(cE);if(cE.type){cE.parent=cG;this.addChild(cH.children[cF])}}}};var cu=function(cF,cD,cE){this.cgmId=cF?cF:0;this.matrix=cD?cD:null;this.boundingSphere=cE?cE:null};this.addChildExpand=function(cH){var cG=new cu(cH.node.cgmId,cH.node.matrix,cH.node.boundingSphere);if(cH.node.rep!==undefined){cG.rep=cH.node.rep}else{cG.children=[]}if(cH.children){var cD=cH.children.length;for(var cF=0;cF<cD;cF++){var cE=this.addChildExpand(cH.children[cF]);cG.children.push(cE)}}return cG};this.compressedChildren=function(cQ,cL){var cH=cQ.node;if(cL.offset>cL.size){var cK;cL.size*=2;cK=new ArrayBuffer(cL.size);cL.result.push(cK);cL.view32F=new Float32Array(cK);cL.view32UInt=new Uint32Array(cK);cL.view8UInt=new Uint8Array(cK)}cL.view32UInt[cL.offset++]=cH.cgmId;cL.view8UInt[cL.offset*4]=cH.type;cL.view8UInt[cL.offset*4+1]=cH.solid;cL.offset++;if(cQ.children){var cP=cQ.children.length,cM,cD;cL.view32UInt[cL.offset++]=cP;for(cM=0;cM<cP;cM++){cB++;cD=cQ.children[cM].node;cH.children.push(cD);cD.parent=cH;this.compressedChildren(cQ.children[cM],cL)}}if(cH.primitives){var cP=cH.primitives.length,cM,cO,cG,cE,cN;cL.view32UInt[cL.offset++]=cP;for(cM=0;cM<cP;cM++){cB++;cO=cH.primitives[cM];cE=cO.boundingSphere?true:false;cN=cO.decoration?cO.decoration[0]:false;cL.view32UInt[cL.offset++]=cO.cgmId;cL.view8UInt[cL.offset*4]=cO.type;cL.view8UInt[cL.offset*4+1]=cE;cL.view8UInt[cL.offset*4+2]=cN;cL.offset++;cL.view32UInt[cL.offset++]=cO.count;cL.view32UInt[cL.offset++]=cO.start;if(cO.group.primitives instanceof Array){cG=cL.idGroup++;cO.group.primitives=cG}else{cG=cO.group.primitives}cL.view32UInt[cL.offset++]=cG;if(cN){var cJ,cF=cO.decoration.length,cI=cL.offset*4;for(cJ=0;cJ<cF;cJ++){cL.view8UInt[cI+cJ]=cO.decoration[cJ]}cL.offset+=(cF/4>>0)+1}if(cE){cL.view32F[cL.offset++]=cO.boundingSphere.center[0];cL.view32F[cL.offset++]=cO.boundingSphere.center[1];cL.view32F[cL.offset++]=cO.boundingSphere.center[2];cL.view32F[cL.offset++]=cO.boundingSphere.radius}}}};this.applyGlobalMatrix=function(cD,cE){for(var cF=0;cF<cD.length;cF++){var cG=cD[cF].globalMatrix?!cD[cF].globalMatrix.isIdentity():false;if(cG){bg.applyMat(cD[cF],cD[cF].globalMatrix,cE)}bg.computeBB(cD[cF])}};this.applyGlobalMatrixStatic=function(cD,cE){for(var cF=0;cF<cD.length;cF++){var cG=cD[cF].globalMatrix?!cD[cF].globalMatrix.isIdentity():false;if(cG){bg.applyMat(cD[cF],cD[cF].globalMatrix,cE)}bg.computeBB(cD[cF])}};this.applyGlobalMatrixAxis=function(cH){var cF=null;var cK=new aq.Matrix4();var cJ=new aq.Vector3();var cE=new aq.Vector3();var cD=new aq.Vector3();var cL=new aq.Vector3();for(var cG=0;cG<cH.length;cG++){cF=cH[cG].axis;var cI=cH[cG].globalMatrix?!cH[cG].globalMatrix.isIdentity():false;if(cI){cJ.set(cF.origin[0],cF.origin[1],cF.origin[2]);cE.set(cF.xAxis[0],cF.xAxis[1],cF.xAxis[2]);cD.set(cF.yAxis[0],cF.yAxis[1],cF.yAxis[2]);cL.set(cF.zAxis[0],cF.zAxis[1],cF.zAxis[2]);cK.makeBasis(cE,cD,cL);cK.setPosition(cJ);cK.multiply(cH[cG].globalMatrix);cF.origin=[cK.elements[12],cK.elements[13],cK.elements[14]];cF.xAxis=[cK.elements[0],cK.elements[1],cK.elements[2]];cF.yAxis=[cK.elements[4],cK.elements[5],cK.elements[6]];cF.zAxis=[cK.elements[8],cK.elements[9],cK.elements[10]]}cH[cG]=cF}};this.applyGlobalMatrixRefPlanes=function(cE){var cH=null;var cO=new aq.Matrix4();var cM=new aq.Vector3();var cG=new aq.Vector3();var cD=new aq.Vector3();var cP=new aq.Vector3();for(var cK=0;cK<cE.length;cK++){var cI=[];var cF=cE[cK].refPlanes;for(var cJ=0;cJ<cF.length;cJ++){var cN=cF[cJ];var cL=cE[cK].globalMatrix?!cE[cK].globalMatrix.isIdentity():false;if(cL){cM.set(cN.origin[0],cN.origin[1],cN.origin[2]);cG.set(cN.xAxis[0],cN.xAxis[1],cN.xAxis[2]);cD.set(cN.yAxis[0],cN.yAxis[1],cN.yAxis[2]);cP.crossVectors(cG,cD);cO.makeBasis(cG,cD,cP);cO.setPosition(cM);cO.multiply(cE[cK].globalMatrix);cN.origin=[cO.elements[12],cO.elements[13],cO.elements[14]];cN.xAxis=[cO.elements[0],cO.elements[1],cO.elements[2]];cN.yAxis=[cO.elements[4],cO.elements[5],cO.elements[6]]}cI.push(cN)}cE[cK]=cI}};this.computePrimBS=function(cS){if(g&&cb){for(var cL=0;cL<cS.length;cL++){var cD=cS[cL];var cG=cD.vertexPositionArray;var cJ=cD.vertexIndexArray;for(var cQ=0;cQ<cD.drawingGroups.length;cQ++){var cU=cD.drawingGroups[cQ];if(cU.glType===0){continue}for(var cP=0;cP<cU.primitives.length;cP++){var cE=cU.primitives[cP];if(cE.boundingSphere){continue}var cO=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE];var cR=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];var cT=[cE];if(D&&cE.rep){if(cE.rep.boundingSphere){continue}cT=cE.rep.primitives}for(var cN=0;cN<cT.length;cN++){var cK=cT[cN];for(var cM=cK.start;cM<cK.start+cK.count;cM++){var cI=cJ[cM];if(cG[3*cI]<cO[0]){cO[0]=cG[3*cI]}if(cG[3*cI+1]<cO[1]){cO[1]=cG[3*cI+1]}if(cG[3*cI+2]<cO[2]){cO[2]=cG[3*cI+2]}if(cG[3*cI]>cR[0]){cR[0]=cG[3*cI]}if(cG[3*cI+1]>cR[1]){cR[1]=cG[3*cI+1]}if(cG[3*cI+2]>cR[2]){cR[2]=cG[3*cI+2]}}}var cF=(cO[0]-cR[0])*(cO[0]-cR[0]);cF+=(cO[1]-cR[1])*(cO[1]-cR[1]);cF+=(cO[2]-cR[2])*(cO[2]-cR[2]);cF=0.5*Math.sqrt(cF);cO[0]=0.5*(cO[0]+cR[0]);cO[1]=0.5*(cO[1]+cR[1]);cO[2]=0.5*(cO[2]+cR[2]);var cH={center:cO,radius:cF};if(D&&cE.rep){cE.rep.boundingSphere=cH}else{cE.boundingSphere=cH}}}}}};this.processAllReps=function(cE,cP,cO){var cD=[];var cN=cE.length;var cI=new aq.Vector3();var cJ=3;if(g){cJ+=4}if(aN){cJ+=1}for(var cH=0;cH<cN;cH++){var cQ=[];var cM=cE[cH].getArray();if(cH&1||cH&8){this.applyGlobalMatrixStatic(cM,cP);this.batch_static(cM,cQ,cP)}else{this.applyGlobalMatrix(cM,cP);for(var cG=0;cG<cM.length;cG++){var cL=cM[cG];var cF=cL.AABB.min;var cK=cL.AABB.max;cI.x=cK[0]-cF[0];cI.y=cK[1]-cF[1];cI.z=cK[2]-cF[2];if(g){cO[cJ*cL.rep+cJ-4]=0.5*cI.length();cO[cJ*cL.rep+cJ-3]=0.5*cF[0]+0.5*cK[0];cO[cJ*cL.rep+cJ-2]=0.5*cF[1]+0.5*cK[1];cO[cJ*cL.rep+cJ-1]=0.5*cF[2]+0.5*cK[2]}if(bK){cM[cG]._radius=0.5*cI.length()}}this.batch(cM,cQ,cP)}cD.push(cQ)}return cD};this.batch=function(cM,cI,cP){var cL=function(cT,cS){if(cT.min[0]>cS.min[0]){cT.min[0]=cS.min[0]}if(cT.min[1]>cS.min[1]){cT.min[1]=cS.min[1]}if(cT.min[2]>cS.min[2]){cT.min[2]=cS.min[2]}if(cT.max[0]<cS.max[0]){cT.max[0]=cS.max[0]}if(cT.max[1]<cS.max[1]){cT.max[1]=cS.max[1]}if(cT.max[2]<cS.max[2]){cT.max[2]=cS.max[2]}};var cQ=function(cU){var cV=cU.primitives;var cT=cV.length-1;var cS=[];for(var cT=0;cT<cV.length;cT++){if(cV[cT].rep&&cV[cT].rep.noShow){cS.push(cV[cT])}}return cS};var cN=function(cT){if(cT&&cT.drawingGroups&&cT.drawingGroups.length){var cU=cT.drawingGroups;for(var cS=0;cS<cU.length;cS++){if(cU[cS].primitives&&cU[cS].primitives.length){var cV=cQ(cU[cS]);if(!cT.noShowPrim){cT.noShowPrim=[]}cT.noShowPrim=cT.noShowPrim.concat(cV)}}}};var cR={containNoShow:false,withSAG:aN,withBoundingElement:g};var cJ=[];var cK=null;var cD=0;var cO=65535;if(this.uint32Index){cO=524287}for(var cF=0;cF<cM.length;cF++){if(!cM[cF].vertexPositionArray){continue}if(!this.FTA&&cM[cF].noShow){continue}if(!cK){cK=cM[cF].AABB}else{cL(cK,cM[cF].AABB)}if(cD+cM[cF].vertexPositionArray.length/3>=cO){if(cD==0){var cH=bg.divideRep(cM[cF],true,cR);for(var cG=0;cG<cH.length;cG++){cI.push(cH[cG])}cK=null;continue}var cE=bg.processRepsCGR(cJ,true,bK,cR,cP);cE.AABB={min:cK.min,max:cK.max};cK=null;cI.push(cE);cD=0;cJ=[]}if((cM[cF].vertexPositionArray.length/3)>=cO){var cH=bg.divideRep(cM[cF],true,cR);for(var cG=0;cG<cH.length;cG++){cI.push(cH[cG])}cK=null;continue}cJ.push(cM[cF]);cD+=cM[cF].vertexPositionArray.length/3}for(var cF=0;cF<cM.length;cF++){if(!cM[cF].vertexPositionArray){continue}if(this.FTA||!cM[cF].noShow||!this.withSceneGraph){continue}cR.containNoShow=true;if(cD+cM[cF].vertexPositionArray.length/3>=cO){if(cD==0){var cH=bg.divideRep(cM[cF],true,cR);for(var cG=0;cG<cH.length;cG++){cI.push(cH[cG])}cK=null;continue}var cE=bg.processRepsCGR(cJ,true,bK,cR,cP);if(!cK){cK={min:[0,0,0],max:[0,0,0]}}cE.AABB={min:cK.min,max:cK.max};cK=null;cI.push(cE);cD=0;cJ=[]}if((cM[cF].vertexPositionArray.length/3)>=cO){var cH=bg.divideRep(cM[cF],true,cR);for(var cG=0;cG<cH.length;cG++){cI.push(cH[cG])}cK=null;continue}cJ.push(cM[cF]);cD+=cM[cF].vertexPositionArray.length/3}if(cJ.length>0){var cE=bg.processRepsCGR(cJ,true,bK,cR,cP);if(!cK){cK={min:[0,0,0],max:[0,0,0]}}cE.AABB={min:cK.min,max:cK.max};if(cE.AABB.min[0]==cE.AABB.max[0]&&cE.AABB.min[1]==cE.AABB.max[1]&&cE.AABB.min[2]==cE.AABB.max[2]){cE.AABB.min[0]-=0.1;cE.AABB.min[1]-=0.1;cE.AABB.max[0]+=0.1;cE.AABB.max[1]+=0.1}cI.push(cE)}};this.batch_static=function(cJ,cG,cO){var cK=function(cR,cQ){for(var cP=0;cP<16;cP++){if(cR.elements[cP]!=cQ.elements[cP]){return false}}return true};var cN=[];for(var cI=0;cI<cJ.length;cI++){var cM=false;var cL=cJ[cI];for(var cH=0;cH<cN.length;cH++){if(cK(cL.attachedPoint,cN[cH].attachedPoint)){cN[cH].reps.push(cL);cM=true;break}}if(!cM){var cF=[cL];cN.push({attachedPoint:cL.attachedPoint,reps:cF})}}for(var cI=0;cI<cN.length;cI++){var cE=bg.processRepsCGR(cN[cI].reps,false,false,{containNoShow:false,withSAG:aN,withBoundingElement:g},cO);var cD=[];if(cE.AABB.min[0]==cE.AABB.max[0]&&cE.AABB.min[1]==cE.AABB.max[1]&&cE.AABB.min[2]==cE.AABB.max[2]){cE.AABB.min[0]-=0.1;cE.AABB.min[1]-=0.1;cE.AABB.max[0]+=0.1;cE.AABB.max[1]+=0.1}cD.push(cE);cG.push({tab:cD,globalMatrix:cN[cI].attachedPoint})}};this.buildSceneGraph=function(cN){var cT=[];var cE=cN.axisSystems;var cP=cN.refPlanes;var cD=cN.texts;if(!this.expand){this.applyGlobalMatrixAxis(cE);this.applyGlobalMatrixRefPlanes(cP);var cG=this.processAllReps(cN.reps,cN.materials,cN.sgRep);var cV=null;if(this.withSceneGraph&&cN.rep){this.addChild(cN.rep);cV=cN.rep.node}if(this.withSceneGraph&&cN.rep&&false){var cO=new ArrayBuffer(65536*128);var cI=[cO];var cJ=new Float32Array(cO);var cU=new Uint32Array(cO);var cH=new Uint8Array(cO);this.compressedChildren(cN.rep,{offset:0,result:cI,size:65536*128,view32F:cJ,view32UInt:cU,view8UInt:cH,idGroup:0});cV=cI}return{reps:cG,sceneGraph:cV,resource:cN.resource,material:cN.materials,sgRep:cN.sgRep,decorations:cN.decorations,axisSystems:cE,refPlanes:cP,texts:cD}}var cS=cw.reps[aZ.NORMAL].getArray();var cK=[];var cF=[];var cV=null;if(rep){cV=this.addChildExpand(rep)}for(var cL=0;cL<cS.length;cL++){if(!cS[cL].vertexPositionArray){continue}if((cS[cL].vertexPositionArray.length/3)>=65535){var cR=bg.divideRep(cS[cL],true);var cT=[];for(var cM=0;cM<cR.length;cM++){cT.push(cR[cM])}cF.push(cT);continue}var cT=[];cK.push(cS[cL]);var cQ=bg.processRepsCGR(cK);cT.push(cQ);cF.push(cT);cK=[]}cS=[];cw.all_reps=[];return{mesh:cF,resource:cw.textures.getArray(),material:cw.materials.getArray(),rep:cV}};this.init=function(){cw=new X(cp.clone());var cN=cw.readString(6);var cD=cw.readString(2);cs=cD[0];if(cN!="V5_CFV"){this.isV5=false;return{mesh:[],resource:[],material:[],excludeReps:[]}}if(cs==3){cd=0}else{cd=1}cw.conversion=true;var cO=cw.readUncompressedInt(true);var cJ=cw.readUncompressedInt(true);cw.skip(8);cw.skip(32);var cQ=cw.readUncompressedInt(true);cw.skip(4);if(cd){cw.setCurrentPosition(cO)}var cD=cw.readString(16);var cF=cw.readUnsignedChar();var cR=cw.readUnsignedShort(true);var cM=cw.readUnsignedShort(true);var cE=cw.readUnsignedShort(true);var cG=cw.readUnsignedShort(true);var cL=cw.readUnsignedShort(true);var cK=cw.readUncompressedInt(true);cw.skip(64-31);if(!cd){var cP=new Uint8Array(384+cJ);cw.readBytes(384,cP);var cH=new Uint8Array(cJ);cw.setCurrentPosition(cO);cw.readBytes(cJ,cH);cP.set(cH,384);var cI=new X(new byteArrayReader(cP));cI.conversion=true;cq=new s(cI,cG)}else{cq=new s(cw,cG)}cw.conversion=false};this.getApplicativeContainer=function(c3,cP){var cI=0;var cS=0;var cG={};if(!cP){this.init();var cJ=new Date().getTime();var cD=null;var cX=this.getRootContainer();if(!cd){var cZ=this.getEntryStreamer(cX.tocEntry);var cR=cZ.readUncompressedInt(false);var cH=cZ.readUncompressedInt(false);var c2=cZ.readUncompressedInt(false);for(var cV=0;cV<c2;cV++){var cR=cZ.readUncompressedInt(false);var cU=cZ.readUncompressedInt(false);var cH=cZ.readUnsignedShort(false);var cO=cZ.readUncompressedInt(false);this.name=cZ.readUnicodeString(cO/2)}var cM=cX.getChildContainer("MAIN");var cL=this.getEntryStreamer(cM.tocEntry);cM.unstreamHeaderUVR(cL);cI=cM.header.version;cS=cM.header.conversion}else{var cW=cX.getChildContainer("SceneGraph");cW.unstreamHeaderCGR();cI=cW.header.version;cS=cW.header.conversion}}else{var cX=this.getRootContainer();if(!cd){var cM=cX.getChildContainer("MAIN");cI=cM.header.version;cS=cM.header.conversion}else{var cW=cX.getChildContainer("SceneGraph");cI=cW.header.version;cS=cW.header.conversion}}var cF=cX.getChildContainer("Applicative Containers");if(!cF){return null}var cQ=cF.getChildContainer(c3);if(!cQ){return null}var c1=cQ.getChildContainer("MainDataStream");if(!c1){return null}var cY=this.getBufferFromEntry(c1.tocEntry);if(cY.length==0){return null}switch(c3){case"V4V5_FDT":var cK=this.getEntryStreamer(c1.tocEntry);if(!cd){cK.bitBoolean=1;cK.bitPacking=1;cK.gasPacking=1}cK.expandCGR=this.expand;cK.version=cI;cK.conversion=cS;var cT=cK.readCompressedInt();var cN=cK.readCompressedInt();cG.oldSize=cT;cG.compressed=cN;cG.offset=cK.getCurrentPosition();cK.skip(cN);if(cK.getBytesRemain()){var c0=cK.readCompressedInt();cG.oldSize=cK.readCompressedInt();cG.compressed=cK.readCompressedInt();cG.offset=cK.getCurrentPosition()}break;default:break}var cE=new Date().getTime();return{buffer:cY,options:cG}};this.getApplicativeContainerOld=function(c3){this.init();var cI=new Date().getTime();var cW=this.getRootContainer();var cD=null;var cH=0;var cR=0;if(!cd){var cY=this.getEntryStreamer(cW.tocEntry);cY.conversion=true;var cQ=cY.readUncompressedInt(false);var cG=cY.readUncompressedInt(false);var c2=cY.readUncompressedInt(false);for(var cU=0;cU<c2;cU++){var cQ=cY.readUncompressedInt(false);var cT=cY.readUncompressedInt(false);var cG=cY.readUnsignedShort(false);var cO=cY.readUncompressedInt(false);this.name=cY.readUnicodeString(cO/2)}cY.conversion=false;var cM=cW.getChildContainer("MAIN");var cK=this.getEntryStreamer(cM.tocEntry);cM.unstreamHeaderUVR(cK);cH=cM.header.version;cR=cM.header.conversion}else{var cV=cW.getChildContainer("SceneGraph");cV.unstreamHeaderCGR();cH=cV.header.version;cR=cV.header.conversion}var cW=this.getRootContainer();var cF=cW.getChildContainer("Applicative Containers");if(!cF){return null}var cP=cF.getChildContainer(c3);if(!cP){return null}var c1=cP.getChildContainer("MainDataStream");if(!c1){return null}var cX=this.getBufferFromEntry(c1.tocEntry);var cJ=this.getEntryStreamer(c1.tocEntry);if(!cd){cJ.bitBoolean=1;cJ.bitPacking=1;cJ.gasPacking=1}cJ.expandCGR=this.expand;cJ.version=cH;cJ.conversion=cR;var cS=cJ.readCompressedInt();var cN=cJ.readCompressedInt();cJ.skip(cN);var c0=cJ.readCompressedInt();cS=cJ.readCompressedInt();cN=cJ.readCompressedInt();var cE=new Date().getTime();var cL=cJ.getCurrentPosition();var cZ=cX.subarray(cJ.getCurrentPosition(),cN+cL);return{buffer:cZ,oldSize:cS,compressed:cN}};this.open=function(cQ){var cP=this.init();if(cQ){cd=0}if(!this.isV5){if(true){console.log("warning cgr version not supported or corrupted file");return{error:"cgr version not supported or corrupted file"}}else{return oldCGR}}h=false;var cI=new Date().getTime();var cY=this.getRootContainer();var cD=null;var cT=null;if(!cd){var c0=this.getEntryStreamer(cY.tocEntry);c0.conversion=true;var cS=c0.readUncompressedInt(false);var cG=c0.readUncompressedInt(false);var c1=c0.readUncompressedInt(false);for(var cW=0;cW<c1;cW++){var cS=c0.readUncompressedInt(false);var cU=c0.readUncompressedInt(false);var cG=c0.readUnsignedShort(false);var cR=c0.readUncompressedInt(false);this.name=c0.readUnicodeString(cR/2)}c0.conversion=false;var cK=cY.getChildContainer("MAIN");var cJ=this.getEntryStreamer(cK.tocEntry);var cN=cK.unstreamHeaderUVR(cJ);if(cN){return cN}var cM=cY.getChildContainer("Options");var cO=this.getEntryStreamer(cM.tocEntry);cO.setContainer(cY);var cL=cO.readUnsignedChar();if(cL>=5){var cZ=cO.readUnsignedChar()}else{}var cF=cY.getChildContainer("Skeleton");if(!cF){return null}var cT=this.getEntryStreamer(cF.tocEntry);cT.setContainer(cY);cT.version=cK.header.version;cT.conversion=cK.header.conversion;cT.bitBoolean=1;cT.bitPacking=1;cT.gasPacking=1;cT.expandCGR=this.expand;var cE=cT.readClassName();var cH=cT.getUnstreamer(cE);cD=cH.unstream(cT)}else{var cX=cY.getChildContainer("SceneGraph");var cN=cX.unstreamHeaderCGR();if(cN){return cN}var cT=cX.getStreamerByName("MainDataStream");cT.expandCGR=this.expand;var cE=cT.readClassName();var cH=cT.getUnstreamer(cE);cD=cH.unstream(cT)}cT.check();var cV=this.buildSceneGraph({axisSystems:cT.axisSystems.getArray(),refPlanes:cT.refPlanes.getArray(),texts:cT.texts.getArray(),resource:cT.textures.getArray(),materials:cT.materials.getArray(),sgRep:cT.sgRep,decorations:cT.decorations.getConcatenatedBlocks(),reps:cT.reps,rep:cD});return cV};this.openSceneGraph=function(cE,cG,cH){this.FTA=true;h=true;if(cH){aY=cH.processText}var cJ=new aG();cJ.setFromBuffer(cE);var cL=new X(cJ);cL.version=1101410;var cN=[];cL.readBytes(12,cN);var cD=cL.readUnsignedChar();cL.conversion=!cD;cL.version=cL.readCompressedInt();var cK=cL.readClassName();var cI=cL.getUnstreamer(cK);var cF=cI.unstream(cL);if(cL.error&&cG){cG(cL.error);return{reps:[],sceneGraph:null,resource:[],material:[],axisSystems:[],refPlanes:[],texts:[]}}cL.check();var cM=this.buildSceneGraph({axisSystems:cL.axisSystems.getArray(),refPlanes:cL.refPlanes.getArray(),texts:cL.texts.getArray(),resource:cL.textures.getArray(),materials:cL.materials.getArray(),sgRep:cL.sgRep,decorations:cL.decorations.getConcatenatedBlocks(),reps:cL.reps,rep:cF});if(cF.noShow&&this.withSceneGraph){cM.sceneGraph.noShow=true}if(this.withSceneGraph){return cM}else{return{mesh:cM.reps[0],resource:cM.resource,material:cM.material,axisSystems:cM.axisSystems,refPlanes:cM.refPlanes,texts:cM.texts,excludeReps:cM.reps[2]}}};this.setThicknessTable=function(cD){al=cD};this.getBufferFromEntry=function(cJ){var cI=0;var cF=cJ.blocReader.blocs;for(var cH=0;cH<cF.length;++cH){cI+=cF[cH].length}var cE=new Uint8Array(cI);var cK=0;for(var cH=0;cH<cF.length;++cH){var cD=cF[cH];for(var cG=0;cG<cD.length;++cG){cE[cK]=cp.buffer[cD.offset+cG];cK++}}return cE};this.getRootContainer=function(){if(cv){return cv}else{cv=new bG(this,cq.getRootTocEntry());cv.name="MAIN";return cv}};this.getStreamer=function(cI,cF){var cD=cq.getChildEntry(cI,cF);if(cD==null){return null}var cJ=0;var cE=new aG(cp.clone());for(var cG=0;cG<cD.blocReader.blocs.length;++cG){cE.addBloc(cD.blocReader.blocs[cG])}var cH=new X(cE);cH.name=cF;return cH};this.getEntryStreamer=function(cG){var cD=new aG(cp.clone());for(var cE=0;cE<cG.blocReader.blocs.length;++cE){cD.addBloc(cG.blocReader.blocs[cE])}var cF=new X(cD);return cF};this.getChildContainer=function(cF,cE){var cD=cq.getChildEntry(cF,cE);if(cD){return new bG(this,cD)}}};var I=function(){var cn=100000;var cp=new aq.Vector3();var co=new aq.Vector3();this.computeBoundingVolume=function(cu){var ct={min:new aq.Vector3(Infinity,Infinity,Infinity),max:new aq.Vector3(-Infinity,-Infinity,-Infinity)};for(var cq=0;cq<cu.length;cq++){var cr=cu[cq];var cs=cr.AABB;if(cs.min[0]<ct.min.x){ct.min.x=cs.min[0]}if(cs.min[1]<ct.min.y){ct.min.y=cs.min[1]}if(cs.min[2]<ct.min.z){ct.min.z=cs.min[2]}if(cs.max[0]>ct.max.x){ct.max.x=cs.max[0]}if(cs.max[1]>ct.max.y){ct.max.y=cs.max[1]}if(cs.max[2]>ct.max.z){ct.max.z=cs.max[2]}}return ct};this.partitionObjects=function(cu,cs){var cr=cp;cr.subVectors(cs.max,cs.min);var cq=0;var ct=cr.x;if(cr.y>cr.x){cq=1;ct=cr.y}if(cr.z>ct){cq=2;ct=cr.z}cu.sort(function(cx,cw){var cv=cx.AABB.max[cq];var cy=cw.AABB.max[cq];if(cv===cy){cv=cx.AABB.max[(cq+1)%3];cy=cw.AABB.max[(cq+1)%3];if(cv===cy){cv=cx.AABB.max[(cq+2)%3];cy=cw.AABB.max[(cq+2)%3];return cy-cv}return cy-cv}return cy-cv});return Math.floor(0.5*cu.length)};this.countTriangles=function(cw){var cv=0;for(var cr=0;cr<cw.length;cr++){var ct=cw[cr];var cu=ct.drawingGroups;for(var cq=0;cq<cu.length;cq++){var cs=cu[cq];if(cs.glType>=4){cv+=cs.count/3}}}return cv};this.buildBVH=function(cw,cv,cq){var cs={type:0,objects:null,bbox:null,leftRightNode:[]};cs.bbox=this.computeBoundingVolume(cw);if(cv){cv.leftRightNode[cq]=cs}if((cw.length===1)||(this.countTriangles(cw)<=cn)){cs.type=1;cs.objects=cw}else{var cu=this.partitionObjects(cw,cs.bbox);var cr=cw.slice(0,cu);var ct=cw.slice(cu,cw.length);if(cr.length){this.buildBVH(cr,cs,0)}if(ct.length){this.buildBVH(ct,cs,1)}}return cs};this.cullingBVH=function(cu,cv){var cs=cv.planes;var cw;var cr=cp;cr.addVectors(cu.min,cu.max).multiplyScalar(0.5);co.subVectors(cu.max,cu.min);var cq=0.5*co.length();for(var ct=0;ct<6;ct++){cw=cs[ct].distanceToPoint(cr);if(cw<=-cq){return false}}return true};this.getRenderListFromBVH=function(cq,cs,cr){if(cr&&!this.cullingBVH(cq.bbox,cr)){return}if(cq.type===1){cs.push(cq.objects.slice())}else{cq.leftRightNode[0]&&this.getRenderListFromBVH(cq.leftRightNode[0],cs,cr);cq.leftRightNode[1]&&this.getRenderListFromBVH(cq.leftRightNode[1],cs,cr)}}};var aV=function(){this.tabBuffer=[];this.size=0;this.chunkSize=1048576;this.currentBuffer=0;this.currentPositionInBuffer=0;this.add=function(co,cp){this.tabBuffer[cp]=co;this.size+=co.length};this.push=function(co){this.tabBuffer.push(co);this.size+=co.length};this.read=function(){if(this.currentPositionInBuffer>=this.chunkSize){this.currentBuffer++;this.currentPositionInBuffer=0}return this.tabBuffer[this.currentBuffer][this.currentPositionInBuffer++]};this.setPosition=function(co){this.currentBuffer=Math.floor(co/this.chunkSize);this.currentPositionInBuffer=co%this.chunkSize};this.readAt=function(co){return this.tabBuffer[Math.floor(co/this.chunkSize)][co%this.chunkSize]};this.length=function(){return this.size};var cn=function(cp,co){if(((position%this.chunkSize)+co)<this.chunkSize){return this.tabBuffer[Math.floor(position/this.chunkSize)]}else{return null}};this.readDouble=function(cq){var co=new DataView(this.tabBuffer[this.currentBuffer].buffer);var cp=co.getFloat64(this.currentPositionInBuffer,true);this.currentPositionInBuffer+=8;return cp};this.clone=function(){var cp=new aV();for(var co=0;co<this.tabBuffer.length;++co){cp.tabBuffer.push(this.tabBuffer[co])}cp.chunkSize=this.chunkSize;return cp};this.arrayCopy=function(ct,cr,co){var cs=0;nbBytesToCopy=cr;while(nbBytesToCopy>0){if(nbBytesToCopy==this.chunkSize-this.currentPositionInBuffer){this.currentBuffer++;this.currentPositionInBuffer=0}else{if(nbBytesToCopy>=this.chunkSize-this.currentPositionInBuffer){var cq=new Uint8Array(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,this.chunkSize-this.currentPositionInBuffer);var cp=new Uint8Array(co,ct+cs,this.chunkSize-this.currentPositionInBuffer);cp.set(cq);cs+=this.chunkSize-this.currentPositionInBuffer;nbBytesToCopy-=this.chunkSize-this.currentPositionInBuffer;this.currentBuffer++;this.currentPositionInBuffer=0}else{var cq=new Uint8Array(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,nbBytesToCopy);var cp=new Uint8Array(co,ct+cs,nbBytesToCopy);cp.set(cq);this.currentPositionInBuffer+=nbBytesToCopy;return}}}};this.getDataViews=function(cq,cp){views=[];this.setPosition(cq);var co=cp;while(co>0){if(co<=this.chunkSize-this.currentPositionInBuffer){views.push({dataView:new DataView(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,co),buffer:this.tabBuffer[this.currentBuffer],offset:this.currentPositionInBuffer});co=0}else{views.push({dataView:new DataView(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,this.chunkSize-this.currentPositionInBuffer),buffer:this.tabBuffer[this.currentBuffer],offset:this.currentPositionInBuffer});co-=this.chunkSize-this.currentPositionInBuffer;this.currentBuffer++;this.currentPositionInBuffer=0}}return views}};var aG=function(cn){this.multiPartReader=cn;this.currentPositionInView=0;this.position=0;this.offsetsInStream=[];this.dataViews=[];this.currentView=null;this.currentBuffer=null;this.offsetInBuffer=0,this.currentViewIndex=0;this.intMaxOffset=0;this.shortMaxOffset=0;this.doubleMaxOffset=0};aG.prototype.addBloc=function(cn){var cp=this.multiPartReader.getDataViews(cn.offset,cn.length);var co=this.dataViews.length;var cq=this.offsetsInStream.length?this.offsetsInStream[this.offsetsInStream.length-1]:0;this.dataViews=this.dataViews.concat(cp);for(var cr=co;cr<this.dataViews.length;++cr){if(cr==0){this.offsetsInStream.push(0)}else{this.offsetsInStream.push(this.offsetsInStream[cr-1]+this.dataViews[cr-1].dataView.byteLength)}}if(this.currentView===null){this.currentView=this.dataViews[0].dataView;this.currentBuffer=this.dataViews[0].buffer;this.offsetInBuffer=this.dataViews[0].offset;this.currentPositionInView=0;this.intMaxOffset=this.currentView.byteLength-4;this.shortMaxOffset=this.currentView.byteLength-2;this.doubleMaxOffset=this.currentView.byteLength-8}};aG.prototype.setFromBuffer=function(cn){this.dataViews.push({dataView:new DataView(cn.buffer,0,cn.length),buffer:cn,offset:0});this.offsetsInStream.push(0);this.currentView=this.dataViews[0].dataView;this.currentBuffer=this.dataViews[0].buffer;this.offsetInBuffer=this.dataViews[0].offset;this.currentPositionInView=0;this.intMaxOffset=this.currentView.byteLength-4;this.shortMaxOffset=this.currentView.byteLength-2;this.doubleMaxOffset=this.currentView.byteLength-8};aG.prototype.getBytesRemain=function(){var cn=this.currentView.byteLength-this.currentPositionInView;for(var co=this.currentViewIndex+1;co<this.dataViews.length;co++){if(this.dataViews[co]){var cp=this.dataViews[co].dataView;cn+=cp.byteLength}}return cn};aG.prototype.read=function(){if(this.currentPositionInView<this.currentView.byteLength){return this.currentBuffer[this.offsetInBuffer+this.currentPositionInView++]}else{this.currentViewIndex++;this.currentView=this.dataViews[this.currentViewIndex].dataView;this.currentBuffer=this.dataViews[this.currentViewIndex].buffer;this.offsetInBuffer=this.dataViews[this.currentViewIndex].offset;this.currentPositionInView=0;this.intMaxOffset=this.currentView.byteLength-4;this.shortMaxOffset=this.currentView.byteLength-2;this.doubleMaxOffset=this.currentView.byteLength-8;return this.currentBuffer[this.offsetInBuffer+this.currentPositionInView++]}};aG.prototype.getCurrentPosition=function(){return this.offsetsInStream[this.currentViewIndex]+this.currentPositionInView};aG.prototype.setPosition=function(cn){var cp=0;var co=0;while(cn>cp+this.dataViews[co].dataView.byteLength){cp+=this.dataViews[co].dataView.byteLength;co++}this.currentViewIndex=co;this.currentView=this.dataViews[this.currentViewIndex].dataView;this.currentBuffer=this.dataViews[this.currentViewIndex].buffer;this.offsetInBuffer=this.dataViews[this.currentViewIndex].offset;this.currentPositionInView=cn-cp;this.intMaxOffset=this.currentView.byteLength-4;this.shortMaxOffset=this.currentView.byteLength-2;this.doubleMaxOffset=this.currentView.byteLength-8};var b3=new Uint8Array(8);var ak=new Int32Array(b3.buffer);var bV=new Uint32Array(b3.buffer);var aU=new Int16Array(b3.buffer);var bu=new Uint16Array(b3.buffer);var aF=new Float32Array(b3.buffer);var aA=new Float64Array(b3.buffer);aG.prototype.readDouble=function(cn){if(cn){b3[7]=this.read();b3[6]=this.read();b3[5]=this.read();b3[4]=this.read();b3[3]=this.read();b3[2]=this.read();b3[1]=this.read();b3[0]=this.read()}else{b3[0]=this.read();b3[1]=this.read();b3[2]=this.read();b3[3]=this.read();b3[4]=this.read();b3[5]=this.read();b3[6]=this.read();b3[7]=this.read()}return aA[0]};aG.prototype.readFloatBorder=function(cn){if(cn){b3[3]=this.read();b3[2]=this.read();b3[1]=this.read();b3[0]=this.read()}else{b3[0]=this.read();b3[1]=this.read();b3[2]=this.read();b3[3]=this.read()}return aF[0]};var W=new Float32Array(1);var aJ=new Uint8Array(W.buffer);aG.prototype.readFloat=function(cn){if(this.currentPositionInView<this.intMaxOffset){var co=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=4;if(cn){aJ[3]=this.currentBuffer[co],aJ[2]=this.currentBuffer[co+1],aJ[1]=this.currentBuffer[co+2],aJ[0]=this.currentBuffer[co+3]}else{aJ[0]=this.currentBuffer[co],aJ[1]=this.currentBuffer[co+1],aJ[2]=this.currentBuffer[co+2],aJ[3]=this.currentBuffer[co+3]}return W[0]}else{return this.readFloatBorder(cn)}};aG.prototype.readIntBorder=function(cn){if(cn){b3[3]=this.read();b3[2]=this.read();b3[1]=this.read();b3[0]=this.read()}else{b3[0]=this.read();b3[1]=this.read();b3[2]=this.read();b3[3]=this.read()}return ak[0]};aG.prototype.readUIntBorder=function(cn){if(cn){b3[3]=this.read();b3[2]=this.read();b3[1]=this.read();b3[0]=this.read()}else{b3[0]=this.read();b3[1]=this.read();b3[2]=this.read();b3[3]=this.read()}return bV[0]};aG.prototype.readInt=function(cq){if(this.currentPositionInView<this.intMaxOffset){var cs=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=4;var cp=this.currentBuffer[cs],co=this.currentBuffer[cs+1],cn=this.currentBuffer[cs+2],cr=this.currentBuffer[cs+3];if(cq){return((cp<<24))+(co<<16)+(cn<<8)+(cr)}else{return((cr<<24))+(cn<<16)+(co<<8)+(cp)}}else{return this.readIntBorder(cq)}};aG.prototype.readUncompressedULong=function(co){if(this.currentPositionInView<this.intMaxOffset){var cn=this.currentView.getUint32(this.currentPositionInView,!co);this.currentPositionInView+=4;return cn}else{return this.readUIntBorder(co)}};aG.prototype.readUncompressedInt=function(co){if(this.currentPositionInView<this.intMaxOffset){var cn=this.currentView.getUint32(this.currentPositionInView,!co);this.currentPositionInView+=4;return cn}else{return this.readUIntBorder(co)}};aG.prototype.readUnsignedShortBorder=function(cn){if(cn){b3[0]=this.read();b3[1]=this.read()}else{b3[1]=this.read();b3[0]=this.read()}return bu[0]};aG.prototype.readShortBorder=function(cn){if(cn){b3[0]=this.read();b3[1]=this.read()}else{b3[1]=this.read();b3[0]=this.read()}return aU[0]};aG.prototype.readUnsignedShort=function(cp){if(this.currentPositionInView<this.shortMaxOffset){var cq=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=2;var co=this.currentBuffer[cq],cn=this.currentBuffer[cq+1];return(co<<8&65280)|(cn&255)}else{return this.readUnsignedShortBorder(cp)}};aG.prototype.readShort=function(cq){if(this.currentPositionInView<this.shortMaxOffset){var cr=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=2;var co=this.currentBuffer[cr],cn=this.currentBuffer[cr+1];if(cq){var cp=(co&127)<<8|cn;cp=cp-((co&128)<<8);return cp}else{var cp=(cn&127)<<8|co;cp=cp-((cn&128)<<8);return cp}}else{return this.readShortBorder(cq)}};aG.prototype.readShortArrayBuffer=function(cs,cn,ct){var co=2*cs;if(this.currentPositionInView+2*cs<this.currentView.byteLength){var cq=new Uint8Array(cn.buffer);var cr=this.offsetInBuffer+this.currentPositionInView;if(ct){for(var cp=0;cp<cs;++cp){cq[2*cp+1]=this.currentBuffer[cr+2*cp];cq[2*cp]=this.currentBuffer[cr+2*cp+1]}}else{for(var cp=0;cp<co;++cp){cq[cp]=this.currentBuffer[cr+cp]}}this.currentPositionInView+=co}else{for(var cp=0;cp<cs;++cp){cn[offset+cp]=this.readShort(ct)}}};aG.prototype.unpackc24=function(cr,cp,cn){if(this.currentPositionInView+3*cp<this.currentView.byteLength){for(var co=0;co<cp;++co){var cq=this.offsetInBuffer+this.currentPositionInView;cn[co+cr]=(this.currentBuffer[cq+3*co]<<16&16711680)|(this.currentBuffer[cq+3*co+1]<<8&65280)|(this.currentBuffer[cq+3*co+2]&255)}this.currentPositionInView+=3*cp}else{for(var co=0;co<cp;++co){cn[co+cr]=(this.read()<<16&16711680)|(this.read()<<8&65280)|(this.read()&255)}}};aG.prototype.readShortArray=function(cu,cs,co,ct){if(this.currentPositionInView+2*cs<this.currentView.byteLength){if(this.conversion){for(var cq=0;cq<cs;++cq){var cp=this.currentBuffer[2*cq];var cn=this.currentBuffer[2*cq+1];var cr=(cp&127)<<8|cn;co[cu+cq]=cr-((cp&128)<<8)}}else{for(var cq=0;cq<cs;++cq){var cp=this.currentBuffer[2*cq];var cn=this.currentBuffer[2*cq+1];var cr=(cp&127)<<8|cn;co[cu+cq]=cr-((cp&128)<<8)}}this.currentPositionInView+=2*cs}else{for(var cq=0;cq<cs;++cq){co[cu+cq]=this.readShort(ct)}}};aG.prototype.readBytesArrayBuffer=function(cr,cq,cn){if(this.currentPositionInView+cq<this.currentView.byteLength){var cp=this.offsetInBuffer+this.currentPositionInView;for(var co=0;co<cq;++co){cn[cr+co]=this.currentBuffer[cp+co]}this.currentPositionInView+=cq}else{for(var co=0;co<cq;++co){cn[cr+co]=this.read()}}};aG.prototype.readBytes=function(cr,cq,cn){if(this.currentPositionInView+cq<this.currentView.byteLength){var cp=this.offsetInBuffer+this.currentPositionInView;for(var co=0;co<cq;++co){cn[cr+co]=this.currentBuffer[cp+co]}this.currentPositionInView+=cq}else{for(var co=0;co<cq;++co){cn[cr+co]=this.read()}}};aG.prototype.getByteView=function(cq,cn){if(this.currentPositionInView+cq<this.currentView.byteLength){var cp=new Uint8Array(this.currentBuffer.buffer,this.offsetInBuffer+this.currentPositionInView,cq);this.currentPositionInView+=cq;return cp}else{for(var co=0;co<cq;++co){cn[co]=this.read()}return cn}};aG.prototype.readUnsignedShortArray=function(cs,cq,cn,cr){if(this.currentPositionInView+2*cq<this.currentView.byteLength){var cp=this.offsetInBuffer+this.currentPositionInView;if(!cr){for(var co=0;co<cq;++co){b3[1]=this.currentBuffer[cp+2*co];b3[0]=this.currentBuffer[cp+2*co+1];cn[cs+co]=bu[0]}}else{for(var co=0;co<cq;++co){b3[0]=this.currentBuffer[cp+2*co];b3[1]=this.currentBuffer[cp+2*co+1];cn[cs+co]=bu[0]}}this.currentPositionInView+=2*cq}else{for(var co=0;co<cq;++co){cn[cs+co]=this.readUnsignedShort(cr)}}};aG.prototype.readFloatArrayBuffer=function(cr,cn,cs){if(this.currentPositionInView+4*cr<this.currentView.byteLength){if(cs){var cq=new Uint8Array(cn.buffer);var co=4*cr;var ct=this.offsetInBuffer+this.currentPositionInView;for(var cp=0;cp<cr;++cp){cq[4*cp+3]=this.currentBuffer[ct+4*cp];cq[4*cp+2]=this.currentBuffer[ct+4*cp+1];cq[4*cp+1]=this.currentBuffer[ct+4*cp+2];cq[4*cp]=this.currentBuffer[ct+4*cp+3]}this.currentPositionInView+=4*cr}else{var cq=new Uint8Array(cn.buffer);var co=4*cr;var ct=this.offsetInBuffer+this.currentPositionInView;for(var cp=0;cp<co;++cp){cq[cp]=this.currentBuffer[ct+cp]}this.currentPositionInView+=co}}else{for(var cp=0;cp<cr;++cp){cn[cp]=this.readFloat(cs)}}};aG.prototype.readFloatArray=function(ct,cr,cn,cs){if(this.currentPositionInView+4*cr<this.currentView.byteLength){var co=this.currentPositionInView+4*cr;var cq=ct;while(this.currentPositionInView<co){cn[cq++]=this.readFloat(cs)}}else{for(var cp=0;cp<cr;++cp){cn[ct+cp]=this.readFloat(cs)}}};var Y=function(){var co=[];var cn=[];this.remove=function(cp){co.splice(cp,1)};this.add=function(cq){var cp=co.length;co[cp]=cq;return cp};this.addAt=function(cq,cp){co[cp]=cq};this.isValidIndex=function(cp){return cp<co.length};this.get=function(cp){return co[cp]};this.getArray=function(){return co};this.isValidMultiRefIndex=function(cp){if(cn[cp]!==undefined){return true}else{return false}};this.isValidMultiRefIndexWithName=function(cq,cp){if(cn[cq]!==undefined){for(var cr=0;cr<cn[cq].length;cr++){if(cn[cq][cr].streamerName===cp){return true}}return false}else{return false}};this.addMultiRefIndex=function(cp,cq){cn[cp]=cq};this.addMultiRefIndexWithName=function(cp,cr,cq){if(cn[cp]!==undefined){cn[cp].push({index:cr,streamerName:cq})}else{cn[cp]=[{index:cr,streamerName:cq}]}};this.getIndex=function(cp){return cn[cp]};this.getIndexWithName=function(cq,cr){var cp=cn[cq];for(var cs=0;cs<cp.length;cs++){if(cp[cs].streamerName===cr){return cp[cs].index}}return null}};return ao});define("Formats/CGRFile",["DS/Formats/CGRFile","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Formats/CGRFile");return b});
/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
(function(j){var g=j.Polymer,i=j.DS;var c=null,r=null,k=null,d=null,o=null,s=null,m=null,n=null,u="../..",e=".html",b={inputsEdit:"inputsEdit",optionsEdit:"optionsEdit",outputsEdit:"outputsEdit",executionEdit:"executionEdit",runConfirm:"runConfirm"},q={inputsEdit:"ad-tool-config-input-files",optionsEdit:"ad-tool-config-how",outputsEdit:"ad-tool-config-output-files",executionEdit:"ad-tool-config-where",runConfirm:"ad-tool-run-dialog"},f={loadError:"loadError",importError:"importError"},a=null,h=null,t=null,l=null,p=null;c=function(){var y,z,B,v,A,x,w,C=function(E,D){if(!E.sequence&&!D.sequence){return 0}else{if(!E.sequence){return -1}else{if(!D.sequence){return 1}else{return E.sequence-D.sequence}}}};this._initializing=true;if(this._templateView){y=JSON.parse((Array.isArray(this._templateView.definition))?this._templateView.definition.join(""):this._templateView.definition);z=Array.isArray(y.layout)?y.layout.join(""):y.layout;if(!a){a=new DOMParser()}B=a.parseFromString(z,"application/xml");v=B.documentElement.getAttribute("name");if(v){this.name=v}this._facetDefs={};A=B.querySelectorAll("ad-tool-editor-facet");if(A&&(A.length>0)){for(x=0;x<A.length;x++){w={type:null,compName:null,comp:null};v=A[x].getAttribute("type");if(v){if(v==="inputsEdit"){w.type=b.inputsEdit}else{if(v==="optionsEdit"){w.type=b.optionsEdit}else{if(v==="outputsEdit"){w.type=b.outputsEdit}else{if(v==="executionEdit"){w.type=b.executionEdit}else{if(v==="runConfirm"){w.type=b.runConfirm}}}}}if(w.type){if((typeof this._facetDefs[w.type]==="undefined")||!this._facetDefs[w.type]){this._facetDefs[w.type]=[]}v=A[x].getAttribute("comp");if(v){w.compName=v}else{w.compName=q[w.type]}v=A[x].getAttribute("sequence");if(v){w.sequence=parseInt(v)}this._facetDefs[w.type].push(w);if(this._facetDefs[w.type].length>1){this._facetDefs[w.type].sort(C)}}}}}this._dataHandler=null;A=B.querySelectorAll("ad-tool-data-handler");if(A&&(A.length>0)){v=A[0].getAttribute("comp");if(v){this._dataHandler={compName:v}}}}this._initializing=false};r=function(z,w,D){var y,x=0,C=0,v=[],B,A;for(y=0;y<w.length;y++){if(!w[y].comp){x++}}B=function(E){E.comp=document.createElement(E.compName);E.comp.tools=this.tools;E.comp.cos=this.cos;C++;if((C===x)&&D.onComplete){for(y=0;y<w.length;y++){v.push(w[y].comp)}D.onComplete(z,v)}};A=function(){if(D.onFailure){D.onFailure(z,f.importError)}};for(y=0;y<w.length;y++){if(!w[y].comp){if(w[y].compName===q[w[y].type]){w[y].comp=document.createElement(w[y].compName);w[y].comp.tools=this.tools;w[y].comp.cos=this.cos;C++;if((C===x)&&D.onComplete){for(y=0;y<w.length;y++){v.push(w[y].comp)}D.onComplete(z,v)}}else{this.importHref(d.call(this,w[y]),B.bind(this,w[y]),A)}}}};k=function(v){var w,x;w=function(y){y.comp=document.createElement(y.compName);y.comp.tools=this.tools;y.comp.cos=this.cos;if(v.onComplete){v.onComplete(y.comp)}};x=function(){if(v.onFailure){v.onFailure(f.importError)}};this.importHref(d.call(this,this._dataHandler),w.bind(this,this._dataHandler),x)};d=function(x){var v,w="";if(this.metadata&&this.metadata.locations&&this.name){w=this.metadata.locations[this.name]}if(w.startsWith("http")){v=w}else{v=u;if(!w.startsWith("/")){v+="/"}v+=w}if(!w.endsWith("/")){v+="/"}v+=x.compName+e;return v};o=function(){var v=[];if(this._facetDefs[b.inputsEdit]){v.concat(this._facetDefs[b.inputsEdit])}if(this._facetDefs[b.optionsEdit]){v.concat(this._facetDefs[b.optionsEdit])}if(this._facetDefs[b.outputsEdit]){v.concat(this._facetDefs[b.outputsEdit])}if(this._facetDefs[b.executionEdit]){v.concat(this._facetDefs[b.executionEdit])}if(this._facetDefs[b.runConfirm]){v.concat(this._facetDefs[b.runConfirm])}return v};s=function(){var v;if(this._facetDefs){if(this._facetDefs[b.inputsEdit]){for(v=0;v<this._facetDefs[b.inputsEdit].length;v++){if(this._facetDefs[b.inputsEdit][v].comp){this._facetDefs[b.inputsEdit][v].comp.tools=this.tools}}}if(this._facetDefs[b.optionsEdit]){for(v=0;v<this._facetDefs[b.optionsEdit].length;v++){if(this._facetDefs[b.optionsEdit][v].comp){this._facetDefs[b.optionsEdit][v].comp.tools=this.tools}}}if(this._facetDefs[b.outputsEdit]){for(v=0;v<this._facetDefs[b.outputsEdit].length;v++){if(this._facetDefs[b.outputsEdit][v].comp){this._facetDefs[b.outputsEdit][v].comp.tools=this.tools}}}if(this._facetDefs[b.executionEdit]){for(v=0;v<this._facetDefs[b.executionEdit].length;v++){if(this._facetDefs[b.executionEdit][v].comp){this._facetDefs[b.executionEdit][v].comp.tools=this.tools}}}if(this._facetDefs[b.runConfirm]){for(v=0;v<this._facetDefs[b.runConfirm].length;v++){if(this._facetDefs[b.runConfirm][v].comp){this._facetDefs[b.runConfirm][v].comp.tools=this.tools}}}}if(this._dataHandler&&this._dataHandler.comp){this._dataHandler.comp.tools=this.tools}};m=function(){var v;if(this._facetDefs){if(this._facetDefs[b.inputsEdit]){for(v=0;v<this._facetDefs[b.inputsEdit].length;v++){if(this._facetDefs[b.inputsEdit][v].comp){this._facetDefs[b.inputsEdit][v].comp.cos=this.cos}}}if(this._facetDefs[b.optionsEdit]){for(v=0;v<this._facetDefs[b.optionsEdit].length;v++){if(this._facetDefs[b.optionsEdit][v].comp){this._facetDefs[b.optionsEdit][v].comp.cos=this.cos}}}if(this._facetDefs[b.outputsEdit]){for(v=0;v<this._facetDefs[b.outputsEdit].length;v++){if(this._facetDefs[b.outputsEdit][v].comp){this._facetDefs[b.outputsEdit][v].comp.cos=this.cos}}}if(this._facetDefs[b.executionEdit]){for(v=0;v<this._facetDefs[b.executionEdit].length;v++){if(this._facetDefs[b.executionEdit][v].comp){this._facetDefs[b.executionEdit][v].comp.cos=this.cos}}}if(this._facetDefs[b.runConfirm]){for(v=0;v<this._facetDefs[b.runConfirm].length;v++){if(this._facetDefs[b.runConfirm][v].comp){this._facetDefs[b.runConfirm][v].comp.cos=this.cos}}}}if(this._dataHandler&&this._dataHandler.comp){this._dataHandler.comp.cos=this.cos}};n=function(){this._dataHandler=null;this._facetDefs={};this._loadError=null};h=function(w){this._templateView=w;this._loadError=false;try{c.call(this)}catch(v){this._loadError=true}};t=function(x,w){var B=null,y,A,v=[],z=false;if(w){if(this._loadError&&w.OnFailure){w.onFailure(x,f.loadError)}else{if(x&&((typeof this._facetDefs[x]!=="undefined")&&this._facetDefs[x])){B=this._facetDefs[x]}else{B=o.call(this)}if(B){for(y=0;y<B.length;y++){A=B[y];if(A.comp){v.push(A.comp)}else{z=true}}if(!z&&w.onComplete){w.onComplete(x,v)}else{r.call(this,x,B,w)}}}}};l=function(v){if(this._loadError&&v&&v.OnFailure){v.onFailure(f.loadError)}else{if(v){if(this._dataHandler&&this._dataHandler.comp){if(v.onComplete){v.onComplete(this._dataHandler.comp)}}else{if(this._dataHandler){k.call(this,v)}else{if(v.onComplete){v.onComplete(null)}}}}}};p=function(){if(this._dataHandler&&this._dataHandler.comp){return this._dataHandler.comp.validate()}else{return true}};i.SMAProcADUI=i.SMAProcADUI||{};i.SMAProcADUI.ADToolEditor=g({is:"ad-tool-editor",properties:{name:{type:String,value:null},metadata:{type:Object,value:null},tools:{type:Array,value:function(){return[]},observer:"toolsChanged"},cos:{type:Object,value:null,observer:"cosChanged"}},observers:["toolsChanged(tools.splices)"],ready:function(){return n.apply(this,arguments)},load:function(){return h.apply(this,arguments)},getFacets:function(){return t.apply(this,arguments)},getDataHandler:function(){return l.apply(this,arguments)},validate:function(){return p.apply(this,arguments)},toolsChanged:function(){s.call(this)},cosChanged:function(){m.call(this)},behaviors:[i.SMAProcSP.SPBase]});i.SMAProcADUI.ADToolEditor.FACETTYPES=i.SMAProcADUI.ADToolEditor.FACETTYPES||b;i.SMAProcADUI.ADToolEditor.ERRORS=i.SMAProcADUI.ADToolEditor.ERRORS||f}(this));
/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
(function(g){var b=g.Polymer,f=g.DS;var a=null,w=null,n=null,l=null,q=null,o=null,h=null,d=null,p=null,i=null,c=null,x=null,t=null,k=null,j=null,s="ToolLibrary",r="Released",y={cancel:"cancel",accept:"accept"},e={visible:"visible",disabled:"disabled"},m=null,u=null,v=null;a=function(B){var D=null,A=null,C=false,z=true;D=function(E){if(this._loadingSpinner){this._loadingSpinner.hide();this._loadingSpinner.stop()}this.DOM(this.$.contentArea).removeClass("hidden");this.DOM(this.$.loadingRow).addClass("hidden");this.$.toolPanel.removeAllItems();C=!this.$.showReleasedOnlyOption.checked;z=!this.$.showLatestOnlyOption.checked;E.forEach(function(F){if((C||F.lifecycleState===r)&&(z||F.isLatestRevision)){var G=this.$.toolPanel.createItem("ad-multiview-tool-def");G.viewState=G.VIEWSTATE.ready;G.model=F;G.modelSource=s;if(!this.filterAbq){this.$.toolPanel.addItem(G)}else{if(F.name.toLowerCase().indexOf("abaqus")>=0||F.name.toLowerCase().indexOf("import simulation results")>=0){this.$.toolPanel.addItem(G)}}}}.bind(this))}.bind(this);A=function(){if(this._loadingSpinner){this._loadingSpinner.hide();this._loadingSpinner.stop()}this.DOM(this.$.contentArea).removeClass("hidden");this.DOM(this.$.loadingRow).addClass("hidden")}.bind(this);this.$.toolPanel.removeAllItems();require(["DS/UIKIT/Spinner"],function(E){if(!this._loadingSpinner){this._loadingSpinner=new E({renderTo:this.$.loadingRow,visible:true})}this._loadingSpinner.spin();this._loadingSpinner.show()}.bind(this));this.DOM(this.$.contentArea).addClass("hidden");this.DOM(this.$.loadingRow).removeClass("hidden");this.$.toolManager.getToolDefs(B,{onComplete:D,onFailure:A})};w=function(){if(this.$.toolPanel.selections.length>0&&this.showOk){this.DOM(this.$.okButton).removeClass(e.disabled);this.$.okButton.disabled=false}else{this.DOM(this.$.okButton).addClass(e.disabled);this.$.okButton.disabled=true}if(this.viewMode===f.SMAProcADUI.ADMultiviewPanel.VIEWMODE.icon){this.DOM(this.$.viewIcons).addClass(e.disabled);this.DOM(this.$.viewList).removeClass(e.disabled)}else{if(this.viewMode===f.SMAProcADUI.ADMultiviewPanel.VIEWMODE.list){this.DOM(this.$.viewIcons).removeClass(e.disabled);this.DOM(this.$.viewList).addClass(e.disabled)}}};n=function(B,z){var A=B.model.name.localeCompare(z.model.name);if(A===0){if(B.model.lifecycleState!==z.model.lifecycleState){if(B.model.lifecycleState===r){A=-1}else{if(z.model.lifecycleState===r){A=1}}}}if(A===0){if(B.model.isLatestRevision){A=-1}else{if(z.model.isLatestRevision){A=1}}}if(A===0){A=B.model.lifecycleState.localeCompare(z.model.lifecycleState)}if(A===0){A=B.model.revision.localeCompare(z.model.revision)}return A};l=function(){this.$.toolPanel.sortFunction=n;var z=localStorage["SMAProcAdhoc.preferences.addToolsViewMode"];if(z&&z.length>0){this.viewMode=z}else{this.viewMode="icon"}w.call(this)};q=function(){var z=localStorage["SMAProcAdhoc.preferences.addToolsViewMode"];if(z&&z.length>0){this.viewMode=z}else{this.viewMode="icon"}w.call(this)};k=function(){this.hideDialog();this.fire(y.accept,{});this.$.toolPanel.selections=[]};j=function(){this.hideDialog();this.fire(y.cancel,{});this.$.toolPanel.selections=[]};o=function(){a.call(this,true)};h=function(){if(!b.dom(this.$.viewIcons).classList.contains(e.disabled)){this.viewMode=f.SMAProcADUI.ADMultiviewPanel.VIEWMODE.icon;localStorage["SMAProcAdhoc.preferences.addToolsViewMode"]=f.SMAProcADUI.ADMultiviewPanel.VIEWMODE.icon;w.call(this)}};d=function(){if(!b.dom(this.$.viewList).classList.contains(e.disabled)){this.viewMode=f.SMAProcADUI.ADMultiviewPanel.VIEWMODE.list;localStorage["SMAProcAdhoc.preferences.addToolsViewMode"]=f.SMAProcADUI.ADMultiviewPanel.VIEWMODE.list;w.call(this)}};p=function(z){this.$.toolPanel.selections=[];w.call(this);z.stopPropagation();z.cancelBubble=true};i=function(z){w.call(this);z.stopPropagation();z.cancelBubble=true};c=function(A){var z=[];z.push(A.detail.item);this.$.toolPanel.selections=z;if(this.showOk){this.onAccept()}A.stopPropagation();A.cancelBubble=true};x=function(z){a.call(this,false);localStorage["SMAProcAdhoc.preferences.addToolsShowReleasedOnly"]=this.$.showReleasedOnlyOption.checked;z.stopPropagation();z.cancelBubble=true};t=function(z){a.call(this,false);localStorage["SMAProcAdhoc.preferences.addToolsShowLatestOnly"]=this.$.showLatestOnlyOption.checked;z.stopPropagation();z.cancelBubble=true};m=function(){var A=localStorage["SMAProcAdhoc.preferences.addToolsShowReleasedOnly"];if(A&&A.length>0){this.$.showReleasedOnlyOption.checked=A==="true"}var z=localStorage["SMAProcAdhoc.preferences.addToolsShowLatestOnly"];if(z&&z.length>0){this.$.showLatestOnlyOption.checked=z==="true"}a.call(this,false);w.call(this);this.DOM(this.$.okButton).addClass(e.disabled);this.$.okButton.disabled=true;this.DOM(this.$.myModal).toggleClass("in");this.DOM(this.$.myModal).addClass("show");this.DOM(this.$.myModal).removeClass("hidden");this.DOM(this.$.myModalOverlay).toggleClass("in");this.DOM(this.$.myModalOverlay).addClass("show");this.DOM(this.$.myModalOverlay).removeClass("hidden")};u=function(){this.DOM(this.$.myModal).toggleClass("in");this.DOM(this.$.myModal).removeClass("show");this.DOM(this.$.myModal).addClass("hidden");this.DOM(this.$.myModalOverlay).toggleClass("in");this.DOM(this.$.myModalOverlay).removeClass("show");this.DOM(this.$.myModalOverlay).addClass("hidden")};v=function(){var z=[],B=this.$.toolPanel.selections,A;for(A=0;A<B.length;A++){if(B[A]){z.push(B[A].model)}}return z};f.SMAProcADUI=f.SMAProcADUI||{};f.SMAProcADUI.ADToolAddDialog=b({is:"ad-tool-add-dialog",properties:{selectedTools:{notify:true},showOk:{type:Boolean,value:false,observer:"showOkChanged"},viewMode:{type:String,value:""},filterAbq:{type:Boolean,value:false},headerText:{type:String,value:""}},attached:function(){return q.apply(this,arguments)},ready:function(){return l.apply(this,arguments)},onRefresh:function(){return o.apply(this,arguments)},onViewIcons:function(){return h.apply(this,arguments)},onViewList:function(){return d.apply(this,arguments)},onContentAreaClick:function(){return p.apply(this,arguments)},onToolSelect:function(){return i.apply(this,arguments)},onToolDrilldown:function(){return c.apply(this,arguments)},onShowReleasedOnlyChange:function(){return x.apply(this,arguments)},onShowLatestOnlyChange:function(){return t.apply(this,arguments)},onAccept:function(){return k.apply(this,arguments)},onCancel:function(){return j.apply(this,arguments)},showDialog:function(){return m.apply(this,arguments)},hideDialog:function(){return u.apply(this,arguments)},getSelectedToolDefs:function(){return v.apply(this,arguments)},showOkChanged:function(z){if(z){this.DOM(this.$.okButton).removeClass(e.disabled);w.call(this)}else{this.DOM(this.$.okButton).addClass(e.disabled);w.call(this)}},behaviors:[f.SMAProcSP.SPBase],_computeClass:function(z){return this.tokenList({hidden:z==="icon"})+"btn btn-xs btn-default "+this.tokenList({hidden:z==="icon"})},_computeClass2:function(z){return this.tokenList({hidden:z==="list"})+"btn btn-xs btn-default "+this.tokenList({hidden:z==="list"})},_computeClass3:function(z){return this.tokenList({hidden:z})+"pendingNote "+this.tokenList({hidden:z})},tokenList:function(B){var A=[];for(var z in B){if(B[z]){A.push(z)}}return A.join(" ")},_computeHeader:function(A){var z="Add New Tools";if(A!==""){return A}else{return z}},_computeOptions1:function(z){var A="Show released tools only";if(z!==""){A="Show released applications only"}return A}});f.SMAProcADUI.ADToolAddDialog.EVENTS=f.SMAProcADUI.ADToolAddDialog.EVENTS||y}(this));
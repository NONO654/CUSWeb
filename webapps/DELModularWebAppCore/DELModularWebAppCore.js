define("DS/DELModularWebAppCore/FacadeBase",[],function(){var a=function(h,d,k){if(!k.id){throw new Error("Element id property is not defined module for "+d)}return{name:"FacadeBase",_element:k,_moduleName:d,_moduleId:k.id,getElement:function e(){return this._element},getName:function c(){return this._moduleName},getId:function f(){return this._moduleId},getPreferenceValue:function o(t){var s=widget.getValue(t),u=widget.getPreference(t);if(u){switch(u.type){case"boolean":s=widget.getBool(t);break}}return s},getAppContext:function i(){return h.getConfig().appContext},getBehavior:function m(s){return h.getBehavior(this.getId(),s)},notify:function r(s,t){h.getMediator().notify(s,t,{sourceModuleId:this.getId()})},stop:function p(){h.stop(this.getId())},log:function j(u,s,t){if(!UWA.is(s)){return h.getLogger().log(this.getId(),u)}h.getLogger().log(this.getId(),u,s,t)},debug:function b(){Array.prototype.unshift.apply(arguments,[this.getId()]);h.getLogger().debug.apply(null,arguments)},warn:function n(){Array.prototype.unshift.apply(arguments,[this.getId()]);h.getLogger().warn.apply(null,arguments)},info:function g(){Array.prototype.unshift.apply(arguments,[this.getId()]);h.getLogger().info.apply(null,arguments)},printDuration:function l(s,t){return h.getLogger().printDuration(s,t)},printCurrentDateTime:function q(s){return h.getLogger().printCurrentDateTime(s)},}};return a});define("DS/DELModularWebAppCore/Mediator",[],function(){var a=function(e){var d=function d(n,l,j){var m,k;if(n.listenTo instanceof Function){k=n.listenTo();for(m in k){if(k.hasOwnProperty(l)){if(m===l){if(!j||j instanceof Array){(function(o){try{o.apply(n,j)}catch(p){e.getLogger().debug(e.name,"Exception on event: %s\nMessage: %s\nStack: %s",l,p.message,p.stack)}})(k[l])}}}}}};return{callHandlers:function b(l,k,j){return d(l,k,j)},preNotifyValidation:function h(j,k){return true},notifyExternalListners:function i(k,m){var l=e.getExternalListenerData(k),j=m instanceof Array?m:[m];if(l instanceof Array){l.forEach(function(o){try{if(o&&o.func){o.func.apply(e,j)}}catch(n){e.getLogger().debug(e.name,"Exception on event: %s\nMessage: %s\nStack: %s",k,n.message,n.stack)}})}},notifyPlugins:function c(j,k){return},notifyModuleAndBehaviors:function f(k,n){var l=e.getInstance(),m=Object.keys(l),j=n instanceof Array?n:[n];m.forEach(function(p){var o=l[p];if(o.isStarted){if(o.behaviors instanceof Array){o.behaviors.forEach(function(q){d(q.instance,k,j)})}d(o.instance,k,j)}})},notify:function g(j,k,l){if(this.preNotifyValidation(j,k)){this.notifyPlugins(j,k);this.notifyModuleAndBehaviors(j,k,l);this.notifyExternalListners(j,k)}}}};return a});define("DS/DELModularWebAppCore/Logger",["DS/Logger/Logger","UWA/Core","UWA/Date"],function(b,d,c){var a=function(){return{log:function g(l){b.getLogger(l).log(Array.prototype.slice.call(arguments,1))},debug:function e(m){var l=b.getLogger(m);l.debug.apply(l,Array.prototype.slice.call(arguments,1))},warn:function k(l){b.getLogger(l).warn(Array.prototype.slice.call(arguments,1))},info:function j(l){b.getLogger(l).info(Array.prototype.slice.call(arguments,1))},error:function f(m){var l=b.getLogger(m);l.error.apply(l,Array.prototype.slice.call(arguments,1))},printDuration:function i(l,n){var m=c.now(),p=l.getTime(),q=m-p,o="Duration: ";if(d.is(n)){o="Duration (for "+n+"): "}b.getLogger().log(o+q+" ms");return q},printCurrentDateTime:function h(m){var l=new c();b.getLogger().log(m+l.toISOString());return l}}};return a});define("DS/DELModularWebAppCore/Core",["UWA/Core","UWA/Promise","DS/DELModularWebAppCore/Mediator","DS/DELModularWebAppCore/Logger","DS/DELModularWebAppCore/FacadeBase"],function(f,c,d,b,a){var e=function(O){var Y={},g={},H={},E={},G=new b(),K,n=-1,P={};var W=function W(Z,ag,ac){var ab,ad,ae=Z[ag],af,aa=20000;ac=ac||{};ad=isNaN(ac.asyncLength)?-1:ac.asyncLength;ab=ac.arguments instanceof Array?ac.arguments:[];af=new c(function(aj,ai){var ak=false;if(typeof ae==="function"){try{if(ad===ae.length){ab.push(function(){aj();ak=true});ae.apply(Z,ab);setTimeout(function(){try{if(!ak){throw new Error("Timeout: No response within specified time period")}}catch(al){G.error("Core","Exception calling method: %s\nMessage: %s\nStack: %s",ag,al.message,al.stack)}},aa)}else{ae.apply(Z,ab);aj()}}catch(ah){G.error("Core","Exception calling method: %s\nMessage: %s\nStack: %s",ag,ah.message,ah.stack);ai()}}else{aj()}});return af};var T=function T(aa){var Z;if(!f.is(aa)){return false}Z=Object.keys(g);return(Z.indexOf(aa)===-1)};var p=function p(aa,ab){var Z=O.require[aa],ad={},ac=[];if(!Z){throw new Error(aa+" map is not defined in app config")}ab.forEach(function(ae){var af=Z[ae];if(af){ac.push(af);ad[af]=ae}else{throw new Error("Path to "+aa+" "+ae+" is not defined")}});return{paths:ac,nameMap:ad}};var o=function o(ab){var Z=g[ab],aa;if(Z){aa=Z.moduleName}return aa};var h=function h(Z){if(!Z){return g}return g[Z]};var X=function X(Z){if(!Z){return Y}return Y[Z]};var D=function D(aa){var Z=[];if(!aa){return H}if(!(aa instanceof Array)){return H[aa]}aa.forEach(function(ab){var ac=H[ab];if(ac){Z.push(ac)}else{throw new Error("Plugin "+ab+" was not found")}});return Z};var i=function i(Z){if(!Z){return E}return E[Z]};var Q=function Q(Z,aa){if(!E.hasOwnProperty(Z)){E[Z]={instance:aa,isStarted:false}}else{G.debug("Core","Service: %s is already registered",Z)}};var w=function w(ab,ac,ad,aa){var Z;if(!f.is(ac.id)){throw new Error("Element Id is not defined for module: "+ab)}Z=g[ac.id];if(!Z){g[ac.id]={instance:ad,behaviors:aa,moduleName:ab,element:ac,isStarted:false}}else{G.debug("Core","Module instance of %s is already registered",ab)}};var z=function z(ab,ac,Z){var aa=X(ab);if(!aa){Y[ab]={creator:ac,behaviorNames:Z,counter:0}}else{G.debug("Core","Module: %s is already registered",ab)}};var t=function t(aa,Z){if(!H.hasOwnProperty(aa)){H[aa]={instance:Z,isStarted:false}}else{G.debug("Core","Plugin: %s is already registered",aa)}};var J=function J(Z,aa,ac){var ad=p("plugin",aa),ab;ab=ad.paths.filter(function(ae){var af=D(ad.nameMap[ae]);if(!af){return true}return false});if(ab.length>0){require(ab,function(){var ag,ai,ah,ae,af;for(ag=0;ag<arguments.length;ag++){af=arguments[ag];ae=ab[ag];ai=ad.nameMap[ae];if(!af){throw new Error("Plugin "+ai+" was not loaded")}if(!D(ai)){ah=new af(Z);t(ai,ah)}}ac()})}else{ac()}};var L=function L(aa,ab,ad,ac,af){var ag=p("behavior",ac),ae=new a(aa,ab,ad),Z=[];require(ag.paths,function(){var aj,ak,ai,am,al,ah;if(arguments.length>0){for(aj=0;aj<arguments.length;aj++){ak=arguments[aj];al=ag.paths[aj];ah=ag.nameMap[al];if(!ak){throw new Error("Behavior "+ah+" was not loaded")}ai=ak.creator;am=ak.plugins;if(!(am instanceof Array)){G.error("Core","%s (behavior) plugins property is not an array",ah);am=[]}(function(ap,an,ao){J(aa,ap,function(){var at=D(ap),ar=at.map(function(av){return av.instance}),aq=[null,aa,ae].concat(ar),au=new (Function.prototype.bind.apply(an,aq));Z.push({name:ao,pluginNames:ap,instance:au,isStarted:false});if(Z.length!==ac.length){return false}af(ae,Z)})})(am,ai,ah)}}else{af(ae)}})};if(!O){O={require:{}}}return{getConfig:function q(){return O},getLogger:function k(){return G},getMediator:function C(){if(!K){K=new d(this)}return K},getInstance:function N(Z){return h(Z)},getBehavior:function S(ac,ab){var aa=h(ac),Z;if(aa){aa.behaviors.some(function(ad){if(ad.id===ab){Z=ad.instance;return true}return false})}return Z},getPlugins:function y(Z){return D(Z)},getService:function F(aa){var ab=i(aa),Z;if(f.is(ab)&&ab.instance){Z=ab.instance}return Z},getExternalListenerData:function A(Z){if(!Z){return f.clone(P)}return f.clone(P[Z])},addExternalListener:function M(Z,ab){var aa;if(!Z||!ab){return}if(!(P[Z] instanceof Array)){P[Z]=[]}aa=(++n).toString();P[Z].push({token:aa,func:ab});return aa},addExternalListenerOnce:function j(Z,ac){var aa,ab=this;function ad(ae){ab.removeExternalListener(aa);ac.call(this,ae)}aa=this.addExternalListener(Z,ad)},removeExternalListener:function s(ad){var aa,ac,ab,Z=false;if(!ad){return Z}for(aa in P){if(P[aa]){for(ac=0,ab=P[aa].length;ac<ab;ac++){if(P[aa][ac]&&P[aa][ac].token===ad){P[aa].splice(ac,1);Z=true;ab--}}}}return Z},createModule:function(Z,aa,ad,ab){var ac=this,af=X(Z),ah,ae,ag=function ag(ak,ai){var aj;z(Z,ak,ai);aj=X(Z);if(T(aa)){ad.id=aa}else{ad.id="mod-"+Z+"-"+aj.counter}aj.counter++;L(ac,Z,ad,ai,function(ap,al){var at=[],an=[],ar={},ao,aq;ai.forEach(function(au,aw){var av=false;al.some(function(ay,ax){if(isNaN(ar[ay.name])){ar[ay.name]=1}if(ay.name===au){if(an.indexOf(ax)===-1){an.push(ax);ay.id=(ar[au]>1)?ay.name+"-"+ar[au]:ay.name;av=true;ay.index=aw;return true}ar[ay.name]+=1}return false});if(!av){throw new Error("Behavior: "+au+" was not instantiated")}});if(al instanceof Array){al.sort(function am(av,au){return av.index-au.index});at=al.map(function(au){return au.instance})}ao=[null,ap].concat(at);aq=new (Function.prototype.bind.apply(ak,ao));w(Z,ad,aq,al);if(ab){ab(ad.id)}})};if(!af){ae=p("module",[Z]),require(ae.paths,function(ai){if(!(ai.behaviors instanceof Array)){G.error("Core","%s behaviors property is not an array",Z);ai.behaviors=[]}ag(ai.creator,ai.behaviors)})}else{if(ad.id){ah=h(ad.id)}if(!ah){ag(af.creator,af.behaviorNames)}else{if(ab){ab(ad.id)}}}},isStarted:function I(ab){var Z=h(ab),aa=false;if(Z){aa=Z.isStarted}return aa},isServiceStarted:function r(ab){var Z=i(ab),aa=false;if(Z){aa=Z.isStarted}return aa},start:function B(ad,ab){var aa=o(ad),ac,ae=[],Z;if(!aa||!X(aa)){G.error(this.name,"Cannot start module: %s, it needs to be created before",ad);return}if(!this.isStarted(ad)){ac=G.printCurrentDateTime("Module Name:"+aa+", Module Id:"+ad+" START - ");Z=h(ad);if(Z.behaviors instanceof Array){Z.behaviors.forEach(function(ag){var af=D(ag.pluginNames);af.forEach(function(ai){var ah;if(!ai.isStarted){if(ai.onStartPromise){ah=ai.onStartPromise}else{ah=W(ai.instance,"onStart",{asyncLength:1}).then(function(){ai.isStarted=true;if(ai.onStartPromise){delete ai.onStartPromise}});ai.onStartPromise=ah}ae.push(ah)}})});c.all(ae).then(function(){var af=[];Z.behaviors.forEach(function(ah){var ag;if(!ah.isStarted){ag=W(ah.instance,"onStart",{arguments:[ab],asyncLength:2});af.push(ag);ah.isStarted=true}});c.all(af).then(function(){var ag;Z.isStarted=true;ag=W(Z.instance,"onStart",{arguments:[ab],asyncLength:2});ag.then(function(){G.printDuration(ac,"Module Name: "+aa+", Module Id: "+ad);G.debug("Core","Module %s (module Id: %s) started successfully.",aa,ad)},function(){G.error("Core","Failed to start module.\nModule Name: %s \nModule Id: ",aa,ad)})},function(){G.error("Core","Failed to start module (as bahavior failed to start). \nModule Name: %s \nModule Id: %s",aa,ad)})},function(){G.error("Core","Failed to start module (as plugin failed to start). \nModule Name: %s \nModule Id: %s",aa,ad)})}}},startService:function x(ab){var aa,Z=i(ab);if(!Z||!Z.instance){G.error(this.name,"Cannot start service: %s, it needs to be created before",ab);return}if(!Z.isStarted){aa=G.printCurrentDateTime("Service Name:"+ab+" START - ");return W(Z.instance,"onStart",{asyncLength:1}).then(function(){Z.isStarted=true;G.printDuration(aa,"Service Name: "+ab);G.debug("Core","Service %s started successfully.",ab)},function(){G.debug("Core","Service %s failed to start.",ab)})}},startAll:function V(){var Z=this,ab=Object.keys(g),aa=arguments;ab.forEach(function(ac){Z.start(ac,aa)})},startAllServices:function m(ad){var aa=this,Z=0,ac=c.resolve(),ab=Object.keys(E);ab.forEach(function(ae){ac=ac.then(function(){return aa.startService(ae)}).then(function(){Z++;if(Z===ab.length){if(typeof ad==="function"){ad.apply(null,null)}}})["catch"](function(af){throw new Error("Failed to load the service "+ab[Z]+" Error description: "+af)})})},stop:function v(aa){var Z=h(aa);if(!Z){G.error(this.name,"Error stopping module instance: %s",aa);return false}if(this.isStarted(aa)){Z.behaviors.forEach(function(ab){if(ab.isStarted){W(ab.instance,"onStop");ab.isStarted=false}});W(Z.instance,"onStop");Z.isStarted=false}},stopAll:function U(){var aa=this,Z,ad=Object.keys(E),ac=Object.keys(H),ab=Object.keys(g);ad.forEach(function(ae){Z=i(ae);if(Z){W(Z.instance,"onStop");Z.isStarted=false}});ab.forEach(function(ae){aa.stop(ae)});ac.forEach(function(ae){Z=D(ae);if(Z&&Z.isStarted){W(Z.instance,"onStop");Z.isStarted=false}})},end:function u(Z){this.stop(Z);if(h(Z)){delete g[Z]}},endAll:function l(){var Z=this,aa=Object.keys(g);aa.forEach(function(ab){Z.end(ab)})},useServices:function R(af,ad,ac){var aa=this,ab=ac,ae=p("service",af),Z;Z=ae.paths.filter(function(ah){var ag=i(ae.nameMap[ah]);if(!ag){return true}return false});if(Z.length>0){require(Z,function(){var ai,aj,ag,ak,ah;for(ai=0;ai<arguments.length;ai++){ah=arguments[ai];ak=Z[ai];aj=ae.nameMap[ak];if(!ah){throw new Error("Service "+aj+" was not loaded")}if(!i(aj)){ag=new ah(aa,ab);Q(aj,ag)}}aa.startAllServices(ad)})}else{aa.startAllServices(ad)}}}};return e});
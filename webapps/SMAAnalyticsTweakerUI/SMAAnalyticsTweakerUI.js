define("DS/SMAAnalyticsTweakerUI/SMAAnalyticsTweakerExprEval",["DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils","DS/SMAProcWebCMMCalculator/Parser/SMAProcWebCMMEval","DS/SMAProcWebCMMCalculator/Parser/SMAProcWebEval","DS/JSCMM/SMAJSCMMFactory"],function(d,e,c,f){var b=undefined;var a={evalExpression:function(g,h,j){var k=[];try{j=j||g.getParameters();k=e.evaluate(h,j,null,{onlyLogicalExpression:true,restrictUndeclaredParameter:true}).result;if(k.output!==undefined&&k.output!==null){return k.output}else{return true}}catch(i){return true}},createCMMParameter:function(g,n,l,k,h,i,o){var j={dataelements:{arraydim:{value:[{value:o}]},name:{value:[{value:g}]},displayName:{value:[{value:n}]},type:{value:[{value:l}]},valuetype:{value:[{value:i}]},mode:{value:[{value:k}]}},objectId:h};var m=f.createParameter(j);m.setDisplayName(n);if(l===undefined){m.setDataType(-1)}return m},};return a});define("DS/SMAAnalyticsTweakerUI/SMAAnalyticsTweakerUI",["UWA/Core","DS/Tree/TreeListView","DS/Tree/TreeNodeModel","DS/SMAAnalyticsNLS/SMAAnalyticsNLSUtils","DS/SMAAnalyticsTweakerUI/SMAAnalyticsTweakerExprEval","DS/SMAProcWebCMMCalculator/SMAProcWebCMMCalcNamespace"],function(d,f,e,a,b,c){var g=undefined;var i=undefined;var h=d.Class.extend({_proxy:undefined,_optThetaTree:undefined,_ctWrapper:undefined,updateUI:function(p,y,u,F,E,A,z,k){p[A].parameters[y].defaultValue=u;var I=E.getParameters()||[];if(k){F=(F.toLowerCase()==="number")?"real":F;var q=b.createCMMParameter(y,y,F,"unknown",undefined,undefined,"SDK");q.setValue(u);for(var D=0;D<I.length;D++){if(y===I[D].getName()){I[D]=q;break}}}var s=p[A].parameters;var G={};for(var H in s){var r=p[A].parameters[H].semantics.visibleCondition;if(r){var t=b.evalExpression(E,r,I);if(t==false){}else{var w=p[A].parameters[H].group;if(w===undefined){w=""}if(!G[w]){G[w]={}}G[w][H]={}}}else{var w=p[A].parameters[H].group;if(w===undefined){w=""}if(!G[w]){G[w]={}}G[w][H]={}}}var l=z.getNthRoot(0);var m=l.getChildren();var n={};for(var D=0;D<m.length;D++){var v=m[D]._options.isGroup;if(v){var w=m[D]._options.label;if(!n[w]){n[w]={}}var B=m[D]._options.children;for(var C=0;C<B.length;C++){n[w][B[C]._options.key]={}}}else{var w="";if(!n[w]){n[w]={}}n[w][m[D]._options.key]={}}}for(var w in G){var x=G[w];for(var o in x){if(n[w][o]===undefined){z.prepareUpdate();g.addToTree(z,w,o,p,E,A,n,k);z.pushUpdate()}}}for(var w in n){var x=n[w];for(var o in x){if(G[w][o]===undefined){g.removeNode(z,w,o)}}}},addToTree:function(r,q,p,o,j,m,k,l){var n=false;if(k[q]){n=true}if(n){g.addNode(r,q,p,o,j,m,l)}else{g.addGroup(r,q,p,o,j,m,l)}},removeNode:function(u,t,s){var p=u.getNthRoot(0);var l=p.getChildren();for(var o=0;o<l.length;o++){var q=l[o]._options.isGroup;if(q){var k=l[o]._options.label;if(t==k){var r=l[o].getChildren();for(var n=0;n<r.length;n++){var m=r[n]._options.key;if(m==s){l[o].removeChild(r[n]);break}}break}}else{var m=l[o]._options.key;if(m==s){p.removeChild(l[o]);break}}}},addGroup:function(r,q,p,n,j,m,l){var k,o;k=new e({label:q,isGroup:true,grid:{data:""}});o=g.generateValueNode(n,p,m,j,r,l);k.addChild(o);o.collapseAll();r.getNthRoot(0).addChild(k);k.expandAll()},addNode:function(v,u,t,q,k,o,n){var p=v.getNthRoot(0);var l=p.getChildren();var s=g.generateValueNode(q,t,o,k,v,n);if(u==""){p.addChild(s)}else{for(var m=0;m<l.length;m++){var r=l[m]._options.isGroup;if(r){var j=l[m]._options.label;if(u==j){l[m].addChild(s)}}}}},buildTweakerUI:function(x,v,k,j,u,n){g=this;g._proxy=u;var t=false;var w,o;var r=d.createElement("div",{id:"my-settings-wrapperInside"+x.id,styles:{height:"100%",width:"90%",overflow:"visible"}});r.inject(x,"top");if(g._ctWrapper&&g._optThetaTree){g._ctWrapper.inject(r.parentElement);g._optThetaTree.inject(g._ctWrapper)}if(r.children.length===0){var m=[];for(var q in v){if(v[q].displayName){m.push(v[q].displayName)}else{m.push(v[q].title)}if(t===false){for(var y in v[q].parameters){var p=v[q].parameters[y].semantics.visibleCondition;if(typeof p!=="undefined"){t=true;break}}}}if(true===n){m.sort()}if(k==a.translate("APPROX_TYPE")){if((Object.keys(u.approximations).length)>1){m.push(a.translate("AP_TYPE_BEST"))}}var s,l;s=(typeof i==="undefined"||i===null||i===0)?m[0]:i;l=Object.keys(v).filter(function(z){return(v[z].displayName===i||v[z].title===i)})[0];if(!l){l=Object.keys(v).filter(function(z){return v[z].displayName===m[0]||v[z].title===m[0]})[0];s=i=m[0]}o=[{label:k,semantics:{possibleValues:m},data:s,key:l,typeRep:"enumString",events:{change:function(C){var A=C.dsModel.elements.internalView.currentLabel;i=A;if(A==a.translate("AP_TYPE_BEST")){this.model.options.grid.key=A;this.model.options.grid.data=A;this.model.getNthParent(0).removeChildren();document.getElementById("approxName").value="Best"}else{var z=C.dsModel.elements.internalView.preselectedIndex;var B=Object.keys(v).filter(function(D){return(v[D].displayName===C.dsModel.value||v[D].title===C.dsModel.value)})[0];this.model.options.grid.data=v[B].displayName||v[B].title;this.model.options.grid.key=B;this.model.getNthParent(0).removeChildren();g.setupUI(this.model.getNthParent(0).getTreeDocument(),w,B,v,t)}}}}];w=g._onReady(r,l,v,o,j,t);return w}},setupUI:function(r,y,s,l,j){var v=c.getNamespace();var o=l[s].parameters;var t=document.getElementById("inlineContainer");var x=[];for(var B in o){var u=l[s].parameters[B].defaultValue;var z=l[s].parameters[B].semantics.valueType;if(z===undefined){z=l[s].parameters[B].semantics.typeRep}z=(z.toLowerCase()==="number")?"real":z;u=(z.toLowerCase()==="boolean"&&(typeof u==="undefined"||u===null))?false:u;if(j){var m=b.createCMMParameter(B,B,z,"unknown",undefined,undefined,"SDK");m.setValue(u);x.push(m)}}if(j){v.setParameters(x)}var A={};for(var B in o){var n=l[s].parameters[B].semantics.visibleCondition;if(n){var p=b.evalExpression(v,n);if(p==false){}else{var q=l[s].parameters[B].group;if(q===undefined){q=""}if(!A[q]){A[q]={}}A[q][B]={}}}else{var q=l[s].parameters[B].group;if(q===undefined){q=""}if(!A[q]){A[q]={}}A[q][B]={}}}r.prepareUpdate();var k=r.getNthRoot(0);var w=g._generateTreeModelFromGroups(l,A,v,r,s,j);w.forEach(function(C){k.addChild(C)},g);k.expandAll();r.pushUpdate()},generateValueNode:function(r,w,p,k,y,o){var u;var m=r[p].parameters[w].semantics.valueType;var q=r[p].parameters[w].defaultValue;var t="";if(typeof m==="undefined"||m===null||m.length===0||m==="string"){t=r[p].parameters[w].semantics.typeRep}if(m==="boolean"){if(q===undefined){q=false}u=new e({label:r[p].parameters[w].label||w,title:r[p].parameters[w].description||w,isGroup:false,key:w,grid:{data:q,typeRep:m,events:{change:function(A){var z=this.model._options.key;this.model._options.grid.data=A.dsModel.value;g.updateUI(r,z,A.dsModel.value,m,k,p,y,o)}}}})}else{if(m==="integer"||m==="number"){var s=r[p].parameters[w].semantics.minValue;var n=r[p].parameters[w].semantics.maxValue;if(s===undefined){s=0}else{s=s.toFixed(0)}if(typeof(q)!=="number"){q=0}u=new e({label:r[p].parameters[w].label||w,title:r[p].parameters[w].description||w,isGroup:false,key:w,grid:{data:q,typeRep:m,events:{postEdit:function(A){var z=this.model._options.key;this.model._options.grid.data=A.dsModel.elements.internalView.value;this.model._options.grid["default"]=A.dsModel.elements.internalView.value;r[p].parameters[z].defaultValue=A.dsModel.elements.internalView.value;A.stopImmediatePropagation();g.updateUI(r,z,A.dsModel.elements.internalView.value,m,k,p,y,o);A.preventDefault();A.stopPropagation()}},semantics:{minValue:s,maxValue:n}}})}else{if(t==="enum"){var j=r[p].parameters[w].semantics["enum"];var l=[];for(var x in j){if(j.hasOwnProperty(x)){l.push(j[x])}}var v=r[p].parameters[w].data;u=new e({label:r[p].parameters[w].label||w,title:r[p].parameters[w].description||w,isGroup:false,key:w,grid:{data:Object.keys(j)[v],typeRep:"enumString",semantics:{possibleValues:l},events:{change:function(B){var A=this.model._options.key;var z=B.dsModel.elements.internalView.preselectedIndex;var C=Object.keys(j)[z];this.model._options.grid.data=C;g.updateUI(r,A,C,t,k,p,y),o}}}})}}}return u},_generateTreeModelFromGroups:function(o,l,j,t,n,m){var s=[];var p,k;for(var r in l){if(r!=""){k=new e({label:r,isGroup:true,grid:{data:""}});for(var q in l[r]){p=g.generateValueNode(o,q,n,j,t,m);k.addChild(p);p.collapseAll()}s.push(k);k.expandAll()}else{for(var q in l[r]){p=g.generateValueNode(o,q,n,j,t,m);if(p){s.push(p);p.expandAll()}}}}return s},_createHeaders:function(j){var k={expanderStyle:"none",headersDimensions:{height:0,width:20},defaultCellHeight:40,height:"auto",apiVersion:2,resize:{columns:false},selection:false,shouldAcceptDrag:function(l){return false},show:{rowHeaders:false,columnHeaders:false},columns:[{dataIndex:"tree",isHidden:false,isEditable:false,width:"40%"},{text:"",dataIndex:"default",width:"45%",onCellRequest:function(l){if(l.nodeModel.options.isGroup!=true){g._generateCellView(l,{escapeHTML:this.escapeHTML},j)}}}]};return k},_generateCellView:function(n,m,l){var j=n.cellView;m.readOnly=!m.readOnly?m.readOnly=false:m.readOnly;m.touchMode=!m.touchMode?m.touchMode=false:m.touchMode;m.escapeHTML=!m.escapeHTML?m.escapeHTML=false:m.escapeHTML;if(n.nodeModel&&n.nodeModel.options){var k=n.nodeModel.options.grid;if(k["default"]==undefined){l.generateView(k.data,{typePath:k.typeRep,semantics:k.semantics,defaultValue:k["default"],readOnly:k.readOnly||m.readOnly,touchMode:m.touchMode,escapeHTML:m.escapeHTML,context:"inlinedTemplate",onViewCreated:function(q){if(q!==undefined){j.getContent().setContent(q)}var o=n.nodeModel;var p=o.options.grid.events;if(p){Object.keys(p).forEach(function(r){q.addEventListener(r,p[r].bind({model:o}))})}}})}else{l.generateView(k["default"],{typePath:k.typeRep,semantics:k.semantics,defaultValue:k["default"],readOnly:k.readOnly||m.readOnly,touchMode:m.touchMode,escapeHTML:m.escapeHTML,context:"inlinedTemplate",onViewCreated:function(q){if(q!==undefined){j.getContent().setContent(q)}var o=n.nodeModel;var p=o.options.grid.events;if(p){Object.keys(p).forEach(function(r){q.addEventListener(r,p[r].bind({model:o}))})}}})}}},_onReady:function(n,p,r,m,j,o){var k=g._createHeaders(j);var l=new f(k);var t=l.getManager();t.setHeadersDimensions({width:0,height:0});l.inject(n);l.getContent().addClassName("ra-approx-settings-theme");var q=l.getDocument();q.prepareUpdate();var s=g._generateTreeModel(m);s.forEach(function(u){q.addRoot(u)},this);q.pushUpdate();l.getNthRoot(0).removeChildren();g.setupUI(q,s,p,r,o);return s},_generateTreeModel:function(k){var j=[];k.forEach(function(l){var m=new e({label:l.label,title:l.title,grid:{data:l.data,key:l.key,typeRep:l.typeRep,semantics:l.semantics,events:l.events}});if(Array.isArray(l.childNodes)){g._addChildNodes(m,l.childNodes)}j.push(m);m.expandAll()},this);return j},_createCustomThetaTable:function(){var n=_me._proxy.getInputParametersList2(),k=_me._proxy.getOutputParametersList2(),o=n.map(function(q){return q.displayName}),p=k.map(function(q){return q.displayName});var l={apiVersion:2,defaultCellHeight:40,height:"auto",expanderStyle:"classic",isEditable:true,show:{rowHeaders:false,columnHeaders:true},headersDimensions:{width:100,height:40},selection:{unselectAllOnEmptyArea:true,toggle:false,canMultiSelect:false},resize:{rows:false,columns:false},performances:{buildLinks:true,useRequestAnimationFrameRendering:false},columns:[{dataIndex:"tree",text:"",width:"auto",isEditable:false,isSortable:false}]};o.forEach(function(q){l.columns.push({dataIndex:q,text:q,typeRepresentation:"number",width:"auto",isEditable:true,isSortable:true})},_me);_me._optThetaTree=new f(l);_me._optThetaTree.getContent().addClassName("ra-krig-custtheta-theme");_me._ctWrapper=d.createElement("div",{id:"ctwrapper",styles:{position:"absolute",width:"100%","min-height":"200px"}});_me._ctWrapper.inject(_me._content.parentElement);_me._optThetaTree.inject(_me._ctWrapper);var j=_me._optThetaTree.elements.container.querySelector(".wux-datagrid");var l=_me._treeList.elements.container.querySelector(".ra-approx-settings-theme .wux-datagrid").scrollHeight;_me._ctWrapper.style.top=l+"px";var m=_me._optThetaTree.getDocument();p.forEach(function(r){var q=new e({label:r});m.addRoot(q)},_me);m.prepareUpdate()},init:function(){g=this}});return h});
define("DS/ENOCharacteristicsWebApp/views/CharacteristicsListFilter",["UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","UWA/Class/Options","DS/Logger/Logger","DS/ENOCharacteristicsWebApp/views/CharacteristicsFilterView","DS/Windows/Dialog","DS/ENOCharacteristicsWebApp/utils/CommandsManagerUtil","i18n!DS/ENOCharacteristicsWebApp/assets/nls/ENOCharacteristicsWebAppNLS","DS/UIKIT/Tooltip"],function(e,b,h,g,c,d,k,j,i,f){var a=b.extend(g,{name:"ListFilter",_logger:null,_charWindow:null,_charDlgWindow:null,_frmWindow:null,init:function(n){this._logger=c.getLogger("ListFilter");this._logger.log("init");this._parent(n);this._charWindow=j.getCharacteristicsWindowFromCommand(n.context);this.setOptions(n);var s=n.renderTo;if(!UWA.is(this._charWindow)){this._logger.log("Warning: Char Window not set");return}var l=this._charWindow.getCharListControl();this._frmWindow=this._charWindow.mFrameWindow;this._charDlgWindow=this._charWindow.getDlgWindow();if(!s){s=this._charDlgWindow.immersiveFrame}var q=UWA.createElement("div");var p=this;this._listsrcview=new d({CharacteristicsControl:l,CharacteristicsWindow:this._charDlgWindow}).render().inject(q);var r=this.getAbsPositionToPlace();var o={my:"top center",at:"top center"};switch(n.position){case"beside_action_bar":o={to:this._charDlgWindow,my:"left top",at:"left top",offsetX:r.x,offsetY:r.y};break;default:this._logger.log("unknown style");break}var m=null;if(!this._frmWindow.elements.filterDialog){m=new k({className:this.name+"_dialog",content:q,immersiveFrame:s,resizableFlag:false,titleBarVisibleFlag:false,closeButtonFlag:false,usePaddingFlag:false,autoCloseFlag:false,position:o,width:40,height:"auto"});m.elements._titleBarDiv.hide();m.getContent().addClassName("charfltr-wux-window");var p=this;m.clearAndHide=function(){p._listsrcview.setFilter("");this.hide()};this._frmWindow.elements.filterDialog=m}h.subscribe("DS/Windows/Dialog#close",this.closeDialog.bind(this))},closeDialog:function(l){this._logger.log("closeDialog");if(this._charDlgWindow===l.dsModel){this._frmWindow.elements.filterDialog.close();this._frmWindow.elements.filterDialog=null}},getAbsPositionToPlace:function(){this._logger.log("getAbsPositionToPlace");var n={};n.x=320;n.y=-20;if(!UWA.is(this._charWindow)){return n}var l=UWA.is(this._charDlgWindow)?this._charDlgWindow.getAbsolutePosition():{x:80,y:10};var m=null;m=this._charWindow.elements.container;n.x=l.x+(0.35*m.scrollWidth)+320;n.y=l.y+m.scrollHeight-20;return n},resetAbsPosition:function(){var l=this.getAbsPositionToPlace();this._frmWindow.elements.filterDialog.setAbsolutePosition(l)},toggleVisibility:function(){this._logger.log("toggleVisibility");var s=this._charWindow.mFrameWindow.elements.filterDialog;if(s!==null){if(true===s.visibleFlag){var r=s.getZIndex();var n=-1;var q=this.options.renderTo;if(q){for(var p=0;p<q.windows.length;p++){var m=q.windows[p];if(m&&(m!==s)){var o=m.getZIndex();if(n<o){n=o}}}}if(n>=r){var l=n+1;s.getContent().setStyle("z-index",l);this.resetAbsPosition()}else{s.hide();this._listsrcview.setFilter("")}}else{s.show();this.resetAbsPosition();s.bringToFront()}}}});return a});
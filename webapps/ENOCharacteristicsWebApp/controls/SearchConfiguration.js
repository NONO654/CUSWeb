define("DS/ENOCharacteristicsWebApp/controls/SearchConfiguration",["UWA/Core","UWA/Utils/InterCom","UWA/Class/Model"],function(d,b,c){var a=function(e){this.socketName="search_socket_"+(new Date()).getTime();this.socket=new b.Socket(this.socketName,{dispatchRetryInterval:5});this.socket.subscribeServer("SearchComServer");this.listener=this.objectsSelected.bind(this);this.socket.addListener("Selected_Objects_search",this.listener)};a.prototype.destroy=function(){var e={};e.widget_id=widget.id;this.socket.dispatchEvent("unregisterSearchContext",e);this.socket.unsubscribeServer("SearchComServer");this.socket.removeListener("Selected_Objects_search",this.listener);this.socket.disconnect()};a.prototype.options=function(m,k,i,n,l){const g="NOT mxid:";var e={};e.title=m;e.multiSel=true;e.mode="furtive";e.app_socket_id=this.socketName;if(typeof widget!=="undefined"){e.widget_id=widget.id}e.default_with_precond=true;e.show_precond=false;e.idcard_activated=false;e.default_search_criteria="";e.charCategory=i;if(k){e.precond="(";k=k.split(",");k.forEach(function(p,o){if(o!==0){e.precond+=" OR "}e.precond+='flattenedtaxonomies:"types/'+p.trim()+'"';e.precond+=" AND ";if(k[0].indexOf("Characteristic Master")>=0){e.precond+="current==Released"}else{e.precond+="current==Release"}e.precond+=" AND latestrevision==TRUE"});var f="";if(l.length>0){var h="";for(var j=0;j<l.length;j++){if(j==0){h+=g}else{h+=" AND "+g}h+=l[j]}f=" AND ("+h+")"}e.precond+=f;e.precond+=")"}if(n){e.default_search_criteria=n}return(e)};a.prototype.activate=function(k,h,g,l,i,j){var m=this.options(k,h,g,i,j);this.callback=l;var f={};f.widget_id=widget.id;this.socket.dispatchEvent("unregisterSearchContext",f);this.socket.dispatchEvent("RegisterContext",m);this.socket.addListener("onCloseTransient",function e(){this.socket.removeListener("onCloseTransient");this.socket.dispatchEvent("UnregisterContext",f)}.bind(this));this.socket.dispatchEvent("InContextSearch",m)};a.prototype.isAvailable=function(){return(d.is(this.socket))};a.prototype.objectsSelected=function(h){var e=[];if(this.callback){for(var g=0;g<h.length;g++){var j={};var f=new c(h[g]);j.id=f.get("id");j.owner=f.get("ds6w:originator");j.name=f.get("ds6w:identifier");j.policy=f.get("ds6w:policy");j.originated=f.get("ds6w:created");j["attribute[Title]"]=f.get("ds6w:label");j.type=f.get("ds6w:type");e.push(j)}this.callback(e)}};return(a)});
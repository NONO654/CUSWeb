define("DS/DELPPWMILModule/MILUI",["UWA/Core"],function(b){var a=function(o,A,i,l,c,E,g,z){var p={className:"",},r,e=[],m=[],n,t=null,q,s,w,h,D,k,x,f,C;q=function q(){var F;F=z.getRoots();m=F[0];e=F[1];if(!m||(Array.isArray(m)&&m.length<=0)){return false}if(!e||(Array.isArray(e)&&e.length<=0)){return false}return true},s=function s(){n={Reroute_ScopeLink:{label:g.getNLSValue("MIL.Reroute.ScopeLink"),value:1,tooltip:g.getNLSValue("MIL.ToolTip.RerouteScope"),getLabel:function F(){return this.tooltip}},Reroute_ImplementAndScopeLink:{label:g.getNLSValue("MIL.Reroute.ImplementAndScopeLink"),value:2,tooltip:g.getNLSValue("MIL.ToolTip.Reroute"),getLabel:function F(){return this.tooltip}},Reroute_ImplementLink:{label:g.getNLSValue("MIL.Reroute.ImplementLink"),value:3,tooltip:g.getNLSValue("MIL.ToolTip.RerouteImplement"),getLabel:function F(){return this.tooltip}},Reroute_DeleteAndCreate:{label:g.getNLSValue("MIL.Reroute.DelAndCreate"),value:4,getLabel:function F(){return this.label}},Reroute_ImplementAndReplaceRef:{label:g.getNLSValue("MIL.Reroute.ImplementAndReplaceRef"),value:5,tooltip:g.getNLSValue("MIL.ToolTip.ReplaceAndReconnect"),getLabel:function F(){return this.tooltip}},Delete:{label:g.getNLSValue("MIL.Delete"),value:6,tooltip:g.getNLSValue("MIL.ToolTip.Delete"),getLabel:function F(){return this.tooltip}},Ignore:{label:g.getNLSValue("MIL.Ignore"),value:7,getLabel:function F(){return this.label}},Ambiguous:{label:g.getNLSValue("MIL.Ambiguous"),value:8,getLabel:function F(){return this.label}},Revise_And_Reconnect:{label:g.getNLSValue("MIL.Revise.Reconnect"),value:9,tooltip:g.getNLSValue("MIL.ToolTip.ReviseAndReconnect"),getLabel:function F(){return this.tooltip}},}};h=function h(G){var F;for(F=0;F<G.length;F++){if(G[F].valueItem===n.Ambiguous.value){return true}}return false};D=function D(){var K=l.getSelectedNodes(),J,F,G,H,I;if(!b.is(m,"array")||!b.is(e,"array")){return}F=m[0];J=e[0];K.forEach(function(N){var O,L,P={},M=function M(){l.removeNode(N)};G=N.options.grid.cellInfo;O=N.options.grid.MIL_suggestion.label;L=O+g.getNLSValue("MIL.Action.Message",{object:N.options.grid.MIL_manufactured});if(h(G.suggestionToPerformEntries)){if(G.hasOwnProperty("candidateOccPath")){G.inconsistentObject.candidatePaths.length=0;G.inconsistentObject.candidatePaths[0]=G.candidateOccPath.toString()}}switch(G.action){case n.Reroute_ImplementAndReplaceRef.value:case n.Reroute_ImplementLink.value:case n.Reroute_ImplementAndScopeLink.value:case n.Reroute_DeleteAndCreate.value:case n.Revise_And_Reconnect.value:P[G.mbomId]=G.inconsistentObject;H={rootMfgId:J,rootPrdId:F,mbomId:G.mbomId,logMessage:L,biStatusObject:P,scopeCreation:"AllLevel"};c.webservice("rerouteLink",F,J,H,function(){M()});break;case n.Delete.value:I=E.getInstance(G.mbomId);if(b.is(I)){E.deleteInstance([I],{onComplete:function(){M()},askDeleteConfirmation:false})}break;case n.Reroute_ScopeLink.value:P[G.mbomId]=G.inconsistentObject;H={rootMfgId:J,rootPrdId:F,mbomId:G.mbomId,logMessage:L,biStatusObject:P};c.webservice("rerouteScopeLink",F,J,H,function(){M()});break;default:break}})};w=function w(){var F=A.create("Element","div",{"class":"mil-panel-container"}),H=A.create("Element","div",{"class":"mil-tree-container"}).inject(F),G=A.getComponent("Button");i.loadDocument(l.getWUXNodeModel());i.getContent().inject(H);t=A.create("Dialog",{identifier:"MIL-UI",domId:"MILUI-dialog",title:g.getNLSValue("ManageInconsistentLinksUI.PanelTitle"),resizableFlag:true,visibleFlag:false,modalFlag:true,content:F,height:315,width:600,snappableFlag:false,buttons:{Ok:new G({disabled:true,label:g.getNLSValue("MIL.PanelApplyButton"),emphasize:"primary",onClick:function(){D()}}),Cancel:new G({onClick:function(){t.close()}})}});t.close=function(){if(b.is(r)){o.notify("toggleCmdCheckHeaderState",{cmdName:r,cmdState:false})}else{k()}}};k=function d(){t.hide()};x=function x(W){var aa,P,I,O,R,J,L,X,S,ae,T,ab,H,ad,ag,V,ai,ac,ah,K=[],Z,Y=[],af,G,U=[],Q=[],F,N=z.getRoots(),M=N[1];if(W){W.forEach(function(aj){P=aj._attributes;aa=P.id;O=P.hasOwnProperty("candidatePaths");R=P.hasOwnProperty("pointedPaths");J=P.hasOwnProperty("candidateScopedMfgItem");I=E.isReference(aa);Y=[];K=[];if(true===I){if(-1===M.indexOf(aa)){return}L=E.getReference(aa);G=g.getIconURLFromKey(L.get("type"));S=C(L,null);if(true===R&&P.pointedPaths.length>0){U=P.pointedPaths.split(",");V=U[U.length-1];T=E.getReference(V);if(b.is(T)){ab=C(T,null);af=g.getIconURLFromKey(T.get("type"))}else{ab=V}}if(true===O&&P.candidatePaths.length>0){P.candidatePaths.forEach(function(ak){Q=ak.split(",");ai=Q[Q.length-1];ad=E.getReference(ai);if(b.is(ad)){ag=C(ad,null)}else{ag=ai}Y.push({labelItem:ag,valueItem:ak.toString()})})}}else{X=E.getInstance(aa);L=E.getReference(X.get("isInstanceOf"));G=g.getIconURLFromKey(L.get("type"));S=C(L,X);if(true===R&&P.pointedPaths.length>0){U=P.pointedPaths.split(",");V=U[U.length-1];ae=E.getInstance(V);if(b.is(ae)){T=E.getReference(ae.get("isInstanceOf"));if(b.is(T)){ab=C(T,ae);af=g.getIconURLFromKey(T.get("type"))}else{ab=V}}else{if(b.is(P.isInstanceOf)){T=E.getReference(P.isInstanceOf);if(b.is(T)){ab=C(T);af=g.getIconURLFromKey(T.get("type"))}}else{ab=V}}}if(true===O&&P.candidatePaths.length>0){P.candidatePaths.forEach(function(ak){Q=ak.split(",");ai=Q[Q.length-1];H=E.getInstance(ai);if(b.is(H)){ad=E.getReference(H.get("isInstanceOf"));ag=C(ad,H)}else{ag=ai}Y.push({labelItem:ag,valueItem:ak.toString()})});Q=P.candidatePaths[0].split(",");ai=Q[Q.length-1];ac=Q;H=E.getInstance(ai);if(b.is(H)){ad=E.getReference(H.get("isInstanceOf"));ag=C(ad,H)}else{ag=ai}}}Z=P.status;if(O){switch(Z){case"ImplCandidatePrdOccWithScopeToOldRev":case"ImplCandPrdOccToOtherRev":if(J===true){ah=n.Reroute_ImplementAndReplaceRef}else{ah=n.Revise_And_Reconnect}break;case"ImplCandidatePrdOccButNotCorrespondingScope":if(J===true){ah=n.Reroute_ImplementAndReplaceRef}else{ah=n.Reroute_ImplementAndScopeLink}break;case"ImplCandPrdOccToDiffPrd":if(J===true){ah=n.Reroute_ImplementAndReplaceRef}else{ah=n.Reroute_ImplementLink}break;case"ImplCandidatePrdOccWithGoodScope":case"ImplCandPrdOccToSamePrd":ah=n.Reroute_ImplementLink;break;case"ImplNoProductOccurence":ah=n.Delete;break;case"ScopeToOldRev":ah=n.Reroute_ScopeLink;break;case"ScopeToNew":ah=n.Reroute_ScopeLink;break;default:break}}else{ah=n.Delete}if(b.is(ah)){K.push({labelItem:ah.label,valueItem:ah.value});if(O&&P.candidatePaths.length>1){ah=n.Ambiguous;K.push({labelItem:ah.label,valueItem:ah.value});Y.unshift({labelItem:g.getNLSValue("MIL.SelectCandidate"),valueItem:g.getNLSValue("MIL.SelectCandidate")});ag=g.getNLSValue("MIL.SelectCandidate")}K.push({labelItem:n.Ignore.label,valueItem:n.Ignore.value});F={MIL_suggestion:ah,MIL_rerouting:O?ag:g.getNLSValue("MIL.RerouteNone"),MIL_previous:R?ab:g.getNLSValue("MIL.PrevisionUnknown"),MIL_manufactured:S,cellInfo:{mbomId:aa,candidateId:ai,candidateOccPath:ac,action:ah.value,candidateEntries:Y,suggestionToPerformEntries:K,PreviousProdIconUrl:af,MfgItemIconUrl:G,inconsistentObject:P}};l.addNodeModel({grid:F})}})}o.notify("stopProgress")};f=function f(M){var J,H,I,F,L,K=[],G=[];M.forEach(function(N){J=N._attributes;H=J.hasOwnProperty("pointedPaths");if(true===H){K=J.pointedPaths.split(",");L=K[K.length-1];I=E.getInstance(L);if(b.is(I)){F=E.getReference(I.get("isInstanceOf"));if(!b.is(F)){G.push(I.get("isInstanceOf"))}}}});if(G.length>0){E.fetchRoot(G,{silent:true,onComplete:function(){x(M)}})}else{x(M)}};C=function C(F,H){var G=F.get("V_Name")+" "+F.get("revision");if(b.is(H)){G=G+"("+H.get("PLM_ExternalID")+")"}return G};return{init:function v(F){p=b.extend(p,F);r=F.manageInconsistentLinksCmdId;s();w();if(!q()){return}o.notify("startProgress");c.getBrokenMfgItemStatus({rootEBOM:m,rootMBOM:e},function G(H){f(H)})},destroy:function B(){if(this.isActive()){k()}if(b.is(t)){t.destroy();t=null}},isActive:function u(){return b.is(t)?t.visibleFlag:false},loadUI:function y(){if(b.is(t)&&t.visibleFlag===false){t.show()}},setApplyButtonState:function j(F){t.buttons.Ok.disabled=!F},}};return a});define("DS/DELPPWMILModule/MILModule",["DS/DELPPWMILModule/MILUI"],function(a){var b=function(n,j,m,f,k,e,i,o){var c=null,h;h=function h(p){c.setApplyButtonState(p.changed.isSelected)};return{name:"MILModule",listenTo:function d(){return{select:h}},onStart:function l(p){c=new a(n,j,m,f,k,e,i,o);c.init({manageInconsistentLinksCmdId:p.manageInconsistentLinksCmdId,});c.loadUI()},onStop:function g(){c.destroy();c=void 0}}};return{behaviors:["UXFactoryBehavior","TreeListViewBehavior","WUXNodeModelBehavior","MfgItemBehavior","ModelBehavior","ResourceBehavior","RootsBehavior"],creator:b}});
CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",icons:"bgcolor,textcolor",hidpi:true,init:function(d){var b=d.config,g=d.lang.colorbutton;var f;if(!CKEDITOR.env.hc){c("TextColor","fore",g.textColorTitle,10);c("BGColor","back",g.bgColorTitle,20)}function c(j,l,m,h){var k=new CKEDITOR.style(b["colorButton_"+l+"Style"]),i=CKEDITOR.tools.getNextId()+"_colorBox";d.ui.add(j,CKEDITOR.UI_PANELBUTTON,{label:m,title:m,modes:{wysiwyg:1},editorFocus:0,toolbar:"colors,"+h,allowedContent:k,requiredContent:k,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":g.panelTitle}},onBlock:function(n,q){q.autoSize=true;q.element.addClass("cke_colorblock");q.element.setHtml(a(n,l,i));q.element.getDocument().getBody().setStyle("overflow","hidden");CKEDITOR.ui.fire("ready",this);var o=q.keys;var p=d.lang.dir=="rtl";o[p?37:39]="next";o[40]="next";o[9]="next";o[p?39:37]="prev";o[38]="prev";o[CKEDITOR.SHIFT+9]="prev";o[32]="click"},refresh:function(){if(!d.activeFilter.check(k)){this.setState(CKEDITOR.TRISTATE_DISABLED)}},onOpen:function(){var o=d.getSelection(),q=o&&o.getStartElement(),p=d.elementPath(q),n;if(!p){return}q=p.block||p.blockLimit||d.document.getBody();do{n=q&&q.getComputedStyle(l=="back"?"background-color":"color")||"transparent"}while(l=="back"&&n=="transparent"&&q&&(q=q.getParent()));if(!n||n=="transparent"){n="#ffffff"}this._.panel._.iframe.getFrameDocument().getById(i).setStyle("background-color",n);return n}})}function a(k,q,m){var n=[],l=b.colorButton_colors.split(",");var j=CKEDITOR.tools.addFunction(function(t,v){if(t=="?"){var w=arguments.callee;function u(x){this.removeListener("ok",u);this.removeListener("cancel",u);x.name=="ok"&&w(this.getContentElement("picker","selectedColor").getValue(),v)}d.openDialog("colordialog",function(){this.on("ok",u);this.on("cancel",u)});return}d.focus();k.hide();d.fire("saveSnapshot");d.removeStyle(new CKEDITOR.style(b["colorButton_"+v+"Style"],{color:"inherit"}));if(t){var i=b["colorButton_"+v+"Style"];i.childRule=v=="back"?function(x){return e(x)}:function(x){return !(x.is("a")||x.getElementsByTag("a").count())||e(x)};d.applyStyle(new CKEDITOR.style(i,{color:t}))}d.fire("saveSnapshot")});n.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',g.auto,'" onclick="CKEDITOR.tools.callFunction(',j,",null,'",q,"');return false;\" href=\"javascript:void('",g.auto,'\')" role="option"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td><span class="cke_colorbox" id="',m,'"></span></td><td colspan=7 align=center>',g.auto,'</td></tr></table></a><table role="presentation" cellspacing=0 cellpadding=0 width="100%">');for(var p=0;p<l.length;p++){if((p%8)===0){n.push("</tr><tr>")}var o=l[p].split("/"),r=o[0],s=o[1]||r;if(!o[1]){r="#"+r.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3")}var h=d.lang.colorbutton.colors[s]||s;n.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',h,'" onclick="CKEDITOR.tools.callFunction(',j,",'",r,"','",q,"'); return false;\" href=\"javascript:void('",h,'\')" role="option"><span class="cke_colorbox" style="background-color:#',s,'"></span></a></td>')}if(d.plugins.colordialog&&b.colorButton_enableMore===undefined||b.colorButton_enableMore){n.push('</tr><tr><td colspan=8 align=center><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',g.more,'" onclick="CKEDITOR.tools.callFunction(',j,",'?','",q,"');return false;\" href=\"javascript:void('",g.more,"')\"",' role="option">',g.more,"</a></td>")}n.push("</tr></table>");return n.join("")}function e(h){return(h.getAttribute("contentEditable")=="false")||h.getAttribute("data-nostyle")}}});CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF";CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]};CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};
CKEDITOR.plugins.add("quicktable",{requires:"table,panelbutton,floatpanel",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",afterInit:function(c){var h=c.config,f=h.qtRows||8,p=h.qtColumns||10,n=h.qtBorder||"1",d=h.qtStyle||null,q=h.qtClass||"",b=h.qtCellPadding||"1",g=h.qtCellSpacing||"1",a=h.qtWidth||"500px",m=h.qtPreviewSize||"14px",o=h.qtPreviewBorder||"1px solid #aaa",i=h.qtPreviewBackground||"#e5e5e5";function e(s){return new CKEDITOR.dom.element(s,c.document)}function j(t,y){var x=e("table");var v=x.append(e("tbody"));for(var w=0;w<t;w++){var z=v.append(e("tr"));for(var u=0;u<y;u++){var s=z.append(e("td"));s.appendBogus()}}x.setAttribute("cellpadding",b);x.setAttribute("cellspacing",g);x.setAttribute("border",n);x.setAttribute("class",q);x.setStyles(d);x.setStyle("width",a);c.insertElement(x);c.fire("removeFormatCleanup",x)}function l(s){var t=[];var w=CKEDITOR.tools.addFunction(function(y,x){j(parseInt(y,10)+1,parseInt(x,10)+1);s.hide()});t.push('<a style="display:block" _cke_focus=1 hidefocus=true href="javascript:void(1)"><table role="presentation" cellspacing=1 cellpadding=1 style="width: 100%; margin: 0 auto 3px;table-layout:fixed;">');for(var v=0;v<f;v++){t.push("<tr>");for(var u=0;u<p;u++){t.push('<td style="border: '+o+";width:"+m+";height:"+m+';" data-i="'+v+'" data-j="'+u+'" onclick="CKEDITOR.tools.callFunction(',w,",'",v,"','",u,"'); return false;\"></td>")}t.push("</tr>")}t.push("</table></a>");return t.join("")}var r={row:-1,column:-1};function k(w,y,v,u){var A=y.$.tBodies[0].rows;for(var t=0;t<A.length;t++){var z=A[t].cells;for(var s=0;s<z.length;s++){var x=z[s];if(t<v&&s<u){x.style.background=i}else{x.style.background=""}}}r.row=v-1;r.column=u-1;w.setText(v+" Ã— "+u+" "+c.lang.table.toolbar)}c.ui.add("Table",CKEDITOR.UI_PANELBUTTON,{label:c.lang.table.toolbar,command:"table",modes:{wysiwyg:1},editorFocus:0,toolbar:"insert,30",caption:null,table:null,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":c.lang.table.toolbar}},onBlock:function(s,w){w.autoSize=true;w.element.addClass("cke_colorblock");var t=new CKEDITOR.dom.element("div");t.setStyles({"text-align":"center",margin:"3px 0"});w.element.append(t);this.caption=t;var v=CKEDITOR.dom.element.createFromHtml(l(s));this.table=this.addEvents(v);w.element.append(v);var u=this.createMoreButton();w.element.append(u);CKEDITOR.ui.fire("ready",this);w.keys=this.assignKeys(w.keys)},assignKeys:function(s){var t=c.lang.dir=="rtl";s[t?37:39]="next";s[40]="next";s[9]="next";s[t?39:37]="prev";s[38]="prev";s[CKEDITOR.SHIFT+9]="prev";s[32]="click";return s},addEvents:function(u){var t=this.table=u.getFirst();var s=this.caption;t.on("mouseleave",function(v){k(s,t,1,1)});t.on("mousemove",function(v){var y=v.data.getTarget();if(y.getName()=="td"){var x=parseInt(y.getAttribute("data-i"),10);var w=parseInt(y.getAttribute("data-j"),10);k(s,t,x+1,w+1)}});u.on("keydown",function(v){var x=v.data.getKeystroke(),y=r.row,w=r.column;switch(x){case 37:w--;break;case 39:w++;break;case 40:y++;break;case 38:y--;break;case 13:case 32:j(y+1,w+1);return;default:return}if(y<0||w<0){this.panel.hide();return}if(y>f-1||w>p-1){c.execCommand("table")}k(s,t,y+1,w+1);v.data.preventDefault();v.data.stopPropagation()});return t},createMoreButton:function(){var s=new CKEDITOR.dom.element("a");s.setAttributes({_cke_focus:1,hidefocus:true,title:c.lang.quicktable.more,href:'javascript:void("'+c.lang.quicktable.more+'")',role:"option"});s.addClass("cke_colormore");s.setText(c.lang.quicktable.more);s.setStyle("text-align","center");s.on("click",function(t){c.execCommand("table");t.data.preventDefault()});return s},onOpen:function(){k(this.caption,this.table,1,1)}})}});
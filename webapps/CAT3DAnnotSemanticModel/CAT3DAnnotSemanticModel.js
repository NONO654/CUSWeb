/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
define("DS/CAT3DAnnotSemanticModel/CAT3DAnnotSemanticModel",[],function(){});define("DS/CAT3DAnnotSemanticModel/CAT3DAnnotationAttributeNode",["DS/CAT3DAnnotationModel/CAT3DAnnotationNode","DS/WebappsUtils/WebappsUtils","i18n!DS/CAT3DAnnotSemanticModel/assets/nls/CAT3DAnnotSemanticModel"],function(c,e,a){var b=[{id:2,name:"GeometricalSet",icon:"I_W3DAnnot_GeometricalAttribute"},{id:3,name:"Point",icon:"I_WebAttrPoint"},{id:4,name:"GeometricalSetLinear",icon:"I_WebAttrGeometricalSetLinear"},{id:5,name:"Line",icon:"I_WebAttrLine"},{id:8,name:"HybridBody",icon:"I_WebAttrHybridBody"},{id:9,name:"Plane",icon:"I_WebAttrPlane"},{id:16,name:"Body",icon:"I_WebAttrBody"},{id:17,name:"Curve",icon:"I_WebAttrCurve"},{id:33,name:"Surface",icon:"I_WebAttrSurface"},{id:65,name:"Solid",icon:"I_WebAttrSolid"},{id:129,name:"AxisSystem",icon:"I_WebAttrAxisSystem"}];var d=c.extend({init:function(i){var g=i||{};var h;this._parent(g);this.isRootAttribute=function(){return g.isRootAttribute};this.getAnnotationClassType=function(){return"tpsAttribute"};this.getAttributeCategory=function(){return g.category};this.getAttributeParam=function(){return g.params};var f=this.getAnnotationName;this.getAnnotationName=function(){if(g.isRootAttribute){return a.rootAttrName}return f()};this.getAnnotationIcon=function(){if(h){return h}var k;if(g.category==="0"){k="I_W3DAnnot_MechanicalAttribute"}else{if(g.category==="1"){k="I_W3DAnnot_ElectricalAttribute"}else{if(g.category==="2"){k="I_W3DAnnot_KnowledgeAttribute"}else{if(g.category==="3"){k="I_W3DAnnot_StructureAttribute"}else{if(g.category==="4"){k="I_W3DAnnot_CompositeAttribute"}else{if(g.category==="5"){if(!g.attrType){k="I_W3DAnnot_GeometricalAttribute"}else{for(var j=0;j<b.length;j++){if(b[j].id===g.attrType){k=b[j].icon;break}}}}else{k="I_W3DAnnot_Attribute"}}}}}}if(k){h=e.getWebappsAssetUrl("CAT3DAnnotationRsc","icons/22/")+k+".png"}return h};if(g.attrType){this.getAttributeType=function(){return g.attrType}}},toJSON:function(){if(!this.jsonObject){this._parent();if(this.getAttributeCategory()!==undefined){this.jsonObject.category=this.getAttributeCategory()}if(this.getAttributeParam()!==undefined){this.jsonObject.param=this.getAttributeParam()}if(this.getAnnotationTTRS()!==undefined){this.jsonObject.ttrs=this.getAnnotationTTRS()}if(this.isRootAttribute()!==undefined){this.jsonObject.isRootAttr=this.isRootAttribute()}if(this.getAttributeType){this.jsonObject.attrType=this.getAttributeType()}}else{this._parent()}return this.jsonObject}});return d});define("DS/CAT3DAnnotSemanticModel/CAT3DAnnotSemanticLoader",["DS/CAT3DAnnotationModel/CAT3DAnnotationLoader","DS/CAT3DAnnotSemanticModel/CAT3DAnnotationAttributeNode"],function(a,c){var b=a.extend({init:function(e){var d=e||{};this._parent(d);this.getType=function(){return"WithSemantic"}},loadAnnotation:function(k){var h;var j=function(r,q,n){var t=Object.keys(r);if(t.length){var m={category:n,onAnnotationAttrModifiedCB:r.nodeXMLtype==="TPSAttribute"?k.cb:function(){}};var p;for(var o=0;o<t.length;o++){if(t[o]==="childrenAttr"){p=r[t[o]]}else{m[t[o]]=r[t[o]]}}var s=new c(m);q.addChild(s);if(p&&p.length){for(var l=0;l<p.length;l++){j(p[l],s,n)}}}};if(k.nodeInfo.nodeXMLtype==="TPSAttribute"||k.nodeInfo.nodeXMLtype==="TPSAttributes"){if(!k.nodeInfo.tpsID){var g=k.annotationSetNode.getRootAnnotationNode("RootAttributes").children,d=0;for(h=0;h<g.length;h++){if(k.annotationSetNode.getRootAnnotationNode("RootAttributes").children[h].isRootAttribute()){d++}}k.nodeInfo.isRootAttribute=true;k.nodeInfo.type=47;k.nodeInfo.tpsID="root_"+d}j(k.nodeInfo,k.annotationSetNode.getRootAnnotationNode("RootAttributes"),k.nodeInfo.category)}else{this._parent(k);if(k.nodeInfo.nodeXMLtype==="TTRS"){k.annotationSetNode.addTTRS(k.nodeInfo)}else{if(k.nodeInfo.nodeXMLtype==="RefFrame"){k.annotationSetNode.addReferenceFrame(k.nodeInfo)}else{var f=k.nodeInfo.rootIndex;if(f){var i=k.annotationSetNode.children[f].children[k.annotationSetNode.children[f].children.length-1];if(k.nodeInfo.val!==undefined){var e=i.getAnnotationSupertype();if(e!==1&&e!==2&&e!==8&&e!==9){i.getAnnotationToleranceValue=function(){return k.nodeInfo.val}}}if(k.nodeInfo.trep!==undefined){i.getAnnotationTTRSRep=function(){return k.nodeInfo.trep}}if(k.nodeInfo.ref!==undefined){i.getAnnotationReferenceFrame=function(){return k.nodeInfo.ref}}if(k.nodeInfo.def!==undefined){i.isDefaultAnnotation=function(){return k.nodeInfo.def!==0}}if(k.nodeInfo.grou!==undefined){i.getGeometricalAttachmentList=function(){return k.nodeInfo.grou}}if(k.nodeInfo.datumTargets!==undefined){i.getDatumTargetList=function(){return k.nodeInfo.datumTargets}}if(k.nodeInfo.associatedBasicDims!==undefined){i.getAssociatedBasicDims=function(){return k.nodeInfo.associatedBasicDims}}}}}}}});return b});
/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
function PowerByHome(b){var a={v1:{ap_custo:"ap_custo",ap_struct:"ap_struct"}};var c={widget:null,powerByApp:null,homeWebInWinOpts:{widget:null,action_bar_opts:null,layout:{}},init:function(d){this.widget=d.widget;this.widget.addEvent("onLoad",this.onLoad.bind(this));this.widget.addEvent("onRefresh",this.onRefresh.bind(this))},onLoad:function(){var d=this;var e=d.widget.getUrl().search("[?&]devmode=1")>0;require(["DS/PADUtils/PADWebInWinServices","DS/PADUtils/PADSettingsMgt","DS/PADCommands/PADModelEvents","text!DS/PowerByHome/assets/PowerByHome_settings.json"],function(i,f,h,j){i.initialize(d.widget);var g=JSON.parse(j);f.setApp(g.padsettings,"pswebinwin",true);if(!e&&!i.isWebInWinContext()&&f.getSetting("activateWebView")){require(["DS/PowerByHome/views/PowerByWebView"],function(k){new k({callback:function(){d.widget.setBody(this.render());this.show();h.publish({event:"pageReady"})}})})}else{require(["UWA/Core","UWA/Utils/Client","DS/PADUtils/XNavSettings","DS/PowerByHome/PowerByWebInWinProxy","DS/PADUtils/views/PADAlert","DS/PowerByHome/HomeComponent","DS/PlatformAPI/PlatformAPI","DS/Menu/Menu"],function(o,l,m,s,k,r,p,n){if(d.powerByApp===null){var q=d.homeWebInWinOpts;q.widget=d.widget;q.lang=d.widget.lang;f.setSetting("lang",d.widget.lang);q.action_bar_opts=l.Features.touchEvents&&!l.Features.pointerEvents?g.action_bar.touch:g.action_bar.standard;q.action_bar_opts.language=d.widget.lang;q.active_view="treelistview";q.layout.propertiesFacet=f.getSetting("propertiesFacet");h.subscribe({event:"HomeComponent/Ready"},function(u){d.powerByApp=u;d.widget.setBody(d.powerByApp.render());var t={add:{direction:["toWeb"],formatIn_toWeb:{operation:"add",operationVersion:"1.0",content:[]},formatOut_toWeb:{content:[]},callback_toWeb_name:"addFromWin",callback_toWeb_fn:function(v){h.publish({event:"PowerByTreeDocument/initContentFromSession",data:v.content})}},removeRoot:{direction:["toWeb"],formatIn_toWeb:{operation:"removeRoot",operationVersion:"1.0",content:[]},formatOut_toWeb:{content:[]},callback_toWeb_name:"removeRootFromWin",callback_toWeb_fn:function(v){h.publish({event:"PowerByTreeDocument/removeRootFromSession",data:v.content})}},updateNodes:{direction:["toWeb"],formatIn_toWeb:{operation:"updateNodes",operationVersion:"1.0",content:[]},formatOut_toWeb:{content:[]},callback_toWeb_name:"updateNodesFromWin",callback_toWeb_fn:function(v){h.publish({event:"PowerByTreeDocument/updateNodes",data:v.content})}},saveSession:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"saveSession",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"saveSession"},showProperties:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"showProperties",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"showProperties"},save:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"save",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"save"},rename:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"rename",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"rename"},options:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"options",operationVersion:"1.0",content:{}},callback_toWin_name:"options"},saveCGR:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"saveCGR",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"saveCGR"},getRevision:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"getRevision",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"getRevision"},replaceByRevision:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"replaceByRevision",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"replaceByRevision"},reloadFromServer:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"reloadFromServer",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"reloadFromServer"},refreshHome:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"refresh",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"refreshHome"},reserve:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"reserve",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"reserve"},unreserve:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"unreserve",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"unreserve"},maturity:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"maturity",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"maturity"},reload:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"reload",operationVersion:"1.0",content:{pids:[]}},callback_toWin_name:"reload"},pageReady:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"pageReady",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"pageReady"},init:{direction:["toWeb"],formatIn_toWeb:{operation:"init",operationVersion:"1.0",content:{JSONSchema:{}}},formatOut_toWeb:{content:[]},callback_toWeb_name:"initFromWin",callback_toWeb_fn:function(v){h.publish({event:"HomeComponent/initCusto",data:v.content})}},displayNotification:{direction:["toWeb"],formatIn_toWeb:{operation:"displayNotification",operationVersion:"1.0",content:{}},formatOut_toWeb:{content:[]},callback_toWeb_name:"displayNotificationFromWin",callback_toWeb_fn:function(v){if(UWA.is(v.content,"object")&&UWA.is(v.content.eventID,"string")&&UWA.is(v.content.msg,"string")){k.displayNotification(v.content)}}},readyForInit:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"readyForInit",operationVersion:"1.0",content:{context:"PowerByHome",lang:f.getSetting("lang")}},callback_toWin_name:"readyForInit"},setCA:{direction:["toWeb"],formatIn_toWeb:{operation:"setCA",operationVersion:"1.0",content:{JSONSchema:{}}},formatOut_toWeb:{content:[]},callback_toWeb_name:"setCAFromWin",callback_toWeb_fn:function(v){h.publish({event:"HomeComponent/setCA",data:v.content})}},removeCA:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"removeCA",operationVersion:"1.0",content:{}},callback_toWin_name:"removeCA"},toggleActiveCA:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"toggleActiveCA",operationVersion:"1.0",content:{}},callback_toWin_name:"toggleActiveCA"},toggleDeActiveCA:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"toggleDeActiveCA",operationVersion:"1.0",content:{}},callback_toWin_name:"toggleDeActiveCA"},changeCA:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"changeCA",operationVersion:"1.0",content:{}},callback_toWin_name:"changeCA"},replaceContent:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"replaceContent",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"replaceContent"},};s.setupEventHandler(t);h.publish({event:"readyForInit"})});h.subscribe({event:"HomeComponent/readyToBuildViews"},function(){h.publish({event:"HomeComponent/buildViews"})});h.subscribe({event:"HomeComponent/pageReady"},function(){h.publish({event:"pageReady"})});p.subscribe("webinwin:win:notification",function(t){require(["DS/PowerByHome/PowerByWebInWinProxy"],function(v){var w=UWA.is(t,"string")?JSON.parse(t):t,u=w.operation+"FromWin";if(v[u]){if(w.operation==="select"||w.operation==="add"||w.operation==="removeRoot"){n.hide()}v[u](w)}})});new r(q)}})}})},onRefresh:function(){var d=require("DS/PADCommands/PADModelEvents");d.publish({event:"HomeComponent/refreshHome"})}};c.init(b);return c}define("DS/PowerByHome/commands/SwitchReservationCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,b,d,a){var c=b.extend({init:function(f){var g=this;this._parent(f);this._check_select();d.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){var f=d.get().options.model.getXSO().get().length?true:false;if(f===true){this.enable()}else{this.disable()}},execute:function(){var f=d.get().getPADTreeDocument()._buildSelectData();switch(this._arguments[0].ID){case"Reserve":a.publish({event:"reserve",data:{cadidPaths:f.cadidPaths}});break;case"Unreserve":a.publish({event:"unreserve",data:{cadidPaths:f.cadidPaths}});break}}});return c});define("DS/PowerByHome/commands/Rename",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,c,d,b){var a=c.extend({init:function(f){var g=this;this._parent(f);this._check_select();d.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){var f=d.get().options.model.getXSO().get().length?true:false;if(f===true){this.enable()}else{this.disable()}},execute:function(){var f=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"rename",data:{cadidPaths:f.cadidPaths}})}});return a});define("DS/PowerByHome/commands/SaveSession",["UWA/Core","DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents"],function(d,c,b){var a=c.extend({init:function(e){var f=this;this._parent(e);this.disable();b.subscribe({event:"PADCommand/RootVisibilityChange"},function(h){var k=[];for(var g=0;g<h.availableRoots.length;g++){var j=h.availableRoots[g].search({match:function(i){if(i.nodeModel.options.grid.sessionStatus!=="sessionNotModified"){return true}else{return false}}},[]);k.push.apply(k,j)}if(k.length===0){f.disable()}else{f.enable()}})},execute:function(){b.publish({event:"saveSession",data:{columns:this.options.columns}})}});return a});define("DS/PowerByHome/commands/OpenCmd",["UWA/Core","UWA/Class","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,a,d,b){var c=a.extend({init:function(){},execute:function(){var f=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"openFromWeb",data:{cadidPaths:f.cadidPaths}})}});return c});define("DS/PowerByHome/mixins/PowerByKeyboardInputs",["UWA/Core","UWA/Class","UWA/Event","DS/ApplicationFrame/CommandsManager"],function(e,a,d,b){var c=a.extend({_component:null,init:function(f){this._parent(f);this._component=f.component;this._onKeyDown_binded=this._onKeyDown.bind(this)},startObservingKeyboard:function(f){e.Element.addEvent.call(document,"keydown",this._onKeyDown_binded)},_onKeyDown:function(j){var i=this;var h=d.whichKey(j);var g=function(){var k=document.activeElement;if(k&&k.tagName==="INPUT"){return true}else{return false}};var f=function(k,m){var l=b.getCommand(m);if(l&&l.isEnabled()){l.begin();d.stop(j)}};switch(h){case"ctrl+a":f(h,"SelectAll");break}}});return c});define("DS/PowerByHome/models/PowerByNodeModel",["DS/Tree/TreeNodeModel","DS/WebappsUtils/WebappsUtils"],function(c,b){function a(d){this.options={label:"",icons:[],grid:{},resourceid:"",type:"",relationid:"",relationtype:"",children:[],thumbnail:null};this.options=UWA.extend(this.options,d);c.call(this,this.options)}a.prototype=Object.create(c.prototype);a.prototype.getID=function(){return this.options.resourceid};a.prototype.getCADID=function(){return this.options.cadid};a.prototype.getOccurencePath=function(f){if(UWA.is(f,"function")){f(this)}if(!this.isRoot()&&this.getParent()){var d=this.getParent();var e=d.getOccurencePath(f);e.push(this.options.relationid);e.push(this.options.resourceid);return e}else{return[this.options.resourceid]}};a.prototype.getOccurenceCADIDPath=function(f){if(UWA.is(f,"function")){f(this)}if(!this.isRoot()&&this.getParent()){var d=this.getParent();var e=d.getOccurenceCADIDPath(f);e.push(this.options.relid);e.push(this.options.cadid);return e}else{return[this.options.cadid]}};a.prototype.getNodeByPath=function(e,m,j,l){if(typeof m!=="number"||m<0){m=0}if(typeof j!=="number"||j<0||j>=e.length){j=e.length-1}if(this.options.cadid){if(((this.options.cadid instanceof Array)&&(this.options.cadid.indexOf(e[m])>=0))||(this.options.cadid===e[m])){if(m===j||(!this.isExpanded()&&(l===undefined||l===false))){return this}else{var g=e[m+1];var f=this.getChildren();if(!f||f.length===0){return this}else{var h=null;for(var k=0;k<f.length&&h===null;k++){var d=f[k];if(g===d.options.relid){h=d}}if(h===null){return this}else{return h.getNodeByPath(e,m+2,j,l)}}}}}else{if(((this.options.resourceid instanceof Array)&&(this.options.resourceid.indexOf(e[m])>=0))||(this.options.resourceid===e[m])){if(m===j||(!this.isExpanded()&&(l===undefined||l===false))){return this}else{var g=e[m+1];var f=this.getChildren();if(!f||f.length===0){return this}else{var h=null;for(var k=0;k<f.length&&h===null;k++){var d=f[k];if(g===d.options.relationid||g===d.options.relid){h=d}}if(h===null){return this}else{return h.getNodeByPath(e,m+2,j,l)}}}}}};a.prototype.getDepth=function(){var e=this;var d=0;while(!e.isRoot()){e=e.getParent();d++}return d};return a});define("DS/PowerByHome/commands/GetRevision",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(c,b,d){var a=c.extend({init:function(e){var f=this;this._parent(e);this._checkSelection();d.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){var e=d.get().options.model.getXSO().get().length?true:false;if(e===true){this.enable()}else{this.disable()}},execute:function(){var e=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"getRevision",data:{cadidPaths:e.cadidPaths}})}});return a});define("DS/PowerByHome/commands/RelationalIPExplorerCmd",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(c,b,d){var a=c.extend({init:function(e){var f=this;this._parent(e);this._checkSelection();d.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){var e=false;var g=d.get().options.model.getXSO().get();for(var f=0;f<g.length;f++){if(g[f]._options.grid.sessionStatus!=="sessionCreated"){e=true;break}}if(e===true){this.enable()}else{this.disable()}},execute:function(){require(["DS/PADUtils/PADUtilsServices","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(f,e){f.setObject_on_compass({nodes_2_open:d.get().getPADTreeDocument().getSelectedNodes()});f.open_app({appId:"ENORIPE_AP"},function(g){})})}});return a});define("DS/PowerByHome/commands/ReplaceByRevision",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(c,b,d){var a=c.extend({init:function(e){var f=this;this._parent(e);this._checkSelection();d.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){var e=d.get().options.model.getXSO().get().length?true:false;if(e===true){this.enable()}else{this.disable()}},execute:function(){var e=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"replaceByRevision",data:{cadidPaths:e.cadidPaths}})}});return a});define("DS/PowerByHome/PowerByTreeListViewUtils",["UWA/Core","UWA/Class","DS/PADUtils/XNavSettings","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt","DS/PADCommands/PADModelEvents","DS/Utilities/Dom","DS/Utilities/Utils","DS/PADUtils/PADPredicatesNls","i18n!DS/PowerByHome/assets/nls/PowerByApps.json","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,b,g,f,i,o,a,k,c,n,d){var m=null;var h=null;function l(t,q,r){var p=t.length;while(--p){var s=t[p];if(r(q,s)){return{item:s,index:p}}}return null}var j=b.extend({buildTreeListColumns:function(B,z){var u=this,s=[],q=[],w=[],v=g.getSetting("columnDefinition"),A=[],t={width:40,minWidth:40,maxWidth:40,dataIndex:"selection",type:"selection",isDraggable:true,isHidden:true,customisation:{exportable:{lock:true,value:false},layout:{lock:false,hidden:true}}};for(var x=0;x<v.length;x++){var r=v[x];if(e.is(r.ds6w)&&r.ds6w.indexOf("ds6wg")===-1){q.push(r.ds6w)}else{w.push(r.dataIndex)}A.push(r.dataIndex)}var p=function(D){var C=e.extend({isDraggable:!D.customisation.layout.lock,isHidden:D.customisation.layout.hidden,minWidth:15,overloadedTooltip:D.tooltip?D.tooltip:undefined},D,true);C.text=D.text;if(e.is(u.onCellRequest[D.dataIndex],"function")){C.onCellRequest=u.onCellRequest[D.dataIndex]}return C};var y=function(I){if(I){var K=[];for(var F=0;F<I.length;F++){K.push(I[F].dataIndex)}if(K.indexOf("selection")===-1){s.push(t)}for(var J=0;J<I.length;J++){var D=I[J],E=null,H=A.indexOf(D.dataIndex);if(D.dataIndex==="selection"){s.push(D);H=-1}if(H!==-1){E=p(D)}if(E){var C=e.extend(E,D,true);s.push(C)}}}else{s.push(t);for(var J=0;J<v.length;J++){var G=p(v[J]);s.push(G)}}return s};y(B.customisation&&B.customisation.view_settings?B.customisation.view_settings.columnDefinition:null);z(s)},onShouldDisplayTooltip:function(u){var r={longHelp:""};if(u.isHeader){function t(w){var x="";if(w.text===""||w.text===null||w.text===undefined){var v="treelistview_customization_"+w.dataIndex;if(e.is(d[v])){x=d[v]}else{x=w.dataIndex}}else{x=w.text}return x}r.longHelp=t(this.getManager().getColumnOptions(u.dataIndex))}else{var s=this.getManager().getColumnOptions(u.dataIndex).overloadedTooltip;if(e.is(this.onProvideTooltip[u.dataIndex])){r=this.onProvideTooltip[u.dataIndex](u)}else{if(s&&u.nodeModel.options.grid[s]){r.longHelp=u.nodeModel.options.grid[s]}else{var p=typeof u.cellModel.options.value;var q="";switch(p){case"string":q=u.cellModel.options.value;break;case"boolean":q=u.cellModel.options.value?"TRUE":"FALSE";break;case"undefined":q="";break}r.longHelp=q}}}return r},onProvideTooltip:{selection:function(p){return{longHelp:p.nodeModel.isSelected?p.nodeModel.isSelected()?d.selected:d.notSelected:""}},tree:function(p){return{longHelp:p.nodeModel.getLabel?p.nodeModel.getLabel():""}},"ds6w:reserved":function(u){var t={longHelp:""};var r=false,q=u.nodeModel.options.grid["ds6w:reserved"];if(q!==undefined&&q!==null){t.longHelp=d.notReserved;var s=u.nodeModel.options.grid["ds6w:reservedBy"]?u.nodeModel.options.grid["ds6w:reservedBy"]:"";r=(typeof q==="boolean")?(q):null;if(r){if(m===null){m=f.getUserLogin()}if(h===null){h=f.getUserName()}var p=true;if(s.trim().length>0){p=(s.toUpperCase().trim()===m.toUpperCase().trim())||false;if(!p){if(s.trim().length!==m.trim().length){p=(s.toUpperCase().trim()===h.toUpperCase().trim())||false}}}if(!p){t.longHelp=d.replace(d.get("reservedByOther"),{who:s})}else{t.longHelp=d.reservedByMe}}}return t}},onCellClickAction:function(q){if(q.cellModel&&q.cellModel.options&&q.cellModel.options.isHeader){return}var p=this.onCellClick[q.dataIndex];if(e.is(p,"function")){p.call(this,q)}},onCellRequest:{"ds6w:reserved":function(u){if(!u.isHeader){var r=false,q=u.nodeModel.options.grid["ds6w:reserved"]!==undefined?u.nodeModel.options.grid["ds6w:reserved"]:"";if(q!==undefined&&q!==null){var s=u.nodeModel.options.grid["ds6w:reservedBy"]?u.nodeModel.options.grid["ds6w:reservedBy"]:"";r=(typeof q==="boolean")?q:null;var t=u.cellView.reuseCellContent("padresuable_unreserved");if(t){if(r){if(m===null){m=f.getUserLogin()}if(h===null){h=f.getUserName()}var p=true;if(s.trim().length>0){p=(s.toUpperCase().trim()===m.toUpperCase().trim())||false;if(!p){if(s.trim().length!==m.trim().length){p=(s.toUpperCase().trim()===h.toUpperCase().trim())||false}}}if(!p){t=u.cellView.reuseCellContent("padresuable_reservedBy_other")}else{t=u.cellView.reuseCellContent("padresuable_reserved")}}}}else{u.cellView.getContent().empty()}}else{u.cellView.getContent().empty()}},"ds6wg:PLMReference.V_isLastVersion":function(q){if(!q.isHeader){var p=q.cellModel.options.value?q.cellModel.options.value:q.nodeModel.options.grid["ds6wg:PLMReference.V_isLastVersion"]?q.nodeModel.options.grid["ds6wg:PLMReference.V_isLastVersion"]:"";if(p!==undefined&&p!==""){p=(typeof p==="boolean")?(p):((p.toUpperCase()==="TRUE")?true:false);if(p){q.cellView.reuseCellContent("check")}else{q.cellView.reuseCellContent("wrong")}}else{q.cellView.getContent().empty()}}},"ds6w:created":function(r){if(!r.isHeader){var q=r.cellModel.options.value;var p=Date.parse(q);if(!isNaN(p)){q=new Date(p).toLocaleString()}r.cellView.getContent().setHTML(q)}},"ds6w:modified":function(r){if(!r.isHeader){var q=r.cellModel.options.value;var p=Date.parse(q);if(!isNaN(p)){q=new Date(p).toLocaleString()}r.cellView.getContent().setHTML(q)}}},onCellClick:{},registerReusableCellContent:function(){var p=this;this.getManager().registerReusableCellContent({id:"padresuable_unreserved",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock-open pad_unlock",style:"color:#b4b6ba; font-size: 22px;"})}});this.getManager().registerReusableCellContent({id:"padresuable_reserved",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-key pad_lock",style:"color:#57b847; font-size: 22px;"})}});this.getManager().registerReusableCellContent({id:"padresuable_reservedBy_other",buildContent:function(){var r=a.createElement("span",{"class":"pad_reserved_by",style:"font-size: 22px;"}),q=a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock pad_lock",style:"color:#ea4f37; font-size: 22px;"});r.appendChild(q);return r}});this.getManager().registerReusableCellContent({id:"check",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check"})}});this.getManager().registerReusableCellContent({id:"wrong",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x  wux-ui-3ds-wrong"})}})},initializePreferencesMgt:function(){var r=this;var q=this.getManager();var p=k.debounce(function(s){r.custoViewChange()},1000);q.onReady(function(){q.onColumnWidthUpdate(p);q.onMoveColumn(p);r.custoViewChange()})},custoViewChange:function(){var p={},q={};p.columnDefinition=this.getManager().getColumns();q=JSON.parse(localStorage.getItem("ENOWSES_AP_Custo"));p.basicTreelistopts=q.basicTreelistopts;localStorage.setItem("ENOWSES_AP_Custo",JSON.stringify(p))},modifyColumRendering:function(u,v){var r=this;var t=e.is(u,"string")?JSON.parse(u):u;var s=r.getManager().getColumnOptions(t.dataIndex);var p=false;if(s){var w=s.text;if(t.headerName&&t.headerName!==w){s.text=t.headerName;if(s.customisation){if(v===true){delete s.customisation.titleModified}else{s.customisation.titleModified=true}}p=true}if(t.isHidden!==undefined&&t.isHidden!==s.isHidden){if(s.isHidden){r.getManager().showColumn(s.dataIndex)}else{r.getManager().hideColumn(s.dataIndex)}s.customisation.layout.hidden=s.isHidden}if(t.exportable!==undefined&&t.exportable!==s.customisation.exportable.value){s.customisation.exportable.value=t.exportable}if(t.column_color){s.customisation.layout.styles=t.column_color;if(!s.customisation.layout.styles){s.customisation.layout.styles={}}s.customisation.layout.styles.color=t.column_color.color;s.customisation.layout.styles["background-color"]=t.column_color["background-color"];var q=s.customisation.layout.styles;r._updateColumnStyles(s.dataIndex,q);r.custoViewChange()}}if(p){r.getManager().updateView(true)}},reset:function(){localStorage.setItem("ENOWSES_AP_Custo","reset");var q=this;var p=o.subscribe({event:"HomeComponent/rebuildColumns"},function(r){o.unsubscribe(p);q.buildTreeListColumns(r,function(t){q.loadColumns(t);for(var s=0;s<t.length;s++){var u={};if(t[s].customisation.layout.styles){u=t[s].customisation.layout.styles}else{u={color:"#000000","background-color":"#ffffff"}}q._updateColumnStyles(t[s].dataIndex,u)}})});o.publish({event:"readyForInit"})},_updateColumnStyles:function(s,x){var q=[];var v=document.styleSheets[0];if(v.cssRules){q=v.cssRules}else{if(v.rules){q=v.rules}}var p="."+this.name+' .wux-datagrid-cell[data-index="'+s+'"]';var t=this._getBrowserSelector(p);var r={};var u=false;var y=l(q,t,function(A,z){return(z.selectorText==A)});if(y!==null){v.deleteRule(y.index)}var w="{}";if(e.is(x,"object")){w=JSON.stringify(x);w=w.replace(/"/g,"");w=w.replace(/,/g,"")}if(w!="{}"){v.insertRule(t+w,q.length)}},_getBrowserSelector:function(q){var s=document.styleSheets;var u=s[s.length-1];var r=-1;var p=null;try{r=u.insertRule(q+"{}",u.cssRules.length);var t=u.cssRules||u.rules;p=t[r].selectorText}finally{if(r>=0){u.deleteRule(r)}}return p}});return j});define("DS/PowerByHome/commands/ReloadFromServer",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(c,b,d){var a=c.extend({init:function(e){var f=this;this._parent(e);this._checkSelection();d.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){var e=d.get().options.model.getXSO().get().length?true:false;if(e===true){this.enable()}else{this.disable()}},execute:function(){var e=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"reloadFromServer",data:{cadidPaths:e.cadidPaths}})}});return a});define("DS/PowerByHome/views/PowerByGraphView",["css!DS/PowerByHome/PowerByHome","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/etree/syncwidget","css!egraph/views","css!etree/syncviews","css!DS/etree/overviewui.css"],function(f,e,c,g,j,a,b,h){var i="powerBygraph";var d=c.extend(g,j,{_treegraph:null,defaultOptions:{fittingArea:{paddingLeft:15,paddingRight:0,paddingTop:0,paddingBottom:80},layout:a.LayoutMode.LAYERED,viewport:null},init:function(k){this._parent(k);this._buildSkeleton();if(this.getOption("renderTo")&&k.isActiveView===true){this.render().inject(this.getOption("renderTo"))}},_buildSkeleton:function(){if(!e.is(this.elements.container)){this.elements.container=UWA.createElement("div",{"class":i});this._treegraph=new a.SyncEGraphTree(this.elements.container,this.options);this._treegraph.createOverview();if(this._treegraph.setAutogroups){this._treegraph.setAutogroups(true)}this._treegraph.setFittingArea(this.options.fittingArea);if(UWA.is(this._treegraph.setHTML5DnD,"function")){this._treegraph.setHTML5DnD(true);this._treegraph.setMultiSelectionDrag(true)}}}});return d});define("DS/PowerByHome/views/PowerByWebView",["css!DS/PowerByHome/PowerByHome","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/UIKIT/Alert","i18n!DS/PowerByHome/assets/nls/PowerByHome.json"],function(e,d,c,f,h,b,i){var g="PowerByWebView";var a=c.extend(f,h,{defaultOptions:{},init:function(j){this._parent(j);this._buildSkeleton();if(this.options.callback){this.options.callback.call(this)}},render:function(){return this.elements.container},_buildSkeleton:function(){var j=this;if(!d.is(this.elements.container)){this.elements.container=UWA.createElement("div",{"class":g})}},show:function(){var k=new b({closable:false,visible:true,autoHide:false,closeOnClick:false,messages:{className:"error",message:i.webViewErrorMessage}}).inject(this.elements.container);var j=k.elements.container.querySelector(".close");j.parentElement.removeClassName("alert-closable");j.parentElement.removeChild(j)}});return a});define("DS/PowerByHome/mixins/PowerByDnD",["UWA/Class","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/views/PADDropTooltip","DS/ApplicationFrame/CommandsManager","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(b,g,c,d,i,h,e,a,f){var j=b.extend({setDnD_onGraph:function(){this.options.views.graphview.getContainer().addEventListener("dragover",this.onDragOverGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("drop",this.onDropBlankGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("dragenter",this.onDragLeaveGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("dragleave",this.onDragLeaveGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("dragend",this.onDragLeaveGraph.bind(this))},doDnDDragStart:function(l,k,m){var n=this.dropdata_from_selected_nodes(k);l.setData("Text",JSON.stringify(n));return true},shouldAcceptDnDDrop:function(o,m,l,n){var k=false;return k},doDnDDrop:function(n,l,k,m){return false},onDragOverGraph:function(k){return false},onDragLeaveGraph:function(k){return false},onDropBlankGraph:function(k){return false},onDragEnterBlank:function(l,k){return false},onDragOverBlank:function(l,k){return false},onDragEndBlank:function(l,k){return false},onDragLeaveBlank:function(l,k){return false},onDropBlank:function(l,k){return false},onDragEnterCell:function(l,k){return false},onDragEndCell:function(l,k){return false},onDragStartCell:function(q,p){var m=p.nodeModel;var l=this.options.model;var n=l.getXSO().get().slice(0);if(n[0]!==m){var o=n.indexOf(m);var k=n[0];n[0]=m;n[o]=k}var r=this.dropdata_from_selected_nodes(n);q.dataTransfer.setData("Text",JSON.stringify(r));q.stopPropagation();return false},onDragOverCell:function(l,k){return false},onDragLeaveCell:function(l,k){return false},onDropCell:function(l,k){},onDragEnterColumnHeader:function(l,k){return},onDragEndColumnHeader:function(l,k){return false},onDragOverColumnHeader:function(l,k){return false},onDragLeaveColumnHeader:function(l,k){return false},onDropColumnHeader:function(l,k){return false},onDragStartColumnHeader:function(l,k){return false},dropOnInvite:function(k){},dropdata_from_selected_nodes:function(k){var l=this;var m={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",widgetId:this.getWidgetId(),data:{items:[]}};k.forEach(function(n){m.data.items.push(l.dropdata_from_node(n))});return m},dropdata_from_node:function(m,k){var l=this;var n=[m.options.type];if(k&&k[m.options.type]){n=k[m.options.type]}return{envId:l.getPlatformId(),serviceId:"3DSpace",contextId:h.getSetting("pad_security_ctx")?h.getSetting("pad_security_ctx"):undefined,objectId:m.getID(),cadId:m.getCADID(),objectType:m.options.type,objectTaxonomies:n,displayName:m.options.display?m.options.display:m.getLabel(),displayType:m.options.grid["ds6w:type"],path:m.getOccurencePathWithType?m.getOccurencePathWithType():undefined}},getWidgetId:function(){if(typeof widget!=="undefined"){return widget.id}else{return -1}},getPlatformId:function(){return(typeof widget!=="undefined"&&widget.getValue("x3dPlatformId"))?widget.getValue("x3dPlatformId"):h.getSetting("x3dPlatformId")}});return j});define("DS/PowerByHome/mixins/PowerByCompatibility",["UWA/Class","DS/UIKIT/Mask"],function(a,c){var b=a.extend({getPADTreeDocument:function(){return this.options.model},getPADTreeListView:function(){return this.options.views.treelistview},getSelectedNodes:function(){return this.options.model.getSelectedNodes()},beginBlockingTransaction:function(d){c.mask(this.elements.main,d)},endBlockingTransaction:function(){c.unmask(this.elements.main)},displayNotification:function(d){require(["DS/PADUtils/views/PADAlert"],function(e){e.displayNotification(d)})},togglePanel:function(d,e){this.elements.appBody.togglePanel(d,e)},});return b});define("DS/PowerByHome/commands/ReplaceContentCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,c,d,b){var a=c.extend({init:function(f){var g=this;this._parent(f);this._check_select();d.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){var f=d.get().options.model.getXSO().get().length?true:false;if(f===true){this.enable()}else{this.disable()}},execute:function(){var f=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"replaceContent",data:{cadidPaths:f.cadidPaths}})}});return a});define("DS/PowerByHome/commands/Options",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,c,d,b){var a=c.extend({init:function(f){var g=this;this._parent(f)},execute:function(){b.publish({event:"options",data:{}})}});return a});define("DS/PowerByHome/PowerByWebInWinProxy",["text!DS/PowerByHome/assets/PowerByWebInWinProxyResources.json","UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/PADCommands/PADModelEvents"],function(h,f,d,c,g){var a="powerByWebInWinProxy";var e=JSON.parse(h);var b=d.singleton({init:function(i){this._parent(i)},setupEventHandler:function(p){var o=this,n;if(p){n=UWA.extend(e,p,true)}else{n=e}var l=Object.getOwnPropertyNames(n);for(var m=0;m<l.length;m++){var k=l[m],j=n[k];if(!UWA.is(j.callback_toWin_fn,"function")){(function(i){o[i.callback_toWin_name]=function(r){var q=UWA.clone(i.formatOut_toWin);if(r){UWA.extend(q.content,r,true)}c.publish("webinwin:web:notification",UWA.is(q,"string")?q:JSON.stringify(q))}})(j)}else{this[j.callback_toWin_name]=j.callback_toWin_fn}g.subscribe({event:j.callback_toWin_name},this[j.callback_toWin_name].bind(this));if(!UWA.is(j.callback_toWeb_fn,"function")){(function(i){o[i.callback_toWeb_name]=function(r){var q=r.content;g.publish({event:i.callback_toWeb_name,data:q})}})(j)}else{this[j.callback_toWeb_name]=j.callback_toWeb_fn}}}});return b});define("DS/PowerByHome/commands/Save",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(c,b,d){var a=c.extend({init:function(e){var f=this;this._parent(e);this._checkSelection();d.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){var e=d.get().options.model.getXSO().get().length?true:false;if(e===true){this.enable()}else{this.disable()}},execute:function(){var e=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"save",data:{cadidPaths:e.cadidPaths}})}});return a});define("DS/PowerByHome/mixins/PowerByCtx",["UWA/Class","i18n!DS/PADCommands/assets/nls/PADCommands.json","i18n!DS/PowerByHome/assets/nls/PowerByHome.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/ApplicationFrame/CommandsManager","DS/WebappsUtils/WebappsUtils","DS/etree/syncwidget","DS/PADCommands/PADModelEvents","DS/PADUtils/PADSettingsMgt","text!DS/PowerByHome/assets/CtxMenuList.json",],function(c,d,j,g,a,e,k,l,i,h){var f=JSON.parse(h);var b=c.extend({getOnContextualEvent:function(m){return{"this":this,callback:function n(p){var o=[];o=this.treeViewMenu(p,m);return o}}},treeViewMenu:function(p,x){var n=[];var v=this;function q(B){var C="";if(B.text===""||B.text===null||B.text===undefined){var A="treelistview_customization_"+B.dataIndex;if(UWA.is(g[A])){C=g[A]}else{C=B.dataIndex}}else{C=B.text}return C}if(p.treeview.isHeader){var r=p.treeview.manager;var y=p.treeview.dataIndex;var w={type:"PushItem",icon:"url("+e.getWebappsAssetUrl("PADCommands","icons/32/I_FitToColumn.png")+")",title:d.PAD_CMDColumnToFit,action:{context:y,callback:function(A){r.sizeColumnToFit(A.context)}}};n.push(w);var z=[];for(var s=0;s<r.options.columns.length;s++){var o=r.options.columns[s];var m=o.customisation.layout.lock?"disabled|":null;if(o.isHidden===false){m=m?m+"selected|":"selected|"}z.push({type:"CheckItem",title:q(o),state:m,action:{context:o.dataIndex,callback:function(A){if(r.getColumnOptions(A.context).customisation.layout.hidden){r.showColumn(A.context);r.getColumnOptions(A.context).customisation.layout.hidden=false}else{r.hideColumn(A.context);r.getColumnOptions(A.context).customisation.layout.hidden=true}}}})}z.push({type:"PushItem",title:d.PAD_CMDCustoColumnMore,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-cog",family:WUXManagedFontIcons.Font3DS,},action:{callback:function(A){v._launchAction({command:"ColumnVisibility"})}}});var u={type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-cog",family:WUXManagedFontIcons.Font3DS,},title:d.PAD_CMDCustoColumn,submenu:z};n.push(u)}else{var t=p.treeview.nodeModel?p.treeview.nodeModel:p.treeview.cellModel;if(t){if(t.isSelected()===false){t.select(true)}n=this.commonMenu(t,x)}}return n},commonMenu:function(q,p){var s=[],o={},n=this;function r(w,v){var u=(v=="PADCommands"?d["PAD_CMD"+f[w].title]:j[f[w].title]);return{title:u,icon:"url("+e.getWebappsAssetUrl(v,f[w].icon)+")",type:"PushItem",action:{callback:n[f[w].callback].bind(n)}}}if(q!==null&&q!==undefined){var t=n.options.model.getSelectedNodes();var m=false;if(t.length>1){m=true}p.forEach(function(z){if(z.multiselection===undefined){z.multiselection=true}if(z.type==="command"){if(z.multiselection||!m){var y=z.id;if(f.lifecyclecmd.indexOf(y)!==-1){s.push(r(y,"LifecycleCmd"))}else{if(f.padcmd.indexOf(y)===-1){s.push(r(y,"PowerByHome"))}else{var v=false;if(y==="ExpandAll_web"||y==="CollapseAll_web"){if(t.length>0){for(var u=0;u<t.length;u++){if(t[u]._expandState==="expandState"||t[u]._expandState==="collapseState"){v=true;break}}}}if(v){s.push(r(y,"PADCommands"))}}}}}else{if(z.type==="subMenu"){z.commands.forEach(function(B){if(B.multiselection===undefined){B.multiselection=true}if(B.multiselection||!m){var A=B.id;if(o[z.label]===undefined){o[z.label]=[]}if(f.padcmd.indexOf(A)!==-1){o[z.label].push(r(A,"PADCommands"))}else{if(f.lifecyclecmd.indexOf(A)!==-1){o[z.label].push(r(A,"LifecycleCmd"))}else{o[z.label].push(r(A,"PowerByHome"))}}}});for(var w in o){var x={type:"PushItem",title:j.lifecycle,submenu:o[w]};s.push(x)}}}if(z.type==="separator"){s.push({type:"SeparatorItem"})}})}return s}});b.prototype._expandAll=function(){this._launchAction({command:"ExpandAll"})};b.prototype._collapseAll=function(){this._launchAction({command:"CollapseAll"})};b.prototype._properties_native=function(){this._launchAction({command:"PropertiesHdr"})};b.prototype._properties_web=function(){this._launchAction({command:"ActionBar_Attributes"})};b.prototype._save_native=function(){this._launchAction({command:"SaveHdr"})};b.prototype._rename_native=function(){this._launchAction({command:"RenameHdr"})};b.prototype._getRevision_native=function(){this._launchAction({command:"GetRevisionHdr"})};b.prototype._replaceByRevision_native=function(){this._launchAction({command:"ReplaceByRevisionHdr"})};b.prototype._reloadFromServer_native=function(){this._launchAction({command:"ReloadFromServerHdr"})};b.prototype._replaceContent_native=function(){this._launchAction({command:"ReplaceContentHdr"})};b.prototype._maturity_web=function(){this._launchAction({command:"MaturityHdr"})};b.prototype._revise_web=function(){this._launchAction({command:"RevisionHdr"})};b.prototype._reserve_native=function(){this._launchAction({command:"ReserveHdr"})};b.prototype._reserve_web=function(){this._launchAction({command:"ActionBar_ReserveCmd"})};b.prototype._unreserve_native=function(){this._launchAction({command:"UnreserveHdr"})};b.prototype._unreserve_web=function(){this._launchAction({command:"ActionBar_UnreserveCmd"})};b.prototype._open_native=function(){require(["DS/PowerByHome/commands/OpenCmd"],function(n){var m=new n();m.execute()})};b.prototype._launchAction=function(n){var m=a.getCommand(n.command,this.options.action_bar_opts&&this.options.action_bar_opts.context?this.options.action_bar_opts.context:null);if(m){m.begin()}};return b});define("DS/PowerByHome/commands/Properties",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,c,d,b){var a=c.extend({init:function(f){var g=this;this._parent(f);this._check_select();d.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){var f=d.get().options.model.getXSO().get().length?true:false;if(f===true){this.enable()}else{this.disable()}},execute:function(){var f=d.get().getPADTreeDocument()._buildSelectData();b.publish({event:"showProperties",data:{cadidPaths:f.cadidPaths}})}});return a});define("DS/PowerByHome/views/PowerByTreeListView",["DS/Tree/TreeListView","DS/PADUtils/XNavSettings","DS/PADCommands/PADModelEvents","DS/Utilities/Dom","DS/PowerByHome/PowerByTreeListViewUtils","DS/WebappsUtils/WebappsUtils","i18n!DS/PowerByHome/assets/nls/PowerByApps.json",],function(d,e,i,a,f,b,c){var h=["CATIAV5","SOLIDWORKS","NX","CREO","SOLIDEDGE","ALTIUM","INVENTOR","AUTOCAD","CAAUPSAPP","CadenceAllegro","3DEXPERIENCE"];var g=d.extend(f,{name:"powerBytreelst",init:function(k){var n=this;var l=require("DS/PADUtils/PADSettingsMgt");var j=k||{};var m=this._parent.bind(this);j=UWA.extend(j,e.getSetting("basicTreelistopts"),true);this.buildTreeListColumns({customisation:k.customisation},function(o){j.columns=o;j.shouldDisplayTooltip=n.onShouldDisplayTooltip.bind(n);m(j);n.getContent().setStyles({position:"absolute",top:0,left:0,bottom:0,right:0});n.getContent().addClassName(n.name);if(n.name!=="powerBytreelst"){n.getContent().addClassName("powerBytreelst")}if(k.renderTo&&k.isActiveView===true){n.inject(k.renderTo)}if(l.getSetting("enablePerformanceAnalysis")===true){n.getManager().enablePerformanceAnalysis()}n.registerReusableCellContent();n.initializePreferencesMgt();n.getManager().onCellClick(n.onCellClickAction.bind(n));n.updateColumns();i.publish({event:"PowerByHome/TreeListView/Ready",data:n})})},setModel:function(j){this.inject(this.options.renderTo);this.options.isActiveView=true;this.getManager().loadDocument(j);if(j.options.viewport.tree!==null&&j.options.viewport.tree!==undefined){this.getManager().setScrollerPosition(j.options.viewport.tree)}},unsetModel:function(){var j=this.getManager();if(j.getScrollerPosition){this.getDocument().options.viewport.tree=j.getScrollerPosition()}this.getOption("renderTo").removeChild(this.elements.container);this.options.isActiveView=false;this.getManager().unloadDocument()},updateColumns:function(){var k=this.getManager().getColumns();for(var j=0;j<k.length;j++){if(k[j].customisation.layout&&k[j].customisation.layout.styles){this._updateColumnStyles(k[j].dataIndex,k[j].customisation.layout.styles)}}},registerReusableCellContent:function(){this._parent();this.getManager().registerReusableCellContent({id:"newInCAD",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_newInCAD.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"incorrectFileLocation",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_incorrectFileLocation.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"unknownByServer",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_unknownByServer.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"knownByServer_localFileOlderThanServerFile",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_localFileOlderThanServerFile.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"knownByServer_metadataHaveChangedOnServer",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_metadataHaveChangedOnServer.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"knownByServer_modifiedInCADSession",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_modifiedInCADSession.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"knownByServer_modifiedSinceDownload",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_modifiedSinceDownload.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"knownByServer_modifiedBySynchronization",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_modifiedBySynchronization.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});this.getManager().registerReusableCellContent({id:"knownByServer_unmodifiedSinceDownload",buildContent:function(){var l=b.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_unmodifiedSinceDownload.png");var k=a.createElement("img",{src:l,width:22,height:22});return k}});for(var j=0;j<h.length;j++){this.getManager().registerReusableCellContent({id:h[j],buildContent:function(){var l=a.createElement("span",{"class":"cadmaster"}),k=a.createElement("img",{"class":"cadmasterIcon",src:b.getWebappsAssetUrl("PowerByHome","icons/cad/I_CADMaster"+this._identifier+".png")});l.appendChild(k);return l}})}},onProvideTooltip:{sessionStatus:function(k){var j={longHelp:""};switch(k.nodeModel.options.grid.sessionStatus){case"newInCAD":j.longHelp=c.newInCAD;break;case"incorrectFileLocation":j.longHelp=c.incorrectFileLocation;break;case"unknownByServer":j.longHelp=c.unknownByServer;break;case"knownByServer_localFileOlderThanServerFile":j.longHelp=c.knownByServer_localFileOlderThanServerFile;break;case"knownByServer_metadataHaveChangedOnServer":j.longHelp=c.knownByServer_metadataHaveChangedOnServer;break;case"knownByServer_modifiedInCADSession":j.longHelp=c.knownByServer_modifiedInCADSession;break;case"knownByServer_unmodifiedSinceDownload":j.longHelp=c.knownByServer_unmodifiedSinceDownload;break;case"knownByServer_modifiedSinceDownload":j.longHelp=c.knownByServer_modifiedSinceDownload;break;case"knownByServer_modifiedBySynchronization":j.longHelp=c.knownByServer_modifiedBySynchronization;break}return j}},onCellRequest:{sessionStatus:function(j){if(!j.isHeader){switch(j.nodeModel.options.grid.sessionStatus){case"newInCAD":j.cellView.reuseCellContent("newInCAD");break;case"incorrectFileLocation":j.cellView.reuseCellContent("incorrectFileLocation");break;case"unknownByServer":j.cellView.reuseCellContent("unknownByServer");break;case"knownByServer_localFileOlderThanServerFile":j.cellView.reuseCellContent("knownByServer_localFileOlderThanServerFile");break;case"knownByServer_metadataHaveChangedOnServer":j.cellView.reuseCellContent("knownByServer_metadataHaveChangedOnServer");break;case"knownByServer_modifiedInCADSession":j.cellView.reuseCellContent("knownByServer_modifiedInCADSession");break;case"knownByServer_unmodifiedSinceDownload":j.cellView.reuseCellContent("knownByServer_unmodifiedSinceDownload");break;case"knownByServer_modifiedSinceDownload":j.cellView.reuseCellContent("knownByServer_modifiedSinceDownload");break;case"knownByServer_modifiedBySynchronization":j.cellView.reuseCellContent("knownByServer_modifiedBySynchronization");break}}},"ds6w:cadMaster":function(m){if(!m.isHeader){var l=null;var j=m.cellModel.options.value;if(j){j=j.replace(/[\[\]]/g,"")}if(h.indexOf(j)!==-1){l=m.cellView.reuseCellContent(j)}if(l){var k=m.manager.getRowHeight();if(k===26&&a.hasClass(l,"compact")===false){l.className="cadmaster compact"}else{if(k===38&&a.hasClass(l,"compact")){l.className="cadmaster"}}}else{m.cellView.getContent().setHTML(m.cellModel.options.value)}}}},centerNode:function(j){this.getManager().scrollToNode(j,"middle",true)}});return g});define("DS/PowerByHome/models/PowerByTreeDocument",["UWA/Core","DS/Tree/TreeDocument","DS/i3DXCompassServices/i3DXCompassPubSub","DS/PADCommands/PADModelEvents","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess","DS/PADUtils/PADSession","DS/PADUtils/views/PADAlert","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADTransactionManager","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PowerByHome/models/PowerByNodeModel","UWA/Utils/InterCom"],function(g,a,m,o,j,h,n,d,c,b,l,f,e,k){var i=a.extend(l,{defaultOptions:{detachTreeDocument:null,viewport:{}},init:function(q){var t=q||{};if(!g.is(t.shouldAcceptDrop)){t.shouldAcceptDrop=this._shouldAcceptDrop.bind(this)}if(!g.is(t.shouldAcceptDrag)){t.shouldAcceptDrag=this._shouldAcceptDrag.bind(this)}this._parent(q);var s=this;this.options.detachTreeDocument=new a();this.invalidateViewPort();o.subscribe({event:"PowerByTreeDocument/initContentFromSession"},s._initContentFromSession.bind(s));o.subscribe({event:"PowerByTreeDocument/updateNodes"},s._updateNodes.bind(s));o.subscribe({event:"PowerByTreeDocument/removeRootFromSession"},s._removeRootFromSession.bind(s));o.subscribe({event:"selectFromWin"},s._selectFromBroadcast.bind(s));var r=function(){if(!s._doNotBroadcastSelect){s._selected_paths=[];var u=s._buildSelectData();o.publish({event:"selectFromWeb",data:u});var v={widgetId:widget.id};m.publish("setTypes",v);s._set3DXContentData()}};this.getXSO().onPostAdd(r);this.getXSO().onPostRemove(r);this.getXSO().onEmpty(function(){if(s._emptyFromProxy===false){s._doNotBroadcastSelect=false}else{s._emptyFromProxy=false}r()});this.getXSO().onPreEmpty(function(){if(s._emptyFromProxy===false){s._doNotBroadcastSelect=true}});var p=function(u){if(u.keyCode===27){s.getXSO().empty()}};document.addEventListener("keyup",p)},_initContentFromSession:function(r){function s(x){var t=x;if(t.children){var w=t.children,v=[];for(var y=0;y<w.length;y++){var u=s(w[y]);if(u.hasChildren()){u.setState({state:"expanded"})}v.push(u)}t.children=v}return new e(t)}for(var p=0;p<r.length;p++){var q=s(r[p]);if(q.hasChildren()){q.setState({state:"expanded"})}this.addRoot(q)}o.publish({event:"PADCommand/RootVisibilityChange",data:{availableRoots:this.getRoots(),detachedRoot:this.options.detachTreeDocument}})},_removeRootFromSession:function(s){var r=this;r._doNotBroadcastSelect=true;function q(v){v.unselect();var u=v.getChildren();if(u){v.getChildren().forEach(function(w){q(w)})}}var t=this.getNodesByIds(s);for(var p=0;p<t.length;p++){q(t[p]);this.removeRoot(t[p])}r._doNotBroadcastSelect=false;o.publish({event:"PADCommand/RootVisibilityChange",data:{availableRoots:this.getRoots(),detachedRoot:this.options.detachTreeDocument}})},_updateNodes:function(r){var q=g.is(r,"string")?JSON.parse(r):r;var p=this;p.withTransactionUpdate(function(){var v=p.getAllDescendants().filter(function(w){return !w.isHidden()});var s=new Map();v.forEach(function(w){var x=s.get(w.options.cadid);if(x){x.push(w)}else{s.set(w.options.cadid,[w])}});for(var u=0;u<q.length;u++){var t=s.get(q[u].cadid);t&&t.forEach(function(w){w.updateOptions(q[u])})}})},getNodesByIds:function(r){var q=[];for(var p=0;p<r.length;p++){var s=this.getNodesById(r[p]);q.push.apply(q,s)}return q},getNodesById:function(q){var p=this.search({match:function(r){if(r.nodeModel.options.cadid===q||r.nodeModel.options.resourceid===q){return true}else{return false}}});return p},getNodeByOccurencePath:function(q){var p=this.getRoots();for(var r=0;r<p.length;r++){var s=p[r].getNodeByPath(q,undefined,undefined,true);if(s){return s}}},_shouldAcceptDrop:function(){return false},_shouldAcceptDrag:function(){return true},invalidateViewPort:function(){this.options.viewport={graph:null,tree:null,tiles:null,thumbnails:null}},prepareBroadcastSelect:function(){},pushBroadcastSelect:function(){},_buildSelectData:function(){var r=[],t=this,u=this._selected_paths;if(j.getSetting("add_objects_when_select")===true&&u.length&&this.getXSO().get().length){var q=this.getRoots();q.forEach(function(w){for(var x=0;x<u.length;x++){var y=w.getNodeByPath(u[x],undefined,undefined,true);if(y){r.push(y)}}})}else{r=this.getXSO().get()}var p={paths:[],cadidPaths:[]};var v;p.attributes={};p.version="1.1";var s=function(x){if(x.getCADID()){var w=x.getCADID();if(!this.attributes.hasOwnProperty(w)){this.attributes[w]={type:x.options.type,label:x.options.label}}}if(x.getID()){var y=x.getID();if(!this.attributes.hasOwnProperty(y)&&!this.attributes.hasOwnProperty(w)){this.attributes[y]={type:x.options.type,label:x.options.label}}}};v=s.bind(p);p.paths=r.map(function(w){return w.getOccurencePath(v)});p.cadidPaths=r.map(function(w){return w.getOccurenceCADIDPath(v)});return p},_selectOccurence:function(){var p=this.getRoots(),u=this,v=this._selected_paths;if(v.length>0){this._doNotBroadcastSelect=true;this.prepareUpdate();var t=[];p.forEach(function(w){for(var x=0;x<v.length;x++){var y=w.getNodeByPath(v[x]);if(y){t.push(y);if(!y.isSelected()){y.select()}}}});var s=this.getSelectedNodes();for(var r=0;r<s.length;r++){var q=s[r];if(t.indexOf(q)<0){q.unselect()}}this.pushUpdate();this._doNotBroadcastSelect=false}},_selectFromBroadcast:function(s){var r=this,t=s.paths,p=s.cadidPaths;if(p!==undefined){r._selected_paths=g.clone(p)}var q=function(){try{r._doNotBroadcastSelect=true;for(var v=0;v<r._selected_paths.length;v++){if(r._selected_paths[v]===null){return}}if(r._selected_paths.length){r._selectOccurence()}else{r._emptyFromProxy=true;r.unselectAll()}var x=[];for(var u=0;u<r._selected_paths.length;u++){var w=r.getNodeByOccurencePath(r._selected_paths[u]);if(w){x.push(r._selected_paths[u])}}r._selected_paths=x}finally{setTimeout(function(){r._doNotBroadcastSelect=false},500)}};q()},_set3DXContentData:function(){var q=this;var p=g.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";if(!q.padintercom){q.padintercom=new k.Socket(p);q.padintercom.subscribeServer("com.ds.compass",window.parent)}var s=q.getSelectedNodes();if(s.length===0){q.padintercom.dispatchEvent("onResetX3DContent",{},p)}else{var r={protocol:"3DXContent",version:"1.0",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",data:{items:[]}};s.forEach(function(t){var u=t.getID();if(u){r.data.items.push({envId:h.getPlatformId(),serviceId:"3DSpace",contextId:j.getSetting("pad_security_ctx")?j.getSetting("pad_security_ctx"):undefined,objectId:t.getID(),objectType:t.options.type,path:undefined})}});q.padintercom.dispatchEvent("onSetX3DContent",r,p)}}});return i});define("DS/PowerByHome/HomeComponent",["DS/PADUtils/PADSession","UWA/Core","UWA/Promise","UWA/Controls/Abstract","DS/UIKIT/Mask","DS/PADCommands/PADModelEvents","DS/PADUtils/PADPromise","DS/PADUtils/PADDataTransform","DS/PADUtils/PADUtilsServices","DS/CoreEvents/ModelEvents","DS/ENOXTriptych/js/ENOXTriptych","DS/PowerByHome/mixins/PowerByCtx","DS/PowerByHome/mixins/PowerByKeyboardInputs","DS/PowerByHome/mixins/PowerByDnD","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassServices/i3DXCompassPubSub","DS/MessageBus/MessageBus","DS/PowerByHome/mixins/PowerByCompatibility","DS/PADUtils/XNavSettings"],function(n,r,d,s,v,a,b,m,l,o,f,t,g,j,c,e,u,k,h){var p="powerbyHomeComponent";var i={};n.softInit(true);var q=s.extend(t,k,g,j,{defaultOptions:{amd_custo:{TreeDocument:"DS/PowerByHome/models/PowerByTreeDocument",TreeListView:"DS/PowerByHome/views/PowerByTreeListView",TreeGraph:"DS/PowerByHome/views/PowerByGraphView"},views:{treelistview:null,graphview:null}},init:function(w){this._parent(w);this.options=r.extend(this.options,w,true);var z=this;this._buildSkeleton();this._buildModel();this._subscribe();var x=b.getPromises();var A=x.slice();var y=new d(function(C,B){d.all(A).then(function(D){a.publish({event:"HomeComponent/Ready",data:z});C()})});y.name="dispatch Ready";x.push(y)},render:function(){return this.elements.container},_buildSkeleton:function(){var x=this;x.elements.container=UWA.createElement("div",{"class":p});x.elements.left=UWA.createElement("div",{"class":p+"-left"});x.elements.main=UWA.createElement("div",{"class":p+"-main"});x.elements.right=UWA.createElement("div",{"class":p+"-right"});var w={left:{resizable:false,originalSize:295,originalState:"close",overMobile:true},right:{resizable:true,originalSize:295,originalState:"close",overMobile:true},withoverflowhidden:true,container:x.elements.container,withtransition:true,modelEvents:a.getModelEvents()};x.elements.appBody=new f();x.elements.appBody.init(w,x.elements.left,x.elements.main,x.elements.right);x.elements.appBody.togglePanel=function(y){if(y==="left"){a.getModelEvents().publish({event:"triptych-toggle-panel",data:"left"})}else{a.getModelEvents().publish({event:"triptych-toggle-panel",data:"right"})}};v.mask(x.elements.main)},_subscribe:function(){var w=this;a.subscribe({event:"HomeComponent/initCusto"},function(z){if(z.action_bar===undefined){throw new Error("ActionBar Is Not Defined")}if(z.contextual_menu===undefined){throw new Error("Contextual Menu Is Not Defined")}if(z.view_settings===undefined){throw new Error("View Settings Is Not Defined")}if(z.title!==undefined){w.options.widget.setTitle(z.title)}if(localStorage.getItem("ENOWSES_AP_Custo")&&localStorage.getItem("ENOWSES_AP_Custo")!=="reset"){i.workUnder=z.workUnder;i.action_bar=z.action_bar;i.contextual_menu=z.contextual_menu;i.view_settings=JSON.parse(localStorage.getItem("ENOWSES_AP_Custo"));for(var y=0;y<i.view_settings.columnDefinition.length;y++){for(var x=0;x<z.view_settings.columnDefinition.length;x++){if(i.view_settings.columnDefinition[y].dataIndex===z.view_settings.columnDefinition[x].dataIndex){i.view_settings.columnDefinition[y].text=z.view_settings.columnDefinition[x].text}}}h.loadSettingsSync(i.view_settings);a.publish({event:"HomeComponent/readyToBuildViews"})}else{if(localStorage.getItem("ENOWSES_AP_Custo")==="reset"){localStorage.setItem("ENOWSES_AP_Custo",JSON.stringify(z.view_settings));i.view_settings=z.view_settings;h.loadSettingsSync(i.view_settings);i.customisation={};i.customisation.view_settings=i.view_settings;a.publish({event:"HomeComponent/rebuildColumns",data:i})}else{i.workUnder=z.workUnder;i.action_bar=z.action_bar;i.contextual_menu=z.contextual_menu;localStorage.setItem("ENOWSES_AP_Custo",JSON.stringify(z.view_settings));i.view_settings=z.view_settings;h.loadSettingsSync(i.view_settings);a.publish({event:"HomeComponent/readyToBuildViews"})}}});a.subscribe({event:"HomeComponent/buildViews"},this._buildViews.bind(this));a.subscribe({event:"HomeComponent/refreshHome"},this._refresh.bind(this));a.subscribe({event:"HomeComponent/setCA"},function(x){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(y){y.set2(x,function(z){})})});c.subscribe("_MySession/AuthKey",function(x){a.publish({event:"changeCA",data:x})});c.subscribe("toggleActiveCA_MySession/AuthKey",function(x){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(z){var y=z.get();a.publish({event:"toggleActiveCA",data:y})})});c.subscribe("toggleDeActiveCA_MySession/AuthKey",function(x){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(z){var y=z.get();a.publish({event:"toggleDeActiveCA",data:y})})});c.subscribe("removeAuthCtxEvent_MySession/AuthKey",function(x){a.publish({event:"removeCA",data:x})});a.subscribe({event:"selectFromWin"},function(y){var x=w.options.model.getSelectedNodes();x&&x.length>0&&w.options.views.treelistview&&w.options.views.treelistview.centerNode(x[0])});if(!w.isSetTypesCallbackSubscribed){e.subscribe("setTypesCallback",function(E){if(E.widgetId===l.getWidgetId()){var y=w.options.model.getSelectedNodes();var B={version:"2.1",results:[],structures:[],viewpoint:[],workUnder:{version:"1.0",AuthoringContextHeader:null,change:{id:"",name:"",context:[],title:"",description:"",severity:""},evolution:{id:"",displayExpression:""}}};var D=UWA.clone(B);var F=0;for(var z in y){var C=y[z].getID();if(C){F++;D.results.push({id:C,phid:C});D.structures.push({structure:[{id:C,show:true,select:true,children:[]}]})}}var A=JSON.stringify(D);var x={appId:E.appId,widgetId:E.widgetId,fileName:"-file",fileContent:A};e.publish("launchApp",x)}});w.isSetTypesCallbackSubscribed=true}},_refresh:function(){this.options.model.getXSO().empty();a.publish({event:"refreshHome"})},_buildModel:function(){var z=this;var w={};var x=b.getPromises();var A=x.slice();var y=new d(function(B){d.all(A).then(function(){require([z.options.amd_custo.TreeDocument],function(C){z.options.model=new C(w);z._keyboardListener=new g({component:z});z._keyboardListener.startObservingKeyboard(z.elements.container);B()})})});y.name="build";x.push(y)},_buildViews:function(){var z=this;var y=b.getPromises();var B=y.slice();var x=new d(function(C){d.all(B).then(function(){require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes"],function(E,D){E.app_initialization(function(){C()},undefined,false)})})});x.name="app init";y.push(x);var w=y.slice();var A=new d(function(C){d.all(w).then(function(){var H=[];i.action_bar.language=z.options.action_bar_opts.language;var F=new d(function(I){if(i.action_bar){require(["DS/PADCommands/PADActionBar"],function(J){z.elements.actionbar=new J({xnav_app:z,action_bar:i.action_bar,renderTo:z.elements.main,callback:{onactionbarcb:function(K){I()}}})})}else{I()}});F.name="action bar";H.push(F);var E=new d(function(I){if(i.workUnder){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(J){J.initialize2(z.elements.main,"_MySession","show","bottom-left",function(K){I()})})}else{I()}});E.name="authoring context";H.push(E);var G=new d(function(J){var K={treelistview:z._buildTreeListView.bind(z),graphview:z._buildGraphView.bind(z)},I=i;K[z.options.active_view]({renderTo:z.elements.main,customisation:I},J);setTimeout((function(){for(var L in K){if(K.hasOwnProperty(L)&&L!==z.options.active_view){K[L]({renderTo:z.elements.main,customisation:I},null)}}}).bind(z),750)});G.name="webux views";H.push(G);var D=new d(function(I){d.all(H).then(function(){v.unmask(z.elements.main);a.publish({event:"HomeComponent/pageReady",version:"1.0"});I();C()})})})});A.name="views";y.push(A)},_buildTreeListView:function(y,z){var w=y||{};var x=this;w.active_view=UWA.clone(x.options.active_view);w.isActiveView=w.active_view==="treelistview"?true:false;w.customisation=y.customisation;w.onDragStartCell=x.onDragStartCell.bind(x);a.subscribe({event:"PowerByHome/TreeListView/Ready"},function(A){x.options.views.treelistview=A;if(w.isActiveView){x.options.views.treelistview.setModel(x.options.model)}if(z){z()}});w.onContextualEvent=x.getOnContextualEvent(w.customisation.contextual_menu);require([x.options.amd_custo.TreeListView],function(A){new A(w)})},_buildGraphView:function(x,y){var z=x||{};var w=this;z.active_view=UWA.clone(w.options.active_view);z.isActiveView=z.active_view==="graphview"?true:false;z.onContextualEvent=w.getOnContextualEvent();require([w.options.amd_custo.TreeGraph],function(A){w.options.views.graphview=new A(z);if(z.isActiveView){w.options.views.graphview.setModel(w.options.model)}if(z.isActiveView===true){w.options.views.graphview.reframeAll()}if(y){y()}})}});return q});
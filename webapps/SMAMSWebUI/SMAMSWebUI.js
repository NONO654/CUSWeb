/*! Copyright 2015 Dassault Systemes */
/*! Copyright 2015 Dassault Systemes */
/*! Copyright 2015 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleGetResultsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/WebappsUtils/WebappsUtils","DS/SMAMSExperimentServices/Document","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAMSExecutionServices/SMAMSExecutionServices","DS/RFLModelerWeb/RFL_EditorPanel","DS/UIKIT/Input/Button","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAMSExperimentServices/SMAMSExperimentServices"],function(c,b,e,d,i,g,h,f,j,k){var a=b.extend({init:function(l){this.panel=null;this._parent(l,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var v=this;var C=v.getFrameWindow();var r=C.RFLEditor;r.hideContextualBar();var t=r.root;var n=r.frmWindow.getUIFrame();var z=r.model.getExperiment().getID();var B;var D={};var q=[];if(!n.querySelector(".results-hierarchy-browser")){var u=c.createElement("ad-hierarchy-browser",{"class":"results-hierarchy-browser"});var A={};A.editor=r;A.title="Results";A.content=u;A.width=350;A.height=315;A.hideFooter=true;A.onOK=(function(){if(this.panel){var E=this.panel.getContent().querySelector("ad-hierarchy-browser");if(E.parentElement){E.parentElement.removeChild(E)}if(!this.panel.closeButtonClicked){this.panel.close()}}}).bind(v);A.onCancel=(function(){if(this.panel){if(!this.panel.closeButtonClicked){var E=this.panel.getContent().querySelector("ad-hierarchy-browser");if(E.parentElement){E.parentElement.removeChild(E)}this.panel.close()}}}).bind(v);var o=new h(A);r.getImmersiveFrame().removeWindow(v.panel);v.panel=o.getPanel();r.getImmersiveFrame().addWindow(v.panel);u.showRefresh=true;u.showRemove=true;u.showIconView=true;u.showListView=true;u.showRootBreadcrumb=true;u.panel=o;var y=c.createElement("div",{title:"Download","class":" tooltip-button-wrapper style-scope ad-hierarchy-browser",});if(u.children[1]){y.inject(u.children[1].children[0].children[1].children[0])}else{if(!u.children[1]){y.inject(u.parentElement)}}var l=new f({value:"",className:"btn btn-xs default style-scope ad-hierarchy-browser",icon:"download"}).inject(y);l.addEvent("onClick",function(){var G=widget.editor.getUIFrame().querySelectorAll(".item-selected")[0].parentElement.parentElement.getAttribute("FileName");var F=function(I){var H=document.createElement("a");document.body.appendChild(H);H.setAttribute("style","display: none");H.href=window.URL.createObjectURL(I);H.download=G;if(window.navigator.msSaveBlob){window.navigator.msSaveBlob(I,G)}else{if(!window.navigator.msSaveBlob){H.click();window.URL.revokeObjectURL(window.URL.createObjectURL(I));document.body.removeChild(H)}}};var E={};E.physicalId=widget.editor.getUIFrame().querySelectorAll(".item-selected")[0].parentElement.parentElement.getAttribute("physicalId");E.filename=widget.editor.getUIFrame().querySelectorAll(".item-selected")[0].parentElement.parentElement.getAttribute("FileName");E.fileformat=widget.editor.getUIFrame().querySelectorAll(".item-selected")[0].parentElement.parentElement.getAttribute("FileFormat");E.responseType="blob";E.onComplete=F;E.onFailure=function(){};E.serverUrl=j.ThreeDSpaceUrl;d.download(E)});y.children[0].children[0].classList.add("style-scope");y.children[0].children[0].classList.add("ad-hierarchy-browser");var x=c.createElement("div",{title:"Open","class":" tooltip-button-wrapper style-scope ad-hierarchy-browser",});if(u.children[1]){x.inject(u.children[1].children[0].children[1].children[0])}else{if(!u.children[1]){x.inject(u.parentElement)}}var m=new f({value:"",className:"btn btn-xs default style-scope ad-hierarchy-browser",icon:"forward"}).inject(x);m.addEvent("onClick",function(){var E=widget.editor.getUIFrame().querySelectorAll(".item-selected")[0].parentElement.parentElement.data;r.eventHandler.openModelInApp(E,"DesignSight","SIMPHYR_AP")});x.children[0].children[0].classList.add("style-scope");x.children[0].children[0].classList.add("ad-hierarchy-browser");var p=function(L,J,I){var K=[];var M=true;if(L.type==="process"){var H={onSuccess:function(Q){widget.editor.getUIFrame().querySelector('[title="Download"]').hide();widget.editor.getUIFrame().querySelector('[title="Open"]').hide();q=[];for(var P=0;P<Q.getAllActivities().length;P++){if(Q.getAllActivities()[P].getObjectType&&Q.getAllActivities()[P].getObjectType()==="Simulation Activity"&&Q.getAllActivities()[P].getName()!=="Experiment"&&Q.getAllActivities()[P].getName()!=="CSE-Director"){q.push(Q.getAllActivities()[P]);var N={name:Q.getAllActivities()[P].getName(),type:"activity",phID:Q.getAllActivities()[P].getPhysicalId(),lastModified:Q.getAllActivities()[P].getFieldValue("created"),description:Q.getAllActivities()[P].getFieldValue("description")};var O=c.createElement("ad-multiview-folder",{});O.model=N;O.viewState="ready";K.push(O)}}I(M,L,K);v.end()},onFailure:function(N){}};i.openProcess(z,H)}else{if(L.type==="activity"){var F={onSuccess:function(R,O,Q){widget.editor.getUIFrame().querySelector('[title="Download"]').show();widget.editor.getUIFrame().querySelector('[title="Open"]').hide();var T=R;var N=new Date(Number(O));var P=String(N);var S=Q;D.physicalId=R;D.onComplete=function(aa){var V=[],Z=0;B=aa;for(var X=0;X<aa.length;X++){V.push({label:aa[X],value:X+1});var Y=aa[X].name.split(".").pop();if(Y==="csv"){var ab=".csv";var U={name:L.name.concat(ab),lastModified:P,description:S}}else{if(Y==="zip"){var ab="_outputFiles.zip";var U={name:L.name.concat(ab),lastModified:P,description:S}}else{var U={name:aa[X].name,lastModified:P,description:S}}}var W=c.createElement("ad-multiview-document",{data:T});W.addEventListener("dragstart",function(af){if(!af){af=window.event}var ae=widget.getValue("x3dPlatformId");if(!ae){ae="OnPremise"}var ad={protocol:"3DXContent",version:"0.1",source:"X3DCSMA_AP",data:{items:[{envId:ae,serviceId:"3DSpace",contextId:widget.getPreference("collabspaces").value.split("::")[1],objectId:T,fileName:this.getAttribute("FileName"),fileNameDisplayed:this.getAttribute("FileNameDisplayed"),objectType:"Simulation Document - Versioned",displayName:""}]}};var ac=JSON.stringify(ad);af.dataTransfer.setData("text",ac)});W.setAttribute("FileName",aa[X].name);W.setAttribute("FileNameDisplayed",L.name);W.setAttribute("FileFormat",aa[X].format);W.setAttribute("physicalId",T);W.model=U;W.viewState="ready";W.expandable=false;K.push(W);Z++}I(M,L,K);v.end()};D.onFailure=function(){};d.listFiles(D)},onFailure:function(N){}};var E={onSuccess:function(Q,O){widget.editor.getUIFrame().querySelector('[title="Download"]').hide();widget.editor.getUIFrame().querySelector('[title="Open"]').show();var R=Q;var N={name:O,};var P=c.createElement("ad-multiview-simulation",{data:R});P.addEventListener("dragstart",function(V){if(!V){V=window.event}var U=widget.getValue("x3dPlatformId");if(!U){U="OnPremise"}var T={protocol:"3DXContent",version:"0.1",source:"X3DCSMA_AP",data:{items:[{envId:U,serviceId:"3DSpace",contextId:widget.getPreference("collabspaces").value.split("::")[1],objectId:R,filePlot:this.getAttribute("FileName"),objectType:"DesignSight",displayName:"Physics Simulation"}]}};var S=JSON.stringify(T);V.dataTransfer.setData("text",S)});P.setAttribute("FileName","Result SO");P.model=N;P.viewState="ready";P.expandable=false;K.push(P);I(M,L,K);v.end()},onFailure:function(N){}};for(var G=0;G<q.length;G++){if(q[G].getName()==="Results Generation"&&L.name==="Results Generation"){g.getResultsSO(z,E)}else{if(q[G]._data.physicalId===L.phID){g.getResults(q[G],F)}}}}}I(M,L,K)};u.populateFunction=p;var w={name:"myProcess",type:"process",id:z};u.rootItem=w}else{if(n.querySelector(".results-hierarchy-browser")){var s=n.querySelector(".results-hierarchy-browser");s.destroy()}}}});return a});
/*! Copyright 2015 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleGetMessagesCmd",["DS/ApplicationFrame/Command","DS/UIKIT/Input/Toggle","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/Windows/Panel","DS/RFLModelerWeb/RFL_EditorPanel","DS/Controls/Tab","DS/Controls/TabBar","DS/Tree/TreeListView","DS/Controls/Expander","DS/SMAMSExecutionServices/SMAMSSolverMessageProcessing","UWA/Core"],function(p,s,g,m,a,l,v,k,o,b,i){var n=["Step","Inc","dt","Total Time","RMS Div","Kinetic Energy",];var h=["step","increment","deltaTime","totalTime","rmsDiv","kineticEnergy"];var r=[50,50,"auto","auto","auto","auto"];var e=["Step","Inc","Att","Sev Discon Iter","Eq Iter","Tot Iter","Tot Time","Step Time","Time Inc"];var y=["step","increment","attempts","severe","equilibrium","iterations","totalTime","stepTime","timeIncrement"];var f=[50,50,50,"auto","auto","auto","auto","auto","auto"];var q=["Step","Inc","Tot Time","CPU Time","Step Time","Stable Inc","Kin Energy","Tot Energy"];var d=["step","increment","totalTime","cpuTime","stepTime","stableTimeIncrement","kineticEnergy","totalEnergy"];var t=[50,50,"auto","auto","auto","auto","auto","auto"];var j=["deltaTime","totalTime",,"stepTime","timeIncrement","stableTimeIncrement","cpuTime"];var u=["rmsDiv","kineticEnergy","totalEnergy"];var c=function(C){var A=false;for(var B=0;B<j.length;B++){if(j[B]==C){A=true;break}}return A};var z=function(C){var A=false;for(var B=0;B<u.length;B++){if(u[B]==C){A=true;break}}return A};var x=function(I,K,E){var L=["Warning","Error"];var A={};var D={defaultCellHeight:35,apiVersion:2,columns:[],roots:[]};D.height="400px";D.resize={columns:true,rows:false};var H;var R;var V=0;var N=function(X){var W,aa,Z;R=X;if(X==="STANDARD_PHASE"){W=e;aa=y;Z=f}else{if(X==="EXPLICIT_PHASE"){W=q;aa=d;Z=t}else{W=n;aa=h;Z=r}}for(var Y=0;Y<W.length;Y++){D.columns.push({text:W[Y],dataIndex:aa[Y],width:Z[Y],isDraggable:false,isSortable:false})}};var J=function(ac){var Y=H.getManager().getDocument();Y.prepareUpdate();for(var X=0;X<ac.length;X++){var aa={};var ab=ac[X];for(var Z=1;Z<D.columns.length;Z++){var W=D.columns[Z].dataIndex;aa[D.columns[Z].dataIndex]=ab[D.columns[Z].dataIndex].nodeValue;if(c(W)){aa[W]=parseFloat(aa[W]).toPrecision(3)}else{if(z(W)){aa[W]=parseFloat(aa[W]).toExponential(2)}}}Y.addRoot({label:"",grid:aa})}Y.pushUpdate()};var C=new l();var U=i.createElement("div");U.setAttribute("class","container-fluid");U.setAttribute("style","margin-top:10px;");var B=i.createElement("div");B.setAttribute("class","container-fluid");B.setAttribute("style","margin-top:10px;");var G=g.get("results_03");if(G==="results_03"){G="No messages to display"}var O=i.createElement("div");O.inject(B);O.setAttribute("style","color: #b4b6ba;text-align:center;");O.textContent=G;var Q=i.createElement("div");Q.inject(U);Q.setAttribute("style","color: #b4b6ba;text-align:center;");Q.textContent=G;var S=function(){var Y=widget.editor.model;var W=new i.Element("div");W.inject(I);C.addTab("Messages",B,0,true,0);C.addTab("Iterations",U,1,false,1);C.tabBar.pinFlag=false;C.tabBar.centeredFlag=false;C.inject(W);C.value=[0];for(var X=0;X<L.length;X++){var Z=L[X];A[Z]=new o({allowUnsafeHTMLHeader:false,header:Z,body:i.createElement("div"),}).inject(B);A[Z].visibleFlag=false;A[Z].count=0}};S();var P=function(){H=new k(D);H.getManager().hideColumn(0);H.options.columns[0].text="";H.getManager().getDocument().options.shouldAcceptDrag=function(){return false};H.getManager().getDocument().options.shouldAcceptDrop=function(){return false};H.inject(U)};var F=function(ac){var ad={Warning:[],Error:[]};for(var Z in ac){if(ac.hasOwnProperty(Z)&&Z!=="Status"&&Z!=="Sensor"){var ab=ac[Z];for(var Y=0;Y<ab.length;Y++){if(ab[Y].hasOwnProperty("message")){var aa=Z;if(aa!=="Warning"&&aa!=="Error"){continue}ad[aa].push(ab[Y].message.nodeValue);A[aa].count++}}}else{if(Z==="Status"){if(Q){Q.remove();Q=null}var ab=ac[Z];if(D.columns.length===0){var X=ab[0].phase.nodeValue;N(X);P()}J(ab)}}}for(var Z in A){if(A.hasOwnProperty(Z)&&ad[Z]!==""){A[Z].visibleFlag=true;for(var Y=0;Y<ad[Z].length;Y++){var W=document.createElement("div");W.textContent=ad[Z][Y];W.setAttribute("style","display: block");W.setAttribute("style","margin-bottom: 10px");A[Z].body.appendChild(W)}A[Z].header=Z+" ("+A[Z].count+")";if(O){O.remove();O=null}}}};var T=function(){};var M=widget.editor.model.getExperiment().solverMessages;if(M!==undefined&&M!==null){M.getMessages(E,F,T)}};var w=p.extend({init:function(A){this.panel=null;this._parent(A,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var H=this;var V=H.getFrameWindow();var F=V.RFLEditor;if(!F.model.experiment.monitoring.list){F.model.experiment.monitoring.list=[]}var A=F.model.getExperiment().solverOptions.duration;var N=F.model.components;var D=[];var O=[];var M=i.createElement("div");M.setAttribute("class","container-fluid");var U=i.createElement("div");U.setAttribute("class","container-fluid");U.inject(M);var Q=0;if(F.model.components.length!==0){var J=0;var C=new l();var L=0;var I=true;for(var T=0;T<N.length;T++){for(var S=0;S<N[T].instances.length;S++){var E=N[T].instances[S].getSelectedBehavior();if(E&&E.sim&&!E.is3dfmu){var W=i.createElement("div");W.setAttribute("class","container-fluid");W.setAttribute("style","margin-top:10px;");var K=N[T].instances[S].name;var P=N[T].instances[S].phID;C.addTab(K,W,L,I,L);if(I){I=false}L++;x(W,K,P);Q++}}C.tabBar.pinFlag=false;C.tabBar.centeredFlag=false;C.inject(U);C.value=[0];C.redrawTabBar()}}if(Q===0){var G=g.get("results_04");if(G==="results_04"){G="No SIM behaviors to display status messages"}U.setAttribute("style","color: #b4b6ba;text-align:center;");U.innerHTML=G}F.hideContextualBar();var R={};R.editor=F;R.title="Simulation Status Messages";R.content=M;R.width=850;R.height=515;R.hideFooter=true;R.onOK=function(){H.end()};R.onCancel=function(){H.end()};var B=new a(R);H.panel=B.getPanel();F.getImmersiveFrame().addWindow(H.panel)},endExecute:function(){var A=this;if(A.panel){if(!A.panel.closeButtonClicked){A.panel.close()}A.panel=null}}});return w});
/*! Copyright 2015 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScalePlayRunAsCmd",["DS/ApplicationFrame/Command","DS/Core/Core","DS/RFLModelerWeb/RFL_EditorPanel","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","UWA/Core","DS/UIKIT/Form"],function(a,d,f,e,g,b){var c=a.extend({_execServ:null,init:function(h){this.panel=null;this.runAsCredentials={domainName:"",windowsUser:"",windowsPass:"",linuxUser:"",linuxPass:"",isightV5User:"",isightV5Password:""};this._parent(h,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var i=d.AFR.CommandsManager.getCommand("SMAMultiScalePlayCmdHdr");if(!i){this.end()}var o=this;var l=this.getFrameWindow();var j=l.RFLEditor;var m=new b({className:"vertical",fields:[{type:"text",name:"domainName",label:"Domain Name",value:this.runAsCredentials.domainName,required:true},{type:"text",name:"windowsUser",label:"Windows Username",value:this.runAsCredentials.windowsUser,required:true},{type:"password",name:"windowsPass",label:"Windows Password",value:this.runAsCredentials.windowsPass,required:true},{type:"text",name:"linuxUser",label:"Linux Username",value:this.runAsCredentials.linuxUser,required:true},{type:"password",name:"linuxPass",label:"Linux Password",value:this.runAsCredentials.linuxPass,required:true}]});var h=g.createElement("div");h.setAttribute("class","container-fluid");m.inject(h);var k={};k.editor=j;k.title="RunAs Credentials";k.content=h;k.width=351;k.height=440;k.onOK=function(){if(!m.validate()){return}o.runAsCredentials={domainName:m.getValue("domainName"),windowsUser:m.getValue("windowsUser"),windowsPass:m.getValue("windowsPass"),linuxUser:m.getValue("linuxUser"),linuxPass:m.getValue("linuxPass"),isightV5User:"",isightV5Password:""};i.runAsCredentials=o.runAsCredentials;i.begin()};k.onCancel=function(){o.end()};var n=new f(k);this.panel=n.getPanel();j.getImmersiveFrame().addWindow(this.panel);m.getField("domainName").focus()},endExecute:function(){if(this.panel){if(!this.panel.closeButtonClicked){this.panel.close()}this.panel=null}}});return c});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleStatusCmd",["UWA/Core","DS/ApplicationFrame/Command"],function(c,a){var b=a.extend({init:function(d){this._parent(d,{isAsynchronous:true,isEnabled:false,mode:"exclusive"});this.panel=null},execute:function(){var e=this;var f=e.getFrameWindow();var d=f.RFLEditor;var g=d.model.experiment.monitoring;this.panel.visibleFlag=true;e.end()}});return b});
/*! Copyright 2016 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleExpCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/SMAMSWeb/SMAMSExperiment","DS/UIKIT/Form","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","i18n!DS/SMAMSWebUI/assets/nls/SMAMSWebUI","DS/RFLModelerWeb/RFL_EditorPanel","DS/Windows/Dialog","DS/Controls/Button","DS/SMAProcWebCMMUtils/SMAJSCMMUtils"],function(e,c,h,f,g,k,d,i,l,j,b){var a=c.extend({init:function(m){this.odtCallback=null;this.panel=null;this._parent(m,{isAsynchronous:true,isEnabled:true,mode:"exclusive"})},execute:function(){var s=this;var u=s.getFrameWindow();var t=u.RFLEditor;var r=t.model;var n=r.getExperiment();var q=new f({className:"vertical",fields:[{type:"text",name:"experimentName",label:"Name"},{type:"textarea",name:"experimentDesc",label:"Description"}]});var p=e.createElement("div");p.setAttribute("class","container-fluid");q.inject(p);t.hideContextualBar();var o=d.get("createExperiment");if(o==="createExperiment"){o="Create Experiment"}var v={};v.editor=t;v.title=o;v.content=p;v.height=235;v.onOK=function(){var x=q.getValue("experimentName");if(!x.trim()||!b.isValidTitle(x,"process")){r.addMessage("Experiment name cannot be empty or contain special characters.","warning","notification");q.getField("experimentName").focus()}else{var A=q.getValue("experimentDesc");var z=x;var w=function(){r.closeModel();t.removeIntroText();t.removeRecentExp();var B={};B.title=z;B.type="DS/RFLModelerWeb/RFL_Component";r.createComponent(B,function(C){r.createSystem(C,B,function(E){r.setRoot(E);var D=new h(r);D.setInfo({title:x,description:A,physicalId:D.phID},function(){},function(){});D.createProcessNew(function(){r.addExperiment(D);if(typeof widget!=="undefined"&&e.is(widget)&&e.is(widget.setTitle)){widget.setTitle(x)}if(s.odtCallback){s.odtCallback()}})},function(){})},function(){});s._enablePanel();s.end()};if(n){s._disablePanel();var y=new l({immersiveFrame:t.getImmersiveFrame(),title:"Confirmation",closeButtonFlag:true,content:"Are you sure you want to create a new Experiment? <br> This action will close the existing Experiment.",position:{at:"center",my:"center"},resizableFlag:false,buttons:{Cancel:new j({allowUnsafeHTMLLabel:false,onClick:function(B){B.dsModel.dialog.close();s._enablePanel();s.end()}}),Ok:new j({allowUnsafeHTMLLabel:false,onClick:function(B){B.dsModel.dialog.close();w()}})}}).inject(t.getUIFrame());y.addEventListener("close",function(B){s._enablePanel();s.end()})}else{w()}}};v.onCancel=function(){s.end()};var m=new i(v);s.panel=m.getPanel();t.getImmersiveFrame().addWindow(s.panel);q.getField("experimentName").focus()},_disablePanel:function(){var m=this;if(m.panel){m.panel.disabled=true}},_enablePanel:function(){var m=this;if(m.panel){m.panel.disabled=false}},endExecute:function(){var m=this;if(m.panel){if(!m.panel.closeButtonClicked){m.panel.close()}m.panel=null}}});return a});
/*! Copyright 2016 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleParamCmd",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/LineEditor","DS/Controls/Toggle","DS/Controls/TooltipModel"],function(e,c,k,h,g,b,f,d,j,i){var a=c.extend({init:function(l){this.selectedElement=null;this.selectedBehavior=null;this.callback=true;this.panel=null;this.returnToCommand=null;this._parent(l,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var n=this;var o=n.getFrameWindow();var m=o.RFLEditor;var l=m.model;if(n.selectedElement===null){n.selectedElement=m.gr.selection.first}if(!n.selectedElement){l.addMessage("You must select a component first.","warning","notification");n.end();return}n.elementSelected(n.selectedElement)},_getUI:function(s,n){var w=this;var y=w.getFrameWindow();var x=y.RFLEditor;var v=x.model;var l=v.getExperiment();var r=JSON.parse(JSON.stringify(s));var o=e.createElement("div");o.setAttribute("class","wux-control-inline-container");o.setStyle("width","100%");o.setStyle("margin","auto");if(typeof n===undefined||!e.is(n)||Object.keys(n).length===0){v.addMessage("No parameters present in component.","warning","notification");w.end();return}else{var z=new b({useAsyncPreExpand:true,shouldBeEditable:function(){return false},shouldAcceptDrag:function(){return false}});for(var q in n){if(!n.hasOwnProperty(q)){continue}var u=q;var p=n[q].value;var m=n[q].type;if(m!=="Real"){continue}if(r[q]){p=r[q].value}else{r[q]={type:n[q].type,value:n[q].value}}z.addChild([{grid:{name:q,type:m,value:p,defaultFlag:n[q].value===r[q].value}}])}var t=Object.keys(s).length===0;var B={treeDocument:z,selection:{canMultiSelect:false,cells:false,columnHeaders:false,enableListSelection:false,nodes:false,rowHeaders:false,toggle:false,unselectAllOnEmptyArea:true},defaultCellHeight:35,apiVersion:2,columns:[{dataIndex:"tree",isHidden:true},{text:"Name",dataIndex:"name",width:"auto",isDraggable:false},{text:"Type",dataIndex:"type",width:"50",isDraggable:false},{text:"Value",dataIndex:"value",width:"auto",onCellRequest:function(C){if(!C.isHeader){var D=new d({value:C.nodeModel.options.grid.value});if(C.cellView){C.cellView.getContent().setAttribute("draggable",false);C.cellView.getContent().setContent(D)}D.disabled=C.nodeModel.options.grid.defaultFlag}},isDraggable:false},{text:" ",dataIndex:"defaultFlag",width:"50",onCellRequest:function(D){var C=new j({allowUnsafeHTMLLabel:true,label:"",type:"switch",checkFlag:D.isHeader?t:D.nodeModel.options.grid.defaultFlag});C.getContent().setStyle("text-align","center");if(D.isHeader){C.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Set default values for all parameters."});C.addEventListener("change",function(){var E={};if(C.checkFlag){E=n;t=true}else{E=r;t=false}w._treeListView.getRoots().forEach(function(F){if(E[F.options.grid.name]){F.options.grid.value=E[F.options.grid.name].value;F.options.grid.defaultFlag=t}});w._treeListView.getManager().updateView()})}else{C.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Set default value."});C.addEventListener("change",function(){if(C.checkFlag){if(n[D.nodeModel.options.grid.name]){D.nodeModel.options.grid.value=n[D.nodeModel.options.grid.name].value}D.nodeModel.options.grid.defaultFlag=true}else{if(r[D.nodeModel.options.grid.name]){D.nodeModel.options.grid.value=r[D.nodeModel.options.grid.name].value}D.nodeModel.options.grid.defaultFlag=false}w._treeListView.getManager().updateView()})}D.cellView.getContent().setContent(C)},isDraggable:false,isSortable:false}]};var A=35*(Object.keys(r).length+1);B.height=A+"px";w._treeListView=new g(B);w._treeListView.inject(o);o.querySelector(".wux-layouts-gridengine").style.height=(A+35)+"px"}return o},elementSelected:function(q){var u=q.data.RFLComponent;var s=this;var w=s.getFrameWindow();var t=w.RFLEditor;var r=u.getReference().model;var o=null;var p={};var m=r.getExperiment();t.hideContextualBar();if(u.isDeleted){s.end();return}var v=null;if(!s.selectedBehavior){v=u.getSelectedBehavior();s.callback=false}else{v=s.selectedBehavior}if(!v){r.addMessage("The component does not have a selected abstraction.","warning","notification");s.end();return}if(m){p=m.getParameters(u.phID)}if(v){var n=v.getDefaultParameters();o=s._getUI(p,n);if(o){var y={};y.editor=t;y.title="Parameters - "+u.getInfo().name;y.content=o;y.width=426;y.minWidth=350;var x=105+35*Object.keys(n).length;y.height=x;y.onOK=function(){var D=JSON.parse(JSON.stringify(n));var G=0;s._treeListView.getRoots().forEach(function(H){var I=H.options.grid.value;if(isNaN(I-parseFloat(I))){H.options.grid.value="";G++}});s._treeListView.getManager().updateView();if(G){r.addMessage("Real type parameters can only take non-empty numeric values","warning","notification");return}var A=0;s._treeListView.getRoots().forEach(function(H){var I=H.options.grid.name;if(D[I]){D[I].value=H.options.grid.value}});var C=s._compareParams(D,n,p);if(v.phID&&Object.keys(v.getDefaultParameters()).length){if(m){var z=m.listBehaviors();if(z[u.phID]&&z[u.phID].behavior===v.phID){if(m.process!==null&&typeof m.process!==undefined){var F={create:[],update:[],remove:[]};for(var B=0;B<C.length;B++){var E={name:C[B].title,startValue:C[B].value};if(C[B].state==="create"){F.create.push(E)}else{if(C[B].state==="update"){F.update.push(E)}}if(C[B].state==="remove"){F.remove.push(E)}}m.setParameters(u.phID,p,F,function(){},function(){})}}}}s.end()};y.onCancel=function(){s.end()};var l=new h(y);s.panel=l.getPanel();t.getUIFrame().querySelector("#maskDiv").style.display="block";t.getImmersiveFrame().addWindow(s.panel)}}},_compareParams:function(p,m,l){var o=[];for(var n in m){if(m[n].type!=="Real"){continue}if(l[n]&&p[n]&&m[n].value!==p[n].value&&l[n].value!==p[n].value){o.push({title:n,value:p[n].value,state:"update"});l[n]={type:"Real",value:p[n].value}}else{if(l[n]&&p[n]&&m[n].value===p[n].value){o.push({title:n,value:p[n].value,state:"remove"});delete l[n]}else{if(!l[n]&&p[n]&&m[n].value!==p[n].value){o.push({title:n,value:p[n].value,state:"create"});l[n]={type:"Real",value:p[n].value}}}}}return o},endExecute:function(){var m=this;var n=m.getFrameWindow();var l=n.RFLEditor;l.getUIFrame().querySelector("#maskDiv").style.display="none";l.clearSelection();m.callback=true;m.selectedElement=null;m.selectedBehavior=null;if(m.panel){if(!m.panel.closeButtonClicked){m.panel.close()}m.panel=null}if(m.returnToCommand){m.returnToCommand.begin();m.returnToCommand=null}}});return a});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleZoomOutCmd",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages"],function(d,a,c){var b=a.extend({init:function(e){this._parent(e,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var g=this;var j=g.getFrameWindow();var f=j.RFLEditor;f.hideContextualBar();var i=f.root;if(!i){var e=c.get("sys_01");if(e==="sys_01"){e="An experiment must be created first."}f.model.addMessage(e,"error","notification")}else{var h=f.gr;h.views.main.zoominc(-1)}g.end()}});return b});
/*! Copyright 2016 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleCheckCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/SMAMSWeb/SMAMSRuleChecker","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","i18n!DS/SMAMSWebUI/assets/nls/SMAMSWebUI","DS/RFLModelerWeb/RFL_EditorPanel","DS/Controls/Expander","DS/Controls/Button"],function(e,c,g,f,d,b,h,j,i){var a=c.extend({callback:null,init:function(k){this.panel=null;this._rc=null;this._parent(k,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var o=this.getFrameWindow();var m=o.RFLEditor;var n=m.root;this._model=m.model;m.hideContextualBar();var k=this._model.getExperiment();if(k===null||typeof(k)===undefined){var l=d.get("exp_not_created");if(l==="exp_not_created"){l="An experiment must be created first."}n.getModel().addMessage(l,"warning","notification");this.end();return}this.fillPanel(true);this.end()},updateUI:function(n){var l=this._model;var m=l.getEditor();var k=l.getExperiment();this._rc=new g(k,["DS/SMAMSWeb/SMAMSRuleExperiment","DS/SMAMSWeb/SMAMSRuleConnector","DS/SMAMSWeb/SMAMSRuleBehaviorSelection","DS/SMAMSWeb/SMAMSRuleMapping","DS/SMAMSWeb/SMAMSRuleInteraction"]);this._rc.run((function(){var s=this._rc.getListErrors();var t=e.createElement("div");t.setAttribute("class","container-fluid");var o=new e.Element("div").inject(t);o.style.paddingTop="15px";o.style.height="50px";var u=0;var B=0;for(var E in s){var v=new e.Element("div");v.setAttribute("class","row");v.style.margin="0";var p;if(s[E].length===0){var z=new e.Element("div");var q=d.get("check_no_error");z.appendChild(e.createElement("span",{text:q}));z.inject(v)}var D="check";for(var w=0;w<s[E].length;w++){if(w!==0){var x=new e.Element("div");x.style.borderTop="solid 1px grey";x.inject(v)}p=s[E][w].createUI();p.inject(v);if(s[E][w].getType()==="error"){u++;D="alert"}else{if(s[E][w].getType()==="warning"){B++;if(D!=="alert"){D="attention"}}}s[E][w].onEdition((function(){this.fillPanel()}).bind(this))}var F=s[E].length?E+"   ("+s[E].length+")":E;var C=new j({allowUnsafeHTMLHeader:false,header:F,icon:D,}).inject(t);C.body=v;if(s[E].length>0){C.expand()}}var q=u+" "+(u>1?d.get("general_errors"):d.get("general_error"));if(B>0){q+=", "+B+" "+d.get("general_warnings")}var r=new e.Element("span").inject(o);r.textContent=q;r.style.position="relative";r.style.left="2px";var y=new e.Element("div").inject(o);y.style["float"]="right";y.style.position="relative";var A=new i({allowUnsafeHTMLLabel:false,label:b.get("check_cmd")}).inject(y);n(t,A,u)}).bind(this),function(){l.addMessage(d.get("check_failure"),"info","log")})},fillPanel:function(n){var k=this._model;var l=k.getEditor();if(!this.panel&&n){var p=new e.Element("div");var m={};m.editor=l;m.title=b.get("check_title");m.content=p;m.width=500;m.height=415;m.hideFooter=true;m.onOK=function(){this.panel=null};m.onCancel=(function(){this.panel=null}).bind(this);var o=new h(m);this.panel=o.getPanel();l.getImmersiveFrame().addWindow(this.panel);this.panel.hide()}if(this.panel){this.updateUI((function(s,t,q){if(this.panel.content.firstChild){this.panel.content.replaceChild(s,this.panel.content.firstChild)}else{this.panel.content.appendChild(s)}t.onClick=(function(){this.fillPanel()}).bind(this);if(this.callback){if(q===0){var r=d.get("check_validated");k.addMessage(r,"success","notification");this.callback();this.callback=null;this.panel.close();this.panel=null;return}else{var r=d.get("check_not_validated");k.addMessage(r,"warning","notification");this.callback=null}}this.panel.show()}).bind(this))}},endExecute:function(){}});return a});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleDelCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/egraph/core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages"],function(e,b,a,d){var c=b.extend({init:function(f){this._parent(f,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var i=this;var j=i.getFrameWindow();var h=j.RFLEditor;var g=h.model;var k=h.gr.selection.first;var f=[];while(k){if(k.selected){f.push(k)}k=k.next}if(f.length&&f[0]!==null){i.deleteSelected(f)}else{g.addMessage("You must select a component or a connection first.","warning","notification");i.end()}},deleteSelected:function(n){var h=this;var m=h.getFrameWindow();var i=m.RFLEditor;i.hideContextualBar();i.clearSelection();var o=i.root;if(n[0].type===a.Type.NODE){var k=n[0].data.RFLComponent;if(!k.isDeleted){if(k.getSelectedBehavior()){var f=i.model.getExperiment();var j=d.get("comp_rem_spinner");if(j==="comp_rem_spinner"){j="Removing Component..."}var g={message:j,exclusive:false};i.addSystemSpinner(g);k.isDeleted=true;f.removeBehavior1(k.getID(),function(){o.removeInstance1(k,false,function(){},function(){});i.removeSystemSpinner(g)},function(){k.isDeleted=false;i.removeSystemSpinner(g)})}else{o.removeInstance1(k,false,function(){},function(){})}}}else{if(n[0].type===a.Type.EDGE){var l=n[0].data.RFLlink;o.removeLink(l,function(){},function(){})}}h.end()},endExecute:function(){}});return c});
/*! Copyright 2015 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScalePlayCmd",["DS/ApplicationFrame/Command","DS/SMAMSWeb/SMAMSGenerateConfigFile","DS/Core/Core","DS/Controls/ComboBox","DS/RFLModelerWeb/RFL_EditorPanel","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMWebServicesUtils","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/SMAMSExecutionServices/SMAMSCommonServices","DS/SMAMSExecutionServices2Unqueued/Constants","UWA/Core","UWA/Json"],function(b,i,f,l,g,k,c,h,d,j,e){var a=b.extend({_execServ:null,init:function(m){this.panel=null;this.runAsCredentials=null;this._parent(m,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var r=this;var s=this.getFrameWindow();var q=s.RFLEditor;var n=q.model.getExperiment();var m=false;for(var p=0;p<n.model.getRoot().listInstances().length;p++){if(n.model.getRoot().listInstances()[p].getSelectedBehavior().simResults&&n.model.getRoot().listInstances()[p].getSelectedBehavior().simResults===true){m=true}}var t=widget.editor.getUIFrame().querySelector(".ec-monitoring").parentNode;t.remove();var t=e.createElement("ec-monitoring").inject(n.monitoring.statusDiv.querySelector(".monitoring-expander-content"));if(m===true){t.initialize(["Checking Execution Settings","Creating Job","Submitting to station","Starting Cosimulation","Running Cosimulation","Uploading Results","Results Generation","Finalizing"]);for(var p=0;p<n.model.root.listInstances().length;p++){t.addStep(n.model.root.listInstances()[p].name,p,"Uploading Results")}k.openProcess(n.getProcess().getProcessInfo().physicalId,{onSuccess:function(w){var v=w.getActivityByName(j.RESULTS_GENERATION);for(var u=0;u<(v.getSteps().length);u++){t.addStep(v.getSteps()[u].getName(),u,"Results Generation")}},onFailure:function(){}})}else{if(m===false){t.initialize(["Checking Execution Settings","Creating Job","Submitting to station","Starting Cosimulation","Running Cosimulation","Uploading Results","Finalizing"]);for(var p=0;p<n.model.root.listInstances().length;p++){t.addStep(n.model.root.listInstances()[p].name,p,"Uploading Results")}}}if(n===null||typeof(n)===undefined){var o=h.get("exp_not_created");if(o==="exp_not_created"){o="An experiment must be created first."}q.model.addMessage(o,"error","notification");r.end()}else{if(n.process){if(q.spinnerArray.length>0){var o=h.get("exec_08");if(o==="exec_08"){o="The experiment cannot be run until pending tasks are completed."}q.model.addMessage(o,"warning","notification");r.end()}else{f.AFR.CommandsManager.getCommand("SMAMultiScaleCheckCmdHdr").callback=function(){var v=function(){var w=h.get("exec_check");if(w==="exec_check"){w="Execution Check failed."}q.model.addMessage(w,"error","notification");r.runAsCredentials=null};var u=function(){f.AFR.CommandsManager.getCommand("SMAMultiScaleStatusCmdHdr").panel.visibleFlag=true;n.startExecution(r.runAsCredentials);r.runAsCredentials=null};r._checkExecutionSettings(u,v)};r._keepCredentials=true;f.AFR.CommandsManager.getCommand("SMAMultiScaleCheckCmdHdr").begin()}}}},endExecute:function(){if(!this._keepCredentials){this.runAsCredentials=null}else{this._keepCredentials=false}},_checkLocalhost:function(p){var o=false;var m={onComplete:function(){if(!o){o=true;p(true)}},onFailure:function(){if(!o){o=true;p(false)}}};var n=e.createElement("sp-cos");n.getPrivateStationInfo(m)},_checkExecutionSettings:function(n,p){var y=this;var G=this.getFrameWindow();var r=G.RFLEditor;var x=r.model.getExperiment();x.monitoring.setStatus("Checking Execution Settings",-1);var F=widget.editor.getUIFrame().querySelector(".ec-monitoring").parentNode;F.setStepStatus("Checking Execution Settings","Experiment steps","Running");var w=function(H){console.log(H);p()};var o=function(H){n()};var D=[];var C=[];var A=null;var v=null;var q=true;var m=false;var t=false;var u=function(){f.AFR.CommandsManager.getCommand("SMAMultiScaleStatusCmdHdr").panel.visibleFlag=false;var K=0;var Y=e.createElement("div");Y.setAttribute("class","wux-control-inline-container");Y.setStyle("width","100%");var ab=h.get("exec_09");if(ab==="exec_09"){ab="Local host is selected for execution, but there is no private station running."}var P=h.get("exec_10");if(P==="exec_10"){P="You have activities that do not a have a station selected. Check your station selection below."}var ad=h.get("exec_13");if(ad==="exec_13"){ad="No station is available for selection."}var ac=e.createElement("div");var X="";if(!t&&m){var J=e.createElement("div");var V=document.createElement("span");V.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attention ";J.appendChild(V);var N=document.createElement("span");N.textContent=X+" "+ab;J.appendChild(N);ac.appendChild(J)}if(!q){var J=e.createElement("div");var V=document.createElement("span");V.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attention ";J.appendChild(V);var N=document.createElement("span");N.textContent=X+" "+P;J.appendChild(N);ac.appendChild(J)}if(D.length===0){var J=e.createElement("div");var V=document.createElement("span");V.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attention ";J.appendChild(V);var N=document.createElement("span");N.textContent=X+" "+ad;J.appendChild(N);ac.appendChild(J)}ac.inject(Y);for(var U=-1;U<v.length;U++){if(U===-1){var aa=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});aa.inject(Y);var L=new e.Element("div",{html:"<h5>Activity</h5>"}).inject(aa);L.setStyles({display:"inline-block",flex:"50%","padding-right":"5px"});var W=new e.Element("div",{html:"<h5>Station Name</h5>"}).inject(aa);W.setStyles({display:"inline-block",flex:"50%","padding-right":"5px"});continue}if(v[U]["Activity"]==="Experiment"){continue}var T=[];var M=v[U]["StationName"];T[0]={labelItem:M,valueItem:M};for(var S=0;S<D.length;S++){if(D[S]!==M&&(v[U]["Activity"]!=="Results Generation"||D[S]["GeneralInfo"]["os"]==="WINDOWS")&&D[S]["GeneralInfo"]["drmMode"]==="fiper"){var Z={labelItem:D[S]["name"]+" , OS= "+D[S]["GeneralInfo"]["os"],valueItem:D[S]["name"]};T.push(Z)}}if(M!=="{localhost}"&&(t||m)){T.push({labelItem:"{localhost}",valueItem:"{localhost}"})}var aa=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});aa.inject(Y);var H=v[U]["Activity"];if(H==="CSE-Director"){H="Co-simulation Master"}var L=new e.Element("div",{html:H}).inject(aa);L.setStyles({display:"inline-block",flex:"50%","padding-right":"5px"});if(v[U]["drmMode"]==="fiper"){var R=new l({elementsList:T,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false}).inject(aa);R.currentValue=M;C.push({activity:v[U]["Activity"],value:R});R.getContent().setStyle("flex","50%")}else{var W=new e.Element("div",{html:"LSF"}).inject(aa);W.setStyles({display:"inline-block",flex:"50%","padding-right":"5px"})}K++}var Q={};Q.editor=r;Q.title="Station Selection";Q.content=Y;Q.width=551;Q.minWidth=480;var O=165+30*K;Q.height=O;Q.onOK=function(){for(var ag=0;ag<C.length;ag++){var ai=C[ag].activity;var ah=C[ag].value;for(var af=0;af<v.length;af++){if(ai===v[af]["Activity"]){var ae=v[af]["index"];A[ae]["value"]=ah.currentValue;break}}}d.saveExecOptions(x.phID,A,o,w);if(!y.panel.closeButtonClicked){y.panel.close()}y.panel=null};Q.onCancel=function(){if(!y.panel.closeButtonClicked){y.panel.close()}y.panel=null};var I=new g(Q);y.panel=I.getPanel();r.getImmersiveFrame().addWindow(y.panel)};var B=function(I){var K=e.Json.xmlToJson(I);var J=K.StationList;if(J.Station!==null&&J.Station!==undefined){var H=J.Station;if(Array.isArray(H)){D=H}else{D.push(H)}}u()};var z=function(I){var J=I+"/admin/station/query?ActiveOnly=true";var H={method:"GET",onComplete:B,onFailure:function(){w("Private station query failued.")}};c.normalRequest(J,H)};var s=function(){var H=function(I){t=I;if(!t&&m||!q){d.getEEDUrl(z,w)}else{o()}};y._checkLocalhost(H)};var E=function(M){A=M;var L=[];var K,N,H;for(var J=0;J<M.length;J++){if(M[J].title.startsWith("Activity")){N=M[J]["title_display"]}else{if(M[J]["title"]==="StationName"){K=M[J]["value"];H=J}else{if(M[J]["title"]==="drmMode"){var I={};I.Activity=N;I.StationName=K;I.drmMode=M[J]["value"];I.index=H;L.push(I);if(K===""&&N!=="Experiment"&&I.drmMode!=="Lsf"){q=false}else{if(K==="{localhost}"&&N!=="Experiment"&&I.drmMode!=="Lsf"){m=true}}}}}}v=L;s()};d.getExecOptions(x.phID,E,w)}});return a});define("DS/SMAMSWebUI/SMAMultiScaleBehSelCmd",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/Controls/Button","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/ComboBox","DS/Controls/TooltipModel","DS/WebappsUtils/WebappsUtils"],function(e,c,k,h,j,g,b,f,l,i,d){var a=c.extend({init:function(m){this.panel=null;this._parent(m,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},_getUI:function(){var u=this;var D=u.getFrameWindow();var r=D.RFLEditor;var p=r.model;var n=p.getRoot();var t=p.getExperiment();var x=n.listInstances();var w=e.createElement("div");w.setAttribute("class","wux-control-inline-container");w.setStyle("width","100%");w.setStyle("margin","auto");var v=new b({useAsyncPreExpand:true,shouldBeEditable:function(){return false},shouldAcceptDrag:function(){return false}});var B=0;for(var A=0;A<x.length;A++){var C=x[A];var s=x[A].getReference().listBehaviors();if(s.length===0){B++;if(B===x.length){p.addMessage("No abstractions available to be selected.","warning","notification");u.end();return}}var E=[];var q="none";E.push({valueItem:"none",labelItem:"Select an abstraction"});for(var y=0;y<s.length;y++){if(s[y]===C.getSelectedBehavior()){q=s[y].getID()}}var m=true;v.addChild([{inst:C,currentBeh:q,grid:{instName:C.getInfo().name,beh:"",param:""}}])}var o={selection:{canMultiSelect:false,cells:false,columnHeaders:false,enableListSelection:false,nodes:false,rowHeaders:false,toggle:false,unselectAllOnEmptyArea:true},treeDocument:v,defaultCellHeight:35,apiVersion:2,columns:[{dataIndex:"tree",isHidden:true},{text:"Instance",dataIndex:"instName",width:"auto",isDraggable:false},{text:"Abstraction",dataIndex:"beh",width:"auto",isDraggable:false,onCellRequest:function(K){if(!K.isHeader){var J=K.nodeModel.options.inst;var H=J.getReference().listBehaviors();var G=[];G.push({valueItem:"none",labelItem:"Select an abstraction"});for(var F=0;F<H.length;F++){G.push({valueItem:H[F].getID(),labelItem:H[F].getInfo().name})}var I=new l({elementsList:G,enableSearchFlag:false,actionOnClickFlag:false});I.currentValue=K.nodeModel.options.currentBeh;I.addEventListener("change",function(){K.nodeModel.options.currentBeh=I.currentValue});K.cellView.getContent().setContent(I)}}},{text:"Parameters",dataIndex:"param",width:"100",onCellRequest:function(I){if(!I.isHeader){var G=new j({allowUnsafeHTMLLabel:false,label:"   ",emphasize:"primary",icon:d.getWebappsBaseUrl()+"SMAMSWebUI/assets/icons/32/I_SMAMSParameter.png",type:"standard",displayStyle:"lite"});G.getContent().setStyle("text-align","center");G.getContent().setStyle("width","100%");G.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Edit Parameters"});G.addEventListener("click",(function(K){if(K.target.parentNode.hasAttribute("disabled")){return}K.target.parentElement.removeAttribute("focused");var J=WUX.AFR.CommandsManager.getCommand("SMAMultiScaleParamCmdHdr");J.selectedElement=this.view;J.returnToCommand=u;J.begin()}).bind(I.nodeModel.options.inst),u);var F=I.nodeModel.options.inst.getSelectedBehavior();if(F){var H=F.getDefaultParameters();if(typeof H===undefined||!e.is(H)||Object.keys(H).length===0){G.disabled=true}}else{G.disabled=true}I.cellView.getContent().setContent(G)}},isDraggable:false,isSortable:false}]};var z=35*(v.getRoots().length+1);o.height=z+"px";u._treeListView=new g(o);u._treeListView.inject(w);w.querySelector(".wux-layouts-gridengine").style.height=(z+35)+"px";return w},execute:function(){var t=this;var w=t.getFrameWindow();var u=w.RFLEditor;u.hideContextualBar();var r=u.model;var o=r.root;var n=r.getExperiment();if(n===null||typeof(n)===undefined){var v=k.get("exp_not_created");if(v==="exp_not_created"){v="An experiment must be created first."}r.addMessage(v,"warning","notification");t.end();return}var s=o.listInstances();if(!s.length){var q=k.get("exp_04");if(q==="exp_04"){q="The experiment does not contain any components."}r.addMessage(q,"warning","notification");t.end();return}var p=t._getUI();var y={};y.editor=u;y.title="Abstraction Selection";y.content=p;y.width=551;y.minWidth=350;var x=105+35*(t._treeListView.getRoots().length);y.height=x;y.onOK=function(){t._treeListView.getRoots().forEach(function(z){var B=z.options.inst;var A=B.reference.getBehavior(z.options.currentBeh);if(A&&A!==B.getSelectedBehavior()){n.addBehavior1(B.phID,A.phID,null,function(){},function(){})}else{if(!A){n.removeBehavior1(B.phID,function(){},function(){})}}});t.end()};y.onCancel=function(){t.end()};var m=new h(y);t.panel=m.getPanel();u.getImmersiveFrame().addWindow(t.panel)},endExecute:function(){var m=this;if(m.panel){if(!m.panel.closeButtonClicked){m.panel.close()}m.panel=null}}});return a});
/*! Copyright 2016 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleEditCompCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/Core/Core","DS/UIKIT/Form","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/Controls/Expander","DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/ComboBox","DS/Tree/TreeListView","DS/Utilities/Array","DS/WebappsUtils/WebappsUtils","DS/RFLModelerWeb/RFL_EditorPanel","DS/Controls/Button","DS/Controls/TooltipModel","DS/RFLModelerWeb/RFL_Connector","DS/RFLModelerWeb/RFL_ThemeBase","DS/ZipJS/zip-fs","DS/SMAMSExperimentServices/Behavior","DS/SMAProcWebCMMUtils/SMAJSCMMUtils"],function(g,o,d,h,f,n,u,s,k,j,q,e,b,p,i,l,a,t,m,c){var r=o.extend({init:function(v){this.panel=null;this.connPanel=null;this.connPanel2=null;this.behPanel=null;this.connTreeList=null;this.behTreeList=null;this.selBehForm=null;this._parent(v,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var x=this;var y=x.getFrameWindow();var w=y.RFLEditor;var v=w.model;var z=w.gr.selection.first;if(z!==null){x._elementSelected(z)}else{v.addMessage("You must select a component first.","warning","notification");x.end()}},_getCompDiv:function(x,w){var z={};w.setStyle("width","100%");var v=new g.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row"});v.inject(w);var y=new g.Element("div",{html:"Name: "}).inject(v);y.setStyles({display:"inline-block",flex:"40%","padding-right":"5px"});z.nameLineEditor=new u({value:x.getInfo().name,pattern:"[A-Za-z0-9_\\-\\s]+",requiredFlag:true});z.nameLineEditor.inject(v);z.nameLineEditor.getContent().setStyles({display:"inline-block",flex:"60%"});var B=new g.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row"});B.inject(w);var A=new g.Element("div",{html:"Description: "}).inject(B);A.setStyles({display:"inline-block",flex:"40%","padding-right":"5px"});z.descLineEditor=new s({value:x.getInfo().description,nbRows:2});z.descLineEditor.inject(B);z.descLineEditor.getContent().setStyles({display:"inline-block",flex:"60%"});return z},_getConDiv:function(F,D,G,x){var E=this;var B=D.model;var H=g.createElement("div");H.setAttribute("class","wux-control-inline-container");H.setStyle("width","100%");var y=g.createElement("div");y.setAttribute("class","wux-control-inline-container");y.setStyle("width","100%");var J=g.createElement("div");J.setAttribute("class","wux-control-inline-container");J.setAttribute("style","text-align: center;color: #b4b6ba;display:none;width:100%");y.inject(H);J.inject(H);var z=function(M){var N=new p({allowUnsafeHTMLLabel:false,label:M,icon:"plus",type:"standard",displayStyle:"lite"});N.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Add Port"});N.addEventListener("click",function(O){O.target.parentElement.removeAttribute("focused");E._disablePanel();E._createConnectorPanel(G)});return N};var v=z("Click to add port. No ports to display.");v.inject(J);var L={selection:{canMultiSelect:false,cells:false,columnHeaders:false,enableListSelection:false,nodes:false,rowHeaders:false,toggle:false,unselectAllOnEmptyArea:true},defaultCellHeight:35,apiVersion:2,columns:[{text:"Name",dataIndex:"name",width:"auto",isDraggable:false},{text:"Causality",dataIndex:"causality",width:"75",isDraggable:false},{text:"Type",dataIndex:"type",width:"auto",isDraggable:false},{text:" ",dataIndex:"edit",width:"85",onCellRequest:function(P){var O=z(" ");O.inject(P.cellView.getContent());if(!P.isHeader){var N=new p({allowUnsafeHTMLLabel:false,label:"   ",icon:"minus",type:"standard",displayStyle:"lite"});N.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Remove Port"});N.addEventListener("click",function(S){S.target.parentElement.removeAttribute("focused");var Q=C.options.height;Q=parseInt(Q.substring(0,Q.indexOf("px")))-35;Q+="px";C.options.height=Q;H.querySelector(".wux-datagrid").style.height=Q;D.removeConnector1(P.nodeModel.options.grid.name,function(){},function(){});P.nodeModel.remove();var R=C.getManager().getRoots();if(R.length===0){y.style.display="none";J.style.display="block"}});N.inject(P.cellView.getContent());var M=new p({allowUnsafeHTMLLabel:false,label:"   ",icon:"pencil",type:"standard",displayStyle:"lite"});M.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Edit Port"});M.addEventListener("click",function(Q){Q.target.parentElement.removeAttribute("focused");E._disablePanel();E._editConPanel(D,G,D.getConnector(P.nodeModel.options.label),C)});M.inject(P.cellView.getContent())}},isDraggable:false,isSortable:false}],roots:[]};var K=35*(x.length+1);if(K>280){K=280}K+="px";L.height=K;for(var A=0;A<x.length;A++){var w=D.getConnector(x[A]);var I="Input";if(w.getCausality()==="O"){I="Output"}else{if(w.getCausality()==="N"){I="Neutral"}}L.roots.push({label:w.getInfo().name,grid:{name:w.getInfo().name,type:w.getType(),causality:I}})}var C=new j(L);C.getManager().hideColumn(0);C.options.columns[0].text="";C.getManager().getDocument().options.shouldAcceptDrag=function(){return false};C.getManager().getDocument().options.shouldAcceptDrop=function(){return false};C.inject(y);H.querySelector(".wux-datagrid").style.height=K;if(!x.length){y.style.display="none";J.style.display="block"}E.connTreeList=C;return H},_getBehDiv:function(x,G,E,H){var F=this;var C=E.model;var w=C.getExperiment();var J=g.createElement("div");J.setAttribute("class","wux-control-inline-container");J.setStyle("width","100%");var y=g.createElement("div");y.setAttribute("class","wux-control-inline-container");y.setStyle("width","100%");var I=g.createElement("div");I.setAttribute("class","wux-control-inline-container");I.setAttribute("style","text-align: center;color: #b4b6ba;display:none;width:100%");y.inject(J);I.inject(J);var A=function(N,Q){var P=new p({allowUnsafeHTMLLabel:false,label:N,icon:"plus",type:"standard",displayStyle:"lite"});P.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Add Abstraction"});var M=g.createElement("label");M.setAttribute("for","myFileInput");M.setAttribute("style","display: none;");M.inject(Q);var O=g.createElement("input");O.setAttribute("id","myFileInput");O.setAttribute("type","file");O.setAttribute("accept",".fmu,.simfmu,.3dfmu");O.setAttribute("multiple",false);O.setAttribute("style","display: none;");O.inject(Q);O.onchange=function(){if(this.files){var S={value:this.files[0]};if(!c.isValidTitle(S.value.name.slice(0,S.value.name.lastIndexOf(".")))){G.model.addMessage("Abstraction name cannot be empty or contain special characters.","warning","notification");return}if(S.value&&S.value.name.search(".fmu")!==-1&&S.value.name.indexOf(".fmu")+4===S.value.name.length){S.type="fmu";S.path="DS/SMAMSWeb/SMAFmuBehavior";S.name=this.files[0].name.slice(0,this.files[0].name.indexOf(".fmu"));y.style.display="block";I.style.display="none";C.isValidFmu(S).then(function(T){F._openFile.call(this,T,H,D,J,F)})["catch"](function(T){C.addMessage(T,"error","notification")})}else{if(S.value.name.search(".simfmu")!==-1&&S.value.name.indexOf(".simfmu")+7===S.value.name.length){S.type="sim";S.path="DS/SMAMSWeb/SMASimulationBehavior";y.style.display="block";I.style.display="none";S.name=this.files[0].name.slice(0,this.files[0].name.indexOf(".simfmu"));F._openFile.call(this,S,H,D,J,F)}else{if(S.value.name.search(".3dfmu")!==-1&&S.value.name.indexOf(".3dfmu")+6===S.value.name.length){S.type="sim";S.path="DS/SMAMSWeb/SMASimulationBehavior";S.is3dfmu=true;y.style.display="block";I.style.display="none";S.name=this.files[0].name.slice(0,this.files[0].name.indexOf(".3dfmu"));F._openFile.call(this,S,H,D,J,F)}else{var R=f.get("sys_08");if(R==="sys_08"){R="The abstraction could not be added because it is invalid."}E.model.addMessage(R,"error","notification")}}}}};P.addEventListener("focus",function(R){R.target.parentElement.removeAttribute("focused");R.target.blur();M.click()});P.inject(Q)};A("Click to add abstraction. No abstractions to display.",I);var z="85";if(localStorage.getItem("EXPCDebugModeOn")==="true"){z="100"}var L={selection:{canMultiSelect:false,cells:false,columnHeaders:false,enableListSelection:false,nodes:false,rowHeaders:false,toggle:false,unselectAllOnEmptyArea:true},defaultCellHeight:35,apiVersion:2,columns:[{text:"Name",dataIndex:"name",width:"auto",isDraggable:false},{text:"Type",dataIndex:"type",width:"75",isDraggable:false},{text:" ",dataIndex:"edit",width:z,isDraggable:false,isSortable:false,onCellRequest:function(P){var O=A(" ",P.cellView.getContent());if(!P.isHeader){var N=new p({allowUnsafeHTMLLabel:false,label:"   ",icon:"minus",type:"standard",displayStyle:"lite"});N.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Remove Abstraction"});N.addEventListener("click",function(V){V.target.parentElement.removeAttribute("focused");var S=D.options.height;S=parseInt(S.substring(0,S.indexOf("px")))-35;S+="px";D.options.height=S;J.querySelector(".wux-datagrid").style.height=S;var U=E.getBehavior(P.nodeModel.options.value);var W=0;var X=function(){P.nodeModel.remove();if(D.getManager().getRoots().length===0){y.style.display="none";I.style.display="block"}if(J.parentNode){var Y=F.panel.getContent().querySelector(".sel-beh-tree-list");if(Y){Y.textContent="";F.selBehForm=F._getSelBehDiv(H,Y)}}};var T=function(){W--;if(W===0){E.removeBehavior1(U,X,function(){})}};for(var R=0;R<E.instances.length;R++){if(E.instances[R].getSelectedBehavior()===U){W++;w.removeBehavior1(E.instances[R].phID,T,function(){})}}if(W===0){E.removeBehavior1(U,X,function(){})}});N.inject(P.cellView.getContent());var M=new p({allowUnsafeHTMLLabel:false,label:"   ",icon:"pencil",type:"standard",displayStyle:"lite"});M.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Edit Abstraction"});M.addEventListener("click",function(R){R.target.parentElement.removeAttribute("focused");F._disablePanel();F._editBehPanel(E,H,E.getBehavior(P.nodeModel.options.value),D)});M.inject(P.cellView.getContent());if(localStorage.getItem("EXPCDebugModeOn")==="true"){var Q=new p({allowUnsafeHTMLLabel:false,label:"   ",icon:"download",type:"standard",displayStyle:"lite"});Q.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Download Abstraction"});Q.addEventListener("click",function(U){U.target.parentElement.removeAttribute("focused");var S=E.getBehavior(P.nodeModel.options.value);var T=".fmu";if(S.sim){T=".simfmu"}var W=S.getInfo().name+T;var V=function(Y){var X=document.createElement("a");document.body.appendChild(X);X.setAttribute("style","display: none");X.href=window.URL.createObjectURL(Y);X.download=W;X.click();window.URL.revokeObjectURL(window.URL.createObjectURL(Y));document.body.removeChild(X)};var R={};R.physicalId=S.getID();R.serverUrl=G.model.serviceUrl;R.onComplete=function(Y){if(T===".simfmu"){var Z=false;if(S.getThumbnail()&&S.getThumbnail().file){Z=true}var X={};X.physicalId=S.getID();X.serverUrl=G.model.serviceUrl;X.onComplete=function(aa){t.createWriter(new t.BlobWriter("application/zip"),function(ab){ab.add("sim.SMASim",new t.BlobReader(Y),function(){ab.add("modelDescription.xml",new t.BlobReader(new Blob([aa])),function(){if(Z){ab.add("model.png",new t.BlobReader(S.getThumbnail().file),function(){ab.close(V)})}else{ab.close(V)}})})},function(){console.log("ERROR")})};X.onFailure=function(){console.log("ERROR")};m.downloadModelDescription(X)}else{V(Y)}};R.onFailure=function(){console.log("ERROR")};m.downloadFmu(R)});Q.inject(P.cellView.getContent())}}}}],roots:[]};var K=35*(x.length+1);if(K>280){K=280}K+="px";L.height=K;for(var B=0;B<x.length;B++){var v="FMU";if(x[B].sim){v="SIM"}L.roots.push({label:"",grid:{name:x[B].getInfo().name,type:v},value:x[B].getID()})}var D=new j(L);D.options.columns[0].text="";D.getManager().hideColumn(0);D.getManager().getDocument().options.shouldAcceptDrag=function(){return false};D.getManager().getDocument().options.shouldAcceptDrop=function(){return false};D.inject(y);J.querySelector(".wux-datagrid").style.height=K;if(!x.length){y.style.display="none";I.style.display="block"}F.behTreeList=D;return J},_getInstDiv:function(A,x){var w={};x.setStyle("width","100%");var v=new g.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row"});v.inject(x);var y=new g.Element("div",{html:"Instance Name: "}).inject(v);y.setStyles({display:"inline-block",flex:"40%","padding-right":"5px"});w.nameLineEditor=new u({value:A.getInfo().name,pattern:"[A-Za-z0-9_\\-\\s]+",requiredFlag:true});w.nameLineEditor.inject(v);w.nameLineEditor.getContent().setStyles({display:"inline-block",flex:"60%"});var B=new g.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row"});B.inject(x);var z=new g.Element("div",{html:"Instance Description: "}).inject(B);z.setStyles({display:"inline-block",flex:"40%","padding-right":"5px"});w.descLineEditor=new s({value:A.getInfo().description,nbRows:2});w.descLineEditor.inject(B);w.descLineEditor.getContent().setStyles({display:"inline-block",flex:"60%"});return w},_getSelBehDiv:function(A,w){var y={};var B=A.getReference().listBehaviors();var E=A.getSelectedBehavior();var v=A.getReference().model.getExperiment();var D=[];D.push({valueItem:"none",labelItem:"Select an abstraction"});for(var C=0;C<B.length;C++){D.push({valueItem:B[C].getID(),labelItem:B[C].getInfo().name})}var x=new g.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row"});x.inject(w);var z=new g.Element("div",{html:"Selected Abstraction: "}).inject(x);z.setStyles({display:"inline-block",flex:"40%","padding-right":"5px"});y.selBehCombo=new k({elementsList:D,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false}).inject(x);y.selBehCombo.getContent().setStyle("flex","60%");if(E){y.selBehCombo.currentValue=E.getID()}if(B.length===0){x.setStyles({display:"none"})}return y},_createConnectorPanel:function(C){var z=C.reference;var A=this;var E=A.getFrameWindow();var B=E.RFLEditor;var D=["Real","Region","Integer","Boolean","String","Enumeration"],y={};var x=new h({className:"vertical",fields:[{type:"text",name:"connectorName",label:"Name"},{type:"textarea",name:"connectorDesc",label:"Description"},{type:"select",name:"type",label:"Type",value:"Select Type",size:7,options:[{label:D[0],value:D[0]},{label:D[1],value:D[1]},{label:D[2],value:D[2]},{label:D[3],value:D[3]},{label:D[4],value:D[4]},{label:D[5],value:D[5]}]},{type:"select",name:"causality",label:"Causality",value:"Select Causality",className:"causality",size:3,options:[{label:"Input",value:"I"},{label:"Output",value:"O"}]}]});x.getContent().querySelector(".causality").parentNode.style.display="none";x.addEvent("onChange",function(){if(x.getValue("type")){if(x.getValue("type")==="Region"){x.getContent().querySelector(".causality").parentNode.style.display="none";x.getField("causality").value="N"}else{x.getContent().querySelector(".causality").parentNode.style.display="block"}}else{x.getContent().querySelector(".causality").parentNode.style.display="none"}});var w=g.createElement("div");w.setAttribute("class","wux-control-inline-container");w.setStyle("width","100%");x.inject(w);var F={};F.editor=B;F.title="Port";F.content=w;F.width=351;F.height=560;F.onOK=function(){var K=1,P=1,J=1;var H=Object.keys(z.getListConnectors());for(var L=0;L<H.length;L++){if(z.getConnector(H[L]).causality==="I"){K++}else{if(z.getConnector(H[L]).causality==="O"){P++}else{if(z.getConnector(H[L]).causality==="N"){J++}}}}var N=x.getValue("causality");if(N===""&&x.getContent().querySelector(".causality").parentNode.style.display==="none"){N="N"}var M=x.getValue("connectorName");if(M&&x.getValue("type")&&N!==""){for(var O=0;O<H.length;O++){if(M===H[O]){x.getField("connectorName").focus();x.getField("connectorName").value="";B.model.addMessage("You must enter a unique port name.","warning","notification");return}}if(N==="I"){y.attach=2;y.offset=17*(K-0.5)}else{if(N==="O"){y.attach=3;y.offset=17*(P-0.5)}else{if(N==="N"){y.attach=0;y.offset=17*(J-0.4)}}}var R={};R.name=M;R.type=x.getValue("type");R.causality=N;R.position=y;R.valueRef="";R.mangledName="";R.phID=null;R.typeID=z.model.typeRefs[R.type][0];R.parent=z;R.description=x.getValue("connectorDesc");var G=new l(R);var I={message:"Adding Port...",exclusive:false};B.addSystemSpinner(I);A.connPanel.disabled=true;var Q=function(){if(!A.connPanel.closeButtonClicked){A.connPanel.close()}A.connPanel=null;B.removeSystemSpinner(I);var T=A.panel.getContent().querySelector(".con-tree-list");T.textContent="";var S=Object.keys(z.getListConnectors());A._getConDiv(B,z,C,S).inject(T);A._enablePanel();if(G.view){var V=G.view.view.display.elt.querySelector("text");if(G.view.attach===2){var U=V.getBBox().width/2+Number(V.getAttribute("x"));V.setAttribute("transform","rotate(180 "+U+",0)")}V.style.visibility="visible"}};z.addConnectors([G],Q,Q)}else{if(!x.getValue("connectorName")){x.getField("connectorName").focus()}else{if(!x.getValue("type")){x.getField("type").focus()}else{if(!N){x.getField("causality").focus()}}}}};F.onCancel=function(){if(!A.connPanel.closeButtonClicked){A.connPanel.close()}A.connPanel=null;A._enablePanel()};F.dontMaximize=true;var v=new b(F);A.connPanel=v.getPanel();B.getImmersiveFrame().addWindow(A.connPanel);x.getField("connectorName").focus()},_editBehPanel:function(O,M,A,z){var B=this;var P=B.getFrameWindow();var y=P.RFLEditor;var D=g.createElement("div");D.setAttribute("class","wux-control-inline-container");D.setStyle("width","100%");var J="";if(A.fmu){J="FMU"}else{if(A.sim){J="SIM"}}var v=new h({className:"vertical",fields:[{type:"text",name:"behaviorName",label:"Name",value:A.getInfo().name},{type:"textarea",name:"behaviorDesc",label:"Description",value:A.getInfo().description},{type:"text",name:"behaviorType",label:"Type",value:J,disabled:true}]});v.getContent().querySelectorAll(".form-group")[2].style.marginBottom="5px";var I=g.createElement("div");I.setAttribute("style","float:left;");var C=g.createElement("div");C.setAttribute("class","h5");C.textContent="Thumbnail";var H=g.createElement("div");H.setAttribute("class","thumbnail-div");var E=A.getThumbnail();var Q=g.createElement("IMG");Q.setAttribute("style","margin-right: 10px;");Q.inject(H);if(E&&E.file){var N=URL.createObjectURL(E.file);Q.src=N;Q.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:" ",shortHelpImage:N})}else{Q.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"No thumbnail present"})}var L=new p({allowUnsafeHTMLLabel:false,label:"   ",icon:"plus-circle",iconSize:"2x",type:"standard",displayStyle:"lite"}).inject(H);L.getContent().setAttribute("style","margin-top: 5px;");L.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Add Thumbnail"});var G=new p({allowUnsafeHTMLLabel:false,label:"   ",icon:"minus-circle",iconSize:"2x",type:"standard",displayStyle:"lite"}).inject(H);G.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Remove Thumbnail"});var F=g.createElement("label");F.setAttribute("for","myFileInput1");F.setAttribute("style","display: none;");F.inject(H);var x=g.createElement("input");x.setAttribute("id","myFileInput1");x.setAttribute("type","file");x.setAttribute("multiple",false);x.setAttribute("accept",".png");x.setAttribute("style","display: none;");x.inject(H);x.onchange=function(){if(this.files&&this.files.length&&this.files[0].type&&this.files[0].type==="image/png"){var T={};T.file=this.files[0];var S=URL.createObjectURL(T.file);Q.src=S;A.setThumbnail(T,true,function(){},function(){});if(M.getSelectedBehavior()===A){M.setThumbnail(T.file);var U=M.getThumbnail();if(U){var S=URL.createObjectURL(U);Q.src=S;Q.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:" ",shortHelpImage:S})}else{Q.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"No Thumbnail Present"})}}M.buildNode()}else{var R=f.get("sys_09");if(R==="sys_09"){R="Select a .PNG file!"}O.model.addMessage(R,"error","notification")}};L.addEventListener("click",function(R){R.target.removeAttribute("focused");R.target.blur();F.click()});G.addEventListener("click",function(R){R.target.removeAttribute("focused");A.removeThumbnail(function(){},function(){});if(M.getSelectedBehavior()===A){M.removeThumbnail()}M.buildNode();Q.src="";Q.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"No Thumbnail Present"})});C.inject(I);H.inject(I);v.inject(D);I.inject(D);var K={};K.editor=y;K.title="Abstraction";K.content=D;K.width=351;K.height=375;K.onOK=function(){var V=v.getValue("behaviorName");if(!V.trim()||!c.isValidTitle(V)){y.model.addMessage("Abstraction name cannot be empty or contain special characters.","warning","notification");v.getField("behaviorName").focus();return}else{z.getManager().unselectAll();var S=v.getValue("behaviorDesc");A.setInfo({name:V,description:S},function(){},function(){});if(!B.behPanel.closeButtonClicked){B.behPanel.close()}B.behPanel=null;if(B.panel.getContent()){var U=B.panel.getContent().querySelector(".beh-tree-list");U.textContent="";var R=O.listBehaviors();B._getBehDiv(R,y,O,M).inject(U);B._enablePanel();var T=B.panel.getContent().querySelector(".sel-beh-tree-list");T.textContent="";B.selBehForm=B._getSelBehDiv(M,T)}}};K.onCancel=function(){z.getManager().unselectAll();if(!B.behPanel.closeButtonClicked){B.behPanel.close()}B.behPanel=null;B._enablePanel()};K.dontMaximize=true;var w=new b(K);B.behPanel=w.getPanel();y.getImmersiveFrame().addWindow(B.behPanel);v.getField("behaviorName").focus()},_editConPanel:function(A,D,x,z){var B=this;var E=B.getFrameWindow();var C=E.RFLEditor;var y="Input";if(x.causality==="O"){y="Output"}else{if(x.causality==="N"){y="Neutral"}}var w=g.createElement("div");w.setAttribute("class","wux-control-inline-container");w.setStyle("width","100%");var F=new h({className:"vertical",fields:[{type:"text",name:"connectorName",label:"Name",value:x.getInfo().name},{type:"textarea",name:"connectorDesc",label:"Description",value:x.getInfo().description},{type:"text",name:"connectorCausality",label:"Causality",value:y,disabled:true},{type:"text",name:"connectorType",label:"Type",value:x.getType(),disabled:true}]}).inject(w);var G={};G.editor=C;G.title="Port";G.content=w;G.width=351;G.height=380;G.onOK=function(){var L=F.getValue("connectorName");if(!L.trim()){F.getField("connectorName").focus();return}else{z.getManager().unselectAll();var J=Object.keys(A.getListConnectors());for(var H=0;H<J.length;H++){if(L===J[H]&&F.getValue("connectorName")!==x.getInfo().name){F.getField("connectorName").focus();F.getField("connectorName").value="";C.model.addMessage("You must enter a unique port name.","warning","notification");return}}var I=F.getValue("connectorDesc");x.setInfo({name:L,description:I});if(!B.connPanel2.closeButtonClicked){B.connPanel2.close()}B.connPanel2=null;var K=B.panel.getContent().querySelector(".con-tree-list");K.textContent="";var J=Object.keys(A.getListConnectors());B._getConDiv(C,A,D,J).inject(K);B._enablePanel()}};G.onCancel=function(){z.getManager().unselectAll();if(!B.connPanel2.closeButtonClicked){B.connPanel2.close()}B.connPanel2=null;B._enablePanel()};G.dontMaximize=true;var v=new b(G);B.connPanel2=v.getPanel();C.getImmersiveFrame().addWindow(B.connPanel2);F.getField("connectorName").focus()},_disablePanel:function(){var v=this;if(v.panel){v.panel.disabled=true}},_enablePanel:function(){var v=this;if(v.panel){v.panel.disabled=false}},_openFile:function(y,B,D,v,x){var z=B.getReference();var A=z.model.getEditor();var C=Object.keys(z.getListConnectors()).length;var w={message:"Adding Abstraction...",exclusive:false};A.addSystemSpinner(w);z.addBehavior1(y.name,y.path,y.type,null,"",(function(G){if(y.is3dfmu){G.is3dfmu=true}G.addFile(y.value,function(){if(x.panel&&x.panel.getContent()){var K=x.panel.getContent().querySelector(".sel-beh-tree-list");K.textContent="";x.selBehForm=x._getSelBehDiv(B,K);var H=Object.keys(z.getListConnectors());if(H.length!==C){var I=x.panel.getContent().querySelector(".con-tree-list");I.textContent="";var J=x.getFrameWindow().RFLEditor;x._getConDiv(J,z,B,H).inject(I)}}});var F="FMU";if(G.sim){F="SIM"}var E=this.options.height;E=parseInt(E.substring(0,E.indexOf("px")))+35;if(E>280){E=280}E+="px";this.options.height=E;if(v.querySelector(".wux-datagrid")){v.querySelector(".wux-datagrid").style.height=E}this.getManager().addRoot({label:"",grid:{name:G.getInfo().name,type:F},value:G.getID()});A.removeSystemSpinner(w)}).bind(D),function(){A.removeSystemSpinner(w)})},_elementSelected:function(I){var L=I.data.RFLComponent;var N=L.getReference();var A=this;var O=A.getFrameWindow();var x=O.RFLEditor;var z=N.model.experiment;x.hideContextualBar();if(L.isDeleted){A.end();return}var D=g.createElement("div");D.setAttribute("class","wux-control-inline-container");D.setStyle("width","98%");var E=g.createElement("div").inject(D);E.setAttribute("class","wux-control-inline-container");E.setStyle("width","100%");var F=A._getCompDiv(N,E);var H=Object.keys(N.getListConnectors());var J=A._getConDiv(x,N,L,H);J.setAttribute("class","con-tree-list");new n({allowUnsafeHTMLHeader:false,header:"Ports",body:J,}).inject(D);var C=N.listBehaviors();var w=A._getBehDiv(C,x,N,L);w.setAttribute("class","beh-tree-list");new n({allowUnsafeHTMLHeader:false,header:"Abstractions",body:w,}).inject(D);var M=g.createElement("div");M.setAttribute("class","wux-control-inline-container");M.setStyle("width","100%");var K=g.createElement("div");K.setAttribute("class","inst-tree-list wux-control-inline-container");K.setStyle("width","100%");var B=g.createElement("div");B.setAttribute("class","sel-beh-tree-list wux-control-inline-container");B.setStyle("width","100%");K.inject(M);B.inject(M);var y=A._getInstDiv(L,K);A.selBehForm=A._getSelBehDiv(L,B);new n({allowUnsafeHTMLHeader:false,header:"Instance - "+L.getInfo().name,body:M,expandedFlag:true,}).inject(D);var G={};G.editor=x;G.title="Component";G.content=D;G.width=455;G.height=410;G.onOK=function(){if(!F.nameLineEditor.value||!y.nameLineEditor.value||!A.selBehForm){return}else{var T=F.nameLineEditor.value;var R="";if(F.descLineEditor.value){R=F.descLineEditor.value}N.setInfo({name:T,description:R},function(){},function(){});var S=y.nameLineEditor.value;var Q="";if(y.descLineEditor.value){Q=y.descLineEditor.value}L.setInfo({name:S,description:Q},function(){},function(){});var P=N.getBehavior(A.selBehForm.selBehCombo.currentValue);if(P&&P!==L.getSelectedBehavior()){z.addBehavior1(L.phID,P.phID,null,function(){},function(){})}else{if(!P){z.removeBehavior1(L.phID,function(){},function(){})}}A.end()}};G.onCancel=function(){A.end()};G.onMinimize=function(){var P=35*(H.length+2);if(P>280){P=280}P=P+"px";J.querySelector(".wux-datagrid").style.height=P;var Q=35*(C.length+2);if(Q>280){Q=280}Q=Q+"px";w.querySelector(".wux-datagrid").style.height=Q};var v=new b(G);A.panel=v.getPanel();x.getUIFrame().querySelector("#maskDiv").style.display="block";x.getImmersiveFrame().addWindow(A.panel);G.onMinimize()},endExecute:function(){var w=this;var x=w.getFrameWindow();var v=x.RFLEditor;v.getUIFrame().querySelector("#maskDiv").style.display="none";v.clearSelection();if(w.panel){if(!w.panel.closeButtonClicked){w.panel.close()}w.panel=null}if(w.connPanel){if(!w.connPanel.closeButtonClicked){w.connPanel.close()}w.connPanel=null}if(w.connPanel2){if(!w.connPanel2.closeButtonClicked){w.connPanel2.close()}w.connPanel2=null}if(w.behPanel){if(!w.behPanel.closeButtonClicked){w.behPanel.close()}w.behPanel=null}if(w.behTreeList){w.behTreeList=null}if(w.connTreeList){w.connTreeList=null}}});return r});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleSearchExpCmd",["UWA/Core","DS/ApplicationFrame/Command"],function(c,a){var b=a.extend({init:function(d){this._parent(d,{isAsynchronous:true,isEnabled:true,mode:"exclusive"})},_onChange:function(d,e,h){var g=d.getSelectedObjectIds();var f=g[g.length-1];e.eventHandler.openSimulation(f,h)},execute:function(){var f=this;var e=f.getFrameWindow();var d=e.RFLEditor;d.hideContextualBar();require(["DS/TransientWidget/TransientWidget"],function(h){if(h.isWidgetOpen()){d.model.addMessage("Pin the widget to the dashboard to use this feature.","warning","notification")}var g=c.createElement("sp-search");g.multiSelect=false;g.plmTypes="Simulation";if(g.search){g.search("")}g.addEventListener("change",(function(){f._onChange(g,d)}).bind(g,f));f.end()})}});return b});
/*! Copyright 2015 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMSInteraction",["UWA/Core","DS/ApplicationFrame/Command","DS/SMAMSExperimentServices/Behavior","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/Controls/Toggle","DS/Controls/Expander","DS/Controls/TooltipModel","DS/Visualization/Node3D","DS/Visualization/ThreeJS_R57","DS/WebappsUtils/WebappsUtils"],function(e,a,c,l,g,b,n,k,j,i,f,h,d){var m=a.extend({init:function(o){this.panel=null;this._parent(o,{isAsynchronous:true,isEnabled:true,mode:"exclusive"})},setOptions:function(o,q,p){this.model=o;this.intText=q;this.link=p},_locate:function(q,t,s){var r=0;for(var p=0;p<q.length;p++){for(var o=0;o<t.length;o++){if(q[p].name===t[o]&&q[p].causality===s){r++}if(r===t.length){return true}}}return false},compatibleTypes:function(){var B=this;var x=B.link;var u=x.view;var w=[];var y=B.model.getExperiment();var H=x.comp1;var G=x.comp2;var S=H.getSelectedBehavior();var P=G.getSelectedBehavior();if(!S||!P){return false}var Q=S.getFieldVariables();var O=P.getFieldVariables();var C=["mass","force"];var I=["displacement","velocity"];var N=["displacement","velocity"];var r=["mass","traction_vector"];var R=["heat_flux","heat_capacitance"];var A=["temperature"];var v=["temperature"];var K=["heat_flux","heat_capacitance"];var p=["massInverse_operator","ricur","velocity","rotational_velocity"];var J=["interface_force","interface_moment","displacement","rotation","velocity","rotational_velocity","acceleration","rotational_acceleration"];var F=["interface_force","interface_moment","displacement","rotation","velocity","rotational_velocity","acceleration","rotational_acceleration"];var M=["mass","ricur","velocity","rotational_velocity"];var t=["mass","ricur","force","moment"];var E=["displacement_predictor","velocity","acceleration","rotation_predictor","rotational_velocity","rotational_acceleration"];var L=["displacement","velocity","acceleration","rotation","rotational_velocity","rotational_acceleration"];var q=["mass","ricur","force","moment"];var o=["temperature"];var z=["heat_flux"];var s=["heat_flux"];var D=["temperature"];if(u){u.cl1.c.data.regionType=[];u.cl2.c.data.regionType=[]}if(this._locate(Q,C,"input")&&this._locate(Q,I,"output")&&this._locate(O,r,"output")&&this._locate(O,N,"input")){w.push("FSI");if(u){u.cl2.c.data.regionType.push("fsi_cfd");u.cl1.c.data.regionType.push("fsi_std")}}else{if(this._locate(Q,r,"output")&&this._locate(Q,N,"input")&&this._locate(O,C,"input")&&this._locate(O,I,"output")){w.push("FSI");if(u){u.cl2.c.data.regionType.push("fsi_std");u.cl1.c.data.regionType.push("fsi_cfd")}}}if(this._locate(Q,R,"input")&&this._locate(Q,A,"output")&&this._locate(O,K,"output")&&this._locate(O,v,"input")){w.push("CHT");if(u){u.cl2.c.data.regionType.push("cht_cfd");u.cl1.c.data.regionType.push("cht_std")}}else{if(this._locate(Q,K,"output")&&this._locate(Q,v,"input")&&this._locate(O,R,"input")&&this._locate(O,A,"output")){w.push("CHT");if(u){u.cl2.c.data.regionType.push("cht_std");u.cl1.c.data.regionType.push("cht_cfd")}}}if(this._locate(Q,p,"input")&&this._locate(Q,J,"output")&&this._locate(O,F,"input")&&this._locate(O,M,"output")){w.push("SXS");if(u){u.cl2.c.data.regionType.push("sxs_xpl");u.cl1.c.data.regionType.push("sxs_std")}}else{if(this._locate(Q,F,"input")&&this._locate(Q,M,"output")&&this._locate(O,p,"input")&&this._locate(O,J,"output")){w.push("SXS");if(u){u.cl2.c.data.regionType.push("sxs_std");u.cl1.c.data.regionType.push("sxs_xpl")}}}if(this._locate(Q,t,"input")&&this._locate(Q,E,"output")&&this._locate(O,L,"input")&&this._locate(O,q,"output")){w.push("SXL");if(u){u.cl2.c.data.regionType.push("sxl_xpl");u.cl1.c.data.regionType.push("sxl_std")}}else{if(this._locate(Q,L,"input")&&this._locate(Q,q,"output")&&this._locate(O,t,"input")&&this._locate(O,E,"output")){w.push("SXL");if(u){u.cl2.c.data.regionType.push("sxl_std");u.cl1.c.data.regionType.push("sxl_xpl")}}}if(this._locate(Q,s,"input")&&this._locate(Q,D,"output")&&this._locate(O,o,"input")&&this._locate(O,z,"output")&&S.codeName==="Abaqus/Standard"&&P.codeName==="CSTStudio"){w.push("IHT");if(u){u.cl1.c.data.regionType.push("iht_std");u.cl2.c.data.regionType.push("iht_cst")}}else{if(this._locate(Q,o,"input")&&this._locate(Q,z,"output")&&this._locate(O,s,"input")&&this._locate(O,D,"output")&&S.codeName==="CSTStudio"&&P.codeName==="Abaqus/Standard"){w.push("IHT");if(u){u.cl1.c.data.regionType.push("iht_cst");u.cl2.c.data.regionType.push("iht_std")}}}if(S.codeName==="Abaqus/Explicit"&&P.codeName==="Abaqus/Explicit"){w=[]}if(S.codeName==="Abaqus/Standard"&&P.codeName==="Abaqus/Standard"){w=[]}return w},_buildMappingForm:function(F){var u=this;var t=u.model.getExperiment();var s=u.link;var w;for(var E=0;E<t.interactions.length;E++){var p=t.interactions[E];if(p.linkID===s.getID()){w=p.mapping;break}}var x=new e.Element("div",{"class":"wux-control-inline-container",});x.setStyle("width","100%");new e.Element("div",{html:"<h5>Search Parameters</h5>"}).inject(x);var M=new e.Element("div");M.setAttribute("class","wux-control-inline-container");M.setStyle("width","100%");M.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Parameters governing the mesh-to-mesh search algorithm."});M.inject(x);var D=[];D[0]={labelItem:"Characteristic length fraction",valueItem:false};D[1]={labelItem:"Absolute length",valueItem:true};var I=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});I.inject(M);var r=new e.Element("div",{html:"Units: "}).inject(I);r.setStyles({display:"inline-block",flex:"20%","padding-right":"5px"});F.unitTypesCombo=new n({elementsList:D,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false}).inject(I);F.unitTypesCombo.getContent().setStyle("flex","80%");F.unitTypesCombo.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"When 'Absolute length' is used, the tolerance is in units of length. Otherwise, the tolerance is a unitless representation of a share of the local facet, or element, characterisitic length."});if(w&&w.search){F.unitTypesCombo.currentValue=w.search.isAbsolute}var z=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});z.inject(M);var K=new e.Element("div",{html:"Global search tolerance: "}).inject(z);K.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});F.gstLineEditor=new b({placeholder:0.1});F.gstLineEditor.inject(z);F.gstLineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});F.gstLineEditor.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"The search algorithm ignores points further than this distance away when locating points on the partner mesh."});if(w&&w.search){if(w.search.neighborhoodSearch){F.gstLineEditor.value=w.search.neighborhoodSearch}}var y=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});y.inject(M);var B=new e.Element("div",{html:"Outward normal tolerance: "}).inject(y);B.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});F.ontLineEditor=new b({placeholder:0.5});F.ontLineEditor.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"The distance searched on the outward-normal side of a facet."});F.ontLineEditor.inject(y);F.ontLineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});if(w&&w.search){if(w.search.normal.outward){F.ontLineEditor.value=w.search.normal.outward}}var G=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});G.inject(M);var q=new e.Element("div",{html:"Inward normal tolerance: "}).inject(G);q.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});F.intLineEditor=new b({placeholder:0.5});F.intLineEditor.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"The distance searched on the inward-normal side of a facet."});F.intLineEditor.inject(G);F.intLineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});if(w&&w.search){if(w.search.normal.inward){F.intLineEditor.value=w.search.normal.inward}}var A=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});A.inject(M);var v=new e.Element("div",{html:"Tangential tolerance: "}).inject(A);v.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});F.ttLineEditor=new b({placeholder:0.5});F.ttLineEditor.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"The distance searched within the plane of a facet."});F.ttLineEditor.inject(A);F.ttLineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});if(w&&w.search){if(w.search.tangential){F.ttLineEditor.value=w.search.tangential}}F.rfnCheckBox=new k({allowUnsafeHTMLLabel:true,label:"Require facing normals",checkFlag:true}).inject(M);F.rfnCheckBox.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"When true, search is successfull only for facets whose normals oppose those associated with the search point. When false, opposing facets whose normals are aligned, whose dot product is positive, are considered in the search. A false setting is generally used only in cases where the facet geometry described to the Co-Simulation Engine is reversed. Other uses of the false setting may result in ambiguous or misleading results."});if(w&&w.search){F.rfnCheckBox.checkFlag=w.search.normal.requireFacingNormals}new e.Element("div",{html:"<h5>Solution Transfer Parameters</h5>"}).inject(x);var L=new e.Element("div");L.setAttribute("class","wux-control-inline-container");L.setStyle("width","100%");L.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Parameters governing the transfer of solution quantities between meshes."});L.inject(x);F.check2=new k({allowUnsafeHTMLLabel:true,label:"Conserve flux quantities across interfaces",checkFlag:false}).inject(L);F.check2.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"When true global conservation of the quantity is ensured, potentially at the expense of smoothness of distribution."});if(w&&w.search){if(w.transfer.flux.globalConservation){F.check2.checkFlag=w.transfer.flux.globalConservation}}F.check3=new k({allowUnsafeHTMLLabel:true,label:"Assign values to orphan locations",checkFlag:false}).inject(L);F.check3.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Orphan locations are defined as those for while search is not successful. When orphanTreatment a quantity is always defined and no error is produced for a search failure."});var J=new e.Element("div");J.setAttribute("class","wux-control-inline-container");J.setStyle("width","100%");J.inject(L);F.check4=new k({allowUnsafeHTMLLabel:true,type:"radio",label:"Use a constant value: ",checkFlag:false,disabled:true});F.check4.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Orphan locations are assigned the value listed."});var C=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});C.inject(J);var o=new e.Element("div",{html:F.check4}).inject(C);o.setStyles({display:"inline-block",flex:"60%"});F.check4LineEditor=new b({disabled:true});F.check4LineEditor.inject(C);F.check4LineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});var H=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",}).inject(J);F.check5=new k({allowUnsafeHTMLLabel:true,type:"radio",label:"Use value from the nearest target mesh location",checkFlag:false,disabled:true}).inject(H);F.check5.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Orphan locations are assigned the value of the quantity at the nearest target-mesh location."});F.check5.getContent().setStyles({display:"inline-block",flex:"100%"});F.check4.addEventListener("buttonclick",function(N){if(F.check4.checkFlag){F.check5.checkFlag=false}});F.check5.addEventListener("buttonclick",function(N){if(F.check5.checkFlag){F.check4.checkFlag=false}});F.check3.addEventListener("buttonclick",function(N){if(F.check3.checkFlag){F.check4.checkFlag=true;F.check4.disabled=false;F.check4LineEditor.disabled=false;F.check5.disabled=false}else{F.check4.checkFlag=false;F.check5.checkFlag=false;F.check4LineEditor.disabled=true;F.check4.disabled=true;F.check5.disabled=true}});if(w&&w.search){if(w.transfer.orphanTreatment){F.check3.checkFlag=true;F.check4.disabled=false;F.check4LineEditor.disabled=false;F.check5.disabled=false;if(w.transfer.orphanTreatment.constantValue){F.check4.checkFlag=true;F.check4LineEditor.value=w.transfer.orphanTreatment.constantValue}else{F.check5.checkFlag=w.transfer.orphanTreatment.nearestNeighbor}}}return x},_buildInteractionForm:function(y,v,x){for(var s=0;s<v.length;s++){var o=x.listInstances();if(v[s]==="SXS"){if(o.length===2&&Object.keys(o[1].reference.connectors).length===1&&Object.keys(o[1].reference.connectors).length===1&&o[0].reference.getConnector(Object.keys(o[0].reference.connectors)[0]).type==="Region"){break}else{v.splice(s,1)}}}var q=new e.Element("div",{"class":"wux-control-inline-container",});q.setStyle("width","100%");var r={FSI:"Fluid Structure Interaction (FSI)",CHT:"Conjugate Heat Transfer (CHT)",SXS:"Standard-Explicit Subcycle (SXS)",SXL:"Standard-Explicit LockStep (SXL)",IHT:"Induction Heat Transfer (IHT)"};var u=[];for(var t=0;t<v.length;t++){u.push({valueItem:v[t],labelItem:r[v[t]]})}if(u.length){var w=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});w.inject(q);var p=new e.Element("div",{html:"Interaction Type: "}).inject(w);p.setStyles({display:"inline-block",flex:"30%","padding-right":"5px"});y.interactionCombo=new n({elementsList:u,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false}).inject(w);y.interactionCombo.getContent().setStyle("flex","70%")}else{q.setStyle("text-align","center");q.innerHTML="No feasible interaction"}return q},_buildRampingForm:function(z){var u=this;var o=u.model.getExperiment();var w=u.link;var y;for(var s=0;s<o.interactions.length;s++){var t=o.interactions[s];if(t.linkID===w.getID()){y=t.ramping;break}}var p=new e.Element("div",{"class":"wux-control-inline-container",});p.setStyle("width","100%");z.rampCheckBox=new k({allowUnsafeHTMLLabel:true,label:"Apply Ramping",checkFlag:false}).inject(p);z.rampCheckBox.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"Ramping will apply a zero amplitude from t=0 to T1. Then a smooth amplitude will be applied from T1 to T2 to reach unit amplitude.",});if(y){z.rampCheckBox.checkFlag=true}var q=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});q.inject(p);var r=new e.Element("div",{html:"Delay the exchange of forces until time: "}).inject(q);r.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});z.t1LineEditor=new b({disabled:!z.rampCheckBox.checkFlag,requiredFlag:z.rampCheckBox.checkFlag});z.t1LineEditor.inject(q);z.t1LineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});if(y&&y.t1){z.t1LineEditor.value=y.t1}var x=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});x.inject(p);var v=new e.Element("div",{html:"Ramp force exchange to full magnitude by time: "}).inject(x);v.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});z.t2LineEditor=new b({disabled:!z.rampCheckBox.checkFlag,requiredFlag:z.rampCheckBox.checkFlag});z.t2LineEditor.inject(x);z.t2LineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});if(y&&y.t2){z.t2LineEditor.value=y.t2}z.rampCheckBox.addEventListener("buttonclick",function(A){if(z.interactionCombo.currentValue!=="FSI"){u.model.addMessage("Ramping can only be applied to FSI interactions.","warning","notification");z.rampCheckBox.checkFlag=false;return}if(z.rampCheckBox.checkFlag){z.t1LineEditor.disabled=false;z.t2LineEditor.disabled=false;z.t1LineEditor.requiredFlag=true;z.t2LineEditor.requiredFlag=true}else{z.t1LineEditor.disabled=true;z.t2LineEditor.disabled=true;z.t1LineEditor.requiredFlag=false;z.t2LineEditor.requiredFlag=false}});return p},_buildImplicitCouplingForm:function(z){var v=this;var o=v.model.getExperiment();var x=v.link;var s;for(var t=0;t<o.interactions.length;t++){var u=o.interactions[t];if(u.linkID===x.getID()){s=u.coupling;break}}var p=new e.Element("div",{"class":"wux-control-inline-container",});p.setStyle("width","100%");z.iCouplingCheckBox=new k({allowUnsafeHTMLLabel:true,label:"Apply Implicit Coupling",checkFlag:false}).inject(p);if(s){z.iCouplingCheckBox.checkFlag=true}var q=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});q.inject(p);var r=new e.Element("div",{html:"Exchange limit: "}).inject(q);r.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});z.iterLineEditor=new b({disabled:!z.iCouplingCheckBox.checkFlag,requiredFlag:z.iCouplingCheckBox.checkFlag});z.iterLineEditor.tooltipInfos=new i({allowUnsafeHTMLShortHelp:true,shortHelp:"The minimum permissible value is '2'."});z.iterLineEditor.inject(q);z.iterLineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});if(s&&s.iterations){z.iterLineEditor.value=s.iterations}var y=new e.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",});y.inject(p);var w=new e.Element("div",{html:"Coupling tolerance: "}).inject(y);w.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});z.tolLineEditor=new b({disabled:!z.iCouplingCheckBox.checkFlag,requiredFlag:z.iCouplingCheckBox.checkFlag,placeholder:0.005});z.tolLineEditor.inject(y);z.tolLineEditor.getContent().setStyles({display:"inline-block",flex:"40%"});if(s&&s.tolerance){z.tolLineEditor.value=s.tolerance}z.iCouplingCheckBox.addEventListener("buttonclick",function(B){if(z.interactionCombo.currentValue!=="FSI"){v.model.addMessage("Implicit Coupling can only be applied to FSI interactions.","warning","notification");z.iCouplingCheckBox.checkFlag=false;return}else{var A=v.link.comp1.getSelectedBehavior();var C=v.link.comp2.getSelectedBehavior();if(A.codeName==="Abaqus/Explicit"||C.codeName==="Abaqus/Explicit"){v.model.addMessage("Implicit Coupling cannot be applied to Explicit behaviors.","warning","notification");z.iCouplingCheckBox.checkFlag=false;return}}if(z.iCouplingCheckBox.checkFlag){z.iterLineEditor.disabled=false;z.iterLineEditor.requiredFlag=true;z.tolLineEditor.disabled=false;z.tolLineEditor.requiredFlag=true}else{z.iterLineEditor.disabled=true;z.iterLineEditor.requiredFlag=false;z.tolLineEditor.disabled=true;z.tolLineEditor.requiredFlag=false}});return p},validateForm:function(o){var p=0;if(isNaN(o.gstLineEditor.value)||o.gstLineEditor.value<0){o.gstLineEditor.value="";o.gstLineEditor.invalidFlag=true;p++}if(isNaN(o.ontLineEditor.value)||o.ontLineEditor.value<0){o.ontLineEditor.value="";o.ontLineEditor.invalidFlag=true;p++}if(isNaN(o.intLineEditor.value)||o.intLineEditor.value<0){o.intLineEditor.value="";o.intLineEditor.invalidFlag=true;p++}if(isNaN(o.ttLineEditor.value)||o.ttLineEditor.value<0){o.ttLineEditor.value="";o.ttLineEditor.invalidFlag=true;p++}if(isNaN(o.check4LineEditor.value)||o.check4LineEditor.value<0){o.check4LineEditor.value="";o.check4LineEditor.invalidFlag=true;p++}if(isNaN(o.t1LineEditor.value)||o.t1LineEditor.value<0||(o.rampCheckBox.checkFlag&&o.t1LineEditor.value==="")){o.t1LineEditor.value="";o.t1LineEditor.invalidFlag=true;p++}if(isNaN(o.t2LineEditor.value)||o.t2LineEditor.value<0||(o.rampCheckBox.checkFlag&&o.t2LineEditor.value==="")){o.t2LineEditor.value="";o.t2LineEditor.invalidFlag=true;p++}if(o.iCouplingCheckBox&&o.iCouplingCheckBox.checkFlag){if(isNaN(o.iterLineEditor.value)||o.iterLineEditor.value<2||o.iterLineEditor.value===""){o.iterLineEditor.value="";o.iterLineEditor.invalidFlag=true;p++}if(isNaN(o.tolLineEditor.value)||o.tolLineEditor.value<0||o.tolLineEditor.value===""){o.tolLineEditor.value="";o.tolLineEditor.invalidFlag=true;p++}}if(p>0){return false}else{return true}},execute:function(){var t=this;var s=t.model;var u=s.getEditor();var o=s.getExperiment();var p=t.intText;var x=p.textContent;var z={};u.hideContextualBar();if(!o){var v=l.get("sys_01");if(v==="sys_01"){v="An experiment must be created first."}s.addMessage(v,"error","notification");return}var w=u.getUIFrame().querySelectorAll(".wux-windows-dialog");for(var r=0;r<w.length;r++){if(w[r].querySelector(".wux-windows-window-header-title")&&w[r].querySelector(".wux-windows-window-header-title").textContent==="Interaction Properties"){return}}var q={message:"Retrieving Interaction Properties...",exclusive:false};u.addSystemSpinner(q);var y=function(){u.removeSystemSpinner(q);var I=t.compatibleTypes();if(!I){s.addMessage("No feasible interaction","warning","notification");return}var B=e.createElement("div");B.setAttribute("class","wux-control-inline-container");B.setStyle("width","98%");t._buildInteractionForm(z,I,s.getRoot()).inject(B);if(x&&x!==""&&z.interactionCombo){z.interactionCombo.currentValue=x}if(z.interactionCombo){var E=t._buildMappingForm(z);new j({allowUnsafeHTMLHeader:false,header:"Mapping Tolerances",body:E,}).inject(B)}if(z.interactionCombo){var N=t._buildRampingForm(z);new j({allowUnsafeHTMLHeader:false,header:"Ramping",body:N,}).inject(B)}if(z.interactionCombo){var O=t._buildImplicitCouplingForm(z);new j({allowUnsafeHTMLHeader:false,header:"Implicit Coupling",body:O,}).inject(B)}if(z.interactionCombo){var M=t.link.comp1;var L=t.link.comp2;var D=M.getSelectedBehavior();var C=L.getSelectedBehavior();var K=[];var F=e.createElement("div").setStyles({width:"100%",height:"400px"});F.innerHTML="Loading...";var H=new j({allowUnsafeHTMLHeader:false,header:"3D review",body:F,}).inject(B);H.expand();var G=function(Q){K.push(Q);if(K.length==2){var R=d.getWebappsBaseUrl()+"SMAMSWebUI/SMAMS3DPlayer.html";var P=document.createElement("IFRAME");P.src=R;P.id="SMAMSInteractionPlayer";P.style.width="100%";P.style.height="100%";F.innerHTML="";F.appendChild(P);F.parentNode.style.width="100%";P.onload=function(){this.contentWindow.loadBlob(K[0]);this.contentWindow.loadBlob(K[1])}}};c.downloadCgr({physicalId:D.getID(),onComplete:G,onFailure:function(){}});c.downloadCgr({physicalId:C.getID(),onComplete:G,onFailure:function(){}})}var J={};J.editor=u;J.title="Interaction Properties";J.content=B;J.width=400;J.height=650;J.onOK=(function(){var S=this;var Q=t.model.getExperiment();if(p&&S.interactionCombo){p.textContent=S.interactionCombo.currentValue;p.parentNode.querySelector(".my-interaction-title").textContent=S.interactionCombo.currentLabel;if(t.validateForm(S)){var R={};R.interaction=S.interactionCombo.currentValue;R.mapping={};R.mapping.search={};R.mapping.search.isAbsolute=S.unitTypesCombo.currentValue;R.mapping.search.neighborhoodSearch=S.gstLineEditor.value;R.mapping.search.normal={};R.mapping.search.normal.outward=S.ontLineEditor.value;R.mapping.search.normal.inward=S.intLineEditor.value;R.mapping.search.normal.requireFacingNormals=S.rfnCheckBox.checkFlag;R.mapping.search.tangential=S.ttLineEditor.value;R.mapping.transfer={};R.mapping.transfer.flux={};R.mapping.transfer.flux.globalConservation=S.check2.checkFlag;if(S.check3.checkFlag){R.mapping.transfer.orphanTreatment={};if(S.check4.checkFlag){R.mapping.transfer.orphanTreatment.constantValue=S.check4LineEditor.value}else{R.mapping.transfer.orphanTreatment.nearestNeighbor=S.check5.checkFlag}}if(S.rampCheckBox.checkFlag){R.ramping={};R.ramping.t1=S.t1LineEditor.value;R.ramping.t2=S.t2LineEditor.value}else{R.ramping=null}if(S.iCouplingCheckBox&&S.iCouplingCheckBox.checkFlag){R.coupling={iterations:S.iterLineEditor.value,tolerance:S.tolLineEditor.value}}else{R.coupling=null}Q.addInteraction1(t.link,R.interaction,R.mapping,R.ramping,R.coupling,false,function(){require(["DS/SMAMSWeb/SMAMSGenerateConfigFile"],function(V){var W=new V("config",s);var X=W.execute();Q.setConfig(X)})},function(){});var U=[];var P=t.link.comp1.getSelectedBehavior();var T=t.link.comp2.getSelectedBehavior();U[P.codeName]={name:t.link.comp1.getInfo().name,id:t.link.comp1.getID()};U[T.codeName]={name:t.link.comp2.getInfo().name,id:t.link.comp2.getID()};if(S.interactionCombo.currentValue==="SXS"){if(Q&&Q.process){Q.setAlgorithm("GANDC");var R=Q.getSolverOptions();R.negotiationMethod="MAX";R.leadActor=U["Abaqus/Standard"].name;Q.setSolverOptions(R,false,function(){},function(){})}}else{if(S.interactionCombo.currentValue==="SXL"){if(Q&&Q.process){Q.setAlgorithm("GAUSS-SEIDEL-PREDICTOR");var R=Q.getSolverOptions();R.leadActor=U["Abaqus/Explicit"].name;R.negotiationMethod="MIN";Q.setSolverOptions(R,false,function(){},function(){})}}else{if(S.interactionCombo.currentValue==="FSI"||S.interactionCombo.currentValue==="CHT"){if(Q&&Q.process){if((Q.getAlgorithm()!="GAUSS-SEIDEL"&&Q.getAlgorithm()!="JACOBI")||R.coupling!=null){Q.setAlgorithm("GAUSS-SEIDEL")}var R=Q.getSolverOptions();if(U["Abaqus/Explicit"]){R.negotiationMethod="MAX";R.leadActor=U["Abaqus/Explicit"].name}else{if(U["Abaqus/Standard"]){R.negotiationMethod="MIN";R.leadActor=U["Abaqus/Standard"].name}}Q.setSolverOptions(R,false,function(){},function(){})}}else{if(S.interactionCombo.currentValue==="IHT"){if(Q&&Q.process){Q.setAlgorithm("GAUSS-SEIDEL");var R=Q.getSolverOptions();R.leadActor=U["Abaqus/Standard"].name;R.negotiationMethod="MASTER";R.masterActor=U["Abaqus/Standard"].id;Q.setSolverOptions(R,false,function(){},function(){})}}}}}}else{t.model.addMessage("Invalid values entered.","warning","notification");return}}t.end()}).bind(z,t);J.onCancel=function(){t.end()};var A=new g(J);t.panel=A.getPanel();u.getImmersiveFrame().addWindow(t.panel)};t.link.getID(y,function(){u.removeSystemSpinner(q);return})},endExecute:function(){var o=this;if(o.panel){if(!o.panel.closeButtonClicked){o.panel.close()}o.panel=null}o.model=null;o.intText=null;o.link=null}});return m});
/*! Copyright 2016 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleExpParamsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","css!UIKIT/UIKIT.css","DS/SMAMSWeb/SMAMSGenerateConfigFile","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/Expander","DS/Controls/LineEditor","DS/Controls/ComboBox"],function(f,c,h,j,n,i,m,k,g,b,e,l,d,p){var a=c.extend({init:function(q){this.panel=null;this._treeListView={};this._parent(q,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},_getSolverArgs:function(B,C){var u=[];var z=this;var E=z.getFrameWindow();var A=E.RFLEditor;var y=A.model;var q=y.getExperiment();if(C.is3dfmu){var t=C.clientSolverParameters.getElementsByTagName("argument");var r="";for(var x=0;x<t.length;x++){if(t[x].getAttribute("modify")==="true"){if(t[x].getAttribute("parameter")==="applicationName"){r=t[x].getAttribute("value")}var s=t[x].getAttribute("value");if(t[x].getAttribute("type")==="Enumeration"){s=t[x].getAttribute("value").split("|");var D=[];for(var w=0;w<s.length;w++){D.push({valueItem:s[w],labelItem:s[w]})}s=D}u.push({name:t[x].getAttribute("parameter"),value:s,type:t[x].getAttribute("type"),app:r})}}}else{var v=q.getSimConfig(B.getID());if(!v){v={};v.cpus="1";v.doublePrecision="false"}if(v.doublePrecision===true){v.doublePrecision="true"}else{if(v.doublePrecision===false){v.doublePrecision="false"}}u.push({name:"CPUs",value:v.cpus,app:"",type:"Real"});var s=[{valueItem:"false",labelItem:"false"}];if(v.doublePrecision==="true"){s.unshift({valueItem:"true",labelItem:"true"})}else{s.push({valueItem:"true",labelItem:"true"})}if(C.codeName==="Abaqus/Explicit"){u.push({name:"Double Precision",value:s,app:"",type:"Enumeration"})}}return u},_getSolverArgsUI:function(){var y=this;var G=y.getFrameWindow();var v=G.RFLEditor;var t=v.model;var r=t.getRoot();var x=t.getExperiment();var B=r.listInstances();var A=f.createElement("div");A.setAttribute("class","wux-control-inline-container");A.setStyle("width","100%");A.setStyle("margin","auto");for(var E=0;E<B.length;E++){var F=B[E];var u=B[E].getSelectedBehavior();if(!u||u.fmu){continue}var w=y._getSolverArgs(F,u);if(w.length===0){continue}var H=f.createElement("div");H.setAttribute("class","wux-control-inline-container");H.setStyle("width","100%");H.setStyle("margin","auto");H.appendChild(f.createElement("h6",{text:F.getInfo().name}));H.inject(A);var z=new b({useAsyncPreExpand:true,shouldBeEditable:function(){return false},shouldAcceptDrag:function(){return false}});for(var D=0;D<w.length;D++){var q=w[D].value;if(w[D].type==="Enumeration"){q=w[D].value[0].valueItem}z.addChild([{grid:{argName:w[D].name,argValue:"",argType:w[D].type,argApp:w[D].app},currentVal:q,enumOpts:w[D].value}])}var s={selection:{canMultiSelect:false,cells:false,columnHeaders:false,enableListSelection:false,nodes:false,rowHeaders:false,toggle:false,unselectAllOnEmptyArea:true},treeDocument:z,defaultCellHeight:35,apiVersion:2,columns:[{dataIndex:"tree",isHidden:true},{text:"Application",dataIndex:"argApp",width:"auto",isDraggable:false,isHidden:!u.is3dfmu},{text:"Argument",dataIndex:"argName",width:"auto",isDraggable:false},{text:"Value",dataIndex:"argValue",width:"auto",onCellRequest:function(J){if(!J.isHeader){if(J.nodeModel.options.grid.argType!=="Enumeration"){var K=new d({value:J.nodeModel.options.currentVal});K.addEventListener("change",function(){J.nodeModel.options.currentVal=K.value});J.cellView.getContent().setContent(K)}else{var I=new p({elementsList:J.nodeModel.options.enumOpts,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false});I.currentValue=J.nodeModel.options.currentVal;I.addEventListener("change",function(){J.nodeModel.options.currentVal=I.currentValue});J.cellView.getContent().setContent(I);J.cellView.getContent().setAttribute("draggable",false)}}},isDraggable:false}]};var C=35*(z.getRoots().length+1);s.height=C+"px";y._treeListView[F.getID()]=new g(s);y._treeListView[F.getID()].inject(A);y._treeListView[F.getID()].getContent().querySelector(".wux-layouts-gridengine").style.height=(C+35)+"px";f.createElement("br").inject(A)}return A},_checkIllegalArguments:function(u){var v=0;var s=this;var t=s.getFrameWindow();var r=t.RFLEditor;var q=r.model;u.getRoots().forEach(function(x){var w=x.options.grid.argName;var z=x.options.currentVal;var y=x.options.grid.argType;if(w!=="additionalArguments"&&y!=="Enumeration"&&z.toString().trim()===""){v++}});if(v){q.addMessage("All solver Arguments except additionalArguments can only take non-empty values.","warning","notification");return true}else{return false}},execute:function(){var C=this;var W=C.getFrameWindow();var v=W.RFLEditor;v.hideContextualBar();var t=v.root;var u=t.getModel();var B=t.getModel().getExperiment();if(B===null||typeof(B)===undefined){var y=m.get("exp_not_created");if(y==="exp_not_created"){y="An experiment must be created first."}u.addMessage(y,"error","notification");C.end();return}var L=["GAUSS-SEIDEL","GAUSS-SEIDEL-PREDICTOR","JACOBI","GANDC"];var V=["MIN","MAX","CONSTANTDT","MASTER"];var H=t.listInstances();var q=B.listInteractions();var x="";var J=[];for(var S=0;S<H.length;S++){if(B.getMasterActor()&&H[S].phID===B.getMasterActor()){x=H[S].name}J.push({label:H[S].name,value:S+1})}var R=new h({className:"vertical",fields:[{type:"text",name:"duration",label:"Experiment duration",value:B.getDuration()},{type:"select",name:"algorithm",label:"Algorithm",value:B.getAlgorithm(),options:[{label:L[0],value:"1"},{label:L[1],value:"2",},{label:L[2],value:"3"},{label:L[3],value:"4",}]},{type:"select",name:"method",label:"Negotiation method",value:B.getMethod(),options:[{label:V[0],value:"1"},{label:V[1],value:"2"},{label:V[2],value:"3"},{label:V[3],value:"4"}]},{type:"text",name:"constantDt",label:"ConstantDT Value",value:B.getConstantDt()},{type:"select",name:"masterActor",label:"Master Actor",value:x,options:J},{type:"select",name:"leadActor",label:"Lead Actor",value:B.getLeadActor(),options:J}]});if(B.getMethod()!=="CONSTANTDT"){R.getField("constantDt").parentNode.style.display="none"}if(B.getMethod()!=="MASTER"){R.getField("masterActor").parentNode.parentNode.style.display="none"}R.addEvent("onChange",function(){if(this.getValue("method")[0]==="3"&&R.getField("constantDt")&&!R.getField("algorithm").disabled){R.getField("constantDt").parentNode.style.display="block";R.getField("masterActor").parentNode.parentNode.style.display="none"}else{if(this.getValue("method")[0]==="4"&&R.getField("masterActor")&&J.length&&!R.getField("algorithm").disabled){R.getField("masterActor").parentNode.parentNode.style.display="block";R.getField("constantDt").parentNode.style.display="none"}else{R.getField("masterActor").parentNode.parentNode.style.display="none";R.getField("constantDt").parentNode.style.display="none"}}});var z=[0,0,0,0];var w=[0,0,0,0];if(q.length==0){R.getInput("algorithm").disable([{value:1},{value:3}]);z[1]=1;z[3]=1}for(var Q=0;Q<q.length;Q++){if(q[Q].value==="SXS"){R.getInput("algorithm").disable();R.getInput("method").disable()}if(q[Q].value==="SXL"){R.getInput("algorithm").disable([{value:0},{value:2},{value:3}]);z[0]=1;z[2]=1;z[3]=1;R.getInput("method").disable([{value:1},{value:2},{value:3}]);w[1]=1;w[2]=1;w[3]=1}if(q[Q].value==="FSI"||q[Q].value==="CHT"){R.getInput("algorithm").disable([{value:1},{value:3}]);z[1]=1;z[3]=1;if(f.is(q[Q].coupling)){R.getInput("algorithm").disable([{value:2}]);z[2]=1}var A=o(t,q[Q].linkID);var Y=A.comp1.getSelectedBehavior();var X=A.comp2.getSelectedBehavior();if(Y.codeName=="Abaqus/Explicit"||X.codeName=="Abaqus/Explicit"){R.getInput("method").disable([{value:0}]);w[0]=1}}if(q[Q].value==="IHT"){R.getInput("algorithm").disable([{value:1},{value:2},{value:3}]);z[1]=1;z[2]=1;z[3]=1;R.getInput("method").disable([{value:0},{value:1},{value:2}]);w[0]=1;w[1]=1;w[2]=1;R.getField("masterActor").disabled=true}}if(z[0]+z[1]+z[2]+z[3]==4){R.getField("algorithm").disabled=true}if(w[0]+w[1]+w[2]+w[3]==4){R.getField("method").disabled=true}R.getField("leadActor").parentNode.parentNode.style.display="none";var T=0,I=0;for(var P=0;P<H.length;P++){var G=H[P].getSelectedBehavior();if(!G){continue}if(G.fmu){T++}else{if(G.sim){I++;for(var N=0;N<q.length;N++){if(G.codeName==="Abaqus/Explicit"&&q[N].value==="SXL"){R.setValue("leadActor",P+1)}if(G.codeName==="Abaqus/Standard"&&q[N].value==="SXS"){R.setValue("leadActor",P+1)}if(G.codeName==="Abaqus/Standard"&&q[N].value==="FSI"){R.setValue("leadActor",P+1)}if(G.codeName==="Abaqus/Explicit"&&q[N].value==="FSI"){R.setValue("leadActor",P+1)}if(G.codeName==="Abaqus/Standard"&&q[N].value==="CHT"){R.setValue("leadActor",P+1)}if(G.codeName==="Abaqus/Explicit"&&q[N].value==="CHT"){R.setValue("leadActor",P+1)}}}}if(P===H.length-1){if(T===H.length){R.getField("leadActor").parentNode.parentNode.style.display="block"}else{if(T>1&&I===1){for(var M=0;M<H.length;M++){var U=H[M].getReference();var s=Object.keys(U.behaviors);for(var K=0;K<s.length;K++){if(U.behaviors[K].getID()===B.behaviors[H[M].getID()].behavior){G=U.behaviors[K];break}}if(G.sim){R.setValue("leadActor",M+1)}}}}}}var F=f.createElement("div");F.setAttribute("class","container-fluid");R.inject(F);if(localStorage.getItem("EXPOldSolverOptions")==="true"){var D=C._getSolverArgsUI();var E=new l({allowUnsafeHTMLHeader:false,header:"Component Execution",body:D}).inject(F);if(D.textContent===""){E.hide()}}var O={};O.editor=v;O.title="Experiment Setup";O.content=F;O.width=450;O.height=440;O.onOK=function(){if(R.getValue("duration")&&!isNaN(R.getValue("duration"))&&R.getValue("constantDt")&&!isNaN(R.getValue("constantDt"))){if(B.process){if(localStorage.getItem("EXPOldSolverOptions")==="true"){for(var ad=0;ad<H.length;ad++){var ag=H[ad];var an=H[ad].getSelectedBehavior();if(!an||an.fmu||!C._treeListView[ag.getID()]){continue}var am=C._treeListView[ag.getID()];if(C._checkIllegalArguments(am)){return}var ak={};ak.name="";ak.version="";if(!an.is3dfmu){var ai={};ai.cpus=am.getRoots()[0].options.currentVal;if(am.getRoots().length>1){ai.doublePrecision=am.getRoots()[1].options.currentVal}else{ai.doublePrecision=false}B.setSimConfig(ag.getID(),ai,false,function(){},function(){})}else{var ab=an.clientSolverParameters.getElementsByTagName("argument");var af=0;for(var ac=0;ac<ab.length;ac++){if(ab[ac].getAttribute("modify")==="true"){var aj=am.getRoots()[af];if(aj){if(aj.options.grid.argType!=="Enumeration"){ab[ac].setAttribute("value",aj.options.currentVal)}else{var aa=[];for(var al=0;al<aj.options.enumOpts.length;al++){aa.push(aj.options.enumOpts[al].valueItem)}var ae=aa.indexOf(aj.options.currentVal);if(ae!==-1){aa.splice(ae,1)}aa.unshift(aj.options.currentVal);ab[ac].setAttribute("value",aa.join("|"))}}af++}else{if(ab[ac].getAttribute("parameter")==="applicationName"&&ab[ac].getAttribute("applicationInfo")==="true"&&ak.name===""){ak.name=ab[ac].getAttribute("value");var Z=ab[ac].parentNode.querySelector("[parameter='applicationVersion']");if(Z&&Z.getAttribute("value")){ak.version=Z.getAttribute("value")}}}}if(ak.name.trim()!==""&&ak.version.trim()!==""){B.process.setApplicationInfo(B.behaviors[ag.phID].activity,ak,function(){},function(){})}}}}var ah={};ah.algorithm=L[R.getValue("algorithm")-1];ah.duration=R.getValue("duration");ah.negotiationMethod=V[R.getValue("method")-1];ah.constantDt=R.getValue("constantDt");if(H.length){ah.leadActor=H[R.getValue("leadActor")-1].name;ah.masterActor=H[R.getValue("masterActor")-1].phID}B.setSolverOptions(ah,false,function(){var ar=new n("config",u);var aq=ar.execute();B.setConfig(aq);var ax=new n("spec",u);var av=ax.execute();for(var aw in av){var ao=null;var ap=(new XMLSerializer()).serializeToString(av[aw]);for(var at=0;at<u.components.length;at++){var ay=Object.keys(u.components[at].behaviors);for(var au=0;au<ay.length;au++){if(u.components[at].behaviors[au].getID()===B.behaviors[aw].behavior){ao=u.components[at].behaviors[au]}}}if(ao.sim){B.getProcess().uploadSpec(B.behaviors[aw].activity,ap,function(){u.addMessage("The spec file has been updated.","info","log")},function(aA){var az=m.get("proc_spec_update");if(az==="proc_spec_update"){az="The spec file could not be updated."}u.addMessage(az,"error","notification",aA)})}}},function(){})}C.end()}else{if(isNaN(R.getValue("constantDt"))||!R.getValue("constantDt")){R.getField("constantDt").focus()}else{R.getField("duration").focus()}}};O.onCancel=function(){C.end()};var r=new k(O);C.panel=r.getPanel();v.getImmersiveFrame().addWindow(C.panel);R.getField("duration").focus()},endExecute:function(){var q=this;if(q.panel){if(!q.panel.closeButtonClicked){q.panel.close()}q.panel=null}}});var o=function(s,t){var r=s.listLinks();for(var q=0;q<=r.length;q++){if(r[q].getID()==t){return r[q];break}}};return a});
/*! Copyright 2016 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleExecOptCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","css!UIKIT/UIKIT.css","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMWebServicesUtils","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Button","DS/Controls/Tab","DS/Controls/TabBar","DS/UIKIT/Input/Text","DS/RFLModelerWeb/RFL_EditorPanel","DS/SMAMSExecutionServices/SMAMSCommonServices"],function(g,b,j,l,p,c,k,o,n,i,f,h,e,m,d){var a=b.extend({init:function(q){this.panel=null;this.messageObj=null;this._parent(q,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var z=this;var I=z.getFrameWindow();var t=I.RFLEditor;t.hideContextualBar();var A={message:"Loading Execution Options...",exclusive:false};z.messageObj=A;t.addSystemSpinner(A);var x=t.model.getExperiment();var F=null,M,L=null,v=null;if(x===null||typeof(x)===undefined){var u=o.get("exp_not_created");if(u==="exp_not_created"){u="An experiment must be created first."}t.model.addMessage(u,"error","notification");z.end()}var E=x.getID();var s={message:"Saving Execution Options...",exclusive:false};var w=function(O){t.removeSystemSpinner(s);var N=o.get("exec_02");if(N==="exec_02"){N="The execution options could not be saved."}t.model.addMessage(N,"error","notification");t.model.addMessage(O,"error","notification")};var q=function(O){z.end();t.removeSystemSpinner(A);var N=o.get("exec_01");if(N==="exec_01"){N="The execution options could not be retrieved."}t.model.addMessage(N,"error","notification");t.model.addMessage(O,"error","notification")};var H=function(N){if(N.title_display==="CSE-Director"&&N.title.startsWith("Activity")){N.title_display="Co-simulation Master"}};var G=function(N){if(N.title_display==="Co-simulation Master"){N.title_display="CSE-Director"}};var C=function(S,N){F=S;M=[];L=[];var P=true;var Q=false;var W;var X=true;for(var T=0;T<S.length;T++){if(N){if(W==="Cleanup"){P=false}if(S[T].title.startsWith("Activity")||S[T].title==="OperatingSystem"||S[T].title==="drmMode"){P=true}else{if(S[T].title==="Step"||S[T].title==="Simulation"||S[T].title==="BeginTime"||S[T].title==="Custom"){P=false}}if(Q){if(S[T].level==="0"){Q=false}else{P=false}}if(S[T]["title_display"]==="Experiment"){P=false;Q=true}if(P){H(S[T]);M.push(S[T]);L.push(T)}W=S[T].title;X=P}else{H(S[T]);M.push(S[T]);L.push(T)}var U=S[T];if(U.title==="drmMode"){var O={fiper:"Built-in",Lsf:"LSF"};while(U.choices.length>0){U.choices.pop()}while(U.choices_display.length>0){U.choices_display.pop()}if(Array.isArray(v)){v.forEach(function(Z){var aa=Z["@name"],Y=O[aa];if(typeof Y!=="undefined"){U.choices.push(aa);U.choices_display.push(Y)}})}else{var V=v["@name"],R=O[V];U.choices.push(V);U.choices_display.push(R)}}}return M};var D=function(P){var O=function(T){var S=false;var R=null;for(var Q=0;Q<P.length;Q++){if(P[Q]["title_display"]===T){S=true}if(S&&P[Q]["title"]==="StationName"){R=Q;break}}return R};var N=O("CSE-Director");if(N===null){N=O("Co-simulation Master")}P[O("Experiment")].value=P[N].value};var J=function(R){var N,P;var Q=false;for(var O=0;O<R.length;O++){if(R[O].title.startsWith("Activity")){Q=false;if(R[O]["title_display"]==="Results Generation"){Q=true}}else{if(R[O]["title"]==="StationName"){N=O}else{if(R[O]["title"]==="CosimGroup"){P=O}else{if(R[O]["title"]==="drmMode"){if(R[O].value=="Lsf"){R[N].value=""}else{R[P].value=""}}}}}}};var K=function(O){for(var N=0;N<O.length;N++){G(O[N]);F[L[N]]=O[N]}D(F);J(F);return F};var y=function(Y){var P=g.createElement("sp-access-group");P.name="simulation";P.ACCESS="write";P.data={modifyMask:"TRUE",readMask:"TRUE",showMask:"TRUE"};var S=g.createElement("sp-exe-options");S.style.height="100%";S.style.color="black";S.data=Y;var O=g.createElement("div");O.setAttribute("class","container-fluid");O.style.height="100%";O.appendChild(P);O.appendChild(S);var V=g.createElement("div");V.setAttribute("class","container-fluid");V.style.height="50px";O.appendChild(V);var Q=g.createElement("div");Q.setAttribute("class","container-fluid");var R=new i({value:"Click to apply {localhost} to all Activities",className:"primary"}).inject(Q);R.onClick=function(){var aa=S.data;for(var Z=0;Z<aa.length;Z++){if(aa[Z].title==="StationName"){S.data[Z].value="{localhost}";S.notifyPath("data."+Z+".value","{localhost}")}}D(F)};var W=false;var U=new n({type:"checkbox",className:"primary",label:"Show all options",checked:W});U.getContent().setAttribute("style","text-align: left");U.onChange=function(){K(S.data);if(U.isChecked()){var Z=C(F,false);d.setExperimentActivityExecOptions(Z);S.data=Z}else{var Z=C(F,true);S.data=Z}};U.inject(Q);var T=g.createElement("div");T.setAttribute("class","container-fluid");Q.inject(T);O.inject(T);T.setAttribute("style","max-width: 523px;");var X={};X.editor=t;X.title="Advanced Execution Options";X.content=T;X.width=550;X.minWidth=375;X.height=525;X.onOK=function(){var Z=function(){t.removeSystemSpinner(s);t.model.addMessage("ExecutionOptions_Saved","info","log")};t.addSystemSpinner(s);d.saveExecOptions(E,K(S.data),Z,w);z.end()};X.onCancel=function(){z.end()};if(z.isRunning()){var N=new m(X);z.panel=N.getPanel();t.getImmersiveFrame().addWindow(z.panel)}};var B=function(N){v=N;var O=function(P){t.removeSystemSpinner(A);t.model.addMessage("The execution options have been retrieved.","info","log");y(C(P,true))};d.getExecOptions(E,O,q)};var r=function(P){var O=P+"/admin/drm";var Q={onComplete:function(R){B(R.Drms.Drm)},onError:function(R){q(R)}};var N={method:"GET",type:"json",responseType:"json",onComplete:Q.onComplete,onFailure:Q.onError};c.normalRequest(O,N)};d.getEEDUrl(r,w)},endExecute:function(){var s=this;var t=s.getFrameWindow();var q=t.RFLEditor;if(s.messageObj){q.removeSystemSpinner(s.messageObj);s.messageObj=null}if(s.panel){if(!s.panel.closeButtonClicked){var r=s.panel.getContent().querySelector("sp-exe-options");if(r&&r.parentElement){r.parentElement.removeChild(r)}s.panel.close()}s.panel=null}}});return a});
/*! Copyright 2015 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleFileMonitoringCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMWebServicesUtils","DS/RFLModelerWeb/RFL_EditorPanel","DS/UIKIT/Input/Button","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/SMAMSWeb/SMAMSFileMonitoring"],function(d,b,h,c,f,e,g,i){var a=b.extend({init:function(j){this.panel=null;this._parent(j,{isAsynchronous:true,isEnabled:false,mode:"exclusive"});this.hierarchyBrowsers=[];this.filemonitor=null;this.monitoringActive=false},_createUI:function(t,n){var l=this;var o=widget.editor;var p=t[0];var r=true;var q=d.createElement("ad-hierarchy-browser",{"class":"results-hierarchy-browser"});var s={};s.editor=o;s.title="File Monitoring";s.content=q;if(!l.panel){s.width=350;s.height=301}if(l.panel){s.position={};s.position.offsetX=n.panel.position.offsetX;s.position.offsetY=n.panel.position.offsetY;s.width=n.panel.width;s.height=n.panel.height}s.hideFooter=true;s.onOK=(function(){if(this.panel){var u=this.panel.getContent().querySelector("ad-hierarchy-browser");if(u.parentElement){u.parentElement.removeChild(u)}if(!this.panel.closeButtonClicked){this.panel.close()}}}).bind(n);s.onCancel=(function(){n.stopFileMonitoring();l.monitoringActive=false;if(this.panel){if(!this.panel.closeButtonClicked){var u=this.panel.getContent().querySelector("ad-hierarchy-browser");if(u.parentElement){u.parentElement.removeChild(u)}this.panel.close()}}l.panel=null}).bind(n);var j=new f(s);l.panel=j;o.getImmersiveFrame().removeWindow(n.panel);n.panel=j.getPanel();o.getImmersiveFrame().addWindow(n.panel);q.showRefresh=true;q.showRemove=true;q.showIconView=true;q.showListView=true;q.showRootBreadcrumb=true;q.panel=j;var k=function(D,A,z){var B=function(){var H=l.filemonitor;if(H){H.refreshList(function(J,I){if(J.length!==0){l._createUI(J,I)}})}};this.onRefresh=B;var C=[];for(var u=0;u<t.length;u++){if(D.name!="myProcess"){var y=D.list}else{if(D.name==="myProcess"){var y=t[u]}}for(var w=0;w<y.directoryList.length;w++){if(!D.path){var G=y.directoryList[w].name}else{if(D.path){var G=D.path+"/"+y.directoryList[w].name}}var x={name:y.directoryList[w].name,lastModified:y.directoryList[w].lastModified,list:y.directoryList[w],path:G};var F=d.createElement("ad-multiview-folder",{});F.model=x;F.viewState="ready";C.push(F)}for(var v=0;v<y.fileList.length;v++){if(!D.path){var G=y.fileList[v].name}else{if(D.path){var G=D.path+"/"+y.fileList[v].name}}var x={name:y.fileList[v].name,lastModified:y.fileList[v].modified,list:y.fileList[v],path:G};var E=d.createElement("ad-multiview-document",{});E.model=x;E.viewState="ready";C.push(E)}if(D.name!="myProcess"){break}}z(r,D,C);l.end()};q.populateFunction=k;var m={name:"myProcess",type:"process",id:"phID"};q.rootItem=m},execute:function(){var l=this;var r=this.getFrameWindow();var p=r.RFLEditor;var k=p.root;this._model=p.model;p.hideContextualBar();var j=this._model.getExperiment();var m=j.monitoring.status;var q=new i(j);l.filemonitor=q;if(m==="succeeded"||m==="failed"||m==="aborted"){WUX.AFR.CommandsManager.getCommand("SMAMultiScaleGetResultsCmdHdr").execute();this.end()}else{if(m==="running"&&localStorage.getItem("EXPCDebugModeOn")==="true"){var o=p.model.getExperiment().getID();l.monitoringActive=true;q.initializeFileMonitoring(o,l,function(t,s){if(t.length!==0){l._createUI(t,s)}})}else{if(m==="running"&&localStorage.getItem("EXPCDebugModeOn")!=="true"){var n=g.get("results_05");if(n==="results_05"){n="No files to display while running"}p.model.addMessage(n,"warning","notification")}}}}});return a});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleCloseCmd",["DS/ApplicationFrame/Command"],function(a){var b=a.extend({init:function(c){this._parent(c,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var e=this;var f=e.getFrameWindow();var d=f.RFLEditor;var c=d.model;c.closeModel();e.end()}});return b});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleReframCmd",["UWA/Core","DS/ApplicationFrame/Command"],function(c,a){var b=a.extend({init:function(d){this._parent(d,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var o=this;var A=o.getFrameWindow();var g=A.RFLEditor;g.hideContextualBar();var f=g.gr;f.views.main.zoomone();var d=1;while(d<3){var C=f.views.main.vpt;var D=A.getUIFrame().offsetHeight;var z=A.getUIFrame().offsetWidth;if(D<=0||z<=0){break}var k=0,v=0,u=0,t=0,s=0,i=0,B=0,l=0,r=0,j=0,q=0;for(var w=f.nodes.first;w;w=w.next){i=C[1]+C[2]*w.top;l=C[0]+C[2]*w.left;r=C[2]*w.width;B=C[2]*w.height;if(k===0){u=i;s=l;v=i+B;t=l+r}else{if((i+B)>v){v=i+B}if((l+r)>t){t=l+r}if(i<u){u=i}if(l<s){s=l}}k++}j=t-s;q=v-u;if(d===1){var p=[],h=[];p[0]=(t+s)/2;p[1]=(v+u)/2;h[0]=(z)/2;h[1]=(D)/2;var x=[];x[0]=C[0]+h[0]-p[0];x[1]=C[1]+h[1]-p[1];x[2]=C[2];if(x[0]&&x[1]&&x[2]){f.views.main.setViewpoint(x)}}else{if(d===2){var e=Math.max(j,q),m=0,y=1;if(e===j){m=j/z;if(q/m>D){m=q/D}}else{m=q/D;if(j/m>z){m=j/z}}y=-2*Math.log(m)/Math.log(2);if(y>0){y=0}else{if(y<0){y=1.25*y}}f.views.main.zoominc(y)}}d++}o.end()}});return b});
/*! Copyright 2015 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleRealTimeResultsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/WebappsUtils/WebappsUtils","DS/SMAMSExperimentServices/Document","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/UIKIT/Input/Toggle","DS/SMAMSExecutionServices/SMAMSMonitoringAPI","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/Windows/Panel","DS/RFLModelerWeb/RFL_EditorPanel","DS/Controls/Expander","DS/SMAMSExecutionServices/SMAMSExecutionServices"],function(d,b,f,e,l,i,m,k,c,h,j,g){var a=b.extend({init:function(n){this.panel=null;this._parent(n,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},_getresults:function(z,n){var q=widget.editor.model;var r=z.options.value[0];var y=z.options.value[1];var E;var J;var p;var G;var s;for(var C=0;C<q.components.length;C++){for(var A=0;A<q.components[C].instances.length;A++){for(var B=0;B<Object.keys(q.components[C].connectors).length;B++){if(r===q.components[C].connectors[Object.keys(q.components[C].connectors)[B]].phID&&y===q.components[C].instances[A].phID){E=q.components[C].instances[A].phID;J=q.components[C].connectors[Object.keys(q.components[C].connectors)[B]].name;p=q.components[C].connectors[Object.keys(q.components[C].connectors)[B]].type;G=q.components[C].connectors[Object.keys(q.components[C].connectors)[B]].valueref;s=q.components[C].instances[A].name}}}}for(var H in q.experiment.behaviors){if(q.experiment.behaviors[H].instance===y){var I=q.experiment.behaviors[H].activity}}q.experiment.monitoring.list.push([E,J,p,G]);var w=s;var t=J;var x=q.getExperiment().getID();var o=[];var D;var F={};var u={onSuccess:function(K){var L=K;F.physicalId=K;F.onComplete=function(R){var S=[],N=R;for(var P=0;P<R.length;P++){if(R[P].name.search(".csv")+4===R[P].name.length){S.push({label:R[P].name.slice(0,R[P].name.search(".csv")),value:P+1})}}var O;for(var M=0;M<N.length;M++){if(N[M].name.search(".csv")!==-1){O=N[M]}}var Q={};Q.physicalId=L;Q.filename=O.name;Q.fileformat=O.format;Q.onComplete=function(T){var aa=q.editor.getFrame().getImmersiveFrame();var af=new d.Element("div");var ad=widget.editor.getUIFrame().querySelectorAll(".wux-windows-window-maincontent").length;var X=new c({title:w+"_"+t,content:af,immersiveFrame:aa,position:{offsetX:20*ad,offsetY:20*ad},width:350,height:300,minHeight:300,allowedDockAreas:WUXDockAreaEnum.NoneDockArea,resizableFlag:true,snappableFlag:true,ensureHeightDefinitionOnHierarchy:true});X.addEventListener("close",function(){widget.getValue("RealTimeVariables")[widget.editor.getUIFrame().querySelector("xy-plot").dataObject.data.droppedData.counter-1]=0;arguments[0].setCheck(false)}.bind(this,z),false);X.addEventListener("stopResize",function(){for(var ag=0;ag<this.querySelectorAll("xy-plot").length;ag++){this.querySelectorAll("xy-plot")[ag].resize()}});var ac=d.createElement("xy-plot").inject(af.parentElement);var Y=ac;var ae=[];Y.processData(T,true);for(var W=0;W<Y.dataObject.data.droppedData.dataName[0].length;W++){ae[W]=Y.dataObject.data.droppedData.dataName[0][W]}Y.dataObject.data.droppedData.plotTitle=w;Y.dataObject.data.droppedData.xAxisName="Time";Y.dataObject.data.droppedData.grid=true;Y.dataObject.data.droppedData.backgroundColor="white";Y.dataObject.data.droppedData.agentName=E;Y.dataObject.data.droppedData.variableName=J;Y.dataObject.data.droppedData.counter=z.options.counter;var U=[0];for(var V=1;V<Y.dataObject.data.droppedData.dataName[0].length;V++){if(ae[V]===t){U.push(V)}else{if(ae[V]!==t){}}}var ab=Y.dataObject.data.droppedData.rawData;var Z=ab.map(function(ag){return U.map(function(ah){return ag[ah]})});Y.dataObject.data.droppedData.rawData=Z;Y.dataObject.data.droppedData.data=Z;if(Y.dataObject.data.droppedData.originalData){var ab=Y.dataObject.data.droppedData.originalData;var Z=ab.map(function(ag){return U.map(function(ah){return ag[ah]})})}Y.dataObject.data.droppedData.originalData=Z;Y.clearMainPlot();Y.setupMainPlot(ae,Y.dataObject.data.droppedData.xAxisName,"",true,"white",J);Y.panel=X};Q.onFailure=function(V,U,W){var T="document download failed "+V+U+W;q.addMessage(T,"warning","notification")};e.download(Q)};F.onFailure=function(){var M="list files failed";q.addMessage(M,"warning","notification")};e.listFiles(F)},onFailure:function(L){var K="get results for activity failed: "+L;q.addMessage(K,"warning","notification")}};var v={onSuccess:function(M){o=[];for(var L=0;L<M._activities.length;L++){if(M._activities[L]._data.busType==="Simulation Activity"&&M._activities[L].getName()!=="Experiment"&&M._activities[L].getName()!=="CSE-Director"){o.push(M._activities[L])}}for(var K=0;K<o.length;K++){if(o[K].getPhysicalId()===I){g.getResults(o[K],u)}}},onFailure:function(L){var K="open process failed: "+L;q.addMessage(K,"warning","notification")}};l.openProcess(x,v);document.addEventListener("execution-started",function(){WUX.AFR.CommandsManager.getCommand("SMAMultiScaleRealTimeResultsCmdHdr")._execStarted()})},_monitor:function(A,n){var r=widget.editor.model;var s=A.options.value[0];var z=A.options.value[1];var H=n;for(var D=0;D<r.components.length;D++){for(var B=0;B<r.components[D].instances.length;B++){for(var C=0;C<Object.keys(r.components[D].connectors).length;C++){if(s===r.components[D].connectors[Object.keys(r.components[D].connectors)[C]].phID&&z===r.components[D].instances[B].phID){var E=r.components[D].instances[B].phID;var J=r.components[D].connectors[Object.keys(r.components[D].connectors)[C]].name;var q=r.components[D].connectors[Object.keys(r.components[D].connectors)[C]].type;var G=r.components[D].connectors[Object.keys(r.components[D].connectors)[C]].valueref;var t=r.components[D].instances[B].name}}}}var y=r.editor.getFrame().getImmersiveFrame();var u=new d.Element("div");var p=widget.editor.getUIFrame().querySelectorAll(".wux-windows-window-maincontent").length;var x=new c({title:J+"  "+t,content:u,immersiveFrame:y,position:{offsetX:20*p,offsetY:20*p},width:350,height:300,minHeight:300,allowedDockAreas:WUXDockAreaEnum.NoneDockArea,resizableFlag:true,snappableFlag:true,ensureHeightDefinitionOnHierarchy:true});x.addEventListener("close",function(){if(widget.editor.getUIFrame().querySelector("xy-plot").dataObject){widget.getValue("RealTimeVariables")[widget.editor.getUIFrame().querySelector("xy-plot").dataObject.data.droppedData.counter-1]=0}arguments[0].setCheck(false)}.bind(this,A),false);x.addEventListener("stopResize",function(){for(var K=0;K<this.querySelectorAll("xy-plot").length;K++){this.querySelectorAll("xy-plot")[K].resize()}});var v=u;var F=d.createElement("xy-plot").inject(v.parentElement);if(A.isChecked()&&r.getExperiment().services&&r.getExperiment().monitoring.status==="running"){var o=r.getExperiment().services;o.subscribe(1,E,J,q,G,function(L){var N=new DOMParser();var M=N.parseFromString(L,"text/xml");var K=M.firstChild.textContent;if(K!==""){F.removeMessage(F);F.updatePlot(K,H,true)}},function(){})}var w="X,Y\r\n0,0\r\n";if(F.processData){F.processData(w)}var I=[];if(F.dataObject){for(var C=0;C<F.dataObject.data.droppedData.dataName[0].length;C++){I[C]=F.dataObject.data.droppedData.dataName[0][C]}F.dataObject.data.droppedData.agentName=E;F.dataObject.data.droppedData.variableName=J;F.dataObject.data.droppedData.counter=A.options.counter;F.dataObject.data.droppedData.xAxisName="Time"}if(F.setupMainPlot){F.setupMainPlot(I,"Time","",true,"white",J)}if(F.dataObject){F.dataObject.data.droppedData.rawData.splice(0)}F.panel=x;r.experiment.monitoring.list.push([E,J,q,G]);document.addEventListener("execution-started",function(){WUX.AFR.CommandsManager.getCommand("SMAMultiScaleRealTimeResultsCmdHdr")._execStarted()});if(r.experiment.monitoring.status!=="running"&&r.experiment.monitoring.status!=="Uploading Results"&&r.experiment.monitoring.status!=="Results Generation"){F.displayMessage("waiting for experiment to start",F)}else{if(r.experiment.monitoring.status==="running"){F.displayMessage("waiting for data",F)}else{if(r.experiment.monitoring.status==="Uploading Results"){F.displayMessage("Uploading results, please try again once completed",F)}else{if(r.experiment.monitoring.status==="Results Generation"){F.displayMessage("Generating results, please try again once completed",F)}}}}},_execStarted:function(){var t=widget.editor;if(t.model.experiment.monitoring.list&&t.model.experiment.monitoring.list.length>0){for(var s=0;s<t.model.experiment.monitoring.list.length;s++){for(var q=0;q<t.getUIFrame().querySelectorAll("xy-plot").length;q++){if(t.getUIFrame().querySelectorAll("xy-plot")[q].dataObject&&t.getUIFrame().querySelectorAll("xy-plot")[q].dataObject.data.droppedData.agentName===t.model.experiment.monitoring.list[s][0]&&t.getUIFrame().querySelectorAll("xy-plot")[q].dataObject.data.droppedData.variableName===t.model.experiment.monitoring.list[s][1]){var x=t.model.getExperiment().services;var z=t.getUIFrame().querySelectorAll("xy-plot");for(var p=0;p<z.length;p++){var r=z[p].dataObject.data.droppedData.agentName;var w=z[p].dataObject.data.droppedData.variableName;var n=z[p].dataObject.data.droppedData.counter;z[p].clearMainPlot();var v="X,Y\r\n0,0\r\n";z[p].processData(v);var y=[];for(var o=0;o<z[p].dataObject.data.droppedData.dataName[0].length;o++){y[o]=z[p].dataObject.data.droppedData.dataName[0][o]}z[p].dataObject.data.droppedData.agentName=r;z[p].dataObject.data.droppedData.variableName=w;z[p].dataObject.data.droppedData.counter=n;z[p].dataObject.data.droppedData.xAxisName="Time";z[p].setupMainPlot(y,"Time","",true,"white",w);z[p].dataObject.data.droppedData.rawData.splice(0);z[p].displayMessage("waiting for data",z[p])}if(x){var u=t.model.experiment.monitoring.list;x.subscribe(1,u[s][0],u[s][1],u[s][2],u[s][3],function(C){var E=new DOMParser();var D=E.parseFromString(C,"text/xml");var B=D.firstChild.textContent;for(var A=0;A<z.length;A++){if(D.firstChild.getAttribute("serviceName")===(z[A].dataObject.data.droppedData.agentName+"_"+z[A].dataObject.data.droppedData.variableName)){if(B!==""){z[A].removeMessage(z[A]);z[A].updatePlot(B,t.model.getExperiment().solverOptions.duration,true)}else{if(B===""){}}}}},function(){})}}}}}},execute:function(){var v=this;var Q=v.getFrameWindow();var t=Q.RFLEditor;if(!t.model.experiment.monitoring.list){t.model.experiment.monitoring.list=[]}var n=t.model.getExperiment().solverOptions.duration;var C=t.model.components;var p=[];var D=[];var y=d.createElement("div");y.setAttribute("class","container-fluid");var P=d.createElement("div");P.setAttribute("class","container-fluid");P.inject(y);var x=0;for(var M=0;M<C.length;M++){for(var I=0;I<C[M].instances.length;I++){var s=C[M].instances[I].getSelectedBehavior();if(s&&s.fmu){var N=new j({allowUnsafeHTMLHeader:false,header:C[M].instances[I].name}).inject(y);for(var K=0;K<Object.keys(C[M].connectors).length;K++){x=x+1;var O=C[M].connectors[Object.keys(this.getFrameWindow().RFLEditor.model.components[M].connectors)[K]].name;var A=C[M].connectors[Object.keys(this.getFrameWindow().RFLEditor.model.components[M].connectors)[K]].causality;if(A==="O"){A="Output"}else{if(A==="I"){A="Input"}else{if(A==="N"){A="Neutral"}}}var r=C[M].connectors[Object.keys(C[M].connectors)[K]].phID;var G=C[M].instances[I].phID;var R=d.createElement("div");R.setAttribute("class","row");R.setAttribute("id",O);var q=d.createElement("div");q.setAttribute("class","my-param-name col-xs-6 col-sm-6 col-md-6 col-lg-6");q.setAttribute("title",O);q.setAttribute("style","cursor: pointer;");var B=d.createElement("div");B.setAttribute("class","my-param-toggle col-xs-2 col-sm-2 col-md-2 col-lg-2");var L=d.createElement("div");L.setAttribute("class","my-param-name col-xs-3 col-sm-3 col-md-3 col-lg-3");q.textContent=O;var J=new i({type:"switch",value:[r,G],label:""}).inject(B);p.push(0);J.options.counter=x;var F=t.getUIFrame().querySelectorAll("xy-plot");for(var w=0;w<F.length;w++){if(F[w].dataObject.data.droppedData.counter===x){J.setCheck();p[x-1]=1;var E=F[w].parentElement.parentElement.parentElement.parentElement;E.addEventListener("close",function(){widget.getValue("RealTimeVariables")[widget.editor.getUIFrame().querySelector("xy-plot").dataObject.data.droppedData.counter-1]=0;arguments[0].setCheck(false)}.bind(this,J),false)}}D.push(J);L.textContent=A;q.inject(R);L.inject(R);B.inject(R);R.inject(P);R.inject(N.getContent().children[0].children[1]);J.onChange=function(){if(this.isChecked()){var ah=d.clone(widget.getValue("RealTimeVariables"));ah[this.options.counter-1]=1;widget.setValue("RealTimeVariables",ah)}else{if(!this.isChecked()){var ah=d.clone(widget.getValue("RealTimeVariables"));ah[this.options.counter-1]=0;widget.setValue("RealTimeVariables",ah);var ab=widget.editor.getUIFrame().querySelectorAll("xy-plot");for(var af=0;af<ab.length;af++){if(ab[af].dataObject.data.droppedData.counter===this.options.counter){ab[af].panel.close()}}}}var aa=this;var Z=widget.editor.model;var T=aa.options.value[0];var z=aa.options.value[1];for(var Y=0;Y<Z.components.length;Y++){for(var V=0;V<Z.components[Y].instances.length;V++){for(var W=0;W<Object.keys(Z.components[Y].connectors).length;W++){if(T===Z.components[Y].connectors[Object.keys(Z.components[Y].connectors)[W]].phID&&z===Z.components[Y].instances[V].phID){var X=Z.components[Y].instances[V].phID;var ae=Z.components[Y].connectors[Object.keys(Z.components[Y].connectors)[W]].name;var ac=Z.components[Y].connectors[Object.keys(Z.components[Y].connectors)[W]].type;var ad=Z.components[Y].connectors[Object.keys(Z.components[Y].connectors)[W]].valueref}}}}if(aa.isChecked()&&Z.getExperiment().services&&Z.getExperiment().monitoring.status==="running"){WUX.AFR.CommandsManager.getCommand("SMAMultiScaleRealTimeResultsCmdHdr")._monitor(this,n)}else{if(!aa.isChecked()&&Z.getExperiment().services){var ag=Z.getExperiment().services;ag.unsubscribe(X,ae,ac,ad)}else{if(aa.isChecked()&&Z.getExperiment().monitoring.status!=="running"&&Z.getExperiment().monitoring.status!=="succeeded"){for(var U=0;U<Z.editor.getUIFrame().querySelectorAll("xy-plot").length;U++){if(X===Z.editor.getUIFrame().querySelectorAll("xy-plot")[U].dataObject.data.droppedData.agentName&&ae===Z.editor.getUIFrame().querySelectorAll("xy-plot")[U].dataObject.data.droppedData.variableName){return}}WUX.AFR.CommandsManager.getCommand("SMAMultiScaleRealTimeResultsCmdHdr")._monitor(this,n)}else{if(!aa.isChecked()&&Z.getExperiment().monitoring.status!=="running"){for(var S=0;S<Z.experiment.monitoring.list.length;S++){if(X===Z.experiment.monitoring.list[S][0]&&ae===Z.experiment.monitoring.list[S][1]&&ac===Z.experiment.monitoring.list[S][2]&&ad===Z.experiment.monitoring.list[S][3]){Z.experiment.monitoring.list.splice(S,1)}}}else{if(aa.isChecked()&&Z.getExperiment().monitoring.status==="succeeded"){WUX.AFR.CommandsManager.getCommand("SMAMultiScaleRealTimeResultsCmdHdr")._getresults(this,n)}}}}}}}}}}if(x===0){var u=k.get("results_06");if(u==="results_06"){u="No variable available for monitoring"}widget.editor.model.addMessage(u,"warning","notification");return}t.hideContextualBar();var H={};H.editor=t;H.title="Results Monitoring";H.content=y;H.width=350;H.height=401;H.hideFooter=true;H.onOK=function(){v.end()};H.onCancel=function(){v.end()};var o=new h(H);v.panel=o.getPanel();t.getImmersiveFrame().addWindow(v.panel);if(typeof widget!=="undefined"&&d.is(widget)&&d.is(widget.setValue)){widget.setValue("RealTimeVariables",p)}},endExecute:function(){var n=this;if(n.panel){if(!n.panel.closeButtonClicked){n.panel.close()}n.panel=null}}});return a});
/*! Copyright 2016 Dassault Systemes 
 * XSS_CHECKED
 * */
define("DS/SMAMSWebUI/SMAMultiScaleCloudExecOptCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","css!UIKIT/UIKIT.css","DS/SMAMSWeb/SMAMSGenerateConfigFile","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/Expander","DS/Controls/LineEditor","DS/Controls/Slider","DS/Controls/TooltipModel","DS/Controls/Toggle","DS/Controls/Button","DS/Controls/ComboBox","DS/SMAMSExecutionServices/SMAMSExecutionServices","DS/SMAMSExecutionServices/SMAMSCommonServices"],function(f,n,g,m,u,b,e,a,i,k,p,l,s,d,h,c,o,j,t,q){var r=n.extend({init:function(v){this.panel=null;this._treeListView={};this._stationSelectionIndex={};this._stationSelectionInfo={};this._execOptData=null;this._formVar={};this._parent(v,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},_getSolverArgs:function(F,G){var z=[];var D=this;var I=D.getFrameWindow();var E=I.RFLEditor;var C=E.model;var v=C.getExperiment();var J=false;if(G.codeName==="Abaqus/Explicit"||G.codeName==="Abaqus/Standard"){J=true}if(G.is3dfmu){var y=G.clientSolverParameters.getElementsByTagName("argument");var w="";for(var B=0;B<y.length;B++){if(t.isCloud&&J&&y[B].getAttribute("parameter")==="-cpus"){continue}if(y[B].getAttribute("parameter")==="applicationName"){w=y[B].getAttribute("value")}if(y[B].getAttribute("modify")==="true"){var x=y[B].getAttribute("value");if(y[B].getAttribute("type")==="Enumeration"){x=y[B].getAttribute("value").split("|");var H=[];for(var A=0;A<x.length;A++){H.push({valueItem:x[A],labelItem:x[A]})}x=H}z.push({name:y[B].getAttribute("parameter"),value:x,type:y[B].getAttribute("type"),app:w})}}}return z},_getSolverArgsUI:function(F){var D=this;var G=D.getFrameWindow();var E=G.RFLEditor;var B=E.model;var w=B.getRoot();var v=B.getExperiment();var C=w.listInstances();var x=f.createElement("div");x.setAttribute("class","wux-control-inline-container");x.setStyle("width","100%");x.setStyle("margin","auto");var L=F.getSelectedBehavior();if(!L||L.fmu){return x}var I=D._getSolverArgs(F,L);if(I.length===0){return x}var z=f.createElement("div");z.setAttribute("class","wux-control-inline-container");z.setStyle("width","100%");z.setStyle("margin","auto");z.appendChild(f.createElement("h6",{text:"Solver Arguments"}));z.inject(x);var H=new k({useAsyncPreExpand:true,shouldBeEditable:function(){return false},shouldAcceptDrag:function(){return false}});for(var A=0;A<I.length;A++){var y=I[A].value;if(I[A].type==="Enumeration"){y=I[A].value[0].valueItem}H.addChild([{grid:{argName:I[A].name,argValue:"",argType:I[A].type,argApp:I[A].app},currentVal:y,enumOpts:I[A].value}])}var K={selection:{canMultiSelect:false,cells:false,columnHeaders:false,enableListSelection:false,nodes:false,rowHeaders:false,toggle:false,unselectAllOnEmptyArea:true},treeDocument:H,defaultCellHeight:35,apiVersion:2,columns:[{dataIndex:"tree",isHidden:true},{text:"Application",dataIndex:"argApp",width:"auto",isDraggable:false,isHidden:!L.is3dfmu},{text:"Argument",dataIndex:"argName",width:"auto",isDraggable:false},{text:"Value",dataIndex:"argValue",width:"auto",onCellRequest:function(N){if(!N.isHeader){if(N.nodeModel.options.grid.argType!=="Enumeration"){var O=new s({value:N.nodeModel.options.currentVal});O.addEventListener("change",function(){N.nodeModel.options.currentVal=O.value});if(N.cellView){N.cellView.getContent().setAttribute("draggable",false);N.cellView.getContent().setContent(O)}}else{var M=new j({elementsList:N.nodeModel.options.enumOpts,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false});M.currentValue=N.nodeModel.options.currentVal;M.addEventListener("change",function(){N.nodeModel.options.currentVal=M.currentValue});N.cellView.getContent().setContent(M);N.cellView.getContent().setAttribute("draggable",false)}}},isDraggable:false}]};var J=35*(H.getRoots().length+1);K.height=J+"px";D._treeListView[F.getID()]=new i(K);D._treeListView[F.getID()].inject(x);D._treeListView[F.getID()].getContent().querySelector(".wux-layouts-gridengine").style.height=(J+35)+"px";f.createElement("br").inject(x);return x},_getDrmOptions:function(O,A,z){var C=this;var F=new f.Element("div",{"class":"wux-control-inline-container",});F.setStyle("width","100%");var P=new f.Element("div");P.setAttribute("class","wux-control-inline-container");P.setStyle("width","100%");P.tooltipInfos=new h({allowUnsafeHTMLShortHelp:true,shortHelp:"DRM Options"});P.inject(F);var I=[];if(true){var w={fiper:"Built-in",Lsf:"LSF"};if(Array.isArray(A)){A.forEach(function(S){var T=S["@name"],Q=w[T];if(typeof Q!=="undefined"){var R={labelItem:Q,valueItem:T};I.push(R)}})}else{var G=A["@name"],x=w[G];var D={labelItem:x,valueItem:G};I.push(D)}}var B=C._getDiv();B.inject(P);var N=C._getNameDiv("DRM ").inject(B);O.drmTypesCombo=new j({elementsList:I,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false}).inject(B);O.drmTypesCombo.currentValue=z.drmMode;var v=C._getDiv();v.inject(P);var y=C._getNameDiv("Operating System: ").inject(v);O.opLineEditor=new s({});O.opLineEditor.inject(v);O.opLineEditor.value=z.OperatingSystem;if(z.drmMode==="Lsf"){v.setStyle("display","none");O.opLineEditor.value=""}var M=C._getDiv();M.inject(P);var L=C._getNameDiv("Station Name: ").inject(M);if(z.drmMode==="Lsf"){M.setStyle("display","none")}O.stationLineEditor=new s({});O.stationLineEditor.inject(M);O.stationLineEditor.value=z.StationName;var E=C._getDiv();E.inject(P);var J=C._getNameDiv("Hosts: ").inject(E);if(z.drmMode==="fiper"){E.setStyle("display","none")}O.hostsLineEditor=new s({});O.hostsLineEditor.inject(E);O.hostsLineEditor.value=z.Hosts;var K=C._getDiv();K.tooltipInfos=new h({allowUnsafeHTMLShortHelp:true,shortHelp:" Specify a co-simulation group for components (activities) that need to be executed simultaneously on the same platform.  Form different groups if you need to execute on different platforms."});K.inject(P);var H=C._getNameDiv("Co-simualtion Group: ").inject(K);if(z.drmMode==="fiper"){K.setStyle("display","none")}O.cosimLineEditor=new s({});O.cosimLineEditor.inject(K);O.cosimLineEditor.value=z.CosimGroup;O.drmTypesCombo.addEventListener("change",function(Q){if(O.drmTypesCombo.currentValue==="fiper"){E.setStyle("display","none");M.setStyle("display","flex");v.setStyle("display","flex");K.setStyle("display","none");O.cosimLineEditor.value=""}else{M.setStyle("display","none");E.setStyle("display","flex");v.setStyle("display","none");O.opLineEditor.value="";K.setStyle("display","flex")}});return F},_getMasterOptions:function(v,A){var z=this;var B=new f.Element("div");B.setAttribute("class","wux-control-inline-container");B.setStyle("width","100%");if(t.isCloud){var y=z._getDiv();y.inject(B);var x=z._getNameDiv("Cost Estimate: ").inject(y);v.creditsLineEditor=new s({disabled:true});v.creditsLineEditor.inject(y);var w=0;if(A===1){w=3}else{if(A>1){w=5}}v.creditsLineEditor.value=(1+w)*10+" SCT tokens";z._getGlobalCostEstimate()}return B},_getsimFmuOptions:function(J,O,B){var K=this;var I=t.isCloud;var X=new f.Element("div");X.setAttribute("class","wux-control-inline-container");X.setStyle("width","100%");var S=false;var D=true;var R=O.md;var E=new DOMParser();var Y=E.parseFromString(R,"text/xml");var F=Y.getElementsByTagName("uvm_data");var W,Q=null,y=null;var U=null;var C=false;if(I&&O.codeName==="CFD"){var M=6;D=true;U=K._calculateTokens(null,null,M,B.cpus);C=true}else{if(I){S=true;if(F.length>0){W=F[0].getElementsByTagName("model_size");Q=W[0].getAttribute("nodes");var V=F[0].getElementsByTagName("step");y=V[0].getAttribute("name");U=K._calculateTokens(B.cpus,K._getSizeIndex(Q),K._getFeatureIndex(y),1);C=true}else{D=false}}else{}}if(S){var N=K._getDiv();N.inject(X);var x=K._getNameDiv("Performance: ").inject(N);x.setAttribute("style","flex:1 1 60%;top: -14px;position: relative;");J.perfSlider=new d({minValue:1,maxValue:7,stepValue:1,value:B.cpus});J.perfSlider.inject(N);J.perfSlider.getContent().setStyle("width","100%");J.perfSlider.tooltipInfos=new h({allowUnsafeHTMLShortHelp:true,shortHelp:J.perfSlider.value})}if(D){var w=K._getDiv();w.inject(X);var H=K._getNameDiv("CPUs: ").inject(w);J.cpusLineEditor=new s({disabled:S});J.cpusLineEditor.inject(w);if(S&&U!==null){J.cpusLineEditor.value=U.numCores}else{J.cpusLineEditor.value=B.cpus}}if(I){var G=K._getDiv();G.inject(X);var v=K._getNameDiv("Cost Estimate: ").inject(G);J.creditsLineEditor=new s({disabled:true});J.creditsLineEditor.inject(G);if(C){J.creditsLineEditor.value=U.SWCheckout}else{J.creditsLineEditor.value="Unavailable"}if(S){J.perfSlider.addEventListener("change",function(aa){var Z=J.perfSlider.value;J.perfSlider.tooltipInfos.shortHelp=Z;if(C){U=K._calculateTokens(Z,K._getSizeIndex(Q),K._getFeatureIndex(y),1);J.creditsLineEditor.value=U.SWCheckout;J.cpusLineEditor.value=U.numCores;K._getGlobalCostEstimate()}})}if(D){J.cpusLineEditor.addEventListener("change",function(ab){if(O.codeName==="CFD"){var Z=J.cpusLineEditor.value;var aa=6;U=K._calculateTokens(1,K._getSizeIndex(Q),6,Z);J.creditsLineEditor.value=U.SWCheckout;K._getGlobalCostEstimate()}})}}if(O.codeName==="Abaqus/Explicit"){var T=[];var A={labelItem:"true",valueItem:"true"};T.push(A);var z={labelItem:"false",valueItem:"false"};T.push(z);var P=K._getDiv();P.inject(X);var L=K._getNameDiv("Double Precision: ").inject(P);J.dblPrecisionCombo=new j({elementsList:T,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false}).inject(P);J.dblPrecisionCombo.currentValue=B.doublePrecision}return X},_get3dfmuOptions:function(E,x){var C=this;var A=t.isCloud;var w=new f.Element("div");w.setAttribute("class","wux-control-inline-container");w.setStyle("width","100%");w.tooltipInfos=new h({allowUnsafeHTMLShortHelp:true,shortHelp:"Options for Solver"});if(t.isCloud){var y=x.clientSolverParameters.getElementsByTagName("argument");var D=0;var F=null;var G=null;for(var B=0;B<y.length;B++){if(y[B].getAttribute("parameter")==="-cpus"){G=y[B];F=y[B].getAttribute("value");break}}if(F!==null){var z=C._getDiv();z.inject(w);var v=C._getNameDiv("Performance: ").inject(z);v.setAttribute("style","flex:1 1 60%;top: -14px;position: relative;");E.perfSlider=new d({minValue:1,maxValue:7,stepValue:1,value:F});E.perfSlider.inject(z);E.perfSlider.getContent().setStyle("width","100%");E.perfSlider.tooltipInfos=new h({allowUnsafeHTMLShortHelp:true,shortHelp:E.perfSlider.value});E.perfSlider.addEventListener("change",function(H){G.setAttribute("value",E.perfSlider.value);E.perfSlider.tooltipInfos.shortHelp=E.perfSlider.value})}}return w},_getGlobalOptions:function(J,y){var G=this;var w=new f.Element("div");w.setAttribute("class","wux-control-inline-container");w.setStyle("width","100%");w.tooltipInfos=new h({allowUnsafeHTMLShortHelp:true,shortHelp:" Global execution options"});if(!t.isCloud){var E=G._getDiv();E.inject(w);var x=G._getNameDiv("Run Time Limit: ").inject(E);J.timeLineEditor=new s({});J.timeLineEditor.inject(E);J.timeLineEditor.value=y.RunTimeLimit;E.tooltipInfos=new h({allowUnsafeHTMLShortHelp:true,shortHelp:"Specify the amount of time the job should run before forced termination by LSF. This is specific to LSF DRM execution."})}if(t.isCloud){var z=G._getDiv();z.inject(w);var B=G._getNameDiv("Total Cost Estimate: ").inject(z);J.creditsValueDiv=G._getDiv();J.creditsLineEditor=new s({disabled:true});J.creditsLineEditor.inject(z);J.creditsLineEditor.value="Unavailable";J.creditsLineEditor.addEventListener("change",function(K){J.creditsLineEditor.value=G._getGlobalCostEstimate()})}var A=G._getDiv();A.inject(w);var H=G._getNameDiv("Cleanup: ").inject(A);var v=[];if(true){var F={"0":"Always","1":"On Success","2":"Never"};for(var C in F){if(F.hasOwnProperty(C)){var I={labelItem:F[C],valueItem:C};v.push(I)}}}J.cleanupTypesCombo=new j({elementsList:v,selectedIndex:0,enableSearchFlag:false,actionOnClickFlag:false}).inject(A);J.cleanupTypesCombo.currentValue=y.Cleanup;var D=new o({label:"Click to apply {localhost} to all Activities",emphasize:"primary"}).inject(w);D.addEventListener("buttonclick",function(){var M=G._stationSelectionInfo;var L=G._formVar;for(var K in M){if(M.hasOwnProperty(K)&&K!=="Experiment"){L[K].stationLineEditor.value="{localhost}"}}});return w},_getDiv:function(){return new f.Element("div").setStyles({display:"flex","align-items":"baseline","flex-flow":"row",})},_getNameDiv:function(w){var v=new f.Element("div",{html:w});v.setStyles({display:"inline-block",flex:"60%","padding-right":"5px"});return v},_getSizeIndex:function(v){var w=null;if(v===null){return w}if(v<125001){w=1}else{if(v<250001){w=2}else{if(v<500001){w=3}else{if(v<1000001){w=4}else{if(v<2000001){w=5}else{if(v<3750001){w=6}else{w=7}}}}}}return w},_getFeatureIndex:function(w){var v=null;if(w==="Step_Lin_Static"||w==="Step_Lin_Buckle"){v=1}else{if(w==="Step_Lin_ModalTransient"||w==="Step_Lin_ModalHarmonic"){v=3}else{if(w==="Step_Gen_Static"||w==="Step_Gen_Dynamic_Implicit"||w==="Step_Gen_HeatTransfer"||w==="Step_Gen_TemperatureDisplacement_Transient"){v=4}else{if(w==="Step_Gen_Dynamic_Explicit"||w==="Step_Gen_Dynamic_Explicit_TemperatureDisplacement"){v=5}}}}return v},_calculateTokens:function(w,y,x,v){var z=f.createElement("sp-credits-calculator");z.$.licenseType.setValue("tokens");z.licenseType="tokens";z.perfIndex=w;z.sizeIndex=y;z.featureIndex=x;z.numCores=v;z.operatingSystem="windows";z.onPremiseStationOnCloud3X=true;var A=z.calculate();A.numCores=z.numCores;return A},_getGlobalCostEstimate:function(){var D=this;var J=D._formVar;var z=function(K){if(K.hasOwnProperty("creditsLineEditor")&&K.creditsLineEditor.value!=="Unavailable"){var L=K.creditsLineEditor.value;return parseInt(L.split(" ")[0])}else{return"Unavailable"}};var H=D.getFrameWindow();var E=H.RFLEditor;var B=E.model;var x=B.getRoot();var C=x.listInstances();var G=z(J["CSE-Director"]);var y=true;for(var A=0;A<C.length;A++){var F=C[A];var I=C[A].getSelectedBehavior();var I=F.getSelectedBehavior();if(!I||I.fmu){continue}var w=J[F.name];var v=z(w);if(v==="Unavailable"){y=false;G="Unavailable";break}else{G+=v}}if(y){G=G+" SCT tokens"}J.global.creditsLineEditor.value=G},execute:function(){var G=this;var L=G._formVar;var C={};var y=false;var v=false;var N=G.getFrameWindow();var A=N.RFLEditor;A.hideContextualBar();var H={message:"Loading Execution Options...",exclusive:false};G.messageObj=H;A.addSystemSpinner(H);var x=A.root;var z=x.getModel();var E=x.getModel().getExperiment();if(E===null||typeof(E)===undefined){var B=e.get("exp_not_created");if(B==="exp_not_created"){B="An experiment must be created first."}z.addMessage(B,"error","notification");A.removeSystemSpinner(H);G.end();return}var J=function(){var Z=x.listInstances();if(E.process){for(var aj=0;aj<Z.length;aj++){var al=Z[aj];var R=Z[aj].getSelectedBehavior();if(!R||R.fmu){continue}var O=G._treeListView[al.getID()];if(O&&G._checkIllegalArguments(O)){return}var af={};af.name="";af.version="";if(!R.is3dfmu){var Q={};var X=al.name;var Y=L[X];if(!t.isCloud||R.codeName==="CFD"){Q.cpus=Y.cpusLineEditor.value}else{Q.cpus=Y.perfSlider.value}if(Y.hasOwnProperty("dblPrecisionCombo")){Q.doublePrecision=Y.dblPrecisionCombo.currentValue}E.setSimConfig(al.getID(),Q,false,function(){},function(){})}else{var ae=false;if(R.codeName==="Abaqus/Explicit"||R.codeName==="Abaqus/Standard"){ae=true}var ac=R.clientSolverParameters.getElementsByTagName("argument");var T=0;for(var ai=0;ai<ac.length;ai++){if(t.isCloud&&ae&&ac[ai].getAttribute("parameter")==="-cpus"){continue}if(ac[ai].getAttribute("modify")==="true"){var ah=O.getRoots()[T];if(ah){if(ah.options.grid.argType!=="Enumeration"){ac[ai].setAttribute("value",ah.options.currentVal)}else{var S=[];for(var ab=0;ab<ah.options.enumOpts.length;ab++){S.push(ah.options.enumOpts[ab].valueItem)}var U=S.indexOf(ah.options.currentVal);if(U!==-1){S.splice(U,1)}S.unshift(ah.options.currentVal);ac[ai].setAttribute("value",S.join("|"))}}T++}else{if(ac[ai].getAttribute("parameter")==="applicationName"&&ac[ai].getAttribute("applicationInfo")==="true"&&af.name===""){af.name=ac[ai].getAttribute("value");var ad=ac[ai].parentNode.querySelector("[parameter='applicationVersion']");if(ad&&ad.getAttribute("value")){af.version=ad.getAttribute("value")}}}}if(af.name.trim()!==""&&af.version.trim()!==""){E.process.setApplicationInfo(E.behaviors[al.phID].activity,af,function(){},function(){})}}}var V=new u("spec",z);var ak=V.execute();for(var an in ak){var am=null;var P=(new XMLSerializer()).serializeToString(ak[an]);for(var ag=0;ag<z.components.length;ag++){var aa=Object.keys(z.components[ag].behaviors);for(var W=0;W<aa.length;W++){if(z.components[ag].behaviors[W].getID()===E.behaviors[an].behavior){am=z.components[ag].behaviors[W]}}}if(am.sim){E.getProcess().uploadSpec(E.behaviors[an].activity,P,function(){z.addMessage("The spec file has been updated.","info","log")},function(ap){var ao=e.get("proc_spec_update");if(ao==="proc_spec_update"){ao="The spec file could not be updated."}z.addMessage(ao,"error","notification",ap)})}}}G.end()};var M=function(){var Z=f.createElement("div");Z.setAttribute("class","container-fluid");L.global={};var O=G._getGlobalOptions(L.global,G._stationSelectionInfo["CSE-Director"]);O.inject(Z);var W=f.createElement("div");L["CSE-Director"]={};L["Results Generation"]={};var S=G._getDrmOptions(L["CSE-Director"],C,G._stationSelectionInfo["CSE-Director"]);var ah=new l({allowUnsafeHTMLHeader:false,header:"Cosimulation Master",body:S}).inject(Z);var P={};var ai=0;var ae=false;var T=z.getRoot();var ab=T.listInstances();for(var ag=0;ag<ab.length;ag++){var V=ab[ag].getSelectedBehavior();if(V){var Y=ab[ag].name;var ac=ab[ag].phID;L[Y]={};var U=G._getDrmOptions(L[Y],C,G._stationSelectionInfo[Y]);P[Y]=new l({allowUnsafeHTMLHeader:false,header:Y,body:U,}).inject(Z);if(V&&V.sim&&!V.is3dfmu){ae=true;var Q=E.getSimConfig(ab[ag].getID());if(!Q){Q={};Q.cpus="1";Q.doublePrecision="false"}var al=G._getsimFmuOptions(L[Y],V,Q);al.inject(U)}else{if(V&&V.is3dfmu){ae=true;var al=G._get3dfmuOptions(L[Y],V);al.inject(U);var X=G._getSolverArgsUI(ab[ag]);X.inject(U);if(V.codeName!=="Abaqus/Explicit"&&V.codeName!=="Abaqus/Standard"&&V.codeName!=="CFD"){ai++}}else{ai++}}}}var ad=G._getMasterOptions(L["CSE-Director"],ai);ad.inject(S);if(ae){var ak=f.createElement("div");var aa=G._getDrmOptions(L["Results Generation"],C,G._stationSelectionInfo["Results Generation"]);aa.inject(ak);var aj=new l({allowUnsafeHTMLHeader:false,header:"Results Generation",body:ak}).inject(Z)}var af={};af.editor=A;af.title="Execution Options";af.content=Z;af.width=450;af.height=440;af.onOK=function(){G._fillExecOptions(L,G._execOptData,G._stationSelectionInfo,G._stationSelectionIndex);A.addSystemSpinner(w);var am=function(){J();A.removeSystemSpinner(w);A.model.addMessage("ExecutionOptions_Saved","info","log")};q.saveExecOptions(E.getID(),G._execOptData,am,K);G.end()};af.onCancel=function(){G.end()};var R=new a(af);G.panel=R.getPanel();A.getImmersiveFrame().addWindow(G.panel)};var D=function(P){G.end();A.removeSystemSpinner(H);var O=e.get("exec_01");if(O==="exec_01"){O="The execution options could not be retrieved."}A.model.addMessage(O,"error","notification");A.model.addMessage(P,"error","notification")};var w={message:"Saving Execution Options...",exclusive:false};var K=function(P){A.removeSystemSpinner(w);var O=e.get("exec_02");if(O==="exec_02"){O="The execution options could not be saved."}A.model.addMessage(O,"error","notification");A.model.addMessage(P,"error","notification")};var I=function(){var O=function(V){A.removeSystemSpinner(H);A.model.addMessage("The execution options have been retrieved.","info","log");G._execOptData=V;var W=[];var Q={};var X={};var R,T;var S;var aa={};var Z={};for(var U=0;U<V.length;U++){if(V[U].title.startsWith("Activity")){aa.Activity=V[U]["title_display"]}else{if(V[U]["title"]==="OperatingSystem"){aa.OperatingSystem=V[U]["value"];Z.OperatingSystem=U}else{if(V[U]["title"]==="StationName"){aa.StationName=V[U]["value"];Z.StationName=U}else{if(V[U]["title"]==="Cleanup"){Z.Cleanup=U;aa.Cleanup=V[U]["value"]}else{if(V[U]["title"]==="Hosts"){Z.Hosts=U;aa.Hosts=V[U]["value"]}else{if(V[U]["title"]==="CPUs"){Z.CPUs=U;aa.CPUs=V[U]["value"]}else{if(V[U]["title"]==="drmMode"){aa.drmMode=V[U]["value"];Z.drmMode=U}else{if(V[U]["title"]==="CosimGroup"){aa.CosimGroup=V[U]["value"];Z.CosimGroup=U}else{if(V[U]["title"]==="RunTimeLimit"){Z.RunTimeLimit=U;aa.RunTimeLimit=V[U]["value"];var Y=JSON.parse(JSON.stringify(aa));W.push(Y);Q[Y.Activity]=Y;var P=JSON.parse(JSON.stringify(Z));X[Y.Activity]=Z;if(R===""&&T!=="Experiment"&&aa.drmMode!=="Lsf"){y=false}else{if(R==="{localhost}"&&T!=="Experiment"&&aa.drmMode!=="Lsf"){v=true}}aa={};Z={}}}}}}}}}}}G._stationSelectionInfo=Q;G._stationSelectionIndex=X;M()};q.getExecOptions(E.getID(),O,D)};var F=function(){var O=function(P){C=P.Drms.Drm;I()};q.getDrms(O,D)};F()},_fillExecOptions:function(A,B,z,w){var y=A.global;var v=function(C,D){B[D.OperatingSystem]["value"]=C.opLineEditor.value;B[D.StationName]["value"]=C.stationLineEditor.value;B[D.Cleanup]["value"]=y.cleanupTypesCombo.currentValue;B[D.Hosts]["value"]=C.hostsLineEditor.value;B[D.drmMode]["value"]=C.drmTypesCombo.currentValue;B[D.CosimGroup]["value"]=C.cosimLineEditor.value;if(y.hasOwnProperty("timeLineEditor")){B[D.RunTimeLimit]["value"]=y.timeLineEditor.value}if(C.hasOwnProperty("cpusLineEditor")){if(parseInt(C.cpusLineEditor.value)){B[D.CPUs]["value"]=C.cpusLineEditor.value}}if(C.drmTypesCombo.currentValue==="Lsf"){B[D.StationName]["value"]=""}};for(var x in z){if(z.hasOwnProperty(x)&&x!=="Experiment"){v(A[x],w[x])}}},_checkIllegalArguments:function(z){var A=0;var x=this;var y=x.getFrameWindow();var w=y.RFLEditor;var v=w.model;z.getRoots().forEach(function(C){var B=C.options.grid.argName;var E=C.options.currentVal;var D=C.options.grid.argType;if(B!=="additionalArguments"&&D!=="Enumeration"&&E.toString().trim()===""){A++}});if(A){v.addMessage("All solver Arguments except additionalArguments can only take non-empty values.","warning","notification");return true}else{return false}},endExecute:function(){var v=this;if(v.panel){if(!v.panel.closeButtonClicked){v.panel.close()}v.panel=null}}});return r});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleOpenAuthoringCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/SMAMSExperimentServices/Behavior","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages"],function(f,b,e,d){var c=b.extend({init:function(g){this._parent(g,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var i=this.getFrameWindow();var h=i.RFLEditor;var g=h.model;var j=h.gr.selection.first;if(!j){g.addMessage("You must select a component first.","warning","notification");return}else{a(j,function(k){h.eventHandler.openModelInApp(k.modelID,k.modelType,k.appID)})}this.end()},});var a=function(k,l){var j=k.data.RFLComponent;var g=j.getSelectedBehavior();var i=j.getReference().getModel();if(g.appName&&g.appName.length>0){var h={};h.physicalId=g.getID();h.onComplete=function(o){if(!o||!o.physicalId){var m=d.get("beh_10");m+=" ";m+=d.get("beh_10a");i.addMessage(m,"error","notification");return}var n={};n.modelID=o.physicalId;n.modelType=o.type;n.appID=g.appName;l(n)};h.onFailure=function(n){var m=d.get("beh_10");m+=" ";m+=d.get("beh_10a");i.addMessage(m,"error","notification");return};e.getSimulationObject(h)}};return c});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleJobAbortCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","css!UIKIT/UIKIT.css","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMWebServicesUtils","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/SMAMSExecutionServices/SMAMSCommonServices"],function(e,b,f,h,j,c,g,i,d){var a=b.extend({init:function(k){this._parent(k,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var p=this;var s=p.getFrameWindow();var q=s.RFLEditor;q.hideContextualBar();var m=q.model.getExperiment();if(m===null||typeof(m)===undefined){var r=i.get("exp_not_created");if(r==="exp_not_created"){r="An experiment must be created first."}q.model.addMessage(r,"error","notification");p.end();return}var t=j.ThreeDSpaceUrl;var l=m.getID();var o=null;var k=false;var v=function(x){if(!k){var w=i.get("exec_04");if(w==="exec_04"){w="The execution of the experiment could not be aborted."}q.model.addMessage(w,"error","notification",x)}p.end()};var n=function(z){var w=z.status;var B=function(){if(w==="NotStarted"){var D=j.ThreeDSpaceUrl+"/resources/slmservices/jobinfo/job/"+z.jobPhysicalId+"/Execution/state";D=D+"?State=Done&CC=Canceled&StartDate="+Date.now()+"&EndDate="+Date.now();var C={method:"POST",data:null,onComplete:function(){k=true;m.monitoring.setStatus("aborted");p.end()},onFailure:v};c._request(D,C)}else{v()}};if(z===null){var x=i.get("exec_12");if(x==="exec_12"){x="No jobs have been run for this process."}q.model.addMessage(x,"warning","notification");return}if(w==="Aborted"||w==="Failed"||w==="Completed"){var x=i.get("exec_05");if(x==="exec_05"){x="No running job is found."}q.model.addMessage(x,"warning","notification");p.end()}else{var A=o+"/execution/"+z.eedJobId+"/cancel";var y={method:"PUT",headers:{EEDTicket:z.cosTicket},data:null,onComplete:function(){k=true;m.monitoring.setStatus("aborted");p.end()},onFailure:B};c.normalRequest(A,y)}};var u=function(w){o=w;d.getJobInfo(l,n,v)};d.getEEDUrl(u,v)},endExecute:function(){}});return a});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleSearchCmd",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages"],function(d,a,c){var b=a.extend({init:function(e){this._parent(e,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},_onChange:function(h,m,q){var n=h.getSelectedObjectIds();var r=m.root;var p=m.getSize().width/2;var o=m.getSize().height/2;for(var k=0;k<n.length;k++){var f=n[k];p+=10*k;o+=10*k;var g=m.gr.views.main.clientToViewpoint(p,o);if(r){var e=r.listInstances();for(var l=0;l<e.length;l++){if(g[0]===parseInt(e[l].view.left)+55){g[0]=parseInt(e[l].view.left)+170}if(Math.floor(g[1])===parseInt(e[l].view.top)+43){g[1]=parseInt(e[l].view.top)+134}}}m.eventHandler.onSearchSelect(f,g[0],g[1],function(){if(q){q()}})}},execute:function(){var g=this;var f=this.getFrameWindow();var e=f.RFLEditor;e.hideContextualBar();require(["DS/TransientWidget/TransientWidget"],function(i){if(i.isWidgetOpen()){e.model.addMessage("Pin the widget to the dashboard to use this feature","warning","notification")}var h=d.createElement("sp-search");h.multiSelect=true;h.plmTypes="RFLVPMLogicalReference";if(h.search){h.search("Log*")}h.addEventListener("change",(function(){g._onChange(h,e)}).bind(h,g));g.end()})}});return b});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleZoomInCmd",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages"],function(d,a,c){var b=a.extend({init:function(e){this._parent(e,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var g=this;var j=g.getFrameWindow();var f=j.RFLEditor;f.hideContextualBar();var i=f.root;if(!i){var e=c.get("sys_01");if(e==="sys_01"){e="An experiment must be created first."}f.model.addMessage(e,"error","notification")}else{var h=f.gr;h.views.main.zoominc(1)}g.end()}});return b});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleJobLogCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","css!UIKIT/UIKIT.css","DS/SMAProcWebCMMUtils/SMAJSCMMAuthoringUtils","DS/SMAProcWebCMMUtils/SMAJSCMMWebServicesUtils","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/SMAMSExecutionServices/SMAMSCommonServices"],function(e,b,f,h,k,c,g,j,i,d){var a=b.extend({init:function(l){this.panel=null;this.messageObj=null;this._parent(l,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var q=this;var t=q.getFrameWindow();var r=t.RFLEditor;r.hideContextualBar();var n={message:"Loading Job Log...",exclusive:false};q.messageObj=n;r.addSystemSpinner(q.messageObj);var m=r.model.getExperiment();if(m===null||typeof(m)===undefined){var s=j.get("exp_not_created");if(s==="exp_not_created"){s="An experiment must be created first."}r.model.addMessage(s,"error","notification");q.end();return}var l=m.getID();var p=null,v=null;var w=function(y){var x=j.get("exec_03");if(x==="exec_03"){x="The job log could not be retrieved."}q.end();r.removeSystemSpinner(n);r.model.addMessage(x,"error","notification",y)};var o=function(A){r.removeSystemSpinner(n);if(A===null){var x=j.get("exec_12");if(x==="exec_12"){x="No jobs have been run for this process."}r.model.addMessage(x,"warning","notification");q.end();return}var z=function(D){var E=e.createElement("sp-job-log");E.eedBaseURL=p;E.jobObjectId=A.jobPhysicalId;E.jobExecutionStatus=A.status;E.eedjobId=A.eedJobId;E.eedTicket=A.eedTicket;E.getJobLog();D.appendChild(E)};var y=e.createElement("div");y.setAttribute("class","container-fluid");y.style.height="100%";z(y);var B={};B.editor=r;B.title="Job Log";B.content=y;B.width=501;B.height=415;B.hideFooter=true;B.onOK=function(){q.end()};B.onCancel=function(){q.end()};B.onMaximize=function(){var D=q.panel.getContent().querySelector("sp-job-log");if(D.parentElement){D.parentElement.removeChild(D)}z(y)};B.onMinimize=function(){var D=q.panel.getContent().querySelector("sp-job-log");if(D.parentElement){D.parentElement.removeChild(D)}z(y)};if(q.isRunning()){var C=new i(B);q.panel=C.getPanel();r.getImmersiveFrame().addWindow(q.panel)}};var u=function(x){p=x;d.getJobInfo(l,o,w)};d.getEEDUrl(u,w)},endExecute:function(){var n=this;var o=n.getFrameWindow();var m=o.RFLEditor;if(n.messageObj){m.removeSystemSpinner(n.messageObj);n.messageObj=null}if(n.panel){if(!n.panel.closeButtonClicked){var l=n.panel.getContent().querySelector("sp-job-log");if(joblog&&l.parentElement){l.parentElement.removeChild(l)}n.panel.close()}n.panel=null}}});return a});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleEmptyCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/SMAProcWebCMMUtils/SMAJSCMMUtils"],function(h,a,b,d,g,f,e){var c=a.extend({init:function(i){this.odtCallback=null;this.panel=null;this._parent(i,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var k=this;var o=k.getFrameWindow();var l=o.RFLEditor;l.hideContextualBar();var p=l.root;if(!p){var m=g.get("sys_01");if(m==="sys_01"){m="An experiment must be created first."}l.model.addMessage(m,"error","notification");k.end();return}var n=new b({className:"vertical",fields:[{type:"text",name:"referenceName",label:"Name"},{type:"textarea",name:"referenceDesc",label:"Description"}]});var j=h.createElement("div");j.setAttribute("class","container-fluid");n.inject(j);var q={};q.editor=l;q.title="Create Component";q.content=j;q.height=235;q.onOK=function(){var u=n.getValue("referenceName");if(!u.trim()||!e.isValidTitle(u)){l.model.addMessage("Component name cannot be empty or contain special characters.","warning","notification");n.getField("referenceName").focus()}else{var B=n.getValue("referenceDesc");var w=n.getValue("referenceName")+"-1";var A=(o.getUIFrame().offsetWidth)/2;var z=o.getUIFrame().offsetHeight*0.25;var s=l.gr.views.main.clientToViewpoint(A,z);var r=p.listInstances();for(var v=0;v<r.length;v++){if(s[0]===parseInt(r[v].view.left)+55){s[0]=parseInt(r[v].view.left)+170}if(Math.floor(s[1])===parseInt(r[v].view.top)+43){s[1]=parseInt(r[v].view.top)+134}}var t={};t.title=u;t.type="DS/RFLModelerWeb/RFL_Component";p.getModel().createComponent(t,function(x){x.description=B;p.addInstance1(s[0],s[1],110,86,w,null,x.getID(),function(y){if(k.odtCallback){k.odtCallback(y)}},function(){})},function(){});k.end()}};q.onCancel=function(){k.end()};var i=new f(q);k.panel=i.getPanel();l.getImmersiveFrame().addWindow(k.panel);n.getField("referenceName").focus()},endExecute:function(){var i=this;if(i.panel){if(!i.panel.closeButtonClicked){i.panel.close()}i.panel=null}}});return c});
/*! Copyright 2016 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleEditExpCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/UIKIT/Form","DS/Core/Core","i18n!DS/SMAMSWebUI/assets/nls/SMAMSMessages","DS/RFLModelerWeb/RFL_EditorPanel","DS/SMAProcWebCMMUtils/SMAJSCMMUtils"],function(h,a,b,d,g,f,e){var c=a.extend({init:function(i){this.panel=null;this._parent(i,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){var n=this;var p=n.getFrameWindow();var o=p.RFLEditor;var m=o.model;o.hideContextualBar();var j=o.model.getExperiment();var k=h.createElement("div");k.setAttribute("class","container-fluid");var q={};q.editor=o;q.title="Experiment";q.height=235;q.onCancel=function(){n.end()};if(j){var l=new b({className:"vertical",fields:[{type:"text",name:"experimentName",label:"Name",value:j.getInfo().title},,{type:"textarea",name:"experimentDesc",label:"Description",value:j.getInfo().description,pattern:"[a-zA-Z]+"}]}).inject(k);q.onOK=function(){var r=l.getValue("experimentName");if(!r.trim()||!e.isValidTitle(r,"process")){m.addMessage("Experiment name cannot be empty or contain special characters.","warning","notification");l.getField("experimentName").focus()}else{var s=l.getValue("experimentDesc");j.setInfo({title:r,description:s,physicalId:j.phID},function(){var v=h.clone(widget.getValue("recentExp"));if(!v){v=[]}if(v.length>4){v.splice(0,v.length-4)}var t={name:j.name,description:j.description,phID:j.phID};for(var u=0;u<v.length;u++){var w=v[u];if(w.phID===t.phID){v.splice(u,1)}}v.push(t);widget.setValue("recentExp",v)},function(){});if(typeof widget!=="undefined"&&h.is(widget)&&h.is(widget.getValue)){widget.setTitle(r)}n.end()}}}else{n.end();return}q.content=k;var i=new f(q);n.panel=i.getPanel();o.getImmersiveFrame().addWindow(n.panel);l.getField("experimentName").focus()},endExecute:function(){var i=this;if(i.panel){if(!i.panel.closeButtonClicked){i.panel.close()}i.panel=null}}});return c});
/*! Copyright 2015 Dassault Systemes */
define("DS/SMAMSWebUI/SMAMultiScaleGraphCmd",["UWA/Core","DS/ApplicationFrame/Command"],function(g,c){var e=c.extend({init:function(h){this._parent(h,{isAsynchronous:true,isEnabled:false,mode:"exclusive"})},execute:function(){widget.editor.hideContextualBar();var j=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame;var i=this.getFrameWindow().RFLEditor;var h=i;a(h);this.end()}});function d(m,o){var p,q,l,k,h;q=0;for(l=m.gr.nodes.first;l;l=l.next){++q}p=Math.max(1,Math.ceil(Math.sqrt(q)));k=h=0;for(l=m.gr.nodes.first;l;l=l.next){l.data.targetLeft=k*200;l.data.targetTop=h*200;++k;if(k===p){++h;k=0}}if(o){m.gr.updateLock();try{for(l=m.gr.nodes.first;l;l=l.next){l.multiset("left",l.data.targetLeft,"top",l.data.targetTop)}}finally{m.gr.updateUnlock()}}else{m.animate();return m.cancelAnimation.bind(m)}}function f(i,h){this.v1=i;this.v2=h}function b(h){this.n=h;this.x=h.left;this.y=h.top;this.vx=0;this.vy=0;this.fx=NaN;this.fy=NaN}function a(t){function h(){var J,I,G,M,K,w,v,F,E,y,x;var D=[];var C=[];var L=[];function A(n){return n<0.2&&n>-0.2}function z(n){return n>300||n<-300}if(o){return}for(J=0,G=r.length;J<G;++J){r[J].x=r[J].n.left;r[J].y=r[J].n.top;r[J].fx=r[J].fy=0}for(J=0,G=r.length;J<G;++J){w=r[J];for(I=J+1;I<G;++I){v=r[I];F=v.x-w.x;E=v.y-w.y;M=F*F+E*E;K=Math.sqrt(M);F/=K;E/=K;y=s*F/M;x=s*E/M;w.fx+=-y;w.fy+=-x;v.fx+=y;v.fy+=x}}for(J=0,G=m.length;J<G;++J){F=m[J].v2.x-m[J].v1.x;E=m[J].v2.y-m[J].v1.y;M=F*F+E*E;K=Math.sqrt(M);D.push(K);F/=K;E/=K;y=l*K*F;x=l*K*E;m[J].v1.fx+=y;m[J].v1.fy+=x;m[J].v2.fx+=-y;m[J].v2.fy+=-x}for(J=0,G=r.length;J<G;++J){r[J].vx=(r[J].vx+r[J].fx)*p;r[J].vy=(r[J].vy+r[J].fy)*p;r[J].x+=r[J].vx;r[J].y+=r[J].vy}if(t.gr){for(var H=t.gr.nodes.first;H;H=H.next){var B=H.data.RFLComponent;B.setPosition([B.view.left,B.view.top])}for(J=0,G=m.length;J<G;++J){F=m[J].v2.x-m[J].v1.x;E=m[J].v2.y-m[J].v1.y;M=F*F+E*E;K=Math.sqrt(M);C.push(K)}for(J=0,G=D.length;J<G;++J){L[J]=C[J]-D[J]}if(L.every(A)||L.some(z)){cancelAnimationFrame(h)}else{t.gr.updateLock();try{for(J=0,G=r.length;J<G;++J){if(!t.gr.isSelected(r[J].n)){r[J].n.multiset("left",r[J].x,"top",r[J].y)}}}finally{t.gr.updateUnlock()}requestAnimationFrame(h)}}}var r,m,i,q,k,o;function u(){o=true}var j,s,l,p;j=190*2;s=100000;l=s/(j*j*j);p=0.8;o=false;r=[];k=Object.create(null);for(i=t.gr.nodes.first;i;i=i.next){r.push(k[i.data.RFLComponent.phID]=new b(i))}m=[];for(q=t.gr.edges.first;q;q=q.next){m.push(new f(k[q.cl1.c.node.data.RFLComponent.phID],k[q.cl2.c.node.data.RFLComponent.phID]))}requestAnimationFrame(h);return u}return e});
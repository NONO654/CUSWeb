define("DS/DELWeb3DViewer/ViewManager",["UWA/Core","UWA/Date","DS/PlatformAPI/PlatformAPI"],function(e,c,a){var d=function d(){var q="ViewManager",g="DS/PADUtils/PADCommandProxy/",f="MFNMGA",t={DROP:"drop",REMOVE:"remove",APPLY_FILTER:"applyFilter",SELECT:"select",CLEAN_ALL:"cleanAll"};var n,j,m,l,k,i,s,o,p;n=function n(){var u="/no_private_channel";if(e.is(widget)){if(e.is(widget.getValue("x3dSharedId"))){u="/"+widget.getValue("x3dSharedId")}else{if(e.is(widget.getValue("x3dAppId"))){u="/"+widget.getValue("x3dAppId")}else{if(e.is(widget.getValue("appId"))){u="/"+widget.getValue("appId")+"_"+widget.id}}}}return u};j=function j(v){var x=n(),w,u=null;if(e.is(v)){w=(((1+Math.random())*65536)|0).toString(16).substring(1);u={metadata:{timestamp:c.now(),originUid:w,appid:x,originWidgetId:v}}}return u};m=function m(u){return u+"/"+f};l=function l(v,u,x,B){var D=B||{},w=e.is(D.privateEvent,"boolean")?D.privateEvent:false,A={},z,y,C=null;if(e.is(u)){A.data=u}y=j(x);if(e.is(y)){A=e.merge(A,y);if(w){z=g+v+n()}else{z=g+v}C={name:z,parameters:A}}return C};k=function k(z){var x=t.DROP,A=e.is(z.rootReferenceIds)?z.rootReferenceIds:null,w=e.is(z.filterQuery3d)?z.filterQuery3d:null,v=e.is(z.originWidgetId)?z.originWidgetId:null,y,u;if(e.is(A)){if(e.is(w)){u={rootsWithFilters:[{filter:{CVQuery3D:w,filterRootIds:A}}]}}else{u={pids:A}}}if(e.is(v)&&e.is(u)){y=l(x,u,v,{privateEvent:true});if(e.is(y)){a.publish(y.name,y.parameters)}}};i=function i(y){var w=t.REMOVE,z=e.is(y.rootReferenceIds)?y.rootReferenceIds:null,v=e.is(y.originWidgetId)?y.originWidgetId:null,u,x;if(e.is(z)){u={pids:z}}if(e.is(v)&&e.is(u)){x=l(w,u,v,{privateEvent:true});if(e.is(x)){a.publish(x.name,x.parameters)}}};s=function s(A){var x=t.APPLY_FILTER,B=e.is(A.rootReferenceIds)?A.rootReferenceIds:null,w=e.is(A.filterQuery3d)?A.filterQuery3d:null,v=e.is(A.originWidgetId)?A.originWidgetId:null,z=e.is(A.removeFilter,"boolean")?A.removeFilter:false,y,u;if(e.is(B)&&e.is(w)){u={filterRootIds:B,CVQuery3D:w};if(z===true){u.empty=z}}if(e.is(v)&&e.is(u)){y=l(x,u,v,{privateEvent:true});if(e.is(y)){a.publish(y.name,y.parameters)}}};o=function o(x){var v=t.CLEAN_ALL,u=e.is(x.originWidgetId)?x.originWidgetId:null,w;if(e.is(u)){w=l(v,null,u,{privateEvent:true});if(e.is(w)){a.publish(w.name,w.parameters)}}};p=function p(z){var w=t.SELECT,x=e.is(z.occPathsWithRefDetail)?z.occPathsWithRefDetail:null,v=e.is(z.originWidgetId)?z.originWidgetId:null,u,y;if(e.is(x)){u={paths:x}}if(e.is(v)&&e.is(u)){y=l(w,u,v,{privateEvent:false});if(e.is(y)){a.publish(y.name,y.parameters)}}};return{getAllEventHandlers:function h(){var u={};u[t.DROP]=k;u[t.REMOVE]=i;u[t.APPLY_FILTER]=s;u[t.CLEAN_ALL]=o;u[t.SELECT]=p;return u},subscribeToAllInterWidgetEvents:function r(){var v=this.getAllEventHandlers();Object.keys(v).forEach(function u(w){var x=m(w);a.subscribe(x,v[w])})}}};var b=(function b(){var f;return{getInstance:function g(){if(!e.is(f)){f=new d()}return f}}})();return b});define("DS/DELWeb3DViewer/init",["UWA/Core","DS/Logger/Logger","DS/PADUtils/PADSettingsMgt","DS/ENOPAD3DViewer/PAD3DViewer"],function(g,b,c,a){var f={name:"init3D",_logger:null,onLoad:function d(){var i=f;if(g.is(b)){f._logger=b.getLogger(f)}f.widget=widget;function j(){if(!i.widget.getValue("x3dSharedId")&&!i.widget.getValue("x3dAppId")){i.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"DELWebMfgAssets_appId"})}c.setSetting("lang",i.widget.lang);i.widget.addEvent("endEdit",c.updateWidgetPreferences.bind(c));i.widget.mergePreferences(c.getWidgetPreferences());c.addEvent("onEnox3dsc_activateBI",function(k){if(i.pad3DViewer&&i.pad3DViewer.getBIController()){i.pad3DViewer.getBIController().toggleBetweenStandaloneAndSlaveMode(k===true?"STANDALONE":"SLAVE")}});c.addEvent("onEnox3dsc_navigate_with_wrap",function(k){if(i.pad3DViewer&&i.pad3DViewer.getController()){i.pad3DViewer.getController().setWrapUsage(k)}});c.addEvent("onDisplay_sceneGraph",function(k){if(i.pad3DViewer){i.pad3DViewer.displayTree(k)}});c.addEvent("onPaddebug_section",function(k){if(i.pad3DViewer){if(k&&i.paddebug===false){i.paddebug=true;i.pad3DViewer.loadActionBar({merge:true,file:"PADDebug.xml",module:"PADDebug"})}}});c.updateWidgetPreferences();if(!i.widget.getValue("ENOX3DSC_RootIds")){widget.addPreference({name:"ENOX3DSC_RootIds",type:"hidden",defaultValue:"[]"})}if(!i.widget.getValue("ENOX3DSC_DetachedRootIds")){widget.addPreference({name:"ENOX3DSC_DetachedRootIds",type:"hidden",defaultValue:"[]"})}if(!i.widget.getValue("x3dSharedId")&&!i.widget.getValue("x3dAppId")){i.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENOPAD_appId"})}}function h(){i.pad3DViewer.subscribe({event:"onActionBarReady"},function(){i.widget.setBody(i.pad3DViewer.render());if(c.getSetting("paddebug_section")&&i.paddebug===false){i.paddebug=true;i.pad3DViewer.loadActionBar({merge:true,file:"PADDebug.xml",module:"PADDebug"})}if(i.widget.widgetDomain&&i.widget.widgetDomain.indexOf("debug_me")>0){if(g.is(f._logger)){f._logger.warn("Debug mode activated")}i.pad3DViewer.displayTree(c.getSetting("display_sceneGraph"));if(i.pad3DViewer.getBIController()){i.pad3DViewer.getBIController().toggleBetweenStandaloneAndSlaveMode(c.getSetting("enox3dsc_activateBI")===true?"STANDALONE":"SLAVE")}}if(i.pad3DViewer.getLevelSelectorCommand){i.pad3DViewer.getLevelSelectorCommand(function(k){if(k){k.displayLabels(true)}})}i.widget.dispatchEvent("onENOPADReady")});i.pad3DViewer.subscribe({event:"onRootAdded"},function(l){var k;if(l.rootLog){k=l.rootLog;i.widget.setValue("ENOX3DSC_RootIds",JSON.stringify(k))}i.pad3DViewer.getContentName({callbacks:{onComplete:function(m){i.widget.setTitle(m.contentName)}}})});i.pad3DViewer.subscribe({event:"onRootRemoved"},function(l){var k;if(l.rootLog){k=l.rootLog;i.widget.setValue("ENOX3DSC_RootIds",JSON.stringify(k))}i.pad3DViewer.getContentName({callbacks:{onComplete:function(m){i.widget.setTitle(m.contentName)}}})});i.pad3DViewer.subscribe({event:"onRootAttached"},function(m){var k,l;if(m.id){k=JSON.parse(i.widget.getValue("ENOX3DSC_DetachedRootIds"));for(l=0;l<k.length;l++){if(k[l]===m.id){k.splice(l,1);break}}i.widget.setValue("ENOX3DSC_DetachedRootIds",JSON.stringify(k))}i.pad3DViewer.getContentName({callbacks:{onComplete:function(n){i.widget.setTitle(n.contentName)}}})});i.pad3DViewer.subscribe({event:"onRootDetached"},function(l){var k;if(l.id){k=JSON.parse(i.widget.getValue("ENOX3DSC_DetachedRootIds"));k.push(l.id);i.widget.setValue("ENOX3DSC_DetachedRootIds",JSON.stringify(k))}i.pad3DViewer.getContentName({callbacks:{onComplete:function(m){i.widget.setTitle(m.contentName)}}})})}if(!i.pad3DViewer){i.pad3DViewer=new a({widget:i.widget,windowOptions:{context:"Default",robotVisibility:false,defaultContextualBarVisibility:false,mouseProfile:"CATIA",BIMode:"SLAVE",viewerOptions:{svgMode:true}},allowAuthoring:false,authorizedRootTypes:["MCAD Assembly","MCAD Component","CATDrawing","VPMReference","VPMRepReference"],authorizeSet3DStructure:true,selectiveLoading:false});j();h()}},onRefresh:function e(){f.pad3DViewer.refresh()},};return f});define("DS/DELWeb3DViewer/App3D",["UWA/Core","DS/ENOPAD3DViewer/PAD3DViewer","DS/PADUtils/PADSettingsMgt","DS/DELWeb3DViewer/ViewManager","text!DS/DELWeb3DViewer/assets/json/3DViewerConfigurations.json"],function(f,b,c,e,d){var a=function a(){var l,g="DELMFNMGA_appId",m=e.getInstance();var k,i;k=function k(){if(!widget.getValue("x3dAppId")){widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:g})}c.set_app_context("enopad3dviewer",true);c.setSetting("lang",widget.lang);widget.mergePreferences(c.getWidgetPreferences());widget.addEvent("endEdit",c.updateWidgetPreferences.bind(c))};i=function i(){if(f.is(l)){l.subscribe({event:"onActionBarReady"},function n(){widget.setBody(l.render())});m.subscribeToAllInterWidgetEvents()}};return{onLoad:function h(){var n;if(!f.is(l)){k();n=JSON.parse(d);n=f.merge(n,{widget:widget});l=new b(n);i()}},onRefresh:function j(){if(f.is(l)){l.refresh()}}}};return a});
/*! Copyright 2015 Dassault Systemes. All rights reserved. */
(function(c){var b={EVERYTHING:"Everything",INPUTS:"Inputs",OUTPUTS:"Outputs",NONE:"None"},d={DIFFERENCE:"Difference",FULL_COMPARISON:"Full Comparison"},f=function(g){var i=[];switch(g.filter){case b.INPUTS:i=g.inputs;break;case b.OUTPUTS:i=g.outputs;break;case b.NONE:i=g.none;break;case b.EVERYTHING:default:i=g.every}if(g.mode===d.DIFFERENCE){var h=i.filter(function(j){return !j[0].matches});g.viewData=h}else{g.viewData=i}},a=function(g){g.titles=[];g.every=[];g.inputs=[];g.outputs=[];g.none=[];f(g);g.spinner.show();g.compareData=[];g.compareItems.forEach(function(h){Polymer.dom(g.$.simulationCompareData).setAttribute("uri","simulations/"+h.id+"/iosummaryview");g.$.simulationCompareData.getData()})},e=function(g){if(Array.isArray(g.simDetails)){g.compareData.push(g.simDetails)}if(g.compareData.length===g.compareItems.length){for(var k=0;k<g.compareItems.length;k+=1){for(var h=0;h<g.compareData.length;h+=1){if(g.compareData[h][0].objectId===g.compareItems[k].oid){g.compareData[h][0].physicalid=g.compareItems[k].id;g.compareData[h][0].revision=g.compareItems[k].basics.revision;if(k!==h){var l=g.compareData[k];g.compareData[k]=g.compareData[h];g.compareData[h]=l}break}}}require(["DS/WebappsUtils/WebappsUtils"],function(j){var i=j.getProxifiedWebappsBaseUrl()===null?j.getWebappsBaseUrl():j.getProxifiedWebappsBaseUrl();var m=new Worker(g.resolveUrl(i+"SMAProcPSUI/ps-simulation-compare-view/compare.js"));m.addEventListener("message",function(n){g.titles=n.data[0].slice(0);g.every=n.data[1].slice(1);g.inputs=n.data[2].slice(0);g.outputs=n.data[3].slice(0);g.none=n.data[4].slice(0);g.spinner.hide();f(g)},false);m.postMessage({imageBaseURL:g.resolveUrl("../assets/images/"),compareData:g.compareData})})}};Polymer({is:"ps-simulation-compare-view",behaviors:[c.DS.SMAProcSP.SPBase],properties:{activeitem:{type:Object,notify:true},compareItems:{type:Array,observer:"compareItemsChanged"},simDetails:{observer:"simDetailsChanged"},titles:{type:Array,value:function(){return[]},notify:true},viewData:{type:Array,value:function(){return[]},notify:true}},ready:function(){this.mode=d.FULL_COMPARISON;this.filter=b.EVERYTHING;this.every=[];this.inputs=[];this.outputs=[];this.none=[];this.compareData=[];var g=this;require(["UWA/Drivers/Alone","DS/UIKIT/Spinner"],function(j,h){var i=g.querySelector("#loadingIndicator");if(i){g.spinner=new h({className:"large"}).inject(i)}g.fire("attached")})},attached:function(){},simDetailsChanged:function(){if(!this.compareItems||this.compareItems.length<1){return}e(this)},compareItemsChanged:function(){if(!this.compareItems||this.compareItems.length<1){return}a(this)},openSimulation:function(h){var i=Polymer.dom(h).localTarget.id,g=this;(this.compareItems||[]).some(function(j){if(j.id===i){g.fire("open-simulation",j);return true}})},generateData:function(){var g=this.$.comparisonType.value;if(this.mode!==g){this.mode=g;f(this)}},filterData:function(h){var g=h.target.value;if(this.filter!==g){this.filter=g;f(this)}},_computeClass:function(g,j){var i="table-cell",h;if(j===d.FULL_COMPARISON&&g.matches!==h){i=i+" "+g.matches}return i},_computeLevelsWidth:function(g){return(parseInt(g.level||0,10)*16)+"px"},_computeIsIconSet:function(g){return Boolean(g.icon)},_computeIcon:function(g){return g.icon||""},_computeIsModeSet:function(g){return Boolean(this.filter===b.EVERYTHING&&g.ioMode)},_computeMode:function(g){var h="";if(this.filter===b.EVERYTHING){switch(g.ioMode){case"InputOutput":h=this.resolveUrl("../assets/images/smaIconIO.gif");break;case"Input":h=this.resolveUrl("../assets/images/smaIconInput.gif");break;case"Output":h=this.resolveUrl("../assets/images/smaIconOutput.gif");break}}return h},_computeStyles:function(g){var h;switch(g.title){case"Simulation":case"Activity":g.level=1;h="otherTitle simActTitle";break;case"Attributes":case"Parameters":case"OwnedContent":case"ReferencedContent":h="otherTitle";break;case"Simulation Inputs":case"Simulation Outputs":case"Neutral":h="otherTitle ioTitle";break;default:h="multivalue"}if("true"===g.mandatory){h="mandatory"}return h}})}(this));
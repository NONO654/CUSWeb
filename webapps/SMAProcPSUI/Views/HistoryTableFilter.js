define("DS/SMAProcPSUI/Views/HistoryTableFilter",["UWA/Core","UWA/Element","UWA/Controls/Abstract","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/SMAProcSPUI/Views/Select","DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom","css!DS/UIKIT/UIKIT.css","css!DS/Core/wux.css","css!DS/SMAProcPSUI/ps-parameter-history/ps-parameter-history.css","css!DS/SMAProcPSUI/Views/HistoryTableFilter.css"],function(f,d,i,h,c,g,b,e,a){var j=i.extend({id:"history-table-filter",className:"HistoryTableFilter",spreadsheet:null,isDestroyed:false,onLoad:function(){var s=this.options;var n=this;var q=e.getWebappsAssetUrl("SMAProcPSUI","images/smaIconInput.gif");var k=e.getWebappsAssetUrl("SMAProcPSUI","images/smaIconOutput.gif");var p=e.getWebappsAssetUrl("SMAProcPSUI","images/smaIconIO.gif");if(s.data&&s.data.length>0){this.model=new c({useAsyncPreExpand:true});this.model.prepareUpdate();for(var o=0;o<s.data.length;o+=1){var m=new g({label:o,grid:s.data[o]});this.model.addRoot(m);m=null}this.model.pushUpdate()}var r=new h({columns:[{text:"",dataIndex:"selection",type:"selection",width:30},{dataIndex:"name",text:"Name"},{dataIndex:"mode",text:"Mode",isFilterable:true,onCellRequest:function(u){if(!u.nodeModel._options){return}var t=u.nodeModel._options.grid.mode;u.cellView.elements.container.setContent(u.cellView.elements.layout);switch(t){case"input":u.cellView.elements.layout.setContent("<img src="+q+"></img>");break;case"output":u.cellView.elements.layout.setContent("<img src="+k+"></img>");break;case"both":u.cellView.elements.layout.setContent("<img src="+p+"></img>");break;default:u.cellView.elements.layout.setContent(" ")}}}],usePager:true,height:"auto",isEditable:false,defaultCellHeight:30,showVerticalLines:true,isSortable:false,selection:{nodes:false,cells:false,rowHeaders:true,columnHeaders:true,unselectAllOnEmptyArea:false,toggle:true,canMultiSelect:true},show:{rowHeaders:false},resize:{columns:true,rows:false},apiVersion:2});var l=r.getManager();l.onReady(function(){l.loadDocument(this.model);var u=l.options.columns[0].dataIndex;l.hideColumn(u);var t=n.spreadsheet.getContent();t.querySelector(".wux-datagrid").style.top=s.topPadding;t.querySelector(".wux-datagrid").style.bottom="80px";n.dispatchEvent("onReady")}.bind(this));this.spreadsheet=r;this.spreadsheet.inject(s.container);this.buildToolbar(s,this.model);a.onNodeRendered(l.elements.container,function(){if(!n.nodeRendered){n.nodeRendered=true;var x=l.getContent().clientWidth;l.setColumnWidth("name",x-80);l.setColumnWidth("mode",50);var u=l.getNumberOfRows();var v=0;while(v<u){var t=l.getCell(v,"name");t.setCellStyle({"text-align":"left"});t=l.getCell(v,"mode");var w=t.getCellContent();switch(w){case"input":t.setCellContent("<img src="+q+"></img>");break;case"output":t.setCellContent("<img src="+k+"></img>");break;case"both":t.setCellContent("<img src="+p+"></img>");break;default:t.setCellContent("")}t.setCellStyle({"text-align":"left"});v=v+1}l.prepareUpdateView();n.options.selectAll&&l.selectAll();l.pushUpdateView()}})},buildToolbar:function(l,k){var n=this;n.toolbar=new f.Element("div",{"class":"toolbar"}).inject(l.toolbarDiv);var m=new b({disabled:false,multiple:false,name:"select",placeholder:"Select Mode",type:"select",className:"selectMode",options:[{label:"Input",value:"Input"},{label:"Input/Output",value:"Input/Output"},{label:"Output",value:"Output"},{label:"Neutral",value:"Neutral"},{label:"Select All",value:"Select All"},{label:"Clear All",value:"Clear All"}],events:{onChange:function(p){var q=p.target.value;var o=k.getRoots();if(q==="Input"){o.forEach(function(s){var r=s.options.grid.mode;if(r==="input"){s.select()}else{s.unselect()}})}else{if(q==="Output"){o.forEach(function(s){var r=s.options.grid.mode;if(r==="output"){s.select()}else{s.unselect()}})}else{if(q==="Input/Output"){o.forEach(function(s){var r=s.options.grid.mode;if(r==="both"){s.select()}else{s.unselect()}})}else{if(q==="Neutral"){o.forEach(function(s){var r=s.options.grid.mode;if(r==="none"){s.select()}else{s.unselect()}})}else{if(q==="Select All"){o.forEach(function(r){r.select()})}else{if(q==="Clear All"){o.forEach(function(r){r.unselect()})}}}}}}}}});n.toolbar.appendChild(m.getContent());n.toolbar.selectMode=m},init:function(k){this._parent(k);this.onLoad()},onReady:function(){var k=this;setTimeout(function(){k.spreadsheet.dispatchEvent("filterready");var l=k.spreadsheet.getManager(),n=l.getContent().clientWidth,m=k.options.data.length>10?100:80;l.setColumnWidth("name",n-m);l.setColumnWidth("mode",50)},0)},getSelection:function(){var p=[],o=this.spreadsheet.getManager();var l=o.getNumberOfRows();var q=0;while(q<l){var k=o.getCell(q,"name"),n=k.getCellContent(),m=k.isSelected();p.push({name:n,isSelected:m});q=q+1}return p},setSelection:function(l){var k=this.spreadsheet.getManager();k.prepareUpdateView();if(l&&l.length>0){this.model.getRoots().forEach(function(m){var n=m._options.grid.name;k.processRows(function(p,o){if(n===l[o].name&&l[o].isSelected){k.selectRow(o,false);m.select()}else{if(n===l[o].name&&!l[o].isSelected){m.unselect()}}})})}else{k.selectAll()}k.pushUpdateView()},clearSelectedMode:function(){this.toolbar.selectMode.clearCheck()},destroy:function(){this.isDestroyed=true;this.spreadsheet.getManager().destroy();this.spreadsheet=null;if(this.toolbar){this.toolbar.destroy()}this._parent()}});return j});
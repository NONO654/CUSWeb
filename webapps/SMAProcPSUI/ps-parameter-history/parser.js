var STATUS_CODE={10:"OK",20:"Job Cancelled",25:"Work item cancelled",40:"FAILED",50:"System Error",60:"Timeout",70:"Parameter Limits violated"};function Parser(){this.response={jobData:{},activityData:{},parameterNames:[],parameterTypes:[],parameterValues:[]}}Parser.prototype.ProcessJobData=function(b){var c=0,d="\t",a=b.split(d),e;for(c=0;c<a.length;c+=1){e=a[c];if(e.indexOf("JOB")>-1){this.response.jobData.JobName=a[++c]}else{if(e.indexOf("USER=")>-1){this.response.jobData.UserName=e.split("=")[1]}else{if(e.indexOf("START=")>-1){this.response.jobData.StartDate=e.split("=")[1]}else{if(e.indexOf("END=")>=0){this.response.jobData.EndDate=e.split("=")[1]}else{if(e.indexOf("SNAP=")>=0){this.response.jobData.snap=e.split("=")[1]}}}}}}};Parser.prototype.ProcessActivityData=function(b){var c=0,d="\t",a=b.split(d),e;for(c=0;c<a.length;c+=1){e=a[c];if(e.indexOf("ACTIVITY")>-1){this.response.activityData.ActPath=a[++c]}else{if(e.indexOf("ACTIVITY")>-1){this.response.activityData.SubFlowPath=a[++c]}else{if(e.indexOf("FIXED=")>-1){this.response.activityData.Fixed=e.split("=")[1]}else{if(e.indexOf("INPUTS=")>-1){this.response.activityData.Inputs=e.split("=")[1]}else{if(e.indexOf("OUTPUTS=")>-1){this.response.activityData.Outputs=e.split("=")[1]}else{if(e.indexOf("ROWS=")>-1){this.response.activityData.Rows=e.split("=")[1]}}}}}}}};Parser.prototype.ProcessParameterNames=function(b){var c=0,d="\t",a=b.split(d),e="";for(c=0;c<a.length;c+=1){e=a[c];this.response.parameterNames.push({dataIndex:e,text:e})}};Parser.prototype.ProcessParameterTypes=function(b){var c="\t",a=b.split(c);this.response.parameterTypes=a};Parser.prototype.ProcessResultData=function(b){var d=0,e="\t",a=b.split(e),f,g,c={};for(d=0;d<a.length;d+=1){f=this.response.parameterNames[d].dataIndex;g=a[d];if(f!=="RUN ID"&&f!=="RUN TYPE"&&f!=="STATUS"){var h=g.indexOf("]");if(h!==-1){g=g.replace(/[\x1E]/g,",").slice(h+2)}}if(g.length===2&&g.charCodeAt(0)===27&&g.charCodeAt(1)===63){g=""}c[f]=g}if(c.STATUS!==0){this.response.parameterValues.push(c)}};Parser.prototype.PostProcess=function(){var b=0,a=-1;for(b=0;b<this.response.parameterNames.length;b+=1){if(this.response.parameterNames[b].dataIndex.indexOf("RUN TYPE")>-1){a=b;break}}if(a>-1){this.response.parameterNames.splice(a,1);this.response.parameterTypes.splice(a,1);for(b=0;b<this.response.parameterValues.length;b+=1){this.response.parameterValues[b].STATUS=STATUS_CODE[this.response.parameterValues[b].STATUS]}}};Parser.prototype.ProcessTSVData=function(c){var a=0,b="\n",d=c.split(b);this.ProcessJobData(d[1]);this.ProcessActivityData(d[2]);this.ProcessParameterNames(d[3]);this.ProcessParameterTypes(d[4]);for(a=5;a<d.length;a+=1){if(d[a]!==""){this.ProcessResultData(d[a])}}this.PostProcess()};this.self.addEventListener("message",function(a){var b=new Parser();b.ProcessTSVData(a.data);this.self.postMessage(b.response)},false);
(function(k){var d,s,r,g,f,v,b,e,u,m,l,c,n,p,t,o,q,j,a,i,h;l=function(B){if(B&&B.stopPropagation){B.stopPropagation()}if(Object.keys(this.webUXDRMOptions).length===0){for(var z=0;z<this.drmTabOptions.activities.length;z++){var x=this.drmTabOptions.activities[z].sequence;var A="";var y=this.querySelector("#"+x);for(var w=0;w<this.drmOptions[x].length;w++){if(this.drmOptions[x][w].title==="drmMode"){A=this.drmOptions[x][w].value;break}}this.webUXDRMOptions[x]=new q({drmMode:A,drmOptions:this.drmOptions[x],container:y,showLoadingIndicator:true})}}};g=function(){var w=this.$.spDashboard.getAuthenticatedJspUri("/simulationcentral/smaImpactGraph.jsp?"+this.JS.toQueryString({physicalId:this.simulation.id,toolbar:"SMAHome_ImpactGraphToolbar","export":"false",PrinterFriendly:"false",StringResourceFileId:"smaSimulationCentralStringResource",suiteKey:"SimulationCentral",categoryTreeName:"type_Simulation",emxSuiteDirectory:"simulationcentral",isStructure:"true",otherTollbarParams:"isStructure",SuiteDirectory:"simulationcentral"}));m(w)};m=function(x){var y=k.outerWidth*3/4,w=k.outerHeight*3/4,A=y/7,z=w/7,B=k.open(x,"xyz","height="+w+", width="+y+", top="+z+", left="+A);if(k.focus){B.focus()}};a=function(){if(!j){this.set("simulation.$state","is-updating");this.debounce("_apiCall",function(){this.makeApiCall()}.bind(this),3000);var w=this.$.mcsWSBaseURL.getValue()+"/simulations/"+this.simulation.id;this.fire("datadirty",{isDirty:true,url:w})}};i=function(w){if(w.detail.id===appData.simData.simulationId){this.$.simulationStudy.value=w.detail.attributes["Simulation Study"]}};o=function(y){if(!j){var x=y.target.value;var z=/["#$@%*,?<>[\]|:{}';\\\/]/g;var w=x&&x.match(z);if(w&&w.length>0){this.simulation.attributes.title=x.replace(z,"");y.currentTarget.value=x.replace(z,"");this.fire("appmessage",{level:"info",message:"The characters listed below are not allowed for input: \" # $ @ % * , ? < > [ ] / | : { } ; ' \\",category:"specialChars"});y.stopPropagation()}else{if(x!==this.simulation.attributes.title){this.simulation.attributes.title=x;this.asyncFire("event-manager",{name:"update-title",data:this.simulation});this.updateDetails()}}}};t=function(){this.$.simulationProp1.sendRequest({verb:"PUT",uri:this.$.mcsWSBaseURL.getValue()+"/simulations/"+this.simulation.id,data:JSON.stringify(this.simulation),onComplete:function(){this.set("simulation.$state","");this.fire("updateSimulation")}.bind(this),onError:function(){this.set("simulation.$state","is-failing");setTimeout(function(){this.set("simulation.$state","")}.bind(this),3000)}.bind(this),physicalId:this.simulation.id});this.fire("datadirty",{isDirty:false})};f=function(){var A=["OperatingSystem","StationName","Custom","Group","CosimGroup","drmMode","JobName","JobGroup","Hosts","CPUs","Resources","BeginTime","EndTime","RunTimeLimit","AdditionalBsubArguments","ExclusiveExecution"];appData.simData.exeOptions=this.exeOptions;this.exeOptionsUI=[];var z="";for(var y=0;y<this.exeOptions.length;y++){var x=false;var B=this.querySelector("#exeOptions").filter_type(this.exeOptions[y]);if(this.xsView&&this.exeOptions[y].hasOwnProperty("editableInPS")){this.exeOptions[y].editableInPS="true";if(this.exeOptions[y].hasOwnProperty("action")){this.exeOptions[y].action="edit"}}if(B==="Activity"){this.push("drmTabOptions.activities",this.exeOptions[y]);z=this.exeOptions[y].sequence;this.drmOptions[z]=[]}if(this.exeOptions[y].hasOwnProperty("drm")){x=true;this.drmOptions[z].push(this.exeOptions[y])}for(var w=0;w<A.length;w++){if(this.exeOptions[y].title===A[w]){x=true;if(this.exeOptions[y].hasOwnProperty("editableInPS")){if(this.exeOptions[y].editableInPS==="true"){this.exeOptions[y].readonly=false}else{this.exeOptions[y].readonly=true}}this.drmOptions[z].push(this.exeOptions[y])}}if(!x){this.exeOptionsUI.push(this.exeOptions[y])}}this.querySelector("#exeOptions").data=this.exeOptionsUI;this.querySelector("#actListRepeat").render();if(this.tab==="drmOptions"){this.showDRMTab()}};b=function(){this.debounce("_onShowExecutionOptions",function(){var w=this.$.exeOptionsWs;this._countOfInValidField=0;this.$.optionsMd.show();if(this.$.requiredFieldMessage.children.length!==0){this.$.requiredFieldMessage.removeChild(this.querySelector("#msgDiv"))}this.resetRequiredCount();if(this.drmOptions){this.drmOptions={}}if(this.drmTabOptions.activities.length>0){this.splice("drmTabOptions.activities",0,this.drmTabOptions.activities.length)}if(Object.keys(this.webUXDRMOptions).length>0){for(var y in this.webUXDRMOptions){if(this.webUXDRMOptions.hasOwnProperty(y)){try{this.webUXDRMOptions.prop.destroy()}catch(x){}}}this.webUXDRMOptions={}}w.uri="simulations/"+this.simulation.id+"/executionoptions";w.getData();w.simulation=this.simulation},300)};e=function(){this.$.optionsMd.hide()};u=function(){var B=0,R,K;var y=this.exeOptions.length;if(Object.keys(this.webUXDRMOptions).length>0){for(var z in this.webUXDRMOptions){if(this.webUXDRMOptions.hasOwnProperty(z)){try{var G=false;var P="";var I=this.webUXDRMOptions[z].getSelectedDrmMode();var A=this.webUXDRMOptions[z].getDrmOptions();var x=[];if(I!=="fiper"&&I!=="Lsf"){for(var D=0;D<A.length;D++){var O={title_display:"",title:"",datatype:"",value:"",drm:"",readonly:"false"};O.title_display=A[D].title_display;O.title=A[D].title;O.value=A[D].value;O.datatype=A[D].type;if(A[D].hasOwnProperty("@ReadOnlyFlag")){O.readonly=A[D]["@ReadOnlyFlag"]}O.drm=I;x.push(O)}}for(var M=B;M<this.exeOptions.length;M++){if(this.exeOptions[M].title==="drmMode"){P=this.exeOptions[M].value}if(this.exeOptions[M].sequence){if(this.exeOptions[M].sequence===z){B=M;G=true}else{if(G){y=M;break}}}if(B>=y){y=this.exeOptions.length}}if(G){if(I==="fiper"||I==="Lsf"){for(var L=B;L<y;L++){if(this.exeOptions[L].title==="drmMode"){this.exeOptions[L].value=I}for(var H=0;H<A.length;H++){R=A[H].title_display;K=this.exeOptions[L].title_display;if(K===R){this.exeOptions[L].value=A[H].value;break}}}}else{var J=0,E;for(E=B;E<y;E++){if(this.exeOptions[E].title==="drmMode"){this.exeOptions[E].value=I;J=E;break}}if(I!==P){for(E=J;E<y;E++){if(this.exeOptions[E].drm!==undefined&&this.exeOptions[E].drm!==null&&this.exeOptions[E].drm.length>0){this.exeOptions[E].drm=""}}}for(var F=0;F<x.length;F++){if(I!==P){this.exeOptions.splice(J+1,0,x[F])}else{R=x[F].title;var w=false;for(E=B;E<y;E++){K=this.exeOptions[E].title;if(K===R&&this.exeOptions[E].drm===I){w=true;this.exeOptions[E].value=x[F].value;break}}if(!w){this.exeOptions.splice(J+1,0,x[F])}}}}}}catch(N){}}}this.webUXDRMOptions={}}var C=this.$.mcsWSBaseURL.getValue()+"/"+this.$.exeOptionsWs.uri;var Q=this.exeOptions?JSON.stringify(this.exeOptions):null;this.$.exeOptionsWs.sendRequest({verb:"PUT",uri:C,context:this,onComplete:s.bind(this),onError:r.bind(this),data:Q,physicalId:this.simulation.id});this.$.optionsMd.hide()};s=function(){appData.simData.exeOptions=this.exeOptions;appData.simData.operatingStystems=[];appData.simData.stationNames=[];this.asyncFire("event-manager",{name:"exeoptions-changed",data:this.exeOptions});var w=this.exeOptions&&this.exeOptions.forEach(function(x){if(x.title==="StationName"&&x.value!==""){var y=x.value;if(y.indexOf(" ")>0){var z=y.split(" ");z.forEach(function(A){if(appData.simData.stationNames.indexOf(A)<0){appData.simData.stationNames.push(A)}})}else{if(appData.simData.stationNames.indexOf(x.value)<0){appData.simData.stationNames.push(x.value)}}}if(x.title==="OperatingSystem"&&x.value!==""){if(appData.simData.operatingStystems.indexOf(x.value)<0){appData.simData.operatingStystems.push(x.value)}}});this.asyncFire("appmessage",{level:"success",message:"Execution Options are successfully updated.",autoHide:true,category:"saveSuccess"});this.asyncFire("exeOptionsUpdate",{level:"success"})};r=function(w){this.asyncFire("appmessage",{level:"error",autoHide:true,message:w.response||"Error in saving the Execution Options.",category:"saveError"})};d=function(){this.webUXDRMOptions={};k.require(["UWA/Core"],function(w){h=w});k.require(["DS/SMAExeDrmInfraUI/Views/CustomDRMUI"],function(w){q=w})};v=function(){this.asyncFire("event-manager",{name:"exeoptions-changed",data:this.exeOptions})};c=function(){this.$.saveButton.disabled=true;if(!(this._countOfInValidField>1)){this.querySelector("#saveButton").classList.add("disable-button-exe-options-close");if(this.$.requiredFieldMessage.children.length===0){var w=new h.Element("span",{id:"msgDiv"});var y=document.createTextNode("One or more required fields are empty");w.appendChild(y);var x=this.querySelector("#requiredFieldMessage");x.insertBefore(w,this.requiredFieldMessage);x.classList.add("reqFieldMesg")}}this._countOfInValidField++};n=function(){if(this._countOfInValidField>0){this._countOfInValidField--}this.debounce("_validChange",function(){if(this._countOfInValidField===0){this.$.saveButton.disabled=false;this.querySelector("#saveButton").classList.remove("disable-button-exe-options-close");if(this.$.requiredFieldMessage.children.length!==0){this.$.requiredFieldMessage.removeChild(this.querySelector("#msgDiv"))}}}.bind(this),300)};p=function(x){var w=this.$.exeOptionsWs;if(w.simulation&&(w.simulation.id!==this.simulation.id)){this._countOfInValidField=0}if(x&&this.webUXDRMOptions){if(this.webUXDRMOptions[x.currentTarget.id].inValidCount!==undefined||this._countOfInValidField!==0){this._countOfInValidField=this._countOfInValidField-this.webUXDRMOptions[x.currentTarget.id].inValidCount}}if(this._countOfInValidField===0&&this.$.saveButton.disabled===true){this.$.saveButton.disabled=false;this.querySelector("#saveButton").classList.remove("disable-button-exe-options-close");if(this.querySelectorAll("#msgDiv").length!==0){this.$.requiredFieldMessage.removeChild(this.querySelector("#msgDiv"))}}};k.Polymer({is:"ps-simulation-details",properties:{simulation:{type:Object,value:function(){return{}},observer:"setDescriptionTimeout",notify:true},xsView:{type:Boolean,value:false},drmTabOptions:{type:Object,value:function(){return{activities:[]}},notify:true},drmOptions:{type:Object,notify:true,value:function(){return{}}},drmOptionDisable:{type:Boolean,value:function(){return{activities:[]}}},_countOfInValidField:{type:Number,value:0}},observers:["updateDetails(simulation.attributes.description,simulation.attributes.Simulation Study)"],saveExeOptionsComplete:function(){return s.apply(this,arguments)},saveExeOptionsFailure:function(){return r.apply(this,arguments)},ready:function(){return d.apply(this,arguments)},invalidChange:function(){return c.apply(this,arguments)},validChange:function(){return n.apply(this,arguments)},resetRequiredCount:function(){return p.apply(this,arguments)},onShowImpactGraph:function(){return g.apply(this,arguments)},onUpdateComplete:function(){return v.apply(this,arguments)},_computeUriForExeOptions:function(w){return"simulations/"+w+"/executionoptions"},onShowExecutionOptions:function(){return b.apply(this,arguments)},showDRMTab:function(){return l.apply(this,arguments)},saveExecutionOptions:function(){return u.apply(this,arguments)},hideExecutionOptions:function(){return e.apply(this,arguments)},onExeOptionsReady:function(){return f.apply(this,arguments)},behaviors:[DS.SMAProcSP.SPBase],simulationDetailsChange:function(){return o.apply(this,arguments)},updateDetails:function(){return a.apply(this,arguments)},updateGroup:function(w){return i.apply(this,arguments)},makeApiCall:function(){return t.apply(this,arguments)},_computeSimulationKind:function(){return this.simulation.attributes?this.simulation.attributes["Simulation Kind"]:""},_computeSimulationStudy:function(){return this.simulation.attributes?this.simulation.attributes["Simulation Study"]:""},_computeOriginated:function(){var w=this.simulation.basics?this.simulation.basics.originatedMillis:"";if(w){var x=new Date(parseInt(w));return x.getDate()+" "+x.toLocaleString("en-us",{month:"short"})+" "+x.getFullYear()+" "+x.toLocaleTimeString()}else{return this.simulation.basics?this.simulation.basics.originated:""}},_computeModified:function(){var x=this.simulation.basics?this.simulation.basics.modifiedMillis:"";if(x){var w=new Date(parseInt(x));return w.getDate()+" "+w.toLocaleString("en-us",{month:"short"})+" "+w.getFullYear()+" "+w.toLocaleTimeString()}else{return this.simulation.basics?this.simulation.basics.modified:""}},_computeUptoDate:function(){return this.simulation.attributes?this.simulation.attributes["Up To Date"]:""},_computeClass:function(){var w="";if(this.xsView){w+="noDisplay"}w+=" description-container";return w},_computeClass2:function(){if((this.simulation.attributes&&this.simulation.attributes["Simulation Kind"]==="adhoc")){return"noDisplay"}return""},_activityTitle:function(w){return w.sequence},_activityTitleDisplay:function(w){return w.title_display},setDescriptionTimeout:function(){j=true;if(this.simulation&&this.simulation.attributes){this.$.simTitle.value=this.simulation.attributes.title;this.$.simulationStudy.value=this.simulation.attributes["Simulation Study"]}setTimeout(function(){j=false},3000);setTimeout(function(){if(this.$.simDescription.value==="null"){this.$.simDescription.value=""}}.bind(this),25)}})}(this));
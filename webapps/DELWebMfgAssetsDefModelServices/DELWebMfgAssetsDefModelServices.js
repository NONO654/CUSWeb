define("DS/DELWebMfgAssetsDefModelServices/DocumentObjAttributesUtils",["UWA/Core","UWA/Class","DS/Logger/Logger"],function(f,c,b){var e=c.singleton({name:"DocumentObjAttributesUtils",_logger:undefined,init:function(g){g=g||{};if(f.is(b)){e._logger=b.getLogger(e)}this._ModelUtils=g.ModelUtils;this._iUIConfigDocValuesURL="DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIDocumentDisplayAttributeConfig";this._readXMLConfiguration();this.attrDisplayMap={}},_readXMLConfiguration:function d(){var h=function h(k){var i,j;if(f.is(k.DisplayAttributeDescriptionList)){if(Array.isArray(k.DisplayAttributeDescriptionList["Document"])){i=k.DisplayAttributeDescriptionList["Document"]}else{i=[k.DisplayAttributeDescriptionList["Document"]]}for(j=0;j<i.length;j++){e.attrDisplayMap[i[j].coloumnName]=i[j].Attribute}}},g=function g(i){e._logger.log(i.message)};e._ModelUtils.getXMLValues(this._iUIConfigDocValuesURL,h,g)},getDocumentAttributes:function a(l,g){var j=e.attrDisplayMap[g],h=l[0].get("dataelements"),i,k="";if(!f.is(j)){k=h.title}else{if(!Array.isArray(j)){j=[j]}for(i=0;i<j.length;i++){if(f.is(h[j[i].name])&&h[j[i].name]!==""){k=k+h[j[i].name]+" "}}}return k}});return e});define("DS/DELWebMfgAssetsDefModelServices/LoggerUtils",["UWA/Core","UWA/Class","DS/DELWebMfgAssetsDefLoggerModel/LoggerCollection",],function(h,c,k){var e=c.singleton({name:"LoggerUtils",_logIndex:0,init:function n(p){this._parent(p);this._loggerCollection=new k()},setAddCallback:function j(p){this._loggerCollection.addEvent("onAdd",p)},getNextIndex:function b(){++this._logIndex;return this._logIndex},_log:function l(s,p,r){var q={index:s,name:p,action:r,time:(new Date()).toString().split(" ")[4],isRunning:true};if((r==="completed")||(r==="failed")||(r==="timedout")){q.isRunning=false;this._loggerCollection.where({index:s}).forEach(function t(u){u.set("isRunning",false)})}this._loggerCollection.add(q)},logStarted:function d(q,p){this._log(q,p,"started")},logCompleted:function i(q,p){this._log(q,p,"completed")},logFailed:function f(q,p){this._log(q,p,"failed")},logTimedOut:function m(q,p){this._log(q,p,"timedout")},logInfo:function g(q,p){this._log(q,p,"information")},getSize:function o(){return this._loggerCollection.size()},getModel:function a(p){return this._loggerCollection.at(p)}});return e});define("DS/DELWebMfgAssetsDefModelServices/AbstractIRPCCollection",["UWA/Core","UWA/Class/Collection","UWA/Class/Debug"],function(e,b,d){var a=b.extend(d,{comparator:"PID",sync:function c(i,h,g){var f=this;(function(){var s,k=new Date(),p,o,n=g.onComplete,l=g.onFailure,q="START - "+i+" request",j=" / Time: "+k.toISOString(),r="END - "+i+" request",m;if(e.is(f._logger)){s=e.is(h.id)?q+" on "+h.id+j:q+j;f._logger.log(s)}g.onComplete=function(v,u){var t=0;if(e.is(f._logger)){p=new Date();o=p.getTime()-k.getTime();m=" / Duration: "+o+" ms";s=e.is(h.id)?r+" on "+h.id+m:r+m;f._logger.log(s)}if(Array.isArray(v)){for(t=0;t<v.length;t++){if(e.is(v[t].attributesValue)){v[t].PID=v[t].attributesValue.PID}}}n.call(null,v,u)};g.onFailure=function(t,v,u){if(e.is(f._logger)){s="FAILURE during "+i+": "+e.Json.encode(t);f._logger.log(s)}l.call(null,t,v,u)};return f._parent.call(f,i,h,g)})()}});return a});define("DS/DELWebMfgAssetsDefModelServices/ModelPreferences",["UWA/Core","UWA/Class"],function(e,a){var d=a.singleton({LeftBloc:null,RightBloc:null,PPRTypes:null,typeHierarchy:{},RelationsList:null,CustomRelationsList:null,CustomInstanceList:null,DocPolicyNames:null,init:function h(j){this._parent(j)},_getValue:function f(j,l){var k=e.is(l)?l:null;if(e.is(widget)&&e.is(widget.getValue,"function")&&e.is(j,"string")&&(j.length>0)){k=widget.getValue(j)}return k},_getPreference:function c(j,l){var k=e.is(l)?l:null;if(e.is(widget)&&e.is(widget.getPreference,"function")&&e.is(j,"string")&&(j.length>0)){k=widget.getPreference(j)}return k},getNavigateOnIndexedDB:function(){var j=d._getValue("navigateOnIndexedDB","false");if(!e.is(j)||j==="false"){return false}return true},getNavigateOn:function i(){var j=d._getPreference("navigateOn",{value:"indexOndemand"}).value;return j},getPrefExpandLevel:function g(){var j=d._getPreference("fetchAllLevel",{value:"false"}).value;return(j==="false")?2:-1},getTypeHierarchy:function b(j){var k=e.is(d.typeHierarchy[j].derivedTypes,"array")?d.typeHierarchy[j].derivedTypes:[];return k}});return d});define("DS/DELWebMfgAssetsDefModelServices/AbstractDisplayModel",["UWA/Core","DS/Logger/Logger","UWA/Class/Model","UWA/Class/Debug"],function(g,b,f,d){var c=f.extend(d,{name:"AbstractDisplayModel",_logger:null,idAttribute:"PID",defaults:{selectedInTableView:false,selectedInAuxiliaryView:false,selectedInGenericView:false},setup:function a(){if(g.is(b)){this._logger=b.getLogger(c)}},validate:function e(){}});return c});define("DS/DELWebMfgAssetsDefModelServices/ProxyXSO",["UWA/Core","UWA/Event","DS/Logger/Logger","DS/Selection/XSO"],function(g,a,b,e){var f=e.extend({_logger:null,init:function d(h){if(g.is(b)){this._logger=b.getLogger(this)}this._parent(h)},onSelectionChange:function c(h){var i;if(g.is(this._logger)){this._logger.warn("ProxyXSO - Selection has changed!")}i=h.modifiedObjectPID;if(h.modifiedObjectSelectionState){this.add(i)}else{this.remove(i)}}});return f});define("DS/DELWebMfgAssetsDefModelServices/Resources",["UWA/Core","UWA/Class","UWA/Json","DS/Logger/Logger","DS/WebappsUtils/WebappsUtils","text!DS/DELWebMfgAssetsDefModelServices/assets/localIcons.json"],function(k,t,b,w,h,r){var u=t.singleton({name:"Resources",_logger:null,_rscCatalog:{},_nlsFiles:[],_attributeInfo:{},_typeMaskInfo:{},_dimensions:[],_3DSpaceURL:null,_localIconsInfo:{},init:function s(A){this._parent(A);if(k.is(w)){this._logger=w.getLogger(u)}this._localIconsInfo=b.decode(r)},set3DSpaceBaseURL:function j(A){this._3DSpaceURL=A+"common/images"},addNlsJSON:function a(B){var C;function A(F,E){return F.replace(/\{([\w\-]+)\}/g,function(G,H){return k.is(E[H])?E[H]:""})}function D(E){k.i18n(E);if(!k.is(E.get)){Object.defineProperty(E,"get",{value:function(F){return this[F]||F},enumerable:false})}if(!(E.replace)){Object.defineProperty(E,"replace",{value:A,enumerable:false})}return E}C=D(B);this.addNlsFile(C)},addCATNlsFile:function(A){var B=this._catToJson(A);this.addNlsJSON(B)},addCATRscFile:function(D,C){var A=D.replace(/\n|\r/g,"").split(";"),B={};A.forEach(function(H){var G,E,F;if(H!==""&&H.indexOf("=")>0){G=H.split("=");E=G[0].replace(/(\.Icon\.Normal)$/,"");F=G[1].replace(/"|.png/g,"");B[E]={IconName:F,ModuleName:C}}});this._rscCatalog=k.merge(this._rscCatalog,B)},addRscFile:function(A,D){var C=k.is(A,"string")?b.decode(A):A,B;if(k.is(D)){for(B in C){if(k.is(B)){k.merge(C[B],{ModuleName:D})}}}this._rscCatalog=k.merge(this._rscCatalog,C)},putRscLocalInfo:function g(){var A=this._rscCatalog,B;for(B in A){if(k.is(B)){if(k.is(A[B].IconName)){if(k.is(this._localIconsInfo[A[B].IconName])){k.merge(A[B],{ModuleName:this._localIconsInfo[A[B].IconName]})}}}}},addNlsFile:function(A){this._nlsFiles.push(A)},addAttributeInfo:function x(A){k.merge(this._attributeInfo,A)},addDimensions:function m(A){this._dimensions=A},addTypeMaskInfo:function p(B,A){this._typeMaskInfo[B]=A},getNLSValue:function z(C,G,D,A){var I,E,F,H=this._nlsFiles,B=-1;if(H.length===0){if(k.is(this._logger)){this._logger.log("No NLS files were specified")}return}if(k.is(C)){F=C;if(k.is(D)){F=D+"."+F}if(k.is(A)){F=F+"."+A}do{B++;E=H[B].get(F)}while(E===F&&B<H.length-1);if(E!==F){if(k.is(G)){I=H[B].replace(E,G)}else{I=E}}else{I=C}}else{F="Wrong NLS key"}return k.is(I)?I:F},getRSCValue:function n(A){return this._rscCatalog[A]},getAttributeInfo:function v(A,C){var B;if(A.indexOf(".")===-1){Object.keys(this._attributeInfo).some(function(D){var F,E;F=D.split(".");F=F[F.length-1];E=F===A;if(E){A=D}return E})}B=this._attributeInfo[A];if(!k.is(B)){return null}B.FullName=A;if(!k.is(C)){return B}return B[C]},getTypeMaskInfo:function i(A){return this._typeMaskInfo[A]},_getDimensionFromName:function l(A,C){var D={},B=function B(F){var E=false;if(F.Name===C){D=F;E=true}return E};if(k.is(C,"string")&&(C.length>0)&&k.is(A,"array")){A.some(B)}return D},_getUnitInfo:function e(E,D){var C,B,A;C=u._getDimensionFromName(u._dimensions,E);A=k.is(D,"string")&&D.length>0?D:C.MKSUnit;B=u._getDimensionFromName(C.Units,A);return B},getNLSForUnit:function y(D,C){var A,B="";if("Ratio"===D){B="%"}else{A=u._getUnitInfo(D,C);if(k.is(A)&&k.is(A.NLSName,"string")){B=A.NLSName}}return B},getLabelForUnit:function o(D,C){var B,A="";B=u._getUnitInfo(D,C);if(k.is(B)&&k.is(B.label,"string")){A=B.label}return A},getIconURLFromKey:function d(D,C,B){var G="icons/32",A=".png",F=h.getWebappsAssetUrl("DELWebMfgAssetsDefUI",G),H="I_DELQuestionMark",I,E;if(k.is(C)){D=C+"."+D}if(k.is(B)){D=D+"."+B}I=this.getRSCValue(D);if(k.is(I)){if(k.is(I.IconName)){H=I.IconName}if(k.is(I.ModuleName)){F=h.getWebappsAssetUrl(I.ModuleName,G)}else{F=this._3DSpaceURL}}E=F+"/"+H+A;return E},getIconFromKey:function q(A){return new k.Controls.Img(this.getIconDataFromKey(A))},getIconDataFromKey:function c(B){var A={url:this.getIconURLFromKey(B),className:"uwa-img MGA-Icon"};return A},_catToJson:function f(C){var A=C.replace(/\n|\r/g,"").split(";"),B={};A.forEach(function(G){var F,D,E;if(G!==""&&G.indexOf("=")>0){F=G.split("=");D=F[0];E=F[1].replace(/"|.png/g,"");B[D]=E}});return B}});return u});define("DS/DELWebMfgAssetsDefModelServices/CustoXmlUtils",["UWA/Core"],function(b){var a=function a(){var c=[],d=new Map(),e=function e(h){if(b.is(h.dicoType)&&b.is(h.attribute)){if(d.has(h.dicoType)){if(d.get(h.dicoType).indexOf(h.attribute)===-1){d.get(h.dicoType).push(h.attribute)}}else{d.set(h.dicoType,[h.attribute])}}},g=function g(m,q,k){var s=m.split("."),p,o,h={},l={},i,r={},n=function n(t,v){var u={},j;for(j=0;j<v.length;++j){if(!b.is(t[v[j]])){t=null;break}else{t=t[v[j]]}}if(b.is(t)){if(b.typeOf(t)==="array"){for(j=0;j<t.length;++j){u[t[j][q]]=t[j]}}else{if(b.typeOf(t)==="object"){u[t[q]]=t}}}return u};if(b.is(k)&&b.is(m)&&b.is(q)){if(b.typeOf(k[s[0]])==="array"){for(i=0;i<k[s[0]].length;i++){l=k[s[0]][i];o=m.indexOf(".");p=m.substring(o+1,m.length);p=p.split(".");if(b.is(l[p],"array")){r=n(l,p)}else{r=n(k,s)}b.merge(h,r)}}else{h=n(k,s)}}return h};return{retrieveAttributesInfoFromXml:function f(s){var r,o,j,p,q,m,t,h,u,l,v,n,k=function k(x){var y,z,w,i=["reference","instance"];if(b.is(x)){for(y in x){if(x.hasOwnProperty(y)){if(b.is(x[y])&&b.is(x[y]["dicoType"])){w=y.split(".");if(i.indexOf(w[w.length-1])>-1){z=w[w.length-2]}else{z=w[w.length-1]}}e({attribute:z,dicoType:x[y]["dicoType"]})}}}};if(b.is(s)){if(b.is(s.uiConfig)){o=s.uiConfig;for(r in o.Config.Preferences){if(o.Config.Preferences[r]){k(g("Config.Preferences."+r+".Columns.Column","dataIndex",o));k(g("Config.Preferences."+r+".Label","dataIndex",o))}}}if(b.is(s.insertCmd)){t=s.insertCmd;h=g("AttributesDescriptionList.Type","name",t);for(u in h){if(h.hasOwnProperty(u)){k(g("Section.Attribute","name",h[u]))}}}if(b.is(s.editLink)){j=s.editLink;for(p in j.Config){if(j.Config.hasOwnProperty(p)){if(j.Config[p].Attribute){q=j.Config[p].Attribute;if(!b.is(q,"array")){q=[q]}for(m=0;m<q.length;m++){q[m]["dicoType"]=q[m]["name"].split(".")[0]}k(g(p+".Attribute","name",j.Config))}}}}if(b.is(s.bomView)){l=s.bomView;if(l.Config.Preferences.BOMView.Color.AttributeDefinition){k(g("Config.Preferences.BOMView.Color.AttributeDefinition","dataIndex",l))}if(l.Config.Preferences.BOMView.Content.Type){v=l.Config.Preferences.BOMView.Content.Type;for(n=0;n<v.length;n++){k(g("Row","dataIndex",v[n]))}}}d.forEach(function(w,i){c.push({type:i,attributes:w})});return c}}}};return a});define("DS/DELWebMfgAssetsDefModelServices/BehaviorUtil",["UWA/Core","UWA/Class","DS/Logger/Logger","DS/PlatformAPI/PlatformAPI"],function(e,u,v,a){var o=u.singleton({name:"BehaviorUtil",_logger:null,init:function s(x){x=x||{};this._parent(x);if(e.is(v)){this._logger=v.getLogger(o)}},_getVariable:function m(H,E){var C="app.MFN.default",A="boolean",z=false,x=z,G=e.is(E,"string")?((E.length>0)?E:A):A,B=e.is(H,"string")?((H.length>0)?H:C):C,y=a.getApplicationConfiguration(B),F=localStorage.getItem(B),D=false;if(e.is(y,"string")){x=y;D=true;o._logger.log("From server ("+B+", "+G+"): "+x)}else{if(e.is(F,"string")){x=F;D=true;o._logger.log("From client ("+B+", "+G+"): "+x)}}if(D){switch(G){case"boolean":x=("true"===x);break;default:break}}return x},isNewDragNDrop:function j(){var x=o._getVariable("app.MFN.isOldDragNDrop");return !x},shouldLoadRootOnly:function t(){return o._getVariable("app.feature.loadRootOnly")},isSwitchToDBMode:function f(){return o._getVariable("app.feature.isSwitchToDBMode")},isCloud:function h(){return o._getVariable("app.build.isCloud")},isNewArchi:function g(){return o._getVariable("app.Archi.isNewArchi")},getDefaultTimeout:function p(){return o._getVariable("app.feature.defaultTimeout","string")},useRootStorage:function q(){return o._getVariable("app.feature.useRootStorage")},isSwipeableMenuPrefDisplayed:function r(){return o._getVariable("app.MFNMGA.isSwipeableMenuPrefDisplayed")},isNavigateOnIndexedDBPrefDisplayed:function i(){return o._getVariable("app.MFNMGA.isNavigateOnIndexedDBPrefDisplayed")},isDialogDisplayedAtDDinCaseOfMove:function n(){return o._getVariable("app.MFNMGA.isDialogDisplayedAtDDinCaseOfMove")},isLinksUIMultiSelection:function l(){return o._getVariable("app.feature.LinksUI.multiSelection")},isUpdateUIUpdateIntermediateScopedAssemblies:function w(){return o._getVariable("app.feature.UpdateUI.UpdateIntermediateScopedAssemblies")},isViewPersistanceOn:function d(){var x=o._getVariable("app.feature.isViewPersistanceOn");return x},isSuppressHideShow3DColumn:function b(){return o._getVariable("app.feature.suppressHideShow3DColumn")},isDynamicTimeoutMode:function c(){return o._getVariable("app.feature.isDynamicTimeout")},isEffectivityColumn:function k(){return o._getVariable("app.feature.isEffectivityColumn")},});return o});define("DS/DELWebMfgAssetsDefModelServices/ImplementLinkUtil",["UWA/Core","UWA/Class","DS/Logger/Logger",],function(h,d,c){var e=d.singleton({_context:null,_widgetTrigram:"",name:"ImplementLinkUtil",init:function f(i){i=i||{};this._logger=c.getLogger(e);if(h.is(i.CollectionUtils)){this._CollectionUtils=i.CollectionUtils}if(h.is(i.ModelUtils)){this._ModelUtils=i.ModelUtils;this._widgetTrigram=this._ModelUtils.getWidgetTrigram()}},getPathsToScope:function b(o,l){var q,r,s,p,n,k,j,i,m=null;if(h.is(o,"array")&&h.is(l,"array")){for(q=o.length-1;q>=0;q--){r=e._CollectionUtils.getInstanceFromCollection(o[q]);s=r.get("isAggregatedBy");p=e._CollectionUtils.getImpactedConnections(s);p=e._CollectionUtils.getProcessScopeLinksInGivenRefConns(p);if(h.is(p)&&p.length>0){for(n=l.length-1;n>=0;n--){k=e._CollectionUtils.getInstanceFromCollection(l[n]);j=k.get("isAggregatedBy");i=e._CollectionUtils.getImpactedConnections(j);i=e._CollectionUtils.getProcessScopeLinksInGivenRefConns(i);if(h.is(i)&&i.length>0){if(h.is(p[0].id===i[0].id)){m={fromPathScope:o.slice(q),toPathScope:l.slice(n)};break}}}}if(h.is(m)){break}}}return m},getOccPathForUpperScope:function a(k){var l,i,n,m,j=null;if(h.is(k,"array")){for(l=k.length-1;l>=0;l--){i=e._CollectionUtils.getInstanceFromCollection(k[l]);n=i.get("isAggregatedBy");m=e._CollectionUtils.getImpactedConnections(n);m=e._CollectionUtils.getProcessScopeLinksInGivenRefConns(m);if(h.is(m)&&m.length>0){j=k.slice(l);break}}}return j},getFilteredConnectionModelInfo:function g(j,m){var i=[],k;if(e._widgetTrigram==="MFN"){return m}if(h.is(j)&&h.is(j,"array")){if(h.is(m)&&h.is(m,"array")&&m.length>0){m.forEach(function l(n){if(h.is(n)&&(n.connectionTypeName==="ProcessImplementLinkOcc"||n.connectionTypeName==="ProcessImplementLinkOcc_inverse")){k=e.getOccPathForUpperScope(j);if(e._CollectionUtils.arrayCompare(k,n.fromID)){i.push(n)}}else{i.push(n)}});return i}}return m}});return e});define("DS/DELWebMfgAssetsDefModelServices/DocumentUtility",["UWA/Core","UWA/Class","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/Resources"],function(g,a,e,h){var o=a.singleton({_logger:null,_modelUtils:null,_uiUtils:null,collectionUtils:null,getDocumentID:function b(q,s){s=s||{};g.merge(s,{url:"modeler/pprirpc/document?irpcPID="+q,method:"GET",onComplete:function t(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.GetDocInfoSuccess")})},onFailure:function r(u){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.GetDocInfoFailure")+g.Json.encode(u)})}});o._modelUtils.webServiceRequest(s)},linkWithDocumentID:function i(q,r,t){var u={pid:q,myDocumentPID:r,isVPLMControlled:"true"};t=t||{};g.merge(t,{url:"modeler/pprirpc/document",method:"POST",data:g.Json.encode(u),onComplete:function v(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.LinkDocSuccess")})},onFailure:function s(w){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.LinkDocFailure")+g.Json.encode(w)})}});o._modelUtils.webServiceRequest(t)},deleteLink:function p(q,r,t){var u={pid:q,myDocumentPID:r};t=t||{};g.merge(t,{url:"modeler/pprirpc/document",method:"DELETE",data:g.Json.encode(u),onComplete:function v(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.DeleteLinkSuccess")})},onFailure:function s(w){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.DeleteLinkFailure")+g.Json.encode(w)})}});o._modelUtils.webServiceRequest(t)},getDocumentInfo:function n(t,r){r=r||{};g.merge(r,{securityContext:o._modelUtils.getSecurityContext(),onComplete:function s(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.GetDocInfoSuccess")})},onFailure:function q(u){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.GetDocInfoFailure")+g.Json.encode(u)})}});if(!Array.isArray(t)){t=[t]}o._modelUtils.getDocumentInfo(t,r)},attachFile:function l(q,r,t){q=q||{};q.fileInfo=r;t=t||{};g.merge(t,{securityContext:o._modelUtils.getSecurityContext(),onComplete:function u(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.AttachFileSuccess")})},onFailure:function s(v){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.AttachFileFailure")+g.Json.encode(v)})}});o._modelUtils.attachFile(q,r,t)},modifyFile:function d(q,r,t){q=q||{};q.fileInfo=r;t=t||{};g.merge(t,{securityContext:o._modelUtils.getSecurityContext(),onComplete:function u(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.ModifyFileSuccess")})},onFailure:function s(v){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.ModifyFileFailure")+g.Json.encode(v)})}});o._modelUtils.modifyFile(q,r,t)},downloadFiles:function j(r,q,t){t=t||{};g.merge(t,{securityContext:o._modelUtils.getSecurityContext(),onComplete:function u(v){var w=v+"&attachment=true";window.open(w,"_blank");o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.DownloadFilesSuccess")})},onFailure:function s(v){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.DownloadFilesFailure")+g.Json.encode(v)})}});o._modelUtils.downloadFiles(r,q,t)},removeFile:function f(r,q,t){t=t||{};g.merge(t,{securityContext:o._modelUtils.getSecurityContext(),onComplete:function u(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.RemoveFileSuccess")})},onFailure:function s(v){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.RemoveFileFailure")+g.Json.encode(v)})}});o._modelUtils.removeFile(r,q,t)},downloadDocuments:function c(v,t){var q,s;t=t||{};g.merge(t,{securityContext:o._modelUtils.getSecurityContext(),onComplete:function u(w){for(q=0;q<w.length;q++){s=w[q].downloadUrl+"&attachment=true";window.open(s,"_blank")}o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.DownloadFilesSuccess")})},onFailure:function r(w){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.DownloadFilesFailure")+g.Json.encode(w)})}});o._modelUtils.downloadDocuments(v,t)},deleteDocument:function k(q,s){s=s||{};g.merge(s,{securityContext:o._modelUtils.getSecurityContext(),onComplete:function t(){o._uiUtils.AlertManager.add({className:"success",message:h.getNLSValue("Document.DeleteDocSuccess")})},onFailure:function r(u){o._uiUtils.AlertManager.add({className:"error",message:h.getNLSValue("Document.DeleteDocFailure")+g.Json.encode(u)})}});o._modelUtils.deleteDocument(q,s)},init:function m(q){o._parent(q);if(g.is(e)){o._logger=e.getLogger(o)}o._modelUtils=q.modelUtils;o._uiUtils=q.uiUtils;o.collectionUtils=q.collectionUtils}});return o});define("DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils",["UWA/Core","UWA/Class","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/ImplementLinkUtil","DS/DELWebMfgAssetsDefModelServices/ModelPreferences","DS/DELWebMfgAssetsDefModelServices/Resources",],function(j,c,e,o,g,b){var k=c.singleton({name:"RelObjAttributesUtils",init:function(p){p=p||{};this._logger=e.getLogger(k);this._ModelUtils=p.ModelUtils;this._CollectionUtils=p.CollectionUtils;this._linkedObjectContraint=false;k._constraintRelationName=null;this._relAttrToRelations={};this.typeToDisplayAttrMap={};if(p.relAttrToRelations){this.relAttrToRelations=p.relAttrToRelations}if(p.iUIConfigRelValues){this.iUIConfigRelValues=p.iUIConfigRelValues}this._readXMLConfiguration();o.init({CollectionUtils:this._CollectionUtils,ModelUtils:this._ModelUtils})},_readXMLConfiguration:function m(){var r,q,s,p;if(this.relAttrToRelations.RelationsColumns&&this.relAttrToRelations.RelationsColumns.RelationsColumn){r=this.relAttrToRelations.RelationsColumns.RelationsColumn;if(!Array.isArray(r)){r=[r]}r.forEach(function(t){k._relAttrToRelations[t.name]={};q=j.is(t.Type)?(Array.isArray(t.Type)?t.Type:[t.Type]):[];s=j.is(t.LinkedObjectConstraint)?(Array.isArray(t.LinkedObjectConstraint)?t.LinkedObjectConstraint:[t.LinkedObjectConstraint]):[];for(p=0;p<q.length;p++){k._relAttrToRelations[t.name][q[p].name]=q[p].format;if(p<s.length){k._constraintRelationName=t.name;k._relAttrToRelations[t.name][s[p].dicoType]=s[p].dataIndex;k._linkedObjectContraint=true}}})}if(j.is(this.iUIConfigRelValues.DisplayAttributeDescriptionList)&&j.is(this.iUIConfigRelValues.DisplayAttributeDescriptionList.Type)){k.typeToDisplayAttrMap=this.iUIConfigRelValues.convert("DisplayAttributeDescriptionList.Type","name")}},getRelAttrToRelationsMap:function l(){return this._relAttrToRelations},isObjectConstraint:function i(){return this._linkedObjectContraint},buildConnectionModelInfo:function d(q,s){var p,v,r,t,x,w=[],u;if(!j.is(q)){return}p=s||{};v=j.is(q)?(j.is(q.id,"string")?q.id:null):null;r=k._CollectionUtils.isReference(v);t=r?q:k._CollectionUtils.getReferenceModelFromInstance(q);x={referencePID:r?v:null,instancePID:!r?v:null,useOnlyRefRefLnk:false,objPPRType:j.is(t)?t.get("PPRTYPE"):null};u=function u(z){var y=false;x.connectionModelInfo={};y=k._CollectionUtils.isConnectionImpacted(z,x);if(y&&j.is(x.connectionModelInfo)){w.push(j.clone(x.connectionModelInfo))}};k._CollectionUtils.connections.forEach(u);if(j.is(q)){q.setDisplayModel({connectionModelInfo:w},p)}},fillConnectionModelInfo:function h(v,s){var t=s||{},u=j.is(v)?v:null,q=k._CollectionUtils.isReference(u),r=(!q)?u:null,p=q?u:j.is(r)?k._CollectionUtils.getReferenceFromInstancePID(r.id):null;if(j.is(u)){k._CollectionUtils.getConnectionsByModel(p,r,null,false,null,t);k.buildConnectionModelInfo(u,t)}},updateConnectionsRelationAttributes:function f(q,v){var s=v.isReference(),r=s?v:null,t=(!s)?v:null,u;k._CollectionUtils.getConnectionsByModel(r,t,null,false);u=v.getDisplayModelAttr("connectionModelInfo");if(j.is(u,"array")){q.prepareUpdate();if(u.length>0){u.forEach(function p(w){var z=w.modelID,y;if(j.is(z,"string")){y=k._CollectionUtils.getReferenceFromCollection(z);if(!j.is(y)){y=k._CollectionUtils.getInstanceFromCollection(z)}k.updateRelationAttributes(q,y)}else{if(j.is(z,"array")){z.forEach(function x(A){y=k._CollectionUtils.getInstanceFromCollection(A);k.updateRelationAttributes(q,y)})}}})}k.updateRelationAttributes(q,v);q.pushUpdate()}},updateRelationAttributes:function a(u,s){var r=j.is(s)?s.isInstance():false,v=j.is(u)?u.getColumnsDataIndex():[],t="connectionModelInfo",x=null,p=null,q=[];if(j.is(s)&&j.is(u)){u.prepareUpdate();x=u.search(s.id,"PID",r);if(j.is(x,"array")){x.forEach(function w(G){var E=G.getReferencePID(),B=G.getInstancePID(),F=j.is(E)?k._CollectionUtils.getReferenceFromCollection(E):null,D=j.is(B)?k._CollectionUtils.getInstanceFromCollection(B):null,z=j.is(F)?F.getDisplayModelAttr(t):[],A;if(j.is(D)){z=z.concat(D.getDisplayModelAttr(t));if(k._ModelUtils.getWidgetTrigram()!=="MFN"){if(j.is(z)&&j.is(z,"array")&&z.length>0){q=o.getFilteredConnectionModelInfo(G.getAbsolutePath(),z);z=q}}}p=k.getRelationAttributes(z,v);if(j.is(p)){if(g.getNavigateOn()==="indexOndemand"){if(j.is(D)&&!D.get("queriedForConnections")){Object.keys(p).forEach(function C(H){if(p[H].length===0){p[H].push({Value:b.getNLSValue("RelationsNotLoadedQuestionMark")})}})}if(j.is(F)&&!F.get("queriedForConnections")){Object.keys(p).forEach(function C(H){if(p[H].length===0){p[H].push({Value:b.getNLSValue("RelationsNotLoadedQuestionMark")})}})}}A=Object.keys(p);A.forEach(function y(H){G.setAttribute(H,p[H])})}})}u.pushUpdate()}},getRelationAttributes:function n(q,r){var t={},p=j.is(r,"array")?r:[r],u;if(j.is(q,"array")){u=k.getRelAttrToRelationsMap();p.forEach(function s(v){var w;if(v.split(".")[1]==="relation"){t[v]=[];w=u[v];if(j.is(w)){q.forEach(function x(E){var F,z,A,C=j.is(E)?(j.is(E.connectionTypeName)?E.connectionTypeName:null):null,I,H=j.is(w[C])?w[C]:null,y,D,J,B,G;if(j.is(H)){if(j.is(E.modelID)){if(j.is(E.modelID,"array")){z=k._CollectionUtils.instances.get(E.modelID[E.modelID.length-1])}else{z=k._CollectionUtils.references.get(E.modelID);if(j.is(z,"string")&&(z.length>0)){if(!z.get("V_Name")){F=k._ModelUtils.translatePredicateToAttribute(z._attributes,{type:"entity"});z.set(F)}}}}if(j.is(E.connectionID,"string")&&(E.connectionID.length>0)){A=k._CollectionUtils.connections.get(E.connectionID)}y=("Type"===H)?(j.is(z)?z.get("type"):null):C;if(j.is(y)&&!j.is(k.typeToDisplayAttrMap[y])){if(j.is(z)&&j.is(z.get("isInstanceOf"))){z=k._CollectionUtils.references.get(z.get("isInstanceOf"));if(j.is(z)&&j.is(z.get("type"))){y=z.get("type")}}}I=j.is(y)?w[y]:null;if(k.isObjectConstraint()&&v===k._constraintRelationName){if(j.is(I)){if(j.is(k.typeToDisplayAttrMap[y])){D=k.typeToDisplayAttrMap[y]["display_icon"]}else{D=null}if((D==="relatedObject")||(j.is(y,"string"))){B=y}else{if(D==="relation"){B=E.connectionTypeName}else{B="UNKNOWN"}}if(j.is(z)){G=z.get(I.split(".")[0])}else{G="UNKNOWN"}t[v].push({Icon:B,Value:G})}}else{if(j.is(y)&&j.is(k.typeToDisplayAttrMap[y])){J=k.typeToDisplayAttrMap[y]["display_attribute"];D=k.typeToDisplayAttrMap[y]["display_icon"];if(D==="relatedObject"){B=y}else{if(D==="relation"){B=E.connectionTypeName}}if(J.split(".")[1]==="relatedObject"){G=z.get(J.split(".")[0])}else{if(J.split(".")[1]==="relation"){G=A.get(J.split(".")[0])}}}else{if(j.is(y,"string")){B=y}else{B="UNKNOWN"}if(j.is(z)){G=z.get("V_Name")||z.get("name")||z.get("PLM_ExternalId");G=G+" "+z.get("revision")}else{G="UNKNOWN"}}t[v].push({Icon:B,Value:G})}}})}}})}return t}});return k});define("DS/DELWebMfgAssetsDefModelServices/CustoParametersSet",["UWA/Core","DS/DELWebMfgAssetsDefModelServices/Resources","UWA/Class"],function(c,d,a){var g=a.singleton({name:"CustoParametersSet",_infos:{},_currentlySelected:"",init:function i(j){if(c.is(widget.getValue)){this._currentlySelected=widget.getValue("custoParametersSet")}this._parent(j)},isChanged:function h(){var j=false;if(c.is(widget.getValue)){if(this._currentlySelected!=widget.getValue("custoParametersSet")){this._currentlySelected=widget.getValue("custoParametersSet");j=true}}return j},getNames:function b(){var k={value:"OOTBValue",label:d.getNLSValue("Preferences.CustoParametersSetDefault")},l=[k],j=Object.keys(g._infos);j.forEach(function m(n){l.push({value:n,label:d.getNLSValue(n)})});return l},setInformation:function f(j){g._infos=c.is(j)?j:{}},getSelectedPID:function e(){var j="",k;if(c.is(widget)&&c.is(widget.getValue,"function")){k=widget.getValue("custoParametersSet");if(c.is(k,"string")&&this._infos.hasOwnProperty(k)){j=this._infos[k]}}return j}});return g});define("DS/DELWebMfgAssetsDefModelServices/ModelUtils",["UWA/Core","UWA/Date","UWA/Class","DS/Core/Events","UWA/Class/Promise","DS/Logger/Logger","DS/WebappsUtils/WebappsUtils","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/DELWebMfgAssetsDefIndexServices/IndexParser","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/LoggerUtils","DS/DELWebMfgAssetsDefModelServices/ModelPreferences","DS/DELWebMfgAssetsDefModelServices/CustoParametersSet","DS/DELWebMfgAssetsDefModelServices/BehaviorUtil","DS/DocumentManagement/DocumentManagement","DS/DELWebMfgAssetsDefModelServices/CustoXmlUtils","DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns","text!DS/DELWebMfgAssetsDefModelServices/assets/DELWebMfgAssetsDefModelDocument.json","text!DS/DELWebMfgAssetsDefModelServices/assets/DELWebMfgAssetsDefModelTypes.json"],function(aK,Q,aN,aX,aU,G,aB,aM,p,ak,r,m,I,k,w,D,E,S,ah,aH,P){var aL=aN.singleton({name:"ModelUtils",_logger:null,_webServicesCount:1,_selectFacet:[],_computeBo:[],_xmlIndexMapping:"DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUIIndexMapping",_xmlCustomRelations:"DELWebMfgAssetsDefModelServices/DELWebMfgAssetsDefModelCustomRelations",_indexMapping:null,_selectPredicates:{},_defaultSecurityContext:"ctx::FakeDefaultRole.FakeDefaultOrga.FakeDefaultCommonSpace",_widgetTrigram:"NOT_DEFINED",_3DSpaceServiceName:"3DSpace",_servicesURL:{"3DSpace":"NOT_DEFINED","3DSearch":"NOT_DEFINED"},_platformId:{"3DSpace":"NOT_DEFINED","3DSearch":"NOT_DEFINED"},_CSRFToken:null,init:function af(aZ){var aY="uwa";this._parent(aZ);if(aK.is(widget.environment)){if(aK.is(widget.environment.name)){aY=widget.environment.name}}if(aK.is(G)){this._logger=G.getLogger(aL)}if(aY==="uwa"){this.setStandAlone(true)}else{this.setStandAlone(false)}this.xmlCache={};this._typeConfig=JSON.parse(P);this._documentConfig=JSON.parse(aH);this._servicesURL[aL._3DSpaceServiceName]=this.getDefault3DSpaceBaseURL()},retrieveAttributesInfo:function ao(a2,aY){var aZ,a1,a0;if(aK.is(a2)){aZ={uiConfig:this.getXmlFromCache(a2.uiConfig),insertCmd:this.getXmlFromCache(a2.insertCmd),editLink:this.getXmlFromCache(a2.editLink),bomView:this.getXmlFromCache(a2.bomView)}}a0=new S();a1=a0.retrieveAttributesInfoFromXml(aZ);new aU(aL._retrieveDicoAttr.bind(a1)).then(function a4(){if(aK.is(aY)){aY()}},function a3(){aL._logger.error("RetrieveDicoAttr Promise Failure")})},getInitPromise:function U(a0){var aZ=new aU(function aY(a2,a1){aL._initPromiseExec(a0,a2,a1)});return aZ},_initPromiseExec:function aa(a6,a4,aZ){var a1={warnings:[]},a3;a6.preferences.buildView();a3=new aU(function a5(a8,a7){aL._retrieveServiceURL(aL._3DSpaceServiceName,a8,a7)});a3.then(function aY(){var a7;m.set3DSpaceBaseURL(aL.get3DSpaceUrl());a7=new aU(function(a9,a8){a6.securityContext.loadSecurityContexts(a9,a8,a6)});return a7}).then(function a0(a8){var a7=null;if(aK.is(a8,"string")){a1.warnings.push(a8)}a7=new aU(function a9(bb,ba){aL._retrieveCustoParametersSetsInfo(a6.preferences,bb,ba)});return a7}).then(function a2(a8){aL._CSRFToken=aK.is(a8)?(aK.is(a8.eno_csrf_token)?{eno_csrf_token:a8.eno_csrf_token}:null):null;new aU(function a7(){var bd;aL.getXMLValues("DELWebMfgAssetsDefUI/DELWebMfgAssetsDefUITooltipConfig");aL.getXMLValues("DELWebMfgAssetsDefModelServices/DELWebMfgAssetsDefModelConfig",function ba(bf){k.LeftBloc=bf.Config.Preferences.LeftBloc;k.RightBloc=bf.Config.Preferences.RightBloc});if(aK.is(a6.xmlModelRelation,"string")&&(a6.xmlModelRelation.length>0)){aL.getXMLValues(a6.xmlModelRelation,function a9(bf){k.RelationsList=bf.RelationsList})}bd=[new aU(aL._retrieveIndexMapping),new aU(aL._retrieveDicoType),new aU(aL._retrieveResourceType),new aU(aL._retrievePPRTypes),new aU(aL._retrieveDimensions),new aU(aL._retrieveModelCustomRelations),new aU(aL._retrieveAttrMaskInfoForPPRTypes),new aU(function bc(bg,bf){aL._retrieveServiceURL("3DSearch",bg,bf)}),new aU(function(bf){ah.isAdditionalColumnsAvailable(function bg(){bf(ah)})})];aU.all(bd).then(function be(){a4(a1)},function bb(){aL._logger.error("ModelUtils.getInitPromise, initPromiseExec FAILED !!!");aZ()})})})},_retrieveServiceURL:function ap(aY,a1,aZ){var a2=aK.is(widget)?(aK.is(widget.getValue,"function")?widget.getValue("x3dPlatformId"):""):"";if(!aL.isStandAlone()){p.getServiceUrl({serviceName:aY,platformId:a2,onComplete:function a0(a3){if(aK.is(a3,"array")){if(a3.length>0){if(aK.is(a3[0].url)){aL._servicesURL[aY]=a3[0].url+(aY===aL._3DSpaceServiceName?"/":"");aL._platformId[aY]=a3[0].platformId}}}else{if(aK.is(a3,"string")){aL._servicesURL[aY]=a3+(aY===aL._3DSpaceServiceName?"/":"");aL._platformId[aY]=a2}}a1()},onFailure:aZ})}else{a1()}},_retrieveIndexMapping:function K(aZ){aL.getXMLValues(aL._xmlIndexMapping,function aY(a0){aL._indexMapping=a0;aZ()})},_retrieveDicoType:function F(a1,a0){var aZ=aL.getReferenceTypes().concat(aL.getInstanceTypes(),aL.getDocumentTypes());aL.webServiceRequest({url:"dictionary/getTypeInfo?parentInfo=true",method:"POST",data:JSON.stringify(aZ),onComplete:function aY(a2){Object.keys(a2).forEach(function a3(a4){var a6=[],a5=aK.is(a2[a4].parent)?a2[a4].parent:null;while(null!==a5){a6.push(a5);a5=aK.is(a2[a5].parent)?a2[a5].parent:null}if(a6.length>0){a6.reverse();if(-1!==aL.getReferenceTypes().indexOf(a6[0])){aL._typeConfig.reference.types.push(a4)}else{if(-1!==aL.getInstanceTypes().indexOf(a6[0])){aL._typeConfig.instance.types.push(a4)}}if(-1!==aL.getDocumentTypes().indexOf(a6[0])){aL._typeConfig.document.types.push(a4)}if(!aK.is(a2[a6[0]].derivedTypes,"array")){a2[a6[0]].derivedTypes=[]}a2[a6[0]].derivedTypes.push(a4)}a2[a4].inheritanceChain=a6});m.addRscFile(a2);m.putRscLocalInfo();k.typeHierarchy=aK.merge(k.typeHierarchy,a2);a1()},onFailure:a0,onTimeout:a0})},_retrieveResourceType:function L(a1,a0){var aZ=["Resource"];aL.webServiceRequest({url:"dictionary/getTypeInfo",method:"POST",data:JSON.stringify(aZ),onComplete:function aY(a4){var a3=Object.keys(a4).filter(function a2(a5){return(a5!=="Resource")});a4.Resource.derivedTypes=a3;a4.Resource.inheritanceChain=[];k.typeHierarchy.Resource=a4.Resource;a1()},onFailure:a0,onTimeout:a0})},_retrieveDicoAttr:function B(a3,a1){var a2=aK.Json.encode(this),aZ=function aZ(a5,a4){aL.webServiceRequest({url:"dictionary/getAttributesInfo",method:"POST",onComplete:a5,onFailure:a4,onTimeout:a4,data:a2})},aY=function aY(a5,a4){aL.webServiceRequest({url:"modeler/ppr/getAttributesMaskInfo",method:"POST",onComplete:a5,onFailure:a4,onTimeout:a4,data:a2})},a0=function a0(a4){var a8,a5={},a7={};if(aK.is(a4,"array")&&(a4.length===2)){a8=a4[0].map(function a6(bc){var ba={},a9=a4[1].filter(function(bd){return(bd.type===bc.type)})[0];ba.type=bc.type;ba.info=aK.extend(a9.info,bc.info,true);ba.info.forEach(function bb(bd){var be=ba.type+"."+bd.Name;a7[be]=bd.NLS;a5[be]=bd});return ba})}aL._logger.log("Attributes info merged (dico and mask): "+JSON.stringify(a8));m.addNlsJSON(a7);m.addAttributeInfo(a5);a3(a8)};aU.all([new aU(aZ),new aU(aY)]).then(a0,a1)},_retrievePPRTypes:function aG(a2,a0){aL.webServiceRequest({url:"modeler/ppr/getPPRTypes",method:"GET",onComplete:function aY(a3){k.PPRTypes=a3;a2()},onFailure:function aZ(){k.PPRTypes=[];a0()},onTimeout:function a1(){k.PPRTypes=[];a0()}})},_retrieveDimensions:function ai(a0,aZ){aL.webServiceRequest({url:"dictionary/dimensions",method:"GET",onComplete:function aY(a1){m.addDimensions(a1.results);a0()},onFailure:aZ,onTimeout:aZ})},_retrieveCustoParametersSetsInfo:function y(aZ,a2,a1){var a0=function a0(){aL._logger.error("ModelUtils.getInitPromise, get getCustoParametersSets FAILED !!!");a1()};aL.webServiceRequest({url:"modeler/ppr/getCustoParametersSetsInfo",method:"GET",onComplete:function aY(a4,a3){w.setInformation(a4);aZ.populateCustomParameters();aZ.populateSecurityContext();a2(a3)},onFailure:a0,onTimeout:a0})},_retrieveAttrMaskInfoForOperationTypes:function ab(aZ,aY){aL.getAttributeMaskInfoOfType("OPERATION",aZ,aY)},_retrieveAttrMaskInfoForSystemTypes:function aS(aZ,aY){aL.getAttributeMaskInfoOfType("SYSTEM",aZ,aY)},_retrieveAttrMaskInfoForResourceTypes:function aA(aZ,aY){aL.getAttributeMaskInfoOfType("RESOURCE",aZ,aY)},_retrieveAttrMaskInfoForProcessTypes:function a(aZ,aY){aL.getAttributeMaskInfoOfType("PROCESS",aZ,aY)},_retrieveAttrMaskInfoForProductTypes:function b(aZ,aY){aL.getAttributeMaskInfoOfType("PRODUCT",aZ,aY)},_retrieveAttrMaskInfoForPartTypes:function ag(aZ,aY){aL.getAttributeMaskInfoOfType("PART",aZ,aY)},_retrieveAttrMaskInfoForPPRTypes:function aF(a1,aZ){var aY=[new aU(aL._retrieveAttrMaskInfoForProcessTypes),new aU(aL._retrieveAttrMaskInfoForResourceTypes)];if(aL.getWidgetTrigram()==="MFN"){aY.push(new aU(aL._retrieveAttrMaskInfoForProductTypes));aY.push(new aU(aL._retrieveAttrMaskInfoForPartTypes))}else{aY.push(new aU(aL._retrieveAttrMaskInfoForSystemTypes));aY.push(new aU(aL._retrieveAttrMaskInfoForOperationTypes))}aU.all(aY).then(function a2(){a1()},function a0(){aL._logger.error("ModelUtils._retrieveAttrMaskInfoForPPRTypes FAILED !!!");aZ()})},_retrieveModelCustomRelations:function ar(aZ){aL.getXMLValues(aL._xmlCustomRelations,function aY(a1){var a5,a0,a8,a9={},a3={},a4,a7,a6=[],a2=0;if(aK.is(a1.CustomRelationsList.RelationConfig)){a4=a1.CustomRelationsList.RelationConfig;a4=Array.isArray(a4)?a4:[a4];for(a5=0;a5<a4.length;a5++){a0=a4[a5].fromType;a8=a4[a5].toType;a7=a4[a5]["Relation"];a6=[];if(!aK.is(a3[a0])){a3[a0]={}}a3[a0][a8]=false;if(aK.is(a7)){a7=Array.isArray(a7)?a7:[a7];for(a2=0;a2<a7.length;a2++){if(a7[a2]["type"]==="Instance"){a3[a0][a8]=a7[a2].write}else{a6.push(a7[a2])}}}if(!aK.is(a9[a0])){a9[a0]={}}a9[a0][a8]={Relation:a6}}k.CustomRelationsList=a9;k.CustomInstanceList=a3}aZ()})},getExecuteByBlockPromise:function H(a9){var a7=null,a1=500,a3=5,aY=a9||{},bc=aK.is(aY.callback,"function")?aY.callback:function ba(){},aZ=aK.is(aY.context)?aY.context:a7,bd=aK.is(aY.globalArray,"array")?aY.globalArray:[],a8=aK.is(aY.blockSize,"number")?((Math.abs(Math.floor(aY.blockSize))>0)?Math.abs(Math.floor(aY.blockSize)):a1):a1,a6=aK.is(aY.delay,"number")?Math.abs(Math.floor(aY.delay)):a3,a0=Math.floor(bd.length/a8)+1,a4=null,a5=0,bb=function bb(bf,bg){var be=function be(bk,bi){var bh=function bh(){bk(bg+1)},bj=function bj(){bc.call(aZ,bf,bh,bi)};if(bf.length>0){setTimeout(bj,a6)}else{bk(bg+1)}};return new aU(be)},a2=function a2(be){return bb(bd.slice(be*a8,(be+1)*a8),be)};for(a5=0;a5<a0;a5++){if(aK.is(a4)){a4=a4.then(a2)}else{a4=a2(0)}}return a4},getReferenceTypes:function ay(){return aL._typeConfig.reference.types},getDocumentTypes:function d(){return aL._typeConfig.document.types},getInstanceTypes:function aP(){return aL._typeConfig.instance.types},getConnectionTypes:function aw(){return aL._typeConfig.connection.types},isEntityReference:function A(aY){return aL.getReferenceTypes().indexOf(aY)!==-1},isReferenceDocument:function f(aY){return aL.getDocumentTypes().indexOf(aY)!==-1},isEntityInstance:function ax(aY){return aL.getInstanceTypes().indexOf(aY)!==-1},isEntityConnection:function Y(aY){return aL.getConnectionTypes().indexOf(aY)!==-1},getWidgetTrigram:function z(){return aL._widgetTrigram},setWidgetTrigram:function C(aY){aL._widgetTrigram=aY},getAppId:function aV(){var aY="/no_private_channel";if(aK.is(widget)){if(aK.is(widget.getValue("x3dSharedId"))){aY="/"+widget.getValue("x3dSharedId")}else{if(aK.is(widget.getValue("x3dAppId"))){aY="/"+widget.getValue("x3dAppId")}else{if(aK.is(widget.getValue("appId"))){aY="/"+widget.getValue("appId")+"_"+widget.id}}}}return aY},getUid:function aC(){return(((1+Math.random())*65536)|0).toString(16).substring(1)},setForceDBMode:function i(aY){aL._logger.log("ModelUtils.setForceDBMode: "+aY);if(D.isSwitchToDBMode()){widget.setValue("forceDBModePreferences",aY.toString())}},isNavigateOn:function aJ(){var aY,aZ=false;if(D.isSwitchToDBMode()){aZ=widget.getValue("forceDBModePreferences")}if(!aZ){aY=k.getNavigateOn()}return aY},getAuthoringContextHdr:function j(){var aZ=ak.get(),aY=aK.is(aZ)?aK.is(aZ.AuthoringContextHeader)?aZ.AuthoringContextHeader:{}:{};return aY},setCAAndGetDetailsPromise:function aj(a0){var aY,a1={context:1},aZ=function aZ(a4,a3){var a2=function a2(a7){var a8=aK.is(a7)?(aK.is(a7.changeaction)?aK.is(a7.changeaction.context,"array")?a7.changeaction.context:[]:[]):[],a6=[];a8.forEach(function a5(ba){var a9=aK.is(ba)?(aK.is(ba.id,"string")?ba.id.split(":"):[]):[];if((a9.length===2)&&("pid"===a9[0])&&(0!==a9[1].length)){a6.push(a9[1])}});a4(a6)};aL.webServiceRequest({url:"modeler/change/changeaction/pid:"+a0,method:"GET",header:aL.getHeaders({isJsonOnly:true}),data:a1,onComplete:a2,onFailure:a3,onTimeout:a3})};ak.set({version:"1.0",change:{id:a0}});aY=new aU(aZ);return aY},setSelectPredicate:function aQ(aY,aZ){var a0=["PID","type","interface","PLM_ExternalID","isAggregatedBy","isInstanceOf","V_discipline","V_TreeOrder"];a0.forEach(function(a1){if(aZ.indexOf(a1)===-1){aZ.push(a1)}});aL._selectPredicates[aY]={entity:this.translateAttributeToPredicate(aZ,{type:"entity"}),relation:this.translateAttributeToPredicate(aZ,{type:"relation"})}},getSelectPredicate:function q(a0,aZ){var aY=[],a1=aL._selectPredicates;a0=a0||"entity";if(!aZ){switch(a0){case"entity":Object.keys(a1).forEach(function(a3){var a4=a1[a3].entity,a2=Object.keys(a4).map(function(a5){return a4[a5]});a2.forEach(function(a5){if(aY.indexOf(a5)===-1){aY.push(a5)}})});break;case"relation":Object.keys(a1).forEach(function(a3){var a4=a1[a3].relation,a2=Object.keys(a4).map(function(a5){return a4[a5]});a2.forEach(function(a5){if(aY.indexOf(a5)===-1){aY.push(a5)}})});break;default:}}else{switch(a0){case"entity":aY=a1[aZ].entity;break;case"relation":aY=a1[aZ].relation;break;default:}}return aY},getSelectUnit:function aD(aZ){var a1=aL.translatePredicateToAttribute(aZ),aY={},a0;a1.forEach(function(a3,a2){a0=m.getAttributeInfo(a3);if(a0&&a0.ManipulationUnit){aY[aZ[a2]]=m.getNLSForUnit(a0.Magnitude,a0.ManipulationUnit)}});return aY},getDefault3DSpaceBaseURL:function O(){var aZ=/^(https?:\/\/)?([\da-z\.-]+)(:[0-9]{2,5})?([\/\w \.-]*3DDashboard\/)*/,a1=aB.getWebappsBaseUrl(),a0=a1.match(aZ),aY="";if(aK.is(a0)&&aK.is(a0,"array")){aY=(aK.is(a0[1])?a0[1]:"")+a0[2]+(aK.is(a0[4])?"":a0[3])+(aK.is(a0[4])?a0[4].replace(/3DDashboard\/?/,"3DSpace/"):"/3DSpace/")}return aY},isStandAlone:function al(){return this._standalone},setStandAlone:function aq(aY){this._standalone=aY;if(aK.is(this._logger)){if(this._standalone){this._logger.info("Widget on STANDALONE mode.")}else{this._logger.info("Widget on PLATFORM mode.")}}},getXMLValues:function an(a7,a5,a3){var a9=a7.split("/"),aY=aB.getWebappsBaseUrl()+a9[0]+"/assets/xml/"+a9[1]+".xml",a4=this,a1,a0,a8={dataCache:[],convert:function a6(bc,bb){var be=bc.split("."),bd=this,ba;if(!aK.is(this.dataCache[bb])){for(ba=0;ba<be.length;++ba){if(!aK.is(bd[be[ba]])){bd=null;break}else{bd=bd[be[ba]]}}if(aK.is(bd)){this.dataCache[bb]={};if(aK.typeOf(bd)==="array"){for(ba=0;ba<bd.length;++ba){this.dataCache[bb][bd[ba][bb]]=bd[ba];delete this.dataCache[bb][bd[ba][bb]][bb]}}else{if(aK.typeOf(bd)==="object"){this.dataCache[bb][bd[bb]]=bd}}}if(aK.is(a4._logger)){a4._logger.log("getXMLValues.convert, COMPUTE: ");a4._logger.log(this.dataCache[bb])}}return this.dataCache[bb]}};if(aK.Utils.isValidUrl(aY)){if(aK.is(this.getXmlFromCache(a7))){if(aK.is(a5)){a5(a4.getXmlFromCache(a7))}}else{a1=function aZ(ba){if(aK.is(a4._logger)){a4._logger.log("ModelUtils.getXMLValues(), REQUEST: "+a7)}if(aK.is(ba)){a4.xmlCache[a7]=aK.merge(ba.fileContent,a8);if(aK.is(a5)){a5(a4.getXmlFromCache(a7))}a4._logger.log(a4.getXmlFromCache(a7))}else{a4._logger.warn("configurationXML response data is undefined. XML requested: "+a7)}};a0=function a2(ba){if(aK.is(a4._logger)){a4._logger.warn("!!! ModelUtils.getXMLValues(), ERROR: "+a7);a4._logger.log(ba)}if(aK.is(a3)){a3(ba)}};aL.webServiceRequest({url:"modeler/ppr/configurationXML?frameworkName="+a9[0]+"&fileName="+a9[1]+".xml&custoParamSetPID="+w.getSelectedPID(),method:"GET",onComplete:a1,onFailure:a0})}}else{if(aK.is(a4._logger)){a4._logger.warn("!!! ModelUtils.getXMLValues(), xmlPath NOT valid (url):");a4._logger.log(aY)}}},getPreferencesValue:function ac(aZ){var aY;if(!aK.is(aZ)){this._logger.error("iOptions must exist in ModelUtils.webServiceRequest call.");return}if(this.isStandAlone()){if(aK.is(this.standAloneWebServiceRequest)){}}else{aY=widget.getValue(aZ);return aY}},printCurrentDateTime:function R(aZ){var aY=new Q();if(aK.is(this._logger)){this._logger.log(aZ+aY.toISOString())}return aY},printDuration:function g(a3,a0){var aZ=Q.now(),a1=a3.getTime(),a2=aZ-a1,aY="Duration: ";if(aK.is(this._logger)){if(aK.is(a0)){aY="Duration (for "+a0+"): "}this._logger.log(aY+a2+" ms")}return a2},get3DSpaceUrl:function N(){return aL._servicesURL[aL._3DSpaceServiceName]},get3DSpaceServiceName:function N(){return aL._3DSpaceServiceName},get3DSearchURL:function ad(){var aY=(aK.is(this._servicesURL["3DSearch"],"string")&&(this._servicesURL["3DSearch"].length>0))?this._servicesURL["3DSearch"]:null,aZ=this.get3DSpaceUrl();if(!aK.is(aY)){if(aK.is(aZ,"string")){aZ=aZ.replace(/3DSpace\/$/,"");aY=aZ+"federated"}else{aL._logger.warn("ERROR: Couldn't retrieve the base url")}}return aY},getPlatformId:function x(aY){var aZ=null;if(aK.is(aY.serviceId,"string")){aZ=aL._platformId[aY.serviceId]}else{aL._logger.warn("ERROR: Couldn't retrieve the platform ID")}return aZ},getAssetFolder:function at(aY){var aZ;aY=aY||{};aZ=aY.module||m.getAssetsModule();return aB.getWebappsAssetUrl(aZ,"")},getWebServicesURL:function s(){return this.get3DSpaceUrl()+"resources/modeler/pprirpc"},webServiceRequest:function n(a7){var a8=/^https?:\/\//i,ba=this,a0={},bb,a9,a5,a1,a2,aZ,a4,aY,a6,a3;if(!aK.is(a7)){this._logger.error("iOptions must exist in ModelUtils.webServiceRequest call.");return}if(!aK.is(a7.url,"string")){this._logger.error("iOptions.url must be a string in ModelUtils.webServiceRequest call.");return}if(!aK.is(a7.method,"string")){this._logger.error("iOptions.method must be be defined in ModelUtils.webServiceRequest call.");return}bb=a8.test(a7.url)?a7.url:(this.get3DSpaceUrl()+"resources/"+a7.url);a9=aK.is(a7.type)?a7.type:"json";a5=aK.is(a7.data)?a7.data:null;a1=aK.is(a7.headers)?a7.headers:this.getHeaders();a2=aK.is(a7.async)?a7.async:true;aZ=aK.is(a7.context)?a7.context:this;a4=aK.is(a7.noProxy)?null:"passport";aY=aK.is(a7.authenticated)?a7.authenticated:true;a6=this.getTimeoutPreference();a3=aK.is(a7.timeOutExtensionPromise)?a7.timeOutExtensionPromise&&D.isDynamicTimeoutMode():false;if(this.isStandAlone()){if(aK.is(this.standAloneWebServiceRequest)){this.standAloneWebServiceRequest(this,a0,a7.url,a7.method,a9,a7.onComplete,a5,a7.onFailure,aZ)}}else{aX.publish({event:"DELMGAMFN/webService/Start"});document.body.style.cursor="wait";(function(){var be=Q.now(),bc=ba._webServicesCount+"-START- "+a7.url+" request / Time: "+new Q(be).toISOString(),bo=ba._webServicesCount+"-END- "+a7.url+" request",bk=ba._webServicesCount+"-FAIL- "+a7.url+" request",bd=ba._webServicesCount+"-TIME OUT- "+a7.url+" request",bn=(a3)?a7.timeOutExtensionPromise:null,bm,bi,bs,bf,bh,bj,br,bl;if(aK.is(ba._logger)){ba._logger.log(bc)}bs={headers:a1,method:a7.method,type:a9,data:a5,async:a2};if(!a7.noProxy){bs.proxy=a4}bs.onComplete=function bp(bu,bv){document.body.style.cursor="default";if(aK.is(ba._logger)){bj=Q.now();bh=bj-be;bf=" / Duration: "+bh+" ms";br=bo+bf;ba._logger.log(br)}if(aK.is(a7.onComplete)){try{a7.onComplete.call(aZ,bu,bv)}catch(bt){ba._logger.warn("Exception in onComplete CB");ba._logger.warn(bt)}}if(aK.is(a7.logMessage)){I.logCompleted(bl,a7.logMessage)}aX.publish({event:"DELMGAMFN/webService/End"})};bs.onFailure=function bg(bw,bu,bt){document.body.style.cursor="default";if(aK.is(ba._logger)){ba._logger.warn(bk);ba._logger.warn(bw)}if(aK.is(a7.onFailure)){try{a7.onFailure.call(aZ,bw,bu,bt)}catch(bv){ba._logger.warn("Exception in onFailure CB");ba._logger.warn(bv)}}if(aK.is(a7.logMessage)){I.logFailed(bl,a7.logMessage)}aX.publish({event:"DELMGAMFN/webService/End"})};bm=function bq(bu){document.body.style.cursor="default";if(aK.is(ba._logger)){ba._logger.warn(bd);ba._logger.warn(bu)}if(aK.is(a7.onTimeout)){try{a7.onTimeout.call(aZ,bu)}catch(bt){ba._logger.warn("Exception in onTimeout CB");ba._logger.warn(bt)}}if(aK.is(a7.logMessage)){I.logTimedOut(bl,a7.logMessage)}aX.publish({event:"DELMGAMFN/webService/End"})};if(a3){bs.timeout=0;bs.onCancel=bm}else{bs.timeout=a6;bs.onTimeout=bm}if(aK.is(a7.logMessage)){bl=I.getNextIndex();I.logStarted(bl,a7.logMessage)}if(aY){ba._logger.log("Call to WAFData.authenticatedRequest(URL, options): ",bb+", "+aK.Json.encode(bs));bi=aM.authenticatedRequest(bb,bs)}else{ba._logger.log("Call to WAFData.proxifiedRequest(URL, options): ",bb+", "+aK.Json.encode(bs));bi=aM.proxifiedRequest(bb,bs)}if(a3){(function(){var bt,bw,bv,bu;bv=function bv(){return bi.xhr.readyState===bi.xhr.DONE};bu=bi.xhr.onreadystatechange;bi.xhr.onreadystatechange=function bx(){if(bv()){clearTimeout(bw)}if(bu){bu.apply(this,arguments)}};bt=function bt(){bw=setTimeout(function by(){bn().then(function bA(){if(!bv()){bt()}},function bz(){bi.cancel()})},a6)};bt()})()}ba._webServicesCount++})()}},getTimeoutPreference:function l(){var aZ,aY=600;if(aK.is(widget)){if(aK.is(widget.hasPreference,"function")){if(widget.hasPreference("timeout")){aZ=widget.getPreference("timeout");aY=parseInt(aZ.value);if(isNaN(aY)||aY<=0){aY=parseInt(aZ.defaultValue)}}}return aY*1000}},setSecurityContext:function am(aZ){var aY="ctx::";aL._logger.log("setSecurityContext: "+aK.Json.encode(aZ));this._defaultSecurityContext=aK.is(aZ)?aY+aZ:""},getSecurityContext:function aE(){return this._defaultSecurityContext},getTenant:function o(){var aY="OnPremise";return aY},getHeaders:function aT(aY){var a5="en",a0=aY||{},a2=aK.is(a0.isJsonOnly)?a0.isJsonOnly:false,aZ=aK.is(a0.isAuthoringCtx)?a0.isAuthoringCtx:false,a1=aK.is(a0.minorVersion)?a0.minorVersion:"",a4=aL.getAuthoringContextHdr(),a3={"Accept-Language":aK.is(widget)?(aK.is(widget.lang,"string")?widget.lang:a5):a5,SecurityContext:aL.getSecurityContext()};if(a2){a3.Accept="application/json";a3["Content-Type"]="application/json"}else{a3.Accept="application/json,text/javascript,*/*";a3["Content-Type"]="application/ds-json"}if(aZ){a3=aK.extend(a3,a4)}if(""!==a1){a3["DS-API-Version"]=a1}if(aK.is(aL._CSRFToken)){a3=aK.extend(a3,aL._CSRFToken)}return a3},getCVServletLabel:function c(){return this._widgetTrigram+"-"+(new Q()).toISOString()},fetchOnIndex:function X(a4,a5){var aZ=aL.get3DSpaceUrl()+"cvservlet/fetch/v2",aY=a5||{},ba=aK.is(aY.type,"string")?aY.type:"entity",bb=aK.is(aY.context)?aY.context:null,a1=aK.is(a4)?aK.is(a4,"array")?a4:[a4]:null,a9=aK.is(aY.select_predicate)?aY.select_predicate:aL.getSelectPredicate(ba),a7=aL.getSelectUnit(a9),a6={label:this.getCVServletLabel(),physicalid:a1,select_predicate:a9,locale:widget.locale,lang:widget.lang,select_unit:a7,with_synthesis_attribute:true};aL.webServiceRequest({url:aZ,method:"POST",headers:aL.getHeaders({isJsonOnly:true}),data:aK.Json.encode(a6),onComplete:function a0(bd){var bc=[],bf=aK.is(bd)?aK.is(bd.results,"array")?bd.results:[bd.results]:null;if(aK.is(bf,"array")){bf.forEach(function be(bg){var bi=r.parseFetchResult(bg),bh=aL.translatePredicateToAttribute(bi.attributes,{type:ba});aK.merge(bh,aL.translatePredicateToAttribute(bi.ds6w,{type:ba,fromExpandService:true}));bi.attributes=bh;bc.push(bi)})}if(aK.is(aY.onComplete,"function")){bc=(bc.length>0)?(bc.length>1)?bc:bc[0]:null;aY.onComplete.call(bb,bc)}},onFailure:function a8(bc){if(aK.is(aY.onFailure,"function")){aY.onFailure.call(bb,bc)}},onTimeout:function a2(bc){if(aK.is(aY.onFailure,"function")){aY.onFailure.call(bb,bc)}},onCancel:function a3(bc){if(aK.is(aY.onFailure,"function")){aY.onFailure.call(bb,bc)}}})},expandOnIndex:function v(a6,a2,aZ){var a1=this.get3DSpaceUrl()+"cvservlet/expand",bh=aL.getSelectPredicate("entity"),aY=aL.getSelectPredicate("relation"),a8=aL.getSelectUnit(bh),bf=aL._selectFacet,a9=aL._computeBo,bd,a3={},bg,be,a4,a7=["union","intersection","minus"],a0;aZ=aZ||{};if(aK.is(aZ.selectBo,"array")){bh=aZ.selectBo}if(aK.is(aZ.selectRel,"array")){aY=aZ.selectRel}if(aK.is(aZ.selectFacets,"array")){bf=aZ.selectFacets}if(aK.is(aZ.computeBo,"array")){a9=aZ.computeBo}if(aK.is(aZ.cvquery,"object")){bd=aZ.cvquery}bg={label:this.getCVServletLabel(),select_bo:bh,select_rel:aY,select_ds6w_facet:bf,compute_select_bo:a9,locale:widget.locale,lang:widget.lang,select_unit:a8};be=["MfgProcessAlternate","Alternate"];if(aK.is(bd)){aK.merge(bg,bd);for(a4 in bd){if(bd.hasOwnProperty(a4)){if(a7.indexOf(a4)!==-1){a0=bd[a4].expand;if(aK.is(a0,"array")){a0.forEach(function(bi){bi.no_type_filter_rel=be});break}}}}a1=this.get3DSpaceUrl()+"cvservlet/multiexpand"}else{if(a6 instanceof Array){bg.multi_root_physicalid=a6}else{bg.root_physicalid=a6}if(aK.is(aZ.expandIter,"string")){bg.expand_iter=aZ.expandIter}bg.no_type_filter_rel=be}bg=aK.Json.encode(bg);this.webServiceRequest({url:a1,method:"POST",headers:aL.getHeaders({isJsonOnly:true}),data:bg,onComplete:function bb(bj){var bi;if(a2 instanceof Function){bi=r.parseNavigateResult(bj);a3={roots:bi};a2.call(aZ.context,a3)}},onFailure:function bc(bi){if(aZ.onFailure instanceof Function){aZ.onFailure.call(aZ.context,bi)}},onTimeout:function ba(bi){if(aZ.onTimeout instanceof Function){aZ.onTimeout.call(aZ.context,bi)}},timeOutExtensionPromise:aZ.timeOutExtensionPromise,onCancel:function a5(bi){if(aZ.onFailure instanceof Function){aZ.onFailure.call(aZ.context,bi)}}})},navigateOnIndex:function M(a7,a8,ba){var aZ=this.get3DSpaceUrl()+"cvservlet/navigate?SecurityContext="+this.getSecurityContext(),aY=[],a1,a5={},a3,a9,a4=aL.getSelectPredicate("entity").concat(aL.getSelectPredicate("relation"));a1=a4.length;while(a1--){a9=a4[a1];if(!a5[a9]){aY.unshift(a9);a5[a9]=true}}ba=ba||{};if(!(a7 instanceof Array)){a7=[a7]}if(ba.selectBo instanceof Array){aY=ba.selectBo}aY.push("pathsr");a3={label:this.getCVServletLabel(),input_physical_ids:a7,primitives:[{navigate_to_sr:{id:1,filter:{role:["52"],category:["7"]},mode:"path"},navigate_from_sr:{id:2,mode:"ends",filter:{role:["52"],category:["7"]}}},{navigate_to_sr:{id:3,filter:{role:["51"],category:["5"]},mode:"path"},navigate_from_sr:{id:4,mode:"ends",filter:{role:["51"],category:["5"]}}},{navigate_to_sr:{id:5,filter:{role:["203"],category:["5"]},mode:"path"},navigate_from_sr:{id:6,filter:{role:["203"],category:["5"]}}},{navigate_to_sr:{id:7,filter:{role:["204"],category:["6"]},mode:"path"},navigate_from_sr:{id:8,filter:{role:["204"],category:["6"]}}},{navigate_to_sr:{id:9,filter:{role:["296"],category:["1"]},mode:"path"},navigate_from_sr:{id:10,filter:{role:["296"],category:["1"]}}},{navigate_to_sr:{id:11,filter:{role:["363"],category:["1"]},mode:"path"},navigate_from_sr:{id:12,filter:{role:["363"],category:["1"]}}},{navigate_to_rel:{id:13,filter:{rel_type:["MfgProcessAlternate"]},mode:"return_rel"},navigate_from_rel:{id:14,filter:{rel_type:["MfgProcessAlternate"]},mode:"return_rel"}},{navigate_to_rel:{id:15,filter:{rel_type:["VPLMrel_47_PLMPort_47_V_Owner"]}},navigate_from_rel:{id:16,filter:{rel_type:["VPLMrel_47_PLMPort_47_V_Owner"]},mode:"return_rel"}},{navigate_to_sr:{id:17,filter:{role:["296"],category:["1"]}}},{navigate_to_sr:{id:18,filter:{role:["308"],category:["7"]},mode:"path"},navigate_from_sr:{id:19,filter:{role:["308"],category:["7"]}}},{navigate_to_sr:{id:20,filter:{role:["307"],category:["5"]},mode:"path"},navigate_from_sr:{id:21,filter:{role:["307"],category:["5"]}}},{navigate_to_rel:{id:22,filter:{rel_type:["VPLMrel_47_PLMConnection_47_V_Owner"]}},navigate_to_sr:{id:23,filter:{role:["87"],category:["1"]},mode:"path"}},{navigate_to_sr:{id:24,filter:{role:["248"],category:["1"]},mode:"path"},navigate_from_sr:{id:25,mode:"ends",filter:{role:["248"],category:["1"]}}},{navigate_to_sr:{id:26,filter:{role:["249"],category:["1"]},mode:"path"},navigate_from_sr:{id:27,mode:"ends",filter:{role:["249"],category:["1"]}}},{navigate_to_sr:{id:28,filter:{role:["295"],category:["1"]},mode:"path"},navigate_from_sr:{id:29,filter:{role:["295"],category:["1"]}}},{navigate_to_sr:{id:30,filter:{role:["294"],category:["1"]},mode:"path"},navigate_from_sr:{id:31,filter:{role:["294"],category:["1"]}}}],patterns:{scope_pathSR:[{id:2},{id:3}],scopeInverse_pathSR:[{id:4},{id:1}],candidateResource_pathSR:[{id:6},{id:7}],candidateResourceInverse_pathSR:[{id:8},{id:5}],mbomSystemOutput_pathSR:[{id:15},{id:10},{id:11}],mbomSystemOutputInverse_pathSR:[{id:12},{id:9}],mbomSystemOutputInverse_relation:[{id:12},{id:17},{id:16}],mbomOperationOutput_pathSR:[{id:10},{id:11}],mbomOperationOutputInverse_pathSR:[{id:12},{id:9}],alternate_relation:[{id:13}],alternateInverse_relation:[{id:14}],historization_pathSR:[{id:19},{id:20}],historizationInverse_pathSR:[{id:21},{id:18}],document_pathSR:[{id:22},{id:23}],productFlow_pathSR:[{id:25},{id:26}],productFlowInverse_pathSR:[{id:27},{id:24}],productMbomImplement_pathSR:[{id:3}],productMbomImplementInverse_pathSR:[{id:4}],Material_pathSR:[{id:29},{id:30}],MaterialInverse_pathSR:[{id:31},{id:28}],operationProcessImplement_pathSR:[{id:2},{id:3}],operationProcessImplementInverse_pathSR:[{id:4},{id:1}]},patternTypeFilters:{mbomSystemOutputInverse_pathSR:{typesReturn:["DELLmiProdSystemIOPort"]},mbomOperationOutputInverse_pathSR:{typesToNotReturn:["DELLmiProdSystemIOPort"]},productMbomImplementInverse_pathSR:{typesToNotReturn:["DELFmiProcessImplementCnx","DELFmiFunctionIdentifiedInstance","MfgProductionPlanning"]},scope_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},scopeInverse_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},operationProcessImplement_pathSR:{typesToNotReturn:["PLMCoreReference"],filterLinksOn:"elements"},operationProcessImplementInverse_pathSR:{typesToNotReturn:["PLMCoreReference"],filterLinksOn:"elements"}},attributes:aY,fileAttributes:[],version:3};if(aK.is(ba.expandIter,"string")){a3.expand_iter=ba.expandIter}a3=aK.Json.encode(a3);this.webServiceRequest({url:aZ,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",},data:a3,onComplete:function a2(bb){if(a8 instanceof Function){a8.call(ba.context,bb)}},onFailure:function a0(bb){if(ba.onFailure instanceof Function){ba.onFailure(bb)}},onTimeout:function a6(bb){if(ba.onTimeout instanceof Function){ba.onTimeout.call(ba.context,bb)}},timeOutExtensionPromise:ba.timeOutExtensionPromise})},navigateOnIndexRequirements:function az(a5,a6,a2,a7){var aZ=this.get3DSpaceUrl()+"cvservlet/navigate?SecurityContext="+this.getSecurityContext(),aY=aL.getSelectPredicate("entity"),a3;a7=a7||{};if(!(a5 instanceof Array)){a5=[a5]}if(a7.selectBo instanceof Array){aY=a7.selectBo}a3={label:this.getCVServletLabel(),input_physical_ids:a5,primitives:[],patterns:{},patternTypeFilters:{},attributes:aY,fileAttributes:[],version:3};a2.forEach(function(ba,a9){var a8=a9+1,bb="customPath_relation"+a9;a3.primitives.push({navigate_from_rel:{id:a8,filter:{rel_type:[ba.relation]},mode:"return_rel"}});a3.patterns[bb]=[{id:a8}]});a3=aK.Json.encode(a3);if(aL.isStandAlone()){aZ="/modeler/cvservlet/navigateCustom"}this.webServiceRequest({url:aZ,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",},data:a3,onComplete:function a1(a8){if(a6 instanceof Function){a6.call(a7.context,a8)}},onFailure:function a0(a8){if(a7.onFailure instanceof Function){a7.onFailure.call(a7.context,a8)}},onTimeout:function a4(a8){if(a7.onTimeout instanceof Function){a7.onTimeout.call(a7.context,a8)}}})},translatePredicateToAttribute:function aI(aZ,a0){var aY,a1,a2,a3=function a3(a5){var a4={};a5=a5||{};Object.keys(a5).forEach(function(a6){var a7=a5[a6];if(!(a7 instanceof Function)&&0!==a6.indexOf("_")){if(aK.is(a7)&&aK.is(a7.value)){a4[a6]=a7.value}}});return a4};a0=a0||{};a2=a0.type||"entity";if(aZ instanceof Array){aY=[]}else{aY={};if(a0.fromExpandService){aZ=a3(aZ)}}switch(a2){case"entity":a1=this._indexMapping.IndexMapping.Entity.Key;break;case"relation":a1=this._indexMapping.IndexMapping.Relation.Key;break;default:}if(this._indexMapping){if(aZ instanceof Array){aZ.forEach(function(a5){var a4;a1.some(function(a6){var a7=a6.index===a5;if(a7){a4=a6}return a7});if(a4){if(aY.indexOf(a4.database)===-1){aY.push(a4.database)}}})}else{Object.keys(aZ).forEach(function(a6){var a5,a7,a4;a1.some(function(a8){var a9=a8.index===a6;if(a9){a4=a8}return a9});if(a4){a5=aZ[a4.index];a1.some(function(a8){var a9=a8.index===a5;if(a9){a7=a8}return a9});if(a7){a5=a7.database}aY[a4.database]=a5}})}}return aY},translateAttributeToPredicate:function av(a2,aZ){var aY=[],a1,a0;aZ=aZ||{};a1=aZ.type||"entity";switch(a1){case"entity":a0=this._indexMapping.IndexMapping.Entity.Key;break;case"relation":a0=this._indexMapping.IndexMapping.Relation.Key;break;default:}if(this._indexMapping){a2.forEach(function(a4){var a3;a0.some(function(a5){var a6=a5.database===a4;if(a6){a3=a5}return a6});if(a3){if(aY.indexOf(a3.index)===-1){aY.push(a3.index)}}})}return aY},unique:function u(aY){var aZ=function aZ(a2,a1,a0){return(a0.indexOf(a2)===a1)};return aY.filter(aZ)},castToBoolean:function e(aY){return aK.is(aY)?aY:false},timestampToDate:function W(a0,aZ){var aY,a1="%Y/%m/%d";if(aK.is(a0,"string")){a0=parseInt(a0)}if(!aK.is(a0,"number")){this._logger.warn("timestamp must be a number. timestamp: "+a0);return null}aZ=aZ||{};aY=new Q(a0);if(!aK.is(aY)){this._logger.warn("Could not create date from timestamp: %d",a0);return null}if(aK.is(aZ.format,"string")){a1=aZ.format}return aY.strftime(a1)},isAKindOf:function ae(aZ,a2){var a0=false,a1=aK.is(aZ)?(aK.is(aZ,"string")?aZ:(aK.is(aZ.get,"function")?aZ.get("type"):null)):null,aY=(aK.is(a2,"string")&&(0<a2.length))?k.getTypeHierarchy(a2):null;if(aK.is(a1,"string")&&aK.is(a2,"string")){if(a2===a1){a0=true}else{if(aK.is(aY,"array")){a0=aY.some(function a3(a4){return(a1===a4)},this)}}}return a0},getDocumentInfo:function J(aZ,aY){if(aL.isStandAlone()){aK.merge(aY,{url:"modeler/pprirpc/document",method:"GET",data:aZ});aL.webServiceRequest(aY)}else{E.getDocuments(aZ,aY)}},getAttributeMaskInfoOfType:function Z(aZ,a2,aY){var a0=this,a1=function a1(a3){var a4;for(a4 in a3){if(Object.prototype.hasOwnProperty.call(a3,a4)){m.addTypeMaskInfo(a4,a3[a4])}}if(aK.is(a2,"function")){a2()}};a0.webServiceRequest({url:"modeler/ppr/getTypesAttributesMaskInfo",method:"POST",data:aK.Json.encode([aZ]),onComplete:a1,onFailure:aY,onTimeout:aY})},attachFile:function au(aY,aZ,a0){if(aL.isStandAlone()){aK.merge(a0,{url:"modeler/ppr/createDocuments",method:"POST",data:aY});aL.webServiceRequest(a0)}else{aL.setForceDBMode(true);if(aK.is(aY.id)){E.addFileToDocument(aY,a0)}else{aY.type=aK.is(aL._documentConfig.documentType,"string")?aL._documentConfig.documentType:"Document";E.createDocument(aY,a0)}}},modifyFile:function t(aY,aZ,a0){if(aL.isStandAlone()){aK.merge(a0,{url:"modeler/ppr/modifyFile",method:"POST",data:aY});aL.webServiceRequest(a0)}else{aL.setForceDBMode(true);E.modifyDocument(aY,a0)}},downloadFiles:function aO(aZ,aY,a0){if(aL.isStandAlone()){aK.merge(a0,{url:"modeler/ppr/fetchDocuments",method:"POST",data:aZ});aL.webServiceRequest(a0)}else{E.downloadDocument(aZ,aY,false,a0)}},removeFile:function T(aZ,aY,a0){if(aL.isStandAlone()){aK.merge(a0,{url:"modeler/ppr/deleteFile",method:"POST",data:{docId:aZ,fileID:aY}});aL.webServiceRequest(a0)}else{aL.setForceDBMode(true);E.deleteFile(aZ,aY,a0)}},downloadDocuments:function h(aZ,aY){if(aL.isStandAlone()){aK.merge(aY,{url:"modeler/ppr/fetchDocuments",method:"POST",data:aZ});aL.webServiceRequest(aY)}else{E.downloadDocuments(aZ,aY)}},deleteDocument:function aW(aY,aZ){if(aL.isStandAlone()){aK.merge(aZ,{url:"modeler/ppr/deleteDocuments",method:"DELETE",data:aY});aL.webServiceRequest(aZ)}else{aL.setForceDBMode(true);E.deleteDocument(aY,aZ)}},populateDocumentPolicies:function aR(){var aY=this;aL.webServiceRequest({url:"modeler/pprirpc/document/policyNames",method:"GET",data:null,onComplete:function(aZ){if(aK.is(aZ)){k.DocPolicyNames=aZ}},onFailure:function(aZ){aY._logger.warn("!!! WS call 'modeler/pprirpc/document/policyNames' in ModelUtils.populateDocumentPolicies() failed");aY._logger.log(aZ)},onTimeout:function(aZ){aY._logger.warn("!!! WS call 'modeler/pprirpc/document/policyNames' in ModelUtils.populateDocumentPolicies() timed out");aY._logger.log(aZ)}})},getXmlFromCache:function V(aY){var aZ;if(aK.is(aY)){aZ=aK.clone(this.xmlCache[aY])}else{this._logger.log("xmlKey is not available")}return aZ}});return aL});define("DS/DELWebMfgAssetsDefModelServices/ExternalEventsUtils",["UWA/Core","UWA/Class","DS/Core/Events","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/ModelUtils"],function(k,d,i,n,h,f){var j=d.singleton({name:"ExternalEventsUtils",_logger:null,_acceptedLinkTypes:["DELLmiTimeConstraintCnx","ProcessImplementLinkOcc","ProductImplementLinkOcc","DELAsmProcessCanUseCnx"],init:function o(p){p=p||{};this._parent(p);this._logger=h.getLogger(j);this._widgetTrigram=f.getWidgetTrigram()},_processConnectionData:function e(q){var r,p;p=k.is(q.attributesValue)?q.attributesValue:q;if(j._acceptedLinkTypes.indexOf(p.PID.split("|")[0])!==-1||j._acceptedLinkTypes.indexOf(p.type)!==-1){if(!k.is(p.type)&&k.is(p["from.PID"])){r={type:p.PID.split("|")[0],pid:p.PID,from:q["from.PID"],to:q["to.PID"]}}else{if(k.is(q["from.attributesValue"])){r={type:p.type,pid:p.PID,from:q["from.attributesValue"].PID,to:q["to.attributesValue"].PID}}else{r={type:p.type,pid:p.PID,from:p.from,to:p.to}}}}return r},_processInstanceData:function g(q){var p;q=k.is(q.attributesValue)?q.attributesValue:q;if(k.is(q.isInstanceOf)){p={pid:q.PID,parentRef:q.isAggregatedBy,childRef:q.isInstanceOf,};if(k.is(q.oldParentPID)){p.previousParentRef=q.oldParentPID}}return p},emitCreateConnectionEvent:function c(q){var r,p={data:[],widgetID:widget.id};if(k.is(q,"object")){q=[q]}q.forEach(function(s){r=j._processConnectionData(s);if(k.is(r)){p.data.push(r)}});if(p.data.length>0){n.publish("DS."+j._widgetTrigram+".Object.CreateConnection",p);j._logger.log("DS."+this._widgetTrigram+".Object.CreateConnection event broadcast: Succeeded");j._logger.log(p)}else{j._logger.log("DS."+this._widgetTrigram+".Object.CreateConnection event broadcast: Failed");j._logger.log(q)}},emitDeleteConnectionEvent:function b(q){var r,p={data:[],widgetID:widget.id};r=j._processConnectionData(q);if(k.is(r)){p.data.push(r)}if(p.data.length>0){n.publish("DS."+j._widgetTrigram+".Object.DeleteConnection",p);j._logger.log("DS."+this._widgetTrigram+".Object.DeletionConnection event broadcast: Succeeded");j._logger.log(p)}else{j._logger.log("DS."+this._widgetTrigram+".Object.DeletionConnection event broadcast: Failed");j._logger.log(q)}},emitCreateInstanceEvent:function l(p){var q,r={data:[],widgetID:widget.id};if(k.is(p,"object")){p=[p]}p.forEach(function(s){q=j._processInstanceData(s);if(k.is(q)){r.data.push(q)}});if(r.data.length>0){n.publish("DS."+j._widgetTrigram+".Object.CreateInstance",r);j._logger.log("DS."+this._widgetTrigram+".Object.CreateInstance event broadcast: Succeeded");j._logger.log(r)}else{j._logger.log("DS."+this._widgetTrigram+".Object.CreateInstance event broadcast: Failed");j._logger.log(p)}},emitDeleteInstanceEvent:function a(p){var q,r={data:[],widgetID:widget.id};q=j._processInstanceData(p);if(k.is(q)){r.data.push(q)}if(r.data.length>0){n.publish("DS."+j._widgetTrigram+".Object.DeleteInstance",r);j._logger.log("DS."+this._widgetTrigram+".Object.DeleteInstance event broadcast: Succeeded");j._logger.log(r)}else{j._logger.log("DS."+this._widgetTrigram+".Object.DeleteInstance event broadcast: Failed");j._logger.log(p)}},emitUpdateEvolutionEffectivityEvent:function m(q){var p=Object.keys(q.relids)[0],s=k.merge(q.relids[p],{objectPID:p}),r={data:[s],widgetID:widget.id};n.publish("DS."+j._widgetTrigram+".Object.UpdateEvolutionEffectivity",r);j._logger.log("DS."+this._widgetTrigram+".Object.UpdateEvolutionEffectivity event broadcast: Succeeded");j._logger.log(r)}});return j});define("DS/DELWebMfgAssetsDefModelServices/CollectionUtils",["UWA/Core","UWA/Class","UWA/Class/Promise","UWA/Date","DS/Core/Events","DS/Logger/Logger","DS/PlatformAPI/PlatformAPI","DS/DELWebMfgAssetsDefModelServices/DocumentUtility","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/ModelPreferences","DS/DELWebMfgAssetsDefModelServices/RelObjAttributesUtils","DS/DELWebMfgAssetsDefModelServices/ExternalEventsUtils","DS/DELWebMfgAssetsDefReferenceModel/ReferenceCollection","DS/DELWebMfgAssetsDefInstanceModel/InstanceCollection","DS/DELWebMfgAssetsDefConnectionModel/ConnectionCollection","DS/DELWebMfgAssetsDefReferenceModel/ReferenceModel","DS/DELWebMfgAssetsDefInstanceModel/InstanceModel","DS/DELWebMfgAssetsDefDocumentModel/DocumentModelCollection","DS/DELWebMfgAssetsDefDocumentModel/DocumentModelUtility","DS/DELWebMfgAssetsDefDocConnectionModel/DocumentConnectionCollection","DS/DELWebMfgAssetsDefCustomModel/CustomCollection","DS/DELWebMfgAssetsDefCustomConnectionModel/CustomConnectionCollection"],function(aO,aQ,aW,aa,aY,I,G,N,aP,g,aL,Y,aG,aE,aF,aR,V,A,ae,ax,av,aK){var ag=aQ.singleton({name:"CollectionUtils",_logger:null,VIEWS:{AUXILIARY:"AUXILIARY",ROUTINGS:"ROUTINGS",GENERIC:"GENERIC"},init:function ao(a0){a0=a0||{};if(aO.is(I)){this._logger=I.getLogger(ag)}this._parent(a0);this._init(a0);if(aO.is(a0.VIEWS)){this.VIEWS=a0.VIEWS}},reload:function aI(a0){if(aO.is(this.references)){delete this.references}if(aO.is(this.instances)){delete this.instances}if(aO.is(this.connections)){delete this.connections}if(aO.is(this.customObjs)){delete this.customObjs}if(aO.is(this.customConnections)){delete this.customConnections}this._init(a0)},_init:function aA(a1){var a0=this;this.references=new aG();this.instances=new aE();this.connections=new aF();this.documents=new A();this.documentsConnection=new ax();this.customObjs=new av();this.customConnections=new aK();this.instances.addEvent("onAdd",function(a2){if(aO.is(a2)){a0.getConnectionsByModel(null,a2,null,false)}});this.instances.referenceCollection=this.references;this.connections.referenceCollection=this.references;this.connections.instanceCollection=this.instances;if(aO.is(a1)){if(aO.is(a1.standAloneModelUtils)){a1.standAloneModelUtils.collectionsInit.call(this,aP)}if(aO.is(a1)){if(aO.is(a1.useER,"boolean")){this.useERObjects(a1.useER)}}}},getCollections:function(){return{referenceCollection:this.references,instanceCollection:this.instances,connectionCollection:this.connections}},getInstanceFromCollection:function t(a0){return this.instances.get(a0)},getInstanceIDsGivenItsTitle:function az(a1){return this.instances.where({PLM_ExternalID:a1}).map(function a0(a2){return a2.id})},getReferenceIDGivenItsTitle:function aq(a1){var a2=this.references.where({V_Name:a1}).map(function a0(a3){return a3.id});return aO.is(a2[0])?a2[0]:null},getInstancesOfReference:function aT(a0){return this.instances.where({isInstanceOf:a0})},getInstancesFromCollection:function O(a0){return this.instances.where({isAggregatedBy:a0})},getReferenceFromInstancePID:function ak(a1){var a2=null,a3=ag.getInstanceFromCollection(a1),a0;if(aO.is(a3)){a0=a3.get("isInstanceOf");if(aO.is(a0,"string")&&(a0.length>0)){a2=ag.references.get(a0)}}return a2},getReferenceFromCollection:function aC(a0){var a1,a2=aO.is(a0,"array")?a0:(aO.is(a0,"string")?[a0]:null);if(aO.is(a2)){a1=[];a2.forEach(function a3(a4){a1.push(ag.references.get(a4))});if(aO.is(a0,"string")){a1=a1[0]}}else{ag._logger.warn("CollectionUtils.getReferenceFromCollection bad input value.")}return a1},getConnectionFromCollection:function v(a0){return ag.connections.get(a0)},getImplementLinks:function c(a0){var a1=[];if(aO.is(a0,"string")&&(a0.length>0)){a1=ag.connections.where({from:a0,type:"ProductImplementLinkOcc"})}return a1},getScopeLinks:function T(a1){var a0=[];if(aO.is(a1,"string")&&(a1.length>0)){a0=ag.connections.where({from:a1,type:"ProductImplementLink"})}return a0},getTargetedByScopeLinks:function z(a1){var a0=[];if(ag.isValidPID(a1)){a0=ag.connections.where({to:a1,type:"ProductImplementLink"})}return a0},getClosestScope:function P(a1,be,ba,a2){var bd=null,a6=function a6(bg){var bf=null,bh;if(ag.isValidPID(bg)){bh=ag.getReferenceFromInstancePID(bg);if(aO.is(bh)){bf=bh.id}}return bf},a9,a4,a8,a7=[],bb,a3,bc;if(aO.is(be,"array")&&aO.is(a2,"array")){a9=be.map(a6);a9.unshift(a1);a4=a2.map(a6);a4.unshift(ba);if(a2.length>0){a4.pop()}ag.connections.forEach(function a0(bf){var bg=bf.get("type"),bi=bf.get("from"),bh=bf.get("to");if("ProductImplementLink"===bg){a8=a9.indexOf(bi);if(-1!==a8){bc=a4.indexOf(bh);if(-1!==bc){a7.push({from:a8,to:bc,connection:bf})}}}});bb=a7.slice().sort(function a5(bg,bf){return(bf.from-bg.from)});a3=a7.slice().sort(function a5(bg,bf){return(bf.to-bg.to)});if(a7.length>0){if((bb[0].from===a3[0].from)&&(bb[0].to===a3[0].to)){bd={};bd.connection=bb[0].connection;bd.firstSubPath=be.slice();bd.firstSubPath.unshift(null);bd.firstSubPath.splice(0,bb[0].from+1);bd.secondSubPath=a2.slice();bd.secondSubPath.unshift(null);bd.secondSubPath.splice(0,bb[0].to+1)}}}return bd},getAuthorizedRelationList:function q(a2){var a1=null,a0;if(aO.is(g)&&aO.is(g.RelationsList)&&aO.is(a2)){a0=g.RelationsList[a2];if(aO.is(a0)){a1=ag.getRelationTypes(a0.PRODUCT,"read");a1=a1.concat(ag.getRelationTypes(a0.PART,"read"));a1=a1.concat(ag.getRelationTypes(a0.PROCESS,"read"));a1=a1.concat(ag.getRelationTypes(a0.SYSTEM,"read"));a1=a1.concat(ag.getRelationTypes(a0.OPERATION,"read"));a1=a1.concat(ag.getRelationTypes(a0.RESOURCE,"read"))}}return a1},addToCollections:function e(a5){var a3=a5||{},a8=a3.stackedReferences?a3.stackedReferences:[],bh=a3.stackedInstances?a3.stackedInstances:[],bp=a3.stackedConnections?a3.stackedConnections:[],a4=a3.deletedObjects?a3.deletedObjects:[],bq=a3.references?a3.references:ag.references,bk=a3.instances?a3.instances:ag.instances,bc=a3.connections?a3.connections:ag.connections,a1=aO.is(a3.silent,"boolean")?a3.silent:true,bl=aO.is(a3.onComplete,"function")?a3.onComplete:null,bn=aO.is(a3.onFailure,"function")?a3.onFailure:null,bg=aO.is(a3.onTimeout,"function")?a3.onTimeout:null,a2=aO.is(a3.context)?a3.context:this,ba=aO.is(a3.documentIdMap)?a3.documentIdMap:[],a0=aO.is(a3.cvquery3d)?a3.cvquery3d:null,bb=ag._onDocumentComplete(ba),a6=function a6(br,bt){br.forEach(function bs(bu){bc.add(bu,{silent:a1})});bt()},bf=function bf(bs,bv){var bt={},bu=bq.add(bs,{silent:a1,merge:true,parse:true,sort:false});bu.forEach(function br(bw){var bx;if(aO.is(bw)&&aO.is(bw.id)){bx=ba[bw.id];aL.buildConnectionModelInfo(bw,{silent:a1});bt[bw.id]=true;if(aO.is(bx)){ag._addDocuments(bx,bw,bb)}}});bq.sort();ag.checkForBadge(bt,a0);bv()},bo=function bo(bs,bt){bs.forEach(function br(bv){var bw,bu;if(aO.is(bv.cvquery)){bu=bv.cvquery;delete bv.cvquery}bw=bk.add(bv,{silent:a1,merge:true,parse:true});if(aO.is(bu)){bw.setDisplayModel({cvquery:bu},{silent:a1})}aL.buildConnectionModelInfo(bw,{silent:a1})});bt()},be=function be(br,bt){br.forEach(function bs(bv){var bu=bk.get(bv);if(aO.is(bu)){bk.remove(bv)}});bt()},a9=function a9(){if(aO.is(bl,"function")){bl.call(a2,a8)}else{if(aO.is(bn,"function")){bn.call(a2)}else{if(aO.is(bg,"function")){bg.call(a2)}}}},bi=function bi(){var br={callback:a6,globalArray:bp,context:bc};return aP.getExecuteByBlockPromise(br)},bm=function bm(){var br={callback:bf,globalArray:a8,context:bq};return aP.getExecuteByBlockPromise(br)},bj=function bj(){var br={callback:bo,globalArray:bh,context:bk};return aP.getExecuteByBlockPromise(br)},bd=function bd(){var br={callback:be,globalArray:a4,context:bk};return aP.getExecuteByBlockPromise(br)};bi().then(function a7(){bm().then(function br(){bj().then(function bs(){bd().then(a9)})})})},isRoot:function aB(a0){var a2=false,a4=["asRootInTableView","asRootInAuxiliaryView","asRootInBodyView"],a3,a1;if(aO.is(a0)){if(aO.is(a0.getDisplayModelAttr,"function")){a3=a0.getDisplayModelAttr(a4);if(aO.is(a3)){for(a1 in a3){if(a3.hasOwnProperty(a1)){a2=a2||a3[a1]}}}}}return a2},emptyCollectionsIfNoRoots:function k(bb){var a1=bb||{},a6=null,ba=true,a5=null,a4=null,bd=aO.is(a1.silent,"boolean")?a1.silent:ba,be=aO.is(a1.onComplete,"function")?a1.onComplete:a5,a3=aO.is(a1.onFailure,"function")?a1.onFailure:a4,a2=aO.is(a1.context)?a1.context:a6,a9=ag.references.some(ag.isRoot,ag),bc,a7,bf,a0,a8;if(!a9){bc=ag.references.reset({},{silent:bd});if(aO.is(bc)){ag.references.remove(bc,{silent:bd})}a7=ag.instances.reset({},{silent:bd});if(aO.is(a7)){ag.instances.remove(a7,{silent:bd})}bf=ag.connections.reset({},{silent:bd});if(aO.is(bf)){ag.connections.remove(bf,{silent:bd})}a0=ag.customObjs.reset({},{silent:bd});if(aO.is(a0)){ag.customObjs.remove(a0,{silent:bd})}a8=ag.customConnections.reset({},{silent:bd});if(aO.is(a8)){ag.customConnections.remove(a8,{silent:bd})}if(aO.is(be)){be.call(a2)}}else{if(aO.is(a3)){a3.call(a2)}}},_getDescendantsFromIndex:function f(a6,bb,bc){var a4=[],a5=[],a9=[],a7={},a8={},a2={},a3=function a3(){if(bc.onFailure instanceof Function){bc.onFailure()}aY.publish({event:"DELMGAMFN/webService/End"})},ba=function ba(){if(bc.onTimeout instanceof Function){bc.onTimeout()}aY.publish({event:"DELMGAMFN/webService/End"})},a0=function a0(){var bd={referenceCollection:aO.is(a2.references)?a2.references:ag.references,instanceCollection:aO.is(a2.instances)?a2.instances:ag.instances,connectionCollection:aO.is(a2.connections)?a2.connections:ag.connections,stackedReferences:a4,stackedInstances:a5,stackedConnections:a9,documentIdMap:a7,cvquery3d:aO.is(bc.cvquery3d)?bc.cvquery3d:null,onComplete:function be(){if(aO.is(bb,"function")){a8.results=a4;if(aO.is(bc.cvquery)){a8.cvquery=bc.cvquery}if(aO.is(bc.cvquery3d)){a8.cvquery3d=bc.cvquery3d}bb(a8)}aY.publish({event:"DELMGAMFN/webService/End"})}};ag.addToCollections(bd)};aY.publish({event:"DELMGAMFN/webService/Start"});a2={onFailure:a3,onTimeout:ba};a2=aO.merge(a2,bc);if(!(a6 instanceof Array)){a6=[a6]}ag.expandNodes(a6,a4,a5,function a1(bd){ag.navigateNodes(bd.expandedIds,a4,a5,a9,function be(bf){ag.expandNodes(bf,a4,a5,a0,a2)},{documentIdMap:a7,onFailure:a3,onTimeout:ba,timeOutExtensionPromise:a2.timeOutExtensionPromise})},a2)},_getDescendantsFromIndexOnDemand:function R(a6,bb,bc){var a4=[],a5=[],a9=[],a7={},a8={},a2={},a3=function a3(){if(bc.onFailure instanceof Function){bc.onFailure()}aY.publish({event:"DELMGAMFN/webService/End"})},ba=function ba(){if(bc.onTimeout instanceof Function){bc.onTimeout()}aY.publish({event:"DELMGAMFN/webService/End"})},a0=function a0(){var bd={referenceCollection:aO.is(a2.references)?a2.references:ag.references,instanceCollection:aO.is(a2.instances)?a2.instances:ag.instances,connectionCollection:aO.is(a2.connections)?a2.connections:ag.connections,stackedReferences:a4,stackedInstances:a5,stackedConnections:a9,documentIdMap:a7,cvquery3d:aO.is(bc.cvquery3d)?bc.cvquery3d:null,onComplete:function be(){if(aO.is(bb,"function")){a8.results=a4;if(aO.is(bc.cvquery)){a8.cvquery=bc.cvquery}if(aO.is(bc.cvquery3d)){a8.cvquery3d=bc.cvquery3d}bb(a8)}aY.publish({event:"DELMGAMFN/webService/End"})}};ag.addToCollections(bd)};aY.publish({event:"DELMGAMFN/webService/Start"});a2={onFailure:a3,onTimeout:ba};a2=aO.merge(a2,bc);if(!(a6 instanceof Array)){a6=[a6]}ag.expandNodes(a6,a4,a5,function a1(){ag.navigateNodes(a6,a4,a5,a9,function bd(be){ag.expandNodes(be,a4,a5,a0,a2)},{documentIdMap:a7,onFailure:a3,onTimeout:ba,timeOutExtensionPromise:a2.timeOutExtensionPromise})},a2)},getConnectionsFromIndex:function C(a4,a0,a6,a2){var a8=[],a5={},a1=function a1(){aY.publish({event:"DELMGAMFN/webService/End"})},a7=function a7(){aY.publish({event:"DELMGAMFN/webService/End"})},a9=this,ba={documentIdMap:a5,onFailure:a1,onTimeout:a7},a3=function a3(){var bb={referenceCollection:ag.references,instanceCollection:ag.instances,connectionCollection:ag.connections,stackedConnections:a8,documentIdMap:a5,stackedReferences:a0,stackedInstances:a6,onComplete:function bc(){if(aO.is(a2,"function")){a2.call(null)}aY.publish({event:"updateViews",data:a4});aY.publish({event:"DELMGAMFN/webService/End"})}};a9.addToCollections(bb)};aY.publish({event:"DELMGAMFN/webService/Start"});if(!(a4 instanceof Array)){a4=[a4]}a9.navigateNodes(a4,a0,a6,a8,a3,ba)},navigateNodes:function ab(a0,a7,a2,a3,a6,a1){var a5=[],a4=function a4(a8){var a9,ba;if(!a8||!(a8.result instanceof Array)){ag._logger.warn("ERROR in navigate result");return}a9=a8.result;ba=function(bj,bc,bb,bd,bi){var bg=bb.physicalid,bf,bl,bh,bk,be;bi=bi||{};if(aP.isEntityConnection(bc.type)&&(aP.isEntityReference(bb.type)||aP.isEntityInstance(bb.type))){if(aP.isReferenceDocument(bb.type)&&a1.documentIdMap){if(!(a1.documentIdMap[bj] instanceof Array)){a1.documentIdMap[bj]=[]}a1.documentIdMap[bj].push(bg)}else{bc=aO.merge(aP.translatePredicateToAttribute(bc,{type:"entity"}),aP.translatePredicateToAttribute(bc,{type:"relation"}));if(bd){bc.from=bj;bc.to=bg}else{bc.from=bg;bc.to=bj}if("ProductImplementLinkOcc"===bc.type){if(bi.occurencePath){if(bd){bc.to=bi.occurencePath}else{bc.from=bi.occurencePath}bc.PID="ProductImplementLinkOcc|"+bj+"|"+aO.Json.encode(bi.occurencePath)}}else{if("ProcessImplementLinkOcc"===bc.type){if(aO.is(bi.owner)&&aO.is(bi.owner.pathsr)){bh=ag._getPathsFromSR(bi.owner.pathsr);if(aO.is(bh)&&aO.is(bh.from)){bl=bh.from;bj=bl.toString()}if(aO.is(bh)&&aO.is(bh.to)){bk=bh.to;bf=bk.toString()}}if(bi.occurencePath){if(bd){bc.to=bi.occurencePath;bf=bi.occurencePath.toString();if(aO.is(bl)){bc.from=bl}}else{bc.from=bi.occurencePath;if(aO.is(bk)){bc.to=bk}}bc.PID="ProcessImplementLinkOcc|"+bj+"|"+bf}}else{if("DELLmiTimeConstraintCnx"===bc.type){if(aO.is(bi.owner)&&aO.is(bi.owner.pathsr)){bh=ag._getPathsFromSR(bi.owner.pathsr);if(aO.is(bh)&&aO.is(bh.from)){bl=bh.from}if(aO.is(bh)&&aO.is(bh.to)){bk=bh.to}if(bd){bc.from=bl;bc.to=bk}else{bc.to=bl;bc.from=bk}}}else{if("SystemImplementLink"===bc.type||"ProcessImplementLink"===bc.type||"ProductImplementLink"===bc.type||"DELLmiMaterialPathCnxCust"===bc.type){bc.PID=bc.type+"|"+bc.from+"|"+bc.to}}}}a3.push(bc);if(aP.isEntityReference(bb.type)&&a5.indexOf(bg)===-1){a5.push(bg)}else{if(aP.isEntityInstance(bb.type)){if(!aO.is(ag.instances.get(bg))&&bb.hasOwnProperty("from.physicalid")){be=bb["from.physicalid"];if(aO.is(be)){if(a5.indexOf(be)===-1){a5.push(be)}}}}}if(a1.addToCollection&&"Document"!==bb.type){a7.push(bb)}}}};a9.forEach(function(bb){var bi=bb.outputs,bg,be,bd=bb.input_object.physicalid,bf,bc,bh;a7.some(function(bj){if(bj.PID===bd){bj.queriedForConnections=true;bj.queriedForDocuments=true;return true}return false});a2.some(function(bj){if(bj.PID===bd){bj.queriedForConnections=true;return true}return false});for(bg in bi){if(bi.hasOwnProperty(bg)){be=bi[bg];bh=bg.indexOf("Inverse")===-1;if(bg.indexOf("_pathSR")!==-1){be.forEach(function(bj){var bk,bl;if(bj&&bj.elements){if(bg.indexOf("productMbomImplement")!==-1){bk=bj.elements.map(function(bm){return bm.physicalid});bl=bj.elements[bj.elements.length-1];bc={type:"ProductImplementLinkOcc"};ba(bd,bc,bl,bh,{occurencePath:bk})}else{if(bg.indexOf("operationProcessImplement")!==-1){bk=bj.elements.map(function(bm){return bm.physicalid});bl=bj.elements[bj.elements.length-1];bc={type:"ProcessImplementLinkOcc"};ba(bd,bc,bl,bh,{occurencePath:bk,owner:bj.owner})}else{if(bg.indexOf("productFlow")!==-1){bk=bj.elements.map(function(bm){return bm.physicalid});bl=bj.elements[bj.elements.length-1];bc=bj.owner;ba(bd,bc,bl,bh,{occurencePath:bk,owner:bj.owner})}else{if(bg.indexOf("Material")!==-1){bf=null;bj.elements.reverse().some(function(bn){var bm=false;if(aP.isEntityInstance(bn.type)){bf=bn;bm=true}return bm});if(aO.is(bf)){bc=bj.owner;ba(bd,bc,bf,bh)}}else{bf=bj.elements[bj.elements.length-1];bc=bj.owner;ba(bd,bc,bf,bh)}}}}}})}else{if(bg.indexOf("_relation")!==-1){be.forEach(function(bl){var bj,bk;if(bg.indexOf("alternate")!==-1){bc=bl;bf=bh?bl.to:bl.from;delete bl["from.physicalid"];delete bl["to.physicalid"];ba(bd,bc,bf,bh)}else{if(bg.indexOf("mbomSystemOutput")!==-1){bj=bg.split("_relation")[0];bk=bi[bj+"_pathSR"];bf=bl.from;if(bk){bk.forEach(function(bm){if(bm&&bm.elements){if(bm.elements[0].physicalid===bl.to.physicalid){bc=bm.owner}}});if(bc){ba(bd,bc,bf,bh)}}}}})}}}}});a6(a5)};a1=a1||{};if(a0.length>0){aP.navigateOnIndex(a0,a4,aO.extend(a1,{context:this}))}else{a6(a5)}},_getCustomDescendantsFromIndex:function i(a4,a2,a3,a7,a9){var a8=this,a5=[],a1=[],a6;a9=a9||{};if(!(a4 instanceof Array)){a4=[a4]}a6=function a6(){var bc=a9.customConnections?a9.customConnections:a8.customConnections,ba=a9.customObjs?a9.customObjs:a8.customObjs;a5.forEach(function bd(be){bc.add(be,{silent:true})});a1.forEach(function bb(be){ba.add(be,{silent:true})});if(a7 instanceof Function){a7()}};a8.navigateNodesForRequirements(a4,a5,a1,a2,a3,function a0(){a6()})},navigateNodesForRequirements:function ap(a7,a8,a2,a4,a5,bc,bd){var a6,bb,a1,a3,a9,ba,a0=function(be){if(aO.is(be)){a6=be.result;bb=function(bg,bf,bh,bi){var bj=bh.physicalid;if(aO.is(bf.isCustomConnection)&&bf.isCustomConnection){if(bi){bf.from=bg;bf.to=bj}else{bf.from=bj;bf.to=bg}if(aO.is(a8)){a8.push(bf);a9=aO.is(a5[bf.type+"from"])?"from":(aO.is(a5[bf.type+"to"])?"to":null);if(a9!==null){ba=bf.type+a9;a3=a5[ba].split(",")}else{a3=["name"]}a1={PID:bh.physicalid,type:bh.type};a3.forEach(function(bk){a1[bk]=bh["ds6w:label"]});a2.push(a1)}}};a6.forEach(function(bf){var bm=bf.outputs,bk,bi,bh=bf.input_object.physicalid,bj,bg,bl;for(bk in bm){if(bm.hasOwnProperty(bk)){bi=bm[bk];if(bk.indexOf("_relation")!==-1){bi.forEach(function(bn){if(bk.indexOf("customPath_relation")!==-1){bg={PID:bn.physicalid,type:bn.type,isCustomConnection:true};bj=bn.from;bl=false;bb(bh,bg,bj,bl)}})}}}})}bc()};bd=bd||{};if(a7.length>0){aP.navigateOnIndexRequirements(a7,a0,a4,aO.extend(bd,{context:this}))}else{bc()}},expandNodes:function s(a7,a3,a5,a8,ba){var a2,a0,a6,a4=[],a9,a1=g.getPrefExpandLevel()||-1;ba=ba||{};a2=aO.is(ba.context)?ba.context:this;a0=isNaN(ba.expandLevel)?a1:ba.expandLevel;a6=aO.is(ba.cvquery)?ba.cvquery:null;a9=function a9(bd){var bb=aO.is(bd.roots)?bd.roots:[],bc={};if(!(bb instanceof Array)){ag._logger.warn("ERROR in expand result");return}ag._expandNodes(bb,a4,a3,a5,a0,a6);bc={expandedIds:a4};a8.call(a2,bc)};if(a7.length>0){aP.expandOnIndex(a7,a9,aO.extend(ba,{context:this,expandIter:a0.toString()}))}else{a8.call(a2,a4)}},_expandNodes:function aN(a3,a0,a7,a5,a6,a2,a1){var a4;if(isNaN(a1)){a1=0}if((a6===-1||a1<=a6)&&aO.is(a3,"array")){a3.forEach(function(ba){var a9=aP.translatePredicateToAttribute(ba,{type:"entity",fromExpandService:true}),a8;if(a6===-1||a1<a6){if(!aO.is(a2)){a9.queriedForChildren=true}}a0.push(a9.PID);a7.push(a9);ba.getChildren().forEach(function(bb){a4=bb.getChildren().filter(function(bc){return aP.isEntityReference(bc.type.value)&&bb.type.value!=="MfgProcessAlternate"});if(a4.length>0){a8=aP.translatePredicateToAttribute(bb,{type:"relation",fromExpandService:true});if(aO.is(a2)){a8.cvquery=a2}a0.push(a8.PID);a5.push(a8);ag._expandNodes(a4,a0,a7,a5,a6,a2,a1+1)}})})}},removeDuplicate:function ay(a0){var a1=function a1(a3,a4,a2){return !a4||a3!==a2[a4-1]};if(aO.is(a0,"array")){a0.sort();a0=a0.filter(a1)}return a0},expandOnBackbone:function M(a3,a5){var a1=ag.getInstancesFromCollection(a3),a4=[];if(aO.is(a1,"array")&&aO.is(a5)){a1.forEach(function a0(a7){var a6=a7.get("isInstanceOf");if(aO.is(a5.referencesPID,"array")){a5.referencesPID.push(a6)}if(aO.is(a5.instancesPID,"array")){a5.instancesPID.push(a7.id)}a4.push(a6)})}a4=ag.removeDuplicate(a4);a4.forEach(function a2(a6){M(a6,a5)})},findMissingLinkedObjects:function L(a3,a4){var a5={referencesPID:[a3.id],instancesPID:[]},a8={inputPIDs:[],context:ag,stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:[],onComplete:function a1(){if(aO.is(a4,"function")){a4.call()}}},a0=function a0(){ag.addToCollections(a8)},a2=function a2(a9){ag.expandNodes(a9,a8.stackedReferences,a8.stackedInstances,a0)};ag.expandOnBackbone(a3.id,a5);a5.referencesPID.forEach(function a7(a9){var bb=ag.getReferenceFromCollection(a9),ba;if(aO.is(bb)){ba=bb.pick("PID");a8.stackedReferences.push(ba)}});a5.instancesPID.forEach(function a6(a9){var bb=ag.getInstanceFromCollection(a9),ba;if(aO.is(bb)){ba=bb.pick("PID");a8.stackedInstances.push(ba)}});a8.inputPIDs=ag.removeDuplicate(a5.referencesPID.slice().concat(a5.instancesPID.slice()));ag.navigateNodes(a8.inputPIDs,a8.stackedReferences,a8.stackedInstances,a8.stackedConnections,a2,a8)},parseCustomConnection:function aw(a1){var a0;if(aO.is(a1.attributesValue)){a0=a1.attributesValue}return a0},parseConnection:function aV(a5,a2,a0){var bg={},bd={},a6={},bj=null,bh,be,bf,bc,bi,a4,ba,bb,a8,a3,a7,a1,a9=aO.is(a0);a2=a2||{};a1=(aO.is(a2.silentMode))?{silent:a2.silentMode}:{};if(aO.is(a5.attributesValue)){a6=a5.attributesValue}for(bj in a5){if(a5.hasOwnProperty(bj)){if(bj.contains("from.")){bf=bj.substring(bj.indexOf("from.")+5);bg[bf]=a5[bj]}else{if(bj.contains("to.")){bf=bj.substring(bj.indexOf("to.")+3);bd[bf]=a5[bj]}else{if(!bj.contains("attributesValue")){a6[bj]=a5[bj]}}}}}be=aO.is(bg.attributesValue)?bg.attributesValue:null;bh=aO.is(bd.attributesValue)?bd.attributesValue:null;a6.from=aO.is(be)?(aO.is(be.PID)?be.PID:null):(aO.is(bg.PID)?bg.PID:null);a6.to=aO.is(bh)?(aO.is(bh.PID)?bh.PID:null):(aO.is(bd.PID)?bd.PID:null);a7=(bh&&bh.PID)?bh.PID instanceof Array:false;if(aO.is(bd.PID,"array")){a6.to=bd.PID}if(aO.is(bg.PID,"array")){a6.from=bg.PID}if(aO.is(be)&&aO.is(be.isInstanceOf)){if(!aO.is(this.instances.get(be.PID))){bc=new V(bg);this.instances.add(bc,a1)}}else{if(aO.is(be)&&(!aO.is(this.references.get(be.PID)))){if(a9){a0.push(be.PID);this._logger.log("iOptions: "+a2)}bi=new aR(bg);this.references.add(bi,a1)}}if(aO.is(bh)&&aO.is(bh.isInstanceOf)){if(!aO.is(this.instances.get(bh.PID))){a4=new V(bd);this.instances.add(a4,a1)}}else{if(aO.is(bh)&&(!aO.is(this.references.get(bh.PID)))&&!a7){if(a9){a0.push(bh.PID)}ba=new aR(bd);this.references.add(ba,a1)}}if(!aO.is(a6.type)){bb=a6.PID;if(!aO.is(bb,"string")){this._logger.warn("ERROR: No PID Attribute");return a6}a8=bb.split("|");if(!aO.is(a8,"array")){this._logger.warn("ERROR: Could not split "+bb+" on |");return a6}if(0>=a8.length){this._logger.warn("ERROR: no | to split on in pid "+bb);return a6}a3=a8[0];a6.type=a3}return a6},parseAuthoringConnectionResponse:function a(a2,a4){var a1=this,a3=(aO.is(a4)&&aO.is(a4.data)&&a4.data!=="")?JSON.parse(a4.data):null,a0;a2=a2||{};a2=aO.merge(a2,{instancesAndReferences:[],connections:[]});a2.instancesAndReferences.forEach(function(a7){var a5=a7.attributesValue,a6,a8;if(a5.hasOwnProperty("isInstanceOf")){a6=a1.instances.get(a5.PID);if(!aO.is(a6)){}else{a6.set(a5)}}else{a8=a1.references.get(a5.PID);if(!aO.is(a8)){}else{a8.set(a5)}}});a2.connections.forEach(function(a6){var a5=a1.parseConnection(a6);if(aO.is(a3)&&a3.type.contains(a5.type)){a0=a5}else{a1.connections.add(a5)}});return a0},checkForBadge:function ad(a4,a0){var a3={},a1;ag.connections.forEach(function a2(a5){if("ProductImplementLink"===a5.get("type")){a1=a5.get("to");if(aO.is(a4[a1])){a3[a1]=a5.get("from")}}},ag);aY.publish({event:"DELWebMfgItemDefUI/AddScopeBadge",data:{scopedRefsArray:a3,cvquery3d:a0}})},_getDescendantsFromDB:function l(a7,bc){var ba=this,a4={},bb=aO.is(bc)?(aO.is(bc.context)?bc.context:null):null,a5=function a5(bd,be,bf){ag._logger.warn("Failure in CollectionUtils._getDescendantsFromDB call");if(aO.is(bc.onFailure,"function")){bc.onFailure.call(bb,bd,be,bf)}aY.publish({event:"DELMGAMFN/webService/End"})},a1=function a1(){ag._logger.warn("Timeout in CollectionUtils._getDescendantsFromDB call");if(aO.is(bc.onTimeout,"function")){bc.onTimeout.call(bb)}aY.publish({event:"DELMGAMFN/webService/End"})},a2=function a2(){ag._logger.warn("Cancel in CollectionUtils._getDescendantsFromDB call");if(aO.is(bc.onCancel,"function")){bc.onCancel.call(bb)}aY.publish({event:"DELMGAMFN/webService/End"})},a9=function a9(bd){var bf=[],be={};bd.forEach(function(bi){var bg=bi.attributesValue,bh,bj;if(bg.hasOwnProperty("isInstanceOf")){if(!aO.is(ba.instances.get(bg.PID))){bh=ba.instances.add(bi,a4);bf.push(bh)}}else{bj=ba.references.get(bg.PID);if(!aO.is(bj)){bj=ba.references.add(bi,a4)}bj.set("queriedForChildren",true);bf.push(bj);if(aO.is(bc.fillLinksAndDocuments,"boolean")&&bc.fillLinksAndDocuments){aL.fillConnectionModelInfo(bj,{forceDBMode:true});ae.fetchDocumentUsingModel(bj)}}});ag._logger.log("onGetDescendantsComplete completed");aY.publish({event:"DELMGAMFN/webService/End"});if(aO.is(bc.callback,"function")){be.results=bf;bc.callback(be)}},a3=function a3(bk,bi,bj){var bf={instancesAndReferences:[],connections:[],documents:bk.documents},be,bg=ba._onDocumentComplete(bk.documents);bk.instancesAndReferences.forEach(function(bn){var bl=bn.attributesValue,bm,bo;if(bl.hasOwnProperty("isInstanceOf")){bm=ba.instances.get(bl.PID);if(!aO.is(bm)){bl=aO.extend(bl,{queriedForConnections:true});bm=ba.instances.add(bn,a4)}else{bm.set(bl);bm.set("queriedForConnections",true,a4)}bf.instancesAndReferences.push(bm)}else{bo=ba.references.get(bl.PID);if(!aO.is(bo)){bo=ba.references.add(bn,a4)}if(!(aO.is(bc)&&aO.is(bc.expandLevel)&&bc.expandLevel===0)){bo.set("queriedForChildren",true,a4)}bo.set("queriedForConnections",true,a4);bf.instancesAndReferences.push(bo)}});bk.connections.forEach(function bh(bm){var bn=aO.is(bc.withLinksResolved,"boolean")?(bc.withLinksResolved?bi:null):bi,bl=ba.parseConnection(bm,bc,bn);if(!ba.connections.get(bl.PID)){ba.connections.add(bl)}});bk.instancesAndReferences.forEach(function bd(bn){var bl=bn.attributesValue,bo,bm;if(!bl.hasOwnProperty("isInstanceOf")){bo=ba.references.get(bl.PID);aL.fillConnectionModelInfo(bo,a4,bj);if(!bo.get("queriedForDocuments")){bo.set("queriedForDocuments",true,{silent:true});be=bk.documents[bo.id];ba._addDocuments(be,bo,bg)}}else{bm=ba.instances.get(bl.PID);if(aO.is(bm)){aL.fillConnectionModelInfo(bm,a4)}}});ag._logger.log("onGetDescendantsAndLinksComplete completed")},a6=function a6(bf){var bd=[];if(Array.isArray(bf)){bf.forEach(function be(bg){a3(bg,bd,false)})}else{a3(bf,bd,true)}if(bd.length>0){if(aO.is(bc)&&aO.is(bc.withLinksResolved)){bc.withLinksResolved=false}ba._getDescendantsFromDB(bd,bc)}else{if(aO.is(bc.callback,"function")){bc.callback()}}aY.publish({event:"DELMGAMFN/webService/End"})},a8={pid:Array.isArray(a7)?null:a7,expandLevel:aO.is(bc)&&aO.is(bc.expandLevel)?bc.expandLevel:-1,ordered:aO.is(bc)?(aO.is(bc.ordered,"boolean")?bc.ordered:true):true},a0={url:"modeler/ppr/getDescendants",method:"POST",onComplete:a9,onFailure:a5,onTimeout:a1,onCancel:a2};aY.publish({event:"DELMGAMFN/webService/Start"});bc=bc||{};if(aO.is(bc.silentMode)){a4={silent:true}}aY.publish({event:"DELWebMfgItemDefUI/DisplayLoading"});if(aO.is(bc.withLinks,"boolean")&&bc.withLinks){a0.onComplete=a6;if(Array.isArray(a7)&&(a7.length>1)){a8.pidArray=a7;delete a8.pid;a0.url="modeler/ppr/getMultipleDescendantsAndLinks"}else{a0.url="modeler/ppr/getDescendantsAndLinks";if(Array.isArray(a7)){a8.pid=a7[0]}}}if(aO.is(bc.timeOutExtensionPromise)){a0.timeOutExtensionPromise=bc.timeOutExtensionPromise}a0.data=aO.Json.encode(a8);aP.webServiceRequest(a0)},_onDocumentComplete:function at(a3){var a2=Object.keys(a3),a0=a2.length,a1=0;return function(){a1++;if(a0===0||a0===a1){aY.publish({event:"DELWebMfgAssetsDefUI/DocumentModelReady",data:a2})}}},_addDocuments:function E(a2,a0,a3){var a1=function(a6){var a4=a6.data,a5=[];a4.forEach(function(a7){N.collectionUtils.documents.add(a7,{silent:true});N.collectionUtils.documentsConnection.add({ID:a0.id+"|"+a7.id,irpcID:a0.id,docID:a7.id},{silent:true});a5.push(a7.id)});ae.appendDocIDsToDisplayModel(a0,a5,{silent:true});if(a3 instanceof Function){a3()}};if(aO.is(a2)&&a2.length>0){N.getDocumentInfo(a2,{onComplete:a1})}},getDescendantsFromServer:function aS(a4,a3,a2){var a1=a2||{},a0=aO.is(a1.forceDBMode,"boolean")?a1.forceDBMode:false,a5=function a5(a8){var a6=a1.context||null,a7=Array.isArray(a4)?a4:[a4];aY.publish({event:"updateViews",data:a7});if(aO.is(a3,"function")){a3.call(a6,a8)}};if(aP.isNavigateOn()==="index"&&!a0){ag._getDescendantsFromIndex(a4,a5,a1)}else{if(aP.isNavigateOn()==="indexOndemand"&&!a0){ag._getDescendantsFromIndexOnDemand(a4,a5,a1)}else{ag._getDescendantsFromDB(a4,aO.merge({callback:a5,fillLinksAndDocuments:false,withLinks:!aP.isStandAlone()},a1))}}},getReferenceModelFromInstance:function aH(a2){var a1=a2.get("isInstanceOf");var a0=this.references.get(a1);return a0},getAggregatingReferenceModelFromInstance:function r(a2){var a1=a2.get("isAggregatedBy"),a0=this.references.get(a1);return a0},getCreateScopePromise:function K(a0,a1){var a3=new aW(function a2(a9,a5){var a8={type:"PROCESS_ProductImplementLink",IDFrom:a0,IDTo:a1,},a6={proxy:"passport",wait:true,headers:aP.getHeaders(),data:aO.Json.encode(a8),onComplete:function a7(bd,bf){var ba=ag.getReferenceFromCollection(a0),bb=ag.getReferenceFromCollection(a1),bc=null,be=null;if(aO.is(bf)&&aO.is(bf.connections)&&(bf.connections.length>0)&&aO.is(ba)&&aO.is(bb)){bc=bf.connections[0]["from.attributesValue"];be=bf.connections[0]["to.attributesValue"];if(aO.is(bc)){ba.set(bc)}if(aO.is(be)){bb.set(be)}if(aO.is(ba)){aL.fillConnectionModelInfo(ba)}if(aO.is(bb)){aL.fillConnectionModelInfo(bb)}aP.setForceDBMode(true);a9("AbstractDragAndDropManager.ScopeCreationSuccess")}else{a5("CollectionUtils.ScopeCreationFailed")}},onFailure:function a4(){a5("CollectionUtils.ScopeCreationFailed")}};ag.connections.create(null,a6)});return a3},getCreateILPromise:function W(a2,a1){var a3=new aW(function a0(a9,a5){var a8={type:"PROCESS_ProductImplementLinkOcc",IDFrom:a2,IDTo:aO.Json.encode(a1),},a6={proxy:"passport",wait:true,headers:aP.getHeaders(),data:aO.Json.encode(a8),onComplete:function a7(ba,bb){if(aO.is(bb)&&aO.is(bb.connections)&&(bb.connections.length>0)){aP.setForceDBMode(true);a9("AbstractDragAndDropManager.ImplementLinkCreationSuccess")}else{a5("AbstractDragAndDropManager.ImplementLinkCreationFailure")}},onFailure:function a4(){a5("AbstractDragAndDropManager.ImplementLinkCreationFailure")}};ag.connections.create(null,a6)});return a3},getInstanceCreationPromise:function n(a5,a3){var a4=a3||{},a0=aO.is(a4.referencePID)?a4.referencePID:null,a1=new aW(function a2(ba,a8){var a9={isAggregatedBy:a5,"PLMEntity.V_description":""};if(ag.isValidPID(a0)){a9.isInstanceOf=a0}else{a9["PLMEntity.V_Name"]="Provide";a9.V_Type="DELAsmAssemblyModelDisciplines/Provide";a9.type="Provide"}ag.instances.create(null,{proxy:"passport",wait:true,headers:aP.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),queriedForConnections:true,data:aO.Json.encode(a9),onFailure:function a7(){a8("InsertCmd.CreateInstanceFailure")},onComplete:function a6(bb){ba(bb)}})});return a1},getConsumeEBOMOccurencePromise:function aX(a2,a3,a4,a1){var a5=new aW(function a0(bb,a7){var ba={productID:a3,processID:a2,processInstancePID:a4,productPath:JSON.stringify(a1)},a8={url:"modeler/ppr/createscopeandimplementlink",method:"POST",headers:aP.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),data:aO.Json.encode(ba),onComplete:function a9(be){if(aO.is(be)&&aO.is(be.instancesAndReferences,"array")&&aO.is(be.connections,"array")&&(be.connections.length>0)){be.instancesAndReferences.forEach(function bd(bi){var bf=aO.is(bi.attributesValue)?bi.attributesValue:bi,bg,bh;if(bf.hasOwnProperty("isInstanceOf")){bg=ag.getInstanceFromCollection(bf.PID);if(aO.is(bg)){bg.set(bf)}}else{bh=ag.getReferenceFromCollection(bf.PID);if(aO.is(bh)){bh.set(bf)}}});be.connections.forEach(function bc(bg){var bf=ag.parseConnection(bg);ag.connections.add(bf)});aP.setForceDBMode(true);bb("AbstractDragAndDropManager.ComsumptionSuccess");Y.emitCreateInstanceEvent(be.instancesAndReferences);Y.emitCreateConnectionEvent(be.connections)}else{a7("CollectionUtils.ScopeCreationFailed")}},onFailure:function a6(){a7("CollectionUtils.ScopeCreationFailed")}};aP.webServiceRequest(a8)});return a5},getCopyAttrValuePromise:function x(a5,a2,a7){var a0=a7||{},a6=aO.is(a0.attributeName)?a0.attributeName:"V_Name",a1=ag.getReferenceFromCollection(a5),a3=ag.getReferenceFromCollection(a2),a4=new aW(function a8(be,bb){var a9={},bc={proxy:"passport",headers:aP.getHeaders(),onComplete:function ba(bf){be(bf)},onFailure:function bd(bg,bf){bb(bf)}};if(aO.is(a1)&&aO.is(a3)){a9[a6]=a1.get(a6);bc.data=aO.Json.encode(a9);a3.save(null,bc)}else{bb()}});return a4},getCreateMBOMFromEBOMPromise:function an(a0,a2,a4,a3){var a5=new aW(function a1(bb,a7){var ba={rootProductID:a0,productOccPaths:a2,rootMfgItemID:a4,targetMfgItemID:a3,expandBy:(aP.isNavigateOn()==="index"||aP.isNavigateOn()==="indexOndemand")?"index":"database"},a8={url:"modeler/ppr/MfgItem/CreateMBOMFromEBOM",method:"POST",headers:aP.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),data:aO.Json.encode(ba),onComplete:function a9(bh){var bg={stackedReferences:[],stackedInstances:[],stackedConnections:[],onComplete:function bf(){aP.setForceDBMode(true);bg.stackedInstances.forEach(function bi(bl){var bj=aO.is(bl)?bl.PID:null,bk=ag.getInstanceFromCollection(bj);if(aO.is(bk)){bk.dispatchEvent("onAdd",[bk,ag.instances,{}])}});bb("AbstractDragAndDropManager.ComsumptionSuccess");Y.emitCreateInstanceEvent(bh.instancesAndReferences);Y.emitCreateConnectionEvent(bh.connections)},onFailure:function bc(){a7("CollectionUtils.CreateMBOMFromEBOMFailed")}};if(aO.is(bh)&&aO.is(bh.instancesAndReferences,"array")&&aO.is(bh.connections,"array")){bh.instancesAndReferences.forEach(function be(bj){var bi=aO.is(bj.attributesValue)?bj.attributesValue:bj;if(bi.hasOwnProperty("isInstanceOf")){bi.queriedForConnections=true;bg.stackedInstances.push(bi)}else{bi.queriedForConnections=true;bg.stackedReferences.push(bi)}});bh.connections.forEach(function bd(bj){var bi=ag.parseConnection(bj);bg.stackedConnections.push(bi)});if(bg.stackedInstances.length>0){ag.addToCollections(bg)}else{a7("CollectionUtils.CreateMBOMFromEBOMFailed")}}else{a7("CollectionUtils.CreateMBOMFromEBOMFailed")}},onFailure:function a6(){a7("CollectionUtils.CreateMBOMFromEBOMFailed")}};aP.webServiceRequest(a8)});return a5},fetchRoot:function j(a9,a8){var a0=a8||{},a1=aO.is(a0.context)?a0.context:ag,a5=aO.is(a0.forceDBMode)?a0.forceDBMode:false,a7=function a7(bc){var ba=new aR({PID:a9}),bb=aO.is(bc.context)?bc.context:ag,be=function be(){if(aO.is(bc.onComplete,"function")){bc.onComplete.call(bb,ba,{forceDBMode:a5})}},bd=function bd(bf){if(aO.is(bc.onFailure,"function")){bc.onFailure.call(bb,bf)}};ba.fetch({proxy:"passport",type:"json",headers:aP.getHeaders(),onComplete:be,onFailure:bd})},a4=function a4(){var ba=function ba(bb){if(aO.is(a0.onComplete,"function")){a0.onComplete.call(a1,bb,{forceDBMode:true})}};a7({onComplete:ba,onFailure:a0.onFailure})},a2={context:a1,onComplete:function a6(bb){var ba;if(aO.is(bb)){if(aO.is(bb,"array")&&bb.length===0){a4()}else{if(aO.is(bb.attributes)&&aO.is(bb.attributes.PID)){ba=new aR(bb.attributes);if(aO.is(a0.onComplete,"function")){a0.onComplete.call(a1,ba)}}else{a4()}}}else{a4()}},onFailure:function a3(){a4()}};if((aP.isNavigateOn()==="index"||aP.isNavigateOn()==="indexOndemand")&&!a5){aP.fetchOnIndex(a9,a2)}else{a7(a0)}},getRelationTypes:function Z(a4,a5){var a0=[],a3=[],a2,a1=null;if(aO.is(a4)){if(!aO.is(a4.Relation.length)){a3.push(a4.Relation);a4.Relation=a3}for(a1=0;a1<a4.Relation.length;a1++){a2=a4.Relation[a1];if(aO.is(a2[a5])&&a2[a5]===true){a0.push(a2.type)}}}return a0},getScopeLinksInGivenRefConns:function aU(a0){return a0.filter(function(a1){return a1.id.indexOf("ProductImplementLink|")===-1})},getProcessScopeLinksInGivenRefConns:function y(a0){return a0.filter(function(a1){return a1.id.indexOf("ProcessImplementLink|")!==-1})},getImpactedConnections:function af(a0){var a1;a1=ag.connections.filter(function(a2){var a5,a4,a3=function a3(a6){return a6===a0};a5=a2.get("from");if(aO.is(a5,"string")){if(a5===a0){return true}}else{if(aO.is(a5,"array")){if(a5.some(a3)){return true}}}a4=a2.get("to");if(aO.is(a4,"string")){if(a4===a0){return true}}else{if(aO.is(a4,"array")){if(a4.some(a3)){return true}}}return false});return a1},getImpactedConnectionsOfInstance:function aj(a2,a1){var a5,a4=null,a6=function a6(bb,a7){var a8,bc,a9,ba;bc=ag.getInstanceFromCollection(bb).get("isInstanceOf");a9=ag.instances.where({isAggregatedBy:bc}).map(function(bd){return bd.id});if(a9.length===0){return[]}ba=a9.filter(function(bd){return a7.indexOf(bd)!==-1});if(ba.length>0){return ba}for(a8=0;a8<a9.length;a8++){ba=a6(a9[a8],a7);if(ba.length>0){break}}return ba},a0=function a0(a9){var bc,ba,a8,be,a7,bb=[],bd=[];bb=a9[0];bd.push(bb);for(bc=0;bc<a9.length-1;bc++){bb=[];a8=a9[bc];for(ba=0;ba<a8.length;ba++){if(bd[bc].indexOf(a8[ba])===-1){continue}a7=a9[bc+1];be=a6(a8[ba],a7);bb=bb.concat(be)}bd.push(bb)}return bd},a3=function a3(bb){var bh=[],bc=[],a8,bg,a7,ba,bf,bd,a9=null;a7=(bb.getUpperScopePath().length>0)?true:false;a8=bb;while(aO.is(a8)&&!a8.isRoot()){bg=a8.getPathToScope();bf=ag.connections.filter(function(bj){var bi="ProductImplementLinkOcc"===bj.get("type")||"ProcessImplementLinkOcc"===bj.get("type"),bk=ag.arrayCompare(bg,bj.get("to"));return bi&&bk}).map(function be(bi){return bi.get("from")});bh.unshift(bf);a8=a8.getFirstParentWithAScopeNode()}if(a7){if(bh[bh.length-1].length>0){bc=a0(bh)}else{bc=bh}ba=bb.getAbsolutePath();bd=ag.connections.filter(function(bj){var bi="ProductImplementLinkOcc"===bj.get("type")||"ProcessImplementLinkOcc"===bj.get("type"),bk=ag.arrayCompare(ba,bj.get("to"));return bi&&bk}).map(function be(bi){return bi.get("from")})}else{bc=bh}if(bc.length>0){a9=bc[bc.length-1];if(aO.is(bd,"array")&&bd.length>0){a9=a9.concat(bd)}}return a9};if(aO.is(a2,"string")){a5=ag.connections.filter(function(a7){var a8=a7.get("from");if(aO.is(a8,"array")){a8=a8[a8.length-1]}return(a8===a2)})}else{if(aO.is(a2,"array")){a4=a3(a1);a5=ag.connections.filter(function(a7){return a4.indexOf(a7.get("from"))!==-1})}}return a5},extractAttributesFromConnections:function ar(a1){var a0=[],a2=function(a3,a5,a4){this.type=a3;this.from=a5;this.to=a4};a1.forEach(function(a3){a0.push(new a2(a3.get("type"),a3.get("from"),a3.get("to")))});return a0},arrayCompare:function m(a3,a2){var a1,a0;if(!aO.is(a3,"array")||!aO.is(a2,"array")){return false}a0=a3.length;if(a0!==a2.length){return false}for(a1=0;a1<a0;a1++){if(a3[a1] instanceof Array&&a2[a1] instanceof Array){if(!ag.arrayCompare(a3[a1],a2[a1])){return false}}else{if(a3[a1]!==a2[a1]){return false}}}return true},isValidPID:function D(a0){var a1=false;if(aO.is(a0,"string")&&(a0.length>0)){a1=true}return a1},getLastElement:function J(a0){var a1=null;if(aO.is(a0,"array")){a1=(a0.length>0)?a0[a0.length-1]:null}return a1},getLastElementInstanceInfoPID:function b(a2,a1){var a3=null,a0=null,a4=null;a3=ag.getLastElement(a2);if(ag.isValidPID(a3)){a0=ag.getInstanceFromCollection(a3);if(aO.is(a0)){a4=a0.get(a1);if(!ag.isValidPID(a4)){a4=null}}}return a4},isConnectionImpacted:function Q(a9,a3){var a8=a3||{},bd=aO.is(a8.referencePID)?a8.referencePID:null,ba=aO.is(a8.instancePID)?a8.instancePID:null,a5=aO.is(a8.relationTypes)?a8.relationTypes:null,a2=aO.is(a8.useOnlyRefRefLnk)?a8.useOnlyRefRefLnk:true,a7=aO.is(a8.connectionModelInfo)?a8.connectionModelInfo:null,a0=aO.is(a8.objPPRType)?a8.objPPRType:null,be=a9.get("from"),bc=a9.get("to"),a4=a9.get("type"),bh=false,bg=true,bf=false,bb=false,a6=function a6(bi){var bj=false;if(aO.is(bi,"array")){if((bi[bi.length-1]===bd)||(bi[bi.length-1]===ba)){bj=true}}else{if((bi===bd)||(bi===ba)){bj=true}}return bj},a1=function a1(){var bi=false,bj;if(aO.is(a4,"string")){if(aO.is(a5,"array")){bj=a5}else{bj=ag.getAuthorizedRelationList(a0)}if(aO.is(bj,"array")){if((bj.length>0)&&(bj.indexOf(a4)>=0)){bi=true}}}return bi};bb=a6(be);if(bb){if(aO.is(a7)){a7.connectionID=a9.id;a7.connectionTypeName=a4;a7.modelID=bc;a7.fromID=a9.get("from")}}else{if(!aO.is(a5,"array")){bb=a6(bc);if(bb&&aO.is(a4,"string")&&(a4.length>0)){a4=a4+"_inverse";if(aO.is(a7)){a7.connectionID=a9.id;a7.connectionTypeName=a4;a7.modelID=be;a7.fromID=a9.get("to")}}}}if(bb){if(aO.is(be,"array")||aO.is(bc,"array")){bh=true}bg=a1();if((!a2||!bh)&&bg){bf=true}else{if(aO.is(a7)){a7=null}}}else{if(aO.is(a7)){a7=null}}return bf},getConnectionsByModel:function o(a3,a2,a1,a7,a6,a4){var a5=a4||{},a0=aO.is(a5.forceDBMode)?a5.forceDBMode:false;if((aP.isNavigateOn()==="index"||aP.isNavigateOn()==="indexOndemand")&&!a0){ag._getConnectionsByModelFromIndex(a3,a2,a1,a7,a6)}else{ag._getConnectionsByModelFromDB(a3,a2,a1,a7,a6)}},_getConnectionsByModelFromIndex:function aM(bf,a3,a7,a9,a2){var a6=[],ba=aO.is(bf)?bf.id:null,a5=aO.is(a3)?a3.id:null,bc=aO.is(bf)?bf.get("PPRTYPE"):(aO.is(a3)?a3.get("PPRTYPE"):null),be=[],a0=[],a4=[],a8=[],bb={documentIdMap:a8},a1=function a1(){var bh=[],bl=[],bj=[],bm={stackedReferences:[],stackedInstances:[],onComplete:function bn(){if(aO.is(a2,"function")){a2(bh)}}},bo=function bo(bs){var br=false,bq={referencePID:ba,instancePID:a5,relationTypes:a7,useOnlyRefRefLnk:a9,objPPRType:bc};br=ag.isConnectionImpacted(bs,bq);return br},bi=function bi(bt){var bu=bt.get("from"),bv=bt.get("to"),bs=bt.get("type"),bq=true,br=function br(bx,bw){if(aO.is(bx,"array")){bx.forEach(function by(bz){if(aO.is(bz,"string")&&!ag.isInstance(bz)){bj.push(bz)}})}else{if(aO.is(bx,"string")){if(bw){if(!ag.isReference(bx)){bl.push(bx)}}else{if(!ag.isInstance(bx)){bj.push(bx)}}}}};if("ProductImplementLinkOcc"===bs||"DELLmiTimeConstraintCnx"===bs||"DELLmiMaterialPathCnxCust"===bs){bq=false}br(bu,bq);br(bv,bq)},bg=function bg(br){var bq=function bq(bs){bm.stackedReferences.push(bs.attributes)};if(aO.is(br)){if(aO.is(br,"array")){br.forEach(bq)}else{bq(br)}}ag.addToCollections(bm)},bp=function bp(){if(bl.length>0){aP.fetchOnIndex(bl,{onComplete:bg,context:ag})}else{bg()}},bk=function bk(br){var bq=function bq(bs){bm.stackedInstances.push(bs);if(aO.is(bs.isInstanceOf,"string")&&(""!==bs.isInstanceOf)){if(!ag.isReference(bs.isInstanceOf)){bl.push(bs.isInstanceOf)}}};if(aO.is(br)){if(aO.is(br,"array")){br.forEach(bq)}else{bq(br)}}bp()};bh=ag.connections.filter(bo);if(aO.is(bh,"array")){bh.forEach(bi)}if(bj.length>0){aP.fetchOnIndex(bj,{onComplete:bk,context:ag,type:"relation"})}else{bk()}},bd=function bd(){var bi={queriedForConnections:true},bg={stackedReferences:be,stackedInstances:a0,stackedConnections:a4,documentIdMap:a8,onComplete:function bh(){if(aO.is(bf)){bf.set(bi)}if(aO.is(a3)){a3.set(bi)}a1()}};ag.addToCollections(bg)};if(aO.is(ba)){if(ag._needToQueryForConnections(ag.references,ba)){a6.push(ba)}}if(aO.is(a5)){if(ag._needToQueryForConnections(ag.instances,a5)){a6.push(a5)}}if(a6.length>0){ag.navigateNodes(a6,be,a0,a4,bd,bb)}else{a1()}},_getConnectionsByModelFromDB:function ac(bc,a4,a6,a7,a3){var bd=this,ba=aO.is(a3,"function"),bf,a1,bb,a2,a9,a0,a8,be,a5;if(aO.is(a4)){a2=a4.id;a0=a2;a8=a4.get("PPRTYPE")}if(aO.is(bc)){bb=bc.id;a9=bb;a8=bc.get("PPRTYPE")}be=function be(bj){var bi=[],bh={from:true,to:true},bk,bg;if(aO.is(bj)){bh=aO.extend(bh,bj)}if(bh.from){bk=bd.connections.filter(function(bl){var bo=false,bm,bn;bn=bl.get("from");if(aO.is(bn,"array")){bn=bn[bn.length-1]}if(bn===bb||bn===a2){bm=bl.get("type");if(a1.indexOf(bm)>=0){if(a7){if(bd.isReference(bl.get("from"))&&bd.isReference(bl.get("to"))){bo=true}}else{bo=true}}}return bo});bi=bi.concat(bk)}if(bh.to){bg=bd.connections.filter(function(bl){var bn=false,bm,bo;bo=bl.get("to");if(aO.is(bo,"array")){bo=bo[bo.length-1]}if(bo===bb||bo===a2){bm=bl.get("type")+"_inverse";if(a1.indexOf(bm)>=0){if(a7){if(bd.isReference(bl.get("from"))&&bd.isReference(bl.get("to"))){bn=true}}else{bn=true}}}return bn});bi=bi.concat(bg)}return bi};a5=function a5(bm,bo,bp){var bs=[],bk,br,bh=[],bl=[],bn=[],bq=[];if(a8==="PART"){if(aO.is(bm)){bh.push(bm)}if(aO.is(bo)){bh.push(bo)}bd.navigateNodes(bh,bl,bn,bq,function bg(){bd.connections.add(bq);bd.references.add(bl,{silent:true});bs=be(bp);if(ba){a3(bs)}},{addToCollection:true})}else{bd.connections.fetch({data:{parentPID:bm,instancePID:bo,gridIDs:aO.Json.encode(a1)},proxy:"passport",headers:aP.getHeaders(),wait:true,remove:false,onComplete:function bj(){var bt;if(aO.is(bm)&&!a7){bk=bd.references.get(bm);if(bk){if("PART"===bk.get("PPRTYPE")){bt=aP.translatePredicateToAttribute(bk._attributes,{type:"entity"});bk.set(bt)}bk.set({queriedForConnections:true})}else{bd._logger.warn("could not get reference pid %s",bm)}}if(aO.is(bo&&!a7)){br=bd.instances.get(bo);br.set({queriedForConnections:true})}bs=be(bp);if(ba){a3(bs)}},onFailure:function bi(){if(ba){a3(bs)}}})}};if(aO.typeOf(a6)==="array"){a1=a6;if(!this._needToQueryForConnections(this.references,bb)){a9=null}if(!this._needToQueryForConnections(this.instances,a2)){a0=null}if(aO.is(a9)||aO.is(a0)){a5(a9,a0,{from:true,to:false})}else{bf=be({from:true,to:false});if(ba){a3(bf)}}}else{if(aO.is(a8,"string")){a1=ag.getAuthorizedRelationList(a8);if(!bd._needToQueryForConnections(bd.references,a9)){a9=null}if(!bd._needToQueryForConnections(bd.instances,a0)){a0=null}if(aO.is(a9)||aO.is(a0)){a5(a9,a0)}else{bf=be();if(ba){a3(bf)}}}else{if(ba){a3(null)}}}},_get3DViewerMetadatas:function ah(){return{metadata:{timestamp:aa.now(),originUid:aP.getUid(),appid:aP.getAppId(),originWidgetId:widget.id}}},_Compute3DContentFromMBOM:function u(a5,a2){var a0=a2||{},a1=aO.is(a0.onComplete)?a0.onComplete:null,a3=aO.is(a0.asRootInTableView,"boolean")?a0.asRootInTableView:null,bb=aO.is(a0.toPID,"string")?a0.toPID:null,a6=aO.is(a0.cvquery3d)?a0.cvquery3d:null,a9=null,a7=true,ba={pids:[]},a4={};if(aO.is(a5)){a9=ag.getReferenceFromCollection(a5);if(aO.is(a3)){if(aO.is(a9)){if(a9.getDisplayModelAttr("asRootInTableView")!==a3){a7=false}}else{a7=false}}if(a7){if(aO.is(bb)){if(aO.is(a1,"function")){if(aO.is(a6)){ba={rootsWithFilters:[]};a4={rootId:bb,filter:{CVQuery3D:a6,filterRootIds:[bb]}};delete ba.pids;ba.rootsWithFilters.push(a4)}else{ba.pids.push(bb)}a1(ba)}}else{ag.getConnectionsByModel(a9,null,["ProductImplementLink"],false,function a8(bd){if(aO.is(bd,"array")){bd.forEach(function bc(be){var bf=be.get("to");if(aO.is(bf,"string")&&(bf.length>0)){ba.pids.push(bf)}})}if(aO.is(a1,"function")){if(aO.is(a6)){ba={rootsWithFilters:[]};a4={rootId:bb,filter:{CVQuery3D:a6,filterRootIds:[bb]}};delete ba.pids;ba.rootsWithFilters.push(a4)}a1(ba)}})}}}},add3DContentFromMBOM:function F(a0,a4){var a3=a4||{},a6=aO.is(a3.toPID,"string")?a3.toPID:null,a2=aO.is(a3.testAsRootInTableView,"boolean")?(a3.testAsRootInTableView?true:null):true,a1=aO.is(a3.cvquery3d)?a3.cvquery3d:null,a5=function a5(a8){var a7={data:a8};aO.merge(a7,ag._get3DViewerMetadatas());G.publish("DS/PADUtils/PADCommandProxy/drop"+aP.getAppId(),a7)};ag._Compute3DContentFromMBOM(a0,{onComplete:a5,asRootInTableView:a2,toPID:a6,cvquery3d:a1})},remove3DContentFromMBOM:function am(a0,a4){var a3=a4||{},a6=aO.is(a3.toPID,"string")?a3.toPID:null,a2=aO.is(a3.testAsRootInTableView,"boolean")?(a3.testAsRootInTableView?false:null):false,a1=aO.is(a3.filter)?a3.filter:null,a5=function a5(a8){var a7={data:a8};aO.merge(a7,ag._get3DViewerMetadatas());G.publish("DS/PADUtils/PADCommandProxy/remove"+aP.getAppId(),a7)};ag._Compute3DContentFromMBOM(a0,{onComplete:a5,asRootInTableView:a2,toPID:a6,filter:a1})},getConnectionsById:function aJ(a5,a0,a2,a6,a1){var a4,a3;if(aO.is(a5)){a4=this.references.get(a5)}if(aO.is(a0)){a3=this.instances.get(a0)}this.getConnectionsByModel(a4,a3,a2,a6,a1)},getSelectedRefs:function p(a0){return this._getSelectedModels(this.references,a0)},getSelectedInsts:function al(a0){return this._getSelectedModels(this.instances,a0)},_getSelectedModels:function h(a4,a2){var a0,a1;a2=a2||{};if(a2.views){if(aO.is(a2.views,"array")){a0=a2.views}else{a0=[a2.views]}}else{a0=Object.keys(this.VIEWS)}a1=a4.filter(function a3(a7){var a8=false,a5;a0.forEach(function a6(a9){switch(a9){case this.VIEWS.AUXILIARY:a5="selectedInAuxiliaryView";break;case this.VIEWS.ROUTINGS||this.VIEWS.MBOM:a5="selectedInTableView";break;case this.VIEWS.GENERIC:a5="selectedInGenericView";break;case this.VIEWS.BODY:a5="selectedInBodyView";break;case this.VIEWS.ACTION:a5="selectedInActionView";break;default:a5="";break}a8=a8||aP.castToBoolean(a7.getDisplayModelAttr(a5))},this);return a8},this);return aP.unique(a1)},_needToQueryForConnections:function aD(a0,a1){return this.needToQueryForConnections(a0.get(a1))},needToQueryForConnections:function au(a1){var a0=false;if(aO.is(a1)){if(!a1.get("queriedForConnections")){a0=true}}return a0},needToQueryForChildren:function H(a2){var a1=false,a0=aO.is(a2,"string")?this.references.get(a2):a2;if(aO.is(a0)){if(!a0.get("queriedForChildren")){a1=true}}return a1},isReference:function S(a0){return aO.is(ag.references.get(a0))},isInstance:function X(a0){return aO.is(ag.instances.get(a0))},refreshAll:function ai(bb,a7,a3,a9){var a0=a9||{},be=aO.is(a0.context)?a0.context:null,a8=a7.concat(a3).concat(bb),ba=[],bd=[],a4=[],a2=[],a6,bc;a8.forEach(function a1(bf){a2.push(new aW(function(bk,bh){ag.fetchRoot(bf,{onFailure:function bg(){bh()},onTimeout:function bj(){bh()},onComplete:function bi(bl,bm){var bn=false;if(aO.is(bl)&&aO.is(bl.get("PID"))){if(aO.is(bm)){if((aP.isNavigateOn()==="index"||aP.isNavigateOn()==="indexOndemand")&&bm.forceDBMode){bn=true}}if(bn){bd.push(bl.get("PID"));a4.push(bl)}ba.push(bl);bk()}else{bh()}}})}))});this._logger.log("refreshAll, Table roots PID: "+a7);this._logger.log("refreshAll, Auxiliary view roots PID: "+a3);aO.Promise.allSettled(a2).then(function a5(){var bi,bh,bf={allRootsFetched:ba,rootsFetchedWithForcedDB:a4,rootPIDsFetchedWithForcedDB:bd,missingRefModel:[]};if(ba.length!==a8.length){a8.forEach(function bg(bj){var bk=ba.every(function bl(bm){return(bm.id!==bj)});if(bk){bf.missingRefModel.push(ag.getReferenceFromCollection(bj))}})}G.publish("DS/PADUtils/PADCommandProxy/cleanAll"+aP.getAppId(),ag._get3DViewerMetadatas());ag.references.reset(ba,{silent:true});a6=ag.instances.reset({},{silent:true});if(aO.is(a6)){ag.instances.remove(a6,{silent:true})}bc=ag.connections.reset({},{silent:true});if(aO.is(bc)){ag.connections.remove(bc,{silent:true})}bi=ag.customObjs.reset({},{silent:true});if(aO.is(bi)){ag.customObjs.remove(bi,{silent:true})}bh=ag.customConnections.reset({},{silent:true});if(aO.is(bh)){ag.customConnections.remove(bh,{silent:true})}if(aO.is(a0.onComplete,"function")){a0.onComplete.call(be,bf)}})},getWhereUsedReferences:function U(a2,a5){var a4=aO.is(a5,"function"),a1,a7=[],a0;if(aO.is(a2)){a1=a2.id}aP.webServiceRequest({url:"modeler/ppr/whereUsed",method:"GET",data:{pid:a1},onComplete:function a6(a8){a8.forEach(function(a9){a0=new aR(a9);if(a0.isReference()&&aO.is(a0.get("PPRTYPE"))){a7.push(a0)}});a7.forEach(function(a9){if(!aO.is(ag.references.get(a9.id))){ag.references.add(a9)}});if(a4){a5(a7)}},onFailure:function a3(){if(a4){a5([])}}})},getCustomReferences:function B(a9,a2,a5,a6,a8){var a1=a8||{},a3=aO.is(a1.forceDBMode)?a1.forceDBMode:false,a0,a7;a0=ag.customObjs.reset({},{silent:true});if(aO.is(a0)){ag.customObjs.remove(a0,{silent:true})}a7=ag.customConnections.reset({},{silent:true});if(aO.is(a7)){ag.customConnections.remove(a7,{silent:true})}if((aP.isNavigateOn()==="index"||aP.isNavigateOn()==="indexOndemand")&&!a3){ag._getCustomDescendantsFromIndex(a9.id,a5,a6,function a4(){ag._getCustomConnectionsByModelFromIndex(a9,null,a2)})}else{ag._getCustomConnectionsByModelFromDB(a9,a2,a5)}},_getCustomConnectionsByModelFromIndex:function aM(a4,a3,a5){var a1=aO.is(a4)?a4.id:null,a2=aO.is(a3)?a3.id:null,a0=function a0(){var a6=[],a7=function a7(bb){var a9=bb.get("from"),bd=bb.get("to"),ba=false,bc=false,a8=function a8(be){var bf=false;if(aO.is(be,"array")){if((be.indexOf(a1)>=0)||(be.indexOf(a2)>=0)){bf=true}}else{if((be===a1)||(be===a2)){bf=true}}return bf};bc=a8(a9);if(!bc){bc=a8(bd)}if(bc){ba=true}return ba};ag.customConnections.filter(a7).forEach(function(a8){a6.push(a8)});if(aO.is(a5,"function")){a5(a6)}};a0()},_getCustomConnectionsByModelFromDB:function w(a2,a5,a7){var a0,a1=this,a4=aO.is(a5,"function");if(aO.is(a2)){a0=a2.id}aP.webServiceRequest({url:"modeler/pprirpc/customConnection",method:"POST",data:JSON.stringify({referencePID:a0,relationAttributes:a7}),onComplete:function a6(a9){var bb,a8,ba=[];if(aO.is(a9)){bb=Array.isArray(a9.connObjs)?a9.connObjs:[a9.connObjs];a8=Array.isArray(a9.connections)?a9.connections:[a9.connections];a8.forEach(function(be){var bc=a1.parseCustomConnection(be),bd;bd=a1.customConnections.add(bc);ba.push(bd)});bb.forEach(function(be){var bd=be.attributesValue,bc;bc=a1.customObjs.get(bd.PID);if(!aO.is(bc)){bc=a1.customObjs.add(be,{})}})}if(a4){a5(ba)}},onFailure:function a3(){if(a4){a5([])}}})},_getPathsFromSR:function d(a1){var a7=null,a2,a3,a0,a6,a4,a5;a2=a1.indexOf(" PS ");a2=a2+4;a3=a1.indexOf(" PE ");if(a2===-1||a3===-1){this._logger.log("Error parsing fromOcc from attribute pathSR: "+a1);return null}a0=a1.substring(a2,a3);a6=a0.split(" ");a2=a1.indexOf(" PS ",a2);a2=a2+4;a3=a1.indexOf(" PE",a3+4);if(a2===-1||a3===-1){this._logger.log("Error parsing toOcc from attribute pathSR: "+a1);return null}a4=a1.substring(a2,a3);a5=a4.split(" ");if(aO.is(a6)&&aO.is(a5)){a7={from:a6,to:a5}}return a7},traverseInstanceModels:function aZ(a2,a5){var a0,a4,a1,a3=function a3(a8,a6){var a7=ag.getInstancesFromCollection(a8);a7.forEach(function(a9){a6.push(a9)})};if(aO.is(a5,"function")){a0=[];a3(a2,a0);while(a0.length>0){a4=a0.pop();a5(a4);a1=a4.get("isInstanceOf");a3(a1,a0)}}else{this._logger.log(this.name,"callback cbProcessModel not provided")}}});return ag});define("DS/DELWebMfgAssetsDefModelServices/Selection",["UWA/Core","UWA/Class","DS/Logger/Logger","DS/PlatformAPI/PlatformAPI","DS/Core/Events","DS/PADUtils/PADCommandProxy","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ProxyXSO"],function(g,z,B,d,t,n,m,f,A,q){var c=z.singleton({name:"Selection",_logger:null,_widgetTrigram:"",_proxyXSO:null,init:function x(D){var F,E;D=D||{};this._parent(D);if(g.is(B)){this._logger=B.getLogger(c)}this._PADProxy=n.create({events:{onRefresh:this._PADRefresh}});this._widgetTrigram=f.getWidgetTrigram();F="DS."+this._widgetTrigram+".Object.AddReference";E="DS."+this._widgetTrigram+".Object.Refresh";d.subscribe(F,c._addReferenceFromEvent);d.subscribe(E,c._refreshElementFromEvent);this._proxyXSO=new q()},getActionBarContext:function y(){return this._context},selectionChanged:function e(E,M,F){var I=m.getSelectedRefs(),J=m.getSelectedInsts(),K="DS/PADUtils/PADCommandProxy/select",N={data:{paths:[],pathsInst:[]}},G=[E],L,D={selectedObjectsPID:[],selectedObjectsInstPID:{},modifiedObjectPID:E,modifiedObjectInstPID:M,modifiedObjectSelectionState:F,widgetId:widget.id?widget.id:"defaultId"};I.forEach(function H(O){if(g.is(O)){D.selectedObjectsPID.push(O.id);D.selectedObjectsInstPID[O.id]=[];J.forEach(function P(Q){if(O.id===Q.get("isInstanceOf")){D.selectedObjectsInstPID[O.id].push(Q.id)}})}});if(g.is(c._logger)){c._logger.log("DS."+this._widgetTrigram+".Selection.SelectionModified event broadcast: ");c._logger.log(D)}if(g.is(c._proxyXSO)){c._proxyXSO.onSelectionChange(D)}d.publish("DS."+this._widgetTrigram+".Selection.SelectionModified",D);if(F){if(D.selectedObjectsPID.length>=1){N.data.paths.push(G);L=D.selectedObjectsInstPID[G[0]];if(L.length===1){N.data.pathsInst.push(L)}d.publish(K,N)}}},_addReferenceFromEvent:function b(E){var D=function D(H){var I=H||{},G=g.is(I.id,"string")?I.id:null,F=g.is(I.forceDBMode,"boolean")?I.forceDBMode:false;if(g.is(G)){c._addReference(H.id,{forceDBMode:F})}};if(g.is(E,"array")){E.forEach(D)}},_refreshElementFromEvent:function k(D){var E=function E(I){var J=I||{},H=g.is(J.id,"string")?J.id:null,G=g.is(J.forceDBMode,"boolean")?J.forceDBMode:false,F=g.is(J.forceExpand,"boolean")?J.forceExpand:true;if(g.is(H)){c._refreshElement(H,{forceExpand:F,forceDBMode:G})}};if(g.is(D,"array")){D.forEach(E)}},_addReference:function v(H,F){var G=F||{},E=g.is(G.forceDBMode,"boolean")?G.forceDBMode:true,I=function I(J){m.references.add(J);t.publish({event:"DELWebMfgAssetsDefUI/asRootInView",data:{rootPLMID:J.id,forceDBMode:E}})},D=function D(J){if(g.is(c._logger)){c._logger.error("Selection._addReference failure for: "+H);if(g.is(J)){c._logger.error(JSON.stringify(J))}}};m.fetchRoot(H,{context:this,onComplete:I,onFailure:D,forceDBMode:E})},_refreshElement:function h(L,K){var D=K||{},N=g.is(D.forceDBMode,"boolean")?D.forceDBMode:true,O=g.is(D.forceExpand,"boolean")?D.forceExpand:false,E=g.is(D.context)?D.context:null,M=g.is(D.onComplete,"function")?D.onComplete:null,F=m.references.get(L),H=function H(){if(O&&g.is(F)){F.set({queriedForChildren:false},{silent:true});m.getDescendantsFromServer(F.id,M,{context:E,forceDBMode:N})}else{if(g.is(M,"function")){M.call(E)}}},I=function I(P){if(g.is(F)){F.set(P,{silent:true})}H()},G=function G(P){if(g.is(c._logger)){c._logger.error("Selection._refreshElement failure for: "+L);if(g.is(P)){c._logger.error(JSON.stringify(P))}}},J;if(!g.is(F)){F=m.instances.get(L)}if(g.is(F)){if((f.isNavigateOn()==="index"||f.isNavigateOn()==="indexOndemand")&&!N){f.fetchOnIndex(F.id,{context:this,onComplete:I,onFailure:G})}else{J={proxy:"passport",headers:f.getHeaders(),onComplete:H,onFailure:G};F.fetch(J)}}},_MGACSO:[],_createNode:function i(G,D){var E;if(!G){c._logger.warn("No model to create node from");return}E={options:{grid:{"ds6wg:type":G.get("type"),"ds6wg:revision":G.get("revision")}},getID:function F(){return G.id},getInstID:function K(){var L=[];if(g.is(D,"array")){D.forEach(function(M){L.push(M.id)})}return L},getLabel:function J(){return G.get("V_Name")},getIcon:function I(){return A.getIconURLFromKey(G.get("type"))},getOccurencePathWithType:function H(){return null}};return E},_addNode:function a(E,D){c._MGACSO.push(c._createNode(E,D))},_emptyNode:function C(){c._MGACSO=[]},_refreshCreated:function p(D){var F,E;if(g.is(D,"array")){for(F=0;F<D.length;++F){if(g.is(c._logger)){c._logger.log("context._refreshCreated, elt.pid: ");c._logger.log(D[F])}E=D[F].physicalid;c._addReference(E)}}},_refreshDeleted:function w(F){var G,D,E,H=function H(J){var I;if(g.id(J,"array")){for(I=0;I<J.length;I++){m.connections.remove(J[I].id)}}};if(g.is(F)){if(g.is(c._logger)){c._logger.log("context._refreshDeleted: ");c._logger.log(F)}for(G=0;G<F.length;++G){E=F[G].physicalid;if(g.is(E)){D=m.instances.get(E);if(g.is(D)){m.getConnectionsByModel(null,D,null,false,H);m.instances.remove(E)}D=m.references.get(E);if(g.is(D)){m.getConnectionsByModel(D,null,null,false,H);m.references.remove(E)}}}}},_refreshModified:function j(E){if(g.is(E)){if(g.is(c._logger)){c._logger.log("Selection._refreshModified: ");c._logger.log(E)}if(g.is(E,"array")){E.forEach(function D(F){var G=g.is(F.physicalid)?F.physicalid:F,I=m.getReferenceFromCollection(G),J=g.is(I)?I:m.getInstanceFromCollection(G),H=function H(M){if(g.is(c._logger)){c._logger.error("Selection._refreshModified failure for: "+G);if(g.is(M)){c._logger.error(JSON.stringify(M))}}},K=function K(){if(g.is(c._logger)){c._logger.log("Selection._refreshModified done for: "+G)}},L={proxy:"passport",headers:f.getHeaders(),onComplete:K,onFailure:H};if(g.is(c._logger)){c._logger.log("context._refreshModified, elt.pid: "+G)}if(g.is(J)){J.fetch(L)}})}}},_context:{widget:{data:{appId:"DELMGA_AP"}},getSelectedNodes:function l(){var E=m.getSelectedRefs(),D=m.getSelectedInsts();c._emptyNode();if(g.is(E,"array")){E.forEach(function(F){var G=[];if(g.is(D,"array")){D.forEach(function(H){if(F.id===H.get("isInstanceOf")){G.push(H)}})}this._addNode(F,G)},c)}return c._MGACSO},refreshView:function u(D){if(g.is(c._logger)){c._logger.log("context.RefreshView: ");c._logger.log(D)}f.setForceDBMode(true);if(g.is(D)){if(g.is(D.created)){if(g.is(D.created.length)){if(D.created.length>0){c._refreshCreated(D.created)}}}if(g.is(D.deleted)){if(g.is(D.deleted.length)){if(D.deleted.length>0){c._refreshDeleted(D.deleted)}}}if(g.is(D.modified)){if(g.is(D.modified.length)){if(D.modified.length>0){c._refreshModified(D.modified)}}}}},getSecurityContext:function r(){return{SecurityContext:f.getSecurityContext(),tenant:f.getTenant()}}},_PADRefresh:function s(E){var D=E.authored.modified;if(g.is(c._logger)){c._logger.log("context._PADRefresh: ");c._logger.log(E)}f.setForceDBMode(true);c._refreshModified(D)},getProxyXSO:function o(){return this._proxyXSO}});return c});define("DS/DELWebMfgAssetsDefModelServices/BIUtils",["UWA/Core","UWA/Class","DS/DELWebMfgAssetsDefBIModel/BIModelCollection","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/Resources","UWA/Class/Listener","DS/DELWebMfgAssetsDefModelServices/CollectionUtils","DS/Core/Events"],function(g,z,a,d,F,E,e,m,u){var c=z.singleton(e,{name:"BIUtils",_logger:null,_cmdState:false,init:function y(J){this._parent(J);this.biModelCollection=new a();if(g.is(F)){this._logger=F.getLogger(c)}this._mbomArray=[];this._embomArray=[];this._loadedProcNodes=[];this._loadedProdNodes=[];this.listenTo(m.connections,"onAdd",this._onConnectionAdd);this.listenTo(m.connections,"onRemove",this._onConnectionRemove);this._prdAssignmentStatus={AssociatedWithScope:{colorCode:"#006400",label:E.getNLSValue("BI.PrdStatus.AssociatedWithScope")},NotAssigned:{colorCode:"#FFA500",label:E.getNLSValue("BI.PrdStatus.NotAssigned")},AssignedIndirectly:{colorCode:"#00008B",label:E.getNLSValue("BI.PrdStatus.AssignedIndirectly")},AssignedDirectly:{colorCode:"#ADD8E6",label:E.getNLSValue("BI.PrdStatus.AssignedDirectly")},AssignedMoreThanOnce:{colorCode:"#bd07b0",label:E.getNLSValue("BI.PrdStatus.AssignedMoreThanOnce")},NotAssignable:{colorCode:"#808080",label:E.getNLSValue("BI.PrdStatus.NotAssignable")},NotApplicable:{colorCode:"#A9A9A9",label:E.getNLSValue("BI.PrdStatus.NotApplicable")},PartiallyAssigned:{colorCode:"#8B4513",label:E.getNLSValue("BI.PrdStatus.PartiallyAssigned")},Inconsistent:{colorCode:"#000000",label:E.getNLSValue("BI.PrdStatus.Inconsistent")},};this._mfgUpdateStatus={NotApplicable:{colorCode:"#A9A9A9",label:E.getNLSValue("BI.MfgStatus.NotApplicable")},ScopeGood:{colorCode:"#008000",label:E.getNLSValue("BI.MfgStatus.ScopeGood")},ScopeToOldRev:{colorCode:"#7030a0",label:E.getNLSValue("BI.MfgStatus.ScopeToOldRev")},ScopeToNew:{colorCode:"#FFA500",label:E.getNLSValue("BI.MfgStatus.ScopeToNew")},ScopeNoCorrespondingProductOccurence:{colorCode:"#FF0000",label:E.getNLSValue("BI.MfgStatus.ScopeNoCorrespondingProductOccurence")},ImplGood:{colorCode:"#008000",label:E.getNLSValue("BI.MfgStatus.ImplGood")},ImplGoodWithGoodScope:{colorCode:"#008000",label:E.getNLSValue("BI.MfgStatus.ImplGoodWithGoodScope")},ImplCandidatePrdOccWithGoodScope:{colorCode:"#0000FF",label:E.getNLSValue("BI.MfgStatus.ImplCandidatePrdOccWithGoodScope")},ImplCandidatePrdOcc:{colorCode:"#0000FF",label:E.getNLSValue("BI.MfgStatus.ImplCandidatePrdOcc")},ImplCandidatePrdOccWithScopeToOldRev:{colorCode:"#9370DB",label:E.getNLSValue("BI.MfgStatus.ImplCandidatePrdOccWithScopeToOldRev")},ImplCandidatePrdOccButNotCorrespondingScope:{colorCode:"#FFA500",label:E.getNLSValue("BI.MfgStatus.ImplCandidatePrdOccButNotCorrespondingScope")},ImplCandPrdOccToSamePrd:{colorCode:"#0000FF",label:E.getNLSValue("BI.MfgStatus.ImplCandPrdOccToSamePrd")},ImplCandPrdOccToOtherRev:{colorCode:"#9370DB",label:E.getNLSValue("BI.MfgStatus.ImplCandPrdOccToOtherRev")},ImplCandPrdOccToDiffPrd:{colorCode:"#FFA500",label:E.getNLSValue("BI.MfgStatus.ImplCandPrdOccToDiffPrd")},ImplNoCandProdOccurence:{colorCode:"#FF0000",label:E.getNLSValue("BI.MfgStatus.ImplNoCandProdOccurence")},IntermediateGood:{colorCode:"#008000",label:E.getNLSValue("BI.MfgStatus.IntermediateGood")},IntermediateChildrenNotUptoDate:{colorCode:"#FFFF00",label:E.getNLSValue("BI.MfgStatus.IntermediateChildrenNotUptoDate")},Inconsistent:{colorCode:"#000000",label:E.getNLSValue("BI.MfgStatus.Inconsistent")},}},getBrokenMfgItemStatus:function v(J,M){var L=this,K;J=J||{};J.isMILCommand=true;L._fetchStatus(J,function(N){if(g.is(N)){K=N.where({type:"MfgItemsUpdateStatus",isBroken:true});M(K)}})},getProductAssignmentStatus:function r(L){var K=this,J;K._fetchStatus(function(M){if(g.is(M)){J=M.where({type:"ProductsAssignmentStatus"});L(J)}})},getMfgItemUpdateStatus:function I(L){var K=this,J;K._fetchStatus(function(M){if(g.is(M)){J=M.where({type:"MfgItemsUpdateStatus"});L(J)}})},_fetchStatus:function p(L,N){var M=this;new Promise(function(O){if(!M.isBIComputed()){M.fetchBIComputation(L,function(){O()})}else{O()}}).then(function J(){N(M.biModelCollection)},function K(){N([])})},fetchBIComputation:function t(J,O){var L=this,M;J=J||{};L._mbomArray=g.is(J.rootMBOM)?J.rootMBOM:L._mbomArray;L._embomArray=g.is(J.rootEBOM)?J.rootEBOM:L._embomArray;L._loadedProcNodes=g.is(J.loadedProcNodes)?J.loadedProcNodes:L._loadedProcNodes;L._loadedProdNodes=g.is(J.loadedProdNodes)?J.loadedProdNodes:L._loadedProdNodes;if(L._mbomArray.length<=0&&L._embomArray.length<=0){return}this._engConfigFilter="";this._mfgConfigFilter="";M={expandLevel:-1,ordered:true,mbomIds:L._mbomArray,ebomIds:L._embomArray,engConfigFilter:this._engConfigFilter,mfgConfigFilter:this._mfgConfigFilter};d.webServiceRequest({url:"modeler/ppr/BI",method:"POST",onComplete:function N(P){if(g.is(J)&&g.is(J.isMILCommand)){L._addToBIModelCollection(P,{silent:true})}else{L._addToBIModelCollection(P,{silent:true});u.publish({event:"DELWebMfgItemDefUI/OnBICmdSetStatus",data:L.biModelCollection})}if(O instanceof Function){O()}},onFailure:function K(P){L._logger.log(P)},data:g.Json.encode(M),headers:{Accept:"application/json",SecurityContext:d.getSecurityContext(),"Content-Type":"application/ds-json"}})},_addToBIModelCollection:function o(L,J){var O=this,Q=O._getLoadedProcessPIDInstanceList(),K=O._getLoadedProductOccPathList(),P,N,R,M;for(P in L){if(L.hasOwnProperty(P)){N=L[P];for(R in N){if(N.hasOwnProperty(R)){M=N[R];M.id=R;M.type=P;O.biModelCollection.add(M,J);if("MfgItemsUpdateStatus"===P){O._removeItemEntryIfExists(R,Q)}else{O._removeItemEntryIfExists(R,K)}}}}}O._addBIModelsNotKnownStatus(Q,"MfgItemsUpdateStatus",J);O._addBIModelsNotKnownStatus(K,"ProductsAssignmentStatus",J)},isBIComputed:function h(){var J=this;if(J.biModelCollection.size()>0){return true}return false},resetBIModelCollection:function(){if(true===this.isBIComputed()){this.biModelCollection.reset()}},getAssignmentStatusColorCode:function i(J){return this._prdAssignmentStatus[J].colorCode},getUpdateStatusColorCode:function x(J){return this._mfgUpdateStatus[J].colorCode},getAssignmentStatusLabel:function f(J){return this._prdAssignmentStatus[J].label},getUpdateStatusLabel:function b(J){return this._mfgUpdateStatus[J].label},getAllAssignmentStatus:function H(){return this._prdAssignmentStatus},getAllUpdateStatus:function w(){return this._mfgUpdateStatus},setCurrentBICmdState:function C(J){this._cmdState=J},getCurrentBICmdState:function q(){return this._cmdState},computeBIStatus:function B(){this.resetBIModelCollection();this.fetchBIComputation({})},_onConnectionAdd:function j(M){var P,J,N,K,O,R={},Q={},L=[];if(false===this.getCurrentBICmdState()){return}P=M.get("type");if(!g.is(P,"string")){this._logger.warn("Connection type is not defined");return}if("ProductImplementLink"===P){this.resetBIModelCollection();this.fetchBIComputation({});return}if("ProductImplementLinkOcc"===P||"ProductImplementLink"===P){J=M.get("from");if(!g.is(J,"string")){this._logger.warn("Model from referencepid not found");return}N=M.get("to");N=N.toString();if(!g.is(N,"string")){return}K=this.biModelCollection.findWhere({id:J});if(g.is(K)){K.set({pointedPaths:N,status:this._getProcessStatus(P,N)})}else{R.id=J;R.pointedPaths=N;R.status=this._getProcessStatus(P,N);R.type="MfgItemsUpdateStatus";this.biModelCollection.add(R)}O=this.biModelCollection.findWhere({id:N});if(g.is(O)){L=O.get("implementingPIDs");if(g.is(L,"array")){if(-1===L.indexOf(J)){L.push(J);O.set({implementingPIDs:L,status:this._getProductStatus(L,P)})}}else{O.set({implementingPIDs:[J],status:this._getProductStatus([J],P)})}}else{Q.id=N;Q.implementingPIDs=[J];Q.status=this._getProductStatus([J],P);Q.type="ProductsAssignmentStatus";this.biModelCollection.add(Q)}}},_onConnectionRemove:function l(M){var N,K,Q,J,P,O=[],L;if(false===this.isBIComputed()){return}if(!M){this._logger.warn("ERROR: No model defined");return}N=M.get("type");if(!g.is(N,"string")){this._logger.warn("Could not get connection type");return}if("ProductImplementLink"===N){this.resetBIModelCollection();this.fetchBIComputation({});return}if("ProductImplementLinkOcc"===N||"ProductImplementLink"===N){K=M.get("from");if(!g.is(K,"string")){this._logger.warn("Model from referencepid not found");return}Q=M.get("to");Q=Q.toString();if(!g.is(Q,"string")){return}J=this.biModelCollection.findWhere({id:K});if(g.is(J)){J.set({pointedPaths:"",status:this._getProcessStatus(N)})}P=this.biModelCollection.findWhere({id:Q});if(g.is(P)){O=P.get("implementingPIDs");if(g.is(O,"array")){L=O.indexOf(K);if(-1!==L){O.splice(L,1);P.set({implementingPIDs:O,status:this._getProductStatus(O,N)})}else{P.set({status:"NotAssigned"})}}}}},_getProductStatus:function D(K,J){if("ProductImplementLinkOcc"===J){if(0===K.length){return"NotAssigned"}else{if(1===K.length){return"AssignedDirectly"}else{if(1<K.length){return"AssignedMoreThanOnce"}}}}else{if("ProductImplementLink"===J){if(0===K.length){return"NotAssigned"}else{if(1===K.length){return"AssociatedWithScope"}else{if(1<K.length){return"AssignedMoreThanOnce"}}}}}},_getProcessStatus:function A(J,K){if(g.is(K)){if("ProductImplementLinkOcc"===J){return"ImplGood"}else{if("ProductImplementLink"===J){return"ScopeGood"}}}return"NotApplicable"},_getLoadedProcessPIDInstanceList:function s(){var L=this,K,J,M=[];K=L._loadedProcNodes;K.forEach(function(N){J=N.getInstancePID();if(g.is(J)){M.push(J)}});L._mbomArray.forEach(function(N){M.push(N)});return M},_getLoadedProductOccPathList:function G(){var L=this,K,M,J=[];K=L._loadedProdNodes;K.forEach(function(N){M=N.getAbsolutePath();if(g.is(M)&&(0!==M.length)){J.push(M.toString())}});L._embomArray.forEach(function(N){J.push(N)});return J},_removeItemEntryIfExists:function n(K,L){var J=L.indexOf(K);if(-1!==J){L.splice(J,1);return L}},_addBIModelsNotKnownStatus:function k(L,M,K){var J=this;L.forEach(function(N){var O={};O.id=N;O.type=M;O.status="Inconsistent";J.biModelCollection.add(O,K)})}});return c});define("DS/DELWebMfgAssetsDefModelServices/MILUtils",["UWA/Core","UWA/Class","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/BIUtils","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/CollectionUtils"],function(e,b,d,k,c,h){var g=b.singleton({name:"MILUtils",_logger:null,_context:null,init:function l(m){this._parent(m);this.treeListView=m.treeListView;if(e.is(d)){this._logger=d.getLogger(g)}},getBrokenMfgItemStatus:function f(m,n){k.getBrokenMfgItemStatus(m,n)},rerouteLinkBulk:function i(n,t,m,o,p,s){var q=this;c.webServiceRequest({url:"modeler/ppr/MfgItem/RerouteMfgItem",method:"POST",onComplete:function r(u){q._logger.log(u);o.forEach(function(v){q.treeListView.getDocument().removeRoot(v)});q._addResponseToCollection(n,u,s)},onFailure:function p(u){this._logger.log(u);p();return},data:e.Json.encode({scopeCreation:m,mfgItemPID:n,mbomBIStatus:t}),headers:{Accept:"application/json",SecurityContext:c.getSecurityContext(),"Content-Type":"application/ds-json"}})},deleteInstanceBulk:function a(m,o,n){var q=this,r,s,p;m.forEach(function(v){p=o[v];r=h.getInstanceFromCollection(v);s={proxy:"passport",headers:c.getHeaders({isAuthoringCtx:true,isJsonOnly:true}),context:q,onComplete:function u(w){q._logger.log(w);q.treeListView.getDocument().removeRoot(p)},onFailure:function t(w){q._logger.log(w);t()}};if(e.is(r)){r.destroy(s)}})},_addResponseToCollection:function j(u,o,q){var n=[],p=[],s=[];o.connections.forEach(function t(w){var v=h.parseConnection(w);s.push(v)});o.instancesAndReferences.forEach(function r(w){var v=w.attributesValue;if(v.hasOwnProperty("isInstanceOf")){v.queriedForConnections=true;p.push(v)}else{v.queriedForChildren=true;v.queriedForConnections=true;v.queriedForDocuments=true;n.push(v)}});h.addToCollections({stackedReferences:n,stackedInstances:p,stackedConnections:s,deletedObjects:o.deletedObjects,onComplete:function m(){q()}})}});return g});define("DS/DELWebMfgAssetsDefModelServices/IndexedDBUtils",["UWA/Core","UWA/Class","UWA/Date","DS/Logger/Logger","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/ModelPreferences"],function(i,c,n,f,d,h){var e=c.singleton({name:"IndexedDBUtils",referencesStore:"references",instancesStore:"instances",connectionsStore:"connections",documentsStore:"documents",documentsConnectionsStore:"documentsConnections",_logger:null,_db:null,_version:1,_storeNames:["references","instances","connections","documents","documentsConnections"],_keyPath:"pid",_columns:{references:["data"],instances:["isInstanceOf","isAggregatedBy","data"],connections:["from","to","data"],documents:["data"],documentsConnections:["docID","irpcID","data"]},init:function p(q){var r,s;q=q||{};if(i.is(f)){this._logger=f.getLogger(e)}this._parent(q);if(!i.is(e._db)){r=indexedDB.open(d.getWidgetTrigram(),e._version);r.onupgradeneeded=function(t){e._db=t.target.result;e._storeNames.forEach(function(u){s=e._db.createObjectStore(u,{keyPath:e._keyPath});e._columns[u].forEach(function(v){s.createIndex(v,v,{unique:(v==="data")})})})};r.onsuccess=function(t){e._db=t.target.result}}},get:function g(q,r,s,v){var t,w="indexedDB/get",u;t=d.printCurrentDateTime(w+" start - ");u=this._db.transaction([q]).objectStore(q).get(r);u.onsuccess=function(x){d.printDuration(t,w);if(i.is(x.target.result)){if(i.is(s)){s(i.Json.decode(x.target.result.data))}}else{if(i.is(v)){v()}}};u.onerror=function(x){d.printDuration(t,w);if(i.is(v)){v()}}},put:function m(s,x,w,y){var t,v,u,r,q="indexedDB/put";if(!h.getNavigateOnIndexedDB()){return}t={pid:x,data:i.Json.encode(w)};v=i.is(w._attributes)?w._attributes:w;if(v.hasOwnProperty("isInstanceOf")){t.isInstanceOf=v.isInstanceOf;if(v.hasOwnProperty("isAggregatedBy")){t.isAggregatedBy=v.isAggregatedBy}}else{if(v.hasOwnProperty("from")&&v.hasOwnProperty("to")){t.from=v.from;t.to=v.to}else{if(v.hasOwnProperty("docID")&&v.hasOwnProperty("irpcID")){t.docID=v.docID;t.irpcID=v.irpcID}}}if(i.is(e._db)){r=d.printCurrentDateTime(q+" start - ");u=e._db.transaction([s],"readwrite").objectStore(s).put(t);u.onsuccess=function(z){d.printDuration(r,q);if(i.is(y)){y(w)}};u.onerror=function(z){d.printDuration(r,q)}}},remove:function k(q,r,u){var s,v="indexedDB/delete",t;s=d.printCurrentDateTime(v+" start - ");t=e._db.transaction([q],"readwrite").objectStore(q)["delete"](r);t.onsuccess=function(w){d.printDuration(s,v);if(i.is(u,"function")){u()}};t.onerror=function(w){d.printDuration(s,v)}},where:function j(q,v,y,x,s){var w=this._db.transaction([q]).objectStore(q).index(v),t=[],r=false,u;w.openCursor(IDBKeyRange.only(y)).onsuccess=function(z){var A=z.target.result;if(i.is(A)){r=true;t.push(z.target.result.value);A["continue"]()}else{if(r){if(i.is(x,"function")){u=t.map(function(B){return B.data});x(u)}}else{if(i.is(s,"function")){s()}}}}},setStoreName:function o(r){var q;if(r.name==="DocumentConnectionModel"){q=e.documentsConnectionsStore}else{if(r.get("type")==="Document"){q=e.documentsStore}else{if(r.isReference()){q=e.referencesStore}else{if(r.isInstance()){q=e.instancesStore}else{if(r.isConnection()){q=e.connectionsStore}}}}}return q},getModel:function b(s,t,q){var r=e.setStoreName(s);if(i.is(r)){e.get(r,s.id,t,q)}else{q()}},storeModel:function l(r,s){var q=e.setStoreName(r);if(i.is(r.get("attributesValue"))){delete r._attributes.attributesValue}if(i.is(q)){e.put(q,r.id,r,s)}},removeModel:function a(r,s){var q=e.setStoreName(r);if(i.is(q)){e.remove(q,r.id,s)}}});return e});define("DS/DELWebMfgAssetsDefModelServices/AbstractIRPCModel",["UWA/Core","UWA/Date","DS/Core/Events","UWA/Class/Model","UWA/Class/Debug","DS/DELWebMfgAssetsDefModelServices/ModelUtils","DS/DELWebMfgAssetsDefModelServices/LoggerUtils","DS/DELWebMfgAssetsDefModelServices/Resources","DS/DELWebMfgAssetsDefModelServices/ModelPreferences","DS/DELWebMfgAssetsDefModelServices/IndexedDBUtils","DS/DELWebMfgAssetsDefModelServices/ExternalEventsUtils"],function(h,z,u,n,A,f,k,C,w,r,x){var o=n.extend(A,{idAttribute:"PID",_modelEvents:{},_attributesDef:{},_activeFilter:{},init:function y(F,G){if(!G){G={}}G.parse=true;return this._parent(F,G)},destroy:function B(F){r.removeModel(this);return this._parent(h.merge({type:"json"},F))},setup:function v(){this.setDisplayModel({},{silent:true});return this._parent.apply(this,arguments)},getDisplayModelClass:function s(){return this.constructor._DisplayModelClass},setDisplayModel:function p(I,H){var F=this.getDisplayModelClass(),J={},G,L=true,K;if(!F){return L}if(!I){I={}}if(this.has("displayModel")){J=this.get("displayModel").toJSON()}G=new F(J,{model:this});if(G.validate){K=G.validate(I);if(h.is(K)){L=false;this.dispatchEvent("onValidationFailure",[this,K])}}if(L){G.set(I,H);this.set("displayModel",G,H)}return L},setAdditionalInfo:function i(F){if(h.is(F)){if(h.is(this._additionalInfo)){h.extend(this._additionalInfo,F)}}},getAdditionalInfo:function g(F){if(h.is(F,"string")){if(h.is(this._additionalInfo)&&h.is(this._additionalInfo[F])){return h.result(this._additionalInfo,F)}}},getDisplayModelAttr:function q(H){var F=this.get("displayModel"),G=null;if(h.is(F)){if(h.is(H,"string")){G=F.get(H)}else{if(h.is(H,"array")){G=F.pick(H)}}}return G},getAttributeDef:function b(H){var F,G=null;if(h.is(H,"string")){F=this.getDisplayModelAttr("attributesDef");if(h.is(F)){G=F[H]}}return G},incrementDisplayModelCounter:function j(H,G){var F=this.get("displayModel");if(h.is(F)){if(h.is(F.incrementCounter,"function")){F.incrementCounter(H,G)}}},decrementDisplayModelCounter:function m(H,G){var F=this.get("displayModel");if(h.is(F)){if(h.is(F.incrementCounter,"function")){F.decrementCounter(H,G)}}},sync:function l(H,J,I){var T=this,R,S=z.now(),K,F,P,M,Y,O=T._parent,ab=I.onComplete,W=I.onFailure,U=I.onTimeout,aa=h.is(I.forceRefresh)?I.forceRefresh:false,ac=f.getTimeoutPreference(),L="START - "+H+" request",V=" / Time: "+new z(S).toISOString(),X="END - "+H+" request",G,N=function N(ad,af){var ah=af||{},ae=ad||"NOURL",ag={url:ae,data:h.is(ah.data)?ah.data:"",headers:h.is(ah.headers)?ah.headers:"",method:h.is(ah.method)?ah.method:"GET",type:h.is(ah.type)?ah.type:null,onComplete:h.is(ah.onComplete)?ah.onComplete:null,onFailure:h.is(ah.onFailure)?ah.onFailure:null,onTimeout:h.is(ah.onTimeout)?ah.onTimeout:ah.onFailure};f.webServiceRequest(ag);return ag},Q;if(h.is(T._logger)){R=h.is(J.id)?(L+" on "+J.id+V):(L+V);T._logger.log(R)}if(h.is(I)){if(h.is(I.logMessage)){Q=k.getNextIndex();k.logStarted(Q,I.logMessage)}I.onComplete=function Z(ag,af){var ad=true,ae={code:500,message:"",status:"External Server error",type:""};if(h.is(ag)){if(h.is(ag.type)){if(ag.type==="Generic Error"||ag.type==="BL Error"){ad=false;ae.message=ag.message;ae.type=ag.type}}}if(ad){if(h.is(T._logger)){K=z.now();F=K-S;G=" / Duration: "+F+" ms";R=h.is(J.id)?(X+" on "+J.id+G):(X+G);T._logger.log(R)}if(h.is(I)){if(h.is(ab)){ab.call(null,ag,af);r.storeModel(T)}if(h.is(I.logMessage)){k.logCompleted(Q,I.logMessage)}}if(I.request.method==="POST"){if(J.isConnection()){if(ag.connections.length>0){x.emitCreateConnectionEvent(ag.connections)}}else{if(J.isInstance()){x.emitCreateInstanceEvent(ag.attributesValue)}}}else{if(I.request.method==="DELETE"){if(J.isConnection()){x.emitDeleteConnectionEvent(J.toJSON())}else{if(J.isInstance()){x.emitDeleteInstanceEvent(J.toJSON())}}}}}else{I.onFailure.call(null,ae,ag,af)}}.bind(T);I.onFailure=function(ad,af,ae){if(h.is(T._logger)){R="FAILURE during "+H+": "+h.Json.encode(ad);T._logger.log(R)}if(!h.is(af)){af=ad}if(h.is(I)){if(h.is(W)){W.call(null,af,ae)}if(h.is(I.logMessage)){k.logFailed(Q,I.logMessage)}}};I.onTimeout=function(ad,af,ae){if(h.is(T._logger)){R="TIMEOUT during "+H+": "+h.Json.encode(ad);T._logger.log(R)}if(h.is(I)){if(h.is(U)){U.call(null,af,ae)}if(h.is(I.logMessage)){k.logTimedOut(Q,I.logMessage)}}};if(h.is(ac)){I.timeout=ac}I.ajax=N}if(!f.isStandAlone()&&H==="read"&&w.getNavigateOnIndexedDB()&&!aa){M=function M(ad){P=ad.displayModel;delete ad.displayModel;this.set(ad);this.set("queriedForChildren",false);this.set("queriedForConnections",false);I.onComplete({attributesValue:this._attributes,attributesDef:P.attributesDef})}.bind(this);Y=function Y(){return O.call(T,H,J,I)}.bind(this);r.getModel(J,M,Y)}else{return O.call(T,H,J,I)}},parse:function t(F){var G;if(!F){return}if(h.is(F.attributesValue)){G=this.setTypeAndPPRTYPE(F.attributesValue)}else{G=this.setTypeAndPPRTYPE(F)}Object.keys(G).forEach(function(J){var M=C.getAttributeInfo(J),I=false,L=/^\+?[1-9]\d*$/,K=L.test(G[J]),H;if(M&&M.AuthorizedValues){H=M.AuthorizedValues;H.forEach(function(N){if(N.Name===G[J]){G[J]=N.NLS;I=true}});if(!I&&K){G[J]=H[Number.parseInt(G[J])-1].NLS}}});return G},setTypeAndPPRTYPE:function E(G){var F;if(("VPMReference"===G.type)||("ErgoHuman"===G.type)||(""===G.type)){if(f.isAKindOf(G["interface"],"Resource")){G.type=G["interface"];delete G["interface"]}else{if(h.is(G.V_discipline)&&(G.V_discipline.length>0)&&(G.V_discipline!=="NULL")){G.type=G.V_discipline}}}if(h.is(G.type)&&h.is(w.PPRTypes)&&!h.is(G.PPRTYPE)){F=w.PPRTypes[G.type];if(h.is(F)){G.PPRTYPE=F}}return G},isReference:function d(){return !(this.isInstance()||this.isConnection())},isInstance:function e(){return this.has("isInstanceOf")},isConnection:function D(){return this.has("to")&&this.has("from")},isFiltered:function c(){var F=false;if(this._activeFilter){F=true}return F},addFilter:function a(F){if(this._activeFilter){this._activeFilter=F}return this._activeFilter}});return o});